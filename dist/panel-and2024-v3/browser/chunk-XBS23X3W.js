import{a as Kt}from"./chunk-RI3MFF7Y.js";import{a as Zt}from"./chunk-532GEG3Z.js";import{a as li,b as ci,d as ui}from"./chunk-QYKPK5ST.js";import{a as si}from"./chunk-NCA7VRV6.js";import{a as di,c as mi,d as pi}from"./chunk-VLV76A6S.js";import{a as ai}from"./chunk-G7T3QOEL.js";import{b as Qt,d as pt}from"./chunk-BP3DLVFA.js";import{a as ii,c as ni}from"./chunk-ZH3L76W5.js";import{a as me}from"./chunk-J3LFLWBS.js";import{a as ri,b as oi}from"./chunk-DY74HANX.js";import{a as Be,c as ei,h as ti}from"./chunk-OWL6IWUO.js";import{A as Yt,B as Oe,C as Ue,D as Ae,E as Re,G as ut,a as Ee,c as ct,d as dt,g as mt,k as Pe,n as ke,o as Fe,w as Me,x as Jt,z as Le}from"./chunk-RQ3IJGD3.js";import{$ as $t,M as rt,P as se,Q as le,R as ce,S as de,_ as ye,aa as jt,b as Se,c as C,d as K,da as at,e as Z,ea as st,fa as Wt,h as Bt,ha as lt,i as ee,ja as Te,k as te,ka as Ht,m as ie,pa as he,q as ne,qa as fe,sa as Ne,t as oe,ta as Xt,u as ae}from"./chunk-XQXY4DEL.js";import{a as ot}from"./chunk-F6TCIJ3A.js";import{a as pe,c as ue,d as we,f as Ve,g as Ie,h as De,i as Gt,j as _e}from"./chunk-2CSXOGE3.js";import{$a as m,Ab as O,Ba as z,Bb as Ot,C as Ft,Cb as U,Da as c,Eb as w,Ha as A,Ic as qt,Lc as nt,M as We,O as D,Od as j,Q,Qa as i,Ra as o,Sa as p,Ta as ze,Tb as et,U as Ze,Ua as Ce,Ub as $,Vb as Y,Wa as x,X as Nt,Y as V,Za as f,_ as B,ac as tt,c as R,cc as Ut,d as je,fa as _,ga as h,hb as He,ib as Ge,jb as Qe,jc as At,kb as y,lb as l,m as E,mb as S,nb as b,ob as L,pb as Mt,qa as xt,qb as k,qc as Rt,ra as s,rb as F,rf as W,sa as P,sb as N,sf as H,tc as it,uf as G,vb as Lt,ve as be,wb as q,xb as St,ye as re}from"./chunk-53NX3MDI.js";import{a as T,b as xe,f as Ke,h as kt}from"./chunk-SIAVTO45.js";var ve=Ke(st()),Si=Ke(st());var Fi=["download"],Ni=["searchBar"],Mi=n=>({open:n}),Li=()=>[];function Oi(n,d){if(n&1){let e=x();i(0,"li",49),f("click",function(){let r=_(e).$implicit,a=m();return h(a.onBulkBoardingPassSelected(r.id))}),l(1),o()}if(n&2){let e=d.$implicit;c("hidden",!e.active),s(),S(e.name)}}function Ui(n,d){if(n&1){let e=x();i(0,"li",49),f("click",function(){let r=_(e).$implicit,a=m();return h(a.onBulkCredentialsSelected(r.id))}),l(1),o()}if(n&2){let e=d.$implicit;c("hidden",!e.active),s(),S(e.name)}}function Ai(n,d){n&1&&p(0,"i",58)}function Ri(n,d){if(n&1){let e=x();i(0,"tr",50),f("click",function(){let r=_(e).$implicit,a=m();return h(a.userSelected(r))}),i(1,"td")(2,"div",51)(3,"div"),p(4,"nz-avatar",52),o(),i(5,"div",53)(6,"h6",54),z(7,Ai,1,0,"i",55),l(8),o(),ze(9),i(10,"p",56),l(11),p(12,"nz-badge",57),l(13),p(14,"br"),l(15),o(),Ce(),o()()()()}if(n&2){let e=d.$implicit;s(4),c("nzSrc",e.photoURL),s(3),c("ngIf",e.disabled),s(),b(" ",e.displayName,""),s(3),b(" ",e.studentId," "),s(),c("nzStatus",e.emailVerified?"success":"error"),s(),b(" ",e.email," "),s(2),b(" ",e.customerName," ")}}function Bi(n,d){n&1&&p(0,"i",58)}function qi(n,d){if(n&1){let e=x();i(0,"li",67),f("click",function(){_(e);let r=m(2);return h(r.setUserDisabled(!0))}),l(1,"Suspender Usuario "),o()}}function $i(n,d){if(n&1){let e=x();i(0,"li",67),f("click",function(){_(e);let r=m(2);return h(r.setUserDisabled(!1))}),l(1,"Reactivar Usuario "),o()}}function ji(n,d){if(n&1&&(i(0,"div",59),ze(1),i(2,"div",51)(3,"a",60),p(4,"i",61),o(),i(5,"div"),p(6,"nz-avatar",62),o(),i(7,"div",53)(8,"h6",54),z(9,Bi,1,0,"i",55),l(10),o(),i(11,"p",63),p(12,"nz-badge",57),i(13,"span"),l(14),o()()()(),Ce(),i(15,"div")(16,"a",64),p(17,"i",65),o(),i(18,"nz-dropdown-menu",null,17)(20,"ul",29),z(21,qi,2,0,"li",66)(22,$i,2,0,"li",66),o()()()()),n&2){let e=y(19),t=m();s(3),c("routerLink",Lt(10,Li)),s(3),c("nzSrc",t.currentUserSelected.photoURL),s(3),c("ngIf",t.currentUserSelected.disabled),s(),b(" ",t.currentUserSelected.displayName," "),s(2),c("nzStatus",t.currentUserSelected.emailVerified?"success":"error"),s(2),b(" ",t.currentUserSelected.email," "),s(2),c("nzDropdownMenu",e)("nzTrigger","click"),s(5),c("ngIf",!t.currentUserSelected.disabled),s(),c("ngIf",t.currentUserSelected.disabled)}}function Wi(n,d){n&1&&(i(0,"nz-tag",78),l(1,"Cortes\xEDa "),o()),n&2&&c("nzColor","yellow")}function Hi(n,d){n&1&&(i(0,"nz-tag",78),l(1,"Pagado "),o()),n&2&&c("nzColor","cyan")}function Gi(n,d){n&1&&(i(0,"nz-tag",78),l(1,"Pagado Parcial"),o()),n&2&&c("nzColor","red")}function Qi(n,d){n&1&&(i(0,"nz-tag",78),l(1,"Activo"),o()),n&2&&c("nzColor","cyan")}function Xi(n,d){n&1&&(i(0,"nz-tag",78),l(1,"Suspendido"),o()),n&2&&c("nzColor","red")}function Ji(n,d){if(n&1){let e=x();i(0,"tr",50),f("click",function(){let r=_(e).$implicit,a=m(3);return h(a.boardingPassSelected(r))}),i(1,"td")(2,"nz-tag",78),l(3),o(),i(4,"span",79),l(5),O(6,"date"),o()(),i(7,"td"),l(8),o(),i(9,"td"),z(10,Wi,2,1,"nz-tag",80)(11,Hi,2,1,"nz-tag",80)(12,Gi,2,1,"nz-tag",80)(13,Qi,2,1,"nz-tag",80)(14,Xi,2,1,"nz-tag",80),o(),i(15,"td"),l(16),O(17,"currency"),o(),i(18,"td")(19,"a",81),p(20,"i",82),o(),i(21,"nz-dropdown-menu",null,17)(23,"ul",29)(24,"li",67),f("click",function(){let r=_(e).$implicit,a=m(3);return h(a.deletePurchase(r.id))}),l(25,"Eliminar Boleto"),o(),i(26,"li",67),f("click",function(){let r=_(e).$implicit,a=m(3);return h(a.activatePurchase(r.id,!1))}),l(27,"Suspender Boleto"),o(),i(28,"li",67),f("click",function(){let r=_(e).$implicit,a=m(3);return h(a.activatePurchase(r.id,!0))}),l(29,"Activar Boleto"),o()()()()()}if(n&2){let e=d.$implicit,t=y(22);s(2),c("nzColor","blue"),s(),S(e.name),s(2),b(" ",U(6,13,e.creation_date,"medium")," "),s(3),Mt("",e.routeName," / ",e.stopName," / ",e.round,""),s(2),c("ngIf",e.status==="completed"&&!!e.is_courtesy),s(),c("ngIf",e.status==="completed"&&!e.is_courtesy),s(),c("ngIf",e.status!=="completed"),s(),c("ngIf",e.active),s(),c("ngIf",!e.active),s(2),b(" ",Ot(17,16,e.price)," "),s(3),c("nzDropdownMenu",t)}}function Yi(n,d){if(n&1&&(i(0,"nz-table",77,3)(2,"tbody"),z(3,Ji,30,18,"tr",38),o()()),n&2){let e=y(1);m();let t=y(4),r=m();c("nzData",r.latestPurchases)("nzPageSize",3)("nzFooter",t)("nzLoading",r.loadingLatestPurchases)("nzLoadingDelay",500),s(3),c("ngForOf",e.data)}}function Ki(n,d){if(n&1){let e=x();i(0,"button",83),f("click",function(){_(e);let r=m(2);return h(r.showModal())}),p(1,"i",84),l(2,"Nuevo Pase"),o(),i(3,"button",85),f("click",function(){_(e);let r=m(2);return h(r.showModalProduct())}),p(4,"i",84),l(5,"Productos"),o()}}function Zi(n,d){n&1&&(i(0,"nz-tag",78),l(1,"Activa"),o()),n&2&&c("nzColor","cyan")}function en(n,d){n&1&&(i(0,"nz-tag",78),l(1,"Inactiva"),o()),n&2&&c("nzColor","yellow")}function tn(n,d){if(n&1&&(i(0,"span",79),l(1),O(2,"date"),o()),n&2){let e=m().$implicit;s(),b(" ",U(2,1,e.passValidation.lastUsed.toDate(),"medium")," ")}}function nn(n,d){if(n&1){let e=x();i(0,"tr",50),f("click",function(){let r=_(e).$implicit,a=m(3);return h(a.boardingPassSelected(r))}),i(1,"td"),l(2),O(3,"date"),o(),i(4,"td"),l(5),O(6,"date"),o(),i(7,"td"),z(8,Zi,2,1,"nz-tag",80)(9,en,2,1,"nz-tag",80),o(),i(10,"td"),z(11,tn,3,4,"span",86),o(),i(12,"td")(13,"a",81),p(14,"i",82),o(),i(15,"nz-dropdown-menu",null,22)(17,"ul",29)(18,"li",67),f("click",function(){let r=_(e).$implicit,a=m(3);return h(a.deleteCredential(r.id))}),l(19,"Eliminar Credencial"),o(),i(20,"li",67),f("click",function(){let r=_(e).$implicit,a=m(3);return h(a.activateCredential(r.id,!1))}),l(21,"Suspender Credencial"),o(),i(22,"li",67),f("click",function(){let r=_(e).$implicit,a=m(3);return h(a.activateCredential(r.id,!0))}),l(23,"Activar Credencial"),o()()()()()}if(n&2){let e=d.$implicit,t=y(16);s(2),S(U(3,6,e.validFrom.toDate(),"mediumDate")),s(3),S(U(6,9,e.validTo.toDate(),"mediumDate")),s(3),c("ngIf",e.active),s(),c("ngIf",!e.active),s(2),c("ngIf",!!e.passValidation&&e.passValidation.lastUsed),s(2),c("nzDropdownMenu",t)}}function rn(n,d){if(n&1&&(i(0,"nz-table",77,3)(2,"thead")(3,"tr")(4,"th",75),l(5,"V\xE1lida desde"),o(),i(6,"th",75),l(7,"V\xE1lida hasta"),o(),i(8,"th",75),l(9,"Estado"),o(),i(10,"th",75),l(11,"Ultima Actividad"),o()()(),i(12,"tbody"),z(13,nn,24,12,"tr",38),o()()),n&2){let e=y(1);m();let t=y(8),r=m();c("nzData",r.userCredentials)("nzPageSize",3)("nzFooter",t)("nzLoading",r.loadingUserCredentials)("nzLoadingDelay",500),s(13),c("ngForOf",e.data)}}function on(n,d){if(n&1){let e=x();i(0,"button",83),f("click",function(){_(e);let r=m(2);return h(r.showModalCredential())}),p(1,"i",84),l(2,"Nueva credencial"),o()}}function an(n,d){if(n&1&&(i(0,"tr")(1,"td"),l(2),O(3,"date"),o(),i(4,"td"),l(5),o()()),n&2){let e=d.$implicit;s(2),S(U(3,2,e.createdAt.toDate(),"dd/MM/yyyy")),s(3),S(e.msg)}}function sn(n,d){if(n&1){let e=x();i(0,"div"),p(1,"nz-divider",87),i(2,"textarea",88),N("ngModelChange",function(r){_(e);let a=m(2);return F(a.newMessage,r)||(a.newMessage=r),h(r)}),o()(),i(3,"button",83),f("click",function(){_(e);let r=m(2);return h(r.showModalMessageCenter())}),p(4,"i",84),l(5,"Enviar Mensaje"),o()}if(n&2){let e=m(2);s(2),k("ngModel",e.newMessage)}}function ln(n,d){if(n&1&&(i(0,"nz-tabset",68)(1,"nz-tab",69),z(2,Yi,4,6,"nz-table",70)(3,Ki,6,0,"ng-template",null,18,w),o(),i(5,"nz-tab",71),z(6,rn,14,6,"nz-table",70)(7,on,3,0,"ng-template",null,19,w),o(),i(9,"nz-tab",72),l(10," Otras compras "),o(),i(11,"nz-tab",73)(12,"nz-table",74,20)(14,"thead")(15,"tr")(16,"th",75),l(17,"Fecha"),o(),i(18,"th",75),l(19,"Mensaje"),o()()(),i(20,"tbody"),z(21,an,6,5,"tr",76),o()(),z(22,sn,6,1,"ng-template",null,21,w),o()()),n&2){let e=y(13),t=y(23),r=m();s(2),c("ngIf",r.latestPurchases),s(4),c("ngIf",r.userCredentials),s(6),c("nzData",r.userChatMessageData)("nzPageSize",3)("nzFooter",t)("nzLoadingDelay",500),s(9),c("ngForOf",e.data)}}function cn(n,d){n&1&&l(0," Nuevo pase ")}function dn(n,d){if(n&1&&(i(0,"div")(1,"nz-option",105),p(2,"i",84),l(3),o()()),n&2){let e=d.$implicit;s(),c("nzLabel",e.name)("nzValue",e.productId),s(2),L(" ",e.name," $",e.price," ")}}function mn(n,d){if(n&1&&(i(0,"nz-option",105),p(1,"i",84),l(2),o()),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.routeId),s(2),b(" ",e.name,"")}}function pn(n,d){if(n&1&&(i(0,"nz-option",105),p(1,"i",84),l(2),p(3,"br"),l(4),o()),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.stopPointId),s(2),b(" ",e.name," "),s(2),b(" ",e.description," ")}}function un(n,d){if(n&1){let e=x();i(0,"form",89),f("ngSubmit",function(){_(e);let r=m();return h(r.submitForm())}),i(1,"nz-form-item")(2,"nz-form-label"),l(3,"Servicio "),o(),i(4,"nz-select",90),f("ngModelChange",function(r){_(e);let a=m();return h(a.onProductSelected(r,a.products))}),z(5,dn,4,4,"div",76),o()(),i(6,"nz-form-item")(7,"nz-form-label"),l(8,"Operaci\xF3n"),o(),i(9,"nz-select",91),f("ngModelChange",function(r){_(e);let a=m();return h(a.onRouteSelected(r,a.routes))}),z(10,mn,3,3,"nz-option",92),o()(),i(11,"nz-form-item")(12,"nz-form-label"),l(13,"Estaci\xF3n"),o(),i(14,"nz-select",93),f("ngModelChange",function(r){_(e);let a=m();return h(a.onStopPointSelected(r,a.stopPoints))}),z(15,pn,5,4,"nz-option",92),o()(),i(16,"nz-form-item")(17,"nz-form-label"),l(18,"Turno"),o(),i(19,"nz-select",94),p(20,"nz-option",95)(21,"nz-option",96)(22,"nz-option",97),o()(),i(23,"div",98)(24,"div",99)(25,"nz-form-item")(26,"nz-form-label"),l(27,"Cantidad a pagar"),o(),i(28,"nz-input-number",100),f("ngModelChange",function(r){_(e);let a=m();return h(a.onAmountChange(r))}),o()()(),i(29,"div",99)(30,"nz-form-item")(31,"nz-form-label"),l(32,"\xBFEs cortes\xEDa?"),o(),i(33,"nz-switch",101),f("ngModelChange",function(r){_(e);let a=m();return h(a.onCourtesyChange(r))}),o()()()(),i(34,"nz-form-item")(35,"nz-form-control")(36,"label",102),l(37,"Activar pase"),o()()(),i(38,"div",98)(39,"div",99)(40,"nz-form-item")(41,"nz-form-label"),l(42,"V\xE1lido desde"),o(),p(43,"nz-date-picker",103),o()(),i(44,"div",99)(45,"nz-form-item")(46,"nz-form-label"),l(47,"V\xE1lido hasta"),o(),p(48,"nz-date-picker",104),o()()()()}if(n&2){let e=m();c("formGroup",e.validateForm),s(5),c("ngForOf",e.products),s(5),c("ngForOf",e.routes),s(5),c("ngForOf",e.stopPoints),s(13),c("nzMin",50)("nzMax",1299)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function _n(n,d){if(n&1){let e=x();i(0,"button",85),f("click",function(){_(e);let r=m();return h(r.handleCancel())}),l(1,"Cancelar"),o(),i(2,"button",106),f("click",function(){_(e);let r=m();return h(r.submitForm())}),l(3,"Guardar"),o()}if(n&2){let e=m();s(2),c("nzLoading",e.isConfirmLoading)}}function hn(n,d){n&1&&l(0," Productos ")}function fn(n,d){if(n&1&&(i(0,"nz-option",105),p(1,"i",84),l(2),o()),n&2){let e=m().$implicit;c("nzLabel",e.name)("nzValue",e.productId),s(2),L(" ",e.name," $",e.price,"")}}function gn(n,d){if(n&1&&(i(0,"div"),z(1,fn,3,4,"nz-option",108),o()),n&2){let e=d.$implicit;s(),c("ngIf",e.type=="Producto")}}function zn(n,d){if(n&1){let e=x();i(0,"form",107),f("ngSubmit",function(){_(e);let r=m();return h(r.submitForm())}),i(1,"nz-form-item")(2,"nz-form-label"),l(3,"Producto"),o(),i(4,"nz-select",90),f("ngModelChange",function(r){_(e);let a=m();return h(a.onProductSelected(r,a.products))}),z(5,gn,2,1,"div",76),o()(),i(6,"div",98)(7,"div",99)(8,"nz-form-item")(9,"nz-form-label"),l(10,"Cantidad a pagar"),o(),i(11,"nz-input-number",100),f("ngModelChange",function(r){_(e);let a=m();return h(a.onAmountChange(r))}),o()()(),i(12,"div",99)(13,"nz-form-item")(14,"nz-form-label"),l(15,"\xBFEs cortes\xEDa?"),o(),i(16,"nz-switch",101),f("ngModelChange",function(r){_(e);let a=m();return h(a.onCourtesyChange(r))}),o()()()(),i(17,"nz-form-item")(18,"nz-form-control")(19,"label",102),l(20,"Activar pase"),o()()(),i(21,"div",98)(22,"div",99)(23,"nz-form-item")(24,"nz-form-label"),l(25,"V\xE1lido desde"),o(),p(26,"nz-date-picker",103),o()(),i(27,"div",99)(28,"nz-form-item")(29,"nz-form-label"),l(30,"V\xE1lido hasta"),o(),p(31,"nz-date-picker",104),o()()()()}if(n&2){let e=m();c("formGroup",e.validateForm),s(5),c("ngForOf",e.products),s(6),c("nzMin",50)("nzMax",1299)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function Cn(n,d){if(n&1){let e=x();i(0,"button",85),f("click",function(){_(e);let r=m();return h(r.handleCancelProduct())}),l(1,"Cancelar"),o(),i(2,"button",106),f("click",function(){_(e);let r=m();return h(r.submitFormProduct())}),l(3,"Guardar"),o()}if(n&2){let e=m();s(2),c("nzLoading",e.isConfirmLoading)}}function vn(n,d){n&1&&p(0,"nz-badge",143)}function xn(n,d){n&1&&p(0,"nz-badge",144)}function Sn(n,d){n&1&&p(0,"nz-badge",145)}function bn(n,d){n&1&&p(0,"nz-badge",146)}function yn(n,d){n&1&&p(0,"nz-badge",145)}function wn(n,d){if(n&1&&(i(0,"nz-descriptions-item",147),l(1),p(2,"br"),l(3),o()),n&2){let e=m(2);s(),L(" Tarjeta ",e.lastPurchase.card.bank_name," / ",e.lastPurchase.card.brand," "),s(2),b(" ",e.lastPurchase.card.card_number," ")}}function Tn(n,d){n&1&&(i(0,"nz-descriptions-item",147),l(1," Tienda "),o())}function En(n,d){n&1&&(i(0,"nz-descriptions-item",147),l(1," Efectivo "),o())}function Vn(n,d){if(n&1){let e=x();i(0,"nz-date-picker",148),N("ngModelChange",function(r){_(e);let a=m(2);return F(a.lastPurchase.due_date,r)||(a.lastPurchase.due_date=r),h(r)}),f("ngModelChange",function(r){_(e);let a=m(2);return h(a.onValidToUpdated(r))}),o()}if(n&2){let e=m(2);k("ngModel",e.lastPurchase.due_date)}}function In(n,d){if(n&1){let e=x();i(0,"a",149),f("nzOnConfirm",function(){_(e);let r=m(2);return h(r.onCanUpdateValidTo())})("nzOnCancel",function(){_(e);let r=m(2);return h(r.handleCancel())}),i(1,"small"),l(2,"Editar"),o()()}}function Dn(n,d){if(n&1){let e=x();i(0,"a",150),f("nzOnConfirm",function(){_(e);let r=m(2);return h(r.onCanUpdatePayment())})("nzOnCancel",function(){_(e);let r=m(2);return h(r.handleCancel())}),i(1,"small"),l(2,"Editar"),o()()}}function Pn(n,d){if(n&1){let e=x();i(0,"nz-input-number",151),N("ngModelChange",function(r){_(e);let a=m(2);return F(a.lastPurchase.amount,r)||(a.lastPurchase.amount=r),h(r)}),f("ngModelChange",function(r){_(e);let a=m(2);return h(a.onPaymentUpdated(r))}),o()}if(n&2){let e=m(2);k("ngModel",e.lastPurchase.amount),c("nzMin",1)("nzMax",12e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function kn(n,d){if(n&1){let e=x();i(0,"div",109)(1,"nz-tabset",68)(2,"nz-tab",110)(3,"div")(4,"nz-descriptions",111)(5,"nz-descriptions-item",112),l(6),o(),i(7,"nz-descriptions-item",113),z(8,vn,1,0,"nz-badge",114)(9,xn,1,0,"nz-badge",115)(10,Sn,1,0,"nz-badge",116),o(),i(11,"nz-descriptions-item",117),z(12,bn,1,0,"nz-badge",118)(13,yn,1,0,"nz-badge",116),o(),i(14,"nz-descriptions-item",119),l(15),O(16,"date"),o(),z(17,wn,4,3,"nz-descriptions-item",120)(18,Tn,2,0,"nz-descriptions-item",120)(19,En,2,0,"nz-descriptions-item",120),i(20,"nz-descriptions-item",121),l(21),o(),i(22,"nz-descriptions-item",122),l(23),O(24,"date"),o(),i(25,"nz-descriptions-item",123),l(26),O(27,"date"),z(28,Vn,1,1,"nz-date-picker",124)(29,In,3,0,"a",125),o(),i(30,"nz-descriptions-item",126),p(31,"i",127)(32,"i",128),o(),i(33,"nz-descriptions-item",129),l(34),o(),i(35,"nz-descriptions-item",113),l(36),z(37,Dn,3,0,"a",130)(38,Pn,1,6,"nz-input-number",131),o(),i(39,"nz-descriptions-item",132),l(40),o(),i(41,"nz-descriptions-item",133),l(42),o(),i(43,"nz-descriptions-item",134),l(44),o(),i(45,"nz-descriptions-item",135),l(46),o(),i(47,"nz-descriptions-item",136),l(48),o()(),p(49,"br"),o()(),i(50,"nz-tab",137),p(51,"app-shared-usage-history",138),o(),i(52,"nz-tab",139),p(53,"nz-qrcode",140)(54,"a",null,23),l(56),i(57,"button",141),f("click",function(){_(e);let r=m();return h(r.downloadImg())}),l(58,"Descargar"),o()(),i(59,"nz-tab",142),l(60," Content of Tab Pane 3 "),o()()()}if(n&2){let e,t=m();s(6),S(t.lastPurchase.name),s(2),c("ngIf",t.lastPurchase.status=="completed"),s(),c("ngIf",t.lastPurchase.status=="partial"),s(),c("ngIf",t.lastPurchase.status=="in_progress"),s(2),c("ngIf",t.lastPurchase.active),s(),c("ngIf",!t.lastPurchase.active),s(2),b(" ",U(16,31,t.lastPurchase.operation_date,"medium")," "),s(2),c("ngIf",!!t.lastPurchase&&t.lastPurchase.card),s(),c("ngIf",!!t.lastPurchase&&t.lastPurchase.method=="store"),s(),c("ngIf",!!t.lastPurchase&&t.lastPurchase.method=="cash"),s(2),b("",t.lastPurchase.is_courtesy?"Si":"No"," "),s(2),b(" ",U(24,34,t.lastPurchase.validFrom.toDate(),"mediumDate"),""),s(3),b(" ",t.canUpdateValidTo?null:U(27,37,t.lastPurchase.validTo.toDate(),"mediumDate")," "),s(2),c("ngIf",t.canUpdateValidTo),s(),c("ngIf",!t.canUpdateValidTo&&t.lastPurchase.status!="completed"),s(5),L("",t.lastPurchase.currency," ",t.lastPurchase.price," "),s(2),L(" ",t.canUpdatePayment?null:t.lastPurchase.currency," ",t.canUpdatePayment?null:t.lastPurchase.amount," "),s(),c("ngIf",!t.canUpdatePayment&&t.lastPurchase.status!="completed"),s(),c("ngIf",t.canUpdatePayment),s(2),S(t.lastPurchase.authorization),s(2),b("",t.lastPurchase.routeName," "),s(2),L("",t.lastPurchase.stopName," ",t.lastPurchase.stopDescription,""),s(2),S(t.lastPurchase.round),s(2),b(" ",t.lastPurchase.description," "),s(3),c("userId",t.currentUserSelected.uid)("boardingPassId",(e=t.lastPurchase==null?null:t.lastPurchase.id)!==null&&e!==void 0?e:""),s(5),L(" ",t.currentUserSelected.uid,"-",t.lastPurchase.id," ")}}function Fn(n,d){n&1&&l(0," Nuevo pase ")}function Nn(n,d){if(n&1&&(i(0,"div")(1,"nz-option",105),p(2,"i",84),l(3),o()()),n&2){let e=d.$implicit;s(),c("nzLabel",e.name)("nzValue",e.productId),s(2),L(" ",e.name," $",e.price,"")}}function Mn(n,d){if(n&1&&(i(0,"nz-option",105),p(1,"i",84),l(2),o()),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.routeId),s(2),b(" ",e.name,"")}}function Ln(n,d){if(n&1&&(i(0,"nz-option",105),p(1,"i",84),l(2),p(3,"br"),l(4),o()),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.stopPointId),s(2),b(" ",e.name," "),s(2),b(" ",e.description,"")}}function On(n,d){if(n&1){let e=x();i(0,"div")(1,"form",107),f("ngSubmit",function(){_(e);let r=m(2);return h(r.submitForm())}),i(2,"nz-form-item")(3,"nz-form-label"),l(4,"Servicio "),o(),i(5,"nz-select",90),f("ngModelChange",function(r){_(e);let a=m(2);return h(a.onProductSelected(r,a.products))}),z(6,Nn,4,4,"div",76),o()(),i(7,"nz-form-item")(8,"nz-form-label"),l(9,"Operaci\xF3n"),o(),i(10,"nz-select",91),f("ngModelChange",function(r){_(e);let a=m(2);return h(a.onRouteSelected(r,a.routes))}),z(11,Mn,3,3,"nz-option",92),o()(),i(12,"nz-form-item")(13,"nz-form-label"),l(14,"Estaci\xF3n"),o(),i(15,"nz-select",93),f("ngModelChange",function(r){_(e);let a=m(2);return h(a.onStopPointSelected(r,a.stopPoints))}),z(16,Ln,5,4,"nz-option",92),o()(),i(17,"nz-form-item")(18,"nz-form-label"),l(19,"Turno"),o(),i(20,"nz-select",94),p(21,"nz-option",95)(22,"nz-option",96)(23,"nz-option",97),o()(),i(24,"div",98)(25,"div",99)(26,"nz-form-item")(27,"nz-form-label"),l(28,"Cantidad a pagar"),o(),i(29,"nz-input-number",100),f("ngModelChange",function(r){_(e);let a=m(2);return h(a.onAmountChange(r))}),o()()(),i(30,"div",99)(31,"nz-form-item")(32,"nz-form-label"),l(33,"\xBFEs cortes\xEDa?"),o(),i(34,"nz-switch",101),f("ngModelChange",function(r){_(e);let a=m(2);return h(a.onCourtesyChange(r))}),o()()()(),i(35,"nz-form-item")(36,"nz-form-control")(37,"label",102),l(38,"Activar pase"),o()()(),i(39,"div",98)(40,"div",99)(41,"nz-form-item")(42,"nz-form-label"),l(43,"V\xE1lido desde"),o(),p(44,"nz-date-picker",103),o()(),i(45,"div",99)(46,"nz-form-item")(47,"nz-form-label"),l(48,"V\xE1lido hasta"),o(),p(49,"nz-date-picker",104),o()()()()()}if(n&2){let e=m(2);s(),c("formGroup",e.validateForm),s(5),c("ngForOf",e.products),s(5),c("ngForOf",e.routes),s(5),c("ngForOf",e.stopPoints),s(13),c("nzMin",50)("nzMax",1299)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function Un(n,d){if(n&1){let e=x();i(0,"tr")(1,"td",160),N("nzCheckedChange",function(r){let a=_(e).$implicit,u=m(3);return F(u.mapOfCheckedId[a.id],r)||(u.mapOfCheckedId[a.id]=r),h(r)}),f("nzCheckedChange",function(){_(e);let r=m(3);return h(r.refreshStatus())}),o(),i(2,"td"),l(3),o(),i(4,"td"),l(5),o(),i(6,"td"),l(7),o()()}if(n&2){let e=d.$implicit,t=m(3);s(),k("nzChecked",t.mapOfCheckedId[e.id]),s(2),S(e.studentId),s(2),S(e.displayName),s(2),S(e.email)}}function An(n,d){if(n&1){let e=x();i(0,"div")(1,"nz-table",158,24),f("nzCurrentPageDataChange",function(r){_(e);let a=m(2);return h(a.currentPageDataChange(r))}),i(3,"thead")(4,"tr")(5,"th",159),N("nzCheckedChange",function(r){_(e);let a=m(2);return F(a.isAllDisplayDataChecked,r)||(a.isAllDisplayDataChecked=r),h(r)}),f("nzCheckedChange",function(r){_(e);let a=m(2);return h(a.checkAllData(r))}),o(),i(6,"th",75),l(7,"Id"),o(),i(8,"th",75),l(9,"Nombre"),o(),i(10,"th",75),l(11,"Email / Tel\xE9fono"),o()()(),i(12,"tbody"),z(13,Un,8,4,"tr",76),o()()()}if(n&2){let e=y(2),t=m(2);s(),c("nzData",t.devicesList)("nzSize","middle"),s(4),c("nzSelections",t.listOfSelection),k("nzChecked",t.isAllDisplayDataChecked),c("nzIndeterminate",t.isIndeterminate),s(8),c("ngForOf",e.data)}}function Rn(n,d){if(n&1){let e=x();i(0,"nz-date-picker",148),N("ngModelChange",function(r){_(e);let a=m(3);return F(a.lastPurchase.due_date,r)||(a.lastPurchase.due_date=r),h(r)}),f("ngModelChange",function(r){_(e);let a=m(3);return h(a.onValidToUpdated(r))}),o()}if(n&2){let e=m(3);k("ngModel",e.lastPurchase.due_date)}}function Bn(n,d){if(n&1){let e=x();i(0,"a",149),f("nzOnConfirm",function(){_(e);let r=m(3);return h(r.onCanUpdateValidTo())})("nzOnCancel",function(){_(e);let r=m(3);return h(r.handleCancel())}),i(1,"small"),l(2,"Editar"),o()()}}function qn(n,d){if(n&1){let e=x();i(0,"a",150),f("nzOnConfirm",function(){_(e);let r=m(3);return h(r.onCanUpdatePayment())})("nzOnCancel",function(){_(e);let r=m(3);return h(r.handleCancel())}),i(1,"small"),l(2,"Editar"),o()()}}function $n(n,d){if(n&1){let e=x();i(0,"nz-input-number",151),N("ngModelChange",function(r){_(e);let a=m(3);return F(a.lastPurchase.amount,r)||(a.lastPurchase.amount=r),h(r)}),f("ngModelChange",function(r){_(e);let a=m(3);return h(a.onPaymentUpdated(r))}),o()}if(n&2){let e=m(3);k("ngModel",e.lastPurchase.amount),c("nzMin",1)("nzMax",12e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function jn(n,d){if(n&1&&(i(0,"div")(1,"div")(2,"nz-descriptions",111)(3,"nz-descriptions-item",112),l(4),o(),i(5,"nz-descriptions-item",121),l(6),o(),i(7,"nz-descriptions-item",122),l(8),O(9,"date"),o(),i(10,"nz-descriptions-item",123),l(11),O(12,"date"),z(13,Rn,1,1,"nz-date-picker",124)(14,Bn,3,0,"a",125),o(),i(15,"nz-descriptions-item",126),p(16,"i",127)(17,"i",128),o(),i(18,"nz-descriptions-item",129),l(19),o(),i(20,"nz-descriptions-item",113),l(21),z(22,qn,3,0,"a",130)(23,$n,1,6,"nz-input-number",131),o(),i(24,"nz-descriptions-item",132),l(25),o(),i(26,"nz-descriptions-item",133),l(27),o(),i(28,"nz-descriptions-item",134),l(29),o(),i(30,"nz-descriptions-item",135),l(31),o(),i(32,"nz-descriptions-item",136),l(33),o()(),p(34,"br"),o(),l(35),o()),n&2){let e=m(2);s(4),S(e.validateForm.controls.product_description.value),s(2),b("",e.validateForm.controls.is_courtesy.value?"Si":"No"," "),s(2),b(" ",U(9,19,e.lastPurchase.validFrom.toDate(),"mediumDate"),""),s(3),b(" ",e.canUpdateValidTo?null:U(12,22,e.lastPurchase.validTo.toDate(),"mediumDate")," "),s(2),c("ngIf",e.canUpdateValidTo),s(),c("ngIf",!e.canUpdateValidTo&&e.lastPurchase.status!="completed"),s(5),L("",e.lastPurchase.currency," ",e.lastPurchase.price," "),s(2),L(" ",e.canUpdatePayment?null:e.lastPurchase.currency," ",e.canUpdatePayment?null:e.lastPurchase.amount," "),s(),c("ngIf",!e.canUpdatePayment&&e.lastPurchase.status!="completed"),s(),c("ngIf",e.canUpdatePayment),s(2),S(e.lastPurchase.authorization),s(2),b("",e.lastPurchase.routeName," "),s(2),L("",e.lastPurchase.stopName," ",e.lastPurchase.stopDescription,""),s(2),S(e.lastPurchase.round),s(2),b(" ",e.lastPurchase.description," "),s(2),b(" ",e.actualSelectedRows," ")}}function Wn(n,d){if(n&1&&(i(0,"nz-steps",152),p(1,"nz-step",153)(2,"nz-step",154)(3,"nz-step",155),o(),p(4,"br"),i(5,"div",156),z(6,On,50,9,"div",157)(7,An,14,6,"div",157)(8,jn,36,25,"div",157),o()),n&2){let e=m();c("nzCurrent",e.current),s(6),c("ngIf",e.current==0),s(),c("ngIf",e.current==1),s(),c("ngIf",e.current==2)}}function Hn(n,d){if(n&1){let e=x();i(0,"button",165),f("click",function(){_(e);let r=m(2);return h(r.pre())}),i(1,"span"),l(2,"Anterior"),o()()}if(n&2){let e=m(2);c("disabled",e.isCreatingBoardingPasses)}}function Gn(n,d){if(n&1){let e=x();i(0,"button",165),f("click",function(){_(e);let r=m(2);return h(r.next())}),i(1,"span"),l(2,"Siguiente"),o()()}if(n&2){let e=m(2);c("disabled",e.isCreatingBoardingPasses)}}function Qn(n,d){if(n&1){let e=x();i(0,"button",106),f("click",function(){_(e);let r=m(2);return h(r.createMultipleBoardingPasses())}),i(1,"span"),l(2,"Crear Pases"),o()()}if(n&2){let e=m(2);c("nzLoading",e.isCreatingBoardingPasses)}}function Xn(n,d){if(n&1){let e=x();i(0,"button",85),f("click",function(){_(e);let r=m(2);return h(r.done())}),i(1,"span"),l(2,"Terminar"),o()()}}function Jn(n,d){if(n&1&&(i(0,"div",161),z(1,Hn,3,1,"button",162)(2,Gn,3,1,"button",162)(3,Qn,3,1,"button",163)(4,Xn,3,0,"button",164),o()),n&2){let e=m();s(),c("ngIf",e.current>0&&!e.isDone),s(),c("ngIf",e.current<2),s(),c("ngIf",e.current===2&&!e.isDone),s(),c("ngIf",e.current===2&&e.isDone)}}function Yn(n,d){n&1&&l(0," Nuevas credenciales ")}function Kn(n,d){if(n&1){let e=x();i(0,"div")(1,"form",107),f("ngSubmit",function(){_(e);let r=m(2);return h(r.createMultipleCredentials())}),i(2,"div",98)(3,"div",99)(4,"nz-form-item")(5,"nz-form-label"),l(6,"V\xE1lido desde"),o(),p(7,"nz-date-picker",103),o()(),i(8,"div",99)(9,"nz-form-item")(10,"nz-form-label"),l(11,"V\xE1lido hasta"),o(),p(12,"nz-date-picker",104),o()(),i(13,"div",99)(14,"nz-form-item")(15,"nz-form-control")(16,"label",102),l(17,"Activar credencial"),o()()()()()()()}if(n&2){let e=m(2);s(),c("formGroup",e.credentialForm)}}function Zn(n,d){if(n&1){let e=x();i(0,"tr")(1,"td",160),N("nzCheckedChange",function(r){let a=_(e).$implicit,u=m(3);return F(u.mapOfCredentialsCheckedId[a.uid],r)||(u.mapOfCredentialsCheckedId[a.uid]=r),h(r)}),f("nzCheckedChange",function(){_(e);let r=m(3);return h(r.refreshCredentialsStatus())}),o(),i(2,"td"),l(3),o(),i(4,"td"),l(5),o(),i(6,"td"),l(7),o(),i(8,"td"),l(9),o()()}if(n&2){let e=d.$implicit,t=m(3);s(),k("nzChecked",t.mapOfCredentialsCheckedId[e.uid]),s(2),S(e.customerName),s(2),S(e.studentId),s(2),S(e.displayName),s(2),S(e.email)}}function er(n,d){if(n&1){let e=x();i(0,"div")(1,"nz-table",158,24),f("nzCurrentPageDataChange",function(r){_(e);let a=m(2);return h(a.currentCredentialsPageDataChange(r))}),i(3,"thead")(4,"tr")(5,"th",159),N("nzCheckedChange",function(r){_(e);let a=m(2);return F(a.isCredentialsAllDisplayDataChecked,r)||(a.isCredentialsAllDisplayDataChecked=r),h(r)}),f("nzCheckedChange",function(r){_(e);let a=m(2);return h(a.checkCredentialsAllData(r))}),o(),i(6,"th",75),l(7,"Empresa"),o(),i(8,"th",75),l(9,"Id"),o(),i(10,"th",75),l(11,"Nombre"),o(),i(12,"th",75),l(13,"Email / Tel\xE9fono"),o()()(),i(14,"tbody"),z(15,Zn,10,5,"tr",76),o()()()}if(n&2){let e=y(2),t=m(2);s(),c("nzData",t.usersByAccount)("nzSize","middle"),s(4),c("nzSelections",t.listOfCredentialsSelection),k("nzChecked",t.isCredentialsAllDisplayDataChecked),c("nzIndeterminate",t.isCredentialsIndeterminate),s(10),c("ngForOf",e.data)}}function tr(n,d){if(n&1&&(i(0,"div"),l(1),o()),n&2){let e=m(3);s(),b(" Se crear\xE1n ",e.actualSelectedRows," credenciales para los usuarios seleccionados. ")}}function ir(n,d){n&1&&(i(0,"div"),l(1," No has seleccionado ning\xFAn usuario para crear una credencial. "),o())}function nr(n,d){if(n&1&&(i(0,"div"),z(1,tr,2,1,"div",157)(2,ir,2,0,"div",157),o()),n&2){let e=m(2);s(),c("ngIf",e.actualSelectedRows>0),s(),c("ngIf",e.actualSelectedRows===0)}}function rr(n,d){if(n&1&&(i(0,"div")(1,"div"),l(2),o()()),n&2){let e=m(2);s(2),b(" Se crearon ",e.actualSelectedRows,". ")}}function or(n,d){if(n&1&&(i(0,"nz-steps",152),p(1,"nz-step",166)(2,"nz-step",167)(3,"nz-step",155),o(),p(4,"br"),i(5,"div",156),z(6,Kn,18,1,"div",157)(7,er,16,6,"div",157)(8,nr,3,2,"div",157)(9,rr,3,1,"div",157),o()),n&2){let e=m();c("nzCurrent",e.current),s(6),c("ngIf",e.current==0),s(),c("ngIf",e.current==1),s(),c("ngIf",e.current==2),s(),c("ngIf",e.current==3)}}function ar(n,d){if(n&1){let e=x();i(0,"button",85),f("click",function(){_(e);let r=m(2);return h(r.pre())}),i(1,"span"),l(2,"Anterior"),o()()}}function sr(n,d){if(n&1){let e=x();i(0,"button",165),f("click",function(){_(e);let r=m(2);return h(r.next())}),i(1,"span"),l(2,"Siguiente"),o()()}if(n&2){let e=m(2);c("disabled",e.credentialForm.invalid)}}function lr(n,d){if(n&1){let e=x();i(0,"button",169),f("click",function(){_(e);let r=m(2);return h(r.createMultipleCredentials())}),i(1,"span"),l(2,"Crear Credenciales"),o()()}if(n&2){let e=m(2);c("disabled",e.actualSelectedRows===0)("nzLoading",e.isCreatingCredentials)}}function cr(n,d){if(n&1){let e=x();i(0,"button",85),f("click",function(){_(e);let r=m(2);return h(r.done())}),i(1,"span"),l(2,"Terminar"),o()()}}function dr(n,d){if(n&1&&(i(0,"div",161),z(1,ar,3,0,"button",164)(2,sr,3,1,"button",162)(3,lr,3,2,"button",168)(4,cr,3,0,"button",164),o()),n&2){let e=m();s(),c("ngIf",e.current>0&&!e.isDone),s(),c("ngIf",e.current<2),s(),c("ngIf",e.current===2&&!e.isDone),s(),c("ngIf",e.current===3&&e.isDone)}}function mr(n,d){n&1&&l(0," Nueva credencial ")}function pr(n,d){if(n&1){let e=x();i(0,"div",156)(1,"form",107),f("ngSubmit",function(){_(e);let r=m();return h(r.createCredential())}),i(2,"div",98)(3,"div",99)(4,"nz-form-item")(5,"nz-form-label"),l(6,"V\xE1lido desde"),o(),p(7,"nz-date-picker",103),o()(),i(8,"div",99)(9,"nz-form-item")(10,"nz-form-label"),l(11,"V\xE1lido hasta"),o(),p(12,"nz-date-picker",104),o()(),i(13,"div",99)(14,"nz-form-item")(15,"nz-form-control")(16,"label",102),l(17,"Activar credencial"),o()()()()()()()}if(n&2){let e=m();s(),c("formGroup",e.credentialForm)}}function ur(n,d){if(n&1){let e=x();i(0,"button",169),f("click",function(){_(e);let r=m();return h(r.createCredential())}),i(1,"span"),l(2,"Crear Credencial"),o()()}if(n&2){let e=m();c("disabled",e.credentialForm.invalid)("nzLoading",e.isCreatingCredentials)}}var ia=(()=>{let d=class d{constructor(t,r,a,u){this.afs=t,this.modalService=r,this.messageService=a,this.fb=u,this.authService=V(re),this.productsService=V(ri),this.customersService=V(at),this.dashboardService=V(ai),this.rolService=V(Ee),this.hasBeenFiltered=!1,this.loadedDevicesList=[],this.newMessage="",this.loadingChatMessages=!1,this.current=0,this.isDone=!1,this.isCreatingBoardingPasses=!1,this.isCreatingCredentials=!1,this.listOfSelection=[{text:"Seleccionar todas las p\xE1ginas",onSelect:()=>{this.checkAllData(!0)}},{text:"Deseleccionar todas las p\xE1ginas",onSelect:()=>{this.checkAllData(!1),this.refreshStatus()}}],this.listOfCredentialsSelection=[{text:"Seleccionar todas las p\xE1ginas",onSelect:()=>{this.checkCredentialsAllData(!0)}},{text:"Deseleccionar todas las p\xE1ginas",onSelect:()=>{this.checkCredentialsAllData(!1),this.refreshCredentialsStatus()}}],this.isAllDisplayDataChecked=!1,this.isIndeterminate=!1,this.listOfDisplayData=[],this.listOfAllData=[],this.mapOfCheckedId={},this.isCredentialsAllDisplayDataChecked=!1,this.isCredentialsIndeterminate=!1,this.listOfCredentialsDisplayData=[],this.listOfCredentialsAllData=[],this.mapOfCredentialsCheckedId={},this.isContentOpen=!1,this.isUserSelected=!1,this.isLoadingUsers=!1,this.loadingLastPurchase=!1,this.isBoardingPassSelected=!1,this.isCredentialSelected=!1,this.isLoadingPayments=!1,this.hasBeenLoaded=!1,this.loadingUserCredentials=!1,this.loadingLatestPurchases=!1,this.isVisible=!1,this.isProductVisible=!1,this.isModalCredentialVisible=!1,this.isConfirmLoading=!1,this.checked=!1,this.routes=[],this.products=[],this.stopPoints=[],this.usersByAccount=[],this.accountId$=new R,this.routeId$=new R,this.canUpdatePayment=!1,this.canUpdateValidTo=!1,this.elementType="url",this.customersList=[],this.stopSubscription$=new R,this.isVisibleBulk=!1,this.isLoadingBulk=!1,this.isConfirmLoadingBulk=!1,this.isVisibleBulkCredentials=!1,this.isLoadingBulkCredentials=!1,this.isConfirmLoadingBulkCredentials=!1,this.formatterPercent=g=>`${g} %`,this.parserPercent=g=>g.replace(" %",""),this.formatterDollar=g=>`$ ${g}`,this.parserDollar=g=>g.replace("$ ",""),this.selectedUsersForCredentials=[],this.infoLoad=[],this.infoSegment=[],this.accountsService=V(Ve),this.authService.user.subscribe(g=>{this.user=g,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(v=>{this.infoLoad=v,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(D(this.stopSubscription$),E(v=>{let I=v.payload.id,X=v.payload.data();return T({id:I},X)}),Q(v=>(this.infoSegment=v,v))).subscribe())})}ngOnInit(){this.accountId$.pipe(We(g=>this.afs.collection("customers").doc(g).collection("routes",v=>v.where("active","==",!0)).valueChanges({idField:"routeId"}))).subscribe(g=>{this.routes=g});let r=this.accountId$.pipe(We(g=>this.afs.collection("customers").doc(g).collection("products",v=>v.where("active","==",!0)).valueChanges({idField:"productId"}))),a=this.accountId$.pipe(We(g=>this.afs.collection("users",v=>v.where("customerId","==",g).orderBy("studentId")).valueChanges({idField:"uid"}))),u=this.routeId$.pipe(We(g=>this.afs.collection("customers").doc(this.currentSelectedCustomerId).collection("routes").doc(g).collection("stops",v=>v.orderBy("order","asc").where("active","==",!0)).valueChanges({idField:"stopPointId"})));r.subscribe(g=>{console.log(g),this.products=g}),u.subscribe(g=>{this.stopPoints=g}),a.subscribe(g=>{this.usersByAccount=g}),this.getUsersList(),this.getCustomersList(),this.credentialForm=this.fb.group({active:[!0,[C.required]],validFrom:[new Date,[C.required]],validTo:[new Date,[C.required]]}),this.validateForm=this.fb.group({active:[!0,[C.required]],amount:[0,[C.required]],authorization:[""],category:["",[C.required]],conciliated:[!1,[C.required]],creation_date:[new Date().toISOString(),[C.required]],currency:["MXN",[C.required]],customer_id:["",[C.required]],date_created:[new Date,[C.required]],due_date:[new Date,[C.required]],description:["",[C.required]],error_message:[""],fee:this.fb.group({amount:[0],currency:["MXN"],tax:[0]}),is_courtesy:[!1],method:["cash",[C.required]],name:["",[C.required]],operation_date:[new Date().toISOString(),[C.required]],operation_type:["in",[C.required]],order_id:[""],payment_method:this.fb.group({barcode_url:[""],reference:[""],type:["cash"]}),price:[0,[C.required]],product_description:["",[C.required]],product_id:["",[C.required]],round:["",[C.required]],routeId:["",[C.required]],routeName:["",[C.required]],status:["completed",[C.required]],stopDescription:["",[C.required]],stopId:["",[C.required]],stopName:["",[C.required]],transaction_type:["charge",[C.required]],validFrom:[new Date,[C.required]],validTo:[new Date,[C.required]],isTaskIn:[!1,[C.required]],isTaskOut:[!1,[C.required]],isOpenpay:[!1,[C.required]],paidApp:["web",[C.required]],baja:[!1],realValidTo:[]})}ngOnDestroy(){this.hasBeenLoaded=!1,this.loadedDevicesList=[],this.users&&this.users.unsubscribe(),this.routesSubscription&&this.routesSubscription.unsubscribe(),this.productsSubscription&&this.productsSubscription.unsubscribe(),this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}showModal(){this.isVisible=!0}showModalCredential(){this.isModalCredentialVisible=!0}showModalProduct(){this.isProductVisible=!0}showModalMessageCenter(){return kt(this,null,function*(){if(this.currentUserSelected&&this.currentUserSelected.uid){let t=this.currentUserSelected.uid;console.log("token payload created: ",JSON.stringify(this.currentUserSelected.token));let r={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"Apps And Informa",msg:this.newMessage,requestId:"suhB7YFAh6PYXCRuJhfD",token:this.currentUserSelected.token,uid:this.currentUserSelected.uid,result:""},a={timestamp:new Date,title:"Apps And Informa General",from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",requestId:"suhB7YFAh6PYXCRuJhfD",body:this.newMessage,token:this.currentUserSelected.token,uid:this.currentUserSelected.uid};this.dashboardService.setMessage(a,this.currentUserSelected.uid),this.dashboardService.setChatMessage(r).then(()=>{this.newMessage=""})}else console.error("currentUserSelected or uid is null or undefined")})}onBulkBoardingPassSelected(t){this.accountId$.next(t),this.currentSelectedCustomerId=t,this.isVisibleBulk=!0}onBulkCredentialsSelected(t){this.accountId$.next(t),this.currentSelectedCustomerId=t,this.isVisibleBulkCredentials=!0}onProductSelected(t,r){let u=ve.filter(r,g=>g.productId==t)[0];this.validateForm.controls.name.setValue(u.name),this.validateForm.controls.description.setValue(u.description),this.validateForm.controls.product_description.setValue(u.description),this.validateForm.controls.amount.setValue(u.price),this.validateForm.controls.is_courtesy.setValue(!1),this.validateForm.controls.price.setValue(u.price),this.validateForm.controls.category.setValue(u.category),this.validateForm.controls.validFrom.setValue(u.validFrom.toDate()),this.validateForm.controls.validTo.setValue(u.validTo.toDate()),this.validateForm.controls.realValidTo.setValue(u.validTo.toDate().toISOString()),this.validateForm.controls.isTaskIn.setValue(u.isTaskIn),this.validateForm.controls.isTaskOut.setValue(u.isTaskOut)}onRouteSelected(t,r){this.routeId$.next(t);let u=ve.filter(r,g=>g.routeId==t)[0];console.log("record found is: ",u),this.validateForm.controls.routeName.setValue(u.name)}onStopPointSelected(t,r){let u=ve.filter(r,g=>g.stopPointId==t)[0];this.validateForm.controls.stopName.setValue(u.name),this.validateForm.controls.stopDescription.setValue(u.description)}onCourtesyChange(t){t&&this.validateForm.controls.amount.setValue(0)}onAmountChange(t){t>0&&this.validateForm.controls.is_courtesy.setValue(!1)}onCanUpdatePayment(){this.canUpdatePayment=!0}sendMessage(t,r){this.messageService.create(t,r)}onPaymentUpdated(t){this.currentUserSelected&&this.currentUserSelected.uid?(this.lastPurchase!==null&&this.lastPurchase!==void 0?+this.lastPurchase.price===t?this.lastPurchase&&this.lastPurchase.realValidTo?(console.log("full price has been reached"),this.lastPurchase.status="completed",this.lastPurchase.amount=t,this.lastPurchase.active=!0,this.lastPurchase.validTo=qt.fromDate(new Date(this.lastPurchase.realValidTo))):console.error("lastPurchase or date is null or undefined"):this.lastPurchase.amount=t:console.error("lastPurchase is null or undefined"),this.userlevelAccess!="3"?this.customersService.updateBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.lastPurchase).then(r=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(r=>{this.isConfirmLoading=!1}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador."),this.canUpdatePayment=!1):console.error("currentUserSelected or uid is null or undefined")}onCanUpdateValidTo(){this.canUpdateValidTo=!0}onValidToUpdated(t){this.canUpdateValidTo=!1}createCredential(){if(this.credentialForm.valid)if(this.currentUserSelected&&this.currentUserSelected.uid){let t=this.currentUserSelected.uid,r=this.credentialForm.controls.validFrom.value||new Date,a=this.credentialForm.controls.validTo.value||new Date,u=this.credentialForm.controls.active.value||!1;console.log(r,a,u),this.isCreatingCredentials=!0,this.userlevelAccess!="3"?this.customersService.createCredential(this.currentUserSelected.uid,this.currentUserSelected.studentId,r,a,u).then(g=>{console.log(g),this.isModalCredentialVisible=!1}):this.sendMessage("error","El usuario no tiene permisos para crear datos, favor de contactar al administrador."),this.isCreatingCredentials=!1,this.isDone=!0}else console.error("currentUserSelected or uid is null or undefined")}submitForm(){if(this.currentUserSelected&&this.currentUserSelected.uid){let t=this.currentUserSelected.uid;this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId);let r=this.validateForm.controls.amount.value,a=this.validateForm.controls.price.value,u=this.validateForm.controls.validTo.value,g=this.validateForm.controls.is_courtesy.value||!1;this.validateForm.controls.due_date.setValue(u.toISOString()),r!=a&&!g&&this.validateForm.controls.status.setValue("partial");for(let v in this.validateForm.controls)this.validateForm.controls[v].markAsDirty(),this.validateForm.controls[v].updateValueAndValidity();this.validateForm.valid&&(this.isConfirmLoading=!0,this.userlevelAccess!="3"?this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.validateForm.value).then(v=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(v=>{this.isConfirmLoading=!1}):this.sendMessage("error","El usuario no tiene permisos para crear datos, favor de contactar al administrador."))}else console.error("currentUserSelected or uid is null or undefined")}submitFormProduct(){if(this.currentUserSelected&&this.currentUserSelected.uid){let t=this.currentUserSelected.uid;this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId);let r=this.validateForm.controls.amount.value,a=this.validateForm.controls.price.value,u=this.validateForm.controls.validTo.value,g=this.validateForm.controls.is_courtesy.value||!1;this.validateForm.controls.due_date.setValue(u.toISOString()),r!=a&&!g&&this.validateForm.controls.status.setValue("partial"),console.log(this.validateForm.valid),console.log(this.validateForm.value);for(let v in this.validateForm.controls)this.validateForm.controls[v].markAsDirty(),this.validateForm.controls[v].updateValueAndValidity();console.log("this.validateForm.value AQUI"),console.log(this.validateForm.value),this.validateForm.valid&&(this.isConfirmLoading=!0,this.userlevelAccess!="3"?this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.validateForm.value).then(v=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(v=>{this.isConfirmLoading=!1}):this.sendMessage("error","El usuario no tiene permisos para crear datos, favor de contactar al administrador."))}else console.error("currentUserSelected or uid is null or undefined")}handleOk(){this.isConfirmLoading=!0,setTimeout(()=>{this.isVisible=!1,this.isConfirmLoading=!1},3e3)}handleCancel(){this.isVisible=!1,this.isVisibleBulk=!1,this.isVisibleBulkCredentials=!1,this.isModalCredentialVisible=!1}handleCancelProduct(){this.isProductVisible=!1}getUsersList(){this.isLoadingUsers=!0,this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.usersCollection=this.afs.collection("users",t=>t.where("customerId","==",this.user.customerId).orderBy("displayName")),this.users=this.usersCollection.snapshotChanges().pipe(E(t=>t.map(r=>{let a=r.payload.doc.id,u=r.payload.doc.data();return T({id:a},u)}))).subscribe(t=>{this.loadUsers(t)})):(this.usersCollection=this.afs.collection("users",t=>t.orderBy("displayName")),this.users=this.usersCollection.snapshotChanges().pipe(E(t=>t.map(r=>{let a=r.payload.doc.id,u=r.payload.doc.data();return T({id:a},u)}))).subscribe(t=>{this.loadUsers(t)}))}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.afs.collection("customers",r=>r.where("customerId","==",this.user.customerId).orderBy("name")).snapshotChanges().pipe(D(this.stopSubscription$),E(r=>r.map(a=>{let u=a.payload.doc.id,g=a.payload.doc.data();return T({id:u},g)})),Q(r=>(this.customersList=r,r))).subscribe():this.afs.collection("customers",r=>r.orderBy("name")).snapshotChanges().pipe(D(this.stopSubscription$),E(r=>r.map(a=>{let u=a.payload.doc.id,g=a.payload.doc.data();return T({id:u},g)})),Q(r=>(this.customersList=r,r))).subscribe()}reassingBoardingPass(t,r){if(this.currentUserSelected&&this.currentUserSelected.uid)if(this.lastPurchase!==null&&this.lastPurchase!==void 0){let a=this.lastPurchase.id;this.afs.collection("users").doc(this.currentUserSelected.id).collection("boardingPasses").doc(this.lastPurchase.id).set(this.lastPurchase).then(g=>{this.afs.collection("users").doc(this.currentUserSelected.uid).collection("boardingPasses").doc(a).delete()})}else console.error("lastPurchase is null or undefined");else console.error("currentUserSelected or uid is null or undefined")}refreshList(){this.hasBeenLoaded=!1,this.getUsersList()}loadUsers(t){this.loadedDevicesList.length<=1&&(this.displayData=t,this.devicesList=t.slice().sort((r,a)=>r.displayName.localeCompare(a.displayName)),this.loadedDevicesList=this.devicesList)}getItems(t){this.initializeItems();let r=t;if(!r)return;let a=ve.toLower(r);this.devicesList=ve.filter(this.devicesList,function(u){return Object.values(u).some(function(g){return(0,Si.toLower)(g).includes(a)})})}initializeItems(){this.devicesList=this.loadedDevicesList}userSelected(t){if(this.currentUserSelected&&this.currentUserSelected.uid){let r=this.currentUserSelected.uid;this.lastPurchase!==null&&this.lastPurchase!==void 0?(this.currentUserSelected=t,this.currentSelectedCustomerId=this.currentUserSelected.customerId,this.accountId$.next(this.currentUserSelected.customerId),this.isUserSelected=!0,this.isBoardingPassSelected=!1,this.getLatestPurchases(t.uid),this.getUserCredentials(t.uid),this.getUserChatMessages(t.uid),this.lastPurchase=null):console.error("lastPurchase or date is null or undefined")}else console.error("currentUserSelected or uid is null or undefined")}boardingPassSelected(t){this.currentUserSelected&&(this.isBoardingPassSelected=!0,this.lastPurchase=t)}copyDataToUserCollection(){if(this.userlevelAccess!="3")if(this.currentUserSelected&&this.currentUserSelected.uid){let t=this.currentUserSelected.uid;this.customersService.saveOldBoardingPassToUserCollection(this.currentUserSelected.paymentId)}else console.error("currentUserSelected or uid is null or undefined");else this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}showDeleteConfirm(){if(this.currentUserSelected&&this.currentUserSelected.uid){let t=this.currentUserSelected.uid;this.modalService.confirm({nzTitle:"\xBFEst\xE1 seguro de eliminar esta cuenta?",nzContent:'<b style="color: red;">Toda la informaci\xF3n relacionada a esta cuenta ser\xE1 eliminada permanentemente.</b>',nzOkText:"Eliminar",nzOnOk:()=>{this.userlevelAccess=="1"?this.customersService.deleteUser(this.currentUserSelected.uid):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador."),this.currentUserSelected={token:null,uid:"",studentId:"",customerId:"",id:"",paymentId:"",disabled:!1,photoURL:"",displayName:"",emailVerified:!1,email:""},this.isUserSelected=!1},nzCancelText:"No",nzOnCancel:()=>console.log("Cancel")})}else console.error("currentUserSelected or uid is null or undefined")}getLastPurchase(t){this.loadingLastPurchase=!0,this.lastPurchase=null,this.customersService.getLastPurchase(t).valueChanges().subscribe(r=>{this.lastPurchase=r,this.loadingLastPurchase=!1},r=>{this.loadingLastPurchase=!1,this.lastPurchase=null})}activatePurchase(t,r){if(this.userlevelAccess!="3")if(this.currentUserSelected&&this.currentUserSelected.uid){let a=this.currentUserSelected.uid;this.customersService.activatePurchase(this.currentUserSelected.uid,t,r),this.currentUserSelected.paymentId=t}else console.error("currentUserSelected or uid is null or undefined");else this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}deletePurchase(t){this.userlevelAccess=="1"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.deletePurchase(this.currentUserSelected.uid,t),this.isBoardingPassSelected=!1):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}activateCredential(t,r){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.activateCredential(this.currentUserSelected.uid,t,r),this.currentUserSelected.paymentId=t):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}deleteCredential(t){this.userlevelAccess=="1"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.deleteCredential(this.currentUserSelected.uid,t),this.isBoardingPassSelected=!1):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}setUserDisabled(t){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.setUserDisabled(this.currentUserSelected.uid,t),this.currentUserSelected.disabled=t):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}getLatestPurchases(t){this.loadingLatestPurchases=!0,this.customersService.getLatestUserPurchases(t,10).pipe(E(r=>r.map(a=>{let u=a.payload.doc.id,g=a.payload.doc.data();return T({id:u},g)}))).subscribe(r=>{this.latestPurchases=r,this.loadingLatestPurchases=!1},r=>{this.latestPurchases=null,this.loadingLatestPurchases=!1})}getUserCredentials(t){this.loadingUserCredentials=!0,this.customersService.getUserCredentials(t).subscribe(r=>{this.userCredentials=r,this.loadingUserCredentials=!1},r=>{this.userCredentials=null,this.loadingUserCredentials=!1})}getUserChatMessages(t){this.loadingChatMessages=!0,this.dashboardService.getUserChatMessages(t,10).subscribe(r=>{this.userChatMessageData=r})}pre(){this.current-=1}next(){if(this.current+=1,console.log(Object.keys(this.mapOfCheckedId).length),this.current===2){let t=[];this.usersByAccount.forEach(r=>{this.mapOfCredentialsCheckedId[r.uid]===!0&&(console.log("selected user, ",r.firstName," ",r.uid),t.push(r))}),this.actualSelectedRows=t.length,this.selectedUsersForCredentials=t}}done(){this.isVisibleBulk=!1,this.isVisibleBulkCredentials=!1,setTimeout(()=>{this.current=0,this.isDone=!0},500)}createMultipleBoardingPasses(){this.isCreatingBoardingPasses=!0,setTimeout(()=>{this.isCreatingBoardingPasses=!1,this.isDone=!0},2e3)}currentPageDataChange(t){this.listOfDisplayData=t,this.refreshStatus()}refreshStatus(){this.isAllDisplayDataChecked=this.devicesList.every(t=>this.mapOfCheckedId[t.id]),this.isIndeterminate=this.devicesList.some(t=>this.mapOfCheckedId[t.id])&&!this.devicesList}checkAllData(t){this.devicesList.forEach(r=>this.mapOfCheckedId[r.id]=t)}currentCredentialsPageDataChange(t){this.listOfCredentialsDisplayData=t,this.refreshCredentialsStatus()}refreshCredentialsStatus(){this.isCredentialsAllDisplayDataChecked=this.usersByAccount.every(t=>this.mapOfCredentialsCheckedId[t.uid]),this.isCredentialsIndeterminate=this.usersByAccount.some(t=>this.mapOfCredentialsCheckedId[t.uid])&&!this.usersByAccount}checkCredentialsAllData(t){this.usersByAccount.forEach(r=>this.mapOfCredentialsCheckedId[r.uid]=t)}checkCredentialsValidBoardingPass(t){this.usersByAccount.forEach(r=>{this.customersService.getLatestValidUserPurchases(r.uid).pipe(Ft(1),E(a=>a.map(u=>{let g=u.payload.doc.id,v=u.payload.doc.data();return T({id:g},v)})),Q(a=>{console.log(r.displayName," has a valid BPass ?",a.length),this.mapOfCredentialsCheckedId[r.uid]=a.length>0})).subscribe()})}downloadImg(){let t=document.getElementById("download")?.querySelector("canvas");if(t){this.download.nativeElement.href=t.toDataURL("image/png"),this.download.nativeElement.download="ng-zorro-antd";let r=new MouseEvent("click");this.download.nativeElement.dispatchEvent(r)}}createMultipleCredentials(){this.current++;let t=this.credentialForm.controls.validFrom.value||new Date,r=this.credentialForm.controls.validTo.value||new Date,a=this.credentialForm.controls.active.value||!1;this.userlevelAccess!="3"?(this.isCreatingCredentials=!0,this.selectedUsersForCredentials.forEach(u=>{this.customersService.createCredential(u.uid,u.studentId,t,r,a).then(g=>{console.log(g)})}),this.isCreatingCredentials=!1,this.isDone=!0):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}};d.\u0275fac=function(r){return new(r||d)(P(nt),P(lt),P(be),P(ne))},d.\u0275cmp=B({type:d,selectors:[["app-dashboard"]],viewQuery:function(r,a){if(r&1&&(He(Fi,5),He(Ni,5)),r&2){let u;Ge(u=Qe())&&(a.download=u.first),Ge(u=Qe())&&(a.searchbar=u.first)}},decls:73,vars:37,consts:[["menu","nzDropdownMenu"],["menuCredentials","nzDropdownMenu"],["searchBar",""],["basicTable",""],["modalTitle",""],["modalContent",""],["modalFooter",""],["modalTitleProduct",""],["modalContentProduct",""],["modalContentBulk",""],["modalFooterBulk",""],["modalTitleBulkCredentials",""],["modalContentBulkCredentials",""],["modalFooterBulkCredentials",""],["modalTitleUserCredential",""],["modalContentCredential",""],["modalFooterCredential",""],["chatSetting","nzDropdownMenu"],["footerTemplate",""],["credentialFooterTemplate",""],["basicChatData",""],["messageCenterFooterTemplate",""],["credentials","nzDropdownMenu"],["download",""],["rowSelectionTable",""],[2,"margin","buttom 15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],["nz-button","","nzNoAnimation","","nz-dropdown","",2,"background-color","#4F6F57","color","#f6f3ea",3,"nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"hidden","click",4,"ngFor","ngForOf"],[1,"container-fluid","p-h-0"],[1,"chat-list"],[1,"chat-user-tool"],["nz-icon","","nzTheme","outline",1,"search-icon","p-r-10","font-size-20"],["placeholder","Buscar",3,"keyup"],[1,"chat-user-list"],[3,"nzData","nzShowPagination","nzPageSize"],[3,"click",4,"ngFor","ngForOf"],[1,"chat-content",3,"ngClass"],[1,"conversation"],[1,"conversation-wrapper"],["class","conversation-header justify-content-between",4,"ngIf"],[1,"conversation-body"],["style","width: 100% !important; overflow-y: scroll !important;",4,"ngIf"],[2,"background-color","white","color","#4F6F57",3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter"],["class","conversation-footer",4,"ngIf"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzWidth","nzTitle","nzContent","nzFooter"],["nz-menu-item","",3,"click","hidden"],[3,"click"],[1,"media","align-items-center"],["nzShape","square","nzSize","default","nzIcon","user",1,"shadow",2,"background-color","white","color","#4F6F57",3,"nzSrc"],[1,"p-l-15"],[1,"m-b-0"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436",4,"ngIf"],[1,"msg-overflow","m-b-0","text-muted","font-size-13"],[3,"nzStatus"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436"],[1,"conversation-header","justify-content-between"],[1,"m-r-20","d-md-none","d-block","text-dark","font-size-18","m-t-5",3,"routerLink"],["nz-icon","","type","left-circle","theme","outline"],["nzShape","square","nzIcon","user",1,"shadow",2,"background-color","white","color","#4F6F57",3,"nzSrc"],[1,"m-b-0","text-muted","font-size-13"],["nz-dropdown","","nzPlacement","bottomRight",1,"text-dark","font-size-18",3,"nzDropdownMenu","nzTrigger"],["nz-icon","","theme","outline"],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item","",3,"click"],[2,"width","100% !important","overflow-y","scroll !important"],["nzTitle","Pases"],[3,"nzData","nzPageSize","nzFooter","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Credenciales"],["nzTitle","Otras compras"],["nzTitle","Mensajes"],[3,"nzData","nzPageSize","nzFooter","nzLoadingDelay"],[2,"color","#4F6F57"],[4,"ngFor","ngForOf"],[3,"nzData","nzPageSize","nzFooter","nzLoading","nzLoadingDelay"],[3,"nzColor"],["nz-text","","nzType","secondary"],[3,"nzColor",4,"ngIf"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzTheme","outline"],["nz-button","",1,"m-r-10",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nz-icon",""],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nz-text","","nzType","secondary",4,"ngIf"],["nzPlain","","nzText","Mensaje"],["rows","4","nz-input","","placeholder","Mensaje",3,"ngModelChange","ngModel"],["nz-form","","nzLayout","horizontal",2,"background-color","white","color","#4F6F57",3,"ngSubmit","formGroup"],["formControlName","product_id","nzAllowClear","","nzPlaceHolder","Seleccionar producto / servicio",2,"width","320px",3,"ngModelChange"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","320px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","stopId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",2,"width","320px",3,"ngModelChange"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","200px"],["nzValue","D\xEDa","nzLabel","D\xEDa"],["nzValue","Tarde","nzLabel","Tarde"],["nzValue","Noche","nzLabel","Noche"],[1,"row"],[1,"col-md-6"],["formControlName","amount",3,"ngModelChange","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["formControlName","is_courtesy","nzCheckedChildren","Si","nzUnCheckedChildren","No",3,"ngModelChange"],["nz-checkbox","","formControlName","active"],["formControlName","validFrom"],["formControlName","validTo"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","nzLoading"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngIf"],[1,"conversation-footer"],["nzTitle","Detalles"],["nzBordered","","nzSize","small"],["nzTitle","Producto"],["nzTitle","Pagado"],["nzStatus","success","nzText","Si",4,"ngIf"],["nzStatus","processing","nzText","Parcial",4,"ngIf"],["nzStatus","warning","nzText","No",4,"ngIf"],["nzTitle","Activo"],["nzStatus","processing","nzText","Si",4,"ngIf"],["nzTitle","Fecha de compra"],["nzTitle","M\xE9todo de pago",4,"ngIf"],["nzTitle","Pase Cortes\xEDa"],["nzTitle","Valido desde"],["nzTitle","Valido hasta"],[3,"ngModel","ngModelChange",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEst\xE1s seguro de modificar la vigencia?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],["nzTitle","Servicio"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","lastPurchase!.isTaskIn ? '#52c41a' : '#595959'"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","lastPurchase!.isTaskOut ? '#52c41a' : '#595959'"],["nzTitle","Precio"],["nz-popconfirm","","nzPopconfirmTitle","\xBFVas a recibir dinero?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],[3,"ngModel","nzMin","nzMax","nzStep","nzFormatter","nzParser","ngModelChange",4,"ngIf"],["nzTitle","Autorizaci\xF3n"],["nzTitle","Operaci\xF3n"],["nzTitle","Estaci\xF3n"],["nzTitle","Turno"],["nzTitle","Informaci\xF3n de la compra"],["nzTitle","Historial de Uso"],[3,"userId","boardingPassId"],["nzTitle","C\xF3digo QR"],["nzValue","currentUserSelected.uid-lastPurchase!.idBoardingPass"],["nz-button","","nzType","primary",3,"click"],["nzTitle","Soporte"],["nzStatus","success","nzText","Si"],["nzStatus","processing","nzText","Parcial"],["nzStatus","warning","nzText","No"],["nzStatus","processing","nzText","Si"],["nzTitle","M\xE9todo de pago"],[3,"ngModelChange","ngModel"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEst\xE1s seguro de modificar la vigencia?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel"],["nz-popconfirm","","nzPopconfirmTitle","\xBFVas a recibir dinero?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel"],[3,"ngModelChange","ngModel","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["nzSize","small",3,"nzCurrent"],["nzTitle","Pase","nzDescription","Crear el pase."],["nzTitle","Empresas","nzDescription","Seleccionar las Empresas."],["nzTitle","Confirmar","nzDescription","Validar la creaci\xF3n."],[1,"steps-content","overflow-auto"],[4,"ngIf"],["nzShowSizeChanger","",3,"nzCurrentPageDataChange","nzData","nzSize"],["nzShowCheckbox","","nzShowRowSelection","",3,"nzCheckedChange","nzSelections","nzChecked","nzIndeterminate"],["nzShowCheckbox","",3,"nzCheckedChange","nzChecked"],[1,"steps-action"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"disabled","click",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"nzLoading","click",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"click",4,"ngIf"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","disabled"],["nzTitle","Credencial","nzDescription","Crear la credencial."],["nzTitle","Usuarios","nzDescription","Seleccionar los usuarios."],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"disabled","nzLoading","click",4,"ngIf"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","disabled","nzLoading"]],template:function(r,a){if(r&1){let u=x();i(0,"div",25)(1,"div",26)(2,"nz-page-header",27)(3,"nz-page-header-title"),l(4,"Empresas"),o(),i(5,"nz-page-header-subtitle"),l(6,"Listado general"),o(),i(7,"nz-page-header-extra")(8,"button",28),l(9," M\xFAltiples pases "),o(),i(10,"nz-dropdown-menu",null,0)(12,"ul",29),z(13,Oi,2,2,"li",30),o()(),i(14,"button",28),l(15," M\xFAltiples credenciales "),o(),i(16,"nz-dropdown-menu",null,1)(18,"ul",29),z(19,Ui,2,2,"li",30),o()()()()(),i(20,"div",31)(21,"div",32)(22,"div",33),p(23,"i",34),i(24,"input",35,2),f("keyup",function(){_(u);let v=y(25);return h(a.getItems(v.value))}),o()(),i(26,"div",36)(27,"nz-table",37,3)(29,"tbody"),z(30,Ri,16,7,"tr",38),o()()()(),i(31,"div",39)(32,"div",40)(33,"div",41),z(34,ji,23,11,"div",42),i(35,"div",43),z(36,ln,24,7,"nz-tabset",44),i(37,"nz-modal",45),N("nzVisibleChange",function(v){return _(u),F(a.isVisible,v)||(a.isVisible=v),h(v)}),f("nzOnCancel",function(){return _(u),h(a.handleCancel())}),z(38,cn,1,0,"ng-template",null,4,w)(40,un,49,9,"ng-template",null,5,w)(42,_n,4,1,"ng-template",null,6,w),o(),i(44,"nz-modal",46),N("nzVisibleChange",function(v){return _(u),F(a.isProductVisible,v)||(a.isProductVisible=v),h(v)}),f("nzOnCancel",function(){return _(u),h(a.handleCancelProduct())}),z(45,hn,1,0,"ng-template",null,7,w)(47,zn,32,7,"ng-template",null,8,w)(49,Cn,4,1,"ng-template",null,6,w),o()(),z(51,kn,61,40,"div",47),o()()()()(),i(52,"nz-modal",46),N("nzVisibleChange",function(v){return _(u),F(a.isVisibleBulk,v)||(a.isVisibleBulk=v),h(v)}),f("nzOnCancel",function(){return _(u),h(a.handleCancel())}),z(53,Fn,1,0,"ng-template",null,4,w)(55,Wn,9,4,"ng-template",null,9,w)(57,Jn,5,4,"ng-template",null,10,w),o(),i(59,"nz-modal",48),N("nzVisibleChange",function(v){return _(u),F(a.isVisibleBulkCredentials,v)||(a.isVisibleBulkCredentials=v),h(v)}),f("nzOnCancel",function(){return _(u),h(a.handleCancel())}),z(60,Yn,1,0,"ng-template",null,11,w)(62,or,10,5,"ng-template",null,12,w)(64,dr,5,4,"ng-template",null,13,w),o(),i(66,"nz-modal",48),N("nzVisibleChange",function(v){return _(u),F(a.isModalCredentialVisible,v)||(a.isModalCredentialVisible=v),h(v)}),f("nzOnCancel",function(){return _(u),h(a.handleCancel())}),z(67,mr,1,0,"ng-template",null,14,w)(69,pr,18,1,"ng-template",null,15,w)(71,ur,3,2,"ng-template",null,16,w),o()}if(r&2){let u=y(11),g=y(17),v=y(28),I=y(39),X=y(41),M=y(43),J=y(46),ge=y(48),Xe=y(56),Je=y(58),Ct=y(63),$e=y(65),Ye=y(70),vt=y(72);s(2),c("nzGhost",!1),s(6),c("nzDropdownMenu",u),s(5),c("ngForOf",a.customersList),s(),c("nzDropdownMenu",g),s(5),c("ngForOf",a.customersList),s(8),c("nzData",a.devicesList)("nzShowPagination",!1)("nzPageSize",10),s(3),c("ngForOf",v.data),s(),c("ngClass",q(35,Mi,a.isContentOpen)),s(3),c("ngIf",a.isUserSelected),s(2),c("ngIf",a.isUserSelected),s(),k("nzVisible",a.isVisible),c("nzTitle",I)("nzContent",X)("nzFooter",M),s(7),k("nzVisible",a.isProductVisible),c("nzTitle",J)("nzContent",ge)("nzFooter",M),s(7),c("ngIf",a.isBoardingPassSelected),s(),k("nzVisible",a.isVisibleBulk),c("nzTitle","Emitir m\xFAltiples pases")("nzContent",Xe)("nzFooter",Je),s(7),k("nzVisible",a.isVisibleBulkCredentials),c("nzWidth",800)("nzTitle","Emitir m\xFAltiples credenciales")("nzContent",Ct)("nzFooter",$e),s(7),k("nzVisible",a.isModalCredentialVisible),c("nzWidth",800)("nzTitle","Emitir credencial")("nzContent",Ye)("nzFooter",vt)}},dependencies:[et,$,Y,Qt,j,ae,oe,le,se,de,ce,ye,ti,Xt,Ue,Me,Le,Jt,Re,Oe,Ae,Yt,Te,me,si,ci,li,di,ut,pi,mi,ue,pe,Ie,De,_e,Gt,G,W,H,Pe,ct,dt,mt,Be,he,fe,it,ee,Se,K,Z,te,ie,Bt,Fe,ke,oi,pt,ui,Ut,tt],styles:[".conversation-footer[_ngcontent-%COMP%]{height:450px!important}[_nghost-%COMP%]{background-color:#fff;color:#4f6f57}.ant-modal-content[_ngcontent-%COMP%]{background-color:#fff;color:#4f6f57}.ant-modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#4f6f57;color:#f6f3ea}"]});let n=d;return n})();var bi=(()=>{let d=class d{constructor(){this.isMenuFolded=!1,this.isSideNavDark=!1,this.headerColor="default",this.colorConfig={colors:{magenta:"#eb2f96",magentaLight:"rgba(235, 47, 150, 0.05)",red:"#de4436",redLight:"rgba(222, 68, 54, 0.05)",volcano:"#fa541c",volcanoLight:"rgba(250, 84, 28, 0.05)",orange:"#fa8c16",orangeLight:"rgba(250, 140, 22, 0.1)",gold:"#ffc107",goldLight:"rgba(255, 193, 7, 0.1)",lime:"#a0d911",limeLight:"rgba(160, 217, 17, 0.1)",green:"#52c41a",greenLight:"rgba(82, 196, 26, 0.1)",cyan:"#05c9a7",cyanLight:"rgba(0, 201, 167, 0.1)",blue:"#3f87f5",blueLight:"rgba(63, 135, 245, 0.15)",geekBlue:"#2f54eb",geekBlueLight:"rgba(47, 84, 235, 0.1)",purple:"#886cff",purpleLight:"rgba(136, 108, 255, 0.1)",gray:"#53535f",grayLight:"#77838f",grayLighter:"#ededed",grayLightest:"#f1f2f3",border:"#edf2f9",white:"#ffffff",dark:"#2a2a2a",transparent:"rgba(255, 255, 255, 0)"}},this.isMenuFoldedActived=new je(this.isMenuFolded),this.isMenuFoldedChanges=this.isMenuFoldedActived.asObservable(),this.isSideNavDarkActived=new je(this.isSideNavDark),this.isSideNavDarkChanges=this.isSideNavDarkActived.asObservable(),this.isExpandActived=new je(!1),this.isExpandChanges=this.isExpandActived.asObservable(),this.currentHeaderColor=new je(this.headerColor),this.selectedHeaderColor=this.currentHeaderColor.asObservable()}get(){return this.colorConfig}toggleFold(t){this.isMenuFoldedActived.next(t)}toogleSideNavDark(t){this.isSideNavDarkActived.next(t)}toggleExpand(t){this.isExpandActived.next(t)}changeHeaderColor(t){this.currentHeaderColor.next(t)}};d.\u0275fac=function(r){return new(r||d)},d.\u0275prov=Ze({token:d,factory:d.\u0275fac});let n=d;return n})();var yi=(()=>{let d=class d{constructor(t){this.http=t}getFileManagerJson(){return!0}};d.\u0275fac=function(r){return new(r||d)(Nt(At))},d.\u0275prov=Ze({token:d,factory:d.\u0275fac});let n=d;return n})();var gr=["dropdown"],zr=n=>({"nav-open":n}),wi=n=>({"list-view":n}),Cr=n=>({"details-open":n}),Ti=n=>({active:n}),vr=n=>({"border-bottom":n});function xr(n,d){if(n&1){let e=x();i(0,"i",53),f("click",function(){_(e);let r=m();return h(r.navToggler())}),o()}}function Sr(n,d){if(n&1){let e=x();i(0,"i",54),f("click",function(){_(e);let r=m();return h(r.navToggler())}),o()}}function br(n,d){if(n&1){let e=x();i(0,"a",55),f("click",function(){_(e);let r=m();return h(r.changeView())}),p(1,"i",56),o()}}function yr(n,d){if(n&1){let e=x();i(0,"a",57),f("click",function(){_(e);let r=m();return h(r.changeView())}),p(1,"i",58),o()}}function wr(n,d){if(n&1){let e=x();i(0,"div",60),f("click",function(){_(e);let r=m().$implicit,a=m();return h(a.selectFile(a.selected=r.name))})("contextmenu",function(r){_(e);let a=m().$implicit,u=m(),g=y(64);return h(u.contextMenu(r,g,u.selected=a.name))}),i(1,"div",61)(2,"div",62),p(3,"i",63),o(),i(4,"div")(5,"h6",64),l(6),o(),i(7,"span",65),l(8),o()()()()}if(n&2){let e=m().$implicit,t=m();c("ngClass",q(4,Ti,t.selectedFile==e.name)),s(3),c("twoToneColor",t.colorGold),s(3),S(e.name),s(2),S(e.size)}}function Tr(n,d){if(n&1&&(ze(0),z(1,wr,9,6,"div",59),Ce()),n&2){let e=d.$implicit;s(),c("ngIf",e.type=="folder")}}function Er(n,d){if(n&1&&p(0,"i",76),n&2){let e=m(3);c("twoToneColor",e.colorRed)}}function Vr(n,d){if(n&1&&p(0,"i",77),n&2){let e=m(3);c("twoToneColor",e.colorBlue)}}function Ir(n,d){if(n&1&&p(0,"i",78),n&2){let e=m(3);c("twoToneColor",e.colorCyan)}}function Dr(n,d){if(n&1&&p(0,"i",79),n&2){let e=m(3);c("twoToneColor",e.colorVolcano)}}function Pr(n,d){if(n&1&&p(0,"i",80),n&2){let e=m(3);c("twoToneColor",e.colorPurple)}}function kr(n,d){if(n&1&&p(0,"img",81),n&2){let e=m(2).$implicit;c("src",e.url,xt)}}function Fr(n,d){if(n&1){let e=x();i(0,"div",67),f("click",function(){_(e);let r=m().$implicit,a=m();return h(a.selectFile(a.selected=r.name))})("contextmenu",function(r){_(e);let a=m().$implicit,u=m(),g=y(64);return h(u.contextMenu(r,g,u.selected=a.name))}),i(1,"div",68),z(2,Er,1,1,"i",69)(3,Vr,1,1,"i",70)(4,Ir,1,1,"i",71)(5,Dr,1,1,"i",72)(6,Pr,1,1,"i",73)(7,kr,1,1,"img",74),o(),i(8,"div",75)(9,"h6",64),l(10),o(),i(11,"span",65),l(12),o()()()}if(n&2){let e=m().$implicit,t=m();c("ngClass",q(9,Ti,t.selectedFile==e.name)),s(2),c("ngIf",e.type=="pdf"),s(),c("ngIf",e.type=="doc"),s(),c("ngIf",e.type=="xls"),s(),c("ngIf",e.type=="ppt"),s(),c("ngIf",e.type=="txt"),s(),c("ngIf",e.type=="image"),s(3),S(e.name),s(2),S(e.size)}}function Nr(n,d){if(n&1&&(ze(0),z(1,Fr,13,11,"div",66),Ce()),n&2){let e=d.$implicit;s(),c("ngIf",e.type!=="folder")}}function Mr(n,d){if(n&1&&p(0,"i",63),n&2){let e=m(4);c("twoToneColor",e.colorGold)}}function Lr(n,d){if(n&1&&p(0,"i",76),n&2){let e=m(4);c("twoToneColor",e.colorRed)}}function Or(n,d){if(n&1&&p(0,"i",77),n&2){let e=m(4);c("twoToneColor",e.colorBlue)}}function Ur(n,d){if(n&1&&p(0,"i",78),n&2){let e=m(4);c("twoToneColor",e.colorCyan)}}function Ar(n,d){if(n&1&&p(0,"i",79),n&2){let e=m(4);c("twoToneColor",e.colorVolcano)}}function Rr(n,d){if(n&1&&p(0,"i",80),n&2){let e=m(4);c("twoToneColor",e.colorPurple)}}function Br(n,d){if(n&1&&(i(0,"div",102),z(1,Mr,1,1,"i",103)(2,Lr,1,1,"i",69)(3,Or,1,1,"i",70)(4,Ur,1,1,"i",71)(5,Ar,1,1,"i",72)(6,Rr,1,1,"i",73),o()),n&2){let e=m(2).$implicit;s(),c("ngIf",e.type=="folder"),s(),c("ngIf",e.type=="pdf"),s(),c("ngIf",e.type=="doc"),s(),c("ngIf",e.type=="xls"),s(),c("ngIf",e.type=="ppt"),s(),c("ngIf",e.type=="txt")}}function qr(n,d){if(n&1&&p(0,"img",104),n&2){let e=m(2).$implicit;c("src",e.url,xt)}}function $r(n,d){n&1&&p(0,"nz-avatar",119)}function jr(n,d){n&1&&p(0,"nz-avatar",120)}function Wr(n,d){n&1&&p(0,"nz-avatar",121)}function Hr(n,d){n&1&&p(0,"nz-avatar",122)}function Gr(n,d){n&1&&p(0,"nz-avatar",123)}function Qr(n,d){if(n&1&&(i(0,"li",113),z(1,$r,1,0,"nz-avatar",114)(2,jr,1,0,"nz-avatar",115)(3,Wr,1,0,"nz-avatar",116)(4,Hr,1,0,"nz-avatar",117)(5,Gr,1,0,"nz-avatar",118),i(6,"span",14),l(7),o()()),n&2){let e=d.$implicit;s(),c("ngIf",e.substr(e.length-3)=="pdf"),s(),c("ngIf",e.substr(e.length-3)=="doc"),s(),c("ngIf",e.substr(e.length-3)=="xls"),s(),c("ngIf",e.substr(e.length-3)=="ppt"),s(),c("ngIf",e.substr(e.length-3)=="jpg"||e.substr(e.length-3)=="png"),s(2),S(e)}}function Xr(n,d){if(n&1&&(i(0,"div",105)(1,"div",106)(2,"div",107),p(3,"nz-avatar",108),i(4,"div",14)(5,"span",109),l(6),o(),i(7,"span"),l(8),o(),i(9,"span"),l(10),o(),i(11,"div",110),l(12),o()()(),i(13,"ul",111),z(14,Qr,8,6,"li",112),o()()()),n&2){let e=d.$implicit,t=d.last;s(),c("ngClass",q(8,vr,!t)),s(2),c("nzSrc",e.avatar),s(3),b("",e.name," "),s(2),b("",e.action," "),s(2),L("",e.files.length," ",e.text,""),s(2),b(" ",e.time," "),s(2),c("ngForOf",e.files)}}function Jr(n,d){if(n&1){let e=x();i(0,"div")(1,"div",83)(2,"h5",84),l(3),o(),i(4,"div",85)(5,"a",86),f("click",function(){_(e);let r=m(2);return h(r.closeContentDetails())}),p(6,"i",87),o()()(),i(7,"div",88),z(8,Br,7,6,"div",89)(9,qr,1,1,"img",90),o(),i(10,"nz-tabset")(11,"nz-tab",91)(12,"div",92)(13,"dl",93)(14,"dt",94),l(15,"Type:"),o(),i(16,"dd",95),l(17),o()(),i(18,"dl",93)(19,"dt",94),l(20,"Size:"),o(),i(21,"dd",95),l(22),o()(),i(23,"dl",93)(24,"dt",94),l(25,"Modified:"),o(),i(26,"dd",95),l(27),o()(),i(28,"dl",93)(29,"dt",94),l(30,"Created:"),o(),i(31,"dd",95),l(32),o()(),i(33,"dl",93)(34,"dt",94),l(35,"Author:"),o(),i(36,"dd",95),l(37),o()()(),i(38,"div",96)(39,"span",97),l(40,"Add Description"),o(),i(41,"button",98),p(42,"i",45),o()()(),i(43,"nz-tab",99)(44,"div",100),z(45,Xr,15,10,"div",101),o()()()()}if(n&2){let e=m().$implicit;s(3),S(e.name),s(5),c("ngIf",e.type!=="image"),s(),c("ngIf",e.type=="image"),s(8),S(e.type),s(5),S(e.size),s(5),S(e.modifiedDate),s(5),S(e.date),s(5),S(e.author),s(8),c("ngForOf",e.activity)}}function Yr(n,d){if(n&1&&(ze(0),z(1,Jr,46,9,"div",82),Ce()),n&2){let e=d.$implicit,t=m();s(),c("ngIf",t.selectedFile==e.name)}}function Kr(n,d){n&1&&(i(0,"div",124)(1,"div",125),p(2,"img",126),i(3,"p",127),l(4,"Select folder or file to view details"),o()()())}var ca=(()=>{let d=class d{constructor(t,r){this.colorConfig=t,this.fileManagerSvc=r,this.selected=null,this.themeColors=this.colorConfig.get().colors,this.selectedFile="",this.listView=!1,this.isDetailsOpen=!1,this.isNavOpen=!1,this.colorRed=this.themeColors.red,this.colorBlue=this.themeColors.blue,this.colorCyan=this.themeColors.cyan,this.colorGold=this.themeColors.gold,this.colorVolcano=this.themeColors.volcano,this.colorPurple=this.themeColors.purple}ngOnInit(){}changeView(){this.listView=!this.listView}contextMenu(t,r,a){t.preventDefault(),this.selectedFile=r,this.isDetailsOpen=!0,this.dropdown.nzVisible=!0}selectFile(t){this.selectedFile=t,this.isDetailsOpen=!0}unselectFile(){this.selectedFile=""}close(){}closeContentDetails(){this.isDetailsOpen=!1}navToggler(){this.isNavOpen=!this.isNavOpen}};d.\u0275fac=function(r){return new(r||d)(P(bi),P(yi))},d.\u0275cmp=B({type:d,selectors:[["app-payments"]],viewQuery:function(r,a){if(r&1&&He(gr,5),r&2){let u;Ge(u=Qe())&&(a.dropdown=u.first)}},decls:95,vars:22,consts:[["contextDropdownTpl","nzDropdownMenu"],[1,"file-manager-wrapper"],[1,"file-manager-nav",3,"ngClass"],[1,"d-flex","flex-column","justify-content-between","h-100"],[1,"p-t-20"],["nz-menu","",3,"nzMode"],["nz-menu-item",""],["nz-icon","","type","folder-open","theme","outline",1,"text-primary"],["nz-icon","","type","clock-circle","theme","outline",1,"text-primary"],["nz-icon","","type","share-alt","theme","outline",1,"text-primary"],["nz-icon","","type","star","theme","outline",1,"text-primary"],["nz-icon","","type","delete","theme","outline",1,"text-primary"],[1,"m-b-30","m-h-25"],[1,"d-flex","justify-content-between"],[1,"text-gray"],["nzSize","small",3,"nzPercent"],[1,"m-t-15"],["nz-button","","nzBlock","",2,"background-color","#4F6F57","color","#f6f3ea"],["nz-icon","","type","upload","theme","outline"],[1,"m-l-5"],[1,"file-manager-content"],[1,"file-manager-content-header"],[1,"file-manager-search"],["nz-icon","","type","menu-fold","theme","outline","class","toggle-icon",3,"click",4,"ngIf"],["nz-icon","","type","menu-unfold","theme","outline","class","toggle-icon",3,"click",4,"ngIf"],["nz-icon","","type","search","theme","outline",1,"search-icon"],["placeholder","Search..."],[1,"file-manager-tools"],[1,"list-inline","m-b-0"],[1,"list-inline-item"],["zAction","/api/posts/"],["nz-tooltip","","nzPlacement","bottom","nzTitle","Add Files",1,"text-dark"],["nz-icon","","type","file-add","theme","outline"],["class","text-dark","nz-tooltip","","nzPlacement","bottom","nzTitle","List View",3,"click",4,"ngIf"],["class","text-dark","nz-tooltip","","nzPlacement","bottom","nzTitle","Column View",3,"click",4,"ngIf"],["nz-tooltip","","nzPlacement","bottom","nzTitle","Setting",1,"text-dark"],["nz-icon","","type","setting","theme","outline"],[1,"file-manager-content-body"],[1,"file-manager-content-files"],[1,"unselect-bg",3,"click"],[1,"relative"],[1,"file-wrapper","m-t-20",3,"ngClass"],[4,"ngFor","ngForOf"],["nz-menu","","nzInDropDown","",3,"nzClick"],["nz-icon","","type","user-add","theme","outline"],["nz-icon","","type","edit","theme","outline"],["nz-icon","","type","star","theme","outline"],["nz-menu-divider",""],["nz-icon","","type","download","theme","outline"],["nz-icon","","type","delete","theme","outline"],[1,"m-t-60","relative"],[1,"file-manager-content-details",3,"ngClass"],["class","content-details-no-data",4,"ngIf"],["nz-icon","","type","menu-fold","theme","outline",1,"toggle-icon",3,"click"],["nz-icon","","type","menu-unfold","theme","outline",1,"toggle-icon",3,"click"],["nz-tooltip","","nzPlacement","bottom","nzTitle","List View",1,"text-dark",3,"click"],["nz-icon","","type","bars","theme","outline"],["nz-tooltip","","nzPlacement","bottom","nzTitle","Column View",1,"text-dark",3,"click"],["nz-icon","","type","appstore","theme","outline"],["class","file",3,"ngClass","click","contextmenu",4,"ngIf"],[1,"file",3,"click","contextmenu","ngClass"],[1,"media","align-items-center"],[1,"m-r-15","font-size-30"],["nz-icon","","type","folder-open","theme","twotone",3,"twoToneColor"],[1,"mb-0"],[1,"font-size-13","text-muted"],["class","file vertical",3,"ngClass","click","contextmenu",4,"ngIf"],[1,"file","vertical",3,"click","contextmenu","ngClass"],[1,"font-size-40"],["nz-icon","","type","file-pdf","theme","twotone",3,"twoToneColor",4,"ngIf"],["nz-icon","","type","file-word","theme","twotone",3,"twoToneColor",4,"ngIf"],["nz-icon","","type","file-excel","theme","twotone",3,"twoToneColor",4,"ngIf"],["nz-icon","","type","file-ppt","theme","twotone",3,"twoToneColor",4,"ngIf"],["nz-icon","","type","file-text","theme","twotone",3,"twoToneColor",4,"ngIf"],["alt","",3,"src",4,"ngIf"],[1,"m-t-10"],["nz-icon","","type","file-pdf","theme","twotone",3,"twoToneColor"],["nz-icon","","type","file-word","theme","twotone",3,"twoToneColor"],["nz-icon","","type","file-excel","theme","twotone",3,"twoToneColor"],["nz-icon","","type","file-ppt","theme","twotone",3,"twoToneColor"],["nz-icon","","type","file-text","theme","twotone",3,"twoToneColor"],["alt","",3,"src"],[4,"ngIf"],[1,"p-h-25","p-v-15","d-flex","justify-content-between","align-items-center","border-bottom"],[1,"m-b-0"],[1,"content-details-close"],[1,"text-dark",3,"click"],["nz-icon","","type","right-circle","theme","outline"],[1,"m-b-10"],["class","d-flex justify-content-around display-3 align-items-center content-details-file",4,"ngIf"],["class","img-fluid","alt","",3,"src",4,"ngIf"],["nzTitle","Details"],[1,"p-h-25","p-v-15"],[1,"row","m-b-10"],[1,"col-5","text-dark"],[1,"col-7"],[1,"border-top","border-bottom","p-h-25","p-v-10","d-flex","align-items-center"],[1,"text-dark","font-weight-semibold","m-r-10"],["nz-button","","nzShape","circle","nzGhost","",2,"background-color","#4F6F57","color","#f6f3ea"],["nzTitle","Activity"],[1,"p-h-20","p-v-15"],["class","m-b-25",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-around","display-3","align-items-center","content-details-file"],["nz-icon","","type","folder-open","theme","twotone",3,"twoToneColor",4,"ngIf"],["alt","",1,"img-fluid",3,"src"],[1,"m-b-25"],[1,"p-b-10",3,"ngClass"],[1,"d-flex","align-items-center"],["nzIcon","user",1,"m-r-10",3,"nzSrc"],[1,"text-dark","font-weight-semibold"],[1,"text-muted","font-size-13"],[1,"list-unstyled","m-l-50","m-t-15"],["class","m-b-15",4,"ngFor","ngForOf"],[1,"m-b-15"],["nzIcon","file-pdf","nzSize","small","class","ant-avatar-red m-r-10",4,"ngIf"],["nzIcon","file-word","nzSize","small","class","ant-avatar-blue m-r-10",4,"ngIf"],["nzIcon","file-excel","nzSize","small","class","ant-avatar-cyan m-r-10",4,"ngIf"],["nzIcon","file-ppt","nzSize","small","class","ant-avatar-volcano m-r-10",4,"ngIf"],["nzIcon","picture","nzSize","small","class","ant-avatar-purple m-r-10",4,"ngIf"],["nzIcon","file-pdf","nzSize","small",1,"ant-avatar-red","m-r-10"],["nzIcon","file-word","nzSize","small",1,"ant-avatar-blue","m-r-10"],["nzIcon","file-excel","nzSize","small",1,"ant-avatar-cyan","m-r-10"],["nzIcon","file-ppt","nzSize","small",1,"ant-avatar-volcano","m-r-10"],["nzIcon","picture","nzSize","small",1,"ant-avatar-purple","m-r-10"],[1,"content-details-no-data"],[1,"text-center"],["src","assets/images/others/file-manager.png","alt","",1,"img-fluid","opacity-04"],[1,"text-muted","m-t-20"]],template:function(r,a){if(r&1){let u=x();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"ul",5)(5,"li",6),p(6,"i",7),i(7,"span"),l(8,"My Files"),o()(),i(9,"li",6),p(10,"i",8),i(11,"span"),l(12,"Recent"),o()(),i(13,"li",6),p(14,"i",9),i(15,"span"),l(16,"Shared with me"),o()(),i(17,"li",6),p(18,"i",10),i(19,"span"),l(20,"Favorite"),o()(),i(21,"li",6),p(22,"i",11),i(23,"span"),l(24,"Trash"),o()()()(),i(25,"div",12)(26,"div",13)(27,"span",14),l(28,"Free Space"),o(),i(29,"span",14),l(30,"30%"),o()(),p(31,"nz-progress",15),i(32,"div",16)(33,"button",17),p(34,"i",18),i(35,"span",19),l(36,"Upgrade"),o()()()()()(),i(37,"div",20)(38,"div",21)(39,"div",22),z(40,xr,1,0,"i",23)(41,Sr,1,0,"i",24),p(42,"i",25)(43,"input",26),o(),i(44,"div",27)(45,"ul",28)(46,"li",29)(47,"nz-upload",30)(48,"a",31),p(49,"i",32),o()()(),i(50,"li",29),z(51,br,2,0,"a",33)(52,yr,2,0,"a",34),o(),i(53,"li",29)(54,"a",35),p(55,"i",36),o()()()()(),i(56,"div",37)(57,"div",38)(58,"div",39),f("click",function(){return _(u),h(a.unselectFile())}),o(),i(59,"h5",40),l(60,"Folders"),o(),i(61,"div",41),z(62,Tr,2,1,"ng-container",42),i(63,"nz-dropdown-menu",null,0)(65,"ul",43),f("nzClick",function(){return _(u),h(a.close())}),i(66,"li",6),p(67,"i",44),i(68,"span",19),l(69,"Share"),o()(),i(70,"li",6),p(71,"i",45),i(72,"span",19),l(73,"Rename"),o()(),i(74,"li",6),p(75,"i",46),i(76,"span",19),l(77,"Mark as favorite"),o()(),p(78,"li",47),i(79,"li",6),p(80,"i",48),i(81,"span",19),l(82,"Download"),o()(),p(83,"li",47),i(84,"li",6),p(85,"i",49),i(86,"span",19),l(87,"Remove"),o()()()()(),i(88,"h5",50),l(89,"Files"),o(),i(90,"div",41),z(91,Nr,2,1,"ng-container",42),o()(),i(92,"div",51),z(93,Yr,2,1,"ng-container",42)(94,Kr,5,0,"div",52),o()()()()}r&2&&(s(),c("ngClass",q(14,zr,a.isNavOpen)),s(3),c("nzMode","inline"),s(27),c("nzPercent",70),s(9),c("ngIf",a.isNavOpen),s(),c("ngIf",!a.isNavOpen),s(10),c("ngIf",!a.listView),s(),c("ngIf",a.listView),s(9),c("ngClass",q(16,wi,a.listView)),s(),c("ngForOf",a.files),s(28),c("ngClass",q(18,wi,a.listView)),s(),c("ngForOf",a.files),s(),c("ngClass",q(20,Cr,a.isDetailsOpen)),s(),c("ngForOf",a.files),s(),c("ngIf",a.selectedFile==""))},dependencies:[et,$,Y,j,me,ni,ue,pe,we,_e,rt,G,W,H,Fe,ke,ii]});let n=d;return n})();var Dt=Ke(st());var Ei=(n,d)=>["/customers/routes/edit/",n,d];function eo(n,d){n&1&&p(0,"span",25)}function to(n,d){if(n&1&&p(0,"nz-option",36),n&2){let e=d.$implicit;c("nzValue",e)("nzLabel",e)}}function io(n,d){if(n&1&&p(0,"nz-option",36),n&2){let e=d.$implicit;c("nzValue",e)("nzLabel",e)}}function no(n,d){if(n&1&&p(0,"nz-option",37),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.id)}}function ro(n,d){if(n&1){let e=x();i(0,"form",26)(1,"nz-form-item")(2,"nz-form-label"),l(3,"Nombre de la Operaci\xF3n"),o(),i(4,"nz-form-control"),p(5,"input",27),o()(),i(6,"nz-form-item")(7,"nz-form-label"),l(8,"Descripci\xF3n"),o(),i(9,"nz-form-control"),p(10,"textarea",28),o()(),i(11,"nz-form-item")(12,"nz-form-label"),l(13,"Horarios Entradas (Opcional)"),o(),i(14,"nz-form-control")(15,"nz-select",29),z(16,to,1,2,"nz-option",30),o()()(),i(17,"nz-form-item")(18,"nz-form-label"),l(19,"Horarios Salidas (Opcional)"),o(),i(20,"nz-form-control")(21,"nz-select",31),z(22,io,1,2,"nz-option",30),o()()(),i(23,"div",32)(24,"div",33)(25,"nz-form-item")(26,"nz-form-label"),l(27,"Empresa"),o(),i(28,"nz-form-control")(29,"nz-form-control")(30,"nz-select",34),f("ngModelChange",function(r){_(e);let a=m();return h(a.setCustomerName(r))}),z(31,no,1,2,"nz-option",35),o()()()()()()()}if(n&2){let e=m();c("formGroup",e.objectForm),s(16),c("ngForOf",e.timeOptions),s(6),c("ngForOf",e.timeOptions),s(9),c("ngForOf",e.accountsList)}}function oo(n,d){if(n&1){let e=x();i(0,"li",53),f("click",function(){_(e);let r=m().$implicit,a=m(2);return h(a.toggleActive(r))}),p(1,"i",61),i(2,"span",43),l(3,"Activar"),o()()}}function ao(n,d){if(n&1){let e=x();i(0,"li",53),f("click",function(){_(e);let r=m().$implicit,a=m(2);return h(a.toggleActive(r))}),p(1,"i",61),i(2,"span",43),l(3,"Desactivar"),o()()}}function so(n,d){n&1&&(i(0,"nz-tag",62),l(1,"Activa"),o()),n&2&&c("nzColor","blue")}function lo(n,d){n&1&&(i(0,"nz-tag",62),l(1,"Inactiva"),o()),n&2&&c("nzColor","cyan")}function co(n,d){if(n&1){let e=x();i(0,"div",39)(1,"nz-card")(2,"div",40)(3,"div",41),p(4,"nz-avatar",42),i(5,"div",43)(6,"h5",44),l(7),o(),i(8,"span",45),l(9),o()()(),i(10,"div")(11,"a",46),p(12,"i",47),o(),i(13,"nz-dropdown-menu",null,4)(15,"ul",48),z(16,oo,4,0,"li",49)(17,ao,4,0,"li",49),i(18,"li",50)(19,"a",51),p(20,"i",52),i(21,"span",43),l(22,"Editar"),o()()(),i(23,"li",53),f("click",function(){let r=_(e).$implicit,a=m(2);return h(a.duplicate(r))}),p(24,"i",54),i(25,"span",43),l(26,"Duplicar"),o()(),p(27,"li",55),i(28,"li",53),f("click",function(){let r=_(e).$implicit,a=m(2);return h(a.deleteRoute(r))}),p(29,"i",56),i(30,"span",43),l(31,"Eliminar"),o()()()()()(),i(32,"p",57),l(33),o(),i(34,"div",58)(35,"div",59)(36,"div"),z(37,so,2,1,"nz-tag",60)(38,lo,2,1,"nz-tag",60),o()()()()()}if(n&2){let e=d.$implicit,t=y(14);s(4),c("nzSize",40)("nzSrc",e.imageUrl),s(3),S(e.name),s(2),S(e.customerName),s(2),c("nzDropdownMenu",t),s(5),c("ngIf",!e.active),s(),c("ngIf",e.active),s(2),c("routerLink",St(11,Ei,e.customerId,e.routeId)),s(14),S(e.desc),s(4),c("ngIf",e.active),s(),c("ngIf",!e.active)}}function mo(n,d){if(n&1&&(i(0,"div",32),z(1,co,39,14,"div",38),o()),n&2){let e=m();s(),c("ngForOf",e.routesList)}}function po(n,d){if(n&1&&(i(0,"span"),l(1),o()),n&2){let e=m().$implicit;s(),b("",e.initialStart," /")}}function uo(n,d){if(n&1&&(i(0,"span"),l(1),o()),n&2){let e=m().$implicit;s(),S(e.initialEnd)}}function _o(n,d){}function ho(n,d){n&1&&(i(0,"nz-tag",62),l(1,"Activa"),o()),n&2&&c("nzColor","blue")}function fo(n,d){n&1&&(i(0,"nz-tag",62),l(1,"Inactiva"),o()),n&2&&c("nzColor","cyan")}function go(n,d){if(n&1){let e=x();i(0,"li",53),f("click",function(){_(e);let r=m().$implicit,a=m(2);return h(a.toggleActive(r))}),p(1,"i",61),i(2,"span",43),l(3,"Activar"),o()()}}function zo(n,d){if(n&1){let e=x();i(0,"li",53),f("click",function(){_(e);let r=m().$implicit,a=m(2);return h(a.toggleActive(r))}),p(1,"i",61),i(2,"span",43),l(3,"Desactivar"),o()()}}function Co(n,d){if(n&1){let e=x();i(0,"tr")(1,"td"),l(2),o(),i(3,"td"),l(4),o(),i(5,"td"),z(6,po,2,1,"span",65)(7,uo,2,1,"span",65)(8,_o,0,0,"ng-template",null,6,w),o(),i(10,"td"),l(11),z(12,ho,2,1,"nz-tag",60)(13,fo,2,1,"nz-tag",60),o(),i(14,"td",66)(15,"div")(16,"a",46),p(17,"i",47),o(),i(18,"nz-dropdown-menu",null,7)(20,"ul",48),z(21,go,4,0,"li",49)(22,zo,4,0,"li",49),i(23,"li",53),f("click",function(){let r=_(e).$implicit,a=m(2);return h(a.duplicate(r))}),p(24,"i",54),i(25,"span",43),l(26,"Duplicar"),o()(),i(27,"li",50)(28,"a",51),p(29,"i",52),i(30,"span",43),l(31,"Editar"),o()()(),p(32,"li",55),i(33,"li",53),f("click",function(){let r=_(e).$implicit,a=m(2);return h(a.deleteRoute(r))}),p(34,"i",56),i(35,"span",43),l(36,"Eliminar"),o()()()()()()()}if(n&2){let e=d.$implicit,t=y(9),r=y(19);s(2),S(e.customerName),s(2),S(e.name),s(2),c("ngIf",e.initialStart==null?null:e.initialStart.length)("ngIfElse",t),s(),c("ngIf",e.initialEnd==null?null:e.initialEnd.length)("ngIfElse",t),s(4),b("",e.description," "),s(),c("ngIf",e.active),s(),c("ngIf",!e.active),s(3),c("nzDropdownMenu",r),s(5),c("ngIf",!e.active),s(),c("ngIf",e.active),s(6),c("routerLink",St(13,Ei,e.customerId,e.routeId))}}function vo(n,d){if(n&1&&(i(0,"nz-card")(1,"nz-table",63,5)(3,"thead")(4,"tr")(5,"th"),l(6,"Empresa"),o(),i(7,"th"),l(8,"Nombre"),o(),i(9,"th"),l(10,"Horario Entradas / Salidas"),o(),i(11,"th"),l(12,"Descripci\xF3n"),o(),i(13,"th"),l(14,"..."),o()()(),i(15,"tbody"),z(16,Co,37,16,"tr",64),o()()()),n&2){let e=y(2),t=m();s(),c("nzData",t.routesList),s(15),c("ngForOf",e.data)}}function xo(n,d){if(n&1&&(i(0,"nz-option",73),p(1,"i",74),l(2),p(3,"br"),l(4),o()),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.id),s(2),b(" ",e.name," "),s(2),b(" ",e.description,"")}}function So(n,d){if(n&1&&p(0,"nz-option",36),n&2){let e=d.$implicit;c("nzValue",e)("nzLabel",e)}}function bo(n,d){if(n&1){let e=x();i(0,"div",32)(1,"div",67)(2,"form",68)(3,"nz-form-item")(4,"nz-form-label",69),l(5,"Empresa"),o(),i(6,"nz-select",70),f("ngModelChange",function(r){_(e);let a=m();return h(a.onCustomerChange(r))}),z(7,xo,5,4,"nz-option",71),o()(),i(8,"nz-form-item")(9,"nz-form-label"),l(10,"Nombre de la Operaci\xF3n"),o(),i(11,"nz-form-control"),p(12,"input",27),o()(),i(13,"nz-form-item")(14,"nz-form-label"),l(15,"Descripci\xF3n"),o(),i(16,"nz-form-control"),p(17,"textarea",28),o()(),i(18,"nz-form-item")(19,"nz-form-label"),l(20,"Horario Preliminar (Opcional)"),o(),i(21,"nz-form-control")(22,"nz-select",72),z(23,So,1,2,"nz-option",30),o()()()()()()}if(n&2){let e=m();s(2),c("formGroup",e.objectFormDuplicate),s(5),c("ngForOf",e.accountsList),s(16),c("ngForOf",e.timeOptions)}}var xa=(()=>{let d=class d{constructor(t,r,a,u,g){this.afs=t,this.modalService=r,this.messageService=a,this.fb=u,this.modal=g,this.routesService=V(Ne),this.authService=V(re),this.accountsService=V(Ve),this.rolService=V(Ee),this.view="listView",this.isVisible=!1,this.isOkLoading=!1,this.stopSubscription$=new R,this.routesList=[],this.routesListLoaded=[],this.accountsList=[],this.duplicateVisible=!1,this.duplicateCustomerId="",this.isDuplicateLoading=!1,this.selectedData={},this.infoLoad=[],this.infoSegment=[],this.customersService=V(at),this.timeOptions=[],this.authService.user.subscribe(v=>{this.user=v,this.user!==null&&this.user!==void 0&&this.user.idSegment!==void 0&&(console.log(this.user.idSegment),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(D(this.stopSubscription$),E(I=>{let X=I.payload.id,M=I.payload.data();return T({id:X},M)}),Q(I=>(this.infoSegment=I,this.getSubscriptions(),I))).subscribe(),this.authService.user.subscribe(I=>{this.user=I,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&this.rolService.getRol(this.user.rolId).valueChanges().subscribe(X=>{this.infoLoad=X,this.userlevelAccess=this.infoLoad.optionAccessLavel})}))})}ngOnInit(){this.objectForm=this.fb.group({active:[!1,[C.required]],description:["",[C.required]],imageUrl:[""],kmzUrl:[""],name:["",[C.minLength(5),C.maxLength(20),C.required]],routeId:[""],customerId:["",[C.required]],customerName:["",[C.required]],initialStart:[],initialEnd:[]}),this.objectFormDuplicate=this.fb.group({active:[!1,[C.required]],description:["",[C.required]],imageUrl:[""],kmzUrl:[""],name:["",[C.minLength(5),C.maxLength(20),C.required]],routeId:[""],customerId:["",[C.required]],customerName:[""],initialStart:[],initialEnd:[],duplicateCustomerId:[],newCustomerId:[],newCustomerName:[]}),this.generateTimeOptions()}generateTimeOptions(){for(let a=7;a<=21;a++){let u=a%12||12,g=a<12?"AM":"PM",v=`${u.toString().padStart(2,"0")}:${a%60===30?"30":"00"} ${g}`;this.timeOptions.push(v)}}ngOnDestroy(){this.stopSubscription$.next(!1),this.stopSubscription$.complete()}sendMessage(t,r){this.messageService.create(t,r)}getSubscriptions(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.routesService.getAllCustomersRoutesbyCustomer(this.user.customerId).pipe(D(this.stopSubscription$),E(t=>t.map(r=>{let a=r.payload.doc.id,u=r.payload.doc.data();return T({id:a},u)}))).subscribe(t=>{this.routesList=t,this.routesListLoaded=t}),this.accountsService.getAccountsByCustomer(this.user.customerId).pipe(D(this.stopSubscription$),E(t=>{let r=t.payload.id,a=t.payload.data();return T({id:r},a)})).subscribe(t=>{this.accountsList=[t]})):(this.routesService.getAllCustomersRoutes().pipe(D(this.stopSubscription$)).subscribe(t=>{this.routesList=t,this.routesListLoaded=t}),this.accountsService.getAccounts().pipe(D(this.stopSubscription$),E(t=>t.map(r=>{let a=r.payload.doc.id,u=r.payload.doc.data();return T({id:a},u)}))).subscribe(t=>{this.accountsList=t}))}setCustomerName(t){let a=Dt.filter(this.accountsList,u=>u.id==t)[0];this.objectForm.controls.customerName.setValue(a.name)}toggleActive(t){this.routesService.toggleActiveRoute(t.customerId,t.routeId,t).then(()=>{this.routesService.toggleActiveRouteVendor(t.customerId,t.routeId,t).then(()=>{this.sendMessage("sucess","La ruta se modific\xF3 con \xE9xito.")})}).catch(r=>console.log(r))}deleteRoute(t){this.userlevelAccess=="1"?this.routesService.deleteRoute(t.customerId,t.routeId).then(()=>{console.log("done")}).catch(r=>console.log(r)):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}duplicate(t){this.duplicateVisible=!0,this.objectFormDuplicate.patchValue(T({},t)),this.selectedData=t,this.isDuplicateLoading=!1}onCustomerChange(t){if(t){let a=Dt.filter(this.accountsList,u=>u.id==t)[0];this.selectedData.newCustomerName=a.name,this.newCustomerName=a.name,this.objectFormDuplicate.controls.newCustomerName.setValue(a.name)}}createDuplicated(){this.selectedData.newCustomerId=this.duplicateCustomerId,this.isDuplicateLoading=!0,this.userlevelAccess!="3"?this.routesService.duplicateRouteWithStops(this.objectFormDuplicate.value).then(()=>{this.isDuplicateLoading=!1,this.duplicateVisible=!1}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}handleCancel(){this.duplicateVisible=!1,this.isDuplicateLoading=!1}addNewRoute(t){var r;let a=this.modalService.create({nzTitle:"Nueva Operaci\xF3n",nzContent:t,nzFooter:[{label:"Crear Operaci\xF3n",type:"primary",onClick:()=>this.modalService.confirm({nzTitle:"Est\xE1 la informaci\xF3n completa?",nzOnOk:()=>{if(this.objectForm.valid){let u=this.objectForm.value,g=u.initialStart.map(I=>({value:I})),v=u.initialEnd.map(I=>({value:I}));if(this.userlevelAccess!="3"){let I=this.afs.createId(),X=this.routesService.setRoute2(I,this.objectForm.controls.customerId.value,this.objectForm.value).then(()=>{}).catch(M=>console.log(M));this.routesService.getInternalCustomer(this.objectForm.controls.customerId.value).pipe(D(this.stopSubscription$),E(M=>M.map(J=>{let ge=J.payload.doc.id,Xe=J.payload.doc.data();return xe(T({},Xe),{id:ge})}))).subscribe(M=>{let J=this.objectForm.controls.name.value,ge=new Date,Je=new Date(ge.getFullYear()+3,ge.getMonth(),ge.getDate()).toISOString();console.log(J);var Ct="";let $e={authorization:"portalAuth",operation_type:"in",method:"Liquidacion",transaction_type:"charge",card:{type:"",brand:"",address:"",card_number:"",holder_name:"",expiration_year:"",expiration_month:"",allows_charges:"",allows_payouts:"",bank_name:"",bank_code:"",points_card:"",points_type:""},status:"completed",conciliated:!1,creation_date:new Date().toISOString(),operation_date:new Date().toISOString(),description:"Pago a traves de portal",error_message:"",order_id:"portalOrder",currency:"MXN",amount:0,customer:{name:"",last_name:"",email:"",phone_number:"",address:"",creation_date:"",external_id:"",clabe:""},customerId:this.objectForm.controls.customerId.value,active:!0,category:"permanente",date_created:new Date().toISOString(),product_description:"Pago a traves de portal proceso interno al crear una ruta",product_id:"",name:"Internal",isTaskIn:"false",isTaskOut:"false",type:"Servicio",isOpenpay:!1,paidApp:"portal",price:0,round:"",routeId:I,routeName:J,stopDescription:"",stopId:"",stopName:"Internal",validFrom:new Date().toISOString(),validTo:Je,idBoardingPass:M[0].id,idPurchasteRequest:"",is_courtesy:!1,typePayment:"Liquidacion"};r={active:!0,amountPayment:0,payment:"Liquidacion",status:"completed",customer_id:this.objectForm.controls.customerId.value,customerId:this.objectForm.controls.customerId.value,creation_date:new Date().toISOString(),name:"internal",price:0,operation_date:new Date().toISOString(),routeId:I,routeName:J,round:"",stopName:"internal",stopId:"",typePayment:"Liquidacion",validFrom:new Date().toISOString(),validTo:Je,idBoardingPass:M[0].uid,idPurchaseRequest:"",baja:!1,type:"Servicio",fileURL:Ct},this.customersService.saveBoardingPassToUserPurchaseCollection(M[0].id,$e).then(Ye=>{this.customersService.saveBoardingPassDetailToUserPurchaseCollection(M[0].id,I,$e).then(vt=>{let Ii=M[0];this.customersService.createPurchaseCloud($e,Ii,M[0].id)}).catch(vt=>{console.log("error")})}).catch(Ye=>{console.log(Ye)}),this.modalService.closeAll()})}else this.sendMessage("error","El usuario no tiene permisos para agregar datos, favor de contactar al administrador.")}}})}],nzWidth:500})}getItems(t){let r=t;if(!r){this.routesList=this.routesListLoaded.slice();return}let a=r.toLowerCase();this.routesList=this.routesListLoaded.filter(u=>Object.values(u).some(g=>String(g).toLowerCase().includes(a)))}};d.\u0275fac=function(r){return new(r||d)(P(nt),P(lt),P(be),P(ne),P(Ht))},d.\u0275cmp=B({type:d,selectors:[["app-routes"]],decls:31,vars:6,consts:[["searchInput",""],["suffixIconSearch",""],["newProjectContent",""],["modalContent",""],["projectListSetting","nzDropdownMenu"],["listViewTable",""],["empty",""],["projectListSetting2","nzDropdownMenu"],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"page-header"],[1,"row","align-items-md-center"],[1,"col-md-6"],[2,"margin-left","10px","width","280px"],[3,"nzSuffix"],["type","text","nz-input","","placeholder","Selecciona una Operaci\xF3n",3,"keyup"],[1,"text-md-right","m-v-10"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nz-icon","","nzType","plus"],[1,"container-fluid"],["class","row",4,"ngIf"],[4,"ngIf"],["nzTitle","Duplicar la operaci\xF3n para la empresa",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzContent"],["nz-icon","","nzType","search"],["nz-form","","nzLayout","vertical",3,"formGroup"],["type","text","formControlName","name","nz-input","","placeholder","Escriba el nombre de la Operaci\xF3n"],["formControlName","description","nz-input",""],["formControlName","initialStart","nzMode","multiple"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["formControlName","initialEnd","nzMode","multiple"],[1,"row"],[1,"col-md-12"],["formControlName","customerId","nzPlaceHolder","Selecciona la empresa",1,"w-100",3,"ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],[3,"nzLabel","nzValue"],["class","col-md-3",4,"ngFor","ngForOf"],[1,"col-md-3"],[1,"d-flex","justify-content-between"],[1,"media"],["nzShape","square",2,"background-color","white","color","#4F6F57",3,"nzSize","nzSrc"],[1,"m-l-10"],[1,"m-b-0"],[1,"text-muted","font-size-13"],["nz-dropdown","","nzPlacement","bottomRight","nzTrigger","click",1,"text-gray","font-size-18",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","theme","outline"],["nz-menu","","nzSelectable",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item",""],[3,"routerLink"],["nz-icon","","nzType","edit","theme","outline"],["nz-menu-item","",3,"click"],["nz-icon","","nzType","copy","theme","outline"],["nz-menu-divider",""],["nz-icon","","nzType","delete","theme","outline"],[1,"m-t-25"],[1,"m-t-30"],[1,"d-flex","justify-content-between","align-items-center"],["class","m-b-0",3,"nzColor",4,"ngIf"],["nz-icon","","nzType","eye","theme","outline"],[1,"m-b-0",3,"nzColor"],["ngSkipHydration","",3,"nzData"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[1,"text-right"],[1,"col-sm-12"],["nz-form","","nz-form","","nzLayout","vertical",3,"formGroup"],["nzFor","customerId"],["formControlName","duplicateCustomerId","name","duplicateCustomerId","nzAllowClear","","nzPlaceHolder","Selecciona la empresa",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","initialStart"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""]],template:function(r,a){if(r&1){let u=x();i(0,"div",8)(1,"div",9)(2,"nz-page-header",10)(3,"nz-page-header-title",11),l(4,"Operaci\xF3n"),o(),i(5,"nz-page-header-subtitle"),l(6,"Operaciones del Sistema "),o()()(),i(7,"div",12)(8,"div",13)(9,"div",14)(10,"div",15)(11,"nz-form-control")(12,"nz-input-group",16)(13,"input",17,0),f("keyup",function(){_(u);let v=y(14);return h(a.getItems(v.value))}),o()(),z(15,eo,1,0,"ng-template",null,1,w),o()()(),i(17,"div",14)(18,"div",18)(19,"button",19),f("click",function(){_(u);let v=y(24);return h(a.addNewRoute(v))}),p(20,"i",20),i(21,"span"),l(22,"Agregar Operaci\xF3n"),o()(),z(23,ro,32,4,"ng-template",null,2,w),o()()()(),i(25,"div",21),z(26,mo,2,1,"div",22)(27,vo,17,2,"nz-card",23),o(),i(28,"nz-modal",24),N("nzVisibleChange",function(v){return _(u),F(a.duplicateVisible,v)||(a.duplicateVisible=v),h(v)}),f("nzOnCancel",function(){return _(u),h(a.handleCancel())})("nzOnOk",function(){return _(u),h(a.createDuplicated())}),o(),z(29,bo,24,3,"ng-template",null,3,w),o()}if(r&2){let u=y(16),g=y(30);s(2),c("nzGhost",!1),s(10),c("nzSuffix",u),s(14),c("ngIf",a.view=="cardView"),s(),c("ngIf",a.view=="listView"),s(),k("nzVisible",a.duplicateVisible),c("nzContent",g)}},dependencies:[$,Y,j,ae,oe,le,se,de,ce,ye,jt,$t,Ue,Me,Le,Re,Oe,Ae,Te,me,ue,pe,we,Ie,De,_e,G,W,H,ot,Pe,ct,dt,Be,he,fe,it,ee,Se,K,Z,te,ie]});let n=d;return n})();var Pt=Ke(st());function yo(n,d){if(n&1){let e=x();i(0,"li",15),f("click",function(){_(e);let r=m().$implicit,a=m();return h(a.toggleActive(r))}),p(1,"i",16),l(2," Activar "),o()}}function wo(n,d){if(n&1){let e=x();i(0,"li",15),f("click",function(){_(e);let r=m().$implicit,a=m();return h(a.toggleActive(r))}),p(1,"i",16),l(2," Desactivar "),o()}}function To(n,d){if(n&1){let e=x();i(0,"tr")(1,"td"),l(2),o(),i(3,"td"),l(4),o(),i(5,"td")(6,"nz-tag",10),l(7,"Dom"),o(),i(8,"nz-tag",10),l(9,"Lun"),o(),i(10,"nz-tag",10),l(11,"Mar"),o(),i(12,"nz-tag",10),l(13,"Mi\xE9"),o(),i(14,"nz-tag",10),l(15,"Jue"),o(),i(16,"nz-tag",10),l(17,"Vie"),o(),i(18,"nz-tag",10),l(19,"S\xE1b"),o()(),i(20,"td"),l(21),o(),i(22,"td"),l(23),O(24,"date"),o(),i(25,"td"),l(26),o(),i(27,"td"),l(28),o(),i(29,"td"),l(30),o(),i(31,"td"),l(32),o(),i(33,"td")(34,"a",11),p(35,"i",12),o(),i(36,"nz-dropdown-menu",null,2)(38,"ul",13),z(39,yo,3,0,"li",14)(40,wo,3,0,"li",14),i(41,"li",15),f("click",function(){let r=_(e).$implicit,a=m();return h(a.showModalEdit(r))}),p(42,"i",16),l(43," Editar "),o(),p(44,"li",17),i(45,"li",18),f("nzOnConfirm",function(){let r=_(e).$implicit,a=m();return h(a.showModalDelete(r))})("nzOnCancel",function(){_(e);let r=m();return h(r.handleCancel())}),p(46,"i",19),l(47," Eliminar "),o()()()()()}if(n&2){let e=d.$implicit,t=y(37);s(),A(e.active?"text-dark":"text-muted font-italic"),s(),S(e.vendorName),s(),A(e.active?"text-dark":"text-muted font-italic"),s(),S(e.program=="M"?"Mete":"Saca"),s(),A(e.active?"text-dark":"text-muted font-italic"),s(),c("nzColor",e.isSunday?"blue":""),s(2),c("nzColor",e.isMonday?"blue":""),s(2),c("nzColor",e.isTuesday?"blue":""),s(2),c("nzColor",e.isWednesday?"blue":""),s(2),c("nzColor",e.isThursday?"blue":""),s(2),c("nzColor",e.isFriday?"blue":""),s(2),c("nzColor",e.isSaturday?"blue":""),s(2),A(e.active?"text-dark":"text-muted font-italic"),s(),S(e.round),s(),A(e.active?"text-dark":"text-muted font-italic"),s(),S(U(24,38,e.time.toDate(),"shortTime")),s(2),A(e.active?"text-dark":"text-muted font-italic"),s(),S(e.acRequired?"Si":"No"),s(),A(e.active?"text-dark":"text-muted font-italic"),s(),S(e.stopBeginName),s(),A(e.active?"text-dark":"text-muted font-italic"),s(),S(e.stopEndName),s(),A(e.active?"text-dark":"text-muted font-italic"),s(),S(e.type),s(),A(e.active?"text-dark":"text-muted font-italic"),s(),c("nzDropdownMenu",t),s(5),c("ngIf",!e.active),s(),c("ngIf",e.active)}}function Eo(n,d){if(n&1&&(i(0,"nz-option",42),p(1,"i",16),l(2),p(3,"br"),l(4),o()),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.id),s(2),b(" ",e.name," "),s(2),b(" ",e.description,"")}}function Vo(n,d){if(n&1&&(i(0,"nz-option",42),p(1,"i",16),l(2),p(3,"br"),l(4),o()),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.id),s(2),b(" ",e.name," "),s(2),b(" ",e.description,"")}}function Io(n,d){if(n&1&&(i(0,"nz-option",42),p(1,"i",16),l(2),p(3,"br"),l(4),o()),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.id),s(2),b(" ",e.name," "),s(2),b(" ",e.description,"")}}function Do(n,d){if(n&1){let e=x();i(0,"form",20),f("ngSubmit",function(){_(e);let r=m();return h(r.createProgram())}),i(1,"div",21)(2,"div",22)(3,"nz-form-item")(4,"nz-form-label"),l(5,"Tipo de asignaci\xF3n"),o(),i(6,"nz-form-control")(7,"nz-select",23),p(8,"nz-option",24)(9,"nz-option",25)(10,"nz-option",26),o()()()(),i(11,"div",22)(12,"nz-form-item")(13,"nz-form-label"),l(14,"Divisi\xF3n"),o(),i(15,"nz-form-control")(16,"nz-select",27),f("ngModelChange",function(r){_(e);let a=m();return h(a.onVendorSelected(r,"vendorName"))}),z(17,Eo,5,4,"nz-option",28),o()()()()(),i(18,"div",21)(19,"div",22)(20,"nz-form-item")(21,"nz-form-label"),l(22,"Turno"),o(),i(23,"nz-form-control")(24,"nz-select",29),p(25,"nz-option",30)(26,"nz-option",31)(27,"nz-option",32),o()()()(),i(28,"div",22)(29,"nz-form-item")(30,"nz-form-label"),l(31,"Tarea"),o(),i(32,"nz-form-control")(33,"nz-select",33),p(34,"nz-option",34)(35,"nz-option",35),o()()()()(),i(36,"div",21)(37,"div",36)(38,"nz-form-item")(39,"nz-form-label"),l(40,"Hora Compromiso"),o(),i(41,"nz-form-control"),p(42,"nz-time-picker",37),o()()()(),i(43,"nz-form-item")(44,"nz-form-label",38),l(45,"D\xEDas"),o(),i(46,"nz-form-control")(47,"nz-tag",39),f("nzCheckedChange",function(r){_(e);let a=m();return h(a.checkChange("isSunday",r))}),l(48,"Dom"),o(),i(49,"nz-tag",39),f("nzCheckedChange",function(r){_(e);let a=m();return h(a.checkChange("isMonday",r))}),l(50,"Lun"),o(),i(51,"nz-tag",39),f("nzCheckedChange",function(r){_(e);let a=m();return h(a.checkChange("isTuesday",r))}),l(52,"Mar"),o(),i(53,"nz-tag",39),f("nzCheckedChange",function(r){_(e);let a=m();return h(a.checkChange("isWednesday",r))}),l(54,"Mi\xE9"),o(),i(55,"nz-tag",39),f("nzCheckedChange",function(r){_(e);let a=m();return h(a.checkChange("isThursday",r))}),l(56,"Jue"),o(),i(57,"nz-tag",39),f("nzCheckedChange",function(r){_(e);let a=m();return h(a.checkChange("isFriday",r))}),l(58,"Vie"),o(),i(59,"nz-tag",39),f("nzCheckedChange",function(r){_(e);let a=m();return h(a.checkChange("isSaturday",r))}),l(60,"S\xE1b"),o()()(),i(61,"div",21)(62,"div",22)(63,"nz-form-item")(64,"nz-form-label"),l(65,"Inicia en"),o(),i(66,"nz-form-control")(67,"nz-select",40),f("ngModelChange",function(r){_(e);let a=m();return h(a.onStopPointSelected(r,"stopBeginName","stopBeginHour"))}),z(68,Vo,5,4,"nz-option",28),o()()()(),i(69,"div",22)(70,"nz-form-item")(71,"nz-form-label"),l(72,"Termina en"),o(),i(73,"nz-form-control")(74,"nz-select",41),f("ngModelChange",function(r){_(e);let a=m();return h(a.onStopPointSelected(r,"stopEndName","stopEndHour"))}),z(75,Io,5,4,"nz-option",28),o()()()()()()}if(n&2){let e=m();c("formGroup",e.programForm),s(17),c("ngForOf",e.vendorsList),s(30),c("nzChecked",e.programForm.controls.isSunday.value),s(2),c("nzChecked",e.programForm.controls.isMonday.value),s(2),c("nzChecked",e.programForm.controls.isTuesday.value),s(2),c("nzChecked",e.programForm.controls.isWednesday.value),s(2),c("nzChecked",e.programForm.controls.isThursday.value),s(2),c("nzChecked",e.programForm.controls.isFriday.value),s(2),c("nzChecked",e.programForm.controls.isSaturday.value),s(9),c("ngForOf",e.stopPointsList),s(7),c("ngForOf",e.stopPointsList)}}var Vi=(()=>{let d=class d{constructor(t,r){this.messageService=t,this.fb=r,this.loading=!0,this.routesService=V(Ne),this.vendorsService=V(Zt),this.rolService=V(Ee),this.authService=V(re),this.userService=V(Wt),this.stopSubscription$=new R,this.programsList=[],this.stopPointsList=[],this.vendorsList=[],this.isCreateVisible=!1,this.isEditMode=!1,this.infoLoad=[],this.authService.user.subscribe(a=>{this.user=a,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&this.rolService.getRol(this.user.rolId).valueChanges().subscribe(u=>{this.infoLoad=u,this.userlevelAccess=this.infoLoad.optionAccessLavel})}),this.createForm()}sendMessage(t,r){this.messageService.create(t,r)}ngOnInit(){this.getSubscriptions()}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}getSubscriptions(){this.routesService.getRouteAssignments(this.accountId,this.routeId).pipe(D(this.stopSubscription$),E(t=>t.map(r=>{let a=r.payload.doc.id,u=r.payload.doc.data();return xe(T({},u),{id:a})}))).subscribe(t=>{this.programsList=t,this.loading=!1}),this.routesService.getRouteStopPoints(this.accountId,this.routeId).pipe(D(this.stopSubscription$),E(t=>t.map(r=>{let a=r.payload.doc.id,u=r.payload.doc.data();return xe(T({},u),{id:a})}))).subscribe(t=>{this.stopPointsList=t,this.loading=!1}),this.vendorsService.getVendors().pipe(D(this.stopSubscription$),E(t=>t.map(r=>{let a=r.payload.doc.id,u=r.payload.doc.data();return xe(T({},u),{id:a})}))).subscribe(t=>{this.vendorsList=t,this.loading=!1})}createForm(){this.programForm=this.fb.group({active:[!1,[C.required]],acRequired:[!1,[C.required]],isSunday:[!1,[C.required]],isMonday:[!0,[C.required]],isTuesday:[!0,[C.required]],isWednesday:[!0,[C.required]],isThursday:[!0,[C.required]],isFriday:[!0,[C.required]],isSaturday:[!1,[C.required]],program:["",[C.required]],round:["",[C.required]],stopBeginId:["",[C.required]],stopBeginName:["",[C.required]],stopBeginHour:["",[C.required]],stopEndId:["",[C.required]],stopEndName:["",[C.required]],stopEndHour:["",[C.required]],time:[new Date,[C.required]],type:[this.assigmentType,[C.required]],customerName:["",[C.required]],customerId:[this.accountId,[C.required]],vendorName:["",[C.required]],vendorId:["",[C.required]],routeId:[this.routeId,[C.required]]})}patchForm(t){this.programForm.patchValue({active:t.active,acRequired:t.acRequired,isSunday:t.isSunday,isMonday:t.isMonday,isTuesday:t.isTuesday,isWednesday:t.isWednesday,isThursday:t.isThursday,isFriday:t.isFriday,isSaturday:t.isSaturday,program:t.program,round:t.round,stopBeginId:t.stopBeginId,stopBeginName:t.stopBeginName,stopBeginHour:t.stopBeginHour,stopEndId:t.stopEndId,stopEndName:t.stopEndName,stopEndHour:t.stopEndHour,time:t.time.toDate(),type:t.type,customerName:t.customerName,customerId:this.accountId,vendorName:t.vendorName,vendorId:t.vendorId,routeId:this.routeId})}toggleActive(t){this.routesService.toggleRouteAssignment(this.accountId,this.routeId,t.id,t).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1}).catch(r=>console.log(r))}showCreateModal(){this.isCreateVisible=!0,this.currentSelectedId=""}showModalDelete(t){console.log(t),this.userlevelAccess=="1"?this.routesService.deleteRouteAssignments(this.accountId,this.routeId,t.id).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1}).catch(r=>console.log(r)):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}showModalEdit(t){this.patchForm(t),this.currentSelectedId=t.id,this.isCreateVisible=!0,this.isEditMode=!0}handleCancel(){this.isCreateVisible=!1,this.isEditMode=!1,this.currentSelectedId=""}createProgram(){this.programForm.get("customerId").setValue(this.accountId),this.programForm.get("routeId").setValue(this.routeId),this.userlevelAccess!="3"?this.isEditMode?this.routesService.updateRouteAssignment(this.accountId,this.routeId,this.currentSelectedId,this.programForm.value).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1,this.currentSelectedId=""}).catch(t=>console.log(t)):this.routesService.setRouteAssignments(this.accountId,this.routeId,this.programForm.value).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1}).catch(t=>console.log(t)):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}checkChange(t,r){this.programForm.controls[t].setValue(r),console.log(this.programForm.value)}onStopPointSelected(t,r,a){if(t){let g=Pt.filter(this.stopPointsList,I=>I.id==t)[0],v=this.programForm.controls.round.value;switch(this.programForm.controls[r].setValue(g.name),v){case"D\xEDa":this.programForm.controls[a].setValue(g.round1);break;case"Tarde":this.programForm.controls[a].setValue(g.round2);break;default:this.programForm.controls[a].setValue(g.round1);break}}}onVendorSelected(t,r){if(t){let u=Pt.filter(this.vendorsList,g=>g.id==t)[0];this.programForm.controls[r].setValue(u.name)}}};d.\u0275fac=function(r){return new(r||d)(P(be),P(ne))},d.\u0275cmp=B({type:d,selectors:[["app-shared-route-programs"]],inputs:{accountId:"accountId",routeId:"routeId"},decls:33,vars:5,consts:[["programsListTable",""],["modalContent",""],["menu","nzDropdownMenu"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],[3,"nzData","nzLoading"],[2,"color","#4F6F57"],[4,"ngFor","ngForOf"],["nzTitle","Agregar asignaci\xF3n",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzContent"],[3,"nzColor"],["nz-dropdown","","nzPlacement","bottomRight",3,"nzDropdownMenu"],["nz-icon","","nzTooltipTitle","M\xE1s informaci\xF3n","nzTooltipPlacement","topLeft","nz-tooltip",""],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item","",3,"click"],["nz-icon",""],["nz-menu-divider",""],["nz-menu-item","","nz-popconfirm","","nzPopconfirmTitle","\xBFEst\xE1s seguro de eliminar esta asignaci\xF3n?","nzPopconfirmPlacement","topRight",3,"nzOnConfirm","nzOnCancel"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436"],["nz-form","",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-6","col-sm-12"],["formControlName","type"],["nzValue","Permanente","nzLabel","Permanente"],["nzValue","Temporal","nzLabel","Temporal"],["nzValue","Viaje Especial","nzLabel","Viaje Especial"],["formControlName","vendorId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","round"],["nzValue","D\xEDa","nzLabel","D\xEDa"],["nzValue","Tarde","nzLabel","Tarde"],["nzValue","Noche","nzLabel","Noche"],["formControlName","program"],["nzValue","M","nzLabel","Mete"],["nzValue","S","nzLabel","Saca"],[1,"col-md-8","col-sm-12"],["formControlName","time","nzFormat","HH:mm"],["nzFor","days"],["nzMode","checkable",3,"nzCheckedChange","nzChecked"],["formControlName","stopBeginId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["formControlName","stopEndId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue"]],template:function(r,a){if(r&1){let u=x();i(0,"div",3)(1,"nz-page-header",4)(2,"nz-page-header-extra")(3,"button",5),f("click",function(){return _(u),h(a.showCreateModal())}),l(4,"Agregar asignaci\xF3n"),o()()()(),i(5,"nz-table",6,0)(7,"thead")(8,"tr")(9,"th",7),l(10,"Asignado A"),o(),i(11,"th",7),l(12,"Tarea"),o(),i(13,"th",7),l(14,"D\xEDas"),o(),i(15,"th",7),l(16,"Turno"),o(),i(17,"th",7),l(18,"Hora"),o(),i(19,"th",7),l(20,"AC"),o(),i(21,"th",7),l(22,"Inicio"),o(),i(23,"th",7),l(24,"Fin"),o(),i(25,"th",7),l(26,"Tipo"),o(),p(27,"th",7),o()(),i(28,"tbody"),z(29,To,48,41,"tr",8),o()(),i(30,"nz-modal",9),N("nzVisibleChange",function(v){return _(u),F(a.isCreateVisible,v)||(a.isCreateVisible=v),h(v)}),f("nzOnCancel",function(){return _(u),h(a.handleCancel())})("nzOnOk",function(){return _(u),h(a.createProgram())}),z(31,Do,76,11,"ng-template",null,1,w),o()}if(r&2){let u=y(6),g=y(32);s(5),c("nzData",a.programsList)("nzLoading",a.loading),s(24),c("ngForOf",u.data),s(),k("nzVisible",a.isCreateVisible),c("nzContent",g)}},dependencies:[$,Y,j,ae,oe,le,se,de,ce,Ue,Me,Le,Re,Oe,Ae,Te,ue,pe,we,Ie,De,_e,rt,G,W,H,Pe,mt,Be,he,fe,ee,K,Z,te,ie,ei,pt,tt]});let n=d;return n})();function ko(n,d){if(n&1&&(i(0,"nz-option",28),p(1,"i",29),l(2),p(3,"br"),l(4),o()),n&2){let e=d.$implicit;c("nzLabel",e.name)("nzValue",e.id),s(2),b(" ",e.name," "),s(2),b(" ",e.description,"")}}var Ha=(()=>{let d=class d{constructor(t,r){this.route=t,this.fb=r,this.routesService=V(Ne),this.accountsService=V(Ve),this.accountsList=[],this.stopSubscription$=new R,this.routeElement={},this.infoSegment=[],this.authService=V(re),this.authService.user.subscribe(a=>{this.user=a,this.user!==null&&this.user!==void 0&&this.user.idSegment!==void 0&&this.accountsService.getSegmentLevel(this.user.idSegment).pipe(D(this.stopSubscription$),E(u=>{let g=u.payload.id,v=u.payload.data();return T({id:g},v)}),Q(u=>(this.infoSegment=u,u))).subscribe()})}ngOnInit(){this.objectSubscription=this.route.params.pipe(D(this.stopSubscription$)).subscribe(t=>{this.accountId=t.accountId,this.routeId=t.routeId,console.log(t),this.getSubscriptions(),this.createForm()})}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}createForm(){this.objectForm=this.fb.group({active:[!1,[C.required]],name:["",[C.required]],description:[""],imageUrl:[""],kmzUrl:[""],routeId:["",[C.required]],customerId:[""]})}patchForm(t){this.objectForm.patchValue({active:t.active,name:t.name,description:t.description,imageUrl:t.imageUrl,kmzUrl:t.kmzUrl,routeId:t.routeId,customerId:this.accountId})}saveForm(){}getSubscriptions(){this.routesService.getRoute(this.accountId,this.routeId).pipe(D(this.stopSubscription$),E(t=>{let r=t.payload.id,a=t.payload.data();return T({id:r},a)})).subscribe(t=>{this.patchForm(t),this.routeElement=t}),this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.accountsService.getAccountsByCustomer(this.user.customerId).pipe(D(this.stopSubscription$),E(t=>{let r=t.payload.id,a=t.payload.data();return T({id:r},a)})).subscribe(t=>{this.accountsList=[t]}):this.accountsService.getAccounts().pipe(D(this.stopSubscription$),E(t=>t.map(r=>{let a=r.payload.doc.id,u=r.payload.doc.data();return T({id:a},u)}))).subscribe(t=>{this.accountsList=t})}onCustomerChange(){}};d.\u0275fac=function(r){return new(r||d)(P(Rt),P(ne))},d.\u0275cmp=B({type:d,selectors:[["app-edit"]],decls:48,vars:9,consts:[[1,"page-header","has-tab"],[1,"d-md-flex","m-b-15","align-items-center","justify-content-between"],[1,"media","align-items-center","m-b-15"],["nzShape","square",2,"background-color","white","color","#4F6F57",3,"nzSize","nzSrc"],[1,"m-l-15"],[1,"m-b-0"],[1,"m-b-15"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nz-icon","","nzType","save","theme","outline"],["nz-form","","nzLayout","vertical",3,"formGroup"],[1,"page-header-tab"],["nzTitle","Informaci\xF3n B\xE1sica"],[1,"row"],[1,"col-md-9","col-sm-12"],["nzFor","name"],["nz-input","","formControlName","name","type","text"],[1,"col-md-3","col-sm-12"],["nzFor","active"],["formControlName","active","nzCheckedChildren","Activa","nzUnCheckedChildren","Inactiva"],[1,"col-md-12"],["nzFor","description"],["nz-input","","formControlName","description","type","text"],["nzFor","customerId"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Selecciona la empresa",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzTitle","Estaciones"],[3,"accountId","routeId"],["nzTitle","Asignaciones"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon","","nzType","flag"]],template:function(r,a){r&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),p(3,"nz-avatar",3),i(4,"div",4)(5,"h4",5),l(6),o()()(),i(7,"div",6)(8,"button",7),f("click",function(){return a.saveForm()}),p(9,"i",8),i(10,"span"),l(11,"Actualizar"),o()()()()(),i(12,"form",9)(13,"nz-tabset",10)(14,"nz-tab",11)(15,"nz-card")(16,"div",12)(17,"div",13)(18,"nz-form-item")(19,"nz-form-label",14),l(20,"Nombre"),o(),i(21,"nz-form-control"),p(22,"input",15),o()()(),i(23,"div",16)(24,"nz-form-item")(25,"nz-form-label",17),l(26,"Activa"),o(),i(27,"nz-form-control"),p(28,"nz-switch",18),o()()()(),i(29,"div",12)(30,"div",19)(31,"nz-form-item")(32,"nz-form-label",20),l(33,"Descripci\xF3n"),o(),i(34,"nz-form-control"),p(35,"input",21),o()()(),i(36,"div",19)(37,"nz-form-item")(38,"nz-form-label",22),l(39,"Empresa"),o(),i(40,"nz-select",23),f("ngModelChange",function(){return a.onCustomerChange()}),z(41,ko,5,4,"nz-option",24),o()()()()()(),i(42,"nz-tab",25)(43,"nz-card"),p(44,"app-shared-stoppoints-list",26),o()(),i(45,"nz-tab",27)(46,"nz-card"),p(47,"app-shared-route-programs",26),o()()()()),r&2&&(s(3),c("nzSize",70)("nzSrc",a.objectForm.controls.imageUrl.value),s(3),S(a.objectForm.controls.name.value),s(6),c("formGroup",a.objectForm),s(29),c("ngForOf",a.accountsList),s(3),c("accountId",a.accountId)("routeId",a.routeId),s(3),c("accountId",a.accountId)("routeId",a.routeId))},dependencies:[$,j,ae,oe,le,se,de,ce,ye,me,ut,G,W,H,ot,he,fe,ee,Se,K,Z,te,ie,Fe,ke,Kt,Vi]});let n=d;return n})();export{bi as a,ia as b,ca as c,xa as d,Ha as e};
