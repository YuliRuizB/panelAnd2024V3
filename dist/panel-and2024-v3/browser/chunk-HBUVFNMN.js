import{a as Lt,b as De,c as kt}from"./chunk-MVBSW32G.js";import{a as Pt}from"./chunk-NR4FHFAU.js";import{a as Te}from"./chunk-65WLNC2U.js";import{a as et,b as Ot}from"./chunk-4KJECQNL.js";import{a as Ze,h as Mt}from"./chunk-7DX4VOEH.js";import{B as le,C as de,D as me,E as ce,G as Nt,a as Ve,c as ee,d as te,k as ie,n as ve,o as Ce,w as oe,y as Dt,z as se}from"./chunk-P4W5U2FV.js";import{P as Xe,Q as Ye,R as Qe,S as Ie,_ as fe,b as $,c as b,d as q,da as Fe,e as H,ea as ft,fa as ze,h as We,i as Ge,j as yt,ja as we,k as W,m as G,pa as ne,q as J,qa as re,sa as ae,t as Je,ta as Ke,u as Ee}from"./chunk-QRDPTFUJ.js";import{d as Et}from"./chunk-DN7PPQ6G.js";import{a as It,c as Ft,f as Z,g as wt,h as Vt,j as Tt}from"./chunk-BOTI6TUZ.js";import{$b as B,Af as ge,Be as Q,C as ue,Cf as _e,Ea as z,Eb as Le,Fe as ut,Ga as m,Gb as ke,Ib as L,O as V,Pc as X,Q as k,Qd as ye,Ua as n,Va as i,Wa as v,Xa as St,Y as y,Ya as xt,_ as U,_a as w,ac as j,bb as _,bc as bt,c as A,db as u,ec as Re,ga as f,gb as xe,ha as g,lb as $e,m as C,mb as qe,nb as He,ob as E,of as ht,pb as a,qb as I,ra as R,rb as h,sa as s,sb as he,ta as O,tb as be,ub as P,vb as M,wb as N,ye as Y,zb as Oe,zf as K}from"./chunk-WHASPTUY.js";import{a as S,b as Ne,f as ct,h as pt}from"./chunk-SIAVTO45.js";var tt=ct(ft());var Xt=["searchBar"],Yt=["searchBarE"],Qt=["searchBarC"];function Kt(l,p){if(l&1){let e=w();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td")(10,"a",36),_("click",function(){let t=f(e).$implicit,r=u();return g(r.showModalIn(t))}),a(11,"Editar"),i()()()}if(l&2){let e=p.$implicit,o=u();s(2),I(e.customerName),s(2),he("",e.firstName," ",e.lastName,""),s(2),I(e.email),s(2),I(e.status),s(2),m("nzSize",o.size)}}function Zt(l,p){if(l&1){let e=w();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td")(10,"a",36),_("click",function(){let t=f(e).$implicit,r=u();return g(r.showModalInE(t))}),a(11,"Editar"),i()()()}if(l&2){let e=p.$implicit,o=u();s(2),I(e.customerName),s(2),he("",e.firstName," ",e.lastName,""),s(2),I(e.vendorName),s(2),I(e.status),s(2),m("nzSize",o.size)}}function ei(l,p){if(l&1&&(n(0,"nz-tag",44),a(1),i()),l&2){let e=u().$implicit;m("nzColor","red"),s(),h("",e.status," ")}}function ti(l,p){if(l&1&&(n(0,"nz-tag",44),a(1),i()),l&2){let e=u().$implicit;m("nzColor","green"),s(),h("",e.status," ")}}function ii(l,p){if(l&1&&(n(0,"nz-tag",44),a(1),i()),l&2){let e=u().$implicit;m("nzColor","blue"),s(),h("",e.status," ")}}function ni(l,p){if(l&1&&(n(0,"nz-tag",44),a(1),i()),l&2){let e=u().$implicit;m("nzColor","gray"),s(),h("",e.status," ")}}function ri(l,p){if(l&1){let e=w();n(0,"li",42),_("click",function(){f(e);let t=u().$implicit,r=u();return g(r.generarPase(t.userId,t.uid))}),a(1,"Generar Pase"),i()}}function ai(l,p){if(l&1){let e=w();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),z(10,ei,2,2,"nz-tag",37)(11,ti,2,2,"nz-tag",37)(12,ii,2,2,"nz-tag",37)(13,ni,2,2,"nz-tag",37),i(),n(14,"td")(15,"a",38),a(16,"Ver Comprobante"),i()(),n(17,"td")(18,"a",39),v(19,"i",40),i(),n(20,"nz-dropdown-menu",null,15)(22,"ul",41)(23,"li",42),_("click",function(){let t=f(e).$implicit,r=u();return g(r.openModal(t.userId,t.customerName,t.stopInfo.routeName,t.stopInfo.round))}),a(24,"Ver Usuario"),i(),n(25,"li",42),_("click",function(){let t=f(e).$implicit,r=u();return g(r.validarPago(t.uid,t.userId))}),a(26,"Validar Pago"),i(),n(27,"li",42),_("click",function(){let t=f(e).$implicit,r=u();return g(r.rechazarPago(t.uid,t.userId))}),a(28,"Rechazar Pago"),i(),z(29,ri,2,0,"li",43),i()()()()}if(l&2){let e=p.$implicit,o=E(21),t=u();s(2),I(e.date),s(2),I(e.customerName),s(2),I(e.product.description),s(2),I(e.product.price),s(2),m("ngIf",e.status==="rejected"),s(),m("ngIf",e.status==="complete"),s(),m("ngIf",e.status==="accepted"),s(),m("ngIf",e.status==="pending"),s(2),xe("href",e.url,R),s(3),m("nzDropdownMenu",o),s(11),m("ngIf",t.readytoGenerateBoardinPass)}}function oi(l,p){l&1&&a(0,` Nuevo pase
`)}function si(l,p){if(l&1&&v(0,"nz-option",77),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function li(l,p){if(l&1&&(St(0),a(1),xt()),l&2){let e=u().$implicit;s(),h("(",e.frequencies,")")}}function di(l,p){if(l&1&&(n(0,"div")(1,"nz-option",78),v(2,"i",79),a(3),z(4,li,2,1,"ng-container",80),a(5),i()()),l&2){let e=p.$implicit;s(),m("nzLabel",e.name)("nzValue",e.id),s(2),h(" ",e.name," "),s(),m("ngIf",e.frequencies),s(),h(" $",e.price," ")}}function mi(l,p){if(l&1&&(n(0,"nz-option",78),v(1,"i",79),a(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.routeId),s(2),h(" ",e.name,"")}}function ci(l,p){if(l&1&&(n(0,"nz-option",78),v(1,"i",79),a(2),v(3,"br"),a(4),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.stopPointId),s(2),h(" ",e.name," "),s(2),h(" ",e.description," ")}}function pi(l,p){l&1&&(n(0,"div",66)(1,"nz-form-item")(2,"nz-form-label"),a(3,"Fecha Compromiso "),i(),v(4,"nz-date-picker",81),i()())}function ui(l,p){if(l&1){let e=w();n(0,"form",45),_("ngSubmit",function(){f(e);let t=u();return g(t.submitForm())}),n(1,"nz-form-item")(2,"nz-form-label",46),a(3,"Empresa"),i(),n(4,"nz-select",47),_("ngModelChange",function(t){f(e);let r=u();return g(r.onCustomerSelected(t))}),z(5,si,1,2,"nz-option",48),i()(),n(6,"nz-form-item")(7,"nz-form-label",46),a(8,"Servicio"),i(),n(9,"nz-select",49),_("ngModelChange",function(t){f(e);let r=u();return g(r.onProductSelected(t,r.products))}),z(10,di,6,5,"div",29),i()(),n(11,"nz-form-item")(12,"nz-form-label",46),a(13,"Operaci\xF3n"),i(),n(14,"nz-select",50),_("ngModelChange",function(t){f(e);let r=u();return g(r.onRouteSelected(t,r.routes))}),z(15,mi,3,3,"nz-option",51),i()(),n(16,"nz-form-item")(17,"nz-form-label",46),a(18,"Estaciones"),i(),n(19,"nz-select",52),z(20,ci,5,4,"nz-option",51),i()(),n(21,"nz-form-item")(22,"nz-form-label",46),a(23,"Turno"),i(),n(24,"nz-select",53),v(25,"nz-option",54)(26,"nz-option",55)(27,"nz-option",56),i()(),n(28,"nz-form-item")(29,"nz-form-label",46),a(30,"Tipo de Pago"),i(),n(31,"nz-select",57),_("ngModelChange",function(t){f(e);let r=u();return g(r.changePayment(t))}),v(32,"nz-option",58)(33,"nz-option",59)(34,"nz-option",60),i()(),n(35,"nz-form-item")(36,"div",61)(37,"div",62)(38,"nz-form-label"),a(39,"Cantidad a pagar "),i(),n(40,"nz-input-number",63),_("ngModelChange",function(t){f(e);let r=u();return g(r.onAmountChange(t))}),i()(),z(41,pi,5,0,"div",64),i()(),n(42,"div",61)(43,"div",62)(44,"nz-form-item")(45,"nz-form-label"),a(46,"Total a pagar"),i(),n(47,"nz-input-number",65),_("ngModelChange",function(t){f(e);let r=u();return g(r.onAmountChange(t))}),i()()(),n(48,"div",66)(49,"nz-form-item")(50,"nz-form-label"),a(51,"\xBFEs cortes\xEDa?"),i(),n(52,"nz-switch",67),_("ngModelChange",function(t){f(e);let r=u();return g(r.onCourtesyChange(t))}),i()()()(),n(53,"nz-form-item")(54,"nz-form-label",68),a(55,"Tipo de Referencia"),i(),n(56,"nz-select",69),v(57,"nz-option",70)(58,"nz-option",71)(59,"nz-option",72),i()(),n(60,"nz-form-item")(61,"nz-form-control")(62,"label",73),a(63,"Activar pase"),i()()(),n(64,"div",61)(65,"div",74)(66,"nz-form-item")(67,"nz-form-label"),a(68,"V\xE1lido desde"),i(),v(69,"nz-date-picker",75),i()(),n(70,"div",74)(71,"nz-form-item")(72,"nz-form-label"),a(73,"V\xE1lido hasta"),i(),n(74,"nz-date-picker",76),_("ngModelChange",function(t){f(e);let r=u();return g(r.onChangeValidTo(t))}),i()()()()()}if(l&2){let e=u();m("formGroup",e.validateForm),s(5),m("ngForOf",e.customers),s(5),m("ngForOf",e.products),s(5),m("ngForOf",e.routes),s(5),m("ngForOf",e.stopPoints),s(20),m("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar),s(),m("ngIf",e.isAnticipo),s(6),m("disabled",!1)("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar),s(27),m("nzDisabledDate",e.disabledDate)}}function hi(l,p){if(l&1){let e=w();n(0,"button",82),_("click",function(){f(e);let t=u();return g(t.handleCancel())}),a(1,"Cancelar"),i(),n(2,"button",83),_("click",function(){f(e);let t=u();return g(t.submitForm())}),a(3,"Generar Pase"),i()}if(l&2){let e=u();s(2),m("nzLoading",e.isConfirmLoading)}}function fi(l,p){if(l&1&&(n(0,"div")(1,"form",84)(2,"nz-row",85)(3,"nz-col",86)(4,"nz-form-label",87),a(5,"Cliente"),i()(),n(6,"nz-col",88)(7,"nz-form-control"),v(8,"input",89),i()()(),n(9,"nz-row",85)(10,"nz-col",86)(11,"nz-form-label",90),a(12,"Operaci\xF3n"),i()(),n(13,"nz-col",88)(14,"nz-form-control"),v(15,"input",91),i()()(),n(16,"nz-row",85)(17,"nz-col",86)(18,"nz-form-label",92),a(19,"Nombre"),i()(),n(20,"nz-col",88)(21,"nz-form-control"),v(22,"input",93),i()()(),n(23,"nz-row",85)(24,"nz-col",86)(25,"nz-form-label",94),a(26,"Horario"),i()(),n(27,"nz-col",88)(28,"nz-form-control"),v(29,"input",95),i()()(),n(30,"nz-row",85)(31,"nz-col",86)(32,"nz-form-label",96),a(33,"Tel\xE9fono"),i()(),n(34,"nz-col",88)(35,"nz-form-control"),v(36,"input",97),i()()(),n(37,"nz-row",85)(38,"nz-col",86)(39,"nz-form-label",98),a(40,"Correo"),i()(),n(41,"nz-col",88)(42,"nz-form-control"),v(43,"input",99),i()()(),n(44,"nz-row",85)(45,"nz-col",86)(46,"nz-form-label",100),a(47,"Identificaci\xF3n"),i()(),n(48,"nz-col",88)(49,"nz-form-control"),v(50,"input",101),i()()()()()),l&2){let e=u();s(),m("formGroup",e.viewDetalle),s(),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16)}}function gi(l,p){if(l&1){let e=w();n(0,"button",102),_("click",function(){f(e);let t=u();return g(t.handleCancelView())}),a(1,"Aceptar"),i()}}function _i(l,p){if(l&1&&(n(0,"div")(1,"form",84)(2,"nz-form-item")(3,"nz-form-label",103),a(4,"Estatus"),i(),n(5,"nz-form-control",104)(6,"nz-select",105),v(7,"nz-option",106),i()()()()()),l&2){let e=u();s(),m("formGroup",e.signupForm),s(2),m("nzSm",8)("nzXs",24),s(2),m("nzSm",16)("nzXs",24)}}function zi(l,p){if(l&1){let e=w();n(0,"button",102),_("click",function(){f(e);let t=u();return g(t.handleOKEdit())}),a(1,"Aceptar"),i(),n(2,"button",102),_("click",function(){f(e);let t=u();return g(t.handleCancelEdit())}),a(3,"Cancelar"),i()}}function vi(l,p){if(l&1&&v(0,"nz-option",114),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id)}}function Ci(l,p){if(l&1&&(n(0,"div")(1,"form",84)(2,"nz-form-item")(3,"nz-form-label",107),a(4,"Empresa "),i(),n(5,"nz-select",108),z(6,vi,1,2,"nz-option",109),i()(),n(7,"nz-form-item")(8,"nz-form-label",110),a(9,"Estatus"),i(),n(10,"nz-select",111),v(11,"nz-option",112)(12,"nz-option",113),i()()()()),l&2){let e=u();s(),m("formGroup",e.signupFormE),s(2),m("nzSpan",4),s(2),m("nzMaxTagCount",3),s(),m("ngForOf",e.listOfCustomer),s(2),m("nzSm",4),s(2),m("nzMaxTagCount",3)}}function Si(l,p){if(l&1){let e=w();n(0,"button",102),_("click",function(){f(e);let t=u();return g(t.handleOKEditE())}),a(1,"Aceptar"),i(),n(2,"button",102),_("click",function(){f(e);let t=u();return g(t.handleCancelEditE())}),a(3,"Cancelar"),i()}}var Xn=(()=>{class l{constructor(e,o,t){this.fb=e,this.messageService=o,this.afs=t,this.dataUsuariosList=[],this.dataEjecutoresList=[],this.dataTransferList=[],this.isEditModal=!1,this.isEditModalE=!1,this.isViewInfo=!1,this.isVisible1=!1,this.dashboardService=y(Te),this.authService=y(Q),this.usersService=y(ze),this.accountsService=y(Z),this.customersService=y(Fe),this.productsService=y(et),this.routesService=y(ae),this.stopSubscription$=new A,this.size="large",this.readytoGenerateBoardinPass=!1,this.currentUserSelected=[],this.products=[],this.stopPoints=[],this.paymentSelected="",this.productSelected=[],this.isConfirmLoading=!1,this.disabledDate=r=>!1,this.formatterPercent=r=>`${r} %`,this.parserPercent=r=>r.replace(" %",""),this.formatterDollar=r=>`$ ${r}`,this.parserDollar=r=>r.replace("$ ",""),this.isAnticipo=!1,this.isValidDescriptionPaymentType=!1,this.currentLine="",this.stopIdValue=""}ngOnInit(){this.authService.user.subscribe(o=>{this.user=o,this.user!==null&&this.user!==void 0&&this.user.idSegment!==void 0&&this.accountsService.getSegmentLevel(this.user.idSegment).pipe(V(this.stopSubscription$),C(t=>{let r=t.payload.id,d=t.payload.data();return S({id:r},d)}),k(t=>(this.infoSegment=t,t))).subscribe()}),this.signupForm=this.fb.group({status:[""],id:[""]}),this.signupFormE=this.fb.group({status:[""],id:[""],customerId:[""],customerName:[""]}),this.viewDetalle=this.fb.group({status:[""],id:[""],name:[""],customerId:[""],customerName:[""],email:[""],phoneNumber:[""],studentId:[""],defaultRouteName:[""],defaultRound:[""]}),this.validateForm=this.fb.group({active:[!0,[b.required]],amount:[0,[b.required]],authorization:[""],category:["",[b.required]],conciliated:[!1,[b.required]],creation_date:[new Date().toISOString(),[b.required]],currency:["MXN",[b.required]],customer_id:["",[b.required]],customerId:[""],date_created:[new Date,[b.required]],due_date:[new Date,[b.required]],description:["",[b.required]],error_message:[""],fee:this.fb.group({amount:[0],currency:["MXN"],tax:[0]}),is_courtesy:[!1],method:["cash",[b.required]],name:["",[b.required]],operation_date:[new Date().toISOString(),[b.required]],operation_type:["in",[b.required]],order_id:[""],payment_method:this.fb.group({barcode_url:[""],reference:[""],type:["cash"]}),price:[0,[b.required]],product_description:["",[b.required]],product_id:["",[b.required]],round:["",[b.required]],routeId:["",[b.required]],routeName:["",[b.required]],status:["completed",[b.required]],stopDescription:["",[b.required]],stopId:["",[b.required]],stopName:["",[b.required]],transaction_type:["charge",[b.required]],validFrom:[new Date,[b.required]],validTo:[new Date,[b.required]],isTaskIn:[!1,[b.required]],isTaskOut:[!1,[b.required]],isOpenpay:[!1,[b.required]],paidApp:["web",[b.required]],realValidTo:[],payment:["",[b.required]],amountPayment:[0,[b.required]],typePayment:[""],promiseDate:[new Date],baja:[""],fileURL:[""],frequencies:[""]});let e=new Date;this.validateForm.controls.promiseDate.setValue(e),this.validateForm.controls.validTo.setValue(""),this.validateForm.controls.validFrom.setValue(e),this.validateForm.get("stopId").valueChanges.subscribe(o=>{this.onStopPointSelected(o,this.stopPoints)})}fillData(){this.dataUsuariosList.length<=1&&(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.usersService.getPreRegisterInfoByCustomer(this.user.customerId).subscribe(e=>{this.dataUsuarios=e,this.dataUsuariosList=this.dataUsuarios}):this.usersService.getPreRegisterInfo().subscribe(e=>{this.dataUsuarios=e,this.dataUsuariosList=this.dataUsuarios}))}fillDataT(){this.dataTransferList.length<=1&&(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.usersService.getTransferInfoByCustomer(this.user.customerId).subscribe(e=>{this.dataTransfer=e,this.dataTransferList=this.dataTransfer}),this.accountsService.getAccountsByCustomer(this.user.customerId).pipe(V(this.stopSubscription$),C(e=>e.map(o=>{let t=o.payload.doc.id,r=o.payload.doc.data();return S({id:t},r)}))).subscribe(e=>{this.customers=e}),this.routesService.getProducts(this.user.customerId).pipe(V(this.stopSubscription$),C(e=>e.map(o=>{let t=o.payload.doc.id,r=o.payload.doc.data();return S({id:t},r)}))).subscribe(e=>{this.products=e})):this.usersService.getTransferInfo().subscribe(e=>{this.dataTransfer=e,console.log(this.dataTransfer),this.dataTransferList=this.dataTransfer,this.cCollection=this.afs.collection("customers",o=>o.where("active","==",!0)),this.customerSubscription=this.cCollection.snapshotChanges().pipe(C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.customers=o})}))}fillDataE(){this.dataEjecutoresList.length<=1&&(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.usersService.getPreRegisterInfoEByCustomer(this.user.customerId).subscribe(e=>{this.dataEjecutores=e,this.dataEjecutoresList=this.dataEjecutores}):this.usersService.getPreRegisterInfoE().subscribe(e=>{this.dataEjecutores=e,this.dataEjecutoresList=this.dataEjecutores})),this.infoSegment.nivelNum==1?this.accountsService.getAccountsByCustomer(this.user.customerId).pipe(V(this.stopSubscription$),C(e=>{let o=e.payload.id,t=e.payload.data();return S({id:o},t)})).subscribe(e=>{this.listOfCustomer=[e]}):this.accountsService.getAccounts().pipe(V(this.stopSubscription$),C(e=>e.map(o=>{let t=o.payload.doc.id,r=o.payload.doc.data();return S({id:t},r)}))).subscribe(e=>{this.listOfCustomer=e})}ngOnDestroy(){this.stopSubscription$.next(!1),this.stopSubscription$.complete(),this.dataUsuariosList=[],this.dataEjecutoresList=[]}showModalInE(e){this.signupFormE.controls.status.setValue(e.status),this.signupFormE.controls.id.setValue(e.uid),this.isEditModalE=!0}showModalIn(e){this.signupForm.controls.id.setValue(e.uid),this.signupForm.controls.status.setValue(e.status),this.isEditModal=!0}openModal(e,o,t,r){this.isViewInfo=!0,this.usersService.getUserInfo(e).subscribe(d=>{let c=d.payload.data();if(this.currentUserSelected=c,c){let x={id:c.displayName,name:c.displayName,studentId:c.studentId,phoneNumber:c.phoneNumber,email:c.email,customerName:o,customerId:c.customerId,defaultRouteName:t,defaultRound:r};this.viewDetalle.patchValue(S({},x))}})}searchUser(){}handleCancelEdit(){this.isEditModal=!1}handleCancelView(){this.isViewInfo=!1}handleCancelEditE(){this.isEditModalE=!1}handleOKEdit(){this.usersService.updateUserPreRegister(this.signupForm.controls.id.value,this.signupForm.controls.status.value),this.isEditModal=!1}handleOKEditE(){let e=this.signupFormE.value;this.usersService.updateUserPreRegisterE(this.signupFormE.controls.id.value,this.signupFormE.controls.status.value,this.signupFormE.controls.customerId.value,this.signupFormE.controls.customerName.value),this.isEditModalE=!1}handleCancel(){this.isVisible1=!1}handleOk(){this.isConfirmLoading=!0,setTimeout(()=>{this.isVisible1=!1,this.isConfirmLoading=!1},3e3)}initializeItems(){this.dataUsuarios=this.dataUsuariosList,this.dataEjecutores=this.dataEjecutoresList,this.dataTransfer=this.dataTransferList}getItems(e){let o=e;if(!o){this.dataUsuarios=this.dataUsuariosList.slice();return}let t=o.toLowerCase();this.dataUsuarios=this.dataUsuariosList.filter(r=>Object.values(r).some(d=>String(d).toLowerCase().includes(t)))}getItemsE(e){let o=e;if(!o){this.dataEjecutores=this.dataEjecutoresList.slice();return}let t=o.toLowerCase();this.dataEjecutores=this.dataEjecutoresList.filter(r=>Object.values(r).some(d=>String(d).toLowerCase().includes(t)))}getItemsT(e){let o=e;if(!o){this.dataTransfer=this.dataTransferList.slice();return}let t=o.toLowerCase();this.dataTransfer=this.dataTransferList.filter(r=>Object.values(r).some(d=>String(d).toLowerCase().includes(t)))}validarPago(e,o){return pt(this,null,function*(){(yield this.usersService.updateTransfer(e,o,"accepted"))?(this.sendMessage("sucess","Se valido el pago. Ahora puedes generar el pase de abordar."),this.readytoGenerateBoardinPass=!0):this.readytoGenerateBoardinPass=!1})}rechazarPago(e,o){return pt(this,null,function*(){(yield this.usersService.updateTransfer(e,o,"rejected"))?(this.sendMessage("sucess","Se rechazo el pago."),this.readytoGenerateBoardinPass=!1):this.readytoGenerateBoardinPass=!0})}onAmountChange(e){e>0&&this.validateForm.controls.is_courtesy.setValue(!1)}onProductSelected(e,o){this.productSelected=[];let r=tt.default.filter(o,d=>d.id==e)[0];this.productSelected=r,this.validateForm.controls.name.setValue(r.name),this.validateForm.controls.description.setValue(r.description),this.validateForm.controls.product_description.setValue(r.description),this.validateForm.controls.amount.setValue(r.price),this.validateForm.controls.is_courtesy.setValue(!1),this.validateForm.controls.price.setValue(r.price),this.validateForm.controls.category.setValue(r.category),this.validateForm.controls.validFrom.setValue(r.validFrom.toDate()),this.validateForm.controls.validTo.setValue(r.validTo.toDate()),this.validateForm.controls.realValidTo.setValue(r.validTo.toDate().toISOString()),this.validateForm.controls.isTaskIn.setValue(r.isTaskIn),this.validateForm.controls.isTaskOut.setValue(r.isTaskOut),this.validateForm.controls.frequencies.setValue(r.frequencies)}generarPase(e,o){this.usersService.getUserInfo(e).subscribe(t=>{let r=t.payload.data();this.currentUserSelected=r,this.currentLine=o,this.isVisible1=!0})}submitForm(){var e,o=0;let t=this.validateForm.controls.validTo.value||new Date,r=this.validateForm.controls.is_courtesy.value||!1;var d=this.validateForm.controls.promiseDate.value||"",c=this.validateForm.controls.creation_date.value.toString();let x=this.validateForm.controls.typePayment.value;this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId),this.validateForm.controls.customerId.setValue(this.currentUserSelected.customerId);let F=this.validateForm.controls.amount.value,T=this.validateForm.controls.payment.value;T=="Anticipo"&&(F=this.validateForm.controls.amountPayment.value);let D=this.validateForm.controls.frequencies.value||0;D>0&&(o=Number(D)*80);let Pe=this.productSelected?.weeks||0,Be=this.fb.group({}),mt=this.productSelected?.rangeWeeks||{};for(let[Se,pe]of Object.entries(mt))Be.addControl(Se,this.fb.control(pe));T=="Mensualidad"&&(d=this.validateForm.controls.validTo.value||new Date);let Me={authorization:"portalAuth",operation_type:"in",method:this.validateForm.controls.payment.value,transaction_type:"charge",card:{type:"",brand:"",address:"",card_number:"",holder_name:"",expiration_year:"",expiration_month:"",allows_charges:"",allows_payouts:"",bank_name:"",bank_code:"",points_card:"",points_type:""},status:this.validateForm.controls.status.value,conciliated:!1,creation_date:c,operation_date:new Date().toISOString(),description:"Transfer validada  a traves de portal",error_message:"",order_id:"portalOrder",currency:"MXN",amount:this.validateForm.controls.amountPayment.value,customer:{name:this.currentUserSelected.firstName,last_name:this.currentUserSelected.lastName,email:this.currentUserSelected.email,phone_number:this.currentUserSelected.phoneNumber,address:"",creation_date:"",external_id:"",clabe:""},product:{product_id:this.validateForm.controls.product_id.value,amountTrips:o,frequencies:D,rangeWeeks:Be.value,weeks:Pe,name:this.validateForm.controls.product_description.value},customerId:this.currentUserSelected.customerId,active:!0,category:"permanente",date_created:new Date().toISOString(),product_description:"Transfer validada  a traves de portal",product_id:this.validateForm.controls.product_id.value,name:this.validateForm.controls.name.value,isTaskIn:"false",isTaskOut:"false",type:"Servicio",isOpenpay:!1,paidApp:"portal",price:this.validateForm.controls.price.value,round:this.validateForm.controls.round.value,routeId:this.validateForm.controls.routeId.value,routeName:this.validateForm.controls.routeName.value,stopDescription:"",stopId:this.stopIdValue,stopName:this.validateForm.controls.stopDescription.value,validFrom:this.validateForm.controls.validFrom.value,validTo:t,idBoardingPass:this.currentUserSelected.uid,idPurchasteRequest:"",is_courtesy:r,typePayment:T,amountTrips:o,currentTrips:0};this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,Me).then(Se=>{this.isConfirmLoading=!1,this.customersService.getLatestValidUserPurchasesAdvance(this.currentUserSelected.uid,2,d,T,c).pipe(ue(1),C(pe=>pe.map(je=>{let Ht=je.payload.doc.data(),Wt=je.payload.doc.id;return S({id:Wt},Ht)}))).subscribe({next:pe=>{this.customersService.saveBoardingPassDetailToUserPurchaseCollection(this.currentUserSelected.uid,pe[0].id,Me).then(()=>{this.customersService.createPurchaseCloud(Me,this.currentUserSelected,pe[0].id)}).catch(je=>{this.sendMessage("error",je)})},error:pe=>{this.sendMessage("error",pe)}})}).catch(Se=>{this.sendMessage("error",Se)})}sendMessage(e,o){this.messageService.create(e,o)}enviarMensajeConfirmacion(e,o){let t={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"Apps And Informa",msg:"Se confirm\xF3 la informaci\xF3n y se creo el pase de abordar con \xE9xito.",requestId:"suhB7YFAh6PYXCRuJhfD",token:o,uid:e,result:""},r={timestamp:new Date,title:"Apps And Informa General",from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",requestId:"suhB7YFAh6PYXCRuJhfD",body:"Se confirm\xF3 la informaci\xF3n y se creo el pase de abordar con \xE9xito.",token:o,uid:e};this.dashboardService.setMessage(r,e),this.dashboardService.setChatMessage(t).then(()=>{})}onCustomerSelected(e){let o=this.validateForm.get("customerId").value;this.routesService.getProducts(o).pipe(V(this.stopSubscription$),C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return S({id:d},c)}))).subscribe(t=>{this.products=t}),this.routesService.getRoutes(o).pipe(V(this.stopSubscription$),C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return S({id:d},c)}))).subscribe(t=>{this.routes=t})}onRouteSelected(e,o){let r=tt.default.filter(o,c=>c.routeId==e)[0];this.validateForm.controls.routeName.setValue(r.name);let d=this.validateForm.get("customerId").value;this.accountsService.getStopsByCustomer(d,e).pipe(V(this.stopSubscription$),C(c=>c.map(x=>{let F=x.payload.doc.id,T=x.payload.doc.data();return S({id:F},T)}))).subscribe(c=>{this.stopPoints=c})}onChangeValidTo(e){let o=this.validateForm.controls.validFrom.value}onCourtesyChange(e){e&&this.validateForm.controls.amount.setValue(0)}changePayment(e){this.validateForm.controls.amountPayment.setValue(0),this.paymentSelected=e,e=="Mensualidad"?(this.isValidDescriptionPaymentType=!1,this.isAnticipo=!1,this.validateForm.controls.amountPayment.setValue(this.validateForm.controls.amount.value)):e=="Anticipo"?(this.isValidDescriptionPaymentType=!0,this.isAnticipo=!0,this.validateForm.controls.amountPayment.setValue(0)):(this.isAnticipo=!1,this.isValidDescriptionPaymentType=!0,this.validateForm.controls.amountPayment.setValue(0))}onStopPointSelected(e,o){let r=tt.default.filter(this.stopPoints,d=>d.stopPointId===e)[0];r&&(this.stopIdValue=r.id,this.validateForm.patchValue({stopName:r.name,stopDescription:r.description}))}static{this.\u0275fac=function(o){return new(o||l)(O(J),O(Y),O(X))}}static{this.\u0275cmp=U({type:l,selectors:[["app-payments"]],viewQuery:function(o,t){if(o&1&&($e(Xt,5),$e(Yt,5),$e(Qt,5)),o&2){let r;qe(r=He())&&(t.searchbar=r.first),qe(r=He())&&(t.searchbarE=r.first),qe(r=He())&&(t.searchbarC=r.first)}},decls:113,vars:20,consts:[["searchBar",""],["basicTable",""],["searchBarE",""],["basicTable11",""],["searchBarC",""],["basicTable2",""],["modalTitle",""],["modalContent",""],["modalPassFooter",""],["modalContent3",""],["modalFooterEdit1",""],["modalContent2",""],["modalFooterEdit",""],["modalContent112",""],["modalFooterEditE",""],["chatSetting","nzDropdownMenu"],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],["nzTitle","Validaciones"],["nzTitle","Usuarios"],[1,"chat-list"],[1,"chat-user-tool"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzTheme","outline",1,"search-icon","p-r-10","font-size-20"],["placeholder","Buscar",3,"keyup"],["ngSkipHydration","",3,"nzData"],[4,"ngFor","ngForOf"],["nzTitle","Ejecutores"],["nzTitle","Comprobantes"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter"],["nzTitle","Detalle Usuario","nzWidth","600px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzFooter","nzContent"],["nzTitle","Editar Usuarios ","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzFooter","nzContent"],["nzTitle","Editar Ejecutores","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzFooter","nzContent"],["nz-button","","nzType","link",2,"color","#4F6F57","border","none",3,"click","nzSize"],[3,"nzColor",4,"ngIf"],["target","_blank",3,"href"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","nzTheme","outline"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-item","",3,"click",4,"ngIf"],[3,"nzColor"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],[2,"width","100px"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Seleccione una Empresa",2,"width","320px",3,"ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["formControlName","product_id","nzAllowClear","","nzPlaceHolder","Seleccionar producto / servicio",2,"width","320px",3,"ngModelChange"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","320px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","stopId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",2,"width","320px"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","320px"],["nzValue","D\xEDa","nzLabel","D\xEDa"],["nzValue","Tarde","nzLabel","Tarde"],["nzValue","Noche","nzLabel","Noche"],["formControlName","payment","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de Pago",2,"width","320px",3,"ngModelChange"],["nzValue","Mensualidad","nzLabel","Mensualidad"],["nzValue","Anticipo","nzLabel","Anticipo"],["nzValue","Liquidacion","nzLabel","Liquidaci\xF3n"],[1,"row"],[1,"col-md-7"],["formControlName","amountPayment",3,"ngModelChange","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["class","col-md-5",4,"ngIf"],["formControlName","amount",3,"ngModelChange","disabled","nzMin","nzMax","nzStep","nzFormatter","nzParser"],[1,"col-md-5"],["formControlName","is_courtesy","nzCheckedChildren","Si","nzUnCheckedChildren","No",3,"ngModelChange"],[2,"width","120px"],["formControlName","typePayment","nzAllowClear","","nzPlaceHolder","Selecciona una Referencia",2,"width","300px"],["nzValue","Transferencia","nzLabel","Transferencia"],["nzValue","Efectivo","nzLabel","Efectivo"],["nzValue","Sistema","nzLabel","Pago por Sistema"],["nz-checkbox","","formControlName","active"],[1,"col-md-6"],["formControlName","validFrom"],["formControlName","validTo",3,"ngModelChange","nzDisabledDate"],[3,"nzValue","nzLabel"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""],[4,"ngIf"],["formControlName","promiseDate",2,"width","150px"],["nz-button","",3,"click"],["nz-button","",3,"click","nzLoading"],["nz-form","",3,"formGroup"],[3,"nzGutter"],["nzSpan","6"],["nzFor","customerName"],["nzSpan","18"],["nz-input","","id","customerName","formControlName","customerName"],["nzFor","defaultRouteName"],["nz-input","","id","defaultRouteName","formControlName","defaultRouteName"],["nzFor","name"],["nz-input","","id","name","formControlName","name"],["nzFor","defaultRound"],["nz-input","","id","defaultRound","formControlName","defaultRound"],["nzFor","phoneNumber"],["nz-input","","id","phoneNumber","formControlName","phoneNumber"],["nzFor","email"],["nz-input","","id","email","formControlName","email"],["nzFor","studentId"],["nz-input","","id","studentId","formControlName","studentId"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nzFor","status",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["formControlName","status"],["nzValue","active","nzLabel","Activo"],["nzFor","label",3,"nzSpan"],["formControlName","customerId","nzPlaceHolder","Selecciona una empresa",2,"width","250px",3,"nzMaxTagCount"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzFor","status",3,"nzSm"],["formControlName","status","nzPlaceHolder","Selecciona un status",2,"width","250px",3,"nzMaxTagCount"],["nzValue","accept","nzLabel","Aceptado"],["nzValue","reject","nzLabel","Rechazado"],[3,"nzLabel","nzValue"]],template:function(o,t){if(o&1){let r=w();n(0,"div",16)(1,"div",17)(2,"nz-page-header",18)(3,"nz-page-header-title",19),a(4,"Validaciones"),i(),n(5,"nz-page-header-subtitle"),a(6,"Listado de validaciones por aprobar "),i()()(),n(7,"div",20)(8,"nz-tabset"),v(9,"nz-tab",21),n(10,"nz-tab",22)(11,"div",23)(12,"div",24)(13,"a",25),_("click",function(){return f(r),g(t.fillData())}),a(14,"Cargar Usuarios"),i(),v(15,"i",26),n(16,"input",27,0),_("keyup",function(){f(r);let c=E(17);return g(t.getItems(c.value))}),i(),n(18,"a",25),_("click",function(){return f(r),g(t.searchUser())}),a(19,"Buscar Usuario"),i()(),n(20,"div")(21,"nz-table",28,1)(23,"thead")(24,"tr")(25,"th"),a(26,"Empresa"),i(),n(27,"th"),a(28,"Nombre"),i(),n(29,"th"),a(30,"Email"),i(),n(31,"th"),a(32,"Estatus"),i(),n(33,"th"),a(34,"..."),i()()(),n(35,"tbody"),z(36,Kt,12,6,"tr",29),i()()()()(),n(37,"nz-tab",30)(38,"div",23)(39,"div",24)(40,"a",25),_("click",function(){return f(r),g(t.fillDataE())}),a(41,"Cargar Ejecutores"),i(),v(42,"i",26),n(43,"input",27,2),_("keyup",function(){f(r);let c=E(44);return g(t.getItemsE(c.value))}),i()(),n(45,"div")(46,"nz-table",28,3)(48,"thead")(49,"tr")(50,"th"),a(51,"Empresa"),i(),n(52,"th"),a(53,"Nombre"),i(),n(54,"th"),a(55,"Cliente"),i(),n(56,"th"),a(57,"Estatus"),i(),n(58,"th"),a(59,"..."),i()()(),n(60,"tbody"),z(61,Zt,12,6,"tr",29),i()()()()(),n(62,"nz-tab",31)(63,"div",23)(64,"div",24)(65,"a",25),_("click",function(){return f(r),g(t.fillDataT())}),a(66,"Cargar Comprobantes"),i(),v(67,"i",26),n(68,"input",27,4),_("keyup",function(){f(r);let c=E(69);return g(t.getItemsT(c.value))}),i()(),n(70,"div")(71,"nz-table",28,5)(73,"thead")(74,"tr")(75,"th"),a(76,"Fecha"),i(),n(77,"th"),a(78,"Empresa"),i(),n(79,"th"),a(80,"Producto"),i(),n(81,"th"),a(82,"Costo Producto"),i(),n(83,"th"),a(84,"Estatus"),i(),n(85,"th"),a(86,"Comprobante"),i(),n(87,"th"),a(88,"..."),i()()(),n(89,"tbody"),z(90,ai,30,11,"tr",29),i()()()()()()()(),n(91,"nz-modal",32),N("nzVisibleChange",function(c){return f(r),M(t.isVisible1,c)||(t.isVisible1=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.handleCancel())}),z(92,oi,1,0,"ng-template",null,6,L)(94,ui,75,18,"ng-template",null,7,L)(96,hi,4,1,"ng-template",null,8,L),i(),n(98,"nz-modal",33),N("nzVisibleChange",function(c){return f(r),M(t.isViewInfo,c)||(t.isViewInfo=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.handleCancelView())}),z(99,fi,51,8,"ng-template",null,9,L)(101,gi,2,0,"ng-template",null,10,L),i(),n(103,"nz-modal",34),N("nzVisibleChange",function(c){return f(r),M(t.isEditModal,c)||(t.isEditModal=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.handleCancelEdit())}),z(104,_i,8,5,"ng-template",null,11,L)(106,zi,4,0,"ng-template",null,12,L),i(),n(108,"nz-modal",35),N("nzVisibleChange",function(c){return f(r),M(t.isEditModalE,c)||(t.isEditModalE=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.handleCancelEditE())}),z(109,Ci,13,6,"ng-template",null,13,L)(111,Si,4,0,"ng-template",null,14,L),i()}if(o&2){let r=E(22),d=E(47),c=E(72),x=E(93),F=E(95),T=E(97),D=E(100),Pe=E(102),Be=E(105),mt=E(107),Me=E(110),Se=E(112);s(2),m("nzGhost",!1),s(19),m("nzData",t.dataUsuarios),s(15),m("ngForOf",r.data),s(10),m("nzData",t.dataEjecutores),s(15),m("ngForOf",d.data),s(10),m("nzData",t.dataTransfer),s(19),m("ngForOf",c.data),s(),P("nzVisible",t.isVisible1),m("nzTitle",x)("nzContent",F)("nzFooter",T),s(7),P("nzVisible",t.isViewInfo),m("nzFooter",Pe)("nzContent",D),s(5),P("nzVisible",t.isEditModal),m("nzFooter",mt)("nzContent",Be),s(5),P("nzVisible",t.isEditModalE),m("nzFooter",Se)("nzContent",Me)}},dependencies:[B,j,ye,Ee,Je,Ye,Xe,Ie,Qe,fe,Mt,Ke,de,oe,se,ce,le,me,we,Nt,Ft,It,wt,Vt,Tt,_e,K,ge,ie,ee,te,Ze,ne,re,Ge,$,q,H,W,G,Ce,ve,Ot]})}}return l})();var Ue=ct(ft());function xi(l,p){if(l&1&&(n(0,"nz-option",29),v(1,"i",30),a(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(2),h(" ",e.name,"")}}function bi(l,p){if(l&1&&(n(0,"nz-option",29),v(1,"i",30),a(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.routeId),s(2),h(" ",e.name,"")}}function yi(l,p){if(l&1){let e=w();n(0,"th",31),N("nzSortOrderChange",function(t){let r=f(e).$implicit;return M(r.sortOrder,t)||(r.sortOrder=t),g(t)}),a(1),i()}if(l&2){let e=p.$implicit;P("nzSortOrder",e.sortOrder),m("nzSortFn",e.sortFn)("nzFilters",e.listOfFilter)("nzFilterFn",e.filterFn),s(),h(" ",e.name," ")}}function Ei(l,p){if(l&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),a(10),i(),n(11,"td"),a(12),i(),n(13,"td"),a(14),i()()),l&2){let e=p.$implicit;s(2),I(e.turno),s(2),I(e.roundTrip),s(2),I(e.displayName),s(2),I(e.studentId),s(2),I(e.phoneNumber),s(2),I(e.email),s(2),I(e.status)}}function Ii(l,p){if(l&1&&(n(0,"nz-option",29),v(1,"i",30),a(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(2),h(" ",e.name,"")}}function Fi(l,p){if(l&1&&(n(0,"nz-option",29),v(1,"i",30),a(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.routeId),s(2),h(" ",e.name,"")}}function wi(l,p){if(l&1){let e=w();n(0,"th",31),N("nzSortOrderChange",function(t){let r=f(e).$implicit;return M(r.sortOrder,t)||(r.sortOrder=t),g(t)}),a(1),i()}if(l&2){let e=p.$implicit;P("nzSortOrder",e.sortOrder),m("nzSortFn",e.sortFn)("nzFilters",e.listOfFilter)("nzFilterFn",e.filterFn),s(),h(" ",e.name," ")}}function Vi(l,p){if(l&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),a(10),i(),n(11,"td"),a(12),i(),n(13,"td"),a(14),i()()),l&2){let e=p.$implicit;s(2),I(e.turno),s(2),I(e.roundTrip),s(2),I(e.displayName),s(2),I(e.studentId),s(2),I(e.phoneNumber),s(2),I(e.email),s(2),I(e.status)}}function Ti(l,p){if(l&1&&(n(0,"nz-option",29),a(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.routeId),s(),I(e.name)}}function Di(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.lunes),"")}}function Pi(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.martes),"")}}function Mi(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.miercoles),"")}}function Ni(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.jueves),"")}}function Oi(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.viernes),"")}}function Li(l,p){if(l&1&&(n(0,"tr")(1,"td")(2,"nz-tag",43),a(3),i()(),n(4,"td")(5,"nz-tag",43),a(6),i(),z(7,Di,2,2,"nz-tag",45),i(),n(8,"td")(9,"nz-tag",43),a(10),i(),z(11,Pi,2,2,"nz-tag",45),i(),n(12,"td")(13,"nz-tag",43),a(14),i(),z(15,Mi,2,2,"nz-tag",45),i(),n(16,"td")(17,"nz-tag",43),a(18),i(),z(19,Ni,2,2,"nz-tag",45),i(),n(20,"td")(21,"nz-tag",43),a(22),i(),z(23,Oi,2,2,"nz-tag",45),i()()),l&2){let e=p.$implicit,o=u(2);s(2),m("nzColor","blue"),s(),h(" ",e.time,""),s(2),m("nzColor","blue"),s(),h(" ",e.lunes,""),s(),m("ngIf",o.calculateRemaining(e.lunes)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.martes,""),s(),m("ngIf",o.calculateRemaining(e.martes)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.miercoles,""),s(),m("ngIf",o.calculateRemaining(e.miercoles)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.jueves,""),s(),m("ngIf",o.calculateRemaining(e.jueves)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.viernes,""),s(),m("ngIf",o.calculateRemaining(e.viernes)!==0)}}function ki(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.lunes),"")}}function Ri(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.martes),"")}}function Ai(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.miercoles),"")}}function Ui(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.jueves),"")}}function Bi(l,p){if(l&1&&(n(0,"nz-tag",43),a(1),i()),l&2){let e=u().$implicit,o=u(2);m("nzColor","red"),s(),h(" ",o.calculateRemaining(e.viernes),"")}}function ji(l,p){if(l&1&&(n(0,"tr")(1,"td")(2,"nz-tag",43),a(3),i()(),n(4,"td")(5,"nz-tag",43),a(6),i(),z(7,ki,2,2,"nz-tag",45),i(),n(8,"td")(9,"nz-tag",43),a(10),i(),z(11,Ri,2,2,"nz-tag",45),i(),n(12,"td")(13,"nz-tag",43),a(14),i(),z(15,Ai,2,2,"nz-tag",45),i(),n(16,"td")(17,"nz-tag",43),a(18),i(),z(19,Ui,2,2,"nz-tag",45),i(),n(20,"td")(21,"nz-tag",43),a(22),i(),z(23,Bi,2,2,"nz-tag",45),i()()),l&2){let e=p.$implicit,o=u(2);s(2),m("nzColor","blue"),s(),h(" ",e.time,""),s(2),m("nzColor","blue"),s(),h(" ",e.lunes,""),s(),m("ngIf",o.calculateRemaining(e.lunes)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.martes,""),s(),m("ngIf",o.calculateRemaining(e.martes)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.miercoles,""),s(),m("ngIf",o.calculateRemaining(e.miercoles)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.jueves,""),s(),m("ngIf",o.calculateRemaining(e.jueves)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.viernes,""),s(),m("ngIf",o.calculateRemaining(e.viernes)!==0)}}function $i(l,p){if(l&1){let e=w();n(0,"nz-tab",32)(1,"div",9)(2,"form",10),_("ngSubmit",function(){f(e);let t=u();return g(t.submitFormPaid())}),n(3,"table",11)(4,"tr")(5,"td",33)(6,"nz-form-item")(7,"nz-form-label",13),a(8,"Empresa"),i(),v(9,"input",34),i()()(),n(10,"tr")(11,"td",33)(12,"nz-form-item")(13,"nz-form-label",13),a(14,"Operaci\xF3n"),i(),n(15,"nz-select",35),_("ngModelChange",function(t){f(e);let r=u();return g(r.onRoutesSelect(t))}),z(16,Ti,2,3,"nz-option",15),i(),n(17,"label",36),_("ngModelChange",function(t){f(e);let r=u();return g(r.onCheckboxChange(t))}),N("ngModelChange",function(t){f(e);let r=u();return M(r.chkBoardingP,t)||(r.chkBoardingP=t),g(t)}),a(18,"Pases Activos"),i()()(),n(19,"td",33)(20,"nz-form-item")(21,"nz-form-label",13),a(22,"Producto"),i(),n(23,"nz-select",37),_("ngModelChange",function(t){f(e);let r=u();return g(r.onProductSelect(t))}),n(24,"nz-option",29),a(25,"Cami\xF3n"),i(),n(26,"nz-option",29),a(27,"Camioneta"),i()(),v(28,"input",38),i()()(),n(29,"button",39),_("click",function(){f(e);let t=u();return g(t.submitM())}),a(30,"Aceptar"),i()(),n(31,"nz-table",40,1)(33,"thead")(34,"tr",41)(35,"th"),a(36,"Lunes"),i(),n(37,"th"),a(38,"Martes"),i(),n(39,"th"),a(40,"Miercoles"),i(),n(41,"th"),a(42,"Jueves"),i(),n(43,"th"),a(44,"Viernes"),i()()(),n(45,"tbody")(46,"tr",41)(47,"th"),a(48),i(),n(49,"th"),a(50),i(),n(51,"th"),a(52),i(),n(53,"th"),a(54),i(),n(55,"th"),a(56),i()()()(),n(57,"nz-table",42,1)(59,"thead")(60,"tr")(61,"th"),a(62,"Horario"),i(),n(63,"th"),a(64,"Lunes"),i(),n(65,"th"),a(66,"Martes"),i(),n(67,"th"),a(68,"Miercoles"),i(),n(69,"th"),a(70,"Jueves"),i(),n(71,"th"),a(72,"Viernes"),i()()(),n(73,"tbody"),z(74,Li,24,17,"tr",25),i(),n(75,"tfoot")(76,"tr",41)(77,"td")(78,"nz-tag",43),a(79),i()(),n(80,"td")(81,"nz-tag",43),a(82),i()(),n(83,"td")(84,"nz-tag",43),a(85),i()(),n(86,"td")(87,"nz-tag",43),a(88),i()(),n(89,"td")(90,"nz-tag",43),a(91),i()(),n(92,"td")(93,"nz-tag",43),a(94),i()()()()(),n(95,"nz-table",44,2)(97,"thead")(98,"tr")(99,"th"),a(100,"Horario"),i(),n(101,"th"),a(102,"Lunes"),i(),n(103,"th"),a(104,"Martes"),i(),n(105,"th"),a(106,"Miercoles"),i(),n(107,"th"),a(108,"Jueves"),i(),n(109,"th"),a(110,"Viernes"),i()()(),n(111,"tbody"),z(112,ji,24,17,"tr",25),i(),n(113,"tfoot")(114,"tr",41)(115,"td")(116,"nz-tag",43),a(117),i()(),n(118,"td")(119,"nz-tag",43),a(120),i()(),n(121,"td")(122,"nz-tag",43),a(123),i()(),n(124,"td")(125,"nz-tag",43),a(126),i()(),n(127,"td")(128,"nz-tag",43),a(129),i()(),n(130,"td")(131,"nz-tag",43),a(132),i()()()()(),v(133,"nz-form-item"),i()()()}if(l&2){let e=u();s(2),m("formGroup",e.validateFormM),s(14),m("ngForOf",e.routesM),s(),P("ngModel",e.chkBoardingP),s(7),m("nzLabel",e.camion)("nzValue",e.camion),s(2),m("nzLabel",e.camioneta)("nzValue",e.camioneta),s(22),be("Cr\xE9ditos: (",e.LunesFinal," / ",e.sumaTotal,") // ",e.porcentajeLunes.toFixed(2)," %"),s(2),be("Cr\xE9ditos: (",e.MartesFinal," / ",e.sumaTotal,") // ",e.porcentajeMartes.toFixed(2)," %"),s(2),be("Cr\xE9ditos: (",e.MiercolesFinal," / ",e.sumaTotal,") // ",e.porcentajeMiercoles.toFixed(2)," %"),s(2),be("Cr\xE9ditos: (",e.JuevesFinal," / ",e.sumaTotal,") // ",e.porcentajeJueves.toFixed(2)," %"),s(2),be("Cr\xE9ditos: (",e.ViernesFinal," / ",e.sumaTotal,") // ",e.porcentajeViernes.toFixed(2)," %"),s(),m("nzData",e.dataSet),s(17),m("ngForOf",e.dataSet),s(4),m("nzColor","green"),s(),h(" Total : ",e.grantotal,""),s(2),m("nzColor","green"),s(),h(" ",e.totalLunes,""),s(2),m("nzColor","green"),s(),h(" ",e.totalMartes,""),s(2),m("nzColor","green"),s(),h(" ",e.totalViernes,""),s(2),m("nzColor","green"),s(),h(" ",e.totalJueves,""),s(2),m("nzColor","green"),s(),h(" ",e.totalViernes,""),s(),m("nzData",e.dataSetEnd),s(17),m("ngForOf",e.dataSetEnd),s(4),m("nzColor","green"),s(),h(" Total : ",e.grantotalE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalLunesE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalMartesE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalViernesE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalJuevesE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalViernesE,"")}}var dr=(()=>{class l{constructor(e,o,t){this.afs=e,this.messageService=o,this.fb=t,this.isMederos=!1,this.customers=[],this.customerMed=[],this.accountId$=new A,this.routeId$=new A,this.stopSubscription$=new A,this.rowDataPay=[],this.rowData=[],this.userRoute=!1,this.userRouteP=!1,this.submitPayment=!0,this.contenedores="",this.contenedoresPay="",this.rowDataPre=[],this.rowDataPush=[],this.customersService=y(Fe),this.routesService=y(ae),this.usersService=y(ze),this.authService=y(Q),this.accountsService=y(Z),this.productsService=y(et),this.infoSegment=[],this.dataSet=[{time:"",lunes:0,martes:0,miercoles:0,jueves:0,viernes:0}],this.dataSetEnd=[{time:"",lunes:0,martes:0,miercoles:0,jueves:0,viernes:0}],this.lunesP=0,this.martesP=0,this.miercolesP=0,this.juevesP=0,this.viernesP=0,this.lunesE=0,this.martesE=0,this.miercolesE=0,this.juevesE=0,this.viernesE=0,this.totalLunes=0,this.totalMartes=0,this.totalMiercoles=0,this.totalJueves=0,this.totalViernes=0,this.grantotal=0,this.LunesFinal=0,this.MartesFinal=0,this.MiercolesFinal=0,this.JuevesFinal=0,this.ViernesFinal=0,this.countE=0,this.countS=0,this.porcentajeLunes=0,this.porcentajeMartes=0,this.porcentajeMiercoles=0,this.porcentajeJueves=0,this.porcentajeViernes=0,this.sumaTotal=0,this.chkBoardingP=!1,this.totalLunesE=0,this.totalMartesE=0,this.totalMiercolesE=0,this.totalJuevesE=0,this.totalViernesE=0,this.grantotalE=0,this.carro=0,this.asientos=0,this.transportType="",this.camioneta="Camioneta",this.camion="Cami\xF3n",this.listOfColumns=[{name:"Turno",sortOrder:null,sortFn:(r,d)=>r.turno.localeCompare(d.turno),listOfFilter:[],filterFn:(r,d)=>r.some(c=>d.turno.indexOf(c)!==-1)},{name:"Tipo de Viaje",sortOrder:null,sortFn:(r,d)=>r.roundTrip.localeCompare(d.roundTrip),listOfFilter:[],filterFn:(r,d)=>r.some(c=>d.roundTrip.indexOf(c)!==-1)},{name:"Nombre",sortOrder:null,sortFn:(r,d)=>r.displayName.localeCompare(d.displayName),listOfFilter:[],filterFn:(r,d)=>r.some(c=>d.displayName.indexOf(c)!==-1)},{name:"Identificaci\xF3n",sortOrder:null,sortFn:null,listOfFilter:[],filterFn:null},{name:"Telefono",sortOrder:null,sortFn:null,listOfFilter:[],filterFn:null},{name:"Email",sortOrder:null,sortFn:null,listOfFilter:[],filterFn:null},{name:"Estatus",sortOrder:null,sortFn:null,listOfFilter:[],filterFn:null}],this.authService.user.subscribe(r=>{this.user=r,this.user!==null&&this.user!==void 0&&this.user.idSegment!==void 0&&this.accountsService.getSegmentLevel(this.user.idSegment).pipe(V(this.stopSubscription$),C(d=>{let c=d.payload.id,x=d.payload.data();return S({id:c},x)}),k(d=>(this.infoSegment=d,this.fillData(),d))).subscribe()})}ngOnInit(){this.validateForm=this.fb.group({customerId:["",[b.required]],customerName:[],routeId:["",[b.required]],routeName:["",[b.required]],round:["",[b.required]]}),this.validateFormP=this.fb.group({customerId:["",[b.required]],customerName:[],routeId:["",[b.required]],routeName:["",[b.required]],round:["",[b.required]]}),this.validateFormM=this.fb.group({customerId:["",[b.required]],customerName:[],routeId:["",[b.required]],productId:["",[b.required]],asientos:[0,b.required],chkBoardingP:[!1]})}fillData(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.cDocument=this.afs.collection("customers").doc(this.user.customerId),this.customerSubscription=this.cDocument.snapshotChanges().pipe(C(e=>{let o=e.payload.id,t=e.payload.data();return S({id:o},t)})).subscribe(e=>{this.isMederos=!0,this.customers=[e];let o=this.customers.filter(t=>t.isCarrusel);o.length>0&&(this.customerMed=o,this.getRoutesForMed(this.customerMed))})):(this.cCollection=this.afs.collection("customers",e=>e.where("active","==",!0)),this.customerSubscription=this.cCollection.snapshotChanges().pipe(C(e=>e.map(o=>{let t=o.payload.doc.id,r=o.payload.doc.data();return S({id:t},r)}))).subscribe(e=>{this.customers=e;let o=this.customers.filter(t=>t.isCarrusel);o.length>0&&(this.isMederos=!0,this.customerMed=o,this.getRoutesForMed(this.customerMed))}))}getRoutesForMed(e){this.validateFormM.controls.customerName.setValue(e[0].name),this.validateFormM.controls.customerId.setValue(e[0].id),this.routesService.getRoutes(e[0].id).pipe(V(this.stopSubscription$),C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.routesM=o}),this.productsService.getActiveProducts(e[0].id).pipe(V(this.stopSubscription$),C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.products=o})}submitM(){if(this.carro=this.validateFormM.get("asientos")?.value,this.validateFormM.valid){let e=this.validateFormM.get("customerId")?.value,o=this.validateFormM.get("routeId")?.value;this.chkBoardingP?this.routesService.getQuotesByRouteByBoardingPass(e,o,this.transportType).pipe(V(this.stopSubscription$),C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return Ne(S({},c),{id:d})})),C(t=>t.filter(r=>r.quotesData&&Array.isArray(r.quotesData)&&r.quotesData.some(d=>d.transportType===this.transportType))),C(t=>t.reduce((r,d)=>{let c=d.quotesData.filter(x=>x.transportType===this.transportType);return r.concat(c)},[]))).subscribe(t=>{t.length===0?this.sendMessage("info","No existen registros con estos criterios."):this.createDataSet(t)}):this.routesService.getQuotesByRouteandProgram(e,o,this.transportType).pipe(V(this.stopSubscription$),C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return Ne(S({},c),{id:d})}))).subscribe(t=>{t.length==0&&this.sendMessage("info","No existen registros con estos criterios."),this.createDataSet(t)})}else this.sendMessage("error","Datos invalidos favor de validar")}sendMessage(e,o){this.messageService.create(e,o)}onCheckboxChange(e){this.chkBoardingP=this.validateFormM.get("chkBoardingP")?.value}createDataSet(e){let o=this.selectedRoute.initialEnd,t=this.selectedRoute.initialStart,r=[],d=[];d=t.map(c=>({time:c,lunes:0,martes:0,miercoles:0,jueves:0,viernes:0})),r=o.map(c=>({time:c,lunes:0,martes:0,miercoles:0,jueves:0,viernes:0})),e.forEach(c=>{c.daysHour.forEach(x=>{let F=d.find(D=>D.time===x.startInit);if(F)switch(x.day){case 1:F.lunes+=1;break;case 2:F.martes+=1;break;case 3:F.miercoles+=1;break;case 4:F.jueves+=1;break;case 5:F.viernes+=1;break;default:break}let T=r.find(D=>D.time===x.endInit);if(T)switch(x.day){case 1:T.lunes+=1;break;case 2:T.martes+=1;break;case 3:T.miercoles+=1;break;case 4:T.jueves+=1;break;case 5:T.viernes+=1;break;default:break}})}),this.dataSet=d,this.dataSetEnd=r,this.calculateTotals()}onProductSelect(e){this.transportType=e}onRoutesSelect(e){let o=this.routesM.find(t=>t.id===e);o&&(this.selectedRoute=o)}calculateTotals(){this.totalLunes=this.dataSet.reduce((t,r)=>t+r.lunes,0),this.totalMartes=this.dataSet.reduce((t,r)=>t+r.martes,0),this.totalMiercoles=this.dataSet.reduce((t,r)=>t+r.miercoles,0),this.totalJueves=this.dataSet.reduce((t,r)=>t+r.jueves,0),this.totalViernes=this.dataSet.reduce((t,r)=>t+r.viernes,0),this.grantotal=this.totalLunes+this.totalMartes+this.totalMiercoles+this.totalJueves+this.totalViernes,this.totalLunesE=this.dataSetEnd.reduce((t,r)=>t+r.lunes,0),this.totalMartesE=this.dataSetEnd.reduce((t,r)=>t+r.martes,0),this.totalMiercolesE=this.dataSetEnd.reduce((t,r)=>t+r.miercoles,0),this.totalJuevesE=this.dataSetEnd.reduce((t,r)=>t+r.jueves,0),this.totalViernesE=this.dataSetEnd.reduce((t,r)=>t+r.viernes,0),this.grantotalE=this.totalLunesE+this.totalMartesE+this.totalMiercolesE+this.totalJuevesE+this.totalViernesE;let e=this.dataSet.length*this.carro,o=this.dataSetEnd.length*this.carro;this.sumaTotal=e+o,this.LunesFinal=this.totalLunes+this.totalLunesE,this.MartesFinal=this.totalMartes+this.totalMartesE,this.MiercolesFinal=this.totalMiercoles+this.totalMiercolesE,this.JuevesFinal=this.totalJueves+this.totalJuevesE,this.ViernesFinal=this.totalViernes+this.totalViernesE,this.porcentajeLunes=this.LunesFinal/this.sumaTotal*100,this.porcentajeMartes=this.MartesFinal/this.sumaTotal*100,this.porcentajeMiercoles=this.MiercolesFinal/this.sumaTotal*100,this.porcentajeJueves=this.JuevesFinal/this.sumaTotal*100,this.porcentajeViernes=this.ViernesFinal/this.sumaTotal*100}onCustomerSelectedC(e,o){if(e!=null&&!this.userRoute){this.userRoute=!0,this.routes=[],this.contenedores="",this.rowDataPay=[];let r=Ue.filter(o,d=>d.id==e)[0];this.validateForm.controls.customerName.setValue(r.name),this.validateForm.controls.customerId.setValue(r.id),this.fillCustomerRoute(r.id)}}onCustomerSelectedP(e,o){if(e!=null&&!this.userRouteP){this.userRouteP=!0,this.routesP=[],this.contenedoresPay="",this.rowDataPre=[],this.rowData=[];let r=Ue.filter(o,d=>d.id==e)[0];this.validateFormP.controls.customerName.setValue(r.name),this.validateFormP.controls.customerId.setValue(r.id),this.fillCustomerRouteP(r.id)}}calculateRemaining(e){return this.carro-e}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}fillCustomerRoute(e){this.routesService.getRoutes(e).pipe(V(this.stopSubscription$),C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.routes=o})}fillCustomerRouteP(e){this.routesService.getRoutes(e).pipe(V(this.stopSubscription$),C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.routesP=o})}onRouteSelected(e,o){this.routeId$.next(e);let r=Ue.filter(o,d=>d.routeId==e)[0];this.validateForm.controls.routeName.setValue(r.name)}onRouteSelectedP(e,o){this.routeId$.next(e);let r=Ue.filter(o,d=>d.routeId==e)[0];this.validateFormP.controls.routeName.setValue(r.name)}submitFormUnPaid(){this.userRoute=!1,this.rowDataPay=[];let e=this.validateForm.controls.customerId.value,o=this.validateForm.controls.routeId.value,t=this.validateForm.controls.round.value,r="";t==1?r="D\xEDa":t==2?r="Tarde":r="Nocturno",this.usersCollection=this.afs.collection("users",d=>d.where("status","==","preRegister").where("customerId","==",e).where("turno","==",t).where("defaultRoute","==",o).orderBy("displayName")),this.userSubscription=this.usersCollection.snapshotChanges().pipe(C(d=>d.map(c=>{let x=c.payload.doc.id,F=c.payload.doc.data();return S({id:x},F)}))).subscribe(d=>{this.loadUsers(d)})}loadUsers(e){this.rowDataPay=e,e.length<=14?this.contenedores=this.organigrama(e.length,13,19,40):e.length<=19?this.contenedores=this.organigrama(e.length,14,17,40):this.contenedores=this.organigrama(e.length,14,19,40)}loadUsersP(e){this.contenedoresPay="",this.rowData=e,this.rowData.length<=14?this.contenedoresPay=this.organigrama(this.rowData.length,13,19,40):this.rowData.length<=19?this.contenedoresPay=this.organigrama(this.rowData.length,14,17,40):this.contenedoresPay=this.organigrama(this.rowData.length,14,19,40)}onRoundSelected(){if(this.submitPayment){this.submitPayment=!1,this.userRouteP=!1,this.rowData=[],this.rowDataPre=[];let e=this.validateFormP.controls.customerId.value,o=this.validateFormP.controls.routeId.value,t=parseInt(this.validateFormP.controls.round.value,10),r="";t==1?r="D\xEDa":t==2?r="Tarde":r="Nocturno",this.usersCollection=this.afs.collection("users",d=>d.where("customerId","==",e).where("defaultRound","==",r).where("defaultRoute","==",o).orderBy("displayName")),this.userSubscription=this.usersCollection.snapshotChanges().pipe(C(d=>d.map(c=>{let x=c.payload.doc.id,F=c.payload.doc.data();return S({id:x},F)}))).subscribe(d=>{this.rowData=d,this.load()})}}load(){this.rowData.length>=1?(this.rowDataPush=[],this.rowData.forEach(e=>{let o=e.id;this.afs.collection(`users/${o}/boardingPasses`,t=>t.where("active","==",!0).limit(1)).get().subscribe(t=>{t.empty||this.rowDataPush.push(S({},e))})})):this.contenedoresPay="No existen coincidencias!"}submitFormPaid(){this.rowDataPre=[],this.submitPayment=!0,this.rowDataPre=this.rowDataPush,this.loadUsersP(this.rowDataPre)}organigrama(e,o,t,r){let d=0,c=0,x=0,F=0,T=!1;for(;e>0;)if(e>=r)x++,e-=r;else if(e>=t)c++,e-=t;else if(e>=o)d++,e-=o;else{F=e;break}let D="";return d>0&&(D+=`${d} camiones de 14 pasajeros, `,T=!0),c>0&&(D+=`${c} camiones de 19 pasajeros, `,T=!0),x>0&&(D+=`${x} camiones de 40 pasajeros, `,T=!0),F>0&&(D+=`y restan ${F} pasajeros sin asignacion, `),D!==""?T?D=`Se necesitan ${D} en total.`:D=`Se necesitan 0 camiones  ${D} en total.`:D="No se necesitan camiones.",D}resetFilters(){}resetFiltersPay(){}trackByName(e,o){return o.name}trackByNamePay(e,o){return o.name}sortBPay(){}sortBy(){}static{this.\u0275fac=function(o){return new(o||l)(O(X),O(Y),O(J))}}static{this.\u0275cmp=U({type:l,selectors:[["app-organigrama"]],decls:90,vars:18,consts:[["filterTable",""],["borderedTable",""],["borderedTable1",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],["nzTitle","Usuarios Interesados"],[2,"margin-bottom","10px"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],[2,"width","1000px","border-collapse","collapse"],[2,"width","50%"],[2,"width","80px"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Selecciona la Empresa",2,"width","300px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","300px",3,"ngModelChange"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","300px"],["nzValue","1","nzLabel","Matutino"],["nzValue","2","nzLabel","Vespertino"],["nzValue","3","nzLabel","Nocturno"],["nz-button","",3,"click"],[1,"table-operations"],["nzTableLayout","fixed","ngSkipHydration","",3,"nzData"],[3,"nzSortOrder","nzSortFn","nzFilters","nzFilterFn","nzSortOrderChange",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf"],["nzTitle","Usuarios con Pago"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","300px",3,"ngModelChange"],["nzTitle","Unidad Mederos Pagos",4,"ngIf"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""],[3,"nzSortOrderChange","nzSortOrder","nzSortFn","nzFilters","nzFilterFn"],["nzTitle","Unidad Mederos Pagos"],[2,"width","33%"],["nz-input","","id","customerName","formControlName","customerName",2,"width","300px"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","250px",3,"ngModelChange"],["nz-checkbox","","formControlName","chkBoardingP",2,"margin-left","10px","margin-top","5px",3,"ngModelChange","ngModel"],["nzAllowClear","","nzPlaceHolder","Selecciona un Producto","formControlName","productId",2,"width","200px",3,"ngModelChange"],["nz-input","","type","number","formControlName","asientos","id","asientos","placeholder","# Asientos",2,"width","110px","height","30px"],["nz-button","","type","number",2,"margin-bottom","10px",3,"click"],["nzBordered","","nzSize","middle","nzTitle","Procentajes",1,"custom-table"],[2,"border-radius","1px"],["nzBordered","","nzSize","middle","nzTitle","Horario Entrada",3,"nzData"],[1,"m-b-0",3,"nzColor"],["nzBordered","","nzSize","middle","nzTitle","Horario Salida",3,"nzData"],["class","m-b-0",3,"nzColor",4,"ngIf"]],template:function(o,t){if(o&1){let r=w();n(0,"div",3)(1,"div",4)(2,"nz-page-header",5)(3,"nz-page-header-title",6),a(4,"Organigrama de Operaci\xF3n"),i(),n(5,"nz-page-header-subtitle"),a(6,"Reporte de usuarios "),i()()(),n(7,"div",7)(8,"nz-tabset")(9,"nz-tab",8)(10,"div",9)(11,"form",10),_("ngSubmit",function(){return f(r),g(t.submitFormUnPaid())}),n(12,"table",11)(13,"tbody")(14,"tr")(15,"td",12)(16,"nz-form-item")(17,"nz-form-label",13),a(18,"Empresa"),i(),n(19,"nz-select",14),_("ngModelChange",function(c){return f(r),g(t.onCustomerSelectedC(c,t.customers))}),z(20,xi,3,3,"nz-option",15),i()()()(),n(21,"tr")(22,"td",12)(23,"nz-form-item")(24,"nz-form-label",13),a(25,"Operaci\xF3n"),i(),n(26,"nz-select",16),_("ngModelChange",function(c){return f(r),g(t.onRouteSelected(c,t.routes))}),z(27,bi,3,3,"nz-option",15),i()(),n(28,"nz-form-label",13),a(29,"Turno"),i(),n(30,"nz-select",17),v(31,"nz-option",18)(32,"nz-option",19)(33,"nz-option",20),i(),n(34,"nz-form-item")(35,"nz-form-label"),a(36,"Programac\xF3n de Operaci\xF3n: "),i(),n(37,"b"),a(38),i()()()()()(),n(39,"button",21),_("click",function(){return f(r),g(t.submitFormUnPaid())}),a(40,"Aceptar"),i()()(),n(41,"div"),v(42,"div",22),n(43,"nz-table",23,0)(45,"thead")(46,"tr"),z(47,yi,2,5,"th",24),i()(),z(48,Ei,15,7,"tr",25),i()()(),n(49,"nz-tab",26)(50,"div",9)(51,"form",10),_("ngSubmit",function(){return f(r),g(t.submitFormPaid())}),n(52,"table",11)(53,"tr")(54,"td",12)(55,"nz-form-item")(56,"nz-form-label",13),a(57,"Empresa"),i(),n(58,"nz-select",14),_("ngModelChange",function(c){return f(r),g(t.onCustomerSelectedP(c,t.customers))}),z(59,Ii,3,3,"nz-option",15),i()()()(),n(60,"tr")(61,"td",12)(62,"nz-form-item")(63,"nz-form-label",13),a(64,"Operaci\xF3n"),i(),n(65,"nz-select",16),_("ngModelChange",function(c){return f(r),g(t.onRouteSelectedP(c,t.routesP))}),z(66,Fi,3,3,"nz-option",15),i()(),n(67,"nz-form-label",13),a(68,"Turno"),i(),n(69,"nz-select",27),_("ngModelChange",function(){return f(r),g(t.onRoundSelected())}),v(70,"nz-option",18)(71,"nz-option",19)(72,"nz-option",20),i(),n(73,"nz-form-item")(74,"nz-form-label"),a(75,"Programac\xF3n de Operaci\xF3n: "),i(),n(76,"b"),a(77),i()()()()(),n(78,"nz-form-item")(79,"button",21),_("click",function(){return f(r),g(t.submitFormPaid())}),a(80,"Aceptar"),i()()()(),n(81,"div"),v(82,"div",22),n(83,"nz-table",23,0)(85,"thead")(86,"tr"),z(87,wi,2,5,"th",24),i()(),z(88,Vi,15,7,"tr",25),i()()(),z(89,$i,134,50,"nz-tab",28),i()()()}if(o&2){let r=E(44);s(2),m("nzGhost",!1),s(9),m("formGroup",t.validateForm),s(9),m("ngForOf",t.customers),s(7),m("ngForOf",t.routes),s(11),h(" ",t.contenedores,""),s(5),m("nzData",t.rowDataPay),s(4),m("ngForOf",t.listOfColumns)("ngForTrackBy",t.trackByName),s(),m("ngForOf",r.data),s(3),m("formGroup",t.validateFormP),s(8),m("ngForOf",t.customers),s(7),m("ngForOf",t.routesP),s(11),h(" ",t.contenedoresPay,""),s(6),m("nzData",t.rowDataPre),s(4),m("ngForOf",t.listOfColumns)("ngForTrackBy",t.trackByNamePay),s(),m("ngForOf",r.data),s(),m("ngIf",t.isMederos)}},dependencies:[B,j,ye,Ee,Je,Ye,Xe,Ie,fe,Ke,de,Dt,oe,se,ce,le,me,_e,K,ge,ie,ee,te,Ze,ne,re,Ge,$,yt,q,H,W,G,Ce,ve],styles:[".table-operations[_ngcontent-%COMP%]{margin-bottom:16px}.table-operations[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:8px}.custom-table[_ngcontent-%COMP%]{max-width:900px;margin:auto;height:160px}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:14px}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f0f0f0;text-align:center}.custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center}"]})}}return l})();var Ct=ct(ft());var jt=(()=>{class l{constructor(){this.audioUrl=""}static{this.\u0275fac=function(o){return new(o||l)}}static{this.\u0275cmp=U({type:l,selectors:[["app-audio-player"]],inputs:{audioUrl:"audioUrl"},decls:3,vars:1,consts:[["controls",""],["type","audio/mpeg",3,"src"]],template:function(o,t){o&1&&(n(0,"audio",0),v(1,"source",1),a(2," Your browser does not support the audio element. "),i()),o&2&&(s(),m("src",t.audioUrl,R))},encapsulation:2})}}return l})();var $t=()=>({width:"300px",borderRadius:"4px",marginLeft:"160px"}),qt=()=>({width:"300px"});function Hi(l,p){if(l&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),Le(5,"date"),i(),n(6,"td"),a(7),i(),n(8,"td")(9,"a",31),a(10,"Ver Evidencia"),i()(),n(11,"td"),v(12,"app-audio-player",32),i()()),l&2){let e=p.$implicit;s(2),h(" ",e.displayName," "),s(2),I(ke(5,5,e.dateTimeStamp.toDate(),"yyyy-MM-dd HH:mm:ss")),s(3),h(" ",e.comentario," "),s(2),xe("href",e.imageUrl,R),s(3),m("audioUrl",e.audioUrl)}}function Wi(l,p){if(l&1&&(n(0,"nz-table",29,0)(2,"thead")(3,"tr")(4,"th"),a(5,"PR"),i(),n(6,"th"),a(7,"Fecha"),i(),n(8,"th"),a(9,"Comentarios "),i(),n(10,"th"),a(11,"Audio"),i(),n(12,"th"),a(13,"..."),i()()(),n(14,"tbody"),z(15,Hi,13,8,"tr",30),i()()),l&2){let e=E(1),o=u();m("nzData",o.evidenceInfo)("nzLoading",o.loadingevidenceInfo)("nzLoadingDelay",500),s(15),m("ngForOf",e.data)}}function Gi(l,p){if(l&1&&(n(0,"nz-option",33),v(1,"i",34),a(2),v(3,"br"),a(4),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(2),h(" ",e.name," "),s(2),h(" ",e.description,"")}}function Ji(l,p){if(l&1&&v(0,"nz-option",35),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.displayName)}}function Xi(l,p){if(l&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),Le(5,"date"),i(),n(6,"td"),a(7),i(),n(8,"td")(9,"a",31),a(10,"Ver Evidencia"),i()(),n(11,"td"),v(12,"app-audio-player",32),i()()),l&2){let e=p.$implicit;s(2),h(" ",e.displayName," "),s(2),I(ke(5,5,e.dateTimeStamp.toDate(),"yyyy-MM-dd HH:mm:ss")),s(3),h(" ",e.comentario," "),s(2),xe("href",e.imageUrl,R),s(3),m("audioUrl",e.audioUrl)}}function Yi(l,p){if(l&1&&(n(0,"nz-table",29,1)(2,"thead")(3,"tr")(4,"th"),a(5,"PR"),i(),n(6,"th"),a(7,"Fecha"),i(),n(8,"th"),a(9,"Comentarios "),i(),n(10,"th"),a(11,"Audio"),i(),n(12,"th"),a(13,"..."),i()()(),n(14,"tbody"),z(15,Xi,13,8,"tr",30),i()()),l&2){let e=E(1),o=u();m("nzData",o.evidenceInfoDriver)("nzLoading",o.loadingevidenceInfoDriver)("nzLoadingDelay",500),s(15),m("ngForOf",e.data)}}function Qi(l,p){if(l&1&&v(0,"nz-option",35),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function Ki(l,p){if(l&1&&v(0,"nz-option",35),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function Zi(l,p){if(l&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),Le(5,"date"),i(),n(6,"td"),a(7),i(),n(8,"td")(9,"a",31),a(10,"Ver Evidencia"),i()(),n(11,"td"),v(12,"app-audio-player",32),i()()),l&2){let e=p.$implicit;s(2),h(" ",e.displayName," "),s(2),I(ke(5,5,e.dateTimeStamp.toDate(),"yyyy-MM-dd HH:mm:ss")),s(3),h(" ",e.comentario," "),s(2),xe("href",e.imageUrl,R),s(3),m("audioUrl",e.audioUrl)}}function en(l,p){if(l&1&&(n(0,"nz-table",36,0)(2,"thead")(3,"tr")(4,"th"),a(5,"PR"),i(),n(6,"th"),a(7,"Fecha"),i(),n(8,"th"),a(9,"Comentarios "),i(),n(10,"th"),a(11,"Audio"),i(),n(12,"th"),a(13,"..."),i()()(),n(14,"tbody"),z(15,Zi,13,8,"tr",30),i()()),l&2){let e=E(1),o=u();m("nzData",o.evidenceInfoByProgram),s(15),m("ngForOf",e.data)}}function tn(l,p){if(l&1&&v(0,"nz-option",35),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function nn(l,p){if(l&1&&v(0,"nz-option",35),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function rn(l,p){if(l&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),Le(5,"date"),i(),n(6,"td"),a(7),i(),n(8,"td")(9,"a",31),a(10,"Ver Evidencia"),i()(),n(11,"td"),v(12,"app-audio-player",32),i()()),l&2){let e=p.$implicit;s(2),h(" ",e.displayName," "),s(2),I(ke(5,5,e.dateTimeStamp.toDate(),"yyyy-MM-dd HH:mm:ss")),s(3),h(" ",e.comentario," "),s(2),xe("href",e.imageUrl,R),s(3),m("audioUrl",e.audioUrl)}}function an(l,p){if(l&1&&(n(0,"nz-table",36,2)(2,"thead")(3,"tr")(4,"th"),a(5,"PR"),i(),n(6,"th"),a(7,"Fecha"),i(),n(8,"th"),a(9,"Comentarios "),i(),n(10,"th"),a(11,"Audio"),i(),n(12,"th"),a(13,"..."),i()()(),n(14,"tbody"),z(15,rn,13,8,"tr",30),i()()),l&2){let e=E(1),o=u();m("nzData",o.evidenceInfoByRoute),s(15),m("ngForOf",e.data)}}var Ir=(()=>{class l{constructor(e,o,t,r){this.afs=e,this.datePipe=o,this.messageService=t,this.fb=r,this.driverService=y(Lt),this.vendorsService=y(Pt),this.accountsService=y(Z),this.customersService=y(Fe),this.routesService=y(ae),this.programService=y(De),this.loadingevidenceInfo=!1,this.loadingevidenceInfoByProgram=!1,this.loadingevidenceInfoDriver=!1,this.stopSubscription$=new A,this.infoLoad=[],this.customerList=[],this.programList=[],this.customerListRoute=[],this.RouteList=[],this.vendorsList=[],this.rolService=y(Ve),this.authService=y(Q),this.infoSegment=[],this.date=ht(),this.dateRoute=ht(),this.authService.user.subscribe(d=>{this.user=d,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(c=>{this.infoLoad=c,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(V(this.stopSubscription$),C(c=>{let x=c.payload.id,F=c.payload.data();return S({id:x},F)}),k(c=>(this.infoSegment=c,c))).subscribe())}),this.dateFilterForm=this.fb.group({selectedDate:[null]}),this.dateFilterFormProgram=this.fb.group({selectedDate:[null],customerId:[],programId:[],name:[]}),this.dateFilterFormProgramRoute=this.fb.group({selectedDate:[null],customerId:[],routeId:[],name:[]}),this.dateFilterFormDriver=this.fb.group({selectedDate:[null],driverId:[],driver:[],vendorName:[],vendorId:[]}),this.vendorsService.getVendors().pipe(V(this.stopSubscription$),C(d=>d.map(c=>{let x=c.payload.doc.id,F=c.payload.doc.data();return Ne(S({},F),{id:x})}))).subscribe(d=>{this.vendorsList=d})}onDateChangeDriver(){this.evidenceInfoDriver=[],this.driversList=[]}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}onVendorSelected(e,o){if(e){this.evidenceInfoDriver=[],this.driversList=[];let r=Ct.filter(this.vendorsList,d=>d.id==e)[0];this.fillDataDriver(r.id)}}fillDataDriver(e){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.driverService.getDriversbyCustomer(e,this.user.customerId).pipe(C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.driversList=o}):this.driverService.getDrivers(e).pipe(C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.driversList=o})}ngOnInit(){}onDriverSelected(e,o){if(this.evidenceInfoDriver=[],e){let t="";this.dateFilterFormDriver&&(t=this.dateFilterFormDriver.get("selectedDate").value);let r=this.datePipe.transform(t,"dd-MM-yyyy"),c=Ct.filter(this.driversList,x=>x.id==e)[0];this.driverService.getEvidenceDriversperDriver(r.toString(),c.id).pipe(C(x=>x.map(F=>{let T=F.payload.doc.id,D=F.payload.doc.data();return S({id:T},D)}))).subscribe({next:x=>{this.evidenceInfoDriver=x,this.loadingevidenceInfoDriver=!1},error:x=>{this.loadingevidenceInfoDriver=!1}})}}onDateChange(){this.loadingevidenceInfo=!0;let e=this.dateFilterForm.get("selectedDate").value;if(e!==void 0){let o=new Date(e);this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.driverService.getEvidenceDriversbyCustomer(o,this.user.customerId).pipe(C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return S({id:d},c)}))).subscribe({next:t=>{this.evidenceInfo=t,this.loadingevidenceInfo=!1},error:t=>{this.sendMessage("error",t),this.loadingevidenceInfo=!1}}):this.driverService.getEvidenceDrivers(o).pipe(C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return S({id:d},c)}))).subscribe({next:t=>{this.evidenceInfo=t,this.loadingevidenceInfo=!1},error:t=>{this.sendMessage("error",t),this.loadingevidenceInfo=!1}})}}onDateChangeProgram(e){this.date=ut(new Date(e)),this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.cDocument=this.afs.collection("customers").doc(this.user.customerId),this.customerSubscription=this.cDocument.snapshotChanges().pipe(C(o=>{let t=o.payload.id,r=o.payload.data();return S({id:t},r)})).subscribe(o=>{this.customerList=[o]})):(this.cCollection=this.afs.collection("customers",o=>o.where("active","==",!0)),this.customerSubscription=this.cCollection.snapshotChanges().pipe(C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.customerList=o}))}onDateChangeProgramRoute(e){this.dateRoute=ut(new Date(e)),this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.cDocument=this.afs.collection("customers").doc(this.user.customerId),this.customerSubscription=this.cDocument.snapshotChanges().pipe(C(o=>{let t=o.payload.id,r=o.payload.data();return S({id:t},r)})).subscribe(o=>{this.customerListRoute=[o]})):(this.cCollection=this.afs.collection("customers",o=>o.where("active","==",!0)),this.customerSubscription=this.cCollection.snapshotChanges().pipe(C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.customerListRoute=o}))}onCustomerSelected(e){let o=this.dateFilterFormProgram.get("customerId").value;this.date!==void 0&&o!==void 0&&(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.programService.getProgramsByDaybyCustomer(this.date,this.user.customerId).pipe(ue(1),C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return S({id:d},c)})),k(t=>{this.programList=t})).subscribe():this.programService.getProgramsByDay(this.date).pipe(ue(1),C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return S({id:d},c)})),C(t=>{let r=new Set;return t.filter(d=>r.has(d.name)?!1:(r.add(d.name),!0))}),k(t=>{this.programList=t})).subscribe())}onCustomerSelectedRoute(e){let o=this.dateFilterFormProgramRoute.get("customerId").value;this.dateRoute!==void 0&&o!==void 0&&this.programService.getRoutesbyCustomer(o).pipe(ue(1),C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return S({id:d},c)})),k(t=>{this.RouteList=t})).subscribe()}onProgramSelected(){this.loadingevidenceInfoByProgram=!0;let e=this.dateFilterFormProgram.get("programId").value;e!==void 0&&this.driverService.getEvidenceByProgram(e).pipe(C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.evidenceInfoByProgram=o})}onRouteSelected(){let e=this.dateFilterFormProgramRoute.get("routeId").value;e!==void 0&&this.driverService.getEvidenceByRoute(e).pipe(C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)}))).subscribe(o=>{this.evidenceInfoByRoute=o})}sendMessage(e,o){this.messageService.create(e,o)}static{this.\u0275fac=function(o){return new(o||l)(O(X),O(Re),O(Y),O(J))}}static{this.\u0275cmp=U({type:l,selectors:[["app-evidence"]],decls:72,vars:28,consts:[["basicTable",""],["basicTableDriver",""],["basicTableR",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],["nzTitle","Evidencias Generales"],[2,"margin-bottom","10px",3,"formGroup"],["for","selectedDate"],["type","date","id","selectedDate","formControlName","selectedDate",3,"change"],[3,"nzData","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Evidencias por PR"],[2,"width","160px"],[3,"formGroup"],["formControlName","vendorId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",2,"width","450px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","driver","nzAllowClear","","nzPlaceHolder","Seleccione un PR",2,"width","450px",3,"ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzTitle","Evidencias por Programa"],["for","selectedDate",2,"width","160px"],[3,"ngStyle"],[3,"nzSelectChange","ngStyle","nzFullscreen"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Seleccione una Empresa",2,"width","450px",3,"ngModelChange"],["formControlName","programId","nzAllowClear","","nzPlaceHolder","Seleccione un PR",2,"width","450px",3,"ngModelChange"],["ngSkipHydration","",3,"nzData",4,"ngIf"],["nzTitle","Evidencias por Operaci\xF3n"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Seleccione un PR",2,"width","450px",3,"ngModelChange"],[3,"nzData","nzLoading","nzLoadingDelay"],[4,"ngFor","ngForOf"],["target","_blank",3,"href"],[3,"audioUrl"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""],[3,"nzValue","nzLabel"],["ngSkipHydration","",3,"nzData"]],template:function(o,t){o&1&&(n(0,"div",3)(1,"div",4)(2,"nz-page-header",5)(3,"nz-page-header-title",6),a(4,"Evidencias"),i(),n(5,"nz-page-header-subtitle"),a(6,"Reporte de evidencias "),i()()(),n(7,"div",7)(8,"nz-tabset")(9,"nz-tab",8)(10,"div",9)(11,"label",10),a(12," Selecciona una Fecha: "),i(),n(13,"input",11),_("change",function(){return t.onDateChange()}),i()(),n(14,"div"),z(15,Wi,16,4,"nz-table",12),i()(),n(16,"nz-tab",13)(17,"div",9)(18,"nz-form-label",14),a(19," Selecciona una Fecha"),i(),n(20,"input",11),_("change",function(){return t.onDateChangeDriver()}),i()(),n(21,"div",15)(22,"nz-form-control")(23,"nz-form-label",14),a(24,"Divisi\xF3n"),i(),n(25,"nz-select",16),_("ngModelChange",function(d){return t.onVendorSelected(d,"vendorName")}),z(26,Gi,5,4,"nz-option",17),i()(),n(27,"nz-form-control")(28,"nz-form-label",14),a(29,"PR"),i(),n(30,"nz-select",18),_("ngModelChange",function(d){return t.onDriverSelected(d,"vendorName")}),z(31,Ji,1,2,"nz-option",19),i()()(),n(32,"div"),z(33,Yi,16,4,"nz-table",12),i()(),n(34,"nz-tab",20)(35,"div",15)(36,"nz-form-control")(37,"nz-form-label",21),a(38," Selecciona una Fecha "),i(),n(39,"div",22)(40,"nz-calendar",23),_("nzSelectChange",function(d){return t.onDateChangeProgram(d)}),i()()(),n(41,"nz-form-control")(42,"nz-form-label",14),a(43,"Empresa"),i(),n(44,"nz-select",24),_("ngModelChange",function(d){return t.onCustomerSelected(d)}),z(45,Qi,1,2,"nz-option",19),i()(),n(46,"nz-form-control")(47,"nz-form-label",14),a(48,"Programa"),i(),n(49,"nz-select",25),_("ngModelChange",function(){return t.onProgramSelected()}),z(50,Ki,1,2,"nz-option",19),i()()(),n(51,"div"),z(52,en,16,2,"nz-table",26),i()(),n(53,"nz-tab",27)(54,"div",15)(55,"nz-form-control")(56,"nz-form-label",21),a(57," Selecciona una Fecha "),i(),n(58,"div",22)(59,"nz-calendar",23),_("nzSelectChange",function(d){return t.onDateChangeProgramRoute(d)}),i()()(),n(60,"nz-form-control")(61,"nz-form-label",14),a(62,"Empresa"),i(),n(63,"nz-select",24),_("ngModelChange",function(d){return t.onCustomerSelectedRoute(d)}),z(64,tn,1,2,"nz-option",19),i()(),n(65,"nz-form-control")(66,"nz-form-label",14),a(67,"Ruta"),i(),n(68,"nz-select",28),_("ngModelChange",function(){return t.onRouteSelected()}),z(69,nn,1,2,"nz-option",19),i()()(),n(70,"div"),z(71,an,16,2,"nz-table",26),i()()()()()),o&2&&(s(2),m("nzGhost",!1),s(8),m("formGroup",t.dateFilterForm),s(5),m("ngIf",t.evidenceInfo),s(2),m("formGroup",t.dateFilterFormDriver),s(4),m("formGroup",t.dateFilterFormDriver),s(5),m("ngForOf",t.vendorsList),s(5),m("ngForOf",t.driversList),s(2),m("ngIf",t.evidenceInfoDriver),s(2),m("formGroup",t.dateFilterFormProgram),s(4),m("ngStyle",Oe(24,$t)),s(),m("ngStyle",Oe(25,qt))("nzFullscreen",!1)("nzFullscreen",!1),s(5),m("ngForOf",t.customerList),s(5),m("ngForOf",t.programList),s(2),m("ngIf",t.evidenceInfoByProgram),s(2),m("formGroup",t.dateFilterFormProgramRoute),s(4),m("ngStyle",Oe(26,$t)),s(),m("ngStyle",Oe(27,qt))("nzFullscreen",!1)("nzFullscreen",!1),s(5),m("ngForOf",t.customerListRoute),s(5),m("ngForOf",t.RouteList),s(2),m("ngIf",t.evidenceInfoByRoute))},dependencies:[B,j,bt,kt,ye,Ee,Ie,Qe,de,oe,se,ce,le,me,K,ie,ee,te,ne,re,$,q,H,W,G,Ce,ve,jt,Re]})}}return l})();function on(l,p){if(l&1&&(n(0,"nz-option",38),a(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(),h(" ",e.name,"")}}function sn(l,p){if(l&1&&(n(0,"a",42),a(1,"Ver Referencia"),i()),l&2){let e=u().$implicit;m("href",e.refrenceURL,R)}}function ln(l,p){if(l&1){let e=w();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),a(10),i(),n(11,"td")(12,"a",40),_("click",function(){let t=f(e).$implicit,r=u(2);return g(r.loadUserInfoPanel(t.uidUsuario))}),a(13,"Ver"),i()(),n(14,"td"),z(15,sn,2,1,"a",41),i(),n(16,"td")(17,"a",40),_("click",function(){let t=f(e).$implicit,r=u(2);return g(r.openSeguimientoModal(t.id,t.token,t.uidUsuario))}),a(18,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit,o=u(2);s(2),h(" ",e.status," "),s(2),I(e.currentDate),s(2),he(" ",e.description," ",e.cancelUserComment," "),s(2),h(" ",o.getRouteNameById(e.routeId,e.customerId)," "),s(2),h(" ",e.bus," "),s(5),m("ngIf",e.refrenceURL)}}function dn(l,p){if(l&1&&(n(0,"nz-table",39,8)(2,"thead")(3,"tr")(4,"th"),a(5,"Status"),i(),n(6,"th"),a(7,"Fecha"),i(),n(8,"th"),a(9,"Descripci\xF3n"),i(),n(10,"th"),a(11,"Ruta"),i(),n(12,"th"),a(13,"Tipo"),i(),n(14,"th"),a(15,"Usuario"),i(),n(16,"th"),a(17,"Referencia"),i(),n(18,"th"),a(19,"..."),i()()(),n(20,"tbody"),z(21,ln,19,7,"tr",32),i()()),l&2){let e=E(1),o=u();m("nzData",o.mfDataM)("nzLoading",o.loadingmejorasData)("nzLoadingDelay",500),s(21),m("ngForOf",e.data)}}function mn(l,p){if(l&1&&(n(0,"a",42),a(1,"Ver Referencia"),i()),l&2){let e=u().$implicit;m("href",e.refrenceURL,R)}}function cn(l,p){if(l&1){let e=w();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),a(10),i(),n(11,"td")(12,"a",40),_("click",function(){let t=f(e).$implicit,r=u(2);return g(r.loadUserInfoPanel(t.uidUsuario))}),a(13,"Ver"),i()(),n(14,"td"),z(15,mn,2,1,"a",41),i(),n(16,"td")(17,"a",40),_("click",function(){let t=f(e).$implicit,r=u(2);return g(r.openSeguimientoModal(t.id,t.token,t.uidUsuario))}),a(18,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit,o=u(2);s(2),h(" ",e.status," "),s(2),I(e.currentDate),s(2),he(" ",e.description," ",e.cancelUserComment," "),s(2),h(" ",o.getRouteNameById(e.routeId,e.customerId)," "),s(2),h(" ",e.bus," "),s(5),m("ngIf",e.refrenceURL)}}function pn(l,p){if(l&1&&(n(0,"nz-table",43,9)(2,"thead")(3,"tr")(4,"th"),a(5,"Status"),i(),n(6,"th"),a(7,"Fecha"),i(),n(8,"th"),a(9,"Descripci\xF3n"),i(),n(10,"th"),a(11,"Ruta"),i(),n(12,"th"),a(13,"Tipo"),i(),n(14,"th"),a(15,"Usuario"),i(),n(16,"th"),a(17,"Referencia"),i(),n(18,"th"),a(19,"..."),i()()(),n(20,"tbody"),z(21,cn,19,7,"tr",32),i()()),l&2){let e=E(1),o=u();m("nzData",o.mfData)("nzLoading",o.loadingmejorasData)("nzLoadingDelay",500),s(21),m("ngForOf",e.data)}}function un(l,p){if(l&1&&(n(0,"nz-option",38),a(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(),h(" ",e.name,"")}}function hn(l,p){if(l&1&&(n(0,"a",42),a(1,"Ver Referencia"),i()),l&2){let e=u().$implicit;m("href",e.refrenceURL,R)}}function fn(l,p){if(l&1){let e=w();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),a(10),i(),n(11,"td")(12,"a",40),_("click",function(){let t=f(e).$implicit,r=u();return g(r.loadUserInfoPanel(t.uidUsuario))}),a(13,"Ver"),i()(),n(14,"td"),z(15,hn,2,1,"a",41),i(),n(16,"td")(17,"a",40),_("click",function(){let t=f(e).$implicit,r=u();return g(r.openSeguimientoModal(t.id,t.token,t.uidUsuario))}),a(18,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit,o=u();s(2),h(" ",e.status," "),s(2),I(e.currentDate),s(2),he(" ",e.description," ",e.cancelUserComment," "),s(2),h(" ",o.getRouteNameById(e.routeId,e.customerId)," "),s(2),h(" ",e.bus," "),s(5),m("ngIf",e.refrenceURL)}}function gn(l,p){if(l&1&&(n(0,"nz-option",38),a(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(),h(" ",e.name,"")}}function _n(l,p){if(l&1&&(n(0,"a",42),a(1,"Ver Referencia"),i()),l&2){let e=u().$implicit;m("href",e.refrenceURL,R)}}function zn(l,p){if(l&1){let e=w();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),a(10),i(),n(11,"td")(12,"a",40),_("click",function(){let t=f(e).$implicit,r=u();return g(r.loadUserInfoPanel(t.uidUsuario))}),a(13,"Ver"),i()(),n(14,"td"),z(15,_n,2,1,"a",41),i(),n(16,"td")(17,"a",40),_("click",function(){let t=f(e).$implicit,r=u();return g(r.openSeguimientoModal(t.id,t.token,t.uidUsuario))}),a(18,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit,o=u();s(2),h(" ",e.status," "),s(2),I(e.currentDate),s(2),he(" ",e.description," ",e.cancelUserComment," "),s(2),h(" ",o.getRouteNameById(e.routeId,e.customerId)," "),s(2),h(" ",e.bus," "),s(5),m("ngIf",e.refrenceURL)}}function vn(l,p){if(l&1&&(n(0,"div",44)(1,"div")(2,"strong"),a(3,"Cliente:"),i(),a(4),i(),n(5,"div")(6,"strong"),a(7,"Nombre:"),i(),a(8),i(),n(9,"div")(10,"strong"),a(11,"Email:"),i(),a(12),i(),n(13,"div")(14,"strong"),a(15,"Telefono:"),i(),a(16),i()()),l&2){let e=u();s(4),h(" ",e.modalDataUser.customerName,""),s(4),h(" ",e.modalDataUser.displayName,""),s(4),h(" ",e.modalDataUser.email,""),s(4),h(" ",e.modalDataUser.phoneNumber,"")}}function Cn(l,p){if(l&1){let e=w();n(0,"button",45),_("click",function(){f(e);let t=u();return g(t.closeProgramModal())}),a(1,"Aceptar"),i()}}function Sn(l,p){if(l&1&&(n(0,"div",44)(1,"div")(2,"strong"),a(3,"Cliente:"),i(),a(4),i(),n(5,"div")(6,"strong"),a(7,"Conductor:"),i(),a(8),i(),n(9,"div")(10,"strong"),a(11,"Turno:"),i(),a(12),i(),n(13,"div")(14,"strong"),a(15,"Inicio:"),i(),a(16),i(),n(17,"div")(18,"strong"),a(19,"Fin:"),i(),a(20),i(),n(21,"div")(22,"strong"),a(23,"Veh\xEDculo:"),i(),a(24),i()()),l&2){let e=u();s(4),h(" ",e.modalData.customerName,""),s(4),h(" ",e.modalData.driver,""),s(4),h(" ",e.modalData.round,""),s(4),h(" ",e.modalData.startAt,""),s(4),h(" ",e.modalData.endAt,""),s(4),h(" ",e.modalData.vehicleName,"")}}function xn(l,p){if(l&1){let e=w();n(0,"button",45),_("click",function(){f(e);let t=u();return g(t.closeProgramModal())}),a(1,"Aceptar"),i()}}function bn(l,p){if(l&1&&(n(0,"div",49),a(1),i()),l&2){let e=u(2);s(),h(" ",e.errorMessage," ")}}function yn(l,p){if(l&1){let e=w();n(0,"div",44)(1,"nz-select",46),N("ngModelChange",function(t){f(e);let r=u();return M(r.selectedStatus,t)||(r.selectedStatus=t),g(t)}),v(2,"nz-option",22)(3,"nz-option",23)(4,"nz-option",24)(5,"nz-option",25),i(),n(6,"textarea",47),N("ngModelChange",function(t){f(e);let r=u();return M(r.response,t)||(r.response=t),g(t)}),a(7," "),i(),z(8,bn,2,1,"div",48),i()}if(l&2){let e=u();s(),P("ngModel",e.selectedStatus),s(5),P("ngModel",e.response),s(2),m("ngIf",e.errorMessage)}}function En(l,p){if(l&1){let e=w();n(0,"button",45),_("click",function(){f(e);let t=u();return g(t.closeProgramModal())}),a(1,"Cerrar"),i(),n(2,"button",45),_("click",function(){f(e);let t=u();return g(t.handleOk())}),a(3,"Enviar"),i()}}var Ar=(()=>{class l{constructor(e,o,t,r){this.afs=e,this.messageService=o,this.datePipe=t,this.fb=r,this.programService=y(De),this.authService=y(Q),this.rolService=y(Ve),this.routesService=y(ae),this.accountsService=y(Z),this.dashboardService=y(Te),this.userService=y(ze),this.infoSegment=[],this.mfData=[],this.mfDataM=[],this.loadingmejorasData=!1,this.loadingincidenteData=!1,this.loadingopData=!1,this.infoLoad=[],this.stopSubscription$=new A,this.routeNames={},this.isProgramModalVisible=!1,this.isSeguimientoVisible=!1,this.isUserModalVisible=!1,this.modalData={},this.modalDataUser={},this.selectedDataUser=[],this.selectedStatus=null,this.response=null,this.errorMessage=null,this.selectedUserToken="",this.selectHelpCenterIdTicket="",this.selectedUidUser="",this.customersList=[],this.authService.user.subscribe(d=>{this.user=d,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(c=>{this.infoLoad=c,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(V(this.stopSubscription$),C(c=>{let x=c.payload.id,F=c.payload.data();return S({id:x},F)}),k(c=>(this.infoSegment=c,c))).subscribe())}),this.dateFilterForm=this.fb.group({selectedOption:[null],status:[]}),this.dateFilterFormI=this.fb.group({selectedOption:[null],status:[]}),this.dateFilterFormO=this.fb.group({selectedOption:[null],status:[]}),this.getCustomersList()}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}ngOnInit(){}onDateChange(e){if(!(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1))if(e=="1"){let o=this.dateFilterForm.get("selectedOption").value,t=this.dateFilterForm.get("status").value;o&&t?(this.programService.getHelpCenterAll("Mejora",o,t).pipe(C(r=>r.map(d=>{let c=d.payload.doc.id,x=d.payload.doc.data();return S({id:c},x)}))).subscribe(r=>{r.length>0&&(this.mfDataM=r,this.mfData.forEach(d=>{r.routeId&&this.getRouteNameById(d.routeId,d.customerId)}))}),this.programService.getHelpCenterAll("Felicitacion",o,t).pipe(C(r=>r.map(d=>{let c=d.payload.doc.id,x=d.payload.doc.data();return S({id:c},x)}))).subscribe(r=>{r.length>0&&(this.mfData=r,this.mfData.forEach(d=>{r.routeId&&this.getRouteNameById(d.routeId,d.customerId)}))})):this.sendMessage("error","Los criterios son requeridos para la busqueda")}else if(e=="2"){let o=this.dateFilterFormI.get("selectedOption").value,t=this.dateFilterFormI.get("status").value;o&&t?this.programService.getHelpCenterAll("Incidente",o,t).pipe(C(r=>r.map(d=>{let c=d.payload.doc.id,x=d.payload.doc.data();return S({id:c},x)}))).subscribe(r=>{r.length>0?(this.incidenteData=r,this.incidenteData.forEach(d=>{r.routeId&&this.getRouteNameById(d.routeId,d.customerId)})):this.sendMessage("info","No existen registros con estos criterios")}):this.sendMessage("error","Los criterios son requeridos para la busqueda")}else{let o=this.dateFilterFormO.get("selectedOption").value,t=this.dateFilterFormO.get("status").value;o&&t?this.programService.getHelpCenterAll("Objeto Perdido",o,t).pipe(C(r=>r.map(d=>{let c=d.payload.doc.id,x=d.payload.doc.data();return S({id:c},x)}))).subscribe(r=>{r.length>0?(this.opData=r,this.opData.forEach(d=>{r.routeId&&this.getRouteNameById(d.routeId,d.customerId)})):this.sendMessage("info","No existen registros con estos criterios")}):this.sendMessage("error","Los criterios son requeridos para la busqueda")}}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.afs.collection("customers",o=>o.where("customerId","==",this.user.customerId).orderBy("name")).snapshotChanges().pipe(V(this.stopSubscription$),C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)})),k(o=>(this.customersList=o,o))).subscribe():this.afs.collection("customers",o=>o.orderBy("name")).snapshotChanges().pipe(V(this.stopSubscription$),C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)})),k(o=>(this.customersList=o,o))).subscribe()}getRouteNameById(e,o){return this.routeNames[e]?this.routeNames[e]:(this.routesService.getRoute(o,e).pipe(ue(1),C(t=>{let r=t.payload.data(),d=r?r.name:"Pendiente..";return this.routeNames[e]=d,d})).subscribe(),"Loading...")}sendMessage(e,o){this.messageService.create(e,o)}openProgramModal(e,o){this.isProgramModalVisible=!0,this.loadProgramData(e,o)}openSeguimientoModal(e,o,t){this.isSeguimientoVisible=!0,this.selectedUserToken=o,this.selectHelpCenterIdTicket=e,this.selectedUidUser=t,this.loadUserInfo(this.selectedUidUser)}handleOk(){if(!this.selectedStatus||!this.response)this.errorMessage="Por favor, complete todos los campos antes de enviar.";else if(this.errorMessage=null,!this.selectedUserToken||!this.selectHelpCenterIdTicket||!this.selectedUidUser||!this.selectedDataUser)this.errorMessage="Falta informaci\xF3n por cargar. Validar nuevamente.";else{let e=this.selectedUserToken||"";if(this.programService.updateTicketHelpCenter(this.selectHelpCenterIdTicket,this.selectedStatus),e){let o={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"El Ticket generado tiene un status de :"+this.selectedStatus,msg:this.response,requestId:"suhB7YFAh6PYXCRuJhfD",token:e,uid:this.selectedUidUser,email:this.selectedDataUser.email,title:"Apps And Informa General",body:this.response},t={timestamp:new Date,title:"El Ticket generado tiene un status de :"+this.selectedStatus,email:this.selectedDataUser.email,body:this.response,token:e,uid:this.selectedUidUser};this.dashboardService.setChatMessage(o),this.dashboardService.setMessage(t,this.selectedUidUser),this.isSeguimientoVisible=!1,this.response=""}else this.sendMessage("error","Null token :"+this.selectedUidUser+"// "+this.modalDataUser.customerName)}}closeProgramModal(){this.isProgramModalVisible=!1,this.isSeguimientoVisible=!1,this.isUserModalVisible=!1,this.selectedUserToken="",this.selectHelpCenterIdTicket="",this.selectedUidUser=""}loadProgramData(e,o){this.programService.getProgrambyCustomer(e,o).subscribe({next:t=>{if(t.payload){let r=t.payload.data(),d=r.startAt?r.startAt.toDate():new Date,c=r.endAt?r.endAt.toDate():new Date,x=this.datePipe.transform(d,"dd-MM-yyyy HH:mm"),F=this.datePipe.transform(c,"dd-MM-yyyy HH:mm");this.modalData={customerName:r.customerName,driver:r.driver,startAt:x,round:r.round,endAt:F,vehicleName:r.vehicleName}}else this.sendMessage("error","Registro no encontrado")},error:t=>{this.sendMessage("error",t)}})}loadUserInfoPanel(e){this.isUserModalVisible=!0,this.loadUserInfo(e)}loadUserInfo(e){this.userService.getUserInfo(e).subscribe({next:o=>{if(o.payload){let t=o.payload.data();this.selectedDataUser=t,this.modalDataUser={customerName:t.customerName,displayName:t.displayName,email:t.email,phoneNumber:t.phoneNumber,token:t.token}}else this.sendMessage("error","Registro no encontrado")},error:o=>{this.sendMessage("error",o)}})}static{this.\u0275fac=function(o){return new(o||l)(O(X),O(Y),O(Re),O(J))}}static{this.\u0275cmp=U({type:l,selectors:[["app-center"]],decls:128,vars:29,consts:[["incidente",""],["basicTable3",""],["modalContent",""],["modalPassFooter",""],["modalContent2",""],["modalPassFooter2",""],["modalContent1",""],["modalPassFooter1",""],["basicTable1M",""],["basicTable1",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],["nzTitle","Mejoras y Felicitaciones"],[2,"margin-bottom","10px",3,"formGroup"],["for","selectedDate",2,"width","150px"],["formControlName","selectedOption","nzPlaceHolder","Selecciona un cliente",2,"width","300px",3,"ngModelChange","ngModel"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["for","type",2,"width","150px","margin-top","10px"],["formControlName","status","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de status",2,"width","350px"],["nzValue","Abierto","nzLabel","Abierto"],["nzValue","En Proceso","nzLabel","En Proceso"],["nzValue","Cerrado","nzLabel","Cerrado"],["nzValue","Cancelado","nzLabel","Cancelado"],["nz-button","","nzType","primary",2,"margin-left","5px","margin-top","10px","margin-bottom","10px",3,"click"],["nzTitle","Mejoras","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Felicitaciones","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Incidente"],["formControlName","status","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de status",2,"width","250px"],["nzTitle","Incidentes",3,"nzData","nzLoading","nzLoadingDelay"],[4,"ngFor","ngForOf"],["nzTitle","Objetos Perdidos"],["nzTitle","Objetos Perdidos",3,"nzData","nzLoading","nzLoadingDelay"],["nzTitle","Informaci\xF3n del Usuario",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzTitle","Informaci\xF3n del Programa",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzTitle","Seguimiento a Ticket",3,"nzVisibleChange","nzOnOk","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzCustomContent","",3,"nzLabel","nzValue"],["nzTitle","Mejoras","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay"],[3,"click"],["target","_blank",3,"href",4,"ngIf"],["target","_blank",3,"href"],["nzTitle","Felicitaciones","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay"],[2,"display","flex","flex-direction","column","align-items","flex-start"],["nz-button","",3,"click"],["nzAllowClear","","nzPlaceHolder","Seleccione un estado",2,"width","100%","margin-bottom","15px",3,"ngModelChange","ngModel"],["rows","4","nz-input","","placeholder","Redactar Respuesta",2,"width","100%",3,"ngModelChange","ngModel"],["style","color: red; margin-top: 10px;",4,"ngIf"],[2,"color","red","margin-top","10px"]],template:function(o,t){if(o&1){let r=w();n(0,"div",10)(1,"div",11)(2,"nz-page-header",12)(3,"nz-page-header-title",13),a(4,"Centro de Atenci\xF3n"),i(),n(5,"nz-page-header-subtitle"),a(6," Informaci\xF3n "),i()()(),n(7,"div",14)(8,"nz-tabset")(9,"nz-tab",15)(10,"div",16)(11,"div")(12,"label",17),a(13," Selecciona un Cliente: "),i(),n(14,"nz-select",18),N("ngModelChange",function(c){return f(r),M(t.selectedOption,c)||(t.selectedOption=c),g(c)}),z(15,on,2,3,"nz-option",19),i()(),n(16,"div")(17,"label",20),a(18," Status: "),i(),n(19,"nz-select",21),v(20,"nz-option",22)(21,"nz-option",23)(22,"nz-option",24)(23,"nz-option",25),i()()(),n(24,"div")(25,"a",26),_("click",function(){return f(r),g(t.onDateChange("1"))}),a(26,"Cargar"),i()(),n(27,"div"),z(28,dn,22,4,"nz-table",27),i(),n(29,"div"),z(30,pn,22,4,"nz-table",28),i()(),n(31,"nz-tab",29)(32,"div",16)(33,"div")(34,"label",17),a(35," Selecciona un Cliente: "),i(),n(36,"nz-select",18),N("ngModelChange",function(c){return f(r),M(t.selectedOption,c)||(t.selectedOption=c),g(c)}),z(37,un,2,3,"nz-option",19),i()(),n(38,"div")(39,"label",20),a(40," Status: "),i(),n(41,"nz-select",30),v(42,"nz-option",22)(43,"nz-option",23)(44,"nz-option",24)(45,"nz-option",25),i()()(),n(46,"div")(47,"a",26),_("click",function(){return f(r),g(t.onDateChange("2"))}),a(48,"Cargar"),i()(),n(49,"div")(50,"nz-table",31,0)(52,"thead")(53,"tr")(54,"th"),a(55,"Status"),i(),n(56,"th"),a(57,"Fecha"),i(),n(58,"th"),a(59,"Descripci\xF3n"),i(),n(60,"th"),a(61,"Ruta"),i(),n(62,"th"),a(63,"Tipo"),i(),n(64,"th"),a(65,"Usuario"),i(),n(66,"th"),a(67,"Referencia"),i(),n(68,"th"),a(69,"..."),i()()(),n(70,"tbody"),z(71,fn,19,7,"tr",32),i()()()(),n(72,"nz-tab",33)(73,"div",16)(74,"div")(75,"label",17),a(76," Selecciona un Cliente: "),i(),n(77,"nz-select",18),N("ngModelChange",function(c){return f(r),M(t.selectedOption,c)||(t.selectedOption=c),g(c)}),z(78,gn,2,3,"nz-option",19),i()(),n(79,"div")(80,"label",20),a(81," Status: "),i(),n(82,"nz-select",30),v(83,"nz-option",22)(84,"nz-option",23)(85,"nz-option",24)(86,"nz-option",25),i()()(),n(87,"div")(88,"a",26),_("click",function(){return f(r),g(t.onDateChange("3"))}),a(89,"Cargar"),i()(),n(90,"div")(91,"nz-table",34,1)(93,"thead")(94,"tr")(95,"th"),a(96,"Status"),i(),n(97,"th"),a(98,"Fecha"),i(),n(99,"th"),a(100,"Descripci\xF3n"),i(),n(101,"th"),a(102,"Ruta"),i(),n(103,"th"),a(104,"Tipo"),i(),n(105,"th"),a(106,"Usuario"),i(),n(107,"th"),a(108,"Referencia"),i(),n(109,"th"),a(110,"..."),i()()(),n(111,"tbody"),z(112,zn,19,7,"tr",32),i()()()()()()(),n(113,"nz-modal",35),N("nzVisibleChange",function(c){return f(r),M(t.isUserModalVisible,c)||(t.isUserModalVisible=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.closeProgramModal())}),z(114,vn,17,4,"ng-template",null,2,L)(116,Cn,2,0,"ng-template",null,3,L),i(),n(118,"nz-modal",36),N("nzVisibleChange",function(c){return f(r),M(t.isProgramModalVisible,c)||(t.isProgramModalVisible=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.closeProgramModal())}),z(119,Sn,25,6,"ng-template",null,4,L)(121,xn,2,0,"ng-template",null,5,L),i(),n(123,"nz-modal",37),N("nzVisibleChange",function(c){return f(r),M(t.isSeguimientoVisible,c)||(t.isSeguimientoVisible=c),g(c)}),_("nzOnOk",function(){return f(r),g(t.handleOk())})("nzOnCancel",function(){return f(r),g(t.closeProgramModal())}),z(124,yn,9,3,"ng-template",null,6,L)(126,En,4,0,"ng-template",null,7,L),i()}if(o&2){let r=E(51),d=E(92),c=E(115),x=E(117),F=E(120),T=E(122),D=E(125),Pe=E(127);s(2),m("nzGhost",!1),s(8),m("formGroup",t.dateFilterForm),s(4),P("ngModel",t.selectedOption),s(),m("ngForOf",t.customersList),s(13),m("ngIf",t.mfDataM),s(2),m("ngIf",t.mfData),s(2),m("formGroup",t.dateFilterFormI),s(4),P("ngModel",t.selectedOption),s(),m("ngForOf",t.customersList),s(13),m("nzData",t.incidenteData)("nzLoading",t.loadingincidenteData)("nzLoadingDelay",500),s(21),m("ngForOf",r.data),s(2),m("formGroup",t.dateFilterFormO),s(4),P("ngModel",t.selectedOption),s(),m("ngForOf",t.customersList),s(13),m("nzData",t.opData)("nzLoading",t.loadingopData)("nzLoadingDelay",500),s(21),m("ngForOf",d.data),s(),P("nzVisible",t.isUserModalVisible),m("nzContent",c)("nzFooter",x),s(5),P("nzVisible",t.isProgramModalVisible),m("nzContent",F)("nzFooter",T),s(5),P("nzVisible",t.isSeguimientoVisible),m("nzContent",D)("nzFooter",Pe)}},dependencies:[B,j,fe,de,oe,se,ce,le,me,we,_e,K,ge,ie,ee,te,ne,re,$,q,H,W,G,We,Ce,ve]})}}return l})();function In(l,p){if(l&1&&(n(0,"nz-option",22),a(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.name),s(),h(" ",e.name,"")}}function Fn(l,p){if(l&1&&(n(0,"a",25),a(1,"Ver Comprobante"),i()),l&2){let e=u().$implicit;m("href",e.image,R)}}function wn(l,p){if(l&1){let e=w();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),a(10),i(),n(11,"td"),z(12,Fn,2,1,"a",23),i(),n(13,"td")(14,"a",24),_("click",function(){let t=f(e).$implicit,r=u();return g(r.openSeguimientoModal(t.uid,t.userFullData.token,t.userFullData.id,t))}),a(15,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit;s(2),h(" ",e.status," "),s(2),I(e.date),s(2),h(" ",e.displayName," "),s(2),h(" ",e.route.description," "),s(2),h(" ",e.typeRefund.name," "),s(2),m("ngIf",e.image)}}function Vn(l,p){if(l&1&&(n(0,"div",33),a(1),i()),l&2){let e=u(2);s(),h(" ",e.errorMessage," ")}}function Tn(l,p){if(l&1){let e=w();n(0,"div",26)(1,"nz-card",27)(2,"div")(3,"strong"),a(4,"Cliente:"),i(),a(5),i(),n(6,"div")(7,"strong"),a(8,"Nombre:"),i(),a(9),i(),n(10,"div")(11,"strong"),a(12,"Email:"),i(),a(13),i(),n(14,"div")(15,"strong"),a(16,"Telefono:"),i(),a(17),i(),n(18,"div")(19,"strong"),a(20,"Telefono Alterno:"),i(),a(21),i(),n(22,"div")(23,"strong"),a(24,"Matricula:"),i(),a(25),i(),n(26,"div")(27,"strong"),a(28,"Ruta:"),i(),a(29),i(),n(30,"div")(31,"strong"),a(32,"Turno:"),i(),a(33),i()(),n(34,"nz-card",28)(35,"div")(36,"strong"),a(37,"Banco:"),i(),a(38),i(),n(39,"div")(40,"strong"),a(41,"Tarjeta o Clabe:"),i(),a(42),i(),n(43,"div")(44,"strong"),a(45,"Beneficiario:"),i(),a(46),i()(),n(47,"nz-card",29)(48,"nz-select",30),N("ngModelChange",function(t){f(e);let r=u();return M(r.selectedStatus,t)||(r.selectedStatus=t),g(t)}),v(49,"nz-option",14)(50,"nz-option",15)(51,"nz-option",16)(52,"nz-option",17),i(),n(53,"textarea",31),N("ngModelChange",function(t){f(e);let r=u();return M(r.response,t)||(r.response=t),g(t)}),a(54," "),i(),z(55,Vn,2,1,"div",32),i()()}if(l&2){let e=u();s(5),h(" ",e.modalDataUser.customerName,""),s(4),h(" ",e.modalDataUser.displayName,""),s(4),h(" ",e.modalDataUser.email,""),s(4),h(" ",e.modalDataUser.phone,""),s(4),h(" ",e.modalDataUser.phoneAlternative,""),s(4),h(" ",e.modalDataUser.matricula,""),s(4),h(" ",e.modalDataUser.name,""),s(4),h(" ",e.modalDataUser.turn,""),s(5),h(" ",e.modalDataUser.bankCode,""),s(4),h(" ",e.modalDataUser.bankCode,""),s(4),h(" ",e.modalDataUser.benefit,""),s(2),P("ngModel",e.selectedStatus),s(5),P("ngModel",e.response),s(2),m("ngIf",e.errorMessage)}}function Dn(l,p){if(l&1){let e=w();n(0,"button",34),_("click",function(){f(e);let t=u();return g(t.closeProgramModal())}),a(1,"Cerrar"),i(),n(2,"button",34),_("click",function(){f(e);let t=u();return g(t.handleOk())}),a(3,"Enviar"),i()}}var Zr=(()=>{class l{constructor(e,o,t){this.afs=e,this.messageService=o,this.fb=t,this.programService=y(De),this.authService=y(Q),this.rolService=y(Ve),this.routesService=y(ae),this.accountsService=y(Z),this.dashboardService=y(Te),this.userService=y(ze),this.mfDataM=[],this.infoSegment=[],this.stopSubscription$=new A,this.infoLoad=[],this.customersList=[],this.selectedStatus=null,this.response=null,this.errorMessage=null,this.loadingData=!1,this.isSeguimientoVisible=!1,this.selectedDataUser=[],this.modalDataUser={},this.authService.user.subscribe(r=>{this.user=r,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(d=>{this.infoLoad=d,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(V(this.stopSubscription$),C(d=>{let c=d.payload.id,x=d.payload.data();return S({id:c},x)}),k(d=>(this.infoSegment=d,d))).subscribe())}),this.dateFilterForm=this.fb.group({selectedOption:[null],status:[]}),this.getCustomersList()}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}ngOnInit(){}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.afs.collection("customers",o=>o.where("customerId","==",this.user.customerId).orderBy("name")).snapshotChanges().pipe(V(this.stopSubscription$),C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)})),k(o=>(this.customersList=o,o))).subscribe():this.afs.collection("customers",o=>o.orderBy("name")).snapshotChanges().pipe(V(this.stopSubscription$),C(o=>o.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return S({id:r},d)})),k(o=>(this.customersList=o,o))).subscribe()}sendMessage(e,o){this.messageService.create(e,o)}handleOk(){if(!this.selectedStatus||!this.response)this.errorMessage="Por favor, complete todos los campos antes de enviar.";else if(this.errorMessage=null,!this.selectedDataUser.token||!this.selectedDataUser.idDoc||!this.selectedDataUser.userUid||!this.selectedDataUser)this.errorMessage="Falta informaci\xF3n por cargar. Validar nuevamente.";else{let e=this.selectedDataUser.token||"";if(this.programService.updateTicketRefund(this.selectedDataUser.idDoc,this.selectedStatus),e){let o={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"El Ticket generado tiene un status de :"+this.selectedStatus,msg:this.response,requestId:"suhB7YFAh6PYXCRuJhfD",token:e,uid:this.selectedDataUser.userUid,email:this.selectedDataUser.email,title:"Apps And Informa General",body:this.response},t={timestamp:new Date,title:"El Ticket generado tiene un status de :"+this.selectedStatus,email:this.selectedDataUser.email,body:this.response,token:e,uid:this.selectedDataUser.userUid};this.dashboardService.setChatMessage(o),this.dashboardService.setMessage(t,this.selectedDataUser.userUid),this.isSeguimientoVisible=!1,this.response=""}else this.sendMessage("error","Token vacio :"+this.selectedDataUser.userUid+"// "+this.modalDataUser.customerName)}}openSeguimientoModal(e,o,t,r){this.isSeguimientoVisible=!0,r.userFullData.token==null&&(this.errorMessage="El usuario no cuenta con un token v\xE1lido para poder dar seguimiento."),this.modalDataUser={customerName:r.customer,displayName:r.displayName,benefit:r.benefit,bankCode:r.bankCode,phone:r.phone,matricula:r.matricula,phoneAlternative:r.phoneAlternative,email:r.email,token:r.userFullData.token,turn:r.turn,name:r.route.name,idDoc:r.idDoc,userUid:r.uid},this.selectedDataUser=this.modalDataUser}onDateChange(){if(!(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1)){let e=this.dateFilterForm.get("selectedOption").value,o=this.dateFilterForm.get("status").value;e&&o?this.programService.getRefund(e,o).pipe(C(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return S({id:d},c)}))).subscribe(t=>{t.length>0&&(this.mfDataM=t)}):this.sendMessage("error","Los criterios son requeridos para la busqueda")}}closeProgramModal(){this.isSeguimientoVisible=!1,this.modalDataUser={}}static{this.\u0275fac=function(o){return new(o||l)(O(X),O(Y),O(J))}}static{this.\u0275cmp=U({type:l,selectors:[["app-refaund"]],decls:51,vars:11,consts:[["basicTable1M",""],["modalContent1",""],["modalPassFooter1",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],[2,"margin-bottom","10px",3,"formGroup"],["for","selectedOption",2,"width","150px"],["formControlName","selectedOption","nzPlaceHolder","Selecciona un cliente",2,"width","300px",3,"ngModelChange","ngModel"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["for","type",2,"width","150px","margin-top","10px"],["formControlName","status","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de status",2,"width","350px"],["nzValue","Abierto","nzLabel","Abierto"],["nzValue","En Proceso","nzLabel","En Proceso"],["nzValue","Cerrado","nzLabel","Cerrado"],["nzValue","Cancelado","nzLabel","Cancelado"],["nz-button","","nzType","primary",2,"margin-left","5px","margin-top","10px","margin-bottom","10px",3,"click"],["nzTitle","Reembolso","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay"],[4,"ngFor","ngForOf"],["nzTitle","Seguimiento a Ticket",3,"nzVisibleChange","nzOnOk","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzCustomContent","",3,"nzLabel","nzValue"],["target","_blank",3,"href",4,"ngIf"],[3,"click"],["target","_blank",3,"href"],[2,"background","#ECECEC","padding","30px"],["nzTitle","Datos Usuario"],["nzTitle","Datos Bancarios"],["nzTitle","Seguimiento"],["nzAllowClear","","nzPlaceHolder","Seleccione un estado",2,"width","100%","margin-bottom","15px",3,"ngModelChange","ngModel"],["rows","4","nz-input","","placeholder","Redactar Respuesta",2,"width","100%",3,"ngModelChange","ngModel"],["style","color: red; margin-top: 10px;",4,"ngIf"],[2,"color","red","margin-top","10px"],["nz-button","",3,"click"]],template:function(o,t){if(o&1){let r=w();n(0,"div",3)(1,"div",4)(2,"nz-page-header",5)(3,"nz-page-header-title",6),a(4,"Reembolso"),i(),n(5,"nz-page-header-subtitle"),a(6," Proceso "),i()()(),n(7,"div",7)(8,"div",8)(9,"div")(10,"label",9),a(11," Selecciona un Cliente: "),i(),n(12,"nz-select",10),N("ngModelChange",function(c){return f(r),M(t.selectedOption,c)||(t.selectedOption=c),g(c)}),z(13,In,2,3,"nz-option",11),i()(),n(14,"div")(15,"label",12),a(16," Status: "),i(),n(17,"nz-select",13),v(18,"nz-option",14)(19,"nz-option",15)(20,"nz-option",16)(21,"nz-option",17),i()()(),n(22,"div")(23,"a",18),_("click",function(){return f(r),g(t.onDateChange())}),a(24,"Cargar"),i()(),n(25,"div")(26,"nz-table",19,0)(28,"thead")(29,"tr")(30,"th"),a(31,"Status"),i(),n(32,"th"),a(33,"Fecha"),i(),n(34,"th"),a(35,"Usuario"),i(),n(36,"th"),a(37,"Ruta"),i(),n(38,"th"),a(39,"Tipo de Reembolso"),i(),n(40,"th"),a(41,"Referencia"),i(),n(42,"th"),a(43,"..."),i()()(),n(44,"tbody"),z(45,wn,16,6,"tr",20),i()()()()(),n(46,"nz-modal",21),N("nzVisibleChange",function(c){return f(r),M(t.isSeguimientoVisible,c)||(t.isSeguimientoVisible=c),g(c)}),_("nzOnOk",function(){return f(r),g(t.handleOk())})("nzOnCancel",function(){return f(r),g(t.closeProgramModal())}),z(47,Tn,56,14,"ng-template",null,1,L)(49,Dn,4,0,"ng-template",null,2,L),i()}if(o&2){let r=E(27),d=E(48),c=E(50);s(2),m("nzGhost",!1),s(6),m("formGroup",t.dateFilterForm),s(4),P("ngModel",t.selectedOption),s(),m("ngForOf",t.customersList),s(13),m("nzData",t.mfDataM)("nzLoading",t.loadingData)("nzLoadingDelay",500),s(19),m("ngForOf",r.data),s(),P("nzVisible",t.isSeguimientoVisible),m("nzContent",d)("nzFooter",c)}},dependencies:[B,j,fe,de,oe,se,ce,le,me,we,_e,K,ge,Et,ie,ee,te,ne,re,$,q,H,W,G,We]})}}return l})();export{Xn as a,dr as b,Ir as c,Ar as d,Zr as e};
