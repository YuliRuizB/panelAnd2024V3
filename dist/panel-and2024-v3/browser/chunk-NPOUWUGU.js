import{a as $t,c as Wt,d as jt,e as Xt,g as hi,h as fi}from"./chunk-2OFCCJKJ.js";import{a as st}from"./chunk-2KSUXL2N.js";import{a as di,b as ci,d as _i}from"./chunk-N4UQ3ILK.js";import{a as li}from"./chunk-6SROZLDU.js";import{a as mi,c as ui,d as pi}from"./chunk-HGPVWXMK.js";import{a as si}from"./chunk-2UZMVIXQ.js";import{a as at}from"./chunk-DQJBGMKA.js";import{a as Le,b as Yt,d as ni}from"./chunk-CK5DDPD7.js";import{c as rt}from"./chunk-4NYLJXOR.js";import{a as Lt}from"./chunk-AEEHAD3U.js";import{a as ot,b as oi}from"./chunk-SFJ6QK5D.js";import{a as ii,h as ai}from"./chunk-HVJFLIPY.js";import{A as Ze,B as ti,C as et,D as tt,E as it,F as nt,H as ri,a as Ge,c as Ee,d as Ve,e as Kt,k as Pe,n as Qe,o as Je,x as Ye,y as ei}from"./chunk-52KDZ4QO.js";import{$ as Mt,P as ve,Q as Ce,R as $e,S as be,_ as We,aa as Ut,b as Be,c as D,ca as At,d as le,da as je,e as de,ea as ki,f as Nt,fa as Xe,g as qe,h as kt,ha as Gt,i as ce,ja as De,k as me,m as ue,pa as Te,q as pe,qa as we,sa as Ke,t as ge,ta as Zt,u as ze}from"./chunk-HEDYHKE3.js";import{c as Rt,d as Ot}from"./chunk-PMPBZHT3.js";import{a as Bt,c as qt,f as He,g as Ht,h as Qt,j as Jt}from"./chunk-IDUACQZO.js";import{$b as se,Bc as Ft,C as mt,Ce as Z,Db as A,Df as xe,Ea as z,Eb as gt,Ef as Se,Fb as q,Fe as _e,G as re,Ga as d,Gf as ye,Ib as E,M as J,Mb as Tt,O as U,Q as K,Qc as zt,Tc as he,U as Et,Ua as t,Ud as fe,Va as i,Wa as v,X as ut,Xa as ie,Y as k,Ya as ne,_ as Y,_a as x,_b as wt,ac as Oe,bb as _,c as te,cf as vt,db as u,ga as h,gb as oe,gc as It,ha as f,ib as Vt,jc as Ae,kb as pt,l as St,lb as ht,m as T,mb as ft,nb as b,ob as o,pb as g,qb as C,r as yt,ra as Ue,rb as L,sa as r,sb as Pt,ta as R,tb as w,ub as I,vb as F,y as Dt,yb as _t,zb as O}from"./chunk-KAPUTOGI.js";import{a as Mi}from"./chunk-Z7P4GB6X.js";import{a as M,b as Me,f as xt,h as X}from"./chunk-SIAVTO45.js";var ae=xt(ki());var Ct=xt(Mi());var Bi=["download"],qi=["searchBar"],$i=s=>({open:s}),Wi=()=>({y:"calc(100vh - 120px)"}),ji=()=>[];function Xi(s,m){if(s&1&&(t(0,"nz-option",63),o(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(),C(" ",e.name," ")}}function Gi(s,m){s&1&&v(0,"span",64)}function Hi(s,m){s&1&&v(0,"span",64)}function Qi(s,m){s&1&&v(0,"i",71)}function Ji(s,m){if(s&1){let e=x();t(0,"tr",67),_("click",function(){let n=h(e).$implicit,l=u(2);return f(l.userSelected(n))}),t(1,"td")(2,"div",68)(3,"div"),v(4,"nz-avatar",69),i(),t(5,"div")(6,"h6"),z(7,Qi,1,0,"i",70),o(8),i(),ie(9),t(10,"p"),o(11),v(12,"br"),o(13),i(),ne(),i()()()()}if(s&2){let e=m.$implicit;r(4),d("nzSize",30)("nzSrc",e.photoURL),r(3),d("ngIf",e.disabled),r(),C(" ",e.displayName," "),r(3),C(" ",e.email," "),r(2),C(" ",e.customerName," ")}}function Ki(s,m){if(s&1&&(t(0,"nz-table",65,29)(2,"tbody"),z(3,Ji,14,6,"tr",66),i()()),s&2){let e=b(1),a=u();d("nzData",a.devicesList)("nzShowPagination",!0)("nzPageSize",30)("nzScroll",_t(5,Wi)),r(3),d("ngForOf",e.data)}}function Yi(s,m){s&1&&v(0,"i",84)}function Zi(s,m){if(s&1){let e=x();t(0,"li",85),_("click",function(){h(e);let n=u(2);return f(n.setUserDisabled(!0))}),o(1,"Suspender Usuario "),i()}}function en(s,m){if(s&1){let e=x();t(0,"li",85),_("click",function(){h(e);let n=u(2);return f(n.setUserDisabled(!1))}),o(1,"Reactivar Usuario "),i()}}function tn(s,m){if(s&1&&(t(0,"div",72),ie(1),t(2,"div",73)(3,"a",74),v(4,"i",75),i(),t(5,"div"),v(6,"nz-avatar",76),i(),t(7,"div",77)(8,"h6"),z(9,Yi,1,0,"i",78),o(10),i(),t(11,"p"),v(12,"nz-badge",79),t(13,"span"),o(14),i()()()(),ne(),t(15,"div")(16,"a",80),v(17,"i",81),i(),t(18,"nz-dropdown-menu",null,30)(20,"ul",82),z(21,Zi,2,0,"li",83)(22,en,2,0,"li",83),i()()()()),s&2){let e=b(19),a=u();r(3),d("routerLink",_t(10,ji)),r(3),d("nzSrc",a.currentUserSelected.photoURL),r(3),d("ngIf",a.currentUserSelected.disabled),r(),C(" ",a.currentUserSelected.displayName," "),r(2),d("nzStatus",a.currentUserSelected.emailVerified?"success":"error"),r(2),C(" ",a.currentUserSelected.email," "),r(2),d("nzDropdownMenu",e)("nzTrigger","click"),r(5),d("ngIf",!a.currentUserSelected.disabled),r(),d("ngIf",a.currentUserSelected.disabled)}}function nn(s,m){s&1&&(t(0,"nz-tag",118),o(1,"Cortes\xEDa "),i()),s&2&&d("nzColor","yellow")}function an(s,m){s&1&&(t(0,"nz-tag",118),o(1,"Pagado "),i()),s&2&&d("nzColor","cyan")}function rn(s,m){s&1&&(t(0,"nz-tag",118),o(1,"Pagado Parcial"),i()),s&2&&d("nzColor","red")}function on(s,m){s&1&&(t(0,"nz-tag",118),o(1,"Baja"),i()),s&2&&d("nzColor","magenta")}function sn(s,m){if(s&1&&(t(0,"nz-tag",118),o(1),i()),s&2){let e=u().$implicit;d("nzColor","blue"),r(),g(e.payment)}}function ln(s,m){s&1&&(t(0,"nz-tag",118),o(1,"Activo"),i()),s&2&&d("nzColor","cyan")}function dn(s,m){if(s&1&&(t(0,"span"),o(1),A(2,"currency"),i()),s&2){let e=u().$implicit;r(),g(gt(2,1,e.amountPayment))}}function cn(s,m){if(s&1){let e=x();t(0,"tr",67),_("click",function(){let n=h(e).$implicit,l=u(3);return f(l.boardingPassSelected(n))}),t(1,"td")(2,"nz-tag",118),o(3),i(),t(4,"span",119),o(5),A(6,"date"),i()(),t(7,"td"),o(8),i(),t(9,"td"),z(10,nn,2,1,"nz-tag",120)(11,an,2,1,"nz-tag",120)(12,rn,2,1,"nz-tag",120)(13,on,2,1,"nz-tag",120)(14,sn,2,2,"nz-tag",120)(15,ln,2,1,"nz-tag",120),i(),t(16,"td"),o(17),A(18,"currency"),i(),t(19,"td"),z(20,dn,3,3,"span",116),i(),t(21,"td")(22,"a",121),v(23,"i",122),i(),t(24,"nz-dropdown-menu",null,30)(26,"ul",82)(27,"li",85),_("click",function(){let n=h(e).$implicit,l=u(3);return f(l.editPurchase(n))}),o(28,"Editar Boleto"),i(),t(29,"li",85),_("click",function(){let n=h(e).$implicit,l=u(3);return f(l.deletePurchase(n.id))}),o(30,"Eliminar Boleto"),i(),t(31,"li",85),_("click",function(){let n=h(e).$implicit,l=u(3);return f(l.activatePurchase(n.id,!1))}),o(32,"Suspender Boleto"),i(),t(33,"li",85),_("click",function(){let n=h(e).$implicit,l=u(3);return f(l.activatePurchase(n.id,!0))}),o(34,"Activar Boleto"),i()()()()()}if(s&2){let e=m.$implicit,a=b(25);r(2),d("nzColor","blue"),r(),g(e.name),r(2),C(" ",q(6,15,e.creation_date,"medium")," "),r(3),Pt("",e.routeName," / ",e.stopDescription," / ",e.round,""),r(2),d("ngIf",e.status==="completed"&&!!e.is_courtesy),r(),d("ngIf",e.status==="completed"&&!e.is_courtesy),r(),d("ngIf",e.status!=="completed"),r(),d("ngIf",e.status!=="completed"&&e.baja===!0),r(),d("ngIf",e.status!=="completed"),r(),d("ngIf",e.active),r(2),C(" ",gt(18,18,e.amount)," "),r(3),d("ngIf",e.payment=="Anticipo"),r(2),d("nzDropdownMenu",a)}}function mn(s,m){if(s&1&&(t(0,"nz-table",117,29)(2,"thead")(3,"tr")(4,"th"),o(5,"Pase"),i(),t(6,"th"),o(7,"Operaci\xF3n"),i(),t(8,"th"),o(9,"Estatus "),i(),t(10,"th"),o(11,"Precio"),i(),t(12,"th"),o(13,"Abono"),i()()(),t(14,"tbody"),z(15,cn,35,20,"tr",66),i()()),s&2){let e=b(1),a=u(2);d("nzData",a.latestPurchases)("nzPageSize",3)("nzLoading",a.loadingLatestPurchases)("nzLoadingDelay",500),r(15),d("ngForOf",e.data)}}function un(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),A(3,"date"),i(),t(4,"td"),o(5),i()()),s&2){let e=m.$implicit;r(2),g(q(3,2,e.createdAt.toDate(),"dd/MM/yyyy")),r(3),g(e.msg)}}function pn(s,m){if(s&1){let e=x();t(0,"div"),v(1,"nz-divider",123),t(2,"textarea",124),F("ngModelChange",function(n){h(e);let l=u(2);return I(l.newMessage,n)||(l.newMessage=n),f(n)}),i()(),t(3,"button",88),_("click",function(){h(e);let n=u(2);return f(n.showModalMessageCenter())}),v(4,"i",71),o(5,"Enviar Mensaje"),i()}if(s&2){let e=u(2);r(2),w("ngModel",e.newMessage)}}function hn(s,m){if(s&1&&(t(0,"nz-tag",118),o(1),i()),s&2){let e=u().$implicit;d("nzColor","red"),r(),C("",e.status," ")}}function fn(s,m){if(s&1&&(t(0,"nz-tag",118),o(1),i()),s&2){let e=u().$implicit;d("nzColor","green"),r(),C("",e.status," ")}}function _n(s,m){if(s&1&&(t(0,"nz-tag",118),o(1),i()),s&2){let e=u().$implicit;d("nzColor","blue"),r(),C("",e.status," ")}}function gn(s,m){if(s&1&&(t(0,"nz-tag",118),o(1),i()),s&2){let e=u().$implicit;d("nzColor","gray"),r(),C("",e.status," ")}}function zn(s,m){if(s&1&&(t(0,"a",126),o(1,"Ver Comprobante"),i()),s&2){let e=u().$implicit;oe("href",e.url,Ue)}}function vn(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),z(6,hn,2,2,"nz-tag",120)(7,fn,2,2,"nz-tag",120)(8,_n,2,2,"nz-tag",120)(9,gn,2,2,"nz-tag",120),i(),t(10,"td"),z(11,zn,2,1,"a",125),i()()),s&2){let e=m.$implicit;r(2),g(e.date),r(2),g(e.product.description),r(2),d("ngIf",e.status==="rejected"),r(),d("ngIf",e.status==="complete"),r(),d("ngIf",e.status==="accepted"),r(),d("ngIf",e.status==="pending"),r(2),d("ngIf",e.url)}}function Cn(s,m){s&1&&(t(0,"tr")(1,"td",127),o(2,"No hay transferencias encontradas"),i()())}function bn(s,m){if(s&1){let e=x();t(0,"nz-tabset",86)(1,"nz-tab",87),_("nzClick",function(){h(e);let n=u();return f(n.nzClicOptionInformacion())}),t(2,"div")(3,"button",88),_("click",function(){h(e);let n=u();return f(n.showModalEditUser(n.currentUserSelected))}),v(4,"i",71),o(5,"Editar Usuario"),i()(),t(6,"div")(7,"nz-descriptions",89)(8,"nz-descriptions-item",90)(9,"div",91),o(10),i()(),t(11,"nz-descriptions-item",92),o(12),i(),t(13,"nz-descriptions-item",93),o(14),i(),t(15,"nz-descriptions-item",94),o(16),i(),t(17,"nz-descriptions-item",95),o(18),i(),t(19,"nz-descriptions-item",96),o(20),i(),t(21,"nz-descriptions-item",97),o(22),i(),t(23,"nz-descriptions-item",98),o(24),i(),t(25,"nz-descriptions-item",99),o(26),i(),t(27,"nz-descriptions-item",100),o(28),i(),t(29,"nz-descriptions-item",101),o(30),i(),t(31,"nz-descriptions-item",102),o(32),i(),o(33),t(34,"nz-descriptions-item",103),o(35),i(),t(36,"nz-descriptions-item",104),o(37),i(),t(38,"nz-descriptions-item",105),o(39),i(),t(40,"nz-descriptions-item",106),o(41),i(),t(42,"nz-descriptions-item",107),o(43),i(),t(44,"nz-descriptions-item",108),o(45),i()()()(),t(46,"nz-tab",109)(47,"button",88),_("click",function(){h(e);let n=u();return f(n.showModal())}),v(48,"i",71),o(49,"Nuevo Pase"),i(),z(50,mn,16,5,"nz-table",110),i(),t(51,"nz-tab",111),_("nzClick",function(){h(e);let n=u();return f(n.nzClicOption())}),t(52,"nz-table",112,31)(54,"thead")(55,"tr")(56,"th"),o(57,"Fecha"),i(),t(58,"th"),o(59,"Mensaje"),i()()(),t(60,"tbody"),z(61,un,6,5,"tr",113),i()(),z(62,pn,6,1,"ng-template",null,32,E),i(),t(64,"nz-tab",114),_("nzClick",function(){h(e);let n=u();return f(n.nzClicTransfer())}),t(65,"nz-table",115,33)(67,"thead")(68,"tr")(69,"th"),o(70,"Fecha"),i(),t(71,"th"),o(72,"Producto"),i(),t(73,"th"),o(74,"Estatus"),i(),t(75,"th"),o(76,"Comprobante"),i()()(),t(77,"tbody"),z(78,vn,12,7,"tr",113)(79,Cn,3,0,"tr",116),i()()()()}if(s&2){let e=b(53),a=b(63),n=u();r(10),C(" ",n.currentUserSelected.firstName,""),r(2),g(n.currentUserSelected.lastName),r(2),g(n.currentUserSelected.email),r(2),g(n.currentUserSelected.curp),r(2),g(n.currentUserSelected.age),r(2),g(n.currentUserSelected.group),r(2),g(n.currentUserSelected.adress),r(2),g(n.currentUserSelected.emailVerified),r(2),g(n.currentUserSelected.displayName),r(2),g(n.currentUserSelected.customerName),r(2),C(" ",n.currentUserSelected.defaultRouteName,""),r(2),g(n.currentUserSelected.defaultStopName),r(),C(" ",n.currentUserSelected.turno," "),r(2),C(" ",n.currentUserSelected.turno==="1"?"D\xEDa":n.currentUserSelected.turno==="2"?"Tarde":n.currentUserSelected.turno===""?"No definido":""," "),r(2),g(n.currentUserSelected.phoneNumber),r(2),g(n.currentUserSelected.studentId),r(2),g(n.currentUserSelected.username),r(2),g(n.currentUserSelected.status),r(2),g(n.currentUserSelected.roundTrip),r(5),d("ngIf",n.latestPurchases),r(2),d("nzData",n.userChatMessageData)("nzPageSize",3)("nzFooter",a)("nzLoadingDelay",500),r(9),d("ngForOf",e.data),r(4),d("nzData",n.dataTransfer)("nzPageSize",3)("nzShowPagination",!0),r(13),d("ngForOf",n.dataTransfer),r(),d("ngIf",!n.loadinglatestTransfer&&n.dataTransfer.length===0)}}function xn(s,m){s&1&&o(0," Nuevo pase ")}function Sn(s,m){if(s&1&&(ie(0),o(1),ne()),s&2){let e=u().$implicit;r(),C("(",e.frequencies,")")}}function yn(s,m){if(s&1&&(t(0,"div")(1,"nz-option",63),v(2,"i",71),o(3),z(4,Sn,2,1,"ng-container",116),o(5),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.name)("nzValue",e.productId),r(2),C(" ",e.name," "),r(),d("ngIf",e.frequencies),r(),C(" $",e.price," ")}}function Dn(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.routeId),r(2),C(" ",e.name,"")}}function En(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),v(3,"br"),o(4),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.stopPointId),r(2),C(" ",e.name," "),r(2),C(" ",e.description," ")}}function Vn(s,m){s&1&&(t(0,"div",141)(1,"nz-form-item")(2,"nz-form-label"),o(3,"Fecha Compromiso "),i(),v(4,"nz-date-picker",153),i()())}function Pn(s,m){if(s&1){let e=x();t(0,"nz-form-item")(1,"nz-upload",154),_("nzChange",function(n){h(e);let l=u(2);return f(l.handleChange2(n))}),t(2,"p",155)(3,"span",71),o(4,"Cargar"),i()(),t(5,"p",156),o(6,"Arrastra el documento a subir"),i(),t(7,"p",157),o(8," Soporte para un solo archivo. Prohibido subir datos corruptos o archivos maliciosos. "),i()()()}s&2&&(r(),d("nzMultiple",!1)("nzLimit",1)("nzSize",50)("nzFileType","image/png,image/jpeg,image/gif,image/bmp"))}function Tn(s,m){if(s&1){let e=x();t(0,"form",128),_("ngSubmit",function(){h(e);let n=u();return f(n.submitForm())}),t(1,"nz-form-item")(2,"nz-form-label"),o(3,"Servicio"),i(),t(4,"nz-select",129),_("ngModelChange",function(n){h(e);let l=u();return f(l.onProductSelected(n,l.products))}),z(5,yn,6,5,"div",113),i()(),t(6,"nz-form-item")(7,"nz-form-label"),o(8,"Operaci\xF3n"),i(),t(9,"nz-select",130),_("ngModelChange",function(n){h(e);let l=u();return f(l.onRouteSelected(n,l.routes))}),z(10,Dn,3,3,"nz-option",44),i()(),t(11,"nz-form-item")(12,"nz-form-label"),o(13,"Estaciones"),i(),t(14,"nz-select",131),_("ngModelChange",function(n){h(e);let l=u();return f(l.onStopPointSelected(n,l.stopPoints))}),z(15,En,5,4,"nz-option",44),i()(),t(16,"nz-form-item")(17,"nz-form-label"),o(18,"Turno"),i(),t(19,"nz-select",132),v(20,"nz-option",133)(21,"nz-option",134)(22,"nz-option",135),i()(),t(23,"nz-form-item")(24,"nz-form-label"),o(25,"Tipo de Pago"),i(),t(26,"nz-select",136),_("ngModelChange",function(n){h(e);let l=u();return f(l.changePayment(n))}),v(27,"nz-option",137)(28,"nz-option",138)(29,"nz-option",139),i()(),t(30,"nz-form-item")(31,"div",140)(32,"div",141)(33,"nz-form-label"),o(34,"Cantidad a pagar "),i(),t(35,"nz-input-number",142),_("ngModelChange",function(n){h(e);let l=u();return f(l.onAmountChange(n))}),i()(),z(36,Vn,5,0,"div",143),i()(),t(37,"div",140)(38,"div",141)(39,"nz-form-item")(40,"nz-form-label"),o(41,"Total a pagar"),i(),t(42,"nz-input-number",144),_("ngModelChange",function(n){h(e);let l=u();return f(l.onAmountChange(n))}),i()()(),t(43,"div",141)(44,"nz-form-item")(45,"nz-form-label"),o(46,"\xBFEs cortes\xEDa?"),i(),t(47,"nz-switch",145),_("ngModelChange",function(n){h(e);let l=u();return f(l.onCourtesyChange(n))}),i()()()(),t(48,"nz-form-item")(49,"nz-form-label"),o(50,"Tipo de Referencia"),i(),t(51,"nz-select",146),_("ngModelChange",function(n){h(e);let l=u();return f(l.changePaymentType(n))}),v(52,"nz-option",147)(53,"nz-option",148)(54,"nz-option",149),i()(),z(55,Pn,9,4,"nz-form-item",116),t(56,"nz-form-item")(57,"nz-form-control")(58,"label",150),o(59,"Activar pase"),i()()(),t(60,"div",140)(61,"div",141)(62,"nz-form-item")(63,"nz-form-label"),o(64,"V\xE1lido desde"),i(),v(65,"nz-date-picker",151),i()(),t(66,"div",141)(67,"nz-form-item")(68,"nz-form-label"),o(69,"V\xE1lido hasta"),i(),t(70,"nz-date-picker",152),_("ngModelChange",function(n){h(e);let l=u();return f(l.onChangeValidTo(n))}),i()()()()()}if(s&2){let e=u();d("formGroup",e.validateForm),r(5),d("ngForOf",e.products),r(5),d("ngForOf",e.routes),r(5),d("ngForOf",e.stopPoints),r(20),d("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar),r(),d("ngIf",e.isAnticipo),r(6),d("disabled",!1)("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar),r(13),d("ngIf",e.ifValidPayment),r(15),d("nzDisabledDate",e.disabledDate)}}function wn(s,m){if(s&1){let e=x();t(0,"button",158),_("click",function(){h(e);let n=u();return f(n.handleCancel())}),o(1,"Cancelar"),i(),t(2,"button",159),_("click",function(){h(e);let n=u();return f(n.submitForm())}),o(3,"Generar Pase"),i()}if(s&2){let e=u();r(2),d("nzLoading",e.isConfirmLoading)}}function In(s,m){s&1&&o(0," Productos ")}function Fn(s,m){if(s&1&&(ie(0),o(1),ne()),s&2){let e=u(2).$implicit;r(),C("(",e.frequencies,")")}}function Nn(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),z(3,Fn,2,1,"ng-container",116),o(4),i()),s&2){let e=u().$implicit;d("nzLabel",e.name)("nzValue",e.productId),r(2),C(" ",e.name," "),r(),d("ngIf",e.frequencies),r(),C(" $",e.price," ")}}function kn(s,m){if(s&1&&(t(0,"div"),z(1,Nn,5,5,"nz-option",162),i()),s&2){let e=m.$implicit;r(),d("ngIf",e.type=="Producto")}}function Mn(s,m){if(s&1){let e=x();t(0,"form",128),_("ngSubmit",function(){h(e);let n=u();return f(n.submitForm())}),t(1,"nz-form-item")(2,"nz-form-label"),o(3,"Producto"),i(),t(4,"nz-select",129),_("ngModelChange",function(n){h(e);let l=u();return f(l.onProductSelected(n,l.products))}),z(5,kn,2,1,"div",113),i()(),t(6,"div",140)(7,"div",141)(8,"nz-form-item")(9,"nz-form-label"),o(10,"Cantidad a pagar"),i(),t(11,"nz-input-number",160),_("ngModelChange",function(n){h(e);let l=u();return f(l.onAmountChange(n))}),i()()(),t(12,"div",141)(13,"nz-form-item")(14,"nz-form-label"),o(15,"\xBFEs cortes\xEDa?"),i(),t(16,"nz-switch",145),_("ngModelChange",function(n){h(e);let l=u();return f(l.onCourtesyChange(n))}),i()()()(),t(17,"div",140)(18,"div",141)(19,"nz-form-item")(20,"nz-form-label"),o(21,"V\xE1lido desde"),i(),v(22,"nz-date-picker",151),i()(),t(23,"div",141)(24,"nz-form-item")(25,"nz-form-label"),o(26,"V\xE1lido hasta"),i(),v(27,"nz-date-picker",161),i()()()()}if(s&2){let e=u();d("formGroup",e.validateForm),r(5),d("ngForOf",e.products),r(6),d("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function Un(s,m){if(s&1){let e=x();t(0,"button",158),_("click",function(){h(e);let n=u();return f(n.handleCancelProduct())}),o(1,"Cancelar"),i(),t(2,"button",159),_("click",function(){h(e);let n=u();return f(n.submitFormProduct())}),o(3,"Guardar"),i()}if(s&2){let e=u();r(2),d("nzLoading",e.isConfirmLoading)}}function Ln(s,m){s&1&&o(0," Editar Usuario ")}function Rn(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.uid),r(2),C(" ",e.name,"")}}function On(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.routeId),r(2),C(" ",e.name,"")}}function An(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(2),C(" ",e.name," ")}}function Bn(s,m){if(s&1){let e=x();t(0,"form",128),_("ngSubmit",function(){h(e);let n=u();return f(n.submitForm())}),t(1,"nz-form-item")(2,"nz-form-label",163),o(3,"Nombre"),i(),t(4,"nz-form-control",163),v(5,"input",164),i()(),t(6,"nz-form-item")(7,"nz-form-label",163),o(8,"Apellidos"),i(),t(9,"nz-form-control",163),v(10,"input",165),i()(),t(11,"nz-form-item")(12,"nz-form-label",163),o(13,"Display Name"),i(),t(14,"nz-form-control",163),v(15,"input",166),i()(),t(16,"nz-form-item")(17,"nz-form-label",163),o(18,"Usuario"),i(),t(19,"nz-form-control",163),v(20,"input",167),i()(),t(21,"nz-form-item")(22,"nz-form-label",163),o(23,"Tel\xE9fono"),i(),t(24,"nz-form-control",163),v(25,"input",168),i()(),t(26,"nz-form-item")(27,"nz-form-label",163),o(28,"Identificaci\xF3n"),i(),t(29,"nz-form-control",163),v(30,"input",169),i()(),t(31,"nz-form-item")(32,"nz-form-label",163),o(33,"Email"),i(),t(34,"nz-form-control",163),v(35,"input",170),i()(),t(36,"nz-form-item")(37,"nz-form-label",163),o(38,"Empresa"),i(),t(39,"nz-form-control",163)(40,"nz-select",171),_("ngModelChange",function(n){h(e);let l=u();return f(l.onCustomerSelected(n,l.customers))}),z(41,Rn,3,3,"nz-option",44),i()()(),t(42,"nz-form-item")(43,"nz-form-label",163),o(44,"Operaci\xF3n"),i(),t(45,"nz-form-control",163)(46,"nz-select",172),_("ngModelChange",function(n){h(e);let l=u();return f(l.onRouteEditUserSelected(n,l.userRoutes))}),z(47,On,3,3,"nz-option",44),i()()(),t(48,"nz-form-item")(49,"nz-form-label",163),o(50,"Estaci\xF3n"),i(),t(51,"nz-form-control",163)(52,"nz-select",173),_("ngModelChange",function(n){h(e);let l=u();return f(l.onStopPointEditUserSelected(n,l.stopPointsList))}),z(53,An,3,3,"nz-option",44),i()()(),t(54,"nz-form-item")(55,"nz-form-label",163),o(56,"Turno"),i(),t(57,"nz-select",174),v(58,"nz-option",133)(59,"nz-option",134)(60,"nz-option",135),i()()()}if(s&2){let e=u();d("formGroup",e.validateEditForm),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(3),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(3),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(3),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(3),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(3),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(3),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(3),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(2),d("ngForOf",e.customers),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(2),d("ngForOf",e.userRoutes),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(2),d("ngForOf",e.stopPointsList),r(2),d("nzSm",6)("nzXs",24)}}function qn(s,m){if(s&1){let e=x();t(0,"button",158),_("click",function(){h(e);let n=u();return f(n.handleCancel())}),o(1,"Cancelar"),i(),t(2,"button",158),_("click",function(){h(e);let n=u();return f(n.submitEditForm())}),o(3,"Guardar"),i()}}function $n(s,m){s&1&&v(0,"nz-badge",219)}function Wn(s,m){s&1&&v(0,"nz-badge",220)}function jn(s,m){s&1&&v(0,"nz-badge",221)}function Xn(s,m){s&1&&v(0,"nz-badge",222)}function Gn(s,m){s&1&&v(0,"nz-badge",221)}function Hn(s,m){if(s&1){let e=x();t(0,"a",225),_("nzOnConfirm",function(){h(e);let n=u(3);return f(n.onCanUpdatePayment())})("nzOnCancel",function(){h(e);let n=u(3);return f(n.handleCancel())}),t(1,"small"),o(2,"Editar"),i()()}}function Qn(s,m){if(s&1){let e=x();t(0,"nz-input-number",226),_("ngModelChange",function(n){h(e);let l=u(3);return f(l.onPaymentUpdated(n))}),i()}if(s&2){let e=u(3);d("ngModel",e.lastPurchase==null?null:e.lastPurchase.amount)("nzMin",1)("nzMax",1e4)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function Jn(s,m){if(s&1&&(t(0,"nz-descriptions-item",178),o(1),z(2,Hn,3,0,"a",223)(3,Qn,1,6,"nz-input-number",224),i()),s&2){let e=u(2);r(),L(" ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.currency," ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.amountPayment," "),r(),d("ngIf",!e.canUpdatePayment&&(e.lastPurchase==null?null:e.lastPurchase.status)!="completed"&&(e.lastPurchase==null?null:e.lastPurchase.baja)===!1),r(),d("ngIf",e.canUpdatePayment)}}function Kn(s,m){if(s&1&&(t(0,"nz-descriptions-item",178),o(1),i()),s&2){let e=u(2);r(),L(" ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.currency," ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.amount," ")}}function Yn(s,m){if(s&1&&(t(0,"div")(1,"a",126),o(2,"Ver Comprobante"),i()()),s&2){let e=u().$implicit;r(),oe("href",e.fileURL,Ue)}}function Zn(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),A(3,"date"),i(),t(4,"td"),o(5),i(),t(6,"td"),o(7),i(),t(8,"td"),o(9),i(),t(10,"td"),o(11),i(),t(12,"td"),z(13,Yn,3,1,"div",116),i()()),s&2){let e=m.$implicit;r(2),C(" ",q(3,6,e.creation_date,"medium"),""),r(3),g(e.name),r(2),g(e.typePayment),r(2),g(e.type),r(2),C(" $ ",e.amount,""),r(2),d("ngIf",e.typePayment=="Transferencia")}}function ea(s,m){if(s&1&&(t(0,"div"),v(1,"nz-qrcode",213),o(2),i()),s&2){let e=u(3);r(),Vt("nzValue","",e.currentUserSelected.uid,"-",e.lastPurchase.idBoardingPass,""),r(),L(" ",e.currentUserSelected.uid,"-",e.lastPurchase.idBoardingPass," ")}}function ta(s,m){if(s&1&&(t(0,"div"),z(1,ea,3,5,"div",116),i()),s&2){let e=u(2);r(),d("ngIf",e.currentUserSelected&&e.lastPurchase)}}function ia(s,m){if(s&1&&v(0,"nz-avatar",227),s&2){let e=u(2);d("nzSrc",e.currentUserSelected.photoURL)}}function na(s,m){if(s&1){let e=x();t(0,"div",175)(1,"nz-tabset",86)(2,"nz-tab",176)(3,"div")(4,"nz-descriptions",89)(5,"nz-descriptions-item",177),o(6),i(),t(7,"nz-descriptions-item",178),z(8,$n,1,0,"nz-badge",179)(9,Wn,1,0,"nz-badge",180)(10,jn,1,0,"nz-badge",181),i(),t(11,"nz-descriptions-item",182),z(12,Xn,1,0,"nz-badge",183)(13,Gn,1,0,"nz-badge",181),i(),t(14,"nz-descriptions-item",184),o(15),A(16,"date"),i(),t(17,"nz-descriptions-item",185),o(18),i(),t(19,"nz-descriptions-item",186),o(20),A(21,"date"),i(),t(22,"nz-descriptions-item",187),o(23),A(24,"date"),i(),t(25,"nz-descriptions-item",188),o(26),i(),z(27,Jn,4,4,"nz-descriptions-item",189)(28,Kn,2,2,"nz-descriptions-item",189),t(29,"nz-descriptions-item",190),o(30),i(),t(31,"nz-descriptions-item",101),o(32),i(),t(33,"nz-descriptions-item",191),o(34),i(),t(35,"nz-descriptions-item",103),o(36),i(),t(37,"nz-descriptions-item",192),o(38),i(),t(39,"nz-descriptions-item",193),o(40),i(),t(41,"nz-descriptions-item",194),o(42),A(43,"date"),i(),t(44,"nz-descriptions-item",195),o(45),i(),t(46,"nz-descriptions-item",196),o(47),i()(),v(48,"br"),i()(),t(49,"nz-tab",197),_("nzClick",function(){h(e);let n=u();return f(n.nzClicOption())}),t(50,"nz-table",198,34)(52,"thead")(53,"tr")(54,"th"),o(55,"Fecha"),i(),t(56,"th"),o(57,"Nombre"),i(),t(58,"th"),o(59,"Tipo de Referencia"),i(),t(60,"th"),o(61,"Tipo de Pago"),i(),t(62,"th"),o(63,"Monto"),i(),t(64,"th"),o(65,"Comprobante"),i()()(),t(66,"tbody"),z(67,Zn,14,9,"tr",113),i()()(),t(68,"nz-tab",199),v(69,"app-shared-usage-history",200),i(),t(70,"nz-tab",201),z(71,ta,2,1,"div",116),i(),t(72,"nz-tab",202)(73,"div",203)(74,"div",204)(75,"div",205)(76,"nz-card",202)(77,"button",158),_("click",function(){h(e);let n=u();return f(n.downloadPdf())}),o(78,"Imprimir"),i()()()(),t(79,"div",206)(80,"div",207)(81,"nz-card",208),v(82,"nz-card-meta",209),t(83,"div")(84,"div")(85,"B",210),o(86,"Credencial And 2024 "),i()(),t(87,"div")(88,"a",210),o(89),i(),o(90," / "),t(91,"a",210),o(92),i()(),t(93,"div",211)(94,"a",210),o(95),i()()(),t(96,"div",212),v(97,"nz-qrcode",213),i()(),z(98,ia,1,1,"ng-template",null,35,E),i(),t(100,"div",205)(101,"nz-card",208)(102,"div",214)(103,"div",215)(104,"div",216),v(105,"nz-card",217),i()(),t(106,"div",215)(107,"div",216),v(108,"nz-card",217),i()(),t(109,"div",215)(110,"div",216),v(111,"nz-card",217),i()(),t(112,"div",215)(113,"div",216),v(114,"nz-card",217),i()(),t(115,"div",215)(116,"div",216),v(117,"nz-card",217),i()(),t(118,"div",215)(119,"div",216),v(120,"nz-card",217),i()()(),t(121,"div",214)(122,"a",218),o(123," Derechos reservados Apps And. Esta credencial es intransferible"),i()()()()()()()()()}if(s&2){let e,a=b(51),n=b(99),l=u();r(6),g(l.lastPurchase==null?null:l.lastPurchase.name),r(2),d("ngIf",l.lastPurchase.status=="completed"),r(),d("ngIf",l.lastPurchase.status=="partial"),r(),d("ngIf",l.lastPurchase.status=="in_progress"),r(2),d("ngIf",l.lastPurchase.active),r(),d("ngIf",!l.lastPurchase.active),r(2),C(" ",q(16,51,l.lastPurchase==null?null:l.lastPurchase.operation_date,"medium")," "),r(3),C("",l.lastPurchase!=null&&l.lastPurchase.is_courtesy?"Si":"No"," "),r(2),C(" ",l.lastPurchase!=null&&l.lastPurchase.validFrom?q(21,54,l.lastPurchase==null||l.lastPurchase.validFrom==null?null:l.lastPurchase.validFrom.toDate(),"medium"):"",""),r(3),C(" ",l.lastPurchase!=null&&l.lastPurchase.validTo?q(24,57,l.lastPurchase==null||l.lastPurchase.validTo==null?null:l.lastPurchase.validTo.toDate(),"medium"):""," "),r(3),L("",l.lastPurchase==null?null:l.lastPurchase.currency," ",l.lastPurchase==null?null:l.lastPurchase.price," "),r(),d("ngIf",(l.lastPurchase==null?null:l.lastPurchase.status)=="partial"),r(),d("ngIf",(l.lastPurchase==null?null:l.lastPurchase.status)!=="partial"),r(2),g(l.lastPurchase==null?null:l.lastPurchase.authorization),r(2),C("",l.lastPurchase==null?null:l.lastPurchase.routeName," "),r(2),L("",l.lastPurchase==null?null:l.lastPurchase.stopName," ",l.lastPurchase==null?null:l.lastPurchase.stopDescription,""),r(2),g(l.lastPurchase==null?null:l.lastPurchase.round),r(2),L(" ",l.lastPurchase==null?null:l.lastPurchase.currency," ",l.lastPurchase==null?null:l.lastPurchase.amountPayment," "),r(2),C(" ",l.lastPurchase==null?null:l.lastPurchase.payment," "),r(2),C(" ",q(43,60,l.lastPurchase==null?null:l.lastPurchase.promiseDate,"mediumDate")," "),r(3),C(" ",l.lastPurchase==null?null:l.lastPurchase.typePayment," "),r(2),C(" ",l.lastPurchase==null?null:l.lastPurchase.description," "),r(3),d("nzData",l.lastestPurchaseDetail)("nzPageSize",3)("nzLoadingDelay",500),r(17),d("ngForOf",a.data),r(2),d("userId",l.currentUserSelected.uid)("boardingPassId",(e=l.lastPurchase.id)!==null&&e!==void 0?e:""),r(2),d("ngIf",l.requiredFields),r(3),d("nzGutter",8),r(),d("nzSpan",8),r(4),d("nzGutter",8),r(),d("nzSpan",8),r(),d("nzBordered",!0),r(),oe("nzTitle",l.currentUserSelected.displayName),d("nzAvatar",n),r(7),C("Operaci\xF3n: ",l.currentUserSelected.defaultRouteName," "),r(3),C(" Turno :",l.currentUserSelected.defaultRound,""),r(3),C(" Identificaci\xF3n: ",l.currentUserSelected.studentId,""),r(2),d("nzValue",(l.currentUserSelected==null?null:l.currentUserSelected.uid)+"-"+(l.lastPurchase==null?null:l.lastPurchase.idBoardingPass)),r(3),d("nzSpan",8),r(),d("nzBordered",!0),r(4),d("nzBordered",!0),r(3),d("nzBordered",!0),r(3),d("nzBordered",!0),r(3),d("nzBordered",!0),r(3),d("nzBordered",!0),r(3),d("nzBordered",!0)}}function aa(s,m){s&1&&o(0," Comprobante de Pago ")}function ra(s,m){if(s&1&&(t(0,"div",230)(1,"nz-card"),v(2,"nz-card-meta",231),t(3,"div",230)(4,"p")(5,"strong"),o(6,"Producto:"),i(),o(7),i(),t(8,"p")(9,"strong"),o(10,"Descripci\xF3n:"),i(),o(11),i(),t(12,"p")(13,"strong"),o(14,"Pago:"),i(),o(15),i(),t(16,"p")(17,"strong"),o(18,"Tipo:"),i(),o(19),i(),t(20,"p")(21,"strong"),o(22,"Tipo de Pago:"),i(),o(23),i(),t(24,"p")(25,"strong"),o(26,"Costo Total:"),i(),o(27),i(),t(28,"p")(29,"strong"),o(30,"Costo:"),i(),o(31),i(),t(32,"p")(33,"strong"),o(34,"Autorizaci\xF3n:"),i(),o(35),i(),t(36,"p")(37,"strong"),o(38,"Fecha de Creaci\xF3n :"),i(),o(39),i(),t(40,"p")(41,"strong"),o(42,"Cantidad de Viajes:"),i(),o(43),i(),t(44,"p")(45,"strong"),o(46,"Viajes Actuales:"),i(),o(47),i(),t(48,"p")(49,"strong"),o(50,"Nombre de la Operaci\xF3n:"),i(),o(51),i(),t(52,"p")(53,"strong"),o(54,"Turno:"),i(),o(55),i(),t(56,"p")(57,"strong"),o(58,"Parada:"),i(),o(59),i(),t(60,"p")(61,"strong"),o(62,"Fecha Valida inicial:"),i(),o(63),i(),t(64,"p")(65,"strong"),o(66,"Fecha Valida final:"),i(),o(67),i()()()()),s&2){let e=m.$implicit;r(7),C(" ",e.name,""),r(4),C(" ",e.description,""),r(4),C(" ",e.typePayment,""),r(4),C(" ",e.type,""),r(4),C(" ",e.method,""),r(4),C(" ",e.price,""),r(4),C(" ",e.amount,""),r(4),C(" ",e.authorization,""),r(4),C(" ",e.creation_date,""),r(4),C(" ",e.amountTrips,""),r(4),C(" ",e.currentTrips,""),r(4),C(" ",e.routeName,""),r(4),C(" ",e.round,""),r(4),C(" ",e.stopName,""),r(4),C(" ",e.validFrom,""),r(4),C(" ",e.validTo,"")}}function oa(s,m){if(s&1&&(t(0,"div",228),z(1,ra,68,16,"div",229),i()),s&2){let e=u();r(),d("ngForOf",e.reciboPago)}}function sa(s,m){if(s&1){let e=x();t(0,"button",158),_("click",function(){h(e);let n=u();return f(n.handleCancel())}),o(1,"Cancelar"),i(),t(2,"button",159),_("click",function(){h(e);let n=u();return f(n.generatePDFInfo())}),o(3,"Generar PDF"),i()}if(s&2){let e=u();r(2),d("nzLoading",e.isConfirmLoading)}}function la(s,m){s&1&&(t(0,"div"),o(1," Nuevo pase "),i())}function da(s,m){if(s&1&&(ie(0),o(1),ne()),s&2){let e=u().$implicit;r(),C("(",e.frequencies,")")}}function ca(s,m){if(s&1&&(t(0,"div")(1,"nz-option",63),v(2,"i",71),o(3),z(4,da,2,1,"ng-container",116),o(5),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.name)("nzValue",e.productId),r(2),C(" ",e.name," "),r(),d("ngIf",e.frequencies),r(),C(" $",e.price," ")}}function ma(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.routeId),r(2),C(" ",e.name,"")}}function ua(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),v(3,"br"),o(4),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.stopPointId),r(2),C(" ",e.name," "),r(2),C(" ",e.description,"")}}function pa(s,m){if(s&1){let e=x();t(0,"div")(1,"form",128),_("ngSubmit",function(){h(e);let n=u(2);return f(n.submitForm())}),t(2,"nz-form-item")(3,"nz-form-label"),o(4,"Servicio"),i(),t(5,"nz-select",129),_("ngModelChange",function(n){h(e);let l=u(2);return f(l.onProductSelected(n,l.products))}),z(6,ca,6,5,"div",113),i()(),t(7,"nz-form-item")(8,"nz-form-label"),o(9,"Operaci\xF3n"),i(),t(10,"nz-select",130),_("ngModelChange",function(n){h(e);let l=u(2);return f(l.onRouteSelected(n,l.routes))}),z(11,ma,3,3,"nz-option",44),i()(),t(12,"nz-form-item")(13,"nz-form-label"),o(14,"Estaci\xF3n"),i(),t(15,"nz-select",131),_("ngModelChange",function(n){h(e);let l=u(2);return f(l.onStopPointSelected(n,l.stopPoints))}),z(16,ua,5,4,"nz-option",44),i()(),t(17,"nz-form-item")(18,"nz-form-label"),o(19,"Turno"),i(),t(20,"nz-select",132),v(21,"nz-option",133)(22,"nz-option",134)(23,"nz-option",135),i()(),t(24,"div",140)(25,"div",141)(26,"nz-form-item")(27,"nz-form-label"),o(28,"Cantidad a pagar"),i(),t(29,"nz-input-number",160),_("ngModelChange",function(n){h(e);let l=u(2);return f(l.onAmountChange(n))}),i()()(),t(30,"div",141)(31,"nz-form-item")(32,"nz-form-label"),o(33,"\xBFEs cortes\xEDa?"),i(),t(34,"nz-switch",145),_("ngModelChange",function(n){h(e);let l=u(2);return f(l.onCourtesyChange(n))}),i()()()(),t(35,"nz-form-item")(36,"nz-form-control")(37,"label",150),o(38,"Activar pase"),i()()(),t(39,"div",140)(40,"div",141)(41,"nz-form-item")(42,"nz-form-label"),o(43,"V\xE1lido desde"),i(),v(44,"nz-date-picker",151),i()(),t(45,"div",141)(46,"nz-form-item")(47,"nz-form-label"),o(48,"V\xE1lido hasta"),i(),v(49,"nz-date-picker",161),i()()()()()}if(s&2){let e=u(2);r(),d("formGroup",e.validateForm),r(5),d("ngForOf",e.products),r(5),d("ngForOf",e.routes),r(5),d("ngForOf",e.stopPoints),r(13),d("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function ha(s,m){if(s&1){let e=x();t(0,"tr")(1,"td",238),F("nzCheckedChange",function(n){let l=h(e).$implicit,c=u(3);return I(c.mapOfCheckedId[l.id],n)||(c.mapOfCheckedId[l.id]=n),f(n)}),_("nzCheckedChange",function(){h(e);let n=u(3);return f(n.refreshStatus())}),i(),t(2,"td"),o(3),i(),t(4,"td"),o(5),i(),t(6,"td"),o(7),i()()}if(s&2){let e=m.$implicit,a=u(3);r(),w("nzChecked",a.mapOfCheckedId[e.id]),r(2),g(e.studentId),r(2),g(e.displayName),r(2),g(e.email)}}function fa(s,m){if(s&1){let e=x();t(0,"div")(1,"nz-table",236,36),_("nzCurrentPageDataChange",function(n){h(e);let l=u(2);return f(l.currentPageDataChange(n))}),t(3,"thead")(4,"tr")(5,"th",237),F("nzCheckedChange",function(n){h(e);let l=u(2);return I(l.isAllDisplayDataChecked,n)||(l.isAllDisplayDataChecked=n),f(n)}),_("nzCheckedChange",function(n){h(e);let l=u(2);return f(l.checkAllData(n))}),i(),t(6,"th"),o(7,"Id"),i(),t(8,"th"),o(9,"Nombre"),i(),t(10,"th"),o(11,"Email / Tel\xE9fono"),i()()(),t(12,"tbody"),z(13,ha,8,4,"tr",113),i()()()}if(s&2){let e=b(2),a=u(2);r(),d("nzData",a.devicesList)("nzSize","middle"),r(4),d("nzSelections",a.listOfSelection),w("nzChecked",a.isAllDisplayDataChecked),d("nzIndeterminate",a.isIndeterminate),r(8),d("ngForOf",e.data)}}function _a(s,m){if(s&1){let e=x();t(0,"a",240),_("nzOnConfirm",function(){h(e);let n=u(3);return f(n.onCanUpdatePayment())})("nzOnCancel",function(){h(e);let n=u(3);return f(n.handleCancel())}),t(1,"small"),o(2,"Editar"),i()()}}function ga(s,m){if(s&1){let e=x();t(0,"nz-input-number",226),_("ngModelChange",function(n){h(e);let l=u(3);return f(l.onPaymentUpdated(n))}),i()}if(s&2){let e=u(3);d("ngModel",e.lastPurchase==null?null:e.lastPurchase.amount)("nzMin",1)("nzMax",12e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function za(s,m){if(s&1&&(t(0,"div")(1,"div")(2,"nz-descriptions",89)(3,"nz-descriptions-item",177),o(4),i(),t(5,"nz-descriptions-item",185),o(6),i(),t(7,"nz-descriptions-item",186),o(8),A(9,"date"),i(),t(10,"nz-descriptions-item",187),o(11),A(12,"date"),i(),t(13,"nz-descriptions-item",188),o(14),i(),t(15,"nz-descriptions-item",178),o(16),z(17,_a,3,0,"a",239)(18,ga,1,6,"nz-input-number",224),i(),t(19,"nz-descriptions-item",190),o(20),i(),t(21,"nz-descriptions-item",101),o(22),i(),t(23,"nz-descriptions-item",191),o(24),i(),t(25,"nz-descriptions-item",103),o(26),i(),t(27,"nz-descriptions-item",196),o(28),i()(),v(29,"br"),i(),o(30),i()),s&2){let e=u(2);r(4),g(e.validateForm.controls.product_description.value),r(2),C("",e.validateForm.controls.is_courtesy.value?"Si":"No"," "),r(2),C(" ",q(9,17,e.lastPurchase==null||e.lastPurchase.validFrom==null?null:e.lastPurchase.validFrom.toDate(),e.lastPurchase!=null&&e.lastPurchase.validFrom?"medium":"")," "),r(3),C(" ",q(12,20,e.lastPurchase==null||e.lastPurchase.validTo==null?null:e.lastPurchase.validTo.toDate(),e.canUpdateValidTo?"mediumDate":"")," "),r(3),L("",e.lastPurchase==null?null:e.lastPurchase.currency," ",e.lastPurchase==null?null:e.lastPurchase.price," "),r(2),L(" ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.currency," ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.amount," "),r(),d("ngIf",!e.canUpdatePayment&&(e.lastPurchase==null?null:e.lastPurchase.status)!="completed"),r(),d("ngIf",e.canUpdatePayment),r(2),g(e.lastPurchase==null?null:e.lastPurchase.authorization),r(2),C("",e.lastPurchase==null?null:e.lastPurchase.routeName," "),r(2),L("",e.lastPurchase==null?null:e.lastPurchase.stopName," ",e.lastPurchase==null?null:e.lastPurchase.stopDescription,""),r(2),g(e.lastPurchase==null?null:e.lastPurchase.round),r(2),C(" ",e.lastPurchase==null?null:e.lastPurchase.description," "),r(2),C(" ",e.actualSelectedRows," ")}}function va(s,m){if(s&1&&(t(0,"div")(1,"nz-steps",232),v(2,"nz-step",233)(3,"nz-step",234)(4,"nz-step",235),i(),v(5,"br"),t(6,"div"),z(7,pa,50,9,"div",116)(8,fa,14,6,"div",116)(9,za,31,23,"div",116),i()()),s&2){let e=u();r(),d("nzCurrent",e.current),r(6),d("ngIf",e.current==0),r(),d("ngIf",e.current==1),r(),d("ngIf",e.current==2)}}function Ca(s,m){if(s&1){let e=x();t(0,"button",245),_("click",function(){h(e);let n=u(2);return f(n.pre())}),t(1,"span"),o(2,"Anterior"),i()()}if(s&2){let e=u(2);d("disabled",e.isCreatingBoardingPasses)}}function ba(s,m){if(s&1){let e=x();t(0,"button",245),_("click",function(){h(e);let n=u(2);return f(n.next())}),t(1,"span"),o(2,"Siguiente"),i()()}if(s&2){let e=u(2);d("disabled",e.isCreatingBoardingPasses)}}function xa(s,m){if(s&1){let e=x();t(0,"button",159),_("click",function(){h(e);let n=u(2);return f(n.createMultipleBoardingPasses())}),t(1,"span"),o(2,"Crear Pases"),i()()}if(s&2){let e=u(2);d("nzLoading",e.isCreatingBoardingPasses)}}function Sa(s,m){if(s&1){let e=x();t(0,"button",158),_("click",function(){h(e);let n=u(2);return f(n.done())}),t(1,"span"),o(2,"Terminar"),i()()}}function ya(s,m){if(s&1&&(t(0,"div",241),z(1,Ca,3,1,"button",242)(2,ba,3,1,"button",242)(3,xa,3,1,"button",243)(4,Sa,3,0,"button",244),i()),s&2){let e=u();r(),d("ngIf",e.current>0&&!e.isDone),r(),d("ngIf",e.current<2),r(),d("ngIf",e.current===2&&!e.isDone),r(),d("ngIf",e.current===2&&e.isDone)}}function Da(s,m){s&1&&o(0," Liquidaci\xF3n de Pase ")}function Ea(s,m){if(s&1){let e=x();t(0,"nz-form-item")(1,"nz-upload",154),_("nzChange",function(n){h(e);let l=u(2);return f(l.handleChange2(n))}),t(2,"p",155)(3,"span",71),o(4,"Cargar"),i()(),t(5,"p",156),o(6,"Arrastra el documento a subir"),i(),t(7,"p",157),o(8," Soporte para un solo archivo. Prohibido subir datos corruptos o archivos maliciosos. "),i()()()}s&2&&(r(),d("nzMultiple",!1)("nzLimit",1)("nzSize",50)("nzFileType","image/png,image/jpeg,image/gif,image/bmp"))}function Va(s,m){if(s&1){let e=x();t(0,"form",128),_("ngSubmit",function(){h(e);let n=u();return f(n.createLiquidacion())}),t(1,"nz-form-item")(2,"nz-form-label"),o(3,"Producto Seleccionado"),i(),v(4,"input",246),i(),t(5,"nz-form-item")(6,"nz-form-label"),o(7,"Costo Total del Producto"),i(),v(8,"nz-input-number",247),i(),t(9,"nz-form-item")(10,"nz-form-label"),o(11,"Total abonado"),i(),v(12,"nz-input-number",248),i(),t(13,"nz-form-item")(14,"nz-form-label"),o(15,"Cantidad a liquidar"),i(),v(16,"nz-input-number",249),i(),t(17,"nz-form-item")(18,"label",250),_("ngModelChange",function(){h(e);let n=u();return f(n.bajaCheck())}),t(19,"span"),o(20,"Baja"),i()()(),t(21,"nz-form-item")(22,"div",140)(23,"div",141)(24,"nz-form-item")(25,"nz-form-label"),o(26,"V\xE1lido desde"),i(),v(27,"nz-date-picker",151),i()(),t(28,"div",141)(29,"nz-form-item")(30,"nz-form-label"),o(31,"V\xE1lido hasta"),i(),v(32,"nz-date-picker",161),i()()()(),t(33,"nz-form-item")(34,"nz-form-label"),o(35,"Tipo de Referencia"),i(),t(36,"nz-select",146),_("ngModelChange",function(n){h(e);let l=u();return f(l.changeLiqPaymentType(n))}),v(37,"nz-option",147)(38,"nz-option",148)(39,"nz-option",149),i()(),z(40,Ea,9,4,"nz-form-item",116),i()}if(s&2){let e=u();d("formGroup",e.validateLiqForm),r(40),d("ngIf",e.ifValidLiqPayment)}}function Pa(s,m){if(s&1){let e=x();t(0,"button",251),_("click",function(){h(e);let n=u();return f(n.createLiquidacion())}),t(1,"span"),o(2,"Submit"),i()(),t(3,"button",251),_("click",function(){h(e);let n=u();return f(n.handleCancel())}),t(4,"span"),o(5,"Cancel"),i()()}}function Ta(s,m){s&1&&o(0," Nuevas credenciales ")}function wa(s,m){if(s&1){let e=x();t(0,"div")(1,"form",128),_("ngSubmit",function(){h(e);let n=u(2);return f(n.createMultipleCredentials())}),t(2,"div",140)(3,"div",141)(4,"nz-form-item")(5,"nz-form-label"),o(6,"V\xE1lido desde"),i(),v(7,"nz-date-picker",151),i()(),t(8,"div",141)(9,"nz-form-item")(10,"nz-form-label"),o(11,"V\xE1lido hasta"),i(),v(12,"nz-date-picker",161),i()(),t(13,"div",141)(14,"nz-form-item")(15,"nz-form-control")(16,"label",150),o(17,"Activar credencial"),i()()()()()()()}if(s&2){let e=u(2);r(),d("formGroup",e.credentialForm)}}function Ia(s,m){if(s&1){let e=x();t(0,"tr")(1,"td",238),F("nzCheckedChange",function(n){let l=h(e).$implicit,c=u(3);return I(c.mapOfCredentialsCheckedId[l.uid],n)||(c.mapOfCredentialsCheckedId[l.uid]=n),f(n)}),_("nzCheckedChange",function(){h(e);let n=u(3);return f(n.refreshCredentialsStatus())}),i(),t(2,"td"),o(3),i(),t(4,"td"),o(5),i(),t(6,"td"),o(7),i(),t(8,"td"),o(9),i()()}if(s&2){let e=m.$implicit,a=u(3);r(),w("nzChecked",a.mapOfCredentialsCheckedId[e.uid]),r(2),g(e.customerName),r(2),g(e.studentId),r(2),g(e.displayName),r(2),g(e.email)}}function Fa(s,m){if(s&1){let e=x();t(0,"div")(1,"nz-table",236,36),_("nzCurrentPageDataChange",function(n){h(e);let l=u(2);return f(l.currentCredentialsPageDataChange(n))}),t(3,"thead")(4,"tr")(5,"th",237),F("nzCheckedChange",function(n){h(e);let l=u(2);return I(l.isCredentialsAllDisplayDataChecked,n)||(l.isCredentialsAllDisplayDataChecked=n),f(n)}),_("nzCheckedChange",function(n){h(e);let l=u(2);return f(l.checkCredentialsAllData(n))}),i(),t(6,"th",255),o(7,"Empresa"),i(),t(8,"th",255),o(9,"Id"),i(),t(10,"th",255),o(11,"Nombre"),i(),t(12,"th",255),o(13,"Email / Tel\xE9fono"),i()()(),t(14,"tbody"),z(15,Ia,10,5,"tr",113),i()()()}if(s&2){let e=b(2),a=u(2);r(),d("nzData",a.usersByAccount)("nzSize","middle"),r(4),d("nzSelections",a.listOfCredentialsSelection),w("nzChecked",a.isCredentialsAllDisplayDataChecked),d("nzIndeterminate",a.isCredentialsIndeterminate),r(10),d("ngForOf",e.data)}}function Na(s,m){if(s&1&&(t(0,"div"),o(1),i()),s&2){let e=u(3);r(),C(" Se crear\xE1n ",e.actualSelectedRows," credenciales para los usuarios seleccionados. ")}}function ka(s,m){s&1&&(t(0,"div"),o(1," No has seleccionado ning\xFAn usuario para crear una credencial. "),i())}function Ma(s,m){if(s&1&&(t(0,"div"),z(1,Na,2,1,"div",116)(2,ka,2,0,"div",116),i()),s&2){let e=u(2);r(),d("ngIf",e.actualSelectedRows>0),r(),d("ngIf",e.actualSelectedRows===0)}}function Ua(s,m){if(s&1&&(t(0,"div")(1,"div"),o(2),i()()),s&2){let e=u(2);r(2),C(" Se crearon ",e.actualSelectedRows,". ")}}function La(s,m){if(s&1&&(t(0,"nz-steps",232),v(1,"nz-step",252)(2,"nz-step",253)(3,"nz-step",235),i(),v(4,"br"),t(5,"div",254),z(6,wa,18,1,"div",116)(7,Fa,16,6,"div",116)(8,Ma,3,2,"div",116)(9,Ua,3,1,"div",116),i()),s&2){let e=u();d("nzCurrent",e.current),r(6),d("ngIf",e.current==0),r(),d("ngIf",e.current==1),r(),d("ngIf",e.current==2),r(),d("ngIf",e.current==3)}}function Ra(s,m){if(s&1){let e=x();t(0,"button",251),_("click",function(){h(e);let n=u(2);return f(n.pre())}),t(1,"span"),o(2,"Anterior"),i()()}}function Oa(s,m){if(s&1){let e=x();t(0,"button",259),_("click",function(){h(e);let n=u(2);return f(n.next())}),t(1,"span"),o(2,"Siguiente"),i()()}if(s&2){let e=u(2);d("disabled",e.credentialForm.invalid)}}function Aa(s,m){if(s&1){let e=x();t(0,"button",260),_("click",function(){h(e);let n=u(2);return f(n.createMultipleCredentials())}),t(1,"span"),o(2,"Crear Credenciales"),i()()}if(s&2){let e=u(2);d("disabled",e.actualSelectedRows===0)("nzLoading",e.isCreatingCredentials)}}function Ba(s,m){if(s&1){let e=x();t(0,"button",251),_("click",function(){h(e);let n=u(2);return f(n.done())}),t(1,"span"),o(2,"Terminar"),i()()}}function qa(s,m){if(s&1&&(t(0,"div",241),z(1,Ra,3,0,"button",256)(2,Oa,3,1,"button",257)(3,Aa,3,2,"button",258)(4,Ba,3,0,"button",256),i()),s&2){let e=u();r(),d("ngIf",e.current>0&&!e.isDone),r(),d("ngIf",e.current<2),r(),d("ngIf",e.current===2&&!e.isDone),r(),d("ngIf",e.current===3&&e.isDone)}}function $a(s,m){s&1&&o(0," Nueva credencial ")}function Wa(s,m){if(s&1){let e=x();t(0,"div",254)(1,"form",128),_("ngSubmit",function(){h(e);let n=u();return f(n.createCredential())}),t(2,"div",140)(3,"div",141)(4,"nz-form-item")(5,"nz-form-label"),o(6,"V\xE1lido desde"),i(),v(7,"nz-date-picker",151),i()(),t(8,"div",141)(9,"nz-form-item")(10,"nz-form-label"),o(11,"V\xE1lido hasta"),i(),v(12,"nz-date-picker",161),i()(),t(13,"div",141)(14,"nz-form-item")(15,"nz-form-control")(16,"label",150),o(17,"Activar credencial"),i()()()()()()()}if(s&2){let e=u();r(),d("formGroup",e.credentialForm)}}function ja(s,m){if(s&1){let e=x();t(0,"button",260),_("click",function(){h(e);let n=u();return f(n.createCredential())}),t(1,"span"),o(2,"Crear Credencial"),i()()}if(s&2){let e=u();d("disabled",e.credentialForm.invalid)("nzLoading",e.isCreatingCredentials)}}function Xa(s,m){s&1&&o(0," Editar Pase de Abordar ")}function Ga(s,m){if(s&1&&(ie(0),o(1),ne()),s&2){let e=u().$implicit;r(),C("(",e.frequencies,")")}}function Ha(s,m){if(s&1&&(t(0,"div")(1,"nz-option",63),v(2,"i",71),o(3),z(4,Ga,2,1,"ng-container",116),o(5),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.name)("nzValue",e.productId),r(2),C(" ",e.name," "),r(),d("ngIf",e.frequencies),r(),C(" $",e.price," ")}}function Qa(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.routeId),r(2),C(" ",e.name,"")}}function Ja(s,m){if(s&1&&(t(0,"nz-option",63),v(1,"i",71),o(2),v(3,"br"),o(4),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.stopPointId),r(2),C(" ",e.name," "),r(2),C(" ",e.description," ")}}function Ka(s,m){if(s&1){let e=x();t(0,"form",128),_("ngSubmit",function(){h(e);let n=u();return f(n.saveUpdateBoardingPass())}),t(1,"nz-form-item")(2,"nz-form-label"),o(3,"Servicio"),i(),t(4,"nz-select",261),z(5,Ha,6,5,"div",113),i()(),t(6,"nz-form-item")(7,"nz-form-label"),o(8,"Operaci\xF3n"),i(),t(9,"nz-select",130),_("ngModelChange",function(n){h(e);let l=u();return f(l.onRouteSelected(n,l.routes))}),z(10,Qa,3,3,"nz-option",44),i()(),t(11,"nz-form-item")(12,"nz-form-label"),o(13,"Estaciones"),i(),t(14,"nz-select",131),_("ngModelChange",function(n){h(e);let l=u();return f(l.onStopPointSelected(n,l.stopPoints))}),z(15,Ja,5,4,"nz-option",44),i()(),t(16,"nz-form-item")(17,"nz-form-label"),o(18,"Turno"),i(),t(19,"nz-select",132),v(20,"nz-option",133)(21,"nz-option",134)(22,"nz-option",135),i()(),t(23,"div",140)(24,"div",141)(25,"nz-form-item")(26,"nz-form-label"),o(27,"V\xE1lido desde"),i(),v(28,"nz-date-picker",151),i()(),t(29,"div",141)(30,"nz-form-item")(31,"nz-form-label"),o(32,"V\xE1lido hasta"),i(),v(33,"nz-date-picker",161),i()()()()}if(s&2){let e=u();d("formGroup",e.editPayment),r(4),d("nzDisabled",!0),r(),d("ngForOf",e.products),r(5),d("ngForOf",e.routes),r(5),d("ngForOf",e.stopPoints)}}function Ya(s,m){if(s&1){let e=x();t(0,"button",158),_("click",function(){h(e);let n=u();return f(n.handleCancel())}),o(1,"Cancelar"),i(),t(2,"button",158),_("click",function(){h(e);let n=u();return f(n.saveUpdateBoardingPass())}),o(3,"Guardar"),i()}}var fo=(()=>{class s{constructor(e,a,n,l,c,p,y){this.afs=e,this.modalService=a,this.fb=n,this.aff=l,this.bucketStorage=c,this.msg=p,this.cdr=y,this.authService=k(_e),this.userService=k(Xe),this.routesService=k(Ke),this.dashboardService=k(si),this.productsService=k(ot),this.customersService=k(je),this.size=40,this.rolService=k(Ge),this.hasBeenFiltered=!1,this.loadedDevicesList=[],this.reciboPago=[],this.newMessage="",this.loadingChatMessages=!1,this.current=0,this.isDone=!1,this.isCreatingBoardingPasses=!1,this.isCreatingCredentials=!1,this.isModalEditVisible=!1,this.isCollapsed=!0,this.dataTransfer=[],this.listOfSelection=[{text:"Seleccionar todas las p\xE1ginas",onSelect:()=>{this.checkAllData(!0)}},{text:"Deseleccionar todas las p\xE1ginas",onSelect:()=>{this.checkAllData(!1),this.refreshStatus()}}],this.listOfCredentialsSelection=[{text:"Seleccionar todas las p\xE1ginas",onSelect:()=>{this.checkCredentialsAllData(!0)}},{text:"Deseleccionar todas las p\xE1ginas",onSelect:()=>{this.checkCredentialsAllData(!1),this.refreshCredentialsStatus()}}],this.isAllDisplayDataChecked=!1,this.isIndeterminate=!1,this.listOfDisplayData=[],this.mapOfCheckedId={},this.isCredentialsAllDisplayDataChecked=!1,this.isCredentialsIndeterminate=!1,this.listOfCredentialsDisplayData=[],this.listOfCredentialsAllData=[],this.mapOfCredentialsCheckedId={},this.isContentOpen=!1,this.isUserSelected=!1,this.isLoadingUsers=!1,this.loadingLastPurchase=!1,this.isBoardingPassSelected=!1,this.isCredentialSelected=!1,this.isLoadingPayments=!1,this.hasBeenLoaded=!1,this.latestPurchases=[],this.loadingUserCredentials=!1,this.loadingLatestPurchases=!1,this.loadinglatestPurRequest=!1,this.loadinglatestTransfer=!1,this.isVisible=!1,this.isProductVisible=!1,this.isEditUserVisible=!1,this.isModalCredentialVisible=!1,this.isConfirmLoading=!1,this.productSelectedValue="",this.checked=!1,this.routes=[],this.userRoutes=[],this.products=[],this.stopPoints=[],this.stopPointsList=[],this.usersByAccount=[],this.productsReference=[],this.newCustomerIdEditMode="",this.resetClientEditInfo=!1,this.newRouteIdEditeMode="",this.newStepIdEditeMode="",this.accountId$=new te,this.routeId$=new te,this.canUpdatePayment=!1,this.canUpdateValidTo=!1,this.jobTypeIdCustomerSelected="",this.elementType="url",this.customersList=[],this.stopSubscription$=new te,this.isVisibleBulk=!1,this.isLoadingBulk=!1,this.isConfirmLoadingBulk=!1,this.isVisibleBulkCredentials=!1,this.isLoadingBulkCredentials=!1,this.isConfirmLoadingBulkCredentials=!1,this.isConfirmPagoLoading=!1,this.formatterPercent=S=>`${S} %`,this.parserPercent=S=>S.replace(" %",""),this.formatterDollar=S=>`$ ${S}`,this.parserDollar=S=>S.replace("$ ",""),this.selectedUsersForCredentials=[],this.ifValidPayment=!1,this.ifValidLiqPayment=!1,this.isValidDescriptionPaymentType=!1,this.paymentSelected="",this.isAnticipo=!1,this.fileListInfo=[],this.disabledDate=S=>!1,this.fileUrl="http://themenate.com/applicator/dist/assets/images/avatars/thumb-13.jpg",this.autosave=!0,this.uploading=!1,this.bucketPath="dashboard/",this.uploadvalue=0,this.infoLoad=[],this.purchaseActive=!1,this.isVisiblePurchasePay=!1,this.accountsService=k(He),this.infoSegment=[],this.requiredFields=!1,this.productSelected=[],this.switchValueUsers=!0,this.checkOptionsOne=[],this.selectedOption="",this.userCustomerId="",this.beforeUpload=S=>!1,this.authService.user.subscribe(S=>{S&&(this.user=S,this.userCustomerId=this.user.customerId,this.accountsService.getSegmentLevel(this.user.idSegment).pipe(T(V=>{if(V&&V.payload){let N=V.payload.id,P=V.payload.data?V.payload.data():{};return M({id:N},P)}else return this.sendMessage("error",V),{}})).subscribe(V=>{this.infoSegment=V,this.filldata()}))})}filldata(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.accountId$.pipe(J(y=>X(this,null,function*(){return this.afs.collection("customers").doc(y)}))).subscribe(y=>{this.customers=y}):this.accountId$.pipe(J(y=>this.afs.collection("customers",S=>S.where("active","==",!0)).valueChanges({idField:"uid"}))).subscribe(y=>{this.customers=y}),this.accountId$.pipe(J(p=>this.afs.collection("customers").doc(p).collection("routes",y=>y.where("active","==",!0)).valueChanges({idField:"routeId"}))).subscribe(p=>{this.routes=p});let a=this.accountId$.pipe(J(p=>this.afs.collection("customers").doc(p).collection("products",y=>y.where("active","==",!0)).valueChanges({idField:"productId"}))),n=this.accountId$.pipe(J(p=>this.afs.collection("customers").doc(p).collection("products",y=>y.where("active","==",!0)).valueChanges({idField:"productId"}))),l=this.accountId$.pipe(J(p=>this.afs.collection("users",y=>y.where("customerId","==",p).where("active","==",!0).orderBy("studentId")).valueChanges({idField:"uid"}))),c=this.routeId$.pipe(J(p=>this.afs.collection("customers").doc(this.currentSelectedCustomerId).collection("routes").doc(p).collection("stops",y=>y.orderBy("order","asc").where("active","==",!0)).valueChanges({idField:"stopPointId"})));n.subscribe(p=>{this.products=p}),c.subscribe(p=>{this.stopPoints=p}),l.subscribe(p=>{this.usersByAccount=p}),this.getCustomersList()}log(e){this.devicesList=[]}ngOnInit(){this.credentialForm=this.fb.group({active:[!0,[D.required]],validFrom:[new Date,[D.required]],validTo:[new Date,[D.required]]}),this.validateForm=this.fb.group({active:[!0,[D.required]],amount:[0,[D.required]],authorization:[""],category:["",[D.required]],conciliated:[!1,[D.required]],creation_date:[new Date().toISOString(),[D.required]],currency:["MXN",[D.required]],customer_id:["",[D.required]],customerId:[""],date_created:[new Date,[D.required]],due_date:[new Date,[D.required]],description:["",[D.required]],error_message:[""],fee:this.fb.group({amount:[0],currency:["MXN"],tax:[0]}),is_courtesy:[!1],method:["cash",[D.required]],name:["",[D.required]],operation_date:[new Date().toISOString(),[D.required]],operation_type:["in",[D.required]],order_id:[""],payment_method:this.fb.group({barcode_url:[""],reference:[""],type:["cash"]}),price:[0,[D.required]],product_description:["",[D.required]],product_id:["",[D.required]],round:["",[D.required]],routeId:["",[D.required]],routeName:["",[D.required]],status:["completed",[D.required]],stopDescription:["",[D.required]],stopId:["",[D.required]],stopName:["",[D.required]],transaction_type:["charge",[D.required]],validFrom:[new Date,[D.required]],validTo:[new Date,[D.required]],isTaskIn:[!1,[D.required]],isTaskOut:[!1,[D.required]],isOpenpay:[!1,[D.required]],paidApp:["web",[D.required]],realValidTo:[],payment:["",[D.required]],amountPayment:[0,[D.required]],typePayment:[""],promiseDate:[new Date],baja:[""],fileURL:[""],frequencies:[""]});let e=new Date;this.validateForm.controls.promiseDate.setValue(e),this.validateForm.controls.validTo.setValue(""),this.validateForm.controls.validFrom.setValue(e),this.validateEditForm=this.fb.group({firstName:[""],lastName:[""],displayName:[""],username:["",[D.required]],studenId:["",[D.required]],email:["",[D.required]],customerName:["",[D.required]],defaultRoute:["",[D.required]],defaultRouteName:[""],defaultRound:[""],routeId:["",[D.required]],customerId:[""],phoneNumber:[""],defaultStopId:[""],defaultStopName:[""]}),this.editPayment=this.fb.group({id:[""],active:[!0],amount:[0],authorization:[""],category:[""],conciliated:[!1],creation_date:[new Date().toISOString()],currency:["MXN"],customer_id:[""],customerId:[""],date_created:[new Date],due_date:[new Date],description:[""],error_message:[""],fee:this.fb.group({amount:[0],currency:["MXN"],tax:[0]}),is_courtesy:[!1],method:["cash"],name:[""],operation_date:[new Date().toISOString()],operation_type:["in"],order_id:[""],payment_method:this.fb.group({barcode_url:[""],reference:[""],type:["cash"]}),price:[0],product_description:[""],product_id:[""],round:[""],routeId:[""],routeName:[""],status:["completed"],stopDescription:[""],stopId:[""],stopName:[""],transaction_type:["charge"],validFrom:[new Date],validTo:[new Date],isTaskIn:[!1],isTaskOut:[!1],isOpenpay:[!1],paidApp:["web"],realValidTo:[],payment:[""],amountPayment:[0],typePayment:[""],promiseDate:[new Date],baja:[""],fileURL:[""],frequencies:[""]}),this.validateLiqForm=this.fb.group({customerId:[""],amount:new qe({value:"",disabled:!0}),productSelected:[""],alreadyPayment:new qe({value:"",disabled:!0}),completeAmount:new qe({value:"",disabled:!0}),validFrom:[""],validTo:[""],typePayment:[""],fileURL:[""]})}sendMessage(e,a){this.msg.create(e,a)}ngOnDestroy(){this.hasBeenLoaded=!1,this.loadedDevicesList=[],this.users&&this.users.unsubscribe(),this.routesSubscription&&this.routesSubscription.unsubscribe(),this.productsSubscription&&this.productsSubscription.unsubscribe(),this.stopSubscription$.next(void 0),this.stopSubscription$.complete(),this.customerSuscription&&this.customerSuscription.unsubscribe(),this.usersSubscription&&this.usersSubscription.unsubscribe(),this.userChatMessagesSubscription&&this.userChatMessagesSubscription.unsubscribe()}showModalCredential(){this.isModalCredentialVisible=!0}onBulkCredentialsSelected(e){this.accountId$.next(e),this.currentSelectedCustomerId=e,this.isVisibleBulkCredentials=!0}createCredential(){if(this.credentialForm.valid){let e=this.credentialForm.controls.validFrom.value||new Date,a=this.credentialForm.controls.validTo.value||new Date,n=this.credentialForm.controls.active.value||!1;this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.isCreatingCredentials=!0,this.customersService.createCredential(this.currentUserSelected.uid,this.currentUserSelected.studentId,e,a,n).then(l=>{this.isModalCredentialVisible=!1}),this.isCreatingCredentials=!1,this.isDone=!0):this.sendMessage("error","currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}}activateCredential(e,a){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.activateCredential(this.currentUserSelected.uid,e,a),this.currentUserSelected.paymentId=e):this.sendMessage("error","currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}deleteCredential(e){this.userlevelAccess=="1"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.deleteCredential(this.currentUserSelected.uid,e),this.isBoardingPassSelected=!1):this.sendMessage("error","currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}getUserCredentials(e){this.loadingUserCredentials=!0,this.customersService.getUserCredentials(e).pipe(K(a=>{this.userCredentials=a}),Dt(a=>(this.sendMessage("error",a),this.userCredentials=null,St(null))),re(()=>{this.loadingUserCredentials=!1})).subscribe()}currentCredentialsPageDataChange(e){this.listOfCredentialsDisplayData=e,this.refreshCredentialsStatus()}refreshCredentialsStatus(){let e=this.usersByAccount.length>0&&this.usersByAccount.every(n=>this.mapOfCredentialsCheckedId[n.uid]),a=this.usersByAccount.some(n=>this.mapOfCredentialsCheckedId[n.uid]);this.isCredentialsAllDisplayDataChecked=e,this.isCredentialsIndeterminate=a&&!e}checkCredentialsAllData(e){this.usersByAccount.forEach(a=>this.mapOfCredentialsCheckedId[a.uid]=e)}checkCredentialsValidBoardingPass(e){let a=this.usersByAccount.map(n=>this.customersService.getLatestValidUserPurchases(n.uid).pipe(mt(1),T(l=>l.map(c=>{let p=c.payload.doc.id,y=c.payload.doc.data();return M({id:p},y)})),K(l=>{this.mapOfCredentialsCheckedId[n.uid]=l.length>0})));yt(a).subscribe()}createMultipleCredentials(){this.current++;let e=this.credentialForm.controls.validFrom.value||new Date,a=this.credentialForm.controls.validTo.value||new Date,n=this.credentialForm.controls.active.value||!1;this.userlevelAccess!="3"?(this.isCreatingCredentials=!0,this.selectedUsersForCredentials.forEach(l=>{this.customersService.createCredential(l.uid,l.studentId,e,a,n).then(c=>{})}),this.isCreatingCredentials=!1,this.isDone=!0):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}showModalProduct(){this.isProductVisible=!0}onProductSelected(e,a){this.productSelected=[];let l=ae.filter(a,c=>c.productId==e)[0];this.productSelected=l,this.validateForm.controls.name.setValue(l.name),this.validateForm.controls.description.setValue(l.description),this.validateForm.controls.product_description.setValue(l.description),this.validateForm.controls.amount.setValue(l.price),this.validateForm.controls.is_courtesy.setValue(!1),this.validateForm.controls.price.setValue(l.price),this.validateForm.controls.category.setValue(l.category),this.validateForm.controls.validFrom.setValue(l.validFrom.toDate()),this.validateForm.controls.validTo.setValue(l.validTo.toDate()),this.validateForm.controls.realValidTo.setValue(l.validTo.toDate().toISOString()),this.validateForm.controls.isTaskIn.setValue(l.isTaskIn),this.validateForm.controls.isTaskOut.setValue(l.isTaskOut),this.validateForm.controls.frequencies.setValue(l.frequencies)}searchloadUsers(){this.getUsersList()}getUsersList(){if(!this.selectedOption){console.error("Error: selectedOption es null o undefined");return}this.isLoadingUsers=!0,this.afs.collection("users",e=>e.where("customerId","==",this.selectedOption)).get().subscribe({next:e=>{let a=[];e.forEach(n=>{a.push(n.data())}),this.loadUsers(a),this.isCollapsed=!1,this.isLoadingUsers=!1},error:e=>{console.error("Error al obtener usuarios:",e),this.isLoadingUsers=!1}})}setUserDisabled(e){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.setUserDisabled(this.currentUserSelected.uid,e),this.currentUserSelected.disabled=e):this.sendMessage("error","currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}loadUsers(e){let a=new Map,n=[];for(let l of e)l.displayName!==null&&l.displayName!==void 0&&!a.has(l.displayName)&&(a.set(l.displayName,!0),n.push(l));n.sort((l,c)=>l.displayName.localeCompare(c.displayName)),this.devicesList=n,this.loadedDevicesList=n,this.displayData=n}userSelected(e){this.currentUserSelected=e,this.currentSelectedCustomerId=this.currentUserSelected.customerId,this.accountId$.next(this.currentUserSelected.customerId),this.isUserSelected=!0,this.isBoardingPassSelected=!1,this.requiredFields=!1,this.getJobType(e.customerId),this.getLatestPurchases(e.uid),this.getLastestPurchaseRequest(e.uid),this.getUserCredentials(e.uid),this.getUserChatMessages(e.uid),this.lastPurchase=void 0,this.productsReference=null}copyDataToUserCollection(){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?this.customersService.saveOldBoardingPassToUserCollection(this.currentUserSelected.paymentId):this.sendMessage("error","currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}getUserChatMessages(e){this.loadingChatMessages=!0,this.userChatMessagesSubscription&&this.userChatMessagesSubscription.unsubscribe(),this.userChatMessagesSubscription=this.dashboardService.getUserChatMessages(e,10).subscribe(a=>{this.userChatMessageData=a,this.loadingChatMessages=!1})}getJobType(e){this.dashboardService.getJobType(e).pipe(U(this.stopSubscription$),T(a=>a.jobTypeID)).subscribe({next:a=>{a!==void 0&&a.length>0&&this.dashboardService.getJobTypeInfo(a).pipe(U(this.stopSubscription$),T(n=>n.requiredFields)).subscribe({next:n=>{this.requiredFields=n},error:n=>{this.sendMessage("error",n)}})},error:a=>{this.sendMessage("error",a)}})}onBulkBoardingPassSelected(e){this.accountId$.next(e),this.currentSelectedCustomerId=e,this.isVisibleBulk=!0}onCourtesyChange(e){e&&this.validateForm.controls.amount.setValue(0)}onAmountChange(e){e>0&&this.validateForm.controls.is_courtesy.setValue(!1)}onCanUpdatePayment(){if(this.canUpdatePayment=!0,this.lastPurchase!==void 0){var e=Number(this.lastPurchase.amountPayment),a=Number(this.lastPurchase.amount);this.validateLiqForm.controls.productSelected.setValue(this.lastPurchase.name),this.validateLiqForm.controls.alreadyPayment.setValue(e),this.validateLiqForm.controls.amount.setValue(a),this.validateLiqForm.controls.completeAmount.setValue(a-e),this.validateLiqForm.controls.validFrom.setValue(this.lastPurchase.validFrom.toDate()),this.productSelectedValue=this.lastPurchase.name}else this.sendMessage("error","lastPurchase is undefined")}createLiquidacion(){let e=this.validateLiqForm.controls.validTo.value||new Date,a=this.validateLiqForm.controls.typePayment.value;if(this.lastPurchase!==void 0){let c=this.lastPurchase?String(this.lastPurchase.id):void 0;if(e=="")this.msg.error("Se requiere  seleccionar una fecha de terminaci\xF3n de pase.");else if(a=="")this.msg.error("Se requiere  seleccionar un tipo de referencia.");else if(this.currentUserSelected&&this.currentUserSelected.uid){var n,l=this.validateLiqForm.controls.fileURL.value||"";let p=this.productSelected?.amountTrips||0,y=this.productSelected?.frequencies||0,S=this.productSelected?.weeks||0,V=this.productSelected?.rangeWeeks||{},N={authorization:"portalAuth",operation_type:"in",method:this.validateLiqForm.controls.payment.value,transaction_type:"charge",card:{type:"",brand:"",address:"",card_number:"",holder_name:"",expiration_year:"",expiration_month:"",allows_charges:"",allows_payouts:"",bank_name:"",bank_code:"",points_card:"",points_type:""},status:"completed",conciliated:!1,creation_date:new Date().toISOString(),operation_date:new Date().toISOString(),description:"Liquidaci\xF3n a traves del portal",error_message:"",order_id:"portalOrder",currency:"MXN",amount:this.validateLiqForm.controls.amountPayment.value,customer:{name:this.currentUserSelected.firstName,last_name:this.currentUserSelected.lastName,email:this.currentUserSelected.email,phone_number:this.currentUserSelected.phoneNumber,address:"",creation_date:"",external_id:"",clabe:""},product:{product_id:this.validateLiqForm.controls.product_id.value,amountTrips:p,frequencies:y,rangeWeeks:V,weeks:S,name:this.productSelected.name},customerId:this.currentUserSelected.customerId,active:!0,category:"permanente",date_created:new Date().toISOString(),product_description:"Liquidaci\xF3n a traves del portal",product_id:this.validateLiqForm.controls.product_id.value,name:this.validateLiqForm.controls.name.value,isTaskIn:"false",isTaskOut:"false",type:"Servicio",isOpenpay:!1,paidApp:"portal",price:this.lastPurchase.price,round:this.validateLiqForm.controls.round.value,routeId:this.validateLiqForm.controls.routeId.value,routeName:this.validateLiqForm.controls.routeName.value,stopDescription:"",stopId:this.validateLiqForm.controls.stopId.value,stopName:this.validateLiqForm.controls.stopDescription.value,validFrom:this.validateLiqForm.controls.validFrom.value,validTo:e,idBoardingPass:this.currentUserSelected.uid,idPurchasteRequest:"",is_courtesy:!1,typePayment:a};n={active:!0,amountPayment:this.validateLiqForm.controls.completeAmount.value,payment:"Liquidacion",status:this.validateForm.controls.status.value,customer_id:this.currentUserSelected.customerId,creation_date:this.validateForm.controls.creation_date.value,name:this.lastPurchase.name,price:this.lastPurchase.price,operation_date:this.validateForm.controls.operation_date.value,routeId:this.lastPurchase.routeId,routeName:this.lastPurchase.routeName,round:this.lastPurchase.round,stopName:this.validateForm.controls.stopDescription.value,stopId:this.validateForm.controls.stopId.value,typePayment:a,validFrom:this.validateForm.controls.validFrom.value,idBoardingPass:this.currentUserSelected.uid,idPurchasteRequest:"",baja:!1,validTo:e,type:"Servicio",fileURL:l},this.userlevelAccess!="3"?c!==void 0?this.customersService.saveBoardingPassDetailToUserPurchaseCollection(this.currentUserSelected.uid,c,N).then(P=>{if(this.msg.success("El registro se genero correctamente"),this.lastPurchase&&this.lastPurchase.realValidTo!==void 0){let W=new Date(this.lastPurchase.realValidTo);this.lastPurchase.validTo=zt.fromDate(W),this.lastPurchase.status="completed",this.lastPurchase.active=!0,this.lastPurchase.typePayment=this.validateLiqForm.controls.typePayment.value,this.lastPurchase.status="completed",this.lastPurchase.price=this.validateLiqForm.controls.amount.value,this.lastPurchase.amountPayment=this.validateLiqForm.controls.amount.value,this.lastPurchase.payment="Liquidacion";let $=this.currentUserSelected.status;$=="preRegister"&&this.userService.updateUserPreRegister(this.currentUserSelected.uid,$),this.customersService.createPurchaseCloud(N,this.currentUserSelected,c),this.customersService.updateBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.lastPurchase).then(G=>{this.msg.success("Se actualizo el pase"),this.canUpdatePayment=!1}).catch(G=>{this.isConfirmLoading=!1})}}).catch(P=>{this.sendMessage("error",P)}):this.sendMessage("error","lastPurchase is undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}else this.sendMessage("error","currentUserSelected or uid is null or undefined")}else this.sendMessage("error","lastPurchase is undefined")}onPaymentUpdated(e){if(this.lastPurchase!==void 0){if(+this.lastPurchase.price===e){if(this.lastPurchase.status="completed",this.lastPurchase.amount=e,this.lastPurchase.active=!0,this.lastPurchase?.realValidTo!==void 0){let a=new Date(this.lastPurchase.realValidTo);this.lastPurchase.validTo=zt.fromDate(a)}}else this.lastPurchase.amount=e;this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.updateBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.lastPurchase).then(a=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(a=>{this.isConfirmLoading=!1}),this.canUpdatePayment=!1):this.sendMessage("error","currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}}getLastPurchase(e){this.loadingLastPurchase=!0,this.lastPurchase=void 0,this.customersService.getLastPurchase(e).valueChanges().subscribe(a=>{this.lastPurchase=a,this.productsReference=a,this.loadingLastPurchase=!1},a=>{this.loadingLastPurchase=!1,this.lastPurchase=void 0,this.productsReference=null})}activatePurchase(e,a){this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.activatePurchase(this.currentUserSelected.uid,e,a),this.currentUserSelected.paymentId=e):this.sendMessage("error","currentUserSelected or uid is null or undefined")}deletePurchase(e){this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.deletePurchase(this.currentUserSelected.uid,e),this.isBoardingPassSelected=!1,this.userService.updateUserPreRegister(this.currentUserSelected.uid,this.currentUserSelected.status)):this.sendMessage("error","currentUserSelected or uid is null or undefined")}getLatestPurchases(e){this.loadingLatestPurchases=!0,this.customersService.getLatestUserPurchases(e,10).pipe(T(a=>a.map(n=>{let l=n.payload.doc.id,c=n.payload.doc.data();return M({id:l},c)}))).subscribe({next:a=>{this.latestPurchases=a,this.loadingLatestPurchases=!1},error:a=>{this.latestPurchases=[],this.loadingLatestPurchases=!1}})}getLastestPurchaseRequest(e){this.loadinglatestPurRequest=!0,this.customersService.getLatestUserPurchasesRequest(e,10).pipe(T(a=>a.map(n=>{let l=n.payload.doc.id,c=n.payload.doc.data();return M({id:l},c)}))).subscribe({next:a=>{this.latestPurRequest=a,this.loadinglatestPurRequest=!1},error:a=>{this.latestPurRequest=null,this.loadinglatestPurRequest=!1}})}getLatestPurchaseDetail(e,a){this.customersService.getLatestUserPurchaseDetail(e,10,a).pipe(T(n=>n.map(l=>{let c=l.payload.doc.id,p=l.payload.doc.data();return M({id:c},p)}))).subscribe({next:n=>{this.lastestPurchaseDetail=n},error:n=>{this.lastestPurchaseDetail=null}})}reassingBoardingPass(e,a){if(this.userlevelAccess!="3")if(this.currentUserSelected&&this.currentUserSelected.uid){if(this.lastPurchase!==void 0){let n=this.lastPurchase.id,l=this.currentUserSelected.uid;this.afs.collection("users").doc(this.currentUserSelected.id).collection("boardingPasses").doc(this.lastPurchase.id).set(this.lastPurchase).then(p=>{this.afs.collection("users").doc(l).collection("boardingPasses").doc(n).delete()})}}else this.sendMessage("error","currentUserSelected or uid is null or undefined");else this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}bajaBoardingPass(e,a){if(this.currentUserSelected&&this.currentUserSelected.uid){let n=this.afs.collection("users").doc(this.currentUserSelected.id).collection("boardingPasses").doc(e),l={baja:!0};n.update(l).then(c=>{}).catch(c=>{this.sendMessage("error: ",c)})}else this.sendMessage("error","currentUserSelected or uid is null or undefined")}boardingPassSelected(e){this.currentUserSelected&&(this.isBoardingPassSelected=!0,this.lastPurchase=e,this.productsReference=e)}createMultipleBoardingPasses(){this.isCreatingBoardingPasses=!0,setTimeout(()=>{this.isCreatingBoardingPasses=!1,this.isDone=!0},2e3)}showModal(){this.isVisible=!0}showModalEditUser(e){this.isEditUserVisible=!0,this.validateEditForm.controls.firstName.setValue(e.firstName),this.validateEditForm.controls.lastName.setValue(e.lastName),this.validateEditForm.controls.displayName.setValue(e.displayName),this.validateEditForm.controls.username.setValue(e.username),this.validateEditForm.controls.studenId.setValue(e.studentId),this.validateEditForm.controls.email.setValue(e.email),this.validateEditForm.controls.customerId.setValue(e.customerId),this.validateEditForm.controls.customerName.setValue(e.customerName),this.validateEditForm.controls.phoneNumber.setValue(e.phoneNumber),this.validateEditForm.controls.defaultRound.setValue(e.defaultRound),this.fillCustomerRouteEditUser(e.customerId),this.fillStopsEditUser(e.customerId,e.defaultRoute),this.validateEditForm.controls.routeId.setValue(e.defaultRoute),this.validateEditForm.controls.defaultRoute.setValue(e.defaultRoute),this.validateEditForm.controls.defaultRouteName.setValue(e.defaultRouteName),this.validateEditForm.controls.defaultStopId.setValue(e.defaultStopId),this.validateEditForm.controls.defaultStopName.setValue(e.defaultStopName)}fillCustomerRouteEditUser(e){this.routesService.getRoutes(e).pipe(U(this.stopSubscription$),T(a=>a.map(n=>{let l=n.payload.doc.id,c=n.payload.doc.data();return M({id:l},c)}))).subscribe(a=>{this.userRoutes=a})}fillStopsEditUser(e,a){this.routesService.getRouteStopPoints(e,a).pipe(U(this.stopSubscription$),T(n=>n.map(l=>{let c=l.payload.doc.id,p=l.payload.doc.data();return Me(M({},p),{id:c})}))).subscribe(n=>{this.stopPointsList=n})}showModalMessageCenter(){return X(this,null,function*(){if(this.currentUserSelected&&this.currentUserSelected.uid){let e={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"Apps And Informa",msg:this.newMessage,requestId:"suhB7YFAh6PYXCRuJhfD",token:this.currentUserSelected.token,uid:this.currentUserSelected.uid,result:""},a={timestamp:new Date,title:"Apps And Informa General",from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",requestId:"suhB7YFAh6PYXCRuJhfD",body:this.newMessage,token:this.currentUserSelected.token,uid:this.currentUserSelected.uid};this.dashboardService.setMessage(a,this.currentUserSelected.uid),this.dashboardService.setChatMessage(e).then(()=>{this.newMessage=""})}else this.sendMessage("error","currentUserSelected or uid is null or undefined")})}onRouteEditUserSelected(e,a){if(e!=null&&e!=""){let l=ae.filter(a,c=>c.routeId==e)[0];if(this.currentUserSelected&&this.currentUserSelected.uid){this.validateEditForm.controls.defaultRouteName.setValue(l.name);let c=this.currentUserSelected.customerId,p=this.currentUserSelected.defaultRoute;c!=this.newCustomerIdEditMode&&p!=l.routeId?(this.newRouteIdEditeMode=l.routeId,this.fillStopsEditUser(this.newCustomerIdEditMode,l.routeId)):this.newRouteIdEditeMode=p}else this.sendMessage("error","currentUserSelected or uid is null or undefined")}}onRouteSelected(e,a){this.routeId$.next(e);let l=ae.filter(a,p=>p.routeId==e)[0];this.validateForm.controls.routeName.setValue(l.name);let c=a.find(p=>p.routeId===e);c&&this.isModalEditVisible&&this.editPayment.controls.routeName.setValue(c.name,{emitEvent:!1})}onStopPointEditUserSelected(e,a){if(e!=null&&e!=""){let l=ae.filter(a,c=>c.id==e)[0];this.validateEditForm.controls.defaultStopName.setValue(l.name),this.newCustomerIdEditMode!=""&&(this.resetClientEditInfo=!0)}}onStopPointSelected(e,a){let l=ae.filter(a,c=>c.stopPointId==e)[0];this.validateForm.controls.stopName.setValue(l.name),this.validateForm.controls.stopDescription.setValue(l.description),this.isModalEditVisible&&this.editPayment.controls.stopDescription.setValue(l.description)}onCustomerSelected(e,a){if(this.resetClientEditInfo=!1,e!=null){let l=ae.filter(a,c=>c.uid==e)[0];this.currentUserSelected&&this.currentUserSelected.uid?(this.validateEditForm.controls.customerName.setValue(l.name),this.currentUserSelected.customerId!=l.uid?(this.newCustomerIdEditMode=l.uid,this.fillCustomerRouteEditUser(l.uid)):this.newCustomerIdEditMode=""):this.sendMessage("error","currentUserSelected or uid is null or undefined")}}onCanUpdateValidTo(){setTimeout(()=>{this.canUpdateValidTo=!0},0),this.cdr.detectChanges()}editPurchase(e){let a=c=>c?c instanceof Date?c:typeof c.toDate=="function"?c.toDate():typeof c.seconds=="number"?new Date(c.seconds*1e3+(c.nanoseconds||0)/1e6):null:null,n=a(e.validTo),l=a(e.validFrom);this.isModalEditVisible=!0,this.editPayment.patchValue({id:e.id,active:e.active,amount:e.amount,authorization:e.authorization,category:e.category,conciliated:e.conciliated,creation_date:e.creation_date,currency:e.currency,customer_id:e.customer_id,customerId:e.customerId,date_created:e.date_created,due_date:e.due_date,description:e.description,error_message:e.error_message,fee:{amount:e.fee?.amount,currency:e.fee?.currency,tax:e.fee?.tax},is_courtesy:e.is_courtesy,method:e.method,name:e.name,operation_date:e.operation_date,operation_type:e.operation_type,order_id:e.order_id,payment_method:{barcode_url:e.payment_method?.barcode_url,reference:e.payment_method?.reference,type:e.payment_method?.type},price:e.price,product_description:e.product_description,product_id:e.product_id,round:e.round,routeId:e.routeId,routeName:e.routeName,status:e.status,stopDescription:e.stopDescription,stopId:e.stopId,stopName:e.stopName,transaction_type:e.transaction_type,validFrom:l,validTo:n,isTaskIn:e.isTaskIn,isTaskOut:e.isTaskOut,isOpenpay:e.isOpenpay,paidApp:e.paidApp,realValidTo:e.realValidTo,payment:e.typePayment,amountPayment:e.amount,typePayment:e.typePayment,promiseDate:e.promiseDate,baja:e.baja,fileURL:e.fileURL,frequencies:e.frequencies})}saveUpdateBoardingPass(){let e=this.editPayment.controls.routeId.value,a=this.editPayment.controls.id.value,n=this.editPayment.controls.stopId.value,l=this.editPayment.controls.stopName.value,c=this.editPayment.controls.stopDescription.value,p=this.editPayment.controls.round.value,y=this.editPayment.controls.routeName.value,S=this.editPayment.controls.validFrom.value,V=this.editPayment.controls.validTo.value;if(a&&this.customersService.updatePurchase(this.currentUserSelected.uid,a,e,y,n,l,c,p,S,V),this.latestPurchases){let N=this.latestPurchases.findIndex(P=>P.id===a);if(N!==-1){let P=this.latestPurchases[N];(P.routeId!==e||P.stopDescription!==c||P.stopId!==n||P.round!==p||P.validFrom!==S||P.validTo!==V)&&(this.latestPurchases[N]=Me(M({},P),{routeId:e,stopId:n,round:p,stopDescription:c,validFrom:S,validTo:V}))}}this.isModalEditVisible=!1}handleOk(){this.isConfirmLoading=!0,setTimeout(()=>{this.isVisible=!1,this.isConfirmLoading=!1},3e3)}handleCancel(){this.isVisible=!1,this.isVisibleBulk=!1,this.isVisibleBulkCredentials=!1,this.isModalCredentialVisible=!1,this.isEditUserVisible=!1,this.isVisiblePurchasePay=!1,this.canUpdatePayment=!1,this.isModalEditVisible=!1}handleCancelProduct(){this.isProductVisible=!1}refreshList(){this.hasBeenLoaded=!1,this.getUsersList()}getItems(e){let a=e;if(!a){this.devicesList=this.loadedDevicesList.slice();return}let n=a.toLowerCase();this.devicesList=this.loadedDevicesList.filter(l=>Object.values(l).some(c=>String(c).toLowerCase().includes(n)))}getItemsByEmail(e){this.isLoadingUsers=!0,this.afs.collection("users",a=>a.where("email","==",e)).snapshotChanges().pipe(T(a=>a.map(n=>{let l=n.payload.doc.id,c=n.payload.doc.data();return M({id:l},c)}))).subscribe(a=>{this.loadUsers(a),this.isCollapsed=!1})}initializeItems(){this.devicesList=this.loadedDevicesList}showDeleteConfirm(){if(this.currentUserSelected&&this.currentUserSelected.uid){let e=this.currentUserSelected.uid;this.modalService.confirm({nzTitle:"\xBFEst\xE1 seguro de eliminar esta cuenta?",nzContent:'<b style="color: red;">Toda la informaci\xF3n relacionada a esta cuenta ser\xE1 eliminada permanentemente.</b>',nzOkText:"Eliminar",nzOnOk:()=>{this.customersService.deleteUser(e),this.currentUserSelected={uid:"",studentId:"",emailVerified:"",paymentId:"",turno:"",roundTrip:"",disabled:null,customerId:"",firstName:"",lastName:"",email:"",photoURL:"",phoneNumber:"",status:"",id:"",token:"",defaultRoute:"",displayName:"",username:"",customerName:"",defaultRound:"",defaultRouteName:"",defaultStopName:"",defaultStopId:"",curp:"",age:"",group:"",adress:""},this.isUserSelected=!1},nzCancelText:"No"})}else this.sendMessage("error","currentUserSelected or uid is null or undefined")}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.afs.collection("customers").doc(this.userCustomerId).snapshotChanges().pipe(U(this.stopSubscription$),T(a=>{let n=a.payload.id,l=a.payload.data();return M({id:n},l)}),K(a=>(this.customersList=[a],this.checkOptionsOne=[{value:a.id,label:a.name}],a))).subscribe():this.afs.collection("customers",a=>a.orderBy("name")).snapshotChanges().pipe(U(this.stopSubscription$),T(a=>a.map(n=>{let l=n.payload.doc.id,c=n.payload.doc.data();return M({id:l},c)})),K(a=>(this.customersList=a,this.checkOptionsOne=a.map(n=>({value:n.id,label:n.name})),a))).subscribe()}currentPageDataChange(e){this.listOfDisplayData=e,this.refreshStatus()}refreshStatus(){this.isAllDisplayDataChecked=this.devicesList.every(e=>this.mapOfCheckedId[e.id]),this.isIndeterminate=this.devicesList.some(e=>this.mapOfCheckedId[e.id])&&!this.devicesList}checkAllData(e){this.devicesList.forEach(a=>this.mapOfCheckedId[a.id]=e)}submitForm(){if(this.validateSubmit()){var a,n,l=0;if(this.currentUserSelected&&this.currentUserSelected.uid){let S=this.currentUserSelected.uid;this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId),this.validateForm.controls.customerId.setValue(this.currentUserSelected.customerId);let V=this.validateForm.controls.amount.value,N=this.validateForm.controls.payment.value;N=="Anticipo"&&(V=this.validateForm.controls.amountPayment.value);let P=this.validateForm.controls.frequencies.value||0;P>0&&(l=Number(P)*80);let W=this.productSelected?.weeks||0,$=this.fb.group({}),G=this.productSelected?.rangeWeeks||{};for(let[j,ke]of Object.entries(G))$.addControl(j,this.fb.control(ke));let H=this.validateForm.controls.price.value,B=this.validateForm.controls.validTo.value||new Date,Ne=this.validateForm.controls.is_courtesy.value||!1;this.validateForm.controls.due_date.setValue(B.toISOString()),V!=H&&!Ne&&this.validateForm.controls.status.setValue("partial");var c=this.validateForm.controls.promiseDate.value||"",p=this.validateForm.controls.creation_date.value.toString();let Re=this.validateForm.controls.typePayment.value;N=="Mensualidad"&&(c=this.validateForm.controls.validTo.value||new Date);for(let j in this.validateForm.controls)this.validateForm.controls[j].markAsDirty(),this.validateForm.controls[j].updateValueAndValidity();if(this.validateForm.valid){this.isConfirmLoading=!0;var y=this.validateForm.controls.fileURL.value||"";let j={authorization:"portalAuth",operation_type:"in",method:this.validateForm.controls.payment.value,transaction_type:"charge",card:{type:"",brand:"",address:"",card_number:"",holder_name:"",expiration_year:"",expiration_month:"",allows_charges:"",allows_payouts:"",bank_name:"",bank_code:"",points_card:"",points_type:""},status:this.validateForm.controls.status.value,conciliated:!1,creation_date:p,operation_date:new Date().toISOString(),description:"Pago a traves de portal",error_message:"",order_id:"portalOrder",currency:"MXN",amount:this.validateForm.controls.amountPayment.value,customer:{name:this.currentUserSelected.firstName,last_name:this.currentUserSelected.lastName,email:this.currentUserSelected.email,phone_number:this.currentUserSelected.phoneNumber,address:"",creation_date:"",external_id:"",clabe:""},product:{product_id:this.validateForm.controls.product_id.value,amountTrips:l,frequencies:P,rangeWeeks:$.value,weeks:W,name:this.productSelected.name},customerId:this.currentUserSelected.customerId,active:!0,category:"permanente",date_created:new Date().toISOString(),product_description:"Pago a traves de portal",product_id:this.validateForm.controls.product_id.value,name:this.validateForm.controls.name.value,isTaskIn:"false",isTaskOut:"false",type:"Servicio",isOpenpay:!1,paidApp:"portal",price:H,round:this.validateForm.controls.round.value,routeId:this.validateForm.controls.routeId.value,routeName:this.validateForm.controls.routeName.value,stopDescription:"",stopId:this.validateForm.controls.stopId.value,stopName:this.validateForm.controls.stopDescription.value,validFrom:this.validateForm.controls.validFrom.value,validTo:B,idBoardingPass:this.currentUserSelected.uid,idPurchasteRequest:"",is_courtesy:!1,typePayment:N,amountTrips:l,currentTrips:0};this.userlevelAccess!="3"?(a={active:!0,amountPayment:V,payment:N,status:this.validateForm.controls.status.value,customer_id:this.currentUserSelected.customerId,customerId:this.currentUserSelected.customerId,creation_date:p,name:this.validateForm.controls.name.value,price:H,operation_date:this.validateForm.controls.operation_date.value,routeId:this.validateForm.controls.routeId.value,routeName:this.validateForm.controls.routeName.value,round:this.validateForm.controls.round.value,stopName:this.validateForm.controls.stopDescription.value,stopId:this.validateForm.controls.stopId.value,typePayment:Re,validFrom:this.validateForm.controls.validFrom.value,validTo:B,idBoardingPass:this.currentUserSelected.uid,idPurchaseRequest:"",baja:!1,type:"Servicio",fileURL:y},this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,j).then(ke=>{this.isVisible=!1,this.isConfirmLoading=!1,this.customersService.getLatestValidUserPurchasesAdvance(S,2,c,N,p).pipe(mt(1),T(Q=>Q.map(ee=>{let dt=ee.payload.doc.data(),ct=ee.payload.doc.id;return M({id:ct},dt)}))).subscribe({next:Q=>{this.customersService.saveBoardingPassDetailToUserPurchaseCollection(S,Q[0].id,j).then(ee=>{this.sendUser=j,this.idBoardingPass=Q[0].id,this.purchaseActive=!0,this.customersService.createPurchaseCloud(this.sendUser,this.currentUserSelected,this.idBoardingPass)}).catch(ee=>{this.sendMessage("error",ee)})},error:Q=>{this.sendMessage("error",Q)}})}).catch(ke=>{this.isConfirmLoading=!1})):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}}else this.sendMessage("error","currentUserSelected or uid is null or undefined")}}submitReceipt(){}createPurchaseRequest(e,a){return X(this,null,function*(){let n=this.afs.createId(),l=this.afs.collection("users").doc(e).collection("purchaseRequests").doc(n).set(a).then(()=>(this.sendMessage("error","Recibo de compra correctamente generado!"),n)).catch(c=>(this.sendMessage("error",c),""))})}validateSubmit(){if(this.validateForm.controls.product_id.value=="")return this.msg.error("Es necesario seleccionar un producto, favor de validar."),!1;if(this.validateForm.controls.round.value=="")return this.msg.error("Es necesario seleccionar un turno, favor de validar."),!1;let n=this.validateForm.controls.payment.value;if(n=="")return this.msg.error("Es necesario seleccionar un Tipo de Pago, favor de validar."),!1;let l=this.validateForm.controls.promiseDate.value,c=this.validateForm.controls.validTo.value,p=this.validateForm.controls.validFrom.value;if(n=="Anticipo"&&l=="")return this.msg.error("Al seleccionar anticipo es necesario proporcionar una fecha compromiso, favor de validar."),!1;let y=this.validateForm.controls.amountPayment.value,S=this.validateForm.controls.amount.value;if(y=="0")return this.msg.error("Es necesario porporcionar una cantidad a pagar, favor de validar."),!1;if(S<y)return this.msg.error("La cantidad a pagar es mayor al total a pagar, favor de validar."),!1;if(n=="Mensualidad"&&S!=y)return this.msg.error("La cantidad a pagar debe ser igual al total a pagar ya se que selecciono el tipo de pago Mensualidad, favor de validar."),!1;let V=this.validateForm.controls.typePayment.value;return V==""?(this.msg.error("Es necesario seleccionar un tipo de Referencia, favor de validar."),!1):V=="Sistema"&&n=="Anticipo"?(this.msg.error("No puedes seleccionar el tipo de referencia Sistema,si estas generando un anticipo, favor de validar."),!1):V=="Transferencia"&&this.fileListInfo.name==null?(this.msg.error("Es necesario tener un comprobante anexado al pago, favor de agregar uno."),!1):!0}calculateDiff(e,a){let n=new Date(e),l=new Date(a);return Math.floor((l.getTime()-n.getTime())/1e3/60/60/24)}submitEditForm(){if(this.currentUserSelected&&this.currentUserSelected.uid){let e=this.validateEditForm.controls.customerId.value==null?"":this.validateEditForm.controls.customerId.value,a=this.validateEditForm.controls.customerName.value==null?"":this.validateEditForm.controls.customerName.value,n=this.validateEditForm.controls.defaultRound.value==null?"":this.validateEditForm.controls.defaultRound.value,l=this.validateEditForm.controls.defaultRoute.value==null?"":this.validateEditForm.controls.defaultRoute.value,c=this.validateEditForm.controls.defaultRouteName.value==null?"":this.validateEditForm.controls.defaultRouteName.value,p=this.validateEditForm.controls.displayName.value==null?"":this.validateEditForm.controls.displayName.value,y=this.validateEditForm.controls.email.value==null?"":this.validateEditForm.controls.email.value,S=this.validateEditForm.controls.firstName.value==null?"":this.validateEditForm.controls.firstName.value,V=this.validateEditForm.controls.lastName.value==null?"":this.validateEditForm.controls.lastName.value,N=this.validateEditForm.controls.phoneNumber.value==null?"":this.validateEditForm.controls.phoneNumber.value,P=this.validateEditForm.controls.studenId.value==null?"":this.validateEditForm.controls.studenId.value,W=this.validateEditForm.controls.username.value==null?"":this.validateEditForm.controls.username.value,$=this.validateEditForm.controls.defaultStopId.value==null?"":this.validateEditForm.controls.defaultStopId.value,G=this.validateEditForm.controls.defaultStopName.value==null?"":this.validateEditForm.controls.defaultStopName.value,H=this.currentUserSelected.uid,B=!0;this.newCustomerIdEditMode!=""&&!this.resetClientEditInfo&&(this.msg.error("Al cambiar de  Empresa es necesario asignar una operaci\xF3n y estaci\xF3n acorde a la empresa."),B=!1),W==""&&(this.msg.error("El Usuario es un valor requerido, favor de validar."),B=!1),P==""&&(this.msg.error("La Identificaci\xF3n es un valor requerido, favor de validar, si no se tiene un valor poner 0"),B=!1),y==""&&(this.msg.error("El Email es un valor requerido, favor de validar."),B=!1),e==""&&(this.msg.error("La Empresa es un valor requerido, favor de validar"),B=!1),l==""&&(this.msg.error(" La operaci\xF3n es un valor requerido, favor de validar"),B=!1);let Ne={uid:H,customerId:e,customerName:a,defaultRound:n,defaultRoute:l,defaultRouteName:c,displayName:p,email:y,firstName:S,lastName:V,phoneNumber:N,studentId:P,username:W,defaultStopId:$,defaultStopName:G};B&&this.customersService.updateUser(H,Ne).then(Re=>{this.isEditUserVisible=!1,this.currentUserSelected.firstName=S,this.currentUserSelected.lastName=V,this.currentUserSelected.displayName=p,this.currentUserSelected.username=W,this.currentUserSelected.studentId=P,this.currentUserSelected.email=y,this.currentUserSelected.customerId=e,this.currentUserSelected.customerName=a,this.currentUserSelected.phoneNumber=N,this.currentUserSelected.defaultRound=n,this.currentUserSelected.defaultRoute=l,this.currentUserSelected.defaultRouteName=c,this.currentUserSelected.defaultStopName=G,this.currentUserSelected.defaultStopId=$})}else this.sendMessage("error","currentUserSelected or uid is null or undefined")}submitFormProduct(){this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId),this.validateForm.controls.customerId.setValue(this.currentUserSelected.customerId);let e=this.validateForm.controls.amount.value,a=this.validateForm.controls.price.value,n=this.validateForm.controls.validTo.value,l=this.validateForm.controls.is_courtesy.value||!1;this.validateForm.controls.due_date.setValue(n.toISOString()),e!=a&&!l&&this.validateForm.controls.status.setValue("partial");for(let c in this.validateForm.controls)this.validateForm.controls[c].markAsDirty(),this.validateForm.controls[c].updateValueAndValidity();this.validateForm.valid&&(this.isConfirmLoading=!0,this.userlevelAccess!="3"?this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.validateForm.value).then(c=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(c=>{this.isConfirmLoading=!1}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador."))}pre(){this.current-=1}next(){if(this.current+=1,this.current===2){let e=[];this.usersByAccount.forEach(a=>{this.mapOfCredentialsCheckedId[a.uid]===!0&&e.push(a)}),this.actualSelectedRows=e.length,this.selectedUsersForCredentials=e}}done(){this.isVisibleBulk=!1,this.isVisibleBulkCredentials=!1,setTimeout(()=>{this.current=0,this.isDone=!0},500)}nzClicOption(){this.productsReference!==null&&this.getLatestPurchaseDetail(this.currentUserSelected.uid,this.productsReference.id)}nzClicTransfer(){this.loadinglatestTransfer=!0,this.customersService.getUserTransferInfo(this.currentUserSelected.uid).subscribe(e=>{this.dataTransfer=e.length?e:[],this.loadinglatestTransfer=!1},e=>{console.error("Error al obtener transferencias",e),this.dataTransfer=[],this.loadinglatestTransfer=!1})}nzClicOptionInformacion(){this.isBoardingPassSelected=!1}getBase64(e,a){let n=new FileReader;n.readAsDataURL(e),n.onload=()=>a(n.result)}handleChange2(e){if(e.file.status!=="uploading"){let n=e.file.status;this.fileListInfo=e.fileList,e.file.originFileObj&&this.getBase64(e.file.originFileObj,l=>{this.fileUrl=l;let c=e.file.name,p=`${this.bucketPath}/${c}`,y=this.bucketStorage.ref(p);this.task=this.bucketStorage.ref(p).putString(l,"data_url"),this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(T(S=>Number((S/100).toFixed(2)))).subscribe(S=>{this.uploading=S!=0,this.uploadvalue=S}),this.task.snapshotChanges().pipe(re(()=>{this.uploading=!1,this.downloadURL=y.getDownloadURL(),this.downloadURL.subscribe(S=>X(this,null,function*(){this.updateAdvanceURL(S),S.length>0?this.sendMessage("success",`${e.file.name} Archivo cargado satisfactoriamente.`):n==="error"&&this.sendMessage("error",`${e.file.name} archivo fallido, favor de validar.`)}))})).subscribe()})}}changePayment(e){this.validateForm.controls.amountPayment.setValue(0),this.paymentSelected=e,e=="Mensualidad"?(this.isValidDescriptionPaymentType=!1,this.isAnticipo=!1,this.validateForm.controls.amountPayment.setValue(this.validateForm.controls.amount.value)):e=="Anticipo"?(this.isValidDescriptionPaymentType=!0,this.isAnticipo=!0,this.validateForm.controls.amountPayment.setValue(0)):(this.isAnticipo=!1,this.isValidDescriptionPaymentType=!0,this.validateForm.controls.amountPayment.setValue(0))}onChangeValidTo(e){let a=this.validateForm.controls.validFrom.value;if(this.paymentSelected=="Anticipo"){let n=this.credentialForm.controls.validTo.value||new Date}}changePaymentType(e){e=="Sistema"||e=="Efectivo"?this.ifValidPayment=!1:this.ifValidPayment=!0}changeLiqPaymentType(e){e=="Sistema"||e=="Efectivo"?this.ifValidLiqPayment=!1:this.ifValidLiqPayment=!0}updateAdvanceURL(e){return X(this,null,function*(){this.validateForm.controls.fileURL.patchValue(e)})}updateAdvanceLURL(e){return X(this,null,function*(){this.validateLiqForm.controls.fileURL.patchValue(e)})}downloadPdf(){try{var e=new Le;(0,Ct.default)(document.getElementById("credencial")).then(a=>{let n=a.toDataURL("image/png"),l=new Le("p","pt","a4");var c=l.internal.pageSize.getWidth(),p=a.height*c/a.width;l.addImage(n,"PNG",10,10,c,p),l.save("credencial.pdf")})}catch(a){this.sendMessage("error",a)}}generatePDFInfo(){try{var e=new Le;(0,Ct.default)(document.getElementById("recibo")).then(a=>{let n=a.toDataURL("image/png"),l=new Le("p","pt","a4");var c=l.internal.pageSize.getWidth(),p=a.height*c/a.width;l.addImage(n,"PNG",10,10,c,p),l.save("recibo.pdf")})}catch(a){this.sendMessage("error",a)}}generatePurchasePDF(e){this.reciboPago.push({amount:e.amount,amountTrips:e.amountTrips,authorization:e.authorization,creation_date:e.creation_date,currentTrips:e.currentTrips,description:e.description,method:e.method,name:e.name,price:e.price,routeName:e.routeName,round:e.round,stopName:e.stopName,type:e.type,typePayment:e.typePayment,validFrom:e.validFrom,validTo:e.validTo}),this.isVisiblePurchasePay=!0}bajaCheck(){}downloadImg(){let e=document.getElementById("download")?.querySelector("canvas");if(e){this.download.nativeElement.href=e.toDataURL("image/png"),this.download.nativeElement.download="ng-zorro-antd";let a=new MouseEvent("click");this.download.nativeElement.dispatchEvent(a)}}static{this.\u0275fac=function(a){return new(a||s)(R(he),R(Gt),R(pe),R(At),R(at),R(Z),R(Tt))}}static{this.\u0275cmp=Y({type:s,selectors:[["ng-component"]],viewQuery:function(a,n){if(a&1&&(pt(Bi,5),pt(qi,5)),a&2){let l;ht(l=ft())&&(n.download=l.first),ht(l=ft())&&(n.searchbar=l.first)}},decls:104,vars:57,consts:[["searchInput",""],["suffixIconSearch",""],["searchInputEmail",""],["modalTitle",""],["modalContent",""],["modalPassFooter",""],["modalTitleProduct",""],["modalContentProduct",""],["modalFooter",""],["modalUserTitle",""],["modalUserContent",""],["modalUserFooter",""],["modalTitlePay",""],["modalContentPay",""],["modalPassFooterPay",""],["modalContentBulk",""],["modalFooterBulk",""],["modalTitleLiq",""],["modalContentLiquidacion",""],["modalFooterLiquidacion",""],["modalTitleBulkCredentials",""],["modalContentBulkCredentials",""],["modalFooterBulkCredentials",""],["modalTitleUserCredential",""],["modalContentCredential",""],["modalFooterCredential",""],["modalPassTitleE",""],["modalContentEdit",""],["modalPassFooterE",""],["basicTable",""],["chatSetting","nzDropdownMenu"],["basicChatData",""],["messageCenterFooterTemplate",""],["basicTable23",""],["tableReference",""],["avatarTemplate",""],["rowSelectionTable",""],[2,"margin-right","15px","margin-left","15px","background-color","#f9fbfd !important"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"chat-header",2,"background-color","#f9f9f9"],[3,"nzHeader","nzActive"],[2,"display","flex","align-items","center","gap","15px"],["nzPlaceHolder","Selecciona un cliente",2,"width","450px",3,"ngModelChange","ngModel"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[2,"flex-grow","1",3,"nzSuffix"],["type","text","nz-input","","placeholder","Buscar",3,"keyup"],["type","text","nz-input","","placeholder","Buscar por Correo",3,"keyup.enter"],["nz-button","","nzType","primary",1,"m-r-10",3,"click"],["nzCollapsible","",2,"background-color","white","border","1px solid #ccc !important","height","100vh","overflow-y","auto",3,"nzCollapsedChange","nzCollapsed","nzWidth","nzTrigger"],[1,"chat-input"],["style","height: 100%;",3,"nzData","nzShowPagination","nzPageSize","nzScroll",4,"ngIf"],[2,"background-color","white","border","1px solid #ccc !important"],["nz-icon","",1,"trigger",3,"click","nzType"],[2,"background-color","white !important","border","1px solid #ccc !important","padding","20px",3,"ngClass"],[1,"conversation"],[1,"conversation-wrapper"],["class","conversation-header justify-content-between",4,"ngIf"],["style","width: 100% !important; overflow-y: scroll !important; height: 100% !important; ",4,"ngIf"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter","nzWidth"],["class","footer",4,"ngIf"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzWidth","nzTitle","nzContent","nzFooter"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon","","nzType","search"],[2,"height","100%",3,"nzData","nzShowPagination","nzPageSize","nzScroll"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"media","align-items-center",2,"height","60px"],["nzShape","square","nzIcon","user",1,"shadow",3,"nzSize","nzSrc"],["nz-icon","",4,"ngIf"],["nz-icon",""],[1,"conversation-header","justify-content-between"],[1,"media","align-items-center"],[1,"m-r-20","d-md-none","d-block","text-dark","font-size-18","m-t-5",3,"routerLink"],["nz-icon","","type","left-circle","theme","outline"],["nzShape","square","nzIcon","user",1,"shadow",3,"nzSrc"],[1,"p-l-15"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436",4,"ngIf"],[3,"nzStatus"],["nz-dropdown","","nzPlacement","bottomRight",1,"text-dark","font-size-18",3,"nzDropdownMenu","nzTrigger"],["nz-icon","","theme","outline"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436"],["nz-menu-item","",3,"click"],[2,"width","100% !important","overflow-y","scroll !important","height","100% !important"],["nzTitle","Informacion General",3,"nzClick"],["nz-button","",1,"m-r-10",3,"click"],["nzBordered","","nzSize","small"],["nzTitle","Nombre"],[1,"custom-label-style"],["nzTitle","Apellidos"],["nzTitle","Email"],["nzTitle","Curp"],["nzTitle","Edad"],["nzTitle","Grupo/Poblaci\xF3n"],["nzTitle","Direcci\xF3n"],["nzTitle","Correo Valido"],["nzTitle","Display Name"],["nzTitle","Empresa"],["nzTitle","Operaci\xF3n"],["nzTitle","Estaciones"],["nzTitle","Turno"],["nzTitle","Telefono"],["nzTitle","Identificaci\xF3n"],["nzTitle","Usuario"],["nzTitle","Estatus"],["nzTitle","Tipo de Viaje"],["nzTitle","Pases"],[3,"nzData","nzPageSize","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Mensajes",3,"nzClick"],[3,"nzData","nzPageSize","nzFooter","nzLoadingDelay"],[4,"ngFor","ngForOf"],["nzTitle","Transferencias",3,"nzClick"],[3,"nzData","nzPageSize","nzShowPagination"],[4,"ngIf"],[3,"nzData","nzPageSize","nzLoading","nzLoadingDelay"],[3,"nzColor"],["nz-text","","nzType","secondary"],[3,"nzColor",4,"ngIf"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","nzTheme","outline"],["nzPlain","","nzText","Mensaje"],["rows","4","nz-input","","placeholder","Mensaje",3,"ngModelChange","ngModel"],["target","_blank",3,"href",4,"ngIf"],["target","_blank",3,"href"],["colspan","6",1,"text-center"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],["formControlName","product_id","nzAllowClear","","nzPlaceHolder","Seleccionar producto / servicio",2,"width","320px",3,"ngModelChange"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","320px",3,"ngModelChange"],["formControlName","stopId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",2,"width","320px",3,"ngModelChange"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","200px"],["nzValue","D\xEDa","nzLabel","D\xEDa"],["nzValue","Tarde","nzLabel","Tarde"],["nzValue","Noche","nzLabel","Noche"],["formControlName","payment","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de Pago",2,"width","200px",3,"ngModelChange"],["nzValue","Mensualidad","nzLabel","Mensualidad"],["nzValue","Anticipo","nzLabel","Anticipo"],["nzValue","Liquidacion","nzLabel","Liquidaci\xF3n"],[1,"row"],[1,"col-md-6"],["formControlName","amountPayment",3,"ngModelChange","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["class","col-md-6",4,"ngIf"],["formControlName","amount",3,"ngModelChange","disabled","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["formControlName","is_courtesy","nzCheckedChildren","Si","nzUnCheckedChildren","No",3,"ngModelChange"],["formControlName","typePayment","nzAllowClear","","nzPlaceHolder","Selecciona una Referencia",2,"width","200px",3,"ngModelChange"],["nzValue","Transferencia","nzLabel","Transferencia"],["nzValue","Efectivo","nzLabel","Efectivo"],["nzValue","Sistema","nzLabel","Pago por Sistema"],["nz-checkbox","","formControlName","active"],["formControlName","validFrom"],["formControlName","validTo",3,"ngModelChange","nzDisabledDate"],["formControlName","promiseDate"],["nzName","comprobante","nzType","drag","zAction","/api/posts/",3,"nzChange","nzMultiple","nzLimit","nzSize","nzFileType"],[1,"ant-upload-drag-icon"],[1,"ant-upload-text"],[1,"ant-upload-hint"],["nz-button","",3,"click"],["nz-button","",3,"click","nzLoading"],["formControlName","amount",3,"ngModelChange","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["formControlName","validTo"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngIf"],[3,"nzSm","nzXs"],["nz-input","","formControlName","firstName","id","firstName"],["nz-input","","formControlName","lastName","id","lastName"],["nz-input","","formControlName","displayName","id","displayName"],["nz-input","","formControlName","username","id","username"],["nz-input","","formControlName","phoneNumber","id","phoneNumber"],["nz-input","","formControlName","studenId","id","studenId"],["nz-input","","formControlName","email","id","email"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Selecciona la empresa",3,"ngModelChange"],["formControlName","defaultRoute","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",3,"ngModelChange"],["formControlName","defaultStopId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["formControlName","defaultRound","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","320px"],[1,"footer"],["nzTitle","Detalles"],["nzTitle","Producto"],["nzTitle","Pagado"],["nzStatus","success","nzText","Si",4,"ngIf"],["nzStatus","processing","nzText","Parcial",4,"ngIf"],["nzStatus","warning","nzText","No",4,"ngIf"],["nzTitle","Activo"],["nzStatus","processing","nzText","Si",4,"ngIf"],["nzTitle","Fecha de compra"],["nzTitle","Pase Cortes\xEDa"],["nzTitle","Valido desde"],["nzTitle","Valido hasta"],["nzTitle","Precio"],["nzTitle","Pagado",4,"ngIf"],["nzTitle","Autorizaci\xF3n"],["nzTitle","Estaci\xF3n"],["nzTitle","Monto Abonado"],["nzTitle","Tipo de Referencia"],["nzTitle","Fecha Compromiso"],["nzTitle","Tipo de Pago"],["nzTitle","Informaci\xF3n de la compra"],["nzTitle","Referencias",3,"nzClick"],[3,"nzData","nzPageSize","nzLoadingDelay"],["nzTitle","Historial de Uso"],[3,"userId","boardingPassId"],["nzTitle","C\xF3digo QR"],["nzTitle","Credencial"],[2,"background","#ECECEC","padding","30px"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nz-row","","id","credencial","credencial","",3,"nzGutter"],["nz-col","",2,"margin-right","76px",3,"nzSpan"],[1,"rounded-margins",2,"width","400px","border-radius","20px","height","310px","background-color","#73C2FBFE",3,"nzBordered"],["nzDescription","",2,"color","black",3,"nzAvatar","nzTitle"],[2,"color","black"],[2,"margin-bottom","1px"],[2,"display","flex","justify-content","center","align-items","center"],[3,"nzValue"],[2,"display","flex","flex-wrap","wrap","height","100%"],[2,"width","33.33%","box-sizing","border-box","padding","5px","height","130px"],[2,"border","1px solid black","padding","5px","height","100%"],["nzTitle","",2,"background-image","url('../../../assets/images/logo/andlogoSL.png')","background-position","center","background-size","contain","height","100%",3,"nzBordered"],[2,"color","black","font-size","12px"],["nzStatus","success","nzText","Si"],["nzStatus","processing","nzText","Parcial"],["nzStatus","warning","nzText","No"],["nzStatus","processing","nzText","Si"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEditar el pago?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],[3,"ngModel","nzMin","nzMax","nzStep","nzFormatter","nzParser","ngModelChange",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEditar el pago?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel"],[3,"ngModelChange","ngModel","nzMin","nzMax","nzStep","nzFormatter","nzParser"],[3,"nzSrc"],["id","recibo","recibo",""],["class","recibo",4,"ngFor","ngForOf"],[1,"recibo"],["nzTitle","Recibo","nzDescription","And"],["nzSize","small",3,"nzCurrent"],["nzTitle","Pase","nzDescription","Crear el pase."],["nzTitle","Empresas","nzDescription","Seleccionar las empresas."],["nzTitle","Confirmar","nzDescription","Validar la creaci\xF3n."],["nzShowSizeChanger","",3,"nzCurrentPageDataChange","nzData","nzSize"],["nzShowCheckbox","","nzShowRowSelection","",3,"nzCheckedChange","nzSelections","nzChecked","nzIndeterminate"],["nzShowCheckbox","",3,"nzCheckedChange","nzChecked"],["nz-popconfirm","","nzPopconfirmTitle","\xBFVas a recibir dinero?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","\xBFVas a recibir dinero?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel"],[1,"steps-action"],["nz-button","",3,"disabled","click",4,"ngIf"],["nz-button","",3,"nzLoading","click",4,"ngIf"],["nz-button","",3,"click",4,"ngIf"],["nz-button","",3,"click","disabled"],["nz-input","","formControlName","productSelected"],["formControlName","amount"],["formControlName","alreadyPayment"],["formControlName","completeAmount"],["nz-checkbox","","formControlName","baja",3,"ngModelChange"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nzTitle","Credencial","nzDescription","Crear la credencial."],["nzTitle","Usuarios","nzDescription","Seleccionar los usuarios."],[1,"steps-content","overflow-auto"],[2,"color","#4F6F57"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"click",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"disabled","click",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"disabled","nzLoading","click",4,"ngIf"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","disabled"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","disabled","nzLoading"],["formControlName","product_id","nzAllowClear","","nzPlaceHolder","Seleccionar producto / servicio",2,"width","320px",3,"nzDisabled"]],template:function(a,n){if(a&1){let l=x();t(0,"div",37)(1,"nz-layout")(2,"nz-page-header",38)(3,"nz-page-header-title",39),o(4,"General"),i(),t(5,"nz-page-header-subtitle"),o(6,"Listado general de Usuarios "),i(),t(7,"nz-page-header-content")(8,"div",40)(9,"nz-collapse")(10,"nz-collapse-panel",41)(11,"div",42)(12,"nz-select",43),F("ngModelChange",function(p){return h(l),I(n.selectedOption,p)||(n.selectedOption=p),f(p)}),_("ngModelChange",function(p){return h(l),f(n.log(p))}),z(13,Xi,2,3,"nz-option",44),i(),t(14,"nz-input-group",45)(15,"input",46,0),_("keyup",function(){h(l);let p=b(16);return f(n.getItems(p.value))}),i()(),z(17,Gi,1,0,"ng-template",null,1,E),t(19,"nz-input-group",45)(20,"input",47,2),_("keyup.enter",function(){h(l);let p=b(21);return f(n.getItemsByEmail(p.value))}),i()(),z(22,Hi,1,0,"ng-template",null,1,E),t(24,"button",48),_("click",function(){return h(l),f(n.searchloadUsers())}),o(25,"Cargar Usuarios"),i()()()()()()(),t(26,"nz-layout")(27,"nz-sider",49),F("nzCollapsedChange",function(p){return h(l),I(n.isCollapsed,p)||(n.isCollapsed=p),f(p)}),t(28,"div",50),z(29,Ki,4,6,"nz-table",51),i()(),t(30,"nz-layout")(31,"nz-header",52)(32,"span",53),_("click",function(){return h(l),f(n.isCollapsed=!n.isCollapsed)}),i()(),t(33,"nz-content",54)(34,"div",55)(35,"div",56),z(36,tn,23,11,"div",57),t(37,"div"),z(38,bn,80,30,"nz-tabset",58),t(39,"nz-modal",59),F("nzVisibleChange",function(p){return h(l),I(n.isVisible,p)||(n.isVisible=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),z(40,xn,1,0,"ng-template",null,3,E)(42,Tn,71,18,"ng-template",null,4,E)(44,wn,4,1,"ng-template",null,5,E),i(),t(46,"nz-modal",59),F("nzVisibleChange",function(p){return h(l),I(n.isProductVisible,p)||(n.isProductVisible=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancelProduct())}),z(47,In,1,0,"ng-template",null,6,E)(49,Mn,28,7,"ng-template",null,7,E)(51,Un,4,1,"ng-template",null,8,E),i(),t(53,"nz-modal",60),F("nzVisibleChange",function(p){return h(l),I(n.isEditUserVisible,p)||(n.isEditUserVisible=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),z(54,Ln,1,0,"ng-template",null,9,E)(56,Bn,61,46,"ng-template",null,10,E)(58,qn,4,0,"ng-template",null,11,E),i()(),z(60,na,124,63,"div",61),i()()()()()()(),t(61,"nz-modal",59),F("nzVisibleChange",function(p){return h(l),I(n.isVisiblePurchasePay,p)||(n.isVisiblePurchasePay=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),z(62,aa,1,0,"ng-template",null,12,E)(64,oa,2,1,"ng-template",null,13,E)(66,sa,4,1,"ng-template",null,14,E),i(),t(68,"nz-modal",59),F("nzVisibleChange",function(p){return h(l),I(n.isVisibleBulk,p)||(n.isVisibleBulk=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),t(69,"div"),z(70,la,2,0,"ng-template",null,3,E)(72,va,10,4,"ng-template",null,15,E)(74,ya,5,4,"ng-template",null,16,E),i()(),t(76,"nz-modal",59),F("nzVisibleChange",function(p){return h(l),I(n.canUpdatePayment,p)||(n.canUpdatePayment=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),z(77,Da,1,0,"ng-template",null,17,E)(79,Va,41,2,"ng-template",null,18,E)(81,Pa,6,0,"ng-template",null,19,E),i(),t(83,"nz-modal",62),F("nzVisibleChange",function(p){return h(l),I(n.isVisibleBulkCredentials,p)||(n.isVisibleBulkCredentials=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),z(84,Ta,1,0,"ng-template",null,20,E)(86,La,10,5,"ng-template",null,21,E)(88,qa,5,4,"ng-template",null,22,E),i(),t(90,"nz-modal",62),F("nzVisibleChange",function(p){return h(l),I(n.isModalCredentialVisible,p)||(n.isModalCredentialVisible=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),z(91,$a,1,0,"ng-template",null,23,E)(93,Wa,18,1,"ng-template",null,24,E)(95,ja,3,2,"ng-template",null,25,E),i(),t(97,"nz-modal",59),F("nzVisibleChange",function(p){return h(l),I(n.isModalEditVisible,p)||(n.isModalEditVisible=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),z(98,Xa,1,0,"ng-template",null,26,E)(100,Ka,34,5,"ng-template",null,27,E)(102,Ya,4,0,"ng-template",null,28,E),i()}if(a&2){let l=b(18),c=b(41),p=b(43),y=b(45),S=b(48),V=b(50),N=b(52),P=b(55),W=b(57),$=b(59),G=b(63),H=b(65),B=b(67),Ne=b(73),Re=b(75),j=b(78),ke=b(80),Q=b(82),ee=b(87),dt=b(89),ct=b(94),wi=b(96),Ii=b(99),Fi=b(101),Ni=b(103);r(2),d("nzGhost",!1),r(8),d("nzHeader","Filtros avanzados")("nzActive",!0),r(2),w("ngModel",n.selectedOption),r(),d("ngForOf",n.customersList),r(),d("nzSuffix",l),r(5),d("nzSuffix",l),r(8),w("nzCollapsed",n.isCollapsed),d("nzWidth",330)("nzTrigger",null),r(2),d("ngIf",(n.devicesList==null?null:n.devicesList.length)>0),r(3),d("nzType",n.isCollapsed?"menu-unfold":"menu-fold"),r(),d("ngClass",O(55,$i,n.isContentOpen)),r(3),d("ngIf",n.isUserSelected),r(2),d("ngIf",n.isUserSelected),r(),w("nzVisible",n.isVisible),d("nzTitle",c)("nzContent",p)("nzFooter",y),r(7),w("nzVisible",n.isProductVisible),d("nzTitle",S)("nzContent",V)("nzFooter",N),r(7),w("nzVisible",n.isEditUserVisible),d("nzTitle",P)("nzContent",W)("nzFooter",$)("nzWidth",600),r(7),d("ngIf",n.isBoardingPassSelected),r(),w("nzVisible",n.isVisiblePurchasePay),d("nzTitle",G)("nzContent",H)("nzFooter",B),r(7),w("nzVisible",n.isVisibleBulk),d("nzTitle","Emitir m\xFAltiples pases")("nzContent",Ne)("nzFooter",Re),r(8),w("nzVisible",n.canUpdatePayment),d("nzTitle",j)("nzContent",ke)("nzFooter",Q),r(7),w("nzVisible",n.isVisibleBulkCredentials),d("nzWidth",800)("nzTitle","Emitir m\xFAltiples credenciales")("nzContent",ee)("nzFooter",dt),r(7),w("nzVisible",n.isModalCredentialVisible),d("nzWidth",800)("nzTitle","Emitir credencial")("nzContent",ct)("nzFooter",wi),r(7),w("nzVisible",n.isModalEditVisible),d("nzTitle",Ii)("nzContent",Fi)("nzFooter",Ni)}},dependencies:[wt,se,Oe,Yt,fe,ze,ge,Ce,ve,be,$e,We,Ut,Mt,ai,Zt,tt,Ye,Ze,ei,nt,et,it,ti,De,Lt,li,ci,di,mi,ri,rt,pi,ui,fi,hi,Xt,Wt,$t,jt,qt,Bt,Ht,Qt,Jt,ye,xe,Se,Ot,Rt,Pe,Ee,Ve,Kt,ii,Te,we,Ft,ce,Be,le,de,me,ue,kt,Je,Qe,oi,ni,_i,Ae,It],styles:[".centered-header[_ngcontent-%COMP%]{justify-content:center;align-items:center}.header-content[_ngcontent-%COMP%]{text-align:center}.recibo[_ngcontent-%COMP%]{margin-bottom:10px;width:500px}.horizontal-checkbox[_ngcontent-%COMP%]{display:inline-block;margin-right:8px}.chat-container[_ngcontent-%COMP%]{width:300px;display:flex;flex-direction:column;border:1px solid #ccc;border-radius:5px;overflow:hidden;font-family:Arial,sans-serif;background-color:#fff}.chat-header[_ngcontent-%COMP%]{padding:10px;text-align:center;font-weight:700;border:1px solid #edf2f9}.chat-list[_ngcontent-%COMP%]{flex:1;height:150px;overflow-y:auto;padding:10px;background-color:#fff}.chat-message[_ngcontent-%COMP%]{padding:5px;margin-bottom:10px;border-radius:5px;background-color:#fff;border:1px solid #ddd}.chat-message[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{font-weight:700;margin-right:5px}.chat-input[_ngcontent-%COMP%]{display:flex;height:400px;padding:10px;background-color:#fff;border-top:1px solid}.chat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:10px;border:1px solid #ccc;border-radius:5px}.chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;margin-left:10px;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer}.chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.trigger[_ngcontent-%COMP%]{font-size:18px;line-height:64px;padding:0 24px;cursor:pointer;transition:color .3s}.trigger[_ngcontent-%COMP%]:hover{color:#f9f9f9}nz-header[_ngcontent-%COMP%]{background:#fff;padding:0}"]})}}return s})();var Ti=(()=>{class s{constructor(e,a){this.afs=e,this.messageService=a}getFiles(){return this.afs.collectionGroup("quality",a=>a.where("active","==",!0).orderBy("folder","desc")).valueChanges()}saveFileCollection(e){let a=this.afs.createId();return e.uid=a,this.afs.collection("quality").doc(a).set(e)}deletePurchase(e){this.filesCollection=this.afs.collection("quality").doc(e),this.filesCollection.delete().then(()=>{this.sendMessage("success","Se borro con \xE9xito el Archivo")}).catch(a=>{this.sendMessage("error",`\xA1Oops! Algo sali\xF3 mal cuando se intentaba borrar un archivo ... ${a}`)})}sendMessage(e,a){this.messageService.create(e,a)}static{this.\u0275fac=function(a){return new(a||s)(ut(he),ut(Z))}}static{this.\u0275prov=Et({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();function Za(s,m){if(s&1&&v(0,"nz-option",22),s&2){let e=m.$implicit;d("nzValue",e)("nzLabel",e)}}function er(s,m){s&1&&v(0,"input",23)}function tr(s,m){if(s&1){let e=x();t(0,"button",11),_("click",function(){h(e);let n=u();return f(n.newFolderSave())}),o(1,"\u2713"),i()}}function ir(s,m){if(s&1){let e=x();t(0,"button",24),_("click",function(){h(e);let n=u();return f(n.handleOKEdit())}),o(1,"Aceptar"),i(),t(2,"button",11),_("click",function(){h(e);let n=u();return f(n.handleCancelEdit())}),o(3,"Cancelar"),i()}if(s&2){let e=u();d("nzLoading",e.isConfirmLoading)}}function nr(s,m){if(s&1&&(t(0,"div")(1,"a",27),o(2,"Ver Comprobante"),i()()),s&2){let e=u(2);r(),oe("href",e.urlFile,Ue)}}function ar(s,m){if(s&1){let e=x();t(0,"div")(1,"form",25)(2,"nz-form-item")(3,"button",11),_("click",function(){h(e);let n=u();return f(n.changeOption(1))}),o(4,"Ver"),i(),t(5,"button",11),_("click",function(){h(e);let n=u();return f(n.changeOption(2))}),o(6,"Borrar"),i()(),t(7,"nz-form-item"),z(8,nr,3,1,"div",26),i()()()}if(s&2){let e=u();r(8),d("ngIf",e.isVerVisible)}}var Do=(()=>{class s{constructor(e,a,n){this.msg=e,this.bucketStorage=a,this.fb=n,this.rolService=k(Ge),this.authService=k(_e),this.isConfirmLoading=!1,this.fileUrl="http://themenate.com/applicator/dist/assets/images/avatars/thumb-13.jpg",this.autosave=!0,this.uploading=!1,this.bucketPath="/quality1/quality/",this.view="Ver",this.isVerVisible=!1,this.isEditModalVisible=!1,this.urlFile="",this.uploadvalue=0,this.rowFolders=[],this.addNewFolder=!1,this.selectedRecord=[],this.rowGroupPanelShow="always",this.infoLoad=[],this.qualityService=k(Ti),this.uploadingL=!1,this.authService.user.subscribe(l=>{l&&(this.user=l,this.user&&this.user.rolId!=null&&this.rolService.getRol(this.user.rolId).valueChanges().subscribe(c=>{this.infoLoad=c,this.userlevelAccess=this.infoLoad.optionAccessLavel}))})}ngOnInit(){this.validateForm=this.fb.group({folder:[""],fileUrl:[""],fileName:[""],NewFolderName:[""]}),this.loadFiles()}sendMessage(e,a){this.msg.create(e,a)}loadFiles(){this.qualitySubscription=this.qualityService.getFiles().subscribe(e=>{if(e.length>=0){this.rowData=e,e.forEach(n=>{this.rowFolders.push(n.folder)});let a=Array.from(new Set(this.rowFolders));this.rowFolders=a}})}ngOnDestroy(){this.qualitySubscription.unsubscribe()}submitForm(){var e,a=this.fileURL||"",n=this.validateForm.controls.folder.value||"",l=this.fileName||"No-Name",c=new Date;n==""&&this.msg.error("Se requiere seleccionar una carpeta para almacenenar."),a==""&&this.msg.error("Se requiere tener un archivo para subir."),e={active:!0,folder:n,fileUrl:a,fileName:l,creation_date:c,uid:""},this.userlevelAccess!="3"?this.qualityService.saveFileCollection(e).then(p=>{this.msg.success("Se subio el archivo con \xE9xito."),this.refreshTable()}).catch(p=>{this.msg.error("Se presento un error."+p)}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}changeFolder(e){}newFolder(){this.addNewFolder=!0}handleChange(e){if(e.file.status!=="uploading"){let n=e.file.status;this.fileListInfo=e.fileList,e.file.originFileObj&&this.getBase64(e.file.originFileObj,l=>{this.fileUrl=l;let c=e.file.name,p=`${this.bucketPath}/${c}`,y=this.bucketStorage.ref(p);this.task=this.bucketStorage.ref(p).putString(l,"data_url"),this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(T(S=>Number((S/100).toFixed(2)))).subscribe(S=>{this.uploading=S!=0,this.uploadvalue=S}),this.task.snapshotChanges().pipe(re(()=>{this.uploading=!1,this.downloadURL=y.getDownloadURL(),this.downloadURL.subscribe(S=>X(this,null,function*(){this.updateURL(S),S.length>0?this.sendMessage("success",`${e.file.name} Archivo cargado satisfactoriamente.`):n==="error"&&this.sendMessage("error",`${e.file.name} archivo fallido, favor de validar.`)}))})).subscribe()})}}updateURL(e){return X(this,null,function*(){this.fileURL=e})}getBase64(e,a){let n=new FileReader;n.readAsDataURL(e),n.onload=()=>a(n.result)}refreshTable(){this.loadFiles()}newFolderSave(){let e=this.validateForm.get("NewFolderName");e&&e.value!==null&&(this.rowFolders.push(e.value),this.addNewFolder=!1,this.validateForm.controls.NewFolderName.setValue(""))}handleOKEdit(){this.isVerVisible?this.isVerVisible=!0:this.userlevelAccess=="1"?(this.qualityService.deletePurchase(this.selectedUid),this.refreshTable(),this.isEditModalVisible=!1):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}changeOption(e){e==2?this.isVerVisible=!1:this.isVerVisible=!0}handleCancelEdit(){this.isEditModalVisible=!1}handleChangeUpload(e){e.file&&e.file.status!=="uploading"&&(e.file.status==="done"?this.msg.success(`${e.file.name} file uploaded successfully`):e.file.status==="error"&&this.msg.error(`${e.file.name} file upload failed.`),e.file.originFileObj&&this.getBase64(e.file.originFileObj,a=>{this.fileUrl=a;let n=this.bucketStorage.ref(this.bucketPath+e.file.name);this.task=this.bucketStorage.ref(this.bucketPath+e.file.name).putString(a,"data_url"),this.fileName=e.file.name;var l=this.bucketStorage.ref(this.bucketPath).child(e.file.name);this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(T(c=>Number((c/100).toFixed(2)))).subscribe(c=>{this.uploading=c!=0,this.uploadvalue=c}),this.task.snapshotChanges().pipe(re(()=>{this.downloadURL=n.getDownloadURL(),this.downloadURL.subscribe(c=>X(this,null,function*(){this.updateURL(c)}))})).subscribe()}))}static{this.\u0275fac=function(a){return new(a||s)(R(Z),R(at),R(pe))}}static{this.\u0275cmp=Y({type:s,selectors:[["ng-component"]],decls:45,vars:9,consts:[["modalFooterEdit",""],["modalContent",""],[2,"margin","buttom 15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],["nz-form","","nzLayout","vertical",3,"formGroup"],[1,"body"],[1,"row"],[1,"col-md-4"],["formControlName","folder","nzAllowClear","","nzPlaceHolder","Selecciona una carpeta donde almacenar el documento.",2,"width","200px",3,"ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],[1,"col-md-8"],["style","width: 350px;","nz-input","","placeholder","Ingresa el nombre de la carpeta","formControlName","NewFolderName",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"click",4,"ngIf"],[1,"col-md-2"],["zAction","'/api/posts/'",3,"nzChange","nzDisabled"],["nz-button",""],["nz-icon",""],[1,"col-md-10"],[1,"col-md-12"],["nzTitle","Detalle Archivo","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],[3,"nzValue","nzLabel"],["nz-input","","placeholder","Ingresa el nombre de la carpeta","formControlName","NewFolderName",2,"width","350px"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","nzLoading"],["nz-form",""],[4,"ngIf"],["target","_blank",3,"href"]],template:function(a,n){if(a&1){let l=x();t(0,"div",2)(1,"div",3)(2,"nz-page-header",4)(3,"nz-page-header-title"),o(4,"Calidad"),i(),t(5,"nz-page-header-subtitle"),o(6," Repositorio "),i()(),t(7,"form",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"nz-form-item")(12,"nz-form-label"),o(13,"Carpeta"),i(),t(14,"nz-select",9),_("ngModelChange",function(p){return h(l),f(n.changeFolder(p))}),z(15,Za,1,2,"nz-option",10),i(),t(16,"button",11),_("click",function(){return h(l),f(n.newFolder())}),o(17,"+"),i()()(),t(18,"div",12),z(19,er,1,0,"input",13)(20,tr,2,0,"button",14),i()(),t(21,"div",7)(22,"div",15)(23,"nz-form-item")(24,"nz-upload",16),_("nzChange",function(p){return h(l),f(n.handleChangeUpload(p))}),t(25,"button",17),v(26,"span",18),t(27,"span"),o(28,"Cargar Archivo"),i()()()()(),t(29,"div",19)(30,"nz-form-item")(31,"button",11),_("click",function(){return h(l),f(n.submitForm())}),o(32,"Subir"),i()()()()(),t(33,"div",7)(34,"div",15)(35,"button",11),_("click",function(){return h(l),f(n.refreshTable())}),o(36,"Actualizar"),i()(),v(37,"div",19),i(),t(38,"div",7),v(39,"div",20),i()()(),t(40,"nz-modal",21),F("nzVisibleChange",function(p){return h(l),I(n.isEditModalVisible,p)||(n.isEditModalVisible=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancelEdit())}),z(41,ir,4,1,"ng-template",null,0,E),i(),z(43,ar,9,1,"ng-template",null,1,E),i()}if(a&2){let l=b(42),c=b(44);r(2),d("nzGhost",!1),r(5),d("formGroup",n.validateForm),r(8),d("ngForOf",n.rowFolders),r(4),d("ngIf",n.addNewFolder),r(),d("ngIf",n.addNewFolder),r(4),d("nzDisabled",n.uploadingL),r(16),w("nzVisible",n.isEditModalVisible),d("nzContent",c)("nzFooter",l)}},dependencies:[se,Oe,fe,ze,ge,Ce,ve,be,We,De,rt,ye,xe,Se,Pe,Ee,Ve,Te,we,ce,Be,le,de,me,ue,Nt],styles:[".footer[_ngcontent-%COMP%]{height:100%!important;position:absolute;padding:0 25px;display:flex;justify-content:space-between}.body[_ngcontent-%COMP%]{overflow-y:auto;padding:15px 25px;position:relative;width:100%}"]})}}return s})();var Ie=s=>({passes:s}),Fe=s=>({data:s});function rr(s,m){if(s&1&&(t(0,"nz-option",44),o(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(),C(" ",e.name,"")}}function or(s,m){if(s&1&&(t(0,"nz-option",44),v(1,"i",45),o(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(2),L(" ",e.name," $",e.price," ")}}function sr(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i()()),s&2){let e=m.$implicit,a=u();r(2),g(e.customerName),r(2),g(e.routeName),r(2),g(a.customCellRenderer(O(7,Fe,O(5,Ie,e.passes)))),r(2),g(a.customCellRendererMonto(O(11,Fe,O(9,Ie,e.passes)))),r(2),g(a.formatPermission(e.permission))}}function lr(s,m){if(s&1&&(t(0,"nz-option",44),o(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(),C(" ",e.name,"")}}function dr(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i()()),s&2){let e=m.$implicit,a=u();r(2),g(e.customerName),r(2),g(e.routeName),r(2),g(a.customCellRenderer(O(7,Fe,O(5,Ie,e.passes)))),r(2),g(a.customCellRendererMonto(O(11,Fe,O(9,Ie,e.passes)))),r(2),g(a.formatPermission(e.permission))}}function cr(s,m){if(s&1&&(t(0,"nz-option",44),o(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(),C(" ",e.name," ")}}function mr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",44),v(2,"i",45),o(3),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.name)("nzValue",e.id),r(2),L(" ",e.name," $",e.price," ")}}function ur(s,m){if(s&1&&(t(0,"div")(1,"nz-option",44),v(2,"i",45),o(3),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.name)("nzValue",e.id),r(2),C(" ",e.name," ")}}function pr(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i()()),s&2){let e=m.$implicit,a=u();r(2),g(e.customerName),r(2),g(e.routeName),r(2),g(a.customCellRenderer(O(7,Fe,O(5,Ie,e.passes)))),r(2),g(a.customCellRendererMonto(O(11,Fe,O(9,Ie,e.passes)))),r(2),g(a.formatPermission(e.permission))}}function hr(s,m){if(s&1&&(t(0,"nz-option",44),o(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(),C(" ",e.name," ")}}function fr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",44),v(2,"i",45),o(3),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.name)("nzValue",e.id),r(2),L(" ",e.name," $",e.price," ")}}function _r(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td"),o(18),i(),t(19,"td"),o(20),i()()),s&2){let e=m.$implicit,a=u();r(2),g(e.customerName),r(2),g(e.routeName),r(2),g(e.round),r(2),g(e.stopName),r(2),g(e.name),r(2),g(a.formatPermission(e.isTaskIn)),r(2),g(a.formatPermission(e.isTaskOut)),r(2),g(a.formatPermission(e.is_courtesy)),r(2),g(a.formatValidTo(e.validFrom)),r(2),g(a.formatValidTo(e.validTo))}}function gr(s,m){if(s&1&&(t(0,"nz-option",44),o(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(),C(" ",e.name," ")}}function zr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",44),v(2,"i",45),o(3),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.name)("nzValue",e.id),r(2),L(" ",e.name," $",e.price," ")}}function vr(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td"),o(18),i(),t(19,"td"),o(20),i()()),s&2){let e=m.$implicit,a=u();r(2),g(e.customerName),r(2),g(e.routeName),r(2),g(e.round),r(2),g(e.amountPayment),r(2),g(a.formatPromiseDate(e.promiseDate)),r(2),g(a.calculateDaysDifference(e.promiseDate)),r(2),C(" ",e.name,""),r(2),g(a.formatMeteSacaCortesia(e)),r(2),g(a.formatValidTo(e.validFrom)),r(2),g(a.formatValidTo(e.validTo))}}function Cr(s,m){if(s&1&&(t(0,"nz-option",44),o(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(),C(" ",e.name," ")}}function br(s,m){if(s&1&&(t(0,"div")(1,"nz-option",44),v(2,"i",45),o(3),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.name)("nzValue",e.id),r(2),L(" ",e.name," $",e.price," ")}}function xr(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td"),o(18),i(),t(19,"td"),o(20),i(),t(21,"td"),o(22),i()()),s&2){let e=m.$implicit,a=u();r(2),g(e.customerName),r(2),g(e.routeName),r(2),g(e.round),r(2),g(e.amountPayment),r(2),g(a.calculatePendingPayment(e)),r(2),g(a.formatPromiseDate(e.promiseDate)),r(2),g(a.calculateDaysDifference(e.promiseDate)),r(2),C(" ",e.name,""),r(2),g(a.formatMeteSacaCortesia(e)),r(2),g(a.formatValidTo(e.validFrom)),r(2),g(a.formatValidTo(e.validTo))}}function Sr(s,m){if(s&1&&(t(0,"nz-option",44),o(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),r(),C(" ",e.name," ")}}function yr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",44),v(2,"i",45),o(3),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.name)("nzValue",e.id),r(2),L(" ",e.name," $",e.price," ")}}function Dr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",44),v(2,"i",45),o(3),i()()),s&2){let e=m.$implicit;r(),d("nzLabel",e.routeName)("nzValue",e.routeId),r(2),C(" ",e.routeName," ")}}function Er(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td"),o(18),i(),t(19,"td"),o(20),i(),t(21,"td"),o(22),i()()),s&2){let e=m.$implicit,a=u();r(2),g(e.customerName),r(2),g(e.routeName),r(2),g(e.round),r(2),g(e.amountPayment),r(2),g(a.calculatePendingPayment(e)),r(2),g(a.formatPromiseDate(e.promiseDate)),r(2),g(a.calculateDaysDifference(e.promiseDate)),r(2),C(" ",e.name,""),r(2),g(a.formatMeteSacaCortesia(e)),r(2),g(a.formatValidTo(e.validFrom)),r(2),g(a.formatValidTo(e.validTo))}}function Vr(s,m){if(s&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td"),o(18),i(),t(19,"td"),o(20),i(),t(21,"td"),o(22),i()()),s&2){let e=m.$implicit,a=u();r(2),g(e.customerName),r(2),g(e.routeName),r(2),g(e.round),r(2),g(e.amountPayment),r(2),g(a.calculatePendingPayment(e)),r(2),g(a.formatPromiseDate(e.promiseDate)),r(2),g(a.calculateDaysDifference(e.promiseDate)),r(2),C(" ",e.name,""),r(2),g(a.formatMeteSacaCortesia(e)),r(2),g(a.formatValidTo(e.validFrom)),r(2),g(a.formatValidTo(e.validTo))}}function Pr(s,m){if(s&1){let e=x();t(0,"button",22),_("click",function(){h(e);let n=u();return f(n.handleOK())}),o(1,"Aceptar"),i()}}function Tr(s,m){if(s&1&&(t(0,"div")(1,"form",46)(2,"nz-form-item")(3,"nz-form-label",47),o(4,"Empresa:"),i(),t(5,"nz-form-control",47),o(6),i()(),t(7,"nz-form-item")(8,"nz-form-label",47),o(9,"Turno:"),i(),t(10,"nz-form-control",47),o(11),i()(),t(12,"nz-form-item")(13,"nz-form-label",47),o(14,"Operaci\xF3n:"),i(),t(15,"nz-form-control",47),o(16),i()(),t(17,"nz-form-item")(18,"nz-form-label",47),o(19,"Display:"),i(),t(20,"nz-form-control",47),o(21),i()(),t(22,"nz-form-item")(23,"nz-form-label",47),o(24,"Correo:"),i(),t(25,"nz-form-control",47),o(26),i()(),t(27,"nz-form-item")(28,"nz-form-label",47),o(29,"Nombre:"),i(),t(30,"nz-form-control",47),o(31),i()(),t(32,"nz-form-item")(33,"nz-form-label",47),o(34,"Apellidos:"),i(),t(35,"nz-form-control",47),o(36),i()(),t(37,"nz-form-item")(38,"nz-form-label",47),o(39,"Tel\xE9fono:"),i(),t(40,"nz-form-control",47),o(41),i()(),t(42,"nz-form-item")(43,"nz-form-label",47),o(44,"Identificaci\xF3n:"),i(),t(45,"nz-form-control",47),o(46),i()()()()),s&2){let e=u();r(),d("formGroup",e.signupForm),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupForm.get("customerName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupForm.get("defaultRound").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupForm.get("defaultRouteName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupForm.get("displayName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupForm.get("email").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupForm.get("firstName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupForm.get("lastName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupForm.get("phone").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupForm.get("studentId").value)}}function wr(s,m){if(s&1&&(t(0,"div")(1,"form",46)(2,"nz-form-item")(3,"nz-form-label",47),o(4,"Empresa:"),i(),t(5,"nz-form-control",47),o(6),i()(),t(7,"nz-form-item")(8,"nz-form-label",47),o(9,"Turno:"),i(),t(10,"nz-form-control",47),o(11),i()(),t(12,"nz-form-item")(13,"nz-form-label",47),o(14,"Operaci\xF3n:"),i(),t(15,"nz-form-control",47),o(16),i()(),t(17,"nz-form-item")(18,"nz-form-label",47),o(19,"Display:"),i(),t(20,"nz-form-control",47),o(21),i()(),t(22,"nz-form-item")(23,"nz-form-label",47),o(24,"Correo:"),i(),t(25,"nz-form-control",47),o(26),i()(),t(27,"nz-form-item")(28,"nz-form-label",47),o(29,"Nombre:"),i(),t(30,"nz-form-control",47),o(31),i()(),t(32,"nz-form-item")(33,"nz-form-label",47),o(34,"Apellidos:"),i(),t(35,"nz-form-control",47),o(36),i()(),t(37,"nz-form-item")(38,"nz-form-label",47),o(39,"Tel\xE9fono:"),i(),t(40,"nz-form-control",47),o(41),i()(),t(42,"nz-form-item")(43,"nz-form-label",47),o(44,"Identificaci\xF3n:"),i(),t(45,"nz-form-control",47),o(46),i()()()()),s&2){let e=u();r(),d("formGroup",e.signupFormCV),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupFormCV.get("customerName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupFormCV.get("defaultRound").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupFormCV.get("defaultRouteName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupFormCV.get("displayName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupFormCV.get("email").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupFormCV.get("firstName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupFormCV.get("lastName").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupFormCV.get("phone").value),r(2),d("nzSm",6)("nzXs",24),r(2),d("nzSm",14)("nzXs",24),r(),g(e.signupFormCV.get("studentId").value)}}function Ir(s,m){if(s&1){let e=x();t(0,"button",22),_("click",function(){h(e);let n=u();return f(n.handleOK())}),o(1,"Aceptar"),i()}}var qo=(()=>{class s{constructor(e,a,n){this.fb=e,this.msg=a,this.afs=n,this.authService=k(_e),this.usersService=k(Xe),this.usersServices=k(je),this.routesService=k(Ke),this.productsService=k(ot),this.accountsService=k(He),this.stopSubscription$=new te,this.sumOfField=0,this.rowData=[],this.rowDataPay=[],this.rowDataPayTurn=[],this.rowDataPayCV=[],this.rowDataPayCVByR=[],this.TotalUsers=0,this.TotalMPP=0,this.TotalMPByRoute=0,this.usersList=[],this.usersListA=[],this.usersListCV=[],this.routesList=[],this.products=[],this.amountCV=0,this.priceCV=0,this.accountId$=new te,this.productsListV=[],this.shift=[],this.isModalVisible=!1,this.isModalVisibleCV=!1,this.customersList=[],this.checkOptionsOne=[],this.infoSegment=[],this.userCustomerId="",this.validateForm=this.fb.group({id:[null],customerId:[null]}),this.validateFormO=this.fb.group({id:[null],customerId:[null]}),this.validateFormPase=this.fb.group({id:[null],customerId:[null]}),this.validateFormTurn=this.fb.group({id:[null],turno:[""],customerId:[null]}),this.validateFormAnticipos=this.fb.group({id:[null],turno:[""],customerId:[null]}),this.validateFormCV=this.fb.group({id:[null],customerId:[null]}),this.validateFormCVByRoute=this.fb.group({id:[null],routeId:[""],customerId:[null]}),this.signupForm=this.fb.group({id:[],customerName:[""],defaultRound:[""],defaultRouteName:[""],displayName:[""],email:[""],firstName:[""],lastName:[""],phone:[""],studentId:[""]}),this.signupFormCV=this.fb.group({id:[],customerName:[""],defaultRound:[""],defaultRouteName:[""],displayName:[""],email:[""],firstName:[""],lastName:[""],phone:[""],studentId:[""]}),this.shift=[{id:"D\xEDa",name:"D\xEDa"},{id:"Tarde",name:"Tarde"},{id:"Noche",name:"Noche"}],this.validateForm.get("id")?.valueChanges.subscribe(l=>{}),this.authService.user.subscribe(l=>{l&&(this.user=l,this.userCustomerId=this.user.customerId,this.accountsService.getSegmentLevel(this.user.idSegment).pipe(T(c=>{if(c&&c.payload){let p=c.payload.id,y=c.payload.data?c.payload.data():{};return M({id:p},y)}else return console.warn("Unexpected payload structure:",c),{}})).subscribe(c=>{this.infoSegment=c,this.getCustomersList()}))})}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.afs.collection("customers").doc(this.userCustomerId).snapshotChanges().pipe(U(this.stopSubscription$),T(a=>{let n=a.payload.id,l=a.payload.data();return M({id:n},l)}),K(a=>(this.customersList=[a],this.checkOptionsOne=[{value:a.id,label:a.name}],a))).subscribe():this.afs.collection("customers",a=>a.orderBy("name")).snapshotChanges().pipe(U(this.stopSubscription$),T(a=>a.map(n=>{let l=n.payload.doc.id,c=n.payload.doc.data();return M({id:l},c)})),K(a=>(this.customersList=a,this.checkOptionsOne=a.map(n=>({value:n.id,label:n.name})),a))).subscribe()}ngOnInit(){}onFirstDataRendered(e){setTimeout(function(){},0)}ngOnDestroy(){this.stopSubscription$&&(this.stopSubscription$.next(void 0),this.stopSubscription$.complete()),this.productsSubscription&&this.productsSubscription.unsubscribe(),this.accountsSubscription&&this.accountsSubscription.unsubscribe()}getSubscriptionsByRoute(e,a){this.usersService.getBoardingPassesByRoutebyCustomerId(e,a).pipe(U(this.stopSubscription$)).subscribe(n=>{this.rowData=n})}getSubscriptionsByTurn(e,a){this.usersService.getBoardingPassesByTurn(e,a).pipe(U(this.stopSubscription$)).subscribe(n=>{this.rowDataPayTurn=n,this.TotalUsers=this.sumAllPasses(this.rowDataPayTurn)})}sumAllPasses(e){let a=0;return e.forEach(n=>{if(n&&Array.isArray(n.passes)){let l=n.passes.length;a+=n.passes.length}}),a}sumAllCV(e){let a=0;return e.forEach(n=>{n&&Array.isArray(n.passes)&&n.passes.forEach(l=>{this.amountCV=l.amountPayment,this.priceCV=l.amount;let c=this.priceCV-this.amountCV;a+=c})}),a}sumAllCVByR(e){let a=0;return e.forEach(n=>{n&&Array.isArray(n.passes)&&n.passes.forEach(l=>{this.amountCV=l.amountPayment,this.priceCV=l.amount;let c=this.priceCV-this.amountCV;a+=c})}),a}getSubscriptions(e){this.usersService.getBoardingPassesByProduct(e).pipe(U(this.stopSubscription$)).subscribe(a=>{this.rowDataPay=a})}getSubscriptionsPase(e){this.usersService.getBoardingPassesByProduct(e).pipe(U(this.stopSubscription$)).subscribe(a=>{this.createNestedTableData(a)})}getSubscriptionsAnticipos(e){this.usersService.getBoardingPassesByAnticipos(e).pipe(U(this.stopSubscription$)).subscribe(a=>{this.createNestedTableDataA(a)})}getSubscriptionsCV(e){this.usersService.getBoardingPassesByCV(e).pipe(U(this.stopSubscription$)).subscribe(a=>{this.rowDataPayCV=a,this.TotalMPP=this.sumAllCV(this.rowDataPayCV),this.createNestedTableDataCV(a)})}getSubscriptionsCVByRoute(e){this.usersService.getBoardingPassBySingleRoute(e,this.routeIdSelected).pipe(U(this.stopSubscription$)).subscribe(a=>{this.rowDataPayCVByR=a,this.TotalMPByRoute=this.sumAllCVByR(this.rowDataPayCVByR),this.createNestedTableDataCVByRoute(a)})}createNestedTableDataA(e){this.usersListA=[];for(let a=0;a<e.length;++a){e[a].key=a,e[a].expand=!1,e[a].routeName=e[a].passes[0].routeName;for(let n=0;n<e[a].passes.length;++n)e[a].passes[n].key=a,e[a].passes[n].customerName=e[a].customerName,this.usersListA.push(e[a].passes[n])}}createNestedTableDataCV(e){this.usersListCV=[];for(let a=0;a<e.length;++a){e[a].key=a,e[a].expand=!1,e[a].routeName=e[a].passes[0].routeName;for(let n=0;n<e[a].passes.length;++n)e[a].passes[n].key=a,e[a].passes[n].customerName=e[a].customerName,this.usersListCV.push(e[a].passes[n])}}createNestedTableDataCVByRoute(e){this.usersListCVByR=[];for(let a=0;a<e.length;++a){e[a].key=a,e[a].expand=!1,e[a].routeName=e[a].passes[0].routeName;for(let n=0;n<e[a].passes.length;++n)e[a].passes[n].key=a,e[a].passes[n].customerName=e[a].customerName,this.usersListCVByR.push(e[a].passes[n])}if(this.usersListCVByR.length>0){this.usersListCVByRDetalle=[];for(let a of this.usersListCVByR)this.usersService.getUserInfo(a.uid).subscribe(n=>{let l={displayName:n.payload.data().displayName,studentId:n.payload.data().studentId,phone:n.payload.data().phone,email:n.payload.data().email,amountPayment:a.amountPayment,amount:a.amount,promiseDate:a.promiseDate};this.usersListCVByRDetalle.some(p=>p.studentId===n.payload.data().studentId)||this.usersListCVByRDetalle.push(l)})}}createNestedTableData(e){this.routesList=[],this.usersList=[];for(let a=0;a<e.length;++a){e[a].key=a,e[a].expand=!1,e[a].routeName=e[a].passes[0].routeName;for(let n=0;n<e[a].passes.length;++n)e[a].passes[n].key=a,e[a].passes[n].customerName=e[a].customerName,this.usersList.push(e[a].passes[n])}this.routesList=e}onProductSelect(e){}onProductSelectByRoute(e){this.routeIdSelected="",this.routes=[],this.routeSubscription=this.usersService.getBoardingPassRoute(e).pipe(U(this.stopSubscription$)).subscribe(a=>{this.routes=a})}onRouteSelectByRoute(e){this.routeIdSelected=e}submitFormO(){let e=this.validateFormO.controls.customerId.value;this.user.vendorId!=null&&this.getSubscriptionsByRoute(this.user.vendorId,e)}submitForm(){if(this.validateForm.valid){this.rowDataPay=[];let e=this.validateForm.controls.id.value;this.getSubscriptions(e)}else this.sendMessage("error","Forma invalida")}submitFormTurn(){this.rowDataPayTurn=[],this.TotalUsers=0;let e=this.validateFormTurn.controls.id.value,a=this.validateFormTurn.controls.turno.value;this.getSubscriptionsByTurn(e,a)}submitFormPase(){this.rowDataPay=[];let e=this.validateFormPase.controls.id.value;this.getSubscriptionsPase(e)}submitFormAnticipos(){this.usersListA=[];let e=this.validateFormAnticipos.controls.id.value;this.getSubscriptionsAnticipos(e)}submitFormCV(){this.usersListCV=[];let e=this.validateFormCV.controls.id.value;this.TotalMPP=0,this.getSubscriptionsCV(e)}submitFormCVByRoute(){let e=this.validateFormCVByRoute.controls.id.value;this.TotalMPByRoute=0,this.getSubscriptionsCVByRoute(e),this.usersListCVByRDetalle=[],this.FusersListCVByRDetalle=[]}onRowClicked(e){this.accountsSubscription=this.usersService.getUserInfo(e.data.uid).subscribe(a=>{this.signupForm.reset(),this.signupForm.controls.customerName.setValue(a.payload.data().customerName),this.signupForm.controls.defaultRound.setValue(a.payload.data().defaultRound),this.signupForm.controls.defaultRouteName.setValue(a.payload.data().defaultRouteName),this.signupForm.controls.displayName.setValue(a.payload.data().displayName),this.signupForm.controls.email.setValue(a.payload.data().email),this.signupForm.controls.firstName.setValue(a.payload.data().firstName),this.signupForm.controls.lastName.setValue(a.payload.data().lastName),this.signupForm.controls.phone.setValue(a.payload.data().phone),this.signupForm.controls.studentId.setValue(a.payload.data().studentId),this.isModalVisible=!0})}onRowClickedCV(e){this.accountsSubscription=this.usersService.getUserInfo(e.data.uid).subscribe(a=>{this.signupFormCV.reset(),this.signupFormCV.controls.customerName.setValue(a.payload.data().customerName),this.signupFormCV.controls.defaultRound.setValue(a.payload.data().defaultRound),this.signupFormCV.controls.defaultRouteName.setValue(a.payload.data().defaultRouteName),this.signupFormCV.controls.displayName.setValue(a.payload.data().displayName),this.signupFormCV.controls.email.setValue(a.payload.data().email),this.signupFormCV.controls.firstName.setValue(a.payload.data().firstName),this.signupFormCV.controls.lastName.setValue(a.payload.data().lastName),this.signupFormCV.controls.phone.setValue(a.payload.data().phone),this.signupFormCV.controls.studentId.setValue(a.payload.data().studentId),this.isModalVisibleCV=!0})}detalleCVbyR(){this.TotalMPByRoute==0?this.sendMessage("error","Se requiere seleccionar un producto y operaci\xF3n para detallar."):this.FusersListCVByRDetalle=this.usersListCVByRDetalle}sendMessage(e,a){this.msg.create(e,a)}handleOK(){this.isModalVisible=!1,this.isModalVisibleCV=!1}handleCancel(){this.isModalVisible=!1,this.isModalVisibleCV=!1}customCellRenderer(e){return e.data.passes.reduce(l=>l+1,0).toString()}customCellRendererMonto(e){return e.data.passes.reduce((c,p)=>c+p.amount,0).toLocaleString("en-US",{style:"currency",currency:"USD"})}formatPermission(e){return e?"Si":"No"}formatValidTo(e){if(!e)return"";let a=new Date(e.seconds*1e3);return vt(a,"MMMM dd yyyy",{locale:st})}formatMeteSacaCortesia(e){let a=e.isTaskIn?"Si":"No",n=e.isTaskOut?"Si":"No",l=e.is_courtesy?"Si":"No";return`${a} / ${n} / ${l}`}calculateDaysDifference(e){if(!e)return"";let n=e.toDate(),l=new Date,c=n.getTime()-l.getTime();return Math.floor(c/(1e3*60*60*24))+" d\xEDas"}formatPromiseDate(e){if(!e)return"";let a=new Date(e);return vt(a,"MMMM dd yyyy",{locale:st})}calculatePendingPayment(e){return(e.amount-e.amountPayment).toLocaleString("en-US",{style:"currency",currency:"USD"})}log(e){this.sub=this.usersServices.getAccountProducts(e).pipe(T(a=>a.map(n=>{let l=n.payload.doc.id,c=n.payload.doc.data();return Me(M({},c),{id:l})}))).subscribe(a=>{this.products=a,this.products.length===0&&this.sendMessage("error","No hay productos relacionados a este cliente.")})}static{this.\u0275fac=function(a){return new(a||s)(R(pe),R(Z),R(he))}}static{this.\u0275cmp=Y({type:s,selectors:[["ng-component"]],decls:291,vars:55,consts:[["basicTable",""],["basicTable1",""],["basicTable2",""],["basicTable3",""],["basicTable4",""],["basicTable5",""],["basicTable6",""],["modalFooter",""],["modalcontent",""],["modalcontentCV",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],[3,"nzSelectedIndex"],["nzTitle","Pagos Por Producto / Servicio"],[2,"margin-bottom","10px"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],["formControlName","customerId","nzPlaceHolder","Selecciona un cliente",2,"width","650px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","id","nzAllowClear","","nzPlaceHolder","Seleccionar producto / servicio",2,"width","650px",3,"ngModelChange"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["ngSkipHydration","",3,"nzData"],[4,"ngFor","ngForOf"],["nzTitle","Pagos por Operaci\xF3n"],["formControlName","customerId","nzPlaceHolder","Selecciona un cliente",2,"width","650px"],["nzTitle","Pagos por turno"],["id","turn"],["nz-form","","nzLayout","horizontal",1,"horizontal-form",3,"ngSubmit","formGroup"],[1,"form-container"],[1,"form-row"],[1,"form-item"],["formControlName","turno","nzAllowClear","","nzPlaceHolder","Turno",2,"width","100px"],["nzTitle","Pases"],["nzTitle","Anticipos"],["nzTitle","Cartera Vencida"],["nzTitle","Cartera General"],["nzTitle","Cartera Vencida por Operaci\xF3n"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Seleccionar la Operaci\xF3n ",2,"width","450px",3,"ngModelChange"],[2,"margin-top","10px","margin-bottom","10 px"],[2,"margin-top","10px"],["nzTitle","Datos Pase - Anticipo","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzTitle","Datos Pase  - Cartera Vencida","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""],["nz-form","",3,"formGroup"],[3,"nzSm","nzXs"]],template:function(a,n){if(a&1){let l=x();t(0,"div",10)(1,"div",11)(2,"nz-page-header",12)(3,"nz-page-header-title",13),o(4,"Reportes"),i(),t(5,"nz-page-header-subtitle"),o(6,"Reportes General "),i()()(),t(7,"div",14)(8,"nz-tabset",15)(9,"nz-tab",16)(10,"div",17)(11,"form",18),_("ngSubmit",function(){return h(l),f(n.submitForm())}),t(12,"nz-select",19),_("ngModelChange",function(p){return h(l),f(n.log(p))}),z(13,rr,2,3,"nz-option",20),i(),t(14,"nz-select",21),_("ngModelChange",function(p){return h(l),f(n.onProductSelect(p))}),z(15,or,3,4,"nz-option",20),i(),t(16,"button",22),_("click",function(){return h(l),f(n.submitForm())}),o(17,"Aceptar"),i()()(),t(18,"div")(19,"nz-table",23,0)(21,"thead")(22,"tr")(23,"th"),o(24,"Empresa"),i(),t(25,"th"),o(26,"Operaci\xF3n"),i(),t(27,"th"),o(28,"Usuarios"),i(),t(29,"th"),o(30,"Monto"),i(),t(31,"th"),o(32,"Activa"),i()()(),t(33,"tbody"),z(34,sr,11,13,"tr",24),i()()()(),t(35,"nz-tab",25)(36,"div",17)(37,"form",18),_("ngSubmit",function(){return h(l),f(n.submitFormO())}),t(38,"nz-select",26),z(39,lr,2,3,"nz-option",20),i(),t(40,"button",22),_("click",function(){return h(l),f(n.submitFormO())}),o(41,"Aceptar"),i()()(),t(42,"div")(43,"nz-table",23,1)(45,"thead")(46,"tr")(47,"th"),o(48,"Empresa"),i(),t(49,"th"),o(50,"Operaci\xF3n"),i(),t(51,"th"),o(52,"Usuarios"),i(),t(53,"th"),o(54,"Monto"),i(),t(55,"th"),o(56,"Activa"),i()()(),t(57,"tbody"),z(58,dr,11,13,"tr",24),i()()()(),t(59,"nz-tab",27)(60,"div",28)(61,"div",17)(62,"form",29),_("ngSubmit",function(){return h(l),f(n.submitFormTurn())}),t(63,"div",30)(64,"div",31)(65,"div",32)(66,"nz-select",19),_("ngModelChange",function(p){return h(l),f(n.log(p))}),z(67,cr,2,3,"nz-option",20),i()()(),t(68,"div",31)(69,"div",32)(70,"nz-select",21),_("ngModelChange",function(p){return h(l),f(n.onProductSelect(p))}),z(71,mr,4,4,"div",24),i()(),t(72,"div",32)(73,"nz-select",33),z(74,ur,4,3,"div",24),i()(),t(75,"div",32)(76,"button",22),_("click",function(){return h(l),f(n.submitFormTurn())}),o(77,"Aceptar"),i()()()()(),t(78,"div",31),o(79),i()(),t(80,"div")(81,"nz-table",23,2)(83,"thead")(84,"tr")(85,"th"),o(86,"Empresa"),i(),t(87,"th"),o(88,"Operaci\xF3n"),i(),t(89,"th"),o(90,"Usuarios"),i(),t(91,"th"),o(92,"Monto"),i(),t(93,"th"),o(94,"Activa"),i()()(),t(95,"tbody"),z(96,pr,11,13,"tr",24),i()()()()(),t(97,"nz-tab",34)(98,"div",17)(99,"form",18),_("ngSubmit",function(){return h(l),f(n.submitFormPase())}),t(100,"nz-select",19),_("ngModelChange",function(p){return h(l),f(n.log(p))}),z(101,hr,2,3,"nz-option",20),i(),t(102,"nz-select",21),_("ngModelChange",function(p){return h(l),f(n.onProductSelect(p))}),z(103,fr,4,4,"div",24),i(),t(104,"button",22),_("click",function(){return h(l),f(n.submitForm())}),o(105,"Aceptar"),i()()(),t(106,"div")(107,"nz-table",23,3)(109,"thead")(110,"tr")(111,"th"),o(112,"Empresa"),i(),t(113,"th"),o(114,"Operaci\xF3n"),i(),t(115,"th"),o(116,"Turno"),i(),t(117,"th"),o(118,"Estaci\xF3n"),i(),t(119,"th"),o(120,"Pase"),i(),t(121,"th"),o(122,"Mete"),i(),t(123,"th"),o(124,"Saca"),i(),t(125,"th"),o(126,"Pase Cortes\xEDa"),i(),t(127,"th"),o(128,"V\xE1lido desde"),i(),t(129,"th"),o(130,"V\xE1lido hasta"),i()()(),t(131,"tbody"),z(132,_r,21,10,"tr",24),i()()()(),t(133,"nz-tab",35)(134,"div",17)(135,"form",18),_("ngSubmit",function(){return h(l),f(n.submitFormAnticipos())}),t(136,"nz-select",19),_("ngModelChange",function(p){return h(l),f(n.log(p))}),z(137,gr,2,3,"nz-option",20),i(),t(138,"nz-select",21),_("ngModelChange",function(p){return h(l),f(n.onProductSelect(p))}),z(139,zr,4,4,"div",24),i(),t(140,"button",22),_("click",function(){return h(l),f(n.submitFormAnticipos())}),o(141,"Aceptar"),i()()(),t(142,"div")(143,"nz-table",23,3)(145,"thead")(146,"tr")(147,"th"),o(148,"Empresa"),i(),t(149,"th"),o(150,"Operaci\xF3n"),i(),t(151,"th"),o(152,"Turno"),i(),t(153,"th"),o(154,"Monto Anticipo"),i(),t(155,"th"),o(156,"Promesa de Pago"),i(),t(157,"th"),o(158,"D\xEDas vencidos"),i(),t(159,"th"),o(160,"Pase"),i(),t(161,"th"),o(162,"Mete / Saca / Cortes\xEDa"),i(),t(163,"th"),o(164,"V\xE1lido desde"),i(),t(165,"th"),o(166,"V\xE1lido hasta"),i()()(),t(167,"tbody"),z(168,vr,21,10,"tr",24),i()()()(),t(169,"nz-tab",36)(170,"nz-tabset")(171,"nz-tab",37)(172,"div",17)(173,"form",18),_("ngSubmit",function(){return h(l),f(n.submitFormCV())}),t(174,"nz-select",19),_("ngModelChange",function(p){return h(l),f(n.log(p))}),z(175,Cr,2,3,"nz-option",20),i(),t(176,"nz-select",21),_("ngModelChange",function(p){return h(l),f(n.onProductSelect(p))}),z(177,br,4,4,"div",24),i(),t(178,"button",22),_("click",function(){return h(l),f(n.submitFormCV())}),o(179,"Aceptar"),i()(),t(180,"div",31),o(181),A(182,"currency"),i()(),t(183,"div")(184,"nz-table",23,4)(186,"thead")(187,"tr")(188,"th"),o(189,"Empresa"),i(),t(190,"th"),o(191,"Operaci\xF3n"),i(),t(192,"th"),o(193,"Turno"),i(),t(194,"th"),o(195,"Monto Anticipo"),i(),t(196,"th"),o(197,"Pendiente de Pago"),i(),t(198,"th"),o(199,"Promesa de Pago"),i(),t(200,"th"),o(201,"D\xEDas vencidos"),i(),t(202,"th"),o(203,"Pase"),i(),t(204,"th"),o(205,"Mete / Saca / Cortes\xEDa"),i(),t(206,"th"),o(207,"V\xE1lido desde"),i(),t(208,"th"),o(209,"V\xE1lido hasta"),i()()(),t(210,"tbody"),z(211,xr,23,11,"tr",24),i()()()(),t(212,"nz-tab",38)(213,"div",17)(214,"form",18),_("ngSubmit",function(){return h(l),f(n.submitFormCVByRoute())}),t(215,"nz-select",19),_("ngModelChange",function(p){return h(l),f(n.log(p))}),z(216,Sr,2,3,"nz-option",20),i(),t(217,"nz-select",21),_("ngModelChange",function(p){return h(l),f(n.onProductSelectByRoute(p))}),z(218,yr,4,4,"div",24),i(),t(219,"nz-select",39),_("ngModelChange",function(p){return h(l),f(n.onRouteSelectByRoute(p))}),z(220,Dr,4,3,"div",24),i(),t(221,"button",22),_("click",function(){return h(l),f(n.submitFormCVByRoute())}),o(222,"Aceptar"),i()(),t(223,"div",31),o(224),A(225,"currency"),i()(),t(226,"div")(227,"nz-table",23,5)(229,"thead")(230,"tr")(231,"th"),o(232,"Empresa"),i(),t(233,"th"),o(234,"Operaci\xF3n"),i(),t(235,"th"),o(236,"Turno"),i(),t(237,"th"),o(238,"Monto Anticipo"),i(),t(239,"th"),o(240,"Pendiente de Pago"),i(),t(241,"th"),o(242,"Promesa de Pago"),i(),t(243,"th"),o(244,"D\xEDas vencidos"),i(),t(245,"th"),o(246,"Pase"),i(),t(247,"th"),o(248,"Mete / Saca / Cortes\xEDa"),i(),t(249,"th"),o(250,"V\xE1lido desde"),i(),t(251,"th"),o(252,"V\xE1lido hasta"),i()()(),t(253,"tbody"),z(254,Er,23,11,"tr",24),i()()(),t(255,"div",40)(256,"button",22),_("click",function(){return h(l),f(n.detalleCVbyR())}),o(257,"Mostrar Detalle"),i()(),t(258,"div",41)(259,"nz-table",23,6)(261,"thead")(262,"tr")(263,"th"),o(264,"Nombre"),i(),t(265,"th"),o(266,"Identificaci\xF3n"),i(),t(267,"th"),o(268,"Telefono"),i(),t(269,"th"),o(270,"Correo"),i(),t(271,"th"),o(272,"Monto Anticipo"),i(),t(273,"th"),o(274,"Pendiente de Pago"),i(),t(275,"th"),o(276,"Promesa de Pago"),i(),t(277,"th"),o(278,"D\xEDas vencidos"),i()()(),t(279,"tbody"),z(280,Vr,23,11,"tr",24),i()()()()()()()()(),t(281,"nz-modal",42),F("nzVisibleChange",function(p){return h(l),I(n.isModalVisible,p)||(n.isModalVisible=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),z(282,Pr,2,0,"ng-template",null,7,E),i(),z(284,Tr,47,46,"ng-template",null,8,E),t(286,"nz-modal",43),F("nzVisibleChange",function(p){return h(l),I(n.isModalVisibleCV,p)||(n.isModalVisibleCV=p),f(p)}),_("nzOnCancel",function(){return h(l),f(n.handleCancel())}),z(287,wr,47,46,"ng-template",null,9,E)(289,Ir,2,0,"ng-template",null,7,E),i()}if(a&2){let l=b(20),c=b(44),p=b(82),y=b(108),S=b(185),V=b(228),N=b(260),P=b(283),W=b(285),$=b(288);r(2),d("nzGhost",!1),r(6),d("nzSelectedIndex",0),r(3),d("formGroup",n.validateForm),r(2),d("ngForOf",n.customersList),r(2),d("ngForOf",n.products),r(4),d("nzData",n.rowDataPay),r(15),d("ngForOf",l.data),r(3),d("formGroup",n.validateFormO),r(2),d("ngForOf",n.customersList),r(4),d("nzData",n.rowData),r(15),d("ngForOf",c.data),r(4),d("formGroup",n.validateFormTurn),r(5),d("ngForOf",n.customersList),r(4),d("ngForOf",n.products),r(3),d("ngForOf",n.shift),r(5),C(" Usuarios totales: ",n.TotalUsers," "),r(2),d("nzData",n.rowDataPayTurn),r(15),d("ngForOf",p.data),r(3),d("formGroup",n.validateFormPase),r(2),d("ngForOf",n.customersList),r(2),d("ngForOf",n.products),r(4),d("nzData",n.usersList),r(25),d("ngForOf",y.data),r(3),d("formGroup",n.validateFormAnticipos),r(2),d("ngForOf",n.customersList),r(2),d("ngForOf",n.products),r(4),d("nzData",n.usersList),r(25),d("ngForOf",y.data),r(5),d("formGroup",n.validateFormCV),r(2),d("ngForOf",n.customersList),r(2),d("ngForOf",n.products),r(4),C(" Total monto pendiente pago: ",q(182,49,n.TotalMPP,"USD")," "),r(3),d("nzData",n.usersListCV),r(27),d("ngForOf",S.data),r(3),d("formGroup",n.validateFormCVByRoute),r(2),d("ngForOf",n.customersList),r(2),d("ngForOf",n.products),r(2),d("ngForOf",n.routes),r(4),C(" Total monto pendiente pago: ",q(225,52,n.TotalMPByRoute,"USD")," "),r(3),d("nzData",n.usersListCVByR),r(27),d("ngForOf",V.data),r(5),d("nzData",n.FusersListCVByRDetalle),r(21),d("ngForOf",N.data),r(),w("nzVisible",n.isModalVisible),d("nzContent",W)("nzFooter",P),r(5),w("nzVisible",n.isModalVisibleCV),d("nzContent",$)("nzFooter",P)}},dependencies:[se,fe,ze,ge,Ce,ve,be,$e,tt,Ye,Ze,nt,et,it,De,ye,xe,Se,Pe,Ee,Ve,Te,we,ce,le,de,me,ue,Je,Qe,Ae],styles:[".footer[_ngcontent-%COMP%]{height:100%!important;position:absolute;padding:0 25px;display:flex;justify-content:space-between}.body[_ngcontent-%COMP%]{overflow-y:auto;padding:15px 25px;position:relative;width:100%}.horizontal-form[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.form-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.form-item[_ngcontent-%COMP%]{margin-right:10px}"]})}}return s})();var jo=(()=>{class s{static{this.\u0275fac=function(a){return new(a||s)}}static{this.\u0275cmp=Y({type:s,selectors:[["ng-component"]],decls:0,vars:0,template:function(a,n){},encapsulation:2})}}return s})();export{fo as a,Do as b,qo as c,jo as d};
