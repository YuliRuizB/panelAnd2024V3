import './polyfills.server.mjs';
import{$ as me,$c as dl,A as Nt,Aa as wa,Ab as ll,Ac as Pg,B as ga,Ba as ba,C as fg,E as mg,Fa as Tg,G as Vi,Ga as Eg,H as pg,Ia as kn,J as eo,Ja as H,Kb as Kr,Kc as Hg,L as tl,La as Tn,Lb as Qr,Lc as ul,M as gg,Ma as sl,N as va,Na as Ca,O as nl,Oa as Pi,P as vg,Pa as ze,Pc as hl,Q as Ec,Qa as Yr,R as yg,S as _n,Sa as Hi,T as yr,Ta as ol,U as au,Ua as _a,Uc as Bg,V as lt,Va as uu,W as wg,Wa as Rn,Wb as Ig,X as il,Xa as al,Xb as Ag,Ya as wr,_ as bg,a as vr,aa as be,ac as Dg,b as bn,ba as Ce,bd as $n,c as ag,ca as M,cb as Mg,cd as $e,d as ae,da as to,dd as ce,ea as Cg,ed as Ln,fa as rl,fc as io,fd as et,g as cg,ga as Ue,gc as pi,gd as pu,h as J2,ha as $r,hb as no,hc as kg,hd as gu,i as lg,ia as _e,ib as Sa,j as ug,ja as Fe,jb as mi,kb as hu,kc as br,l as Gr,la as cu,lb as du,m as ma,n as Gn,na as Xt,nb as zg,o as kt,oa as _g,oc as bt,p as pa,pa as Sg,q as Je,qb as fu,r as hg,ra as lu,rc as Rg,sa as ya,sb as mu,t as dg,ta as Ve,tb as Mc,ua as Sn,ub as zc,w as Tc,wc as Lg,xb as xg,xc as Vg,yb as Og,z as el,za as Ni,zb as cl,zc as Ng}from"./chunk-WNM5W7LL.mjs";import{d as Cn}from"./chunk-PESVQS5A.mjs";import{A as ml,D as Oc,G as Wg,I as Gg,J as Xr,K as un,a as Fg,d as vu,e as qg,f as xc,l as yu,m as fl,p as Ug,q as jg,s as wu,x as ut,y as ro,z as Bi}from"./chunk-LMEIQMGC.mjs";import{a as wt,b as Li,c as Re,f as T,h as og,i as ou,j as g}from"./chunk-H6KHSOBK.mjs";var Ie=T(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=Kn.DEFAULT_MAX_SEND_MESSAGE_LENGTH=Kn.Propagate=Kn.LogVerbosity=Kn.Status=void 0;var ly=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n}(ly||(Kn.Status=ly={})),uy=function(n){return n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.ERROR=2]="ERROR",n[n.NONE=3]="NONE",n}(uy||(Kn.LogVerbosity=uy={})),hy=function(n){return n[n.DEADLINE=1]="DEADLINE",n[n.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",n[n.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",n[n.CANCELLATION=8]="CANCELLATION",n[n.DEFAULTS=65535]="DEFAULTS",n}(hy||(Kn.Propagate=hy={}));Kn.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;Kn.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var lh=T((lZ,WA)=>{WA.exports={name:"@grpc/grpc-js",version:"1.9.14",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var pt=T(dn=>{"use strict";var uh,hh,dh,fh;Object.defineProperty(dn,"__esModule",{value:!0});dn.isTracerEnabled=dn.trace=dn.log=dn.setLoggerVerbosity=dn.setLogger=dn.getLogger=void 0;var es=Ie(),GA=Re("process"),$A=lh().version,YA={error:(n,...e)=>{console.error("E "+n,...e)},info:(n,...e)=>{console.error("I "+n,...e)},debug:(n,...e)=>{console.error("D "+n,...e)}},uo=YA,Ia=es.LogVerbosity.ERROR,KA=(hh=(uh=process.env.GRPC_NODE_VERBOSITY)!==null&&uh!==void 0?uh:process.env.GRPC_VERBOSITY)!==null&&hh!==void 0?hh:"";switch(KA.toUpperCase()){case"DEBUG":Ia=es.LogVerbosity.DEBUG;break;case"INFO":Ia=es.LogVerbosity.INFO;break;case"ERROR":Ia=es.LogVerbosity.ERROR;break;case"NONE":Ia=es.LogVerbosity.NONE;break;default:}var QA=()=>uo;dn.getLogger=QA;var XA=n=>{uo=n};dn.setLogger=XA;var ZA=n=>{Ia=n};dn.setLoggerVerbosity=ZA;var JA=(n,...e)=>{let t;if(n>=Ia){switch(n){case es.LogVerbosity.DEBUG:t=uo.debug;break;case es.LogVerbosity.INFO:t=uo.info;break;case es.LogVerbosity.ERROR:t=uo.error;break}t||(t=uo.error),t&&t.bind(uo)(...e)}};dn.log=JA;var eD=(fh=(dh=process.env.GRPC_NODE_TRACE)!==null&&dh!==void 0?dh:process.env.GRPC_TRACE)!==null&&fh!==void 0?fh:"",mh=new Set,dy=new Set;for(let n of eD.split(","))n.startsWith("-")?dy.add(n.substring(1)):mh.add(n);var tD=mh.has("all");function nD(n,e,t){fy(e)&&(0,dn.log)(n,new Date().toISOString()+" | v"+$A+" "+GA.pid+" | "+e+" | "+t)}dn.trace=nD;function fy(n){return!dy.has(n)&&(tD||mh.has(n))}dn.isTracerEnabled=fy});var Ul=T(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});Aa.getErrorCode=Aa.getErrorMessage=void 0;function iD(n){return n instanceof Error?n.message:String(n)}Aa.getErrorMessage=iD;function rD(n){return typeof n=="object"&&n!==null&&"code"in n&&typeof n.code=="number"?n.code:null}Aa.getErrorCode=rD});var fn=T(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});Wl.Metadata=void 0;var sD=pt(),oD=Ie(),aD=Ul(),cD=/^[0-9a-z_.-]+$/,lD=/^[ -~]*$/;function uD(n){return cD.test(n)}function hD(n){return lD.test(n)}function py(n){return n.endsWith("-bin")}function dD(n){return!n.startsWith("grpc-")}function jl(n){return n.toLowerCase()}function my(n,e){if(!uD(n))throw new Error('Metadata key "'+n+'" contains illegal characters');if(e!=null)if(py(n)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!hD(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var ph=class n{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){e=jl(e),my(e,t),this.internalRepr.set(e,[t])}add(e,t){e=jl(e),my(e,t);let i=this.internalRepr.get(e);i===void 0?this.internalRepr.set(e,[t]):i.push(t)}remove(e){e=jl(e),this.internalRepr.delete(e)}get(e){return e=jl(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,i]of this.internalRepr)if(i.length>0){let r=i[0];e[t]=Buffer.isBuffer(r)?Buffer.from(r):r}return e}clone(){let e=new n(this.options),t=e.internalRepr;for(let[i,r]of this.internalRepr){let s=r.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);t.set(i,s)}return e}merge(e){for(let[t,i]of e.internalRepr){let r=(this.internalRepr.get(t)||[]).concat(i);this.internalRepr.set(t,r)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,i]of this.internalRepr)e[t]=i.map(fD);return e}toJSON(){let e={};for(let[t,i]of this.internalRepr)e[t]=i;return e}static fromHttp2Headers(e){let t=new n;for(let i of Object.keys(e)){if(i.charAt(0)===":")continue;let r=e[i];try{py(i)?Array.isArray(r)?r.forEach(s=>{t.add(i,Buffer.from(s,"base64"))}):r!==void 0&&(dD(i)?r.split(",").forEach(s=>{t.add(i,Buffer.from(s.trim(),"base64"))}):t.add(i,Buffer.from(r,"base64"))):Array.isArray(r)?r.forEach(s=>{t.add(i,s)}):r!==void 0&&t.add(i,r)}catch(s){let o=`Failed to add metadata entry ${i}: ${r}. ${(0,aD.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,sD.log)(oD.LogVerbosity.ERROR,o)}}return t}};Wl.Metadata=ph;var fD=n=>Buffer.isBuffer(n)?n.toString("base64"):n});var bh=T(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});Gl.CallCredentials=void 0;var wh=fn();function mD(n){return"getRequestHeaders"in n&&typeof n.getRequestHeaders=="function"}var Da=class n{static createFromMetadataGenerator(e){return new vh(e)}static createFromGoogleCredential(e){return n.createFromMetadataGenerator((t,i)=>{let r;mD(e)?r=e.getRequestHeaders(t.service_url):r=new Promise((s,o)=>{e.getRequestMetadata(t.service_url,(a,c)=>{if(a){o(a);return}if(!c){o(new Error("Headers not set by metadata plugin"));return}s(c)})}),r.then(s=>{let o=new wh.Metadata;for(let a of Object.keys(s))o.add(a,s[a]);i(null,o)},s=>{i(s)})})}static createEmpty(){return new yh}};Gl.CallCredentials=Da;var gh=class n extends Da{constructor(e){super(),this.creds=e}generateMetadata(e){return g(this,null,function*(){let t=new wh.Metadata,i=yield Promise.all(this.creds.map(r=>r.generateMetadata(e)));for(let r of i)t.merge(r);return t})}compose(e){return new n(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof n?this.creds.every((t,i)=>t._equals(e.creds[i])):!1}},vh=class n extends Da{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,i)=>{this.metadataGenerator(e,(r,s)=>{s!==void 0?t(s):i(r)})})}compose(e){return new gh([this,e])}_equals(e){return this===e?!0:e instanceof n?this.metadataGenerator===e.metadataGenerator:!1}},yh=class n extends Da{generateMetadata(e){return Promise.resolve(new wh.Metadata)}compose(e){return e}_equals(e){return e instanceof n}}});var _h=T(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});ka.getDefaultRootsData=ka.CIPHER_SUITES=void 0;var pD=Re("fs");ka.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var gy=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,Ch=null;function gD(){return gy?(Ch===null&&(Ch=pD.readFileSync(gy)),Ch):null}ka.getDefaultRootsData=gD});var Kl=T(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0});Yl.ChannelCredentials=void 0;var vD=Re("tls"),yD=bh(),vy=_h();function Sh(n,e){if(n&&!(n instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var Ra=class{constructor(e){this.callCredentials=e||yD.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,i,r){var s;if(Sh(e,"Root certificate"),Sh(t,"Private key"),Sh(i,"Certificate chain"),t&&!i)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&i)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,vD.createSecureContext)({ca:(s=e??(0,vy.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:t??void 0,cert:i??void 0,ciphers:vy.CIPHER_SUITES});return new $l(o,r??{})}static createFromSecureContext(e,t){return new $l(e,t??{})}static createInsecure(){return new Th}};Yl.ChannelCredentials=Ra;var Th=class n extends Ra{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof n}},$l=class n extends Ra{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},t?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){let t=this.callCredentials.compose(e);return new Eh(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},Eh=class n extends Ra{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new n(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var ns=T(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.validateLoadBalancingConfig=en.getFirstUsableConfig=en.isLoadBalancerNameRegistered=en.createLoadBalancer=en.registerDefaultLoadBalancerType=en.registerLoadBalancerType=en.createChildChannelControlHelper=void 0;function wD(n,e){var t,i,r,s,o,a,c,l,u,h;return{createSubchannel:(i=(t=e.createSubchannel)===null||t===void 0?void 0:t.bind(e))!==null&&i!==void 0?i:n.createSubchannel.bind(n),updateState:(s=(r=e.updateState)===null||r===void 0?void 0:r.bind(e))!==null&&s!==void 0?s:n.updateState.bind(n),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:n.requestReresolution.bind(n),addChannelzChild:(l=(c=e.addChannelzChild)===null||c===void 0?void 0:c.bind(e))!==null&&l!==void 0?l:n.addChannelzChild.bind(n),removeChannelzChild:(h=(u=e.removeChannelzChild)===null||u===void 0?void 0:u.bind(e))!==null&&h!==void 0?h:n.removeChannelzChild.bind(n)}}en.createChildChannelControlHelper=wD;var ts={},Mh=null;function bD(n,e,t){ts[n]={LoadBalancer:e,LoadBalancingConfig:t}}en.registerLoadBalancerType=bD;function CD(n){Mh=n}en.registerDefaultLoadBalancerType=CD;function _D(n,e){let t=n.getLoadBalancerName();return t in ts?new ts[t].LoadBalancer(e):null}en.createLoadBalancer=_D;function SD(n){return n in ts}en.isLoadBalancerNameRegistered=SD;function TD(n,e=!1){for(let t of n)if(t.getLoadBalancerName()in ts)return t;return e&&Mh?new ts[Mh].LoadBalancingConfig:null}en.getFirstUsableConfig=TD;function ED(n){if(!(n!==null&&typeof n=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(n);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let t=e[0];if(t in ts)return ts[t].LoadBalancingConfig.createFromJson(n[t]);throw new Error(`Unrecognized load balancing config name ${t}`)}en.validateLoadBalancingConfig=ED});var zh=T(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.extractAndSelectServiceConfig=is.validateServiceConfig=is.validateRetryThrottling=void 0;var MD=Re("os"),Ql=Ie(),zD=ns(),Xl=/^\d+(\.\d{1,9})?s$/,xD="node";function OD(n){if("service"in n&&n.service!==""){if(typeof n.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof n.service}`);if("method"in n&&n.method!==""){if(typeof n.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof n.service}`);return{service:n.service,method:n.method}}else return{service:n.service}}else{if("method"in n&&n.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function ID(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in n)||typeof n.initialBackoff!="string"||!Xl.test(n.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in n)||typeof n.maxBackoff!="string"||!Xl.test(n.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in n)||typeof n.backoffMultiplier!="number"||n.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in n&&Array.isArray(n.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(n.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of n.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(Ql.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(Ql.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:n.maxAttempts,initialBackoff:n.initialBackoff,maxBackoff:n.maxBackoff,backoffMultiplier:n.backoffMultiplier,retryableStatusCodes:n.retryableStatusCodes}}function AD(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in n&&(typeof n.hedgingDelay!="string"||!Xl.test(n.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in n&&Array.isArray(n.nonFatalStatusCodes))for(let t of n.nonFatalStatusCodes)if(typeof t=="number"){if(!Object.values(Ql.Status).includes(t))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof t=="string"){if(!Object.values(Ql.Status).includes(t.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:n.maxAttempts};return n.hedgingDelay&&(e.hedgingDelay=n.hedgingDelay),n.nonFatalStatusCodes&&(e.nonFatalStatusCodes=n.nonFatalStatusCodes),e}function DD(n){var e;let t={name:[]};if(!("name"in n)||!Array.isArray(n.name))throw new Error("Invalid method config: invalid name array");for(let i of n.name)t.name.push(OD(i));if("waitForReady"in n){if(typeof n.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");t.waitForReady=n.waitForReady}if("timeout"in n)if(typeof n.timeout=="object"){if(!("seconds"in n.timeout)||typeof n.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in n.timeout)||typeof n.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");t.timeout=n.timeout}else if(typeof n.timeout=="string"&&Xl.test(n.timeout)){let i=n.timeout.substring(0,n.timeout.length-1).split(".");t.timeout={seconds:i[0]|0,nanos:((e=i[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in n){if(typeof n.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxRequestBytes=n.maxRequestBytes}if("maxResponseBytes"in n){if(typeof n.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxResponseBytes=n.maxResponseBytes}if("retryPolicy"in n){if("hedgingPolicy"in n)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");t.retryPolicy=ID(n.retryPolicy)}else"hedgingPolicy"in n&&(t.hedgingPolicy=AD(n.hedgingPolicy));return t}function yy(n){if(!("maxTokens"in n)||typeof n.maxTokens!="number"||n.maxTokens<=0||n.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in n)||typeof n.tokenRatio!="number"||n.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+n.maxTokens.toFixed(3),tokenRatio:+n.tokenRatio.toFixed(3)}}is.validateRetryThrottling=yy;function wy(n){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in n)if(typeof n.loadBalancingPolicy=="string")e.loadBalancingPolicy=n.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in n)if(Array.isArray(n.loadBalancingConfig))for(let i of n.loadBalancingConfig)e.loadBalancingConfig.push((0,zD.validateLoadBalancingConfig)(i));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in n&&Array.isArray(n.methodConfig))for(let i of n.methodConfig)e.methodConfig.push(DD(i));"retryThrottling"in n&&(e.retryThrottling=yy(n.retryThrottling));let t=[];for(let i of e.methodConfig)for(let r of i.name){for(let s of t)if(r.service===s.service&&r.method===s.method)throw new Error(`Invalid service config: duplicate name ${r.service}/${r.method}`);t.push(r)}return e}is.validateServiceConfig=wy;function kD(n){if(!("serviceConfig"in n))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:wy(n.serviceConfig)};if("clientLanguage"in n)if(Array.isArray(n.clientLanguage)){e.clientLanguage=[];for(let i of n.clientLanguage)if(typeof i=="string")e.clientLanguage.push(i);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in n)if(Array.isArray(n.clientHostname)){e.clientHostname=[];for(let i of n.clientHostname)if(typeof i=="string")e.clientHostname.push(i);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in n)if(typeof n.percentage=="number"&&0<=n.percentage&&n.percentage<=100)e.percentage=n.percentage;else throw new Error("Invalid service config choice: invalid percentage");let t=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let i in n)if(!t.includes(i))throw new Error(`Invalid service config choice: unexpected field ${i}`);return e}function RD(n,e){if(!Array.isArray(n))throw new Error("Invalid service config list");for(let t of n){let i=kD(t);if(!(typeof i.percentage=="number"&&e>i.percentage)){if(Array.isArray(i.clientHostname)){let r=!1;for(let s of i.clientHostname)s===MD.hostname()&&(r=!0);if(!r)continue}if(Array.isArray(i.clientLanguage)){let r=!1;for(let s of i.clientLanguage)s===xD&&(r=!0);if(!r)continue}return i.serviceConfig}}throw new Error("No matching service config found")}function LD(n,e){for(let t of n)if(t.length>0&&t[0].startsWith("grpc_config=")){let i=t.join("").substring(12),r=JSON.parse(i);return RD(r,e)}return null}is.extractAndSelectServiceConfig=LD});var Qn=T(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});Zl.ConnectivityState=void 0;var by=function(n){return n[n.IDLE=0]="IDLE",n[n.CONNECTING=1]="CONNECTING",n[n.READY=2]="READY",n[n.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",n[n.SHUTDOWN=4]="SHUTDOWN",n}(by||(Zl.ConnectivityState=by={}))});var Nn=T(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.uriToString=rs.splitHostPort=rs.parseUri=void 0;var VD=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function ND(n){let e=VD.exec(n);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}rs.parseUri=ND;var Cy=/^\d+$/;function PD(n){if(n.startsWith("[")){let e=n.indexOf("]");if(e===-1)return null;let t=n.substring(1,e);if(t.indexOf(":")===-1)return null;if(n.length>e+1)if(n[e+1]===":"){let i=n.substring(e+2);return Cy.test(i)?{host:t,port:+i}:null}else return null;else return{host:t}}else{let e=n.split(":");return e.length===2?Cy.test(e[1])?{host:e[0],port:+e[1]}:null:{host:n}}}rs.splitHostPort=PD;function HD(n){let e="";return n.scheme!==void 0&&(e+=n.scheme+":"),n.authority!==void 0&&(e+="//"+n.authority+"/"),e+=n.path,e}rs.uriToString=HD});var ji=T(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.mapUriDefaultScheme=Xn.getDefaultAuthority=Xn.createResolver=Xn.registerDefaultScheme=Xn.registerResolver=void 0;var Oh=Nn(),La={},xh=null;function BD(n,e){La[n]=e}Xn.registerResolver=BD;function FD(n){xh=n}Xn.registerDefaultScheme=FD;function qD(n,e,t){if(n.scheme!==void 0&&n.scheme in La)return new La[n.scheme](n,e,t);throw new Error(`No resolver could be created for target ${(0,Oh.uriToString)(n)}`)}Xn.createResolver=qD;function UD(n){if(n.scheme!==void 0&&n.scheme in La)return La[n.scheme].getDefaultAuthority(n);throw new Error(`Invalid target ${(0,Oh.uriToString)(n)}`)}Xn.getDefaultAuthority=UD;function jD(n){return n.scheme===void 0||!(n.scheme in La)?xh!==null?{scheme:xh,authority:void 0,path:(0,Oh.uriToString)(n)}:null:n}Xn.mapUriDefaultScheme=jD});var os=T(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.QueuePicker=ss.UnavailablePicker=ss.PickResultType=void 0;var WD=fn(),GD=Ie(),Jl=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.QUEUE=1]="QUEUE",n[n.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",n[n.DROP=3]="DROP",n}(Jl||(ss.PickResultType=Jl={})),Ih=class{constructor(e){this.status=Object.assign({code:GD.Status.UNAVAILABLE,details:"No connection established",metadata:new WD.Metadata},e)}pick(e){return{pickResultType:Jl.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};ss.UnavailablePicker=Ih;var Ah=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:Jl.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};ss.QueuePicker=Ah});var Zc=T(e3=>{"use strict";Object.defineProperty(e3,"__esModule",{value:!0});e3.BackoffTimeout=void 0;var $D=1e3,YD=1.6,KD=12e4,QD=.2;function XD(n,e){return Math.random()*(e-n)+n}var Dh=class{constructor(e,t){this.callback=e,this.initialDelay=$D,this.multiplier=YD,this.maxDelay=KD,this.jitter=QD,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,i;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(i=(t=this.timerId).unref)===null||i===void 0||i.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+XD(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,(t=(e=this.timerId).ref)===null||t===void 0||t.call(e)}unref(){var e,t;this.hasRef=!1,(t=(e=this.timerId).unref)===null||t===void 0||t.call(e)}getEndTime(){return this.endTime}};e3.BackoffTimeout=Dh});var n3=T(t3=>{"use strict";Object.defineProperty(t3,"__esModule",{value:!0});t3.ChildLoadBalancerHandler=void 0;var ZD=ns(),JD=Qn(),ek="child_load_balancer_helper",kh=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,i){return this.parent.channelControlHelper.createSubchannel(t,i)}updateState(t,i){var r;if(this.calledByPendingChild()){if(t===JD.ConnectivityState.CONNECTING)return;(r=this.parent.currentChild)===null||r===void 0||r.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,i)}requestReresolution(){var t;let i=(t=this.parent.pendingChild)!==null&&t!==void 0?t:this.parent.currentChild;this.child===i&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,i){let r;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let s=new this.ChildPolicyHelper(this),o=(0,ZD.createLoadBalancer)(t,s);s.setChild(o),this.currentChild===null?(this.currentChild=o,r=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,r=this.pendingChild)}else this.pendingChild===null?r=this.currentChild:r=this.pendingChild;this.latestConfig=t,r.updateAddressList(e,t,i)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return ek}};t3.ChildLoadBalancerHandler=kh});var Sy=T(i3=>{"use strict";Object.defineProperty(i3,"__esModule",{value:!0});i3.ResolvingLoadBalancer=void 0;var tk=ns(),nk=zh(),En=Qn(),ik=ji(),Va=os(),rk=Zc(),Rh=Ie(),sk=fn(),ok=pt(),ak=Ie(),ck=Nn(),lk=n3(),uk="resolving_load_balancer";function _y(n){ok.trace(ak.LogVerbosity.DEBUG,uk,n)}var hk=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function dk(n,e,t,i){for(let r of t.name)switch(i){case"EMPTY":if(!r.service&&!r.method)return!0;break;case"SERVICE":if(r.service===n&&!r.method)return!0;break;case"SERVICE_AND_METHOD":if(r.service===n&&r.method===e)return!0}return!1}function fk(n,e,t,i){for(let r of t)if(dk(n,e,r,i))return r;return null}function mk(n){return function(t,i){var r,s;let o=t.split("/").filter(l=>l.length>0),a=(r=o[0])!==null&&r!==void 0?r:"",c=(s=o[1])!==null&&s!==void 0?s:"";if(n&&n.methodConfig)for(let l of hk){let u=fk(a,c,n.methodConfig,l);if(u)return{methodConfig:u,pickInformation:{},status:Rh.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:Rh.Status.OK,dynamicFilterFactories:[]}}}var Lh=class{constructor(e,t,i,r,s){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=r,this.onFailedResolution=s,this.latestChildState=En.ConnectivityState.IDLE,this.latestChildPicker=new Va.QueuePicker(this),this.currentState=En.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,i["grpc.service_config"]?this.defaultServiceConfig=(0,nk.validateServiceConfig)(JSON.parse(i["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(En.ConnectivityState.IDLE,new Va.QueuePicker(this)),this.childLoadBalancer=new lk.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(_y("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,c)=>{this.latestChildState=a,this.latestChildPicker=c,this.updateState(a,c)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,ik.createResolver)(e,{onSuccessfulResolution:(a,c,l,u,h)=>{var d;this.backoffTimeout.stop(),this.backoffTimeout.reset();let m=null;c===null?l===null?(this.previousServiceConfig=null,m=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(l):m=this.previousServiceConfig:(m=c,this.previousServiceConfig=c);let p=(d=m?.loadBalancingConfig)!==null&&d!==void 0?d:[],v=(0,tk.getFirstUsableConfig)(p,!0);if(v===null){this.handleResolutionFailure({code:Rh.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new sk.Metadata});return}this.childLoadBalancer.updateAddressList(a,v,h);let w=m??this.defaultServiceConfig;this.onSuccessfulResolution(w,u??mk(w))},onError:a=>{this.handleResolutionFailure(a)}},i);let o={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new rk.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===En.ConnectivityState.IDLE&&this.updateState(En.ConnectivityState.CONNECTING,new Va.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){_y((0,ck.uriToString)(this.target)+" "+En.ConnectivityState[this.currentState]+" -> "+En.ConnectivityState[e]),e===En.ConnectivityState.IDLE&&(t=new Va.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===En.ConnectivityState.IDLE&&(this.updateState(En.ConnectivityState.TRANSIENT_FAILURE,new Va.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===En.ConnectivityState.IDLE||this.currentState===En.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=En.ConnectivityState.IDLE,this.latestChildPicker=new Va.QueuePicker(this),this.currentState=En.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};i3.ResolvingLoadBalancer=Lh});var Ty=T(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.channelOptionsEqual=Na.recognizedOptions=void 0;Na.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function pk(n,e){let t=Object.keys(n).sort(),i=Object.keys(e).sort();if(t.length!==i.length)return!1;for(let r=0;r<t.length;r+=1)if(t[r]!==i[r]||n[t[r]]!==e[i[r]])return!1;return!0}Na.channelOptionsEqual=pk});var Gi=T(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});Wi.stringToSubchannelAddress=Wi.subchannelAddressToString=Wi.subchannelAddressEqual=Wi.isTcpSubchannelAddress=void 0;var gk=Re("net");function Jc(n){return"port"in n}Wi.isTcpSubchannelAddress=Jc;function vk(n,e){return!n&&!e?!0:!n||!e?!1:Jc(n)?Jc(e)&&n.host===e.host&&n.port===e.port:!Jc(e)&&n.path===e.path}Wi.subchannelAddressEqual=vk;function yk(n){return Jc(n)?n.host+":"+n.port:n.path}Wi.subchannelAddressToString=yk;var wk=443;function bk(n,e){return(0,gk.isIP)(n)?{host:n,port:e??wk}:{path:n}}Wi.stringToSubchannelAddress=bk});var r3=T(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});Pa.addAdminServicesToServer=Pa.registerAdminService=void 0;var Ey=[];function Ck(n,e){Ey.push({getServiceDefinition:n,getHandlers:e})}Pa.registerAdminService=Ck;function _k(n){for(let{getServiceDefinition:e,getHandlers:t}of Ey)n.addService(e(),t())}Pa.addAdminServicesToServer=_k});var My=T(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:!0});Zn.ClientDuplexStreamImpl=Zn.ClientWritableStreamImpl=Zn.ClientReadableStreamImpl=Zn.ClientUnaryCallImpl=Zn.callErrorFromStatus=void 0;var Sk=Re("events"),Bh=Re("stream"),e4=Ie();function Tk(n,e){let t=`${n.code} ${e4.Status[n.code]}: ${n.details}`,r=`${new Error(t).stack}
for call at
${e}`;return Object.assign(new Error(t),n,{stack:r})}Zn.callErrorFromStatus=Tk;var Vh=class extends Sk.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(e4.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}};Zn.ClientUnaryCallImpl=Vh;var Nh=class extends Bh.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(e4.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}};Zn.ClientReadableStreamImpl=Nh;var Ph=class extends Bh.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(e4.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,i){var r;let s={callback:i},o=Number(t);Number.isNaN(o)||(s.flags=o),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};Zn.ClientWritableStreamImpl=Ph;var Hh=class extends Bh.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(e4.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}_write(e,t,i){var r;let s={callback:i},o=Number(t);Number.isNaN(o)||(s.flags=o),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};Zn.ClientDuplexStreamImpl=Hh});var zy=T(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});Ha.InterceptingListenerImpl=Ha.isInterceptingListener=void 0;function Ek(n){return n.onReceiveMetadata!==void 0&&n.onReceiveMetadata.length===1}Ha.isInterceptingListener=Ek;var Fh=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,t=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(t),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,t=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=t,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(t),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,t=>{this.processingMetadata||this.processingMessage?this.pendingStatus=t:this.nextListener.onReceiveStatus(t)})}};Ha.InterceptingListenerImpl=Fh});var Yh=T(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});Jn.getInterceptingCall=Jn.InterceptingCall=Jn.RequesterBuilder=Jn.ListenerBuilder=Jn.InterceptorConfigurationError=void 0;var Mk=fn(),xy=zy(),Oy=Ie(),Iy=Ul(),n4=class n extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,n)}};Jn.InterceptorConfigurationError=n4;var Uh=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};Jn.ListenerBuilder=Uh;var jh=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};Jn.RequesterBuilder=jh;var qh={onReceiveMetadata:(n,e)=>{e(n)},onReceiveMessage:(n,e)=>{e(n)},onReceiveStatus:(n,e)=>{e(n)}},t4={start:(n,e,t)=>{t(n,e)},sendMessage:(n,e)=>{e(n)},halfClose:n=>{n()},cancel:n=>{n()}},Wh=class{constructor(e,t){var i,r,s,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:(i=t.start)!==null&&i!==void 0?i:t4.start,sendMessage:(r=t.sendMessage)!==null&&r!==void 0?r:t4.sendMessage,halfClose:(s=t.halfClose)!==null&&s!==void 0?s:t4.halfClose,cancel:(o=t.cancel)!==null&&o!==void 0?o:t4.cancel}:this.requester=t4}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var i,r,s,o,a,c;let l={onReceiveMetadata:(r=(i=t?.onReceiveMetadata)===null||i===void 0?void 0:i.bind(t))!==null&&r!==void 0?r:u=>{},onReceiveMessage:(o=(s=t?.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&o!==void 0?o:u=>{},onReceiveStatus:(c=(a=t?.onReceiveStatus)===null||a===void 0?void 0:a.bind(t))!==null&&c!==void 0?c:u=>{}};this.processingMetadata=!0,this.requester.start(e,l,(u,h)=>{var d,m,p;this.processingMetadata=!1;let v;if((0,xy.isInterceptingListener)(h))v=h;else{let w={onReceiveMetadata:(d=h.onReceiveMetadata)!==null&&d!==void 0?d:qh.onReceiveMetadata,onReceiveMessage:(m=h.onReceiveMessage)!==null&&m!==void 0?m:qh.onReceiveMessage,onReceiveStatus:(p=h.onReceiveStatus)!==null&&p!==void 0?p:qh.onReceiveStatus};v=new xy.InterceptingListenerImpl(w,l)}this.nextCall.start(u,v),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,i=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,i),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};Jn.InterceptingCall=Wh;function zk(n,e,t){var i,r;let s=(i=t.deadline)!==null&&i!==void 0?i:1/0,o=t.host,a=(r=t.parent)!==null&&r!==void 0?r:null,c=t.propagate_flags,l=t.credentials,u=n.createCall(e,s,o,a,c);return l&&u.setCredentials(l),u}var s3=class{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let i;try{i=this.methodDefinition.requestSerialize(t)}catch(r){this.call.cancelWithStatus(Oy.Status.INTERNAL,`Request message serialization failure: ${(0,Iy.getErrorMessage)(r)}`);return}this.call.sendMessageWithContext(e,i)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let i=null;this.call.start(e,{onReceiveMetadata:r=>{var s;(s=t?.onReceiveMetadata)===null||s===void 0||s.call(t,r)},onReceiveMessage:r=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(r)}catch(a){i={code:Oy.Status.INTERNAL,details:`Response message parsing error: ${(0,Iy.getErrorMessage)(a)}`,metadata:new Mk.Metadata},this.call.cancelWithStatus(i.code,i.details);return}(s=t?.onReceiveMessage)===null||s===void 0||s.call(t,o)},onReceiveStatus:r=>{var s,o;i?(s=t?.onReceiveStatus)===null||s===void 0||s.call(t,i):(o=t?.onReceiveStatus)===null||o===void 0||o.call(t,r)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},Gh=class extends s3{constructor(e,t){super(e,t)}start(e,t){var i,r;let s=!1,o={onReceiveMetadata:(r=(i=t?.onReceiveMetadata)===null||i===void 0?void 0:i.bind(t))!==null&&r!==void 0?r:a=>{},onReceiveMessage:a=>{var c;s=!0,(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,a)},onReceiveStatus:a=>{var c,l;s||(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,null),(l=t?.onReceiveStatus)===null||l===void 0||l.call(t,a)}};super.start(e,o),this.call.startRead()}},$h=class extends s3{};function xk(n,e,t){let i=zk(n,t.path,e);return t.responseStream?new $h(i,t):new Gh(i,t)}function Ok(n,e,t,i){if(n.clientInterceptors.length>0&&n.clientInterceptorProviders.length>0)throw new n4("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(n.callInterceptors.length>0&&n.callInterceptorProviders.length>0)throw new n4("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let r=[];n.callInterceptors.length>0||n.callInterceptorProviders.length>0?r=[].concat(n.callInterceptors,n.callInterceptorProviders.map(a=>a(e))).filter(a=>a):r=[].concat(n.clientInterceptors,n.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let s=Object.assign({},t,{method_definition:e});return r.reduceRight((a,c)=>l=>c(l,a),a=>xk(i,a,e))(s)}Jn.getInterceptingCall=Ok});var Xh=T(a3=>{"use strict";Object.defineProperty(a3,"__esModule",{value:!0});a3.Client=void 0;var $i=My(),Ik=Zh(),Ak=Qn(),as=Ie(),Ba=fn(),o3=Yh(),yi=Symbol(),Fa=Symbol(),qa=Symbol(),Sr=Symbol();function Kh(n){return typeof n=="function"}function Ua(n){return n.stack.split(`
`).slice(1).join(`
`)}var Qh=class{constructor(e,t,i={}){var r,s;if(i=Object.assign({},i),this[Fa]=(r=i.interceptors)!==null&&r!==void 0?r:[],delete i.interceptors,this[qa]=(s=i.interceptor_providers)!==null&&s!==void 0?s:[],delete i.interceptor_providers,this[Fa].length>0&&this[qa].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[Sr]=i.callInvocationTransformer,delete i.callInvocationTransformer,i.channelOverride)this[yi]=i.channelOverride;else if(i.channelFactoryOverride){let o=i.channelFactoryOverride;delete i.channelFactoryOverride,this[yi]=o(e,t,i)}else this[yi]=new Ik.ChannelImplementation(e,t,i)}close(){this[yi].close()}getChannel(){return this[yi]}waitForReady(e,t){let i=r=>{if(r){t(new Error("Failed to connect before the deadline"));return}let s;try{s=this[yi].getConnectivityState(!0)}catch{t(new Error("The channel has been closed"));return}if(s===Ak.ConnectivityState.READY)t();else try{this[yi].watchConnectivityState(s,e,i)}catch{t(new Error("The channel has been closed"))}};setImmediate(i)}checkOptionalUnaryResponseArguments(e,t,i){if(Kh(e))return{metadata:new Ba.Metadata,options:{},callback:e};if(Kh(t))return e instanceof Ba.Metadata?{metadata:e,options:{},callback:t}:{metadata:new Ba.Metadata,options:e,callback:t};if(!(e instanceof Ba.Metadata&&t instanceof Object&&Kh(i)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:i}}makeUnaryRequest(e,t,i,r,s,o,a){var c,l;let u=this.checkOptionalUnaryResponseArguments(s,o,a),h={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:i},d={argument:r,metadata:u.metadata,call:new $i.ClientUnaryCallImpl,channel:this[yi],methodDefinition:h,callOptions:u.options,callback:u.callback};this[Sr]&&(d=this[Sr](d));let m=d.call,p={clientInterceptors:this[Fa],clientInterceptorProviders:this[qa],callInterceptors:(c=d.callOptions.interceptors)!==null&&c!==void 0?c:[],callInterceptorProviders:(l=d.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},v=(0,o3.getInterceptingCall)(p,d.methodDefinition,d.callOptions,d.channel);m.call=v;let w=null,A=!1,_=new Error;return v.start(d.metadata,{onReceiveMetadata:k=>{m.emit("metadata",k)},onReceiveMessage(k){w!==null&&v.cancelWithStatus(as.Status.INTERNAL,"Too many responses received"),w=k},onReceiveStatus(k){if(!A){if(A=!0,k.code===as.Status.OK)if(w===null){let R=Ua(_);d.callback((0,$i.callErrorFromStatus)({code:as.Status.INTERNAL,details:"No message received",metadata:k.metadata},R))}else d.callback(null,w);else{let R=Ua(_);d.callback((0,$i.callErrorFromStatus)(k,R))}_=null,m.emit("status",k)}}}),v.sendMessage(r),v.halfClose(),m}makeClientStreamRequest(e,t,i,r,s,o){var a,c;let l=this.checkOptionalUnaryResponseArguments(r,s,o),u={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:i},h={metadata:l.metadata,call:new $i.ClientWritableStreamImpl(t),channel:this[yi],methodDefinition:u,callOptions:l.options,callback:l.callback};this[Sr]&&(h=this[Sr](h));let d=h.call,m={clientInterceptors:this[Fa],clientInterceptorProviders:this[qa],callInterceptors:(a=h.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=h.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},p=(0,o3.getInterceptingCall)(m,h.methodDefinition,h.callOptions,h.channel);d.call=p;let v=null,w=!1,A=new Error;return p.start(h.metadata,{onReceiveMetadata:_=>{d.emit("metadata",_)},onReceiveMessage(_){v!==null&&p.cancelWithStatus(as.Status.INTERNAL,"Too many responses received"),v=_},onReceiveStatus(_){if(!w){if(w=!0,_.code===as.Status.OK)if(v===null){let k=Ua(A);h.callback((0,$i.callErrorFromStatus)({code:as.Status.INTERNAL,details:"No message received",metadata:_.metadata},k))}else h.callback(null,v);else{let k=Ua(A);h.callback((0,$i.callErrorFromStatus)(_,k))}A=null,d.emit("status",_)}}}),d}checkMetadataAndOptions(e,t){let i,r;return e instanceof Ba.Metadata?(i=e,t?r=t:r={}):(e?r=e:r={},i=new Ba.Metadata),{metadata:i,options:r}}makeServerStreamRequest(e,t,i,r,s,o){var a,c;let l=this.checkMetadataAndOptions(s,o),u={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:i},h={argument:r,metadata:l.metadata,call:new $i.ClientReadableStreamImpl(i),channel:this[yi],methodDefinition:u,callOptions:l.options};this[Sr]&&(h=this[Sr](h));let d=h.call,m={clientInterceptors:this[Fa],clientInterceptorProviders:this[qa],callInterceptors:(a=h.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=h.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},p=(0,o3.getInterceptingCall)(m,h.methodDefinition,h.callOptions,h.channel);d.call=p;let v=!1,w=new Error;return p.start(h.metadata,{onReceiveMetadata(A){d.emit("metadata",A)},onReceiveMessage(A){d.push(A)},onReceiveStatus(A){if(!v){if(v=!0,d.push(null),A.code!==as.Status.OK){let _=Ua(w);d.emit("error",(0,$i.callErrorFromStatus)(A,_))}w=null,d.emit("status",A)}}}),p.sendMessage(r),p.halfClose(),d}makeBidiStreamRequest(e,t,i,r,s){var o,a;let c=this.checkMetadataAndOptions(r,s),l={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:i},u={metadata:c.metadata,call:new $i.ClientDuplexStreamImpl(t,i),channel:this[yi],methodDefinition:l,callOptions:c.options};this[Sr]&&(u=this[Sr](u));let h=u.call,d={clientInterceptors:this[Fa],clientInterceptorProviders:this[qa],callInterceptors:(o=u.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=u.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},m=(0,o3.getInterceptingCall)(d,u.methodDefinition,u.callOptions,u.channel);h.call=m;let p=!1,v=new Error;return m.start(u.metadata,{onReceiveMetadata(w){h.emit("metadata",w)},onReceiveMessage(w){h.push(w)},onReceiveStatus(w){if(!p){if(p=!0,h.push(null),w.code!==as.Status.OK){let A=Ua(v);h.emit("error",(0,$i.callErrorFromStatus)(w,A))}v=null,h.emit("status",w)}}}),h}};a3.Client=Qh});var ed=T(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});ja.loadPackageDefinition=ja.makeClientConstructor=void 0;var i4=Xh(),Dk={unary:i4.Client.prototype.makeUnaryRequest,server_stream:i4.Client.prototype.makeServerStreamRequest,client_stream:i4.Client.prototype.makeClientStreamRequest,bidi:i4.Client.prototype.makeBidiStreamRequest};function Jh(n){return["__proto__","prototype","constructor"].includes(n)}function Ay(n,e,t){t||(t={});class i extends i4.Client{}return Object.keys(n).forEach(r=>{if(Jh(r))return;let s=n[r],o;if(typeof r=="string"&&r.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?o="bidi":o="client_stream":s.responseStream?o="server_stream":o="unary";let a=s.requestSerialize,c=s.responseDeserialize,l=kk(Dk[o],s.path,a,c);i.prototype[r]=l,Object.assign(i.prototype[r],s),s.originalName&&!Jh(s.originalName)&&(i.prototype[s.originalName]=i.prototype[r])}),i.service=n,i.serviceName=e,i}ja.makeClientConstructor=Ay;function kk(n,e,t,i){return function(...r){return n.call(this,e,t,i,...r)}}function Rk(n){return"format"in n}function Lk(n){let e={};for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let i=n[t],r=t.split(".");if(r.some(a=>Jh(a)))continue;let s=r[r.length-1],o=e;for(let a of r.slice(0,-1))o[a]||(o[a]={}),o=o[a];Rk(i)?o[s]=i:o[s]=Ay(i,s,{})}return e}ja.loadPackageDefinition=Lk});var nw=T((LZ,tw)=>{"use strict";var Vk=1/0,Nk="[object Symbol]",Pk=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Hk=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,l3="\\ud800-\\udfff",Hy="\\u0300-\\u036f\\ufe20-\\ufe23",By="\\u20d0-\\u20f0",Fy="\\u2700-\\u27bf",qy="a-z\\xdf-\\xf6\\xf8-\\xff",Bk="\\xac\\xb1\\xd7\\xf7",Fk="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",qk="\\u2000-\\u206f",Uk=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Uy="A-Z\\xc0-\\xd6\\xd8-\\xde",jy="\\ufe0e\\ufe0f",Wy=Bk+Fk+qk+Uk,nd="['\u2019]",jk="["+l3+"]",Dy="["+Wy+"]",c3="["+Hy+By+"]",Gy="\\d+",Wk="["+Fy+"]",$y="["+qy+"]",Yy="[^"+l3+Wy+Gy+Fy+qy+Uy+"]",td="\\ud83c[\\udffb-\\udfff]",Gk="(?:"+c3+"|"+td+")",Ky="[^"+l3+"]",id="(?:\\ud83c[\\udde6-\\uddff]){2}",rd="[\\ud800-\\udbff][\\udc00-\\udfff]",Wa="["+Uy+"]",Qy="\\u200d",ky="(?:"+$y+"|"+Yy+")",$k="(?:"+Wa+"|"+Yy+")",Ry="(?:"+nd+"(?:d|ll|m|re|s|t|ve))?",Ly="(?:"+nd+"(?:D|LL|M|RE|S|T|VE))?",Xy=Gk+"?",Zy="["+jy+"]?",Yk="(?:"+Qy+"(?:"+[Ky,id,rd].join("|")+")"+Zy+Xy+")*",Jy=Zy+Xy+Yk,Kk="(?:"+[Wk,id,rd].join("|")+")"+Jy,Qk="(?:"+[Ky+c3+"?",c3,id,rd,jk].join("|")+")",Xk=RegExp(nd,"g"),Zk=RegExp(c3,"g"),Jk=RegExp(td+"(?="+td+")|"+Qk+Jy,"g"),eR=RegExp([Wa+"?"+$y+"+"+Ry+"(?="+[Dy,Wa,"$"].join("|")+")",$k+"+"+Ly+"(?="+[Dy,Wa+ky,"$"].join("|")+")",Wa+"?"+ky+"+"+Ry,Wa+"+"+Ly,Gy,Kk].join("|"),"g"),tR=RegExp("["+Qy+l3+Hy+By+jy+"]"),nR=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,iR={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},rR=typeof global=="object"&&global&&global.Object===Object&&global,sR=typeof self=="object"&&self&&self.Object===Object&&self,oR=rR||sR||Function("return this")();function aR(n,e,t,i){var r=-1,s=n?n.length:0;for(i&&s&&(t=n[++r]);++r<s;)t=e(t,n[r],r,n);return t}function cR(n){return n.split("")}function lR(n){return n.match(Pk)||[]}function uR(n){return function(e){return n?.[e]}}var hR=uR(iR);function ew(n){return tR.test(n)}function dR(n){return nR.test(n)}function fR(n){return ew(n)?mR(n):cR(n)}function mR(n){return n.match(Jk)||[]}function pR(n){return n.match(eR)||[]}var gR=Object.prototype,vR=gR.toString,Vy=oR.Symbol,Ny=Vy?Vy.prototype:void 0,Py=Ny?Ny.toString:void 0;function yR(n,e,t){var i=-1,r=n.length;e<0&&(e=-e>r?0:r+e),t=t>r?r:t,t<0&&(t+=r),r=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=n[i+e];return s}function wR(n){if(typeof n=="string")return n;if(TR(n))return Py?Py.call(n):"";var e=n+"";return e=="0"&&1/n==-Vk?"-0":e}function bR(n,e,t){var i=n.length;return t=t===void 0?i:t,!e&&t>=i?n:yR(n,e,t)}function CR(n){return function(e){e=u3(e);var t=ew(e)?fR(e):void 0,i=t?t[0]:e.charAt(0),r=t?bR(t,1).join(""):e.slice(1);return i[n]()+r}}function _R(n){return function(e){return aR(OR(zR(e).replace(Xk,"")),n,"")}}function SR(n){return!!n&&typeof n=="object"}function TR(n){return typeof n=="symbol"||SR(n)&&vR.call(n)==Nk}function u3(n){return n==null?"":wR(n)}var ER=_R(function(n,e,t){return e=e.toLowerCase(),n+(t?MR(e):e)});function MR(n){return xR(u3(n).toLowerCase())}function zR(n){return n=u3(n),n&&n.replace(Hk,hR).replace(Zk,"")}var xR=CR("toUpperCase");function OR(n,e,t){return n=u3(n),e=t?void 0:e,e===void 0?dR(n)?pR(n):lR(n):n.match(e)||[]}tw.exports=ER});var sd=T((VZ,iw)=>{"use strict";iw.exports=IR;function IR(n,e){for(var t=new Array(arguments.length-1),i=0,r=2,s=!0;r<arguments.length;)t[i++]=arguments[r++];return new Promise(function(a,c){t[i]=function(u){if(s)if(s=!1,u)c(u);else{for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d++]=arguments[d];a.apply(null,h)}};try{n.apply(e||null,t)}catch(l){s&&(s=!1,c(l))}})}});var aw=T(ow=>{"use strict";var h3=ow;h3.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&e.charAt(t)==="=";)++i;return Math.ceil(e.length*3)/4-i};var Ga=new Array(64),sw=new Array(123);for(wi=0;wi<64;)sw[Ga[wi]=wi<26?wi+65:wi<52?wi+71:wi<62?wi-4:wi-59|43]=wi++;var wi;h3.encode=function(e,t,i){for(var r=null,s=[],o=0,a=0,c;t<i;){var l=e[t++];switch(a){case 0:s[o++]=Ga[l>>2],c=(l&3)<<4,a=1;break;case 1:s[o++]=Ga[c|l>>4],c=(l&15)<<2,a=2;break;case 2:s[o++]=Ga[c|l>>6],s[o++]=Ga[l&63],a=0;break}o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Ga[c],s[o++]=61,a===1&&(s[o++]=61)),r?(o&&r.push(String.fromCharCode.apply(String,s.slice(0,o))),r.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var rw="invalid encoding";h3.decode=function(e,t,i){for(var r=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=sw[c])===void 0)throw Error(rw);switch(s){case 0:o=c,s=1;break;case 1:t[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(rw);return i-r};h3.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var lw=T((PZ,cw)=>{"use strict";cw.exports=d3;function d3(){this._listeners={}}d3.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};d3.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],r=0;r<i.length;)i[r].fn===t?i.splice(r,1):++r;return this};d3.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],r=1;r<arguments.length;)i.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,i)}return this}});var gw=T((HZ,pw)=>{"use strict";pw.exports=uw(uw);function uw(n){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function r(c,l,u){e[0]=c,l[u]=t[0],l[u+1]=t[1],l[u+2]=t[2],l[u+3]=t[3]}function s(c,l,u){e[0]=c,l[u]=t[3],l[u+1]=t[2],l[u+2]=t[1],l[u+3]=t[0]}n.writeFloatLE=i?r:s,n.writeFloatBE=i?s:r;function o(c,l){return t[0]=c[l],t[1]=c[l+1],t[2]=c[l+2],t[3]=c[l+3],e[0]}function a(c,l){return t[3]=c[l],t[2]=c[l+1],t[1]=c[l+2],t[0]=c[l+3],e[0]}n.readFloatLE=i?o:a,n.readFloatBE=i?a:o}():function(){function e(i,r,s,o){var a=r<0?1:0;if(a&&(r=-r),r===0)i(1/r>0?0:2147483648,s,o);else if(isNaN(r))i(2143289344,s,o);else if(r>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(r<11754943508222875e-54)i((a<<31|Math.round(r/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(r)/Math.LN2),l=Math.round(r*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|l)>>>0,s,o)}}n.writeFloatLE=e.bind(null,hw),n.writeFloatBE=e.bind(null,dw);function t(i,r,s){var o=i(r,s),a=(o>>31)*2+1,c=o>>>23&255,l=o&8388607;return c===255?l?NaN:a*(1/0):c===0?a*1401298464324817e-60*l:a*Math.pow(2,c-150)*(l+8388608)}n.readFloatLE=t.bind(null,fw),n.readFloatBE=t.bind(null,mw)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function r(c,l,u){e[0]=c,l[u]=t[0],l[u+1]=t[1],l[u+2]=t[2],l[u+3]=t[3],l[u+4]=t[4],l[u+5]=t[5],l[u+6]=t[6],l[u+7]=t[7]}function s(c,l,u){e[0]=c,l[u]=t[7],l[u+1]=t[6],l[u+2]=t[5],l[u+3]=t[4],l[u+4]=t[3],l[u+5]=t[2],l[u+6]=t[1],l[u+7]=t[0]}n.writeDoubleLE=i?r:s,n.writeDoubleBE=i?s:r;function o(c,l){return t[0]=c[l],t[1]=c[l+1],t[2]=c[l+2],t[3]=c[l+3],t[4]=c[l+4],t[5]=c[l+5],t[6]=c[l+6],t[7]=c[l+7],e[0]}function a(c,l){return t[7]=c[l],t[6]=c[l+1],t[5]=c[l+2],t[4]=c[l+3],t[3]=c[l+4],t[2]=c[l+5],t[1]=c[l+6],t[0]=c[l+7],e[0]}n.readDoubleLE=i?o:a,n.readDoubleBE=i?a:o}():function(){function e(i,r,s,o,a,c){var l=o<0?1:0;if(l&&(o=-o),o===0)i(0,a,c+r),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+r),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+r),i((l<<31|2146435072)>>>0,a,c+s);else{var u;if(o<22250738585072014e-324)u=o/5e-324,i(u>>>0,a,c+r),i((l<<31|u/4294967296)>>>0,a,c+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),u=o*Math.pow(2,-h),i(u*4503599627370496>>>0,a,c+r),i((l<<31|h+1023<<20|u*1048576&1048575)>>>0,a,c+s)}}}n.writeDoubleLE=e.bind(null,hw,0,4),n.writeDoubleBE=e.bind(null,dw,4,0);function t(i,r,s,o,a){var c=i(o,a+r),l=i(o,a+s),u=(l>>31)*2+1,h=l>>>20&2047,d=4294967296*(l&1048575)+c;return h===2047?d?NaN:u*(1/0):h===0?u*5e-324*d:u*Math.pow(2,h-1075)*(d+4503599627370496)}n.readDoubleLE=t.bind(null,fw,0,4),n.readDoubleBE=t.bind(null,mw,4,0)}(),n}function hw(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function dw(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function fw(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function mw(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}});var od=T((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var yw=T(vw=>{"use strict";var ad=vw;ad.length=function(e){for(var t=0,i=0,r=0;r<e.length;++r)i=e.charCodeAt(r),i<128?t+=1:i<2048?t+=2:(i&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320?(++r,t+=4):t+=3;return t};ad.read=function(e,t,i){var r=i-t;if(r<1)return"";for(var s=null,o=[],a=0,c;t<i;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};ad.write=function(e,t,i){for(var r=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-r}});var bw=T((FZ,ww)=>{"use strict";ww.exports=AR;function AR(n,e,t){var i=t||8192,r=i>>>1,s=null,o=i;return function(c){if(c<1||c>r)return n(c);o+c>i&&(s=n(i),o=0);var l=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),l}}});var _w=T((qZ,Cw)=>{"use strict";Cw.exports=Bt;var r4=Yi();function Bt(n,e){this.lo=n>>>0,this.hi=e>>>0}var ho=Bt.zero=new Bt(0,0);ho.toNumber=function(){return 0};ho.zzEncode=ho.zzDecode=function(){return this};ho.length=function(){return 1};var DR=Bt.zeroHash="\0\0\0\0\0\0\0\0";Bt.fromNumber=function(e){if(e===0)return ho;var t=e<0;t&&(e=-e);var i=e>>>0,r=(e-i)/4294967296>>>0;return t&&(r=~r>>>0,i=~i>>>0,++i>4294967295&&(i=0,++r>4294967295&&(r=0))),new Bt(i,r)};Bt.from=function(e){if(typeof e=="number")return Bt.fromNumber(e);if(r4.isString(e))if(r4.Long)e=r4.Long.fromString(e);else return Bt.fromNumber(parseInt(e,10));return e.low||e.high?new Bt(e.low>>>0,e.high>>>0):ho};Bt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+i*4294967296)}return this.lo+this.hi*4294967296};Bt.prototype.toLong=function(e){return r4.Long?new r4.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var cs=String.prototype.charCodeAt;Bt.fromHash=function(e){return e===DR?ho:new Bt((cs.call(e,0)|cs.call(e,1)<<8|cs.call(e,2)<<16|cs.call(e,3)<<24)>>>0,(cs.call(e,4)|cs.call(e,5)<<8|cs.call(e,6)<<16|cs.call(e,7)<<24)>>>0)};Bt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Bt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Bt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Bt.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}});var Yi=T(cd=>{"use strict";var te=cd;te.asPromise=sd();te.base64=aw();te.EventEmitter=lw();te.float=gw();te.inquire=od();te.utf8=yw();te.pool=bw();te.LongBits=_w();te.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);te.global=te.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||cd;te.emptyArray=Object.freeze?Object.freeze([]):[];te.emptyObject=Object.freeze?Object.freeze({}):{};te.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};te.isString=function(e){return typeof e=="string"||e instanceof String};te.isObject=function(e){return e&&typeof e=="object"};te.isset=te.isSet=function(e,t){var i=e[t];return i!=null&&e.hasOwnProperty(t)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};te.Buffer=function(){try{var n=te.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}}();te._Buffer_from=null;te._Buffer_allocUnsafe=null;te.newBuffer=function(e){return typeof e=="number"?te.Buffer?te._Buffer_allocUnsafe(e):new te.Array(e):te.Buffer?te._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};te.Array=typeof Uint8Array<"u"?Uint8Array:Array;te.Long=te.global.dcodeIO&&te.global.dcodeIO.Long||te.global.Long||te.inquire("long");te.key2Re=/^true|false|0|1$/;te.key32Re=/^-?(?:0|[1-9][0-9]*)$/;te.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;te.longToHash=function(e){return e?te.LongBits.from(e).toHash():te.LongBits.zeroHash};te.longFromHash=function(e,t){var i=te.LongBits.fromHash(e);return te.Long?te.Long.fromBits(i.lo,i.hi,t):i.toNumber(!!t)};function Sw(n,e,t){for(var i=Object.keys(e),r=0;r<i.length;++r)(n[i[r]]===void 0||!t)&&(n[i[r]]=e[i[r]]);return n}te.merge=Sw;te.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Tw(n){function e(t,i){if(!(this instanceof e))return new e(t,i);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&Sw(this,i)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}te.newError=Tw;te.ProtocolError=Tw("ProtocolError");te.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var r=Object.keys(this),s=r.length-1;s>-1;--s)if(t[r[s]]===1&&this[r[s]]!==void 0&&this[r[s]]!==null)return r[s]}};te.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}};te.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};te._configure=function(){var n=te.Buffer;if(!n){te._Buffer_from=te._Buffer_allocUnsafe=null;return}te._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,i){return new n(t,i)},te._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}}});var m3=T((jZ,xw)=>{"use strict";xw.exports=xe;var ei=Yi(),ld,f3=ei.LongBits,Ew=ei.base64,Mw=ei.utf8;function s4(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function hd(){}function kR(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function xe(){this.len=0,this.head=new s4(hd,0,0),this.tail=this.head,this.states=null}var zw=function(){return ei.Buffer?function(){return(xe.create=function(){return new ld})()}:function(){return new xe}};xe.create=zw();xe.alloc=function(e){return new ei.Array(e)};ei.Array!==Array&&(xe.alloc=ei.pool(xe.alloc,ei.Array.prototype.subarray));xe.prototype._push=function(e,t,i){return this.tail=this.tail.next=new s4(e,t,i),this.len+=t,this};function dd(n,e,t){e[t]=n&255}function RR(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function fd(n,e){this.len=n,this.next=void 0,this.val=e}fd.prototype=Object.create(s4.prototype);fd.prototype.fn=RR;xe.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new fd((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};xe.prototype.int32=function(e){return e<0?this._push(md,10,f3.fromNumber(e)):this.uint32(e)};xe.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function md(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}xe.prototype.uint64=function(e){var t=f3.from(e);return this._push(md,t.length(),t)};xe.prototype.int64=xe.prototype.uint64;xe.prototype.sint64=function(e){var t=f3.from(e).zzEncode();return this._push(md,t.length(),t)};xe.prototype.bool=function(e){return this._push(dd,1,e?1:0)};function ud(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}xe.prototype.fixed32=function(e){return this._push(ud,4,e>>>0)};xe.prototype.sfixed32=xe.prototype.fixed32;xe.prototype.fixed64=function(e){var t=f3.from(e);return this._push(ud,4,t.lo)._push(ud,4,t.hi)};xe.prototype.sfixed64=xe.prototype.fixed64;xe.prototype.float=function(e){return this._push(ei.float.writeFloatLE,4,e)};xe.prototype.double=function(e){return this._push(ei.float.writeDoubleLE,8,e)};var LR=ei.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var r=0;r<e.length;++r)t[i+r]=e[r]};xe.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(dd,1,0);if(ei.isString(e)){var i=xe.alloc(t=Ew.length(e));Ew.decode(e,i,0),e=i}return this.uint32(t)._push(LR,t,e)};xe.prototype.string=function(e){var t=Mw.length(e);return t?this.uint32(t)._push(Mw.write,t,e):this._push(dd,1,0)};xe.prototype.fork=function(){return this.states=new kR(this),this.head=this.tail=new s4(hd,0,0),this.len=0,this};xe.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s4(hd,0,0),this.len=0),this};xe.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};xe.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};xe._configure=function(n){ld=n,xe.create=zw(),ld._configure()}});var Aw=T((WZ,Iw)=>{"use strict";Iw.exports=Ki;var Ow=m3();(Ki.prototype=Object.create(Ow.prototype)).constructor=Ki;var ls=Yi();function Ki(){Ow.call(this)}Ki._configure=function(){Ki.alloc=ls._Buffer_allocUnsafe,Ki.writeBytesBuffer=ls.Buffer&&ls.Buffer.prototype instanceof Uint8Array&&ls.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var r=0;r<e.length;)t[i++]=e[r++]}};Ki.prototype.bytes=function(e){ls.isString(e)&&(e=ls._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Ki.writeBytesBuffer,t,e),this};function VR(n,e,t){n.length<40?ls.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}Ki.prototype.string=function(e){var t=ls.Buffer.byteLength(e);return this.uint32(t),t&&this._push(VR,t,e),this};Ki._configure()});var g3=T((GZ,Vw)=>{"use strict";Vw.exports=Ct;var bi=Yi(),gd,Rw=bi.LongBits,NR=bi.utf8;function Ci(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function Ct(n){this.buf=n,this.pos=0,this.len=n.length}var Dw=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Ct(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Ct(e);throw Error("illegal buffer")},Lw=function(){return bi.Buffer?function(t){return(Ct.create=function(r){return bi.Buffer.isBuffer(r)?new gd(r):Dw(r)})(t)}:Dw};Ct.create=Lw();Ct.prototype._slice=bi.Array.prototype.subarray||bi.Array.prototype.slice;Ct.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Ci(this,10);return e}}();Ct.prototype.int32=function(){return this.uint32()|0};Ct.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function pd(){var n=new Rw(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Ci(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw Ci(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}Ct.prototype.bool=function(){return this.uint32()!==0};function p3(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}Ct.prototype.fixed32=function(){if(this.pos+4>this.len)throw Ci(this,4);return p3(this.buf,this.pos+=4)};Ct.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Ci(this,4);return p3(this.buf,this.pos+=4)|0};function kw(){if(this.pos+8>this.len)throw Ci(this,8);return new Rw(p3(this.buf,this.pos+=4),p3(this.buf,this.pos+=4))}Ct.prototype.float=function(){if(this.pos+4>this.len)throw Ci(this,4);var e=bi.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Ct.prototype.double=function(){if(this.pos+8>this.len)throw Ci(this,4);var e=bi.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Ct.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw Ci(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,i);if(t===i){var r=bi.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,i)};Ct.prototype.string=function(){var e=this.bytes();return NR.read(e,0,e.length)};Ct.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Ci(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Ci(this);while(this.buf[this.pos++]&128);return this};Ct.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};Ct._configure=function(n){gd=n,Ct.create=Lw(),gd._configure();var e=bi.Long?"toLong":"toNumber";bi.merge(Ct.prototype,{int64:function(){return pd.call(this)[e](!1)},uint64:function(){return pd.call(this)[e](!0)},sint64:function(){return pd.call(this).zzDecode()[e](!1)},fixed64:function(){return kw.call(this)[e](!0)},sfixed64:function(){return kw.call(this)[e](!1)}})}});var Bw=T(($Z,Hw)=>{"use strict";Hw.exports=fo;var Pw=g3();(fo.prototype=Object.create(Pw.prototype)).constructor=fo;var Nw=Yi();function fo(n){Pw.call(this,n)}fo._configure=function(){Nw.Buffer&&(fo.prototype._slice=Nw.Buffer.prototype.slice)};fo.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};fo._configure()});var qw=T((YZ,Fw)=>{"use strict";Fw.exports=o4;var vd=Yi();(o4.prototype=Object.create(vd.EventEmitter.prototype)).constructor=o4;function o4(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");vd.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!e,this.responseDelimited=!!t}o4.prototype.rpcCall=function n(e,t,i,r,s){if(!r)throw TypeError("request must be specified");var o=this;if(!s)return vd.asPromise(n,o,e,t,i,r);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(c,l){if(c)return o.emit("error",c,e),s(c);if(l===null){o.end(!0);return}if(!(l instanceof i))try{l=i[o.responseDelimited?"decodeDelimited":"decode"](l)}catch(u){return o.emit("error",u,e),s(u)}return o.emit("data",l,e),s(null,l)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};o4.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var yd=T(Uw=>{"use strict";var PR=Uw;PR.Service=qw()});var wd=T((QZ,jw)=>{"use strict";jw.exports={}});var $w=T(Gw=>{"use strict";var Mn=Gw;Mn.build="minimal";Mn.Writer=m3();Mn.BufferWriter=Aw();Mn.Reader=g3();Mn.BufferReader=Bw();Mn.util=Yi();Mn.rpc=yd();Mn.roots=wd();Mn.configure=Ww;function Ww(){Mn.util._configure(),Mn.Writer._configure(Mn.BufferWriter),Mn.Reader._configure(Mn.BufferReader)}Ww()});var Kw=T((ZZ,Yw)=>{"use strict";Yw.exports=bd;function bd(n,e){typeof n=="string"&&(e=n,n=void 0);var t=[];function i(s){if(typeof s!="string"){var o=r();if(bd.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),c=new Array(a.length+1),l=new Array(a.length),u=0;u<a.length;)c[u]=a[u],l[u]=s[a[u++]];return c[u]=o,Function.apply(null,c).apply(null,l)}return Function(o)()}for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d]=arguments[++d];if(d=0,s=s.replace(/%([%dfijs])/g,function(p,v){var w=h[d++];switch(v){case"d":case"f":return String(Number(w));case"i":return String(Math.floor(w));case"j":return JSON.stringify(w);case"s":return String(w)}return"%"}),d!==h.length)throw Error("parameter count mismatch");return t.push(s),i}function r(s){return"function "+(s||e||"")+"("+(n&&n.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return i.toString=r,i}bd.verbose=!1});var Xw=T((JZ,Qw)=>{"use strict";Qw.exports=a4;var HR=sd(),BR=od(),Cd=BR("fs");function a4(n,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&Cd&&Cd.readFile?Cd.readFile(n,function(r,s){return r&&typeof XMLHttpRequest<"u"?a4.xhr(n,e,t):r?t(r):t(null,e.binary?s:s.toString("utf8"))}):a4.xhr(n,e,t):HR(a4,this,n,e)}a4.xhr=function(e,t,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==0&&r.status!==200)return i(Error("status "+r.status));if(t.binary){var o=r.response;if(!o){o=[];for(var a=0;a<r.responseText.length;++a)o.push(r.responseText.charCodeAt(a)&255)}return i(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return i(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}});var eb=T(Jw=>{"use strict";var Sd=Jw,Zw=Sd.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},_d=Sd.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),i=Zw(e),r="";i&&(r=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):i?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return r+t.join("/")};Sd.resolve=function(e,t,i){return i||(t=_d(t)),Zw(t)?t:(i||(e=_d(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?_d(e+"/"+t):t)}});var mo=T(tb=>{"use strict";var c4=tb,FR=Ft(),qR=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function l4(n,e){var t=0,i={};for(e|=0;t<n.length;)i[qR[t+e]]=n[t++];return i}c4.basic=l4([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);c4.defaults=l4([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",FR.emptyArray,null]);c4.long=l4([0,0,0,1,1],7);c4.mapKey=l4([0,0,0,5,5,0,0,0,1,1,0,2],2);c4.packed=l4([1,5,0,0,0,5,5,0,0,0,1,1,0])});var us=T((nJ,rb)=>{"use strict";rb.exports=ti;var v3=po();((ti.prototype=Object.create(v3.prototype)).constructor=ti).className="Field";var nb=_i(),ib=mo(),zt=Ft(),Td,UR=/^required|optional|repeated$/;ti.fromJSON=function(e,t){return new ti(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function ti(n,e,t,i,r,s,o){if(zt.isObject(i)?(o=r,s=i,i=r=void 0):zt.isObject(r)&&(o=s,s=r,r=void 0),v3.call(this,n,s),!zt.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!zt.isString(t))throw TypeError("type must be a string");if(i!==void 0&&!UR.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(r!==void 0&&!zt.isString(r))throw TypeError("extend must be a string");i==="proto3_optional"&&(i="optional"),this.rule=i&&i!=="optional"?i:void 0,this.type=t,this.id=e,this.extend=r||void 0,this.required=i==="required",this.optional=!this.required,this.repeated=i==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=zt.Long?ib.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(ti.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});ti.prototype.setOption=function(e,t,i){return e==="packed"&&(this._packed=null),v3.prototype.setOption.call(this,e,t,i)};ti.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return zt.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};ti.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=ib.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Td?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof nb&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof nb))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=zt.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;zt.base64.test(this.typeDefault)?zt.base64.decode(this.typeDefault,e=zt.newBuffer(zt.base64.length(this.typeDefault)),0):zt.utf8.write(this.typeDefault,e=zt.newBuffer(zt.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=zt.emptyObject:this.repeated?this.defaultValue=zt.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Td&&(this.parent.ctor.prototype[this.name]=this.defaultValue),v3.prototype.resolve.call(this)};ti.d=function(e,t,i,r){return typeof t=="function"?t=zt.decorateType(t).name:t&&typeof t=="object"&&(t=zt.decorateEnum(t).name),function(o,a){zt.decorateType(o.constructor).add(new ti(a,e,t,i,{default:r}))}};ti._configure=function(e){Td=e}});var $a=T((iJ,ab)=>{"use strict";ab.exports=ni;var w3=po();((ni.prototype=Object.create(w3.prototype)).constructor=ni).className="OneOf";var sb=us(),y3=Ft();function ni(n,e,t,i){if(Array.isArray(e)||(t=e,e=void 0),w3.call(this,n,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=i}ni.fromJSON=function(e,t){return new ni(e,t.oneof,t.options,t.comment)};ni.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return y3.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function ob(n){if(n.parent)for(var e=0;e<n.fieldsArray.length;++e)n.fieldsArray[e].parent||n.parent.add(n.fieldsArray[e])}ni.prototype.add=function(e){if(!(e instanceof sb))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,ob(this),this};ni.prototype.remove=function(e){if(!(e instanceof sb))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};ni.prototype.onAdd=function(e){w3.prototype.onAdd.call(this,e);for(var t=this,i=0;i<this.oneof.length;++i){var r=e.get(this.oneof[i]);r&&!r.partOf&&(r.partOf=t,t.fieldsArray.push(r))}ob(this)};ni.prototype.onRemove=function(e){for(var t=0,i;t<this.fieldsArray.length;++t)(i=this.fieldsArray[t]).parent&&i.parent.remove(i);w3.prototype.onRemove.call(this,e)};ni.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(r,s){y3.decorateType(r.constructor).add(new ni(s,e)),Object.defineProperty(r,s,{get:y3.oneOfGetter(e),set:y3.oneOfSetter(e)})}}});var Qa=T((rJ,hb)=>{"use strict";hb.exports=Ae;var Ed=po();((Ae.prototype=Object.create(Ed.prototype)).constructor=Ae).className="Namespace";var cb=us(),b3=Ft(),jR=$a(),Ya,u4,Ka;Ae.fromJSON=function(e,t){return new Ae(e,t.options).addJSON(t.nested)};function lb(n,e){if(n&&n.length){for(var t={},i=0;i<n.length;++i)t[n[i].name]=n[i].toJSON(e);return t}}Ae.arrayToJSON=lb;Ae.isReservedId=function(e,t){if(e){for(var i=0;i<e.length;++i)if(typeof e[i]!="string"&&e[i][0]<=t&&e[i][1]>t)return!0}return!1};Ae.isReservedName=function(e,t){if(e){for(var i=0;i<e.length;++i)if(e[i]===t)return!0}return!1};function Ae(n,e){Ed.call(this,n,e),this.nested=void 0,this._nestedArray=null}function ub(n){return n._nestedArray=null,n}Object.defineProperty(Ae.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=b3.toArray(this.nested))}});Ae.prototype.toJSON=function(e){return b3.toObject(["options",this.options,"nested",lb(this.nestedArray,e)])};Ae.prototype.addJSON=function(e){var t=this;if(e)for(var i=Object.keys(e),r=0,s;r<i.length;++r)s=e[i[r]],t.add((s.fields!==void 0?Ya.fromJSON:s.values!==void 0?Ka.fromJSON:s.methods!==void 0?u4.fromJSON:s.id!==void 0?cb.fromJSON:Ae.fromJSON)(i[r],s));return this};Ae.prototype.get=function(e){return this.nested&&this.nested[e]||null};Ae.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof Ka)return this.nested[e].values;throw Error("no such enum: "+e)};Ae.prototype.add=function(e){if(!(e instanceof cb&&e.extend!==void 0||e instanceof Ya||e instanceof jR||e instanceof Ka||e instanceof u4||e instanceof Ae))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof Ae&&e instanceof Ae&&!(t instanceof Ya||t instanceof u4)){for(var i=t.nestedArray,r=0;r<i.length;++r)e.add(i[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),ub(this)};Ae.prototype.remove=function(e){if(!(e instanceof Ed))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),ub(this)};Ae.prototype.define=function(e,t){if(b3.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var i=this;e.length>0;){var r=e.shift();if(i.nested&&i.nested[r]){if(i=i.nested[r],!(i instanceof Ae))throw Error("path conflicts with non-namespace objects")}else i.add(i=new Ae(r))}return t&&i.addJSON(t),i};Ae.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof Ae?e[t++].resolveAll():e[t++].resolve();return this.resolve()};Ae.prototype.lookup=function(e,t,i){if(typeof t=="boolean"?(i=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),b3.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(e.length===1){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof Ae&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof Ae&&(r=this._nestedArray[s].lookup(e,t,!0)))return r;return this.parent===null||i?null:this.parent.lookup(e,t)};Ae.prototype.lookupType=function(e){var t=this.lookup(e,[Ya]);if(!t)throw Error("no such type: "+e);return t};Ae.prototype.lookupEnum=function(e){var t=this.lookup(e,[Ka]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};Ae.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[Ya,Ka]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};Ae.prototype.lookupService=function(e){var t=this.lookup(e,[u4]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};Ae._configure=function(n,e,t){Ya=n,u4=e,Ka=t}});var C3=T((sJ,db)=>{"use strict";db.exports=Tr;var Md=us();((Tr.prototype=Object.create(Md.prototype)).constructor=Tr).className="MapField";var WR=mo(),h4=Ft();function Tr(n,e,t,i,r,s){if(Md.call(this,n,e,i,void 0,void 0,r,s),!h4.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}Tr.fromJSON=function(e,t){return new Tr(e,t.id,t.keyType,t.type,t.options,t.comment)};Tr.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return h4.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Tr.prototype.resolve=function(){if(this.resolved)return this;if(WR.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return Md.prototype.resolve.call(this)};Tr.d=function(e,t,i){return typeof i=="function"?i=h4.decorateType(i).name:i&&typeof i=="object"&&(i=h4.decorateEnum(i).name),function(s,o){h4.decorateType(s.constructor).add(new Tr(o,e,t,i))}}});var _3=T((oJ,fb)=>{"use strict";fb.exports=go;var zd=po();((go.prototype=Object.create(zd.prototype)).constructor=go).className="Method";var Xa=Ft();function go(n,e,t,i,r,s,o,a,c){if(Xa.isObject(r)?(o=r,r=s=void 0):Xa.isObject(s)&&(o=s,s=void 0),!(e===void 0||Xa.isString(e)))throw TypeError("type must be a string");if(!Xa.isString(t))throw TypeError("requestType must be a string");if(!Xa.isString(i))throw TypeError("responseType must be a string");zd.call(this,n,o),this.type=e||"rpc",this.requestType=t,this.requestStream=r?!0:void 0,this.responseType=i,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=c}go.fromJSON=function(e,t){return new go(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};go.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Xa.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};go.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),zd.prototype.resolve.call(this))}});var S3=T((aJ,pb)=>{"use strict";pb.exports=ii;var hs=Qa();((ii.prototype=Object.create(hs.prototype)).constructor=ii).className="Service";var xd=_3(),d4=Ft(),GR=yd();function ii(n,e){hs.call(this,n,e),this.methods={},this._methodsArray=null}ii.fromJSON=function(e,t){var i=new ii(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),s=0;s<r.length;++s)i.add(xd.fromJSON(r[s],t.methods[r[s]]));return t.nested&&i.addJSON(t.nested),i.comment=t.comment,i};ii.prototype.toJSON=function(e){var t=hs.prototype.toJSON.call(this,e),i=e?!!e.keepComments:!1;return d4.toObject(["options",t&&t.options||void 0,"methods",hs.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])};Object.defineProperty(ii.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=d4.toArray(this.methods))}});function mb(n){return n._methodsArray=null,n}ii.prototype.get=function(e){return this.methods[e]||hs.prototype.get.call(this,e)};ii.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return hs.prototype.resolve.call(this)};ii.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof xd?(this.methods[e.name]=e,e.parent=this,mb(this)):hs.prototype.add.call(this,e)};ii.prototype.remove=function(e){if(e instanceof xd){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,mb(this)}return hs.prototype.remove.call(this,e)};ii.prototype.create=function(e,t,i){for(var r=new GR.Service(e,t,i),s=0,o;s<this.methodsArray.length;++s){var a=d4.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");r[a]=d4.codegen(["r","c"],d4.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return r}});var T3=T((cJ,gb)=>{"use strict";gb.exports=Qi;var $R=Yi();function Qi(n){if(n)for(var e=Object.keys(n),t=0;t<e.length;++t)this[e[t]]=n[e[t]]}Qi.create=function(e){return this.$type.create(e)};Qi.encode=function(e,t){return this.$type.encode(e,t)};Qi.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};Qi.decode=function(e){return this.$type.decode(e)};Qi.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};Qi.verify=function(e){return this.$type.verify(e)};Qi.fromObject=function(e){return this.$type.fromObject(e)};Qi.toObject=function(e,t){return this.$type.toObject(e,t)};Qi.prototype.toJSON=function(){return this.$type.toObject(this,$R.toJSONOptions)}});var Od=T((lJ,yb)=>{"use strict";yb.exports=QR;var YR=_i(),Er=mo(),vb=Ft();function KR(n){return"missing required '"+n.name+"'"}function QR(n){var e=vb.codegen(["r","l"],n.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(n.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");n.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var t=0;t<n.fieldsArray.length;++t){var i=n._fieldsArray[t].resolve(),r=i.resolvedType instanceof YR?"int32":i.type,s="m"+vb.safeProp(i.name);e("case %i: {",i.id),i.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),Er.defaults[i.keyType]!==void 0?e("k=%j",Er.defaults[i.keyType]):e("k=null"),Er.defaults[r]!==void 0?e("value=%j",Er.defaults[r]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",i.keyType)("case 2:"),Er.basic[r]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",r),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Er.long[i.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):i.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),Er.packed[r]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,r)("}else"),Er.basic[r]===void 0?e(i.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,r)):Er.basic[r]===void 0?e(i.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,r),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<n._fieldsArray.length;++t){var o=n._fieldsArray[t];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",KR(o))}return e("return m")}});var Dd=T((uJ,wb)=>{"use strict";wb.exports=JR;var XR=_i(),Id=Ft();function ri(n,e){return n.name+": "+e+(n.repeated&&e!=="array"?"[]":n.map&&e!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function Ad(n,e,t,i){if(e.resolvedType)if(e.resolvedType instanceof XR){n("switch(%s){",i)("default:")("return%j",ri(e,"enum value"));for(var r=Object.keys(e.resolvedType.values),s=0;s<r.length;++s)n("case %i:",e.resolvedType.values[r[s]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",t,i)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",i)("return%j",ri(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",ri(e,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',i)("return%j",ri(e,"number"));break;case"bool":n('if(typeof %s!=="boolean")',i)("return%j",ri(e,"boolean"));break;case"string":n("if(!util.isString(%s))",i)("return%j",ri(e,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",ri(e,"buffer"));break}return n}function ZR(n,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",t)("return%j",ri(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",t)("return%j",ri(e,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",t)("return%j",ri(e,"boolean key"));break}return n}function JR(n){var e=Id.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=n.oneofsArray,i={};t.length&&e("var p={}");for(var r=0;r<n.fieldsArray.length;++r){var s=n._fieldsArray[r].resolve(),o="m"+Id.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",ri(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),ZR(e,s,"k[i]"),Ad(e,s,r,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",ri(s,"array"))("for(var i=0;i<%s.length;++i){",o),Ad(e,s,r,o+"[i]")("}");else{if(s.partOf){var a=Id.safeProp(s.partOf.name);i[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),i[s.partOf.name]=1,e("p%s=1",a)}Ad(e,s,r,o)}s.optional&&e("}")}return e("return null")}});var Ld=T(Cb=>{"use strict";var bb=Cb,f4=_i(),Xi=Ft();function kd(n,e,t,i){var r=!1;if(e.resolvedType)if(e.resolvedType instanceof f4){n("switch(d%s){",i);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!r&&(n("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',i,i,i),e.repeated||n("break"),r=!0),n("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",i,s[o[a]])("break");n("}")}else n('if(typeof d%s!=="object")',i)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,t,i);else{var c=!1;switch(e.type){case"double":case"float":n("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",i,i);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,c)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,c?"true":"");break;case"bytes":n('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length >= 0)",i)("m%s=d%s",i,i);break;case"string":n("m%s=String(d%s)",i,i);break;case"bool":n("m%s=Boolean(d%s)",i,i);break}}return n}bb.fromObject=function(e){var t=e.fieldsArray,i=Xi.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return i("return new this.ctor");i("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),o=Xi.safeProp(s.name);s.map?(i("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),kd(i,s,r,o+"[ks[i]]")("}")("}")):s.repeated?(i("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),kd(i,s,r,o+"[i]")("}")("}")):(s.resolvedType instanceof f4||i("if(d%s!=null){",o),kd(i,s,r,o),s.resolvedType instanceof f4||i("}"))}return i("return m")};function Rd(n,e,t,i){if(e.resolvedType)e.resolvedType instanceof f4?n("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",i,t,i,i,t,i,i):n("d%s=types[%i].toObject(m%s,o)",i,t,i);else{var r=!1;switch(e.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":r=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,r?"true":"",i);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:n("d%s=m%s",i,i);break}}return n}bb.toObject=function(e){var t=e.fieldsArray.slice().sort(Xi.compareFieldsById);if(!t.length)return Xi.codegen()("return {}");for(var i=Xi.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],s=[],o=[],a=0;a<t.length;++a)t[a].partOf||(t[a].resolve().repeated?r:t[a].map?s:o).push(t[a]);if(r.length){for(i("if(o.arrays||o.defaults){"),a=0;a<r.length;++a)i("d%s=[]",Xi.safeProp(r[a].name));i("}")}if(s.length){for(i("if(o.objects||o.defaults){"),a=0;a<s.length;++a)i("d%s={}",Xi.safeProp(s[a].name));i("}")}if(o.length){for(i("if(o.defaults){"),a=0;a<o.length;++a){var c=o[a],l=Xi.safeProp(c.name);if(c.resolvedType instanceof f4)i("d%s=o.enums===String?%j:%j",l,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)i("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var u="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";i("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",l,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else i("d%s=%j",l,c.typeDefault)}i("}")}var h=!1;for(a=0;a<t.length;++a){var c=t[a],d=e._fieldsArray.indexOf(c),l=Xi.safeProp(c.name);c.map?(h||(h=!0,i("var ks2")),i("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),Rd(i,c,d,l+"[ks2[j]]")("}")):c.repeated?(i("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),Rd(i,c,d,l+"[j]")("}")):(i("if(m%s!=null&&m.hasOwnProperty(%j)){",l,c.name),Rd(i,c,d,l),c.partOf&&i("if(o.oneofs)")("d%s=%j",Xi.safeProp(c.partOf.name),c.name)),i("}")}return i("return d")}});var Vd=T(_b=>{"use strict";var eL=_b,tL=T3();eL[".google.protobuf.Any"]={fromObject:function(n){if(n&&n["@type"]){var e=n["@type"].substring(n["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var i=n["@type"].charAt(0)==="."?n["@type"].slice(1):n["@type"];return i.indexOf("/")===-1&&(i="/"+i),this.create({type_url:i,value:t.encode(t.fromObject(n)).finish()})}}return this.fromObject(n)},toObject:function(n,e){var t="type.googleapis.com/",i="",r="";if(e&&e.json&&n.type_url&&n.value){r=n.type_url.substring(n.type_url.lastIndexOf("/")+1),i=n.type_url.substring(0,n.type_url.lastIndexOf("/")+1);var s=this.lookup(r);s&&(n=s.decode(n.value))}if(!(n instanceof this.ctor)&&n instanceof tL){var o=n.$type.toObject(n,e),a=n.$type.fullName[0]==="."?n.$type.fullName.slice(1):n.$type.fullName;return i===""&&(i=t),r=i+a,o["@type"]=r,o}return this.toObject(n,e)}}});var z3=T((fJ,Tb)=>{"use strict";Tb.exports=Ye;var Si=Qa();((Ye.prototype=Object.create(Si.prototype)).constructor=Ye).className="Type";var nL=_i(),Hd=$a(),E3=us(),iL=C3(),rL=S3(),Nd=T3(),Pd=g3(),sL=m3(),tn=Ft(),oL=Bd(),aL=Od(),cL=Dd(),Sb=Ld(),lL=Vd();function Ye(n,e){Si.call(this,n,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(Ye.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var n=Object.keys(this.fields),e=0;e<n.length;++e){var t=this.fields[n[e]],i=t.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=tn.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=tn.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=Ye.generateConstructor(this)())},set:function(n){var e=n.prototype;e instanceof Nd||((n.prototype=new Nd).constructor=n,tn.merge(n.prototype,e)),n.$type=n.prototype.$type=this,tn.merge(n,Nd,!0),this._ctor=n;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var i={};for(t=0;t<this.oneofsArray.length;++t)i[this._oneofsArray[t].resolve().name]={get:tn.oneOfGetter(this._oneofsArray[t].oneof),set:tn.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(n.prototype,i)}}});Ye.generateConstructor=function(e){for(var t=tn.codegen(["p"],e.name),i=0,r;i<e.fieldsArray.length;++i)(r=e._fieldsArray[i]).map?t("this%s={}",tn.safeProp(r.name)):r.repeated&&t("this%s=[]",tn.safeProp(r.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function M3(n){return n._fieldsById=n._fieldsArray=n._oneofsArray=null,delete n.encode,delete n.decode,delete n.verify,n}Ye.fromJSON=function(e,t){var i=new Ye(e,t.options);i.extensions=t.extensions,i.reserved=t.reserved;for(var r=Object.keys(t.fields),s=0;s<r.length;++s)i.add((typeof t.fields[r[s]].keyType<"u"?iL.fromJSON:E3.fromJSON)(r[s],t.fields[r[s]]));if(t.oneofs)for(r=Object.keys(t.oneofs),s=0;s<r.length;++s)i.add(Hd.fromJSON(r[s],t.oneofs[r[s]]));if(t.nested)for(r=Object.keys(t.nested),s=0;s<r.length;++s){var o=t.nested[r[s]];i.add((o.id!==void 0?E3.fromJSON:o.fields!==void 0?Ye.fromJSON:o.values!==void 0?nL.fromJSON:o.methods!==void 0?rL.fromJSON:Si.fromJSON)(r[s],o))}return t.extensions&&t.extensions.length&&(i.extensions=t.extensions),t.reserved&&t.reserved.length&&(i.reserved=t.reserved),t.group&&(i.group=!0),t.comment&&(i.comment=t.comment),i};Ye.prototype.toJSON=function(e){var t=Si.prototype.toJSON.call(this,e),i=e?!!e.keepComments:!1;return tn.toObject(["options",t&&t.options||void 0,"oneofs",Si.arrayToJSON(this.oneofsArray,e),"fields",Si.arrayToJSON(this.fieldsArray.filter(function(r){return!r.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])};Ye.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var i=this.oneofsArray;for(t=0;t<i.length;)i[t++].resolve();return Si.prototype.resolveAll.call(this)};Ye.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};Ye.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof E3&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),M3(this)}return e instanceof Hd?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),M3(this)):Si.prototype.add.call(this,e)};Ye.prototype.remove=function(e){if(e instanceof E3&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),M3(this)}if(e instanceof Hd){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),M3(this)}return Si.prototype.remove.call(this,e)};Ye.prototype.isReservedId=function(e){return Si.isReservedId(this.reserved,e)};Ye.prototype.isReservedName=function(e){return Si.isReservedName(this.reserved,e)};Ye.prototype.create=function(e){return new this.ctor(e)};Ye.prototype.setup=function(){for(var e=this.fullName,t=[],i=0;i<this.fieldsArray.length;++i)t.push(this._fieldsArray[i].resolve().resolvedType);this.encode=oL(this)({Writer:sL,types:t,util:tn}),this.decode=aL(this)({Reader:Pd,types:t,util:tn}),this.verify=cL(this)({types:t,util:tn}),this.fromObject=Sb.fromObject(this)({types:t,util:tn}),this.toObject=Sb.toObject(this)({types:t,util:tn});var r=lL[e];if(r){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(s),s.toObject=this.toObject,this.toObject=r.toObject.bind(s)}return this};Ye.prototype.encode=function(e,t){return this.setup().encode(e,t)};Ye.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};Ye.prototype.decode=function(e,t){return this.setup().decode(e,t)};Ye.prototype.decodeDelimited=function(e){return e instanceof Pd||(e=Pd.create(e)),this.decode(e,e.uint32())};Ye.prototype.verify=function(e){return this.setup().verify(e)};Ye.prototype.fromObject=function(e){return this.setup().fromObject(e)};Ye.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};Ye.d=function(e){return function(i){tn.decorateType(i,e)}}});var I3=T((mJ,Ob)=>{"use strict";Ob.exports=Pn;var O3=Qa();((Pn.prototype=Object.create(O3.prototype)).constructor=Pn).className="Root";var qd=us(),Mb=_i(),uL=$a(),ds=Ft(),zb,Fd,m4;function Pn(n){O3.call(this,"",n),this.deferred=[],this.files=[]}Pn.fromJSON=function(e,t){return t||(t=new Pn),e.options&&t.setOptions(e.options),t.addJSON(e.nested)};Pn.prototype.resolvePath=ds.path.resolve;Pn.prototype.fetch=ds.fetch;function xb(){}Pn.prototype.load=function n(e,t,i){typeof t=="function"&&(i=t,t=void 0);var r=this;if(!i)return ds.asPromise(n,r,e,t);var s=i===xb;function o(m,p){if(i){if(s)throw m;var v=i;i=null,v(m,p)}}function a(m){var p=m.lastIndexOf("google/protobuf/");if(p>-1){var v=m.substring(p);if(v in m4)return v}return null}function c(m,p){try{if(ds.isString(p)&&p.charAt(0)==="{"&&(p=JSON.parse(p)),!ds.isString(p))r.setOptions(p.options).addJSON(p.nested);else{Fd.filename=m;var v=Fd(p,r,t),w,A=0;if(v.imports)for(;A<v.imports.length;++A)(w=a(v.imports[A])||r.resolvePath(m,v.imports[A]))&&l(w);if(v.weakImports)for(A=0;A<v.weakImports.length;++A)(w=a(v.weakImports[A])||r.resolvePath(m,v.weakImports[A]))&&l(w,!0)}}catch(_){o(_)}!s&&!u&&o(null,r)}function l(m,p){if(m=a(m)||m,!(r.files.indexOf(m)>-1)){if(r.files.push(m),m in m4){s?c(m,m4[m]):(++u,setTimeout(function(){--u,c(m,m4[m])}));return}if(s){var v;try{v=ds.fs.readFileSync(m).toString("utf8")}catch(w){p||o(w);return}c(m,v)}else++u,r.fetch(m,function(w,A){if(--u,!!i){if(w){p?u||o(null,r):o(w);return}c(m,A)}})}}var u=0;ds.isString(e)&&(e=[e]);for(var h=0,d;h<e.length;++h)(d=r.resolvePath("",e[h]))&&l(d);if(s)return r;u||o(null,r)};Pn.prototype.loadSync=function(e,t){if(!ds.isNode)throw Error("not supported");return this.load(e,t,xb)};Pn.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return O3.prototype.resolveAll.call(this)};var x3=/^[A-Z]/;function Eb(n,e){var t=e.parent.lookup(e.extend);if(t){var i=new qd(e.fullName,e.id,e.type,e.rule,void 0,e.options);return t.get(i.name)||(i.declaringField=e,e.extensionField=i,t.add(i)),!0}return!1}Pn.prototype._handleAdd=function(e){if(e instanceof qd)e.extend!==void 0&&!e.extensionField&&(Eb(this,e)||this.deferred.push(e));else if(e instanceof Mb)x3.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof uL)){if(e instanceof zb)for(var t=0;t<this.deferred.length;)Eb(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var i=0;i<e.nestedArray.length;++i)this._handleAdd(e._nestedArray[i]);x3.test(e.name)&&(e.parent[e.name]=e)}};Pn.prototype._handleRemove=function(e){if(e instanceof qd){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof Mb)x3.test(e.name)&&delete e.parent[e.name];else if(e instanceof O3){for(var i=0;i<e.nestedArray.length;++i)this._handleRemove(e._nestedArray[i]);x3.test(e.name)&&delete e.parent[e.name]}};Pn._configure=function(n,e,t){zb=n,Fd=e,m4=t}});var Ft=T((pJ,Ab)=>{"use strict";var _t=Ab.exports=Yi(),Ib=wd(),Ud,jd;_t.codegen=Kw();_t.fetch=Xw();_t.path=eb();_t.fs=_t.inquire("fs");_t.toArray=function(e){if(e){for(var t=Object.keys(e),i=new Array(t.length),r=0;r<t.length;)i[r]=e[t[r++]];return i}return[]};_t.toObject=function(e){for(var t={},i=0;i<e.length;){var r=e[i++],s=e[i++];s!==void 0&&(t[r]=s)}return t};var hL=/\\/g,dL=/"/g;_t.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};_t.safeProp=function(e){return!/^[$\w_]+$/.test(e)||_t.isReserved(e)?'["'+e.replace(hL,"\\\\").replace(dL,'\\"')+'"]':"."+e};_t.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var fL=/_([a-z])/g;_t.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(fL,function(t,i){return i.toUpperCase()})};_t.compareFieldsById=function(e,t){return e.id-t.id};_t.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(_t.decorateRoot.remove(e.$type),e.$type.name=t,_t.decorateRoot.add(e.$type)),e.$type;Ud||(Ud=z3());var i=new Ud(t||e.name);return _t.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var mL=0;_t.decorateEnum=function(e){if(e.$type)return e.$type;jd||(jd=_i());var t=new jd("Enum"+mL++,e);return _t.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};_t.setProperty=function(e,t,i){function r(s,o,a){var c=o.shift();if(c==="__proto__"||c==="prototype")return s;if(o.length>0)s[c]=r(s[c]||{},o,a);else{var l=s[c];l&&(a=[].concat(l).concat(a)),s[c]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),r(e,t,i)};Object.defineProperty(_t,"decorateRoot",{get:function(){return Ib.decorated||(Ib.decorated=new(I3()))}})});var po=T((gJ,Db)=>{"use strict";Db.exports=Hn;Hn.className="ReflectionObject";var A3=Ft(),D3;function Hn(n,e){if(!A3.isString(n))throw TypeError("name must be a string");if(e&&!A3.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=n,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(Hn.prototype,{root:{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n}},fullName:{get:function(){for(var n=[this.name],e=this.parent;e;)n.unshift(e.name),e=e.parent;return n.join(".")}}});Hn.prototype.toJSON=function(){throw Error()};Hn.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof D3&&t._handleAdd(this)};Hn.prototype.onRemove=function(e){var t=e.root;t instanceof D3&&t._handleRemove(this),this.parent=null,this.resolved=!1};Hn.prototype.resolve=function(){return this.resolved?this:(this.root instanceof D3&&(this.resolved=!0),this)};Hn.prototype.getOption=function(e){if(this.options)return this.options[e]};Hn.prototype.setOption=function(e,t,i){return(!i||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=t),this};Hn.prototype.setParsedOption=function(e,t,i){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(i){var s=r.find(function(c){return Object.prototype.hasOwnProperty.call(c,e)});if(s){var o=s[e];A3.setProperty(o,i,t)}else s={},s[e]=A3.setProperty({},i,t),r.push(s)}else{var a={};a[e]=t,r.push(a)}return this};Hn.prototype.setOptions=function(e,t){if(e)for(var i=Object.keys(e),r=0;r<i.length;++r)this.setOption(i[r],e[i[r]],t);return this};Hn.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};Hn._configure=function(n){D3=n}});var _i=T((vJ,Lb)=>{"use strict";Lb.exports=Zi;var kb=po();((Zi.prototype=Object.create(kb.prototype)).constructor=Zi).className="Enum";var Rb=Qa(),k3=Ft();function Zi(n,e,t,i,r,s){if(kb.call(this,n,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=r||{},this.valuesOptions=s,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}Zi.fromJSON=function(e,t){var i=new Zi(e,t.values,t.options,t.comment,t.comments);return i.reserved=t.reserved,i};Zi.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return k3.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};Zi.prototype.add=function(e,t,i,r){if(!k3.isString(e))throw TypeError("name must be a string");if(!k3.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return r&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=r||null),this.comments[e]=i||null,this};Zi.prototype.remove=function(e){if(!k3.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};Zi.prototype.isReservedId=function(e){return Rb.isReservedId(this.reserved,e)};Zi.prototype.isReservedName=function(e){return Rb.isReservedName(this.reserved,e)}});var Bd=T((yJ,Nb)=>{"use strict";Nb.exports=gL;var pL=_i(),Wd=mo(),Gd=Ft();function Vb(n,e,t,i){return e.resolvedType.group?n("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,i,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):n("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,i,(e.id<<3|2)>>>0)}function gL(n){for(var e=Gd.codegen(["m","w"],n.name+"$encode")("if(!w)")("w=Writer.create()"),t,i,r=n.fieldsArray.slice().sort(Gd.compareFieldsById),t=0;t<r.length;++t){var s=r[t].resolve(),o=n._fieldsArray.indexOf(s),a=s.resolvedType instanceof pL?"int32":s.type,c=Wd.basic[a];i="m"+Gd.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",i,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",i)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|Wd.mapKey[s.keyType],s.keyType),c===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,i):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|c,a,i),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",i,i),s.packed&&Wd.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",i)("w.%s(%s[i])",a,i)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",i),c===void 0?Vb(e,s,o,i+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|c)>>>0,a,i)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",i,s.name),c===void 0?Vb(e,s,o,i):e("w.uint32(%i).%s(%s)",(s.id<<3|c)>>>0,a,i))}return e("return w")}});var Hb=T((wJ,Pb)=>{"use strict";var Se=Pb.exports=$w();Se.build="light";function vL(n,e,t){return typeof e=="function"?(t=e,e=new Se.Root):e||(e=new Se.Root),e.load(n,t)}Se.load=vL;function yL(n,e){return e||(e=new Se.Root),e.loadSync(n)}Se.loadSync=yL;Se.encoder=Bd();Se.decoder=Od();Se.verifier=Dd();Se.converter=Ld();Se.ReflectionObject=po();Se.Namespace=Qa();Se.Root=I3();Se.Enum=_i();Se.Type=z3();Se.Field=us();Se.OneOf=$a();Se.MapField=C3();Se.Service=S3();Se.Method=_3();Se.Message=T3();Se.wrappers=Vd();Se.types=mo();Se.util=Ft();Se.ReflectionObject._configure(Se.Root);Se.Namespace._configure(Se.Type,Se.Service,Se.Enum);Se.Root._configure(Se.Type);Se.Field._configure(Se.Type)});var Yd=T((bJ,qb)=>{"use strict";qb.exports=Fb;var $d=/[\s{}=;:[\],'"()<>]/g,wL=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,bL=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,CL=/^ *[*/]+ */,_L=/^\s*\*?\/*/,SL=/\n/g,TL=/\s/,EL=/\\(.?)/g,ML={0:"\0",r:"\r",n:`
`,t:"	"};function Bb(n){return n.replace(EL,function(e,t){switch(t){case"\\":case"":return t;default:return ML[t]||""}})}Fb.unescape=Bb;function Fb(n,e){n=n.toString();var t=0,i=n.length,r=1,s=0,o={},a=[],c=null;function l(R){return Error("illegal "+R+" (line "+r+")")}function u(){var R=c==="'"?bL:wL;R.lastIndex=t-1;var U=R.exec(n);if(!U)throw l("string");return t=R.lastIndex,w(c),c=null,Bb(U[1])}function h(R){return n.charAt(R)}function d(R,U,X){var re={type:n.charAt(R++),lineEmpty:!1,leading:X},Le;e?Le=2:Le=3;var Xe=R-Le,ve;do if(--Xe<0||(ve=n.charAt(Xe))===`
`){re.lineEmpty=!0;break}while(ve===" "||ve==="	");for(var z=n.substring(R,U).split(SL),Be=0;Be<z.length;++Be)z[Be]=z[Be].replace(e?_L:CL,"").trim();re.text=z.join(`
`).trim(),o[r]=re,s=r}function m(R){var U=p(R),X=n.substring(R,U),re=/^\s*\/\//.test(X);return re}function p(R){for(var U=R;U<i&&h(U)!==`
`;)U++;return U}function v(){if(a.length>0)return a.shift();if(c)return u();var R,U,X,re,Le,Xe=t===0;do{if(t===i)return null;for(R=!1;TL.test(X=h(t));)if(X===`
`&&(Xe=!0,++r),++t===i)return null;if(h(t)==="/"){if(++t===i)throw l("comment");if(h(t)==="/")if(e){if(re=t,Le=!1,m(t-1)){Le=!0;do if(t=p(t),t===i||(t++,!Xe))break;while(m(t))}else t=Math.min(i,p(t)+1);Le&&(d(re,t,Xe),Xe=!0),r++,R=!0}else{for(Le=h(re=t+1)==="/";h(++t)!==`
`;)if(t===i)return null;++t,Le&&(d(re,t-1,Xe),Xe=!0),++r,R=!0}else if((X=h(t))==="*"){re=t+1,Le=e||h(re)==="*";do{if(X===`
`&&++r,++t===i)throw l("comment");U=X,X=h(t)}while(U!=="*"||X!=="/");++t,Le&&(d(re,t-2,Xe),Xe=!0),R=!0}else return"/"}}while(R);var ve=t;$d.lastIndex=0;var z=$d.test(h(ve++));if(!z)for(;ve<i&&!$d.test(h(ve));)++ve;var Be=n.substring(t,t=ve);return(Be==='"'||Be==="'")&&(c=Be),Be}function w(R){a.push(R)}function A(){if(!a.length){var R=v();if(R===null)return null;w(R)}return a[0]}function _(R,U){var X=A(),re=X===R;if(re)return v(),!0;if(!U)throw l("token '"+X+"', '"+R+"' expected");return!1}function k(R){var U=null,X;return R===void 0?(X=o[r-1],delete o[r-1],X&&(e||X.type==="*"||X.lineEmpty)&&(U=X.leading?X.text:null)):(s<R&&A(),X=o[R],delete o[R],X&&!X.lineEmpty&&(e||X.type==="/")&&(U=X.leading?null:X.text)),U}return Object.defineProperty({next:v,peek:A,push:w,skip:_,cmnt:k},"line",{get:function(){return r}})}});var Yb=T((CJ,$b)=>{"use strict";$b.exports=Mr;Mr.filename=null;Mr.defaults={keepCase:!1};var zL=Yd(),Ub=I3(),jb=z3(),Wb=us(),xL=C3(),Gb=$a(),OL=_i(),IL=S3(),AL=_3(),Kd=mo(),Qd=Ft(),DL=/^[1-9][0-9]*$/,kL=/^-?[1-9][0-9]*$/,RL=/^0[x][0-9a-fA-F]+$/,LL=/^-?0[x][0-9a-fA-F]+$/,VL=/^0[0-7]+$/,NL=/^-?0[0-7]+$/,PL=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,Ji=/^[a-zA-Z_][a-zA-Z_0-9]*$/,er=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,HL=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function Mr(n,e,t){e instanceof Ub||(t=e,e=new Ub),t||(t=Mr.defaults);var i=t.preferTrailingComment||!1,r=zL(n,t.alternateCommentMode||!1),s=r.next,o=r.push,a=r.peek,c=r.skip,l=r.cmnt,u=!0,h,d,m,p,v=!1,w=e,A=t.keepCase?function(C){return C}:Qd.camelCase;function _(C,E,P){var ee=Mr.filename;return P||(Mr.filename=null),Error("illegal "+(E||"token")+" '"+C+"' ("+(ee?ee+", ":"")+"line "+r.line+")")}function k(){var C=[],E;do{if((E=s())!=='"'&&E!=="'")throw _(E);C.push(s()),c(E),E=a()}while(E==='"'||E==="'");return C.join("")}function R(C){var E=s();switch(E){case"'":case'"':return o(E),k();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return X(E,!0)}catch{if(C&&er.test(E))return E;throw _(E,"value")}}function U(C,E){var P,ee;do E&&((P=a())==='"'||P==="'")?C.push(k()):C.push([ee=re(s()),c("to",!0)?re(s()):ee]);while(c(",",!0));c(";")}function X(C,E){var P=1;switch(C.charAt(0)==="-"&&(P=-1,C=C.substring(1)),C){case"inf":case"INF":case"Inf":return P*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(DL.test(C))return P*parseInt(C,10);if(RL.test(C))return P*parseInt(C,16);if(VL.test(C))return P*parseInt(C,8);if(PL.test(C))return P*parseFloat(C);throw _(C,"number",E)}function re(C,E){switch(C){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!E&&C.charAt(0)==="-")throw _(C,"id");if(kL.test(C))return parseInt(C,10);if(LL.test(C))return parseInt(C,16);if(NL.test(C))return parseInt(C,8);throw _(C,"id")}function Le(){if(h!==void 0)throw _("package");if(h=s(),!er.test(h))throw _(h,"name");w=w.define(h),c(";")}function Xe(){var C=a(),E;switch(C){case"weak":E=m||(m=[]),s();break;case"public":s();default:E=d||(d=[]);break}C=k(),c(";"),E.push(C)}function ve(){if(c("="),p=k(),v=p==="proto3",!v&&p!=="proto2")throw _(p,"syntax");c(";")}function z(C,E){switch(E){case"option":return qe(C,E),c(";"),!0;case"message":return x(C,E),!0;case"enum":return ke(C,E),!0;case"service":return ct(C,E),!0;case"extend":return fi(C,E),!0}return!1}function Be(C,E,P){var ee=r.line;if(C&&(typeof C.comment!="string"&&(C.comment=l()),C.filename=Mr.filename),c("{",!0)){for(var Z;(Z=s())!=="}";)E(Z);c(";",!0)}else P&&P(),c(";"),C&&(typeof C.comment!="string"||i)&&(C.comment=l(ee)||C.comment)}function x(C,E){if(!Ji.test(E=s()))throw _(E,"type name");var P=new jb(E);Be(P,function(Z){if(!z(P,Z))switch(Z){case"map":se(P,Z);break;case"required":case"repeated":f(P,Z);break;case"optional":v?f(P,"proto3_optional"):f(P,"optional");break;case"oneof":Oe(P,Z);break;case"extensions":U(P.extensions||(P.extensions=[]));break;case"reserved":U(P.reserved||(P.reserved=[]),!0);break;default:if(!v||!er.test(Z))throw _(Z);o(Z),f(P,"optional");break}}),C.add(P)}function f(C,E,P){var ee=s();if(ee==="group"){V(C,E);return}for(;ee.endsWith(".")||a().startsWith(".");)ee+=s();if(!er.test(ee))throw _(ee,"type");var Z=s();if(!Ji.test(Z))throw _(Z,"name");Z=A(Z),c("=");var fe=new Wb(Z,re(s()),ee,E,P);if(Be(fe,function(Dn){if(Dn==="option")qe(fe,Dn),c(";");else throw _(Dn)},function(){yt(fe)}),E==="proto3_optional"){var Mt=new Gb("_"+Z);fe.setOption("proto3_optional",!0),Mt.add(fe),C.add(Mt)}else C.add(fe);!v&&fe.repeated&&(Kd.packed[ee]!==void 0||Kd.basic[ee]===void 0)&&fe.setOption("packed",!1,!0)}function V(C,E){var P=s();if(!Ji.test(P))throw _(P,"name");var ee=Qd.lcFirst(P);P===ee&&(P=Qd.ucFirst(P)),c("=");var Z=re(s()),fe=new jb(P);fe.group=!0;var Mt=new Wb(ee,Z,P,E);Mt.filename=Mr.filename,Be(fe,function(Dn){switch(Dn){case"option":qe(fe,Dn),c(";");break;case"required":case"repeated":f(fe,Dn);break;case"optional":v?f(fe,"proto3_optional"):f(fe,"optional");break;case"message":x(fe,Dn);break;case"enum":ke(fe,Dn);break;default:throw _(Dn)}}),C.add(fe).add(Mt)}function se(C){c("<");var E=s();if(Kd.mapKey[E]===void 0)throw _(E,"type");c(",");var P=s();if(!er.test(P))throw _(P,"type");c(">");var ee=s();if(!Ji.test(ee))throw _(ee,"name");c("=");var Z=new xL(A(ee),re(s()),E,P);Be(Z,function(Mt){if(Mt==="option")qe(Z,Mt),c(";");else throw _(Mt)},function(){yt(Z)}),C.add(Z)}function Oe(C,E){if(!Ji.test(E=s()))throw _(E,"name");var P=new Gb(A(E));Be(P,function(Z){Z==="option"?(qe(P,Z),c(";")):(o(Z),f(P,"optional"))}),C.add(P)}function ke(C,E){if(!Ji.test(E=s()))throw _(E,"name");var P=new OL(E);Be(P,function(Z){switch(Z){case"option":qe(P,Z),c(";");break;case"reserved":U(P.reserved||(P.reserved=[]),!0);break;default:it(P,Z)}}),C.add(P)}function it(C,E){if(!Ji.test(E))throw _(E,"name");c("=");var P=re(s(),!0),ee={options:void 0};ee.setOption=function(Z,fe){this.options===void 0&&(this.options={}),this.options[Z]=fe},Be(ee,function(fe){if(fe==="option")qe(ee,fe),c(";");else throw _(fe)},function(){yt(ee)}),C.add(E,P,ee.comment,ee.options)}function qe(C,E){var P=c("(",!0);if(!er.test(E=s()))throw _(E,"name");var ee=E,Z=ee,fe;P&&(c(")"),ee="("+ee+")",Z=ee,E=a(),HL.test(E)&&(fe=E.slice(1),ee+=E,s())),c("=");var Mt=Dt(C,ee);Ze(C,Z,Mt,fe)}function Dt(C,E){if(c("{",!0)){for(var P={};!c("}",!0);){if(!Ji.test(ye=s()))throw _(ye,"name");if(ye===null)throw _(ye,"end of input");var ee,Z=ye;if(c(":",!0),a()==="{")ee=Dt(C,E+"."+ye);else if(a()==="["){ee=[];var fe;if(c("[",!0)){do fe=R(!0),ee.push(fe);while(c(",",!0));c("]"),typeof fe<"u"&&Ge(C,E+"."+ye,fe)}}else ee=R(!0),Ge(C,E+"."+ye,ee);var Mt=P[Z];Mt&&(ee=[].concat(Mt).concat(ee)),P[Z]=ee,c(",",!0),c(";",!0)}return P}var Wr=R(!0);return Ge(C,E,Wr),Wr}function Ge(C,E,P){C.setOption&&C.setOption(E,P)}function Ze(C,E,P,ee){C.setParsedOption&&C.setParsedOption(E,P,ee)}function yt(C){if(c("[",!0)){do qe(C,"option");while(c(",",!0));c("]")}return C}function ct(C,E){if(!Ji.test(E=s()))throw _(E,"service name");var P=new IL(E);Be(P,function(Z){if(!z(P,Z))if(Z==="rpc")Vt(P,Z);else throw _(Z)}),C.add(P)}function Vt(C,E){var P=l(),ee=E;if(!Ji.test(E=s()))throw _(E,"name");var Z=E,fe,Mt,Wr,Dn;if(c("("),c("stream",!0)&&(Mt=!0),!er.test(E=s())||(fe=E,c(")"),c("returns"),c("("),c("stream",!0)&&(Dn=!0),!er.test(E=s())))throw _(E);Wr=E,c(")");var Z2=new AL(Z,ee,fe,Wr,Mt,Dn);Z2.comment=P,Be(Z2,function(su){if(su==="option")qe(Z2,su),c(";");else throw _(su)}),C.add(Z2)}function fi(C,E){if(!er.test(E=s()))throw _(E,"reference");var P=E;Be(null,function(Z){switch(Z){case"required":case"repeated":f(C,Z,P);break;case"optional":v?f(C,"proto3_optional",P):f(C,"optional",P);break;default:if(!v||!er.test(Z))throw _(Z);o(Z),f(C,"optional",P);break}})}for(var ye;(ye=s())!==null;)switch(ye){case"package":if(!u)throw _(ye);Le();break;case"import":if(!u)throw _(ye);Xe();break;case"syntax":if(!u)throw _(ye);ve();break;case"option":qe(w,ye),c(";");break;default:if(z(w,ye)){u=!1;continue}throw _(ye)}return Mr.filename=null,{package:h,imports:d,weakImports:m,syntax:p,root:e}}});var Xb=T((_J,Qb)=>{"use strict";Qb.exports=Ti;var BL=/\/|\./;function Ti(n,e){BL.test(n)||(n="google/protobuf/"+n+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),Ti[n]=e}Ti("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var Kb;Ti("duration",{Duration:Kb={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});Ti("timestamp",{Timestamp:Kb});Ti("empty",{Empty:{fields:{}}});Ti("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});Ti("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});Ti("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});Ti.get=function(e){return Ti[e]||null}});var Jb=T((SJ,Zb)=>{"use strict";var fs=Zb.exports=Hb();fs.build="full";fs.tokenize=Yd();fs.parse=Yb();fs.common=Xb();fs.Root._configure(fs.Type,fs.parse,fs.common)});var R3=T((TJ,eC)=>{"use strict";eC.exports=Jb()});var Xd=T((EJ,FL)=>{FL.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var sC=T((pe,rC)=>{"use strict";var mn=R3();rC.exports=pe=mn.descriptor=mn.Root.fromJSON(Xd()).lookup(".google.protobuf");var tC=mn.Namespace,p4=mn.Root,zr=mn.Enum,ms=mn.Type,ps=mn.Field,qL=mn.MapField,L3=mn.OneOf,g4=mn.Service,V3=mn.Method;p4.fromDescriptor=function(e){typeof e.length=="number"&&(e=pe.FileDescriptorSet.decode(e));var t=new p4;if(e.file)for(var i,r,s=0,o;s<e.file.length;++s){if(r=t,(i=e.file[s]).package&&i.package.length&&(r=t.define(i.package)),i.name&&i.name.length&&t.files.push(r.filename=i.name),i.messageType)for(o=0;o<i.messageType.length;++o)r.add(ms.fromDescriptor(i.messageType[o],i.syntax));if(i.enumType)for(o=0;o<i.enumType.length;++o)r.add(zr.fromDescriptor(i.enumType[o]));if(i.extension)for(o=0;o<i.extension.length;++o)r.add(ps.fromDescriptor(i.extension[o]));if(i.service)for(o=0;o<i.service.length;++o)r.add(g4.fromDescriptor(i.service[o]));var a=Za(i.options,pe.FileOptions);if(a){var c=Object.keys(a);for(o=0;o<c.length;++o)r.setOption(c[o],a[c[o]])}}return t};p4.prototype.toDescriptor=function(e){var t=pe.FileDescriptorSet.create();return nC(this,t.file,e),t};function nC(n,e,t){var i=pe.FileDescriptorProto.create({name:n.filename||(n.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});t&&(i.syntax=t),n instanceof p4||(i.package=n.fullName.substring(1));for(var r=0,s;r<n.nestedArray.length;++r)(s=n._nestedArray[r])instanceof ms?i.messageType.push(s.toDescriptor(t)):s instanceof zr?i.enumType.push(s.toDescriptor()):s instanceof ps?i.extension.push(s.toDescriptor(t)):s instanceof g4?i.service.push(s.toDescriptor()):s instanceof tC&&nC(s,e,t);i.options=Ja(n.options,pe.FileOptions),i.messageType.length+i.enumType.length+i.extension.length+i.service.length&&e.push(i)}var UL=0;ms.fromDescriptor=function(e,t){typeof e.length=="number"&&(e=pe.DescriptorProto.decode(e));var i=new ms(e.name.length?e.name:"Type"+UL++,Za(e.options,pe.MessageOptions)),r;if(e.oneofDecl)for(r=0;r<e.oneofDecl.length;++r)i.add(L3.fromDescriptor(e.oneofDecl[r]));if(e.field)for(r=0;r<e.field.length;++r){var s=ps.fromDescriptor(e.field[r],t);i.add(s),e.field[r].hasOwnProperty("oneofIndex")&&i.oneofsArray[e.field[r].oneofIndex].add(s)}if(e.extension)for(r=0;r<e.extension.length;++r)i.add(ps.fromDescriptor(e.extension[r],t));if(e.nestedType)for(r=0;r<e.nestedType.length;++r)i.add(ms.fromDescriptor(e.nestedType[r],t)),e.nestedType[r].options&&e.nestedType[r].options.mapEntry&&i.setOption("map_entry",!0);if(e.enumType)for(r=0;r<e.enumType.length;++r)i.add(zr.fromDescriptor(e.enumType[r]));if(e.extensionRange&&e.extensionRange.length)for(i.extensions=[],r=0;r<e.extensionRange.length;++r)i.extensions.push([e.extensionRange[r].start,e.extensionRange[r].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(i.reserved=[],e.reservedRange)for(r=0;r<e.reservedRange.length;++r)i.reserved.push([e.reservedRange[r].start,e.reservedRange[r].end]);if(e.reservedName)for(r=0;r<e.reservedName.length;++r)i.reserved.push(e.reservedName[r])}return i};ms.prototype.toDescriptor=function(e){var t=pe.DescriptorProto.create({name:this.name}),i;for(i=0;i<this.fieldsArray.length;++i){var r;if(t.field.push(r=this._fieldsArray[i].toDescriptor(e)),this._fieldsArray[i]instanceof qL){var s=Zd(this._fieldsArray[i].keyType,this._fieldsArray[i].resolvedKeyType),o=Zd(this._fieldsArray[i].type,this._fieldsArray[i].resolvedType),a=o===11||o===14?this._fieldsArray[i].resolvedType&&iC(this.parent,this._fieldsArray[i].resolvedType)||this._fieldsArray[i].type:void 0;t.nestedType.push(pe.DescriptorProto.create({name:r.typeName,field:[pe.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),pe.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:pe.MessageOptions.create({mapEntry:!0})}))}}for(i=0;i<this.oneofsArray.length;++i)t.oneofDecl.push(this._oneofsArray[i].toDescriptor());for(i=0;i<this.nestedArray.length;++i)this._nestedArray[i]instanceof ps?t.field.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof ms?t.nestedType.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof zr&&t.enumType.push(this._nestedArray[i].toDescriptor());if(this.extensions)for(i=0;i<this.extensions.length;++i)t.extensionRange.push(pe.DescriptorProto.ExtensionRange.create({start:this.extensions[i][0],end:this.extensions[i][1]}));if(this.reserved)for(i=0;i<this.reserved.length;++i)typeof this.reserved[i]=="string"?t.reservedName.push(this.reserved[i]):t.reservedRange.push(pe.DescriptorProto.ReservedRange.create({start:this.reserved[i][0],end:this.reserved[i][1]}));return t.options=Ja(this.options,pe.MessageOptions),t};var jL=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;ps.fromDescriptor=function(e,t){if(typeof e.length=="number"&&(e=pe.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var i;e.typeName&&e.typeName.length?i=e.typeName:i=KL(e.type);var r;switch(e.label){case 1:r=void 0;break;case 2:r="required";break;case 3:r="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;e.extendee!==void 0&&(s=s.length?s:void 0);var o=new ps(e.name.length?e.name:"field"+e.number,e.number,i,r,s);if(o.options=Za(e.options,pe.FieldOptions),e.defaultValue&&e.defaultValue.length){var a=e.defaultValue;switch(a){case"true":case"TRUE":a=!0;break;case"false":case"FALSE":a=!1;break;default:var c=jL.exec(a);c&&(a=parseInt(a));break}o.setOption("default",a)}return QL(e.type)&&(t==="proto3"?e.options&&!e.options.packed&&o.setOption("packed",!1):e.options&&e.options.packed||o.setOption("packed",!1)),o};ps.prototype.toDescriptor=function(e){var t=pe.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=mn.util.ucFirst(this.name),t.label=3;else{switch(t.type=Zd(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:t.typeName=this.resolvedType?iC(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":t.label=3;break;case"required":t.label=2;break;default:t.label=1;break}}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=Ja(this.options,pe.FieldOptions),this.options.default!=null&&(t.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((t.options||(t.options=pe.FieldOptions.create())).packed=!1):this.packed&&((t.options||(t.options=pe.FieldOptions.create())).packed=!0),t};var WL=0;zr.fromDescriptor=function(e){typeof e.length=="number"&&(e=pe.EnumDescriptorProto.decode(e));var t={};if(e.value)for(var i=0;i<e.value.length;++i){var r=e.value[i].name,s=e.value[i].number||0;t[r&&r.length?r:"NAME"+s]=s}return new zr(e.name&&e.name.length?e.name:"Enum"+WL++,t,Za(e.options,pe.EnumOptions))};zr.prototype.toDescriptor=function(){for(var e=[],t=0,i=Object.keys(this.values);t<i.length;++t)e.push(pe.EnumValueDescriptorProto.create({name:i[t],number:this.values[i[t]]}));return pe.EnumDescriptorProto.create({name:this.name,value:e,options:Ja(this.options,pe.EnumOptions)})};var GL=0;L3.fromDescriptor=function(e){return typeof e.length=="number"&&(e=pe.OneofDescriptorProto.decode(e)),new L3(e.name&&e.name.length?e.name:"oneof"+GL++)};L3.prototype.toDescriptor=function(){return pe.OneofDescriptorProto.create({name:this.name})};var $L=0;g4.fromDescriptor=function(e){typeof e.length=="number"&&(e=pe.ServiceDescriptorProto.decode(e));var t=new g4(e.name&&e.name.length?e.name:"Service"+$L++,Za(e.options,pe.ServiceOptions));if(e.method)for(var i=0;i<e.method.length;++i)t.add(V3.fromDescriptor(e.method[i]));return t};g4.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return pe.ServiceDescriptorProto.create({name:this.name,method:e,options:Ja(this.options,pe.ServiceOptions)})};var YL=0;V3.fromDescriptor=function(e){return typeof e.length=="number"&&(e=pe.MethodDescriptorProto.decode(e)),new V3(e.name&&e.name.length?e.name:"Method"+YL++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,Za(e.options,pe.MethodOptions))};V3.prototype.toDescriptor=function(){return pe.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:Ja(this.options,pe.MethodOptions)})};function KL(n){switch(n){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+n)}function QL(n){switch(n){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function Zd(n,e){switch(n){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof zr)return 14;if(e instanceof ms)return e.group?10:11;throw Error("illegal type: "+n)}function Za(n,e){if(n){for(var t=[],i=0,r,s,o;i<e.fieldsArray.length;++i)(s=(r=e._fieldsArray[i]).name)!=="uninterpretedOption"&&n.hasOwnProperty(s)&&(o=n[s],r.resolvedType instanceof zr&&typeof o=="number"&&r.resolvedType.valuesById[o]!==void 0&&(o=r.resolvedType.valuesById[o]),t.push(XL(s),o));return t.length?mn.util.toObject(t):void 0}}function Ja(n,e){if(n){for(var t=[],i=0,r=Object.keys(n),s,o;i<r.length;++i)if(o=n[s=r[i]],s!=="default"){var a=e.fields[s];!a&&!(a=e.fields[s=mn.util.camelCase(s)])||t.push(s,o)}return t.length?e.fromObject(mn.util.toObject(t)):void 0}}function iC(n,e){var t=n.fullName.split("."),i=e.fullName.split("."),r=0,s=0,o=i.length-1;if(!(n instanceof p4)&&e instanceof tC)for(;r<t.length&&s<o&&t[r]===i[s];){var a=e.lookup(t[r++],!0);if(a!==null&&a!==e)break;++s}else for(;r<t.length&&s<o&&t[r]===i[s];++r,++s);return i.slice(s).join(".")}function XL(n){return n.substring(0,1)+n.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}});var oC=T((MJ,ZL)=>{ZL.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var aC=T((zJ,JL)=>{JL.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var cC=T((xJ,eV)=>{eV.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var dC=T(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.addCommonProtos=gs.loadProtosWithOptionsSync=gs.loadProtosWithOptions=void 0;var lC=Re("fs"),uC=Re("path"),e1=R3();function hC(n,e){let t=n.resolvePath;n.resolvePath=(i,r)=>{if(uC.isAbsolute(r))return r;for(let s of e){let o=uC.join(s,r);try{return lC.accessSync(o,lC.constants.R_OK),o}catch{continue}}return process.emitWarning(`${r} not found in any of the include paths ${e}`),t(i,r)}}function tV(n,e){return g(this,null,function*(){let t=new e1.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));hC(t,e.includeDirs)}let i=yield t.load(n,e);return i.resolveAll(),i})}gs.loadProtosWithOptions=tV;function nV(n,e){let t=new e1.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");hC(t,e.includeDirs)}let i=t.loadSync(n,e);return i.resolveAll(),i}gs.loadProtosWithOptionsSync=nV;function iV(){let n=oC(),e=Xd(),t=aC(),i=cC();e1.common("api",n.nested.google.nested.protobuf.nested),e1.common("descriptor",e.nested.google.nested.protobuf.nested),e1.common("source_context",t.nested.google.nested.protobuf.nested),e1.common("type",i.nested.google.nested.protobuf.nested)}gs.addCommonProtos=iV});var pC=T((mC,Jd)=>{"use strict";var fC=function(n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(x,f,V){this.low=x|0,this.high=f|0,this.unsigned=!!V}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function i(x){return(x&&x.__isLong__)===!0}function r(x){var f=Math.clz32(x&-x);return x?31-f:f}t.isLong=i;var s={},o={};function a(x,f){var V,se,Oe;return f?(x>>>=0,(Oe=0<=x&&x<256)&&(se=o[x],se)?se:(V=l(x,0,!0),Oe&&(o[x]=V),V)):(x|=0,(Oe=-128<=x&&x<128)&&(se=s[x],se)?se:(V=l(x,x<0?-1:0,!1),Oe&&(s[x]=V),V))}t.fromInt=a;function c(x,f){if(isNaN(x))return f?R:k;if(f){if(x<0)return R;if(x>=w)return Xe}else{if(x<=-A)return ve;if(x+1>=A)return Le}return x<0?c(-x,f).neg():l(x%v|0,x/v|0,f)}t.fromNumber=c;function l(x,f,V){return new t(x,f,V)}t.fromBits=l;var u=Math.pow;function h(x,f,V){if(x.length===0)throw Error("empty string");if(typeof f=="number"?(V=f,f=!1):f=!!f,x==="NaN"||x==="Infinity"||x==="+Infinity"||x==="-Infinity")return f?R:k;if(V=V||10,V<2||36<V)throw RangeError("radix");var se;if((se=x.indexOf("-"))>0)throw Error("interior hyphen");if(se===0)return h(x.substring(1),f,V).neg();for(var Oe=c(u(V,8)),ke=k,it=0;it<x.length;it+=8){var qe=Math.min(8,x.length-it),Dt=parseInt(x.substring(it,it+qe),V);if(qe<8){var Ge=c(u(V,qe));ke=ke.mul(Ge).add(c(Dt))}else ke=ke.mul(Oe),ke=ke.add(c(Dt))}return ke.unsigned=f,ke}t.fromString=h;function d(x,f){return typeof x=="number"?c(x,f):typeof x=="string"?h(x,f):l(x.low,x.high,typeof f=="boolean"?f:x.unsigned)}t.fromValue=d;var m=65536,p=1<<24,v=m*m,w=v*v,A=w/2,_=a(p),k=a(0);t.ZERO=k;var R=a(0,!0);t.UZERO=R;var U=a(1);t.ONE=U;var X=a(1,!0);t.UONE=X;var re=a(-1);t.NEG_ONE=re;var Le=l(-1,2147483647,!1);t.MAX_VALUE=Le;var Xe=l(-1,-1,!0);t.MAX_UNSIGNED_VALUE=Xe;var ve=l(0,-2147483648,!1);t.MIN_VALUE=ve;var z=t.prototype;z.toInt=function(){return this.unsigned?this.low>>>0:this.low},z.toNumber=function(){return this.unsigned?(this.high>>>0)*v+(this.low>>>0):this.high*v+(this.low>>>0)},z.toString=function(f){if(f=f||10,f<2||36<f)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ve)){var V=c(f),se=this.div(V),Oe=se.mul(V).sub(this);return se.toString(f)+Oe.toInt().toString(f)}else return"-"+this.neg().toString(f);for(var ke=c(u(f,6),this.unsigned),it=this,qe="";;){var Dt=it.div(ke),Ge=it.sub(Dt.mul(ke)).toInt()>>>0,Ze=Ge.toString(f);if(it=Dt,it.isZero())return Ze+qe;for(;Ze.length<6;)Ze="0"+Ze;qe=""+Ze+qe}},z.getHighBits=function(){return this.high},z.getHighBitsUnsigned=function(){return this.high>>>0},z.getLowBits=function(){return this.low},z.getLowBitsUnsigned=function(){return this.low>>>0},z.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ve)?64:this.neg().getNumBitsAbs();for(var f=this.high!=0?this.high:this.low,V=31;V>0&&!(f&1<<V);V--);return this.high!=0?V+33:V+1},z.isZero=function(){return this.high===0&&this.low===0},z.eqz=z.isZero,z.isNegative=function(){return!this.unsigned&&this.high<0},z.isPositive=function(){return this.unsigned||this.high>=0},z.isOdd=function(){return(this.low&1)===1},z.isEven=function(){return(this.low&1)===0},z.equals=function(f){return i(f)||(f=d(f)),this.unsigned!==f.unsigned&&this.high>>>31===1&&f.high>>>31===1?!1:this.high===f.high&&this.low===f.low},z.eq=z.equals,z.notEquals=function(f){return!this.eq(f)},z.neq=z.notEquals,z.ne=z.notEquals,z.lessThan=function(f){return this.comp(f)<0},z.lt=z.lessThan,z.lessThanOrEqual=function(f){return this.comp(f)<=0},z.lte=z.lessThanOrEqual,z.le=z.lessThanOrEqual,z.greaterThan=function(f){return this.comp(f)>0},z.gt=z.greaterThan,z.greaterThanOrEqual=function(f){return this.comp(f)>=0},z.gte=z.greaterThanOrEqual,z.ge=z.greaterThanOrEqual,z.compare=function(f){if(i(f)||(f=d(f)),this.eq(f))return 0;var V=this.isNegative(),se=f.isNegative();return V&&!se?-1:!V&&se?1:this.unsigned?f.high>>>0>this.high>>>0||f.high===this.high&&f.low>>>0>this.low>>>0?-1:1:this.sub(f).isNegative()?-1:1},z.comp=z.compare,z.negate=function(){return!this.unsigned&&this.eq(ve)?ve:this.not().add(U)},z.neg=z.negate,z.add=function(f){i(f)||(f=d(f));var V=this.high>>>16,se=this.high&65535,Oe=this.low>>>16,ke=this.low&65535,it=f.high>>>16,qe=f.high&65535,Dt=f.low>>>16,Ge=f.low&65535,Ze=0,yt=0,ct=0,Vt=0;return Vt+=ke+Ge,ct+=Vt>>>16,Vt&=65535,ct+=Oe+Dt,yt+=ct>>>16,ct&=65535,yt+=se+qe,Ze+=yt>>>16,yt&=65535,Ze+=V+it,Ze&=65535,l(ct<<16|Vt,Ze<<16|yt,this.unsigned)},z.subtract=function(f){return i(f)||(f=d(f)),this.add(f.neg())},z.sub=z.subtract,z.multiply=function(f){if(this.isZero())return this;if(i(f)||(f=d(f)),e){var V=e.mul(this.low,this.high,f.low,f.high);return l(V,e.get_high(),this.unsigned)}if(f.isZero())return this.unsigned?R:k;if(this.eq(ve))return f.isOdd()?ve:k;if(f.eq(ve))return this.isOdd()?ve:k;if(this.isNegative())return f.isNegative()?this.neg().mul(f.neg()):this.neg().mul(f).neg();if(f.isNegative())return this.mul(f.neg()).neg();if(this.lt(_)&&f.lt(_))return c(this.toNumber()*f.toNumber(),this.unsigned);var se=this.high>>>16,Oe=this.high&65535,ke=this.low>>>16,it=this.low&65535,qe=f.high>>>16,Dt=f.high&65535,Ge=f.low>>>16,Ze=f.low&65535,yt=0,ct=0,Vt=0,fi=0;return fi+=it*Ze,Vt+=fi>>>16,fi&=65535,Vt+=ke*Ze,ct+=Vt>>>16,Vt&=65535,Vt+=it*Ge,ct+=Vt>>>16,Vt&=65535,ct+=Oe*Ze,yt+=ct>>>16,ct&=65535,ct+=ke*Ge,yt+=ct>>>16,ct&=65535,ct+=it*Dt,yt+=ct>>>16,ct&=65535,yt+=se*Ze+Oe*Ge+ke*Dt+it*qe,yt&=65535,l(Vt<<16|fi,yt<<16|ct,this.unsigned)},z.mul=z.multiply,z.divide=function(f){if(i(f)||(f=d(f)),f.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&f.low===-1&&f.high===-1)return this;var V=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,f.low,f.high);return l(V,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?R:k;var se,Oe,ke;if(this.unsigned){if(f.unsigned||(f=f.toUnsigned()),f.gt(this))return R;if(f.gt(this.shru(1)))return X;ke=R}else{if(this.eq(ve)){if(f.eq(U)||f.eq(re))return ve;if(f.eq(ve))return U;var it=this.shr(1);return se=it.div(f).shl(1),se.eq(k)?f.isNegative()?U:re:(Oe=this.sub(f.mul(se)),ke=se.add(Oe.div(f)),ke)}else if(f.eq(ve))return this.unsigned?R:k;if(this.isNegative())return f.isNegative()?this.neg().div(f.neg()):this.neg().div(f).neg();if(f.isNegative())return this.div(f.neg()).neg();ke=k}for(Oe=this;Oe.gte(f);){se=Math.max(1,Math.floor(Oe.toNumber()/f.toNumber()));for(var qe=Math.ceil(Math.log(se)/Math.LN2),Dt=qe<=48?1:u(2,qe-48),Ge=c(se),Ze=Ge.mul(f);Ze.isNegative()||Ze.gt(Oe);)se-=Dt,Ge=c(se,this.unsigned),Ze=Ge.mul(f);Ge.isZero()&&(Ge=U),ke=ke.add(Ge),Oe=Oe.sub(Ze)}return ke},z.div=z.divide,z.modulo=function(f){if(i(f)||(f=d(f)),e){var V=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,f.low,f.high);return l(V,e.get_high(),this.unsigned)}return this.sub(this.div(f).mul(f))},z.mod=z.modulo,z.rem=z.modulo,z.not=function(){return l(~this.low,~this.high,this.unsigned)},z.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},z.clz=z.countLeadingZeros,z.countTrailingZeros=function(){return this.low?r(this.low):r(this.high)+32},z.ctz=z.countTrailingZeros,z.and=function(f){return i(f)||(f=d(f)),l(this.low&f.low,this.high&f.high,this.unsigned)},z.or=function(f){return i(f)||(f=d(f)),l(this.low|f.low,this.high|f.high,this.unsigned)},z.xor=function(f){return i(f)||(f=d(f)),l(this.low^f.low,this.high^f.high,this.unsigned)},z.shiftLeft=function(f){return i(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?l(this.low<<f,this.high<<f|this.low>>>32-f,this.unsigned):l(0,this.low<<f-32,this.unsigned)},z.shl=z.shiftLeft,z.shiftRight=function(f){return i(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?l(this.low>>>f|this.high<<32-f,this.high>>f,this.unsigned):l(this.high>>f-32,this.high>=0?0:-1,this.unsigned)},z.shr=z.shiftRight,z.shiftRightUnsigned=function(f){return i(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?l(this.low>>>f|this.high<<32-f,this.high>>>f,this.unsigned):f===32?l(this.high,0,this.unsigned):l(this.high>>>f-32,0,this.unsigned)},z.shru=z.shiftRightUnsigned,z.shr_u=z.shiftRightUnsigned,z.rotateLeft=function(f){var V;return i(f)&&(f=f.toInt()),(f&=63)===0?this:f===32?l(this.high,this.low,this.unsigned):f<32?(V=32-f,l(this.low<<f|this.high>>>V,this.high<<f|this.low>>>V,this.unsigned)):(f-=32,V=32-f,l(this.high<<f|this.low>>>V,this.low<<f|this.high>>>V,this.unsigned))},z.rotl=z.rotateLeft,z.rotateRight=function(f){var V;return i(f)&&(f=f.toInt()),(f&=63)===0?this:f===32?l(this.high,this.low,this.unsigned):f<32?(V=32-f,l(this.high<<V|this.low>>>f,this.low<<V|this.high>>>f,this.unsigned)):(f-=32,V=32-f,l(this.low<<V|this.high>>>f,this.high<<V|this.low>>>f,this.unsigned))},z.rotr=z.rotateRight,z.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},z.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},z.toBytes=function(f){return f?this.toBytesLE():this.toBytesBE()},z.toBytesLE=function(){var f=this.high,V=this.low;return[V&255,V>>>8&255,V>>>16&255,V>>>24,f&255,f>>>8&255,f>>>16&255,f>>>24]},z.toBytesBE=function(){var f=this.high,V=this.low;return[f>>>24,f>>>16&255,f>>>8&255,f&255,V>>>24,V>>>16&255,V>>>8&255,V&255]},t.fromBytes=function(f,V,se){return se?t.fromBytesLE(f,V):t.fromBytesBE(f,V)},t.fromBytesLE=function(f,V){return new t(f[0]|f[1]<<8|f[2]<<16|f[3]<<24,f[4]|f[5]<<8|f[6]<<16|f[7]<<24,V)},t.fromBytesBE=function(f,V){return new t(f[4]<<24|f[5]<<16|f[6]<<8|f[7],f[0]<<24|f[1]<<16|f[2]<<8|f[3],V)};var Be=t;return n.default=Be,"default"in n?n.default:n}({});typeof define=="function"&&define.amd?define([],function(){return fC}):typeof Jd=="object"&&typeof mC=="object"&&(Jd.exports=fC)});var i5=T(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.loadFileDescriptorSetFromObject=nn.loadFileDescriptorSetFromBuffer=nn.fromJSON=nn.loadSync=nn.load=nn.isAnyExtension=nn.Long=void 0;var rV=nw(),tr=R3(),t5=sC(),n5=dC(),sV=pC();nn.Long=sV;function oV(n){return"@type"in n&&typeof n["@type"]=="string"}nn.isAnyExtension=oV;var yC={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function aV(n,e){return n===""?e:n+"."+e}function cV(n){return n instanceof tr.Service||n instanceof tr.Type||n instanceof tr.Enum}function lV(n){return n instanceof tr.Namespace||n instanceof tr.Root}function wC(n,e){let t=aV(e,n.name);return cV(n)?[[t,n]]:lV(n)&&typeof n.nested<"u"?Object.keys(n.nested).map(i=>wC(n.nested[i],t)).reduce((i,r)=>i.concat(r),[]):[]}function gC(n,e){return function(i){return n.toObject(n.decode(i),e)}}function vC(n){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${n.name} structure, got array instead`);let i=n.fromObject(t);return n.encode(i).finish()}}function uV(n,e,t,i){let r=n.resolvedRequestType,s=n.resolvedResponseType;return{path:"/"+e+"/"+n.name,requestStream:!!n.requestStream,responseStream:!!n.responseStream,requestSerialize:vC(r),requestDeserialize:gC(r,t),responseSerialize:vC(s),responseDeserialize:gC(s,t),originalName:rV(n.name),requestType:e5(r,i),responseType:e5(s,i)}}function hV(n,e,t,i){let r={};for(let s of n.methodsArray)r[s.name]=uV(s,e,t,i);return r}function e5(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:t.$type.toObject(t,yC),fileDescriptorProtos:e}}function dV(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:t.$type.toObject(t,yC),fileDescriptorProtos:e}}function fV(n,e,t,i){if(n instanceof tr.Service)return hV(n,e,t,i);if(n instanceof tr.Type)return e5(n,i);if(n instanceof tr.Enum)return dV(n,i);throw new Error("Type mismatch in reflection object handling")}function N3(n,e){let t={};n.resolveAll();let r=n.toDescriptor("proto3").file.map(s=>Buffer.from(t5.FileDescriptorProto.encode(s).finish()));for(let[s,o]of wC(n,""))t[s]=fV(o,s,e,r);return t}function bC(n,e){e=e||{};let t=tr.Root.fromDescriptor(n);return t.resolveAll(),N3(t,e)}function mV(n,e){return(0,n5.loadProtosWithOptions)(n,e).then(t=>N3(t,e))}nn.load=mV;function pV(n,e){let t=(0,n5.loadProtosWithOptionsSync)(n,e);return N3(t,e)}nn.loadSync=pV;function gV(n,e){e=e||{};let t=tr.Root.fromJSON(n);return t.resolveAll(),N3(t,e)}nn.fromJSON=gV;function vV(n,e){let t=t5.FileDescriptorSet.decode(n);return bC(t,e)}nn.loadFileDescriptorSetFromBuffer=vV;function yV(n,e){let t=t5.FileDescriptorSet.fromObject(n);return bC(t,e)}nn.loadFileDescriptorSetFromObject=yV;(0,n5.addCommonProtos)()});var vo=T(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});rt.setup=rt.getChannelzServiceDefinition=rt.getChannelzHandlers=rt.unregisterChannelzRef=rt.registerChannelzSocket=rt.registerChannelzServer=rt.registerChannelzSubchannel=rt.registerChannelzChannel=rt.ChannelzCallTracker=rt.ChannelzChildrenTracker=rt.ChannelzTrace=void 0;var CC=Re("net"),v4=Qn(),w4=Ie(),wV=Gi(),bV=r3(),CV=ed();function r5(n){return{channel_id:n.id,name:n.name}}function c5(n){return{subchannel_id:n.id,name:n.name}}function _V(n){return{server_id:n.id}}function H3(n){return{socket_id:n.id,name:n.name}}var _C=32,s5=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,i){let r=new Date;this.events.push({description:t,severity:e,timestamp:r,childChannel:i?.kind==="channel"?i:void 0,childSubchannel:i?.kind==="subchannel"?i:void 0}),this.events.length>=_C*2&&(this.events=this.events.slice(_C)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:xr(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:xr(e.timestamp),channel_ref:e.childChannel?r5(e.childChannel):null,subchannel_ref:e.childSubchannel?c5(e.childSubchannel):null}))}}};rt.ChannelzTrace=s5;var o5=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,i,r;switch(e.kind){case"channel":{let s=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(i=this.subchannelChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(r=this.socketChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){let e=[];for(let{ref:r}of this.channelChildren.values())e.push(r);let t=[];for(let{ref:r}of this.subchannelChildren.values())t.push(r);let i=[];for(let{ref:r}of this.socketChildren.values())i.push(r);return{channels:e,subchannels:t,sockets:i}}};rt.ChannelzChildrenTracker=o5;var a5=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};rt.ChannelzCallTracker=a5;var SV=1;function B3(){return SV++}var y4=[],l5=[],vs=[],u5=[];function TV(n,e,t){let i=B3(),r={id:i,name:n,kind:"channel"};return t&&(y4[i]={ref:r,getInfo:e}),r}rt.registerChannelzChannel=TV;function EV(n,e,t){let i=B3(),r={id:i,name:n,kind:"subchannel"};return t&&(l5[i]={ref:r,getInfo:e}),r}rt.registerChannelzSubchannel=EV;function MV(n,e){let t=B3(),i={id:t,kind:"server"};return e&&(vs[t]={ref:i,getInfo:n}),i}rt.registerChannelzServer=MV;function zV(n,e,t){let i=B3(),r={id:i,name:n,kind:"socket"};return t&&(u5[i]={ref:r,getInfo:e}),r}rt.registerChannelzSocket=zV;function xV(n){switch(n.kind){case"channel":delete y4[n.id];return;case"subchannel":delete l5[n.id];return;case"server":delete vs[n.id];return;case"socket":delete u5[n.id];return}}rt.unregisterChannelzRef=xV;function OV(n){let e=Number.parseInt(n,16);return[e/256|0,e%256]}function SC(n){if(n==="")return[];let e=n.split(":").map(i=>OV(i));return[].concat(...e)}function IV(n){if((0,CC.isIPv4)(n))return Buffer.from(Uint8Array.from(n.split(".").map(e=>Number.parseInt(e))));if((0,CC.isIPv6)(n)){let e,t,i=n.indexOf("::");i===-1?(e=n,t=""):(e=n.substring(0,i),t=n.substring(i+2));let r=Buffer.from(SC(e)),s=Buffer.from(SC(t)),o=Buffer.alloc(16-r.length-s.length,0);return Buffer.concat([r,o,s])}else return null}function EC(n){switch(n){case v4.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case v4.ConnectivityState.IDLE:return{state:"IDLE"};case v4.ConnectivityState.READY:return{state:"READY"};case v4.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case v4.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function xr(n){if(!n)return null;let e=n.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function MC(n){let e=n.getInfo();return{ref:r5(n.ref),data:{target:e.target,state:EC(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:xr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(t=>r5(t)),subchannel_ref:e.children.subchannels.map(t=>c5(t))}}function AV(n,e){let t=Number.parseInt(n.request.channel_id),i=y4[t];if(i===void 0){e({code:w4.Status.NOT_FOUND,details:"No channel data found for id "+t});return}e(null,{channel:MC(i)})}function DV(n,e){let t=Number.parseInt(n.request.max_results),i=[],r=Number.parseInt(n.request.start_channel_id);for(;r<y4.length;r++){let s=y4[r];if(s!==void 0&&(i.push(MC(s)),i.length>=t))break}e(null,{channel:i,end:r>=vs.length})}function zC(n){let e=n.getInfo();return{ref:_V(n.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:xr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(t=>H3(t))}}function kV(n,e){let t=Number.parseInt(n.request.server_id),i=vs[t];if(i===void 0){e({code:w4.Status.NOT_FOUND,details:"No server data found for id "+t});return}e(null,{server:zC(i)})}function RV(n,e){let t=Number.parseInt(n.request.max_results),i=[],r=Number.parseInt(n.request.start_server_id);for(;r<vs.length;r++){let s=vs[r];if(s!==void 0&&(i.push(zC(s)),i.length>=t))break}e(null,{server:i,end:r>=vs.length})}function LV(n,e){let t=Number.parseInt(n.request.subchannel_id),i=l5[t];if(i===void 0){e({code:w4.Status.NOT_FOUND,details:"No subchannel data found for id "+t});return}let r=i.getInfo(),s={ref:c5(i.ref),data:{target:r.target,state:EC(r.state),calls_started:r.callTracker.callsStarted,calls_succeeded:r.callTracker.callsSucceeded,calls_failed:r.callTracker.callsFailed,last_call_started_timestamp:xr(r.callTracker.lastCallStartedTimestamp),trace:r.trace.getTraceMessage()},socket_ref:r.children.sockets.map(o=>H3(o))};e(null,{subchannel:s})}function TC(n){var e;return(0,wV.isTcpSubchannelAddress)(n)?{address:"tcpip_address",tcpip_address:{ip_address:(e=IV(n.host))!==null&&e!==void 0?e:void 0,port:n.port}}:{address:"uds_address",uds_address:{filename:n.path}}}function VV(n,e){var t,i,r,s,o;let a=Number.parseInt(n.request.socket_id),c=u5[a];if(c===void 0){e({code:w4.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let l=c.getInfo(),u=l.security?{model:"tls",tls:{cipher_suite:l.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(t=l.security.cipherSuiteStandardName)!==null&&t!==void 0?t:void 0,other_name:(i=l.security.cipherSuiteOtherName)!==null&&i!==void 0?i:void 0,local_certificate:(r=l.security.localCertificate)!==null&&r!==void 0?r:void 0,remote_certificate:(s=l.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,h={ref:H3(c.ref),local:l.localAddress?TC(l.localAddress):null,remote:l.remoteAddress?TC(l.remoteAddress):null,remote_name:(o=l.remoteName)!==null&&o!==void 0?o:void 0,security:u,data:{keep_alives_sent:l.keepAlivesSent,streams_started:l.streamsStarted,streams_succeeded:l.streamsSucceeded,streams_failed:l.streamsFailed,last_local_stream_created_timestamp:xr(l.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:xr(l.lastRemoteStreamCreatedTimestamp),messages_received:l.messagesReceived,messages_sent:l.messagesSent,last_message_received_timestamp:xr(l.lastMessageReceivedTimestamp),last_message_sent_timestamp:xr(l.lastMessageSentTimestamp),local_flow_control_window:l.localFlowControlWindow?{value:l.localFlowControlWindow}:null,remote_flow_control_window:l.remoteFlowControlWindow?{value:l.remoteFlowControlWindow}:null}};e(null,{socket:h})}function NV(n,e){let t=Number.parseInt(n.request.server_id),i=vs[t];if(i===void 0){e({code:w4.Status.NOT_FOUND,details:"No server data found for id "+t});return}let r=Number.parseInt(n.request.start_socket_id),s=Number.parseInt(n.request.max_results),a=i.getInfo().sessionChildren.sockets.sort((u,h)=>u.id-h.id),c=[],l=0;for(;l<a.length&&!(a[l].id>=r&&(c.push(H3(a[l])),c.length>=s));l++);e(null,{socket_ref:c,end:l>=a.length})}function xC(){return{GetChannel:AV,GetTopChannels:DV,GetServer:kV,GetServers:RV,GetSubchannel:LV,GetSocket:VV,GetServerSockets:NV}}rt.getChannelzHandlers=xC;var P3=null;function OC(){if(P3)return P3;let n=i5().loadSync,e=n("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return P3=(0,CV.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,P3}rt.getChannelzServiceDefinition=OC;function PV(){(0,bV.registerAdminService)(OC,xC)}rt.setup=PV});var IC=T(q3=>{"use strict";Object.defineProperty(q3,"__esModule",{value:!0});q3.Subchannel=void 0;var Ke=Qn(),HV=Zc(),h5=pt(),F3=Ie(),BV=Nn(),FV=Gi(),t1=vo(),qV="subchannel",UV=~(1<<31),d5=class{constructor(e,t,i,r,s){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=i,this.credentials=r,this.connector=s,this.connectivityState=Ke.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new t1.ChannelzCallTracker,this.childrenTracker=new t1.ChannelzChildrenTracker,this.streamTracker=new t1.ChannelzCallTracker;let a={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new HV.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,FV.subchannelAddressToString)(t),this.keepaliveTime=(o=i["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,i["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new t1.ChannelzTrace,this.channelzRef=(0,t1.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(i,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){h5.trace(F3.LogVerbosity.DEBUG,qV,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){h5.trace(F3.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([Ke.ConnectivityState.TRANSIENT_FAILURE],Ke.ConnectivityState.CONNECTING):this.transitionToState([Ke.ConnectivityState.TRANSIENT_FAILURE],Ke.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,UV);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(t=>{this.transitionToState([Ke.ConnectivityState.CONNECTING],Ke.ConnectivityState.READY)?(this.transport=t,this.channelzEnabled&&this.childrenTracker.refChild(t.getChannelzRef()),t.addDisconnectListener(i=>{this.transitionToState([Ke.ConnectivityState.READY],Ke.ConnectivityState.IDLE),i&&this.keepaliveTime>0&&(this.keepaliveTime*=2,h5.log(F3.LogVerbosity.ERROR,`Connection to ${(0,BV.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):t.shutdown()},t=>{this.transitionToState([Ke.ConnectivityState.CONNECTING],Ke.ConnectivityState.TRANSIENT_FAILURE,`${t}`)})}transitionToState(e,t,i){var r,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(Ke.ConnectivityState[this.connectivityState]+" -> "+Ke.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Ke.ConnectivityState[t]);let o=this.connectivityState;switch(this.connectivityState=t,t){case Ke.ConnectivityState.READY:this.stopBackoff();break;case Ke.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case Ke.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(r=this.transport)===null||r===void 0||r.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case Ke.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let a of this.stateListeners)a(this,o,t,this.keepaliveTime,i);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,t1.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([Ke.ConnectivityState.CONNECTING,Ke.ConnectivityState.READY],Ke.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,t,i,r){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:o=>{o.code===F3.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,t,i,r,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([Ke.ConnectivityState.IDLE],Ke.ConnectivityState.CONNECTING)||this.connectivityState===Ke.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([Ke.ConnectivityState.TRANSIENT_FAILURE],Ke.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};q3.Subchannel=d5});var g5=T(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.setup=bs.DEFAULT_PORT=void 0;var AC=ji(),kC=Re("dns"),RC=Re("util"),jV=zh(),f5=Ie(),m5=fn(),WV=pt(),GV=Ie(),ys=Nn(),DC=Re("net"),$V=Zc(),YV="dns_resolver";function ws(n){WV.trace(GV.LogVerbosity.DEBUG,YV,n)}bs.DEFAULT_PORT=443;var KV=3e4,QV=RC.promisify(kC.resolveTxt),XV=RC.promisify(kC.lookup);function ZV(...n){let e=[];for(let t=0;t<Math.max.apply(null,n.map(i=>i.length));t++)for(let i of n)t<i.length&&e.push(i[t]);return e}var p5=class{constructor(e,t,i){var r,s,o;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,ws("Resolver constructed for target "+(0,ys.uriToString)(e));let a=(0,ys.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,DC.isIPv4)(a.host)||(0,DC.isIPv6)(a.host)?(this.ipResult=[{host:a.host,port:(r=a.port)!==null&&r!==void 0?r:bs.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(s=a.port)!==null&&s!==void 0?s:bs.DEFAULT_PORT),this.percentage=Math.random()*100,i["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:f5.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,ys.uriToString)(this.target)}`,metadata:new m5.Metadata};let c={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoff=new $V.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},c),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=i["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:KV,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(ws("Returning IP address for target "+(0,ys.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)ws("Failed to parse DNS address "+(0,ys.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:f5.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,ys.uriToString)(this.target)}`,metadata:new m5.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;ws("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=XV(e,{all:!0}),this.pendingLookupPromise.then(t=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let i=t.filter(o=>o.family===4),r=t.filter(o=>o.family===6);this.latestLookupResult=ZV(r,i).map(o=>({host:o.address,port:+this.port}));let s="["+this.latestLookupResult.map(o=>o.host+":"+o.port).join(",")+"]";if(ws("Resolved addresses for target "+(0,ys.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{this.pendingLookupPromise!==null&&(ws("Resolution error for target "+(0,ys.uriToString)(this.target)+": "+t.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=QV(e),this.pendingTxtPromise.then(t=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,jV.extractAndSelectServiceConfig)(t,this.percentage)}catch(i){this.latestServiceConfigError={code:f5.Status.UNAVAILABLE,details:`Parsing service config failed with error ${i.message}`,metadata:new m5.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},t=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?ws('resolution update delayed by "min time between resolutions" rate limit'):ws("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function JV(){(0,AC.registerResolver)("dns",p5),(0,AC.registerDefaultScheme)("dns")}bs.setup=JV});var v5=T(r1=>{"use strict";Object.defineProperty(r1,"__esModule",{value:!0});r1.getProxiedConnection=r1.mapProxyName=void 0;var b4=pt(),n1=Ie(),eN=ji(),tN=Re("http"),nN=Re("tls"),iN=pt(),LC=Gi(),i1=Nn(),rN=Re("url"),sN=g5(),oN="proxy";function Cs(n){iN.trace(n1.LogVerbosity.DEBUG,oN,n)}function aN(){let n="",e="";if(process.env.grpc_proxy)e="grpc_proxy",n=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",n=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",n=process.env.http_proxy;else return{};let t;try{t=new rN.URL(n)}catch{return(0,b4.log)(n1.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(t.protocol!=="http:")return(0,b4.log)(n1.LogVerbosity.ERROR,`"${t.protocol}" scheme not supported in proxy URI`),{};let i=null;t.username&&(t.password?((0,b4.log)(n1.LogVerbosity.INFO,"userinfo found in proxy URI"),i=`${t.username}:${t.password}`):i=t.username);let r=t.hostname,s=t.port;s===""&&(s="80");let o={address:`${r}:${s}`};return i&&(o.creds=i),Cs("Proxy server "+o.address+" set by environment variable "+e),o}function cN(){let n=process.env.no_grpc_proxy,e="no_grpc_proxy";return n||(n=process.env.no_proxy,e="no_proxy"),n?(Cs("No proxy server list set by environment variable "+e),n.split(",")):[]}function lN(n,e){var t;let i={target:n,extraOptions:{}};if(((t=e["grpc.enable_http_proxy"])!==null&&t!==void 0?t:1)===0||n.scheme==="unix")return i;let r=aN();if(!r.address)return i;let s=(0,i1.splitHostPort)(n.path);if(!s)return i;let o=s.host;for(let c of cN())if(c===o)return Cs("Not using proxy for target in no_proxy list: "+(0,i1.uriToString)(n)),i;let a={"grpc.http_connect_target":(0,i1.uriToString)(n)};return r.creds&&(a["grpc.http_connect_creds"]=r.creds),{target:{scheme:"dns",path:r.address},extraOptions:a}}r1.mapProxyName=lN;function uN(n,e,t){var i;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let r=e["grpc.http_connect_target"],s=(0,i1.parseUri)(r);if(s===null)return Promise.resolve({});let o=(0,i1.splitHostPort)(s.path);if(o===null)return Promise.resolve({});let a=`${o.host}:${(i=o.port)!==null&&i!==void 0?i:sN.DEFAULT_PORT}`,c={method:"CONNECT",path:a},l={Host:a};(0,LC.isTcpSubchannelAddress)(n)?(c.host=n.host,c.port=n.port):c.socketPath=n.path,"grpc.http_connect_creds"in e&&(l["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),c.headers=l;let u=(0,LC.subchannelAddressToString)(n);return Cs("Using proxy "+u+" to connect to "+c.path),new Promise((h,d)=>{let m=tN.request(c);m.once("connect",(p,v,w)=>{var A;if(m.removeAllListeners(),v.removeAllListeners(),p.statusCode===200)if(Cs("Successfully connected to "+c.path+" through proxy "+u),"secureContext"in t){let _=(0,eN.getDefaultAuthority)(s),k=(0,i1.splitHostPort)(_),R=(A=k?.host)!==null&&A!==void 0?A:_,U=nN.connect(Object.assign({host:R,servername:R,socket:v},t),()=>{Cs("Successfully established a TLS connection to "+c.path+" through proxy "+u),h({socket:U,realTarget:s})});U.on("error",X=>{Cs("Failed to establish a TLS connection to "+c.path+" through proxy "+u+" with error "+X.message),d()})}else Cs("Successfully established a plaintext connection to "+c.path+" through proxy "+u),h({socket:v,realTarget:s});else(0,b4.log)(n1.LogVerbosity.ERROR,"Failed to connect to "+c.path+" through proxy "+u+" with status "+p.statusCode),d()}),m.once("error",p=>{m.removeAllListeners(),(0,b4.log)(n1.LogVerbosity.ERROR,"Failed to connect to proxy "+u+" with error "+p.message),d()}),m.end()})}r1.getProxiedConnection=uN});var w5=T(U3=>{"use strict";Object.defineProperty(U3,"__esModule",{value:!0});U3.StreamDecoder=void 0;var Or=function(n){return n[n.NO_DATA=0]="NO_DATA",n[n.READING_SIZE=1]="READING_SIZE",n[n.READING_MESSAGE=2]="READING_MESSAGE",n}(Or||{}),y5=class{constructor(){this.readState=Or.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t=0,i,r=[];for(;t<e.length;)switch(this.readState){case Or.NO_DATA:this.readCompressFlag=e.slice(t,t+1),t+=1,this.readState=Or.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case Or.READING_SIZE:if(i=Math.min(e.length-t,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+i),this.readSizeRemaining-=i,t+=i,this.readSizeRemaining===0)if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=Or.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=Or.NO_DATA,r.push(s)}break;case Or.READING_MESSAGE:if(i=Math.min(e.length-t,this.readMessageRemaining),this.readPartialMessage.push(e.slice(t,t+i)),this.readMessageRemaining-=i,t+=i,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(s,this.readMessageSize+5);this.readState=Or.NO_DATA,r.push(o)}break;default:throw new Error("Unexpected read state")}return r}};U3.StreamDecoder=y5});var VC=T(j3=>{"use strict";Object.defineProperty(j3,"__esModule",{value:!0});j3.Http2SubchannelCall=void 0;var Ir=Re("http2"),hN=Re("os"),je=Ie(),_s=fn(),dN=w5(),fN=pt(),mN=Ie(),pN="subchannel_call";function gN(n){for(let[e,t]of Object.entries(hN.constants.errno))if(t===n)return e;return"Unknown system error "+n}var b5=class{constructor(e,t,i,r,s){this.http2Stream=e,this.callEventTracker=t,this.listener=i,this.transport=r,this.callId=s,this.decoder=new dN.StreamDecoder,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=je.Status.UNKNOWN,this.finalStatus=null,this.internalError=null,e.on("response",(o,a)=>{let c="";for(let l of Object.keys(o))c+="		"+l+": "+o[l]+`
`;switch(this.trace(`Received server headers:
`+c),o[":status"]){case 400:this.mappedStatusCode=je.Status.INTERNAL;break;case 401:this.mappedStatusCode=je.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=je.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=je.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=je.Status.UNAVAILABLE;break;default:this.mappedStatusCode=je.Status.UNKNOWN}if(a&Ir.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(o);else{let l;try{l=_s.Metadata.fromHttp2Headers(o)}catch(u){this.endCall({code:je.Status.UNKNOWN,details:u.message,metadata:new _s.Metadata});return}this.listener.onReceiveMetadata(l)}}),e.on("trailers",o=>{this.handleTrailers(o)}),e.on("data",o=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+o.length);let a=this.decoder.write(o);for(let c of a)this.trace("parsed message of length "+c.length),this.callEventTracker.addMessageReceived(),this.tryPush(c)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var o;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((o=this.finalStatus)===null||o===void 0?void 0:o.code)===je.Status.OK)return;let a,c="";switch(e.rstCode){case Ir.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;a=je.Status.INTERNAL,c=`Received RST_STREAM with code ${e.rstCode}`;break;case Ir.constants.NGHTTP2_REFUSED_STREAM:a=je.Status.UNAVAILABLE,c="Stream refused by server";break;case Ir.constants.NGHTTP2_CANCEL:a=je.Status.CANCELLED,c="Call cancelled";break;case Ir.constants.NGHTTP2_ENHANCE_YOUR_CALM:a=je.Status.RESOURCE_EXHAUSTED,c="Bandwidth exhausted or memory limit exceeded";break;case Ir.constants.NGHTTP2_INADEQUATE_SECURITY:a=je.Status.PERMISSION_DENIED,c="Protocol not secure enough";break;case Ir.constants.NGHTTP2_INTERNAL_ERROR:a=je.Status.INTERNAL,this.internalError===null?c=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(a=je.Status.UNAVAILABLE,c=this.internalError.message):c=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:a=je.Status.INTERNAL,c=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:a,details:c,metadata:new _s.Metadata,rstCode:e.rstCode})})}),e.on("error",o=>{o.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+o.message+" code="+o.code+" errno="+gN(o.errno)+" syscall="+o.syscall),this.internalError=o),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:je.Status.UNAVAILABLE,details:"Connection dropped",metadata:new _s.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){fN.trace(mN.LogVerbosity.DEBUG,pN,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===je.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==je.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let t="";for(let c of Object.keys(e))t+="		"+c+": "+e[c]+`
`;this.trace(`Received server trailers:
`+t);let i;try{i=_s.Metadata.fromHttp2Headers(e)}catch{i=new _s.Metadata}let r=i.getMap(),s=this.mappedStatusCode;if(s===je.Status.UNKNOWN&&typeof r["grpc-status"]=="string"){let c=Number(r["grpc-status"]);c in je.Status&&(s=c,this.trace("received status code "+c+" from server")),i.remove("grpc-status")}let o="";if(typeof r["grpc-message"]=="string"){try{o=decodeURI(r["grpc-message"])}catch{o=r["grpc-message"]}i.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let a={code:s,details:o,metadata:i};this.endCall(a)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===je.Status.OK?t=Ir.constants.NGHTTP2_NO_ERROR:t=Ir.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new _s.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==je.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let i=r=>{process.nextTick(()=>{var s;let o=je.Status.UNAVAILABLE;r?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=je.Status.INTERNAL),r&&this.cancelWithStatus(o,`Write error: ${r.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,i)}catch(r){this.endCall({code:je.Status.UNAVAILABLE,details:`Write failed with error ${r.message}`,metadata:new _s.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};j3.Http2SubchannelCall=b5});var C5=T(W3=>{"use strict";Object.defineProperty(W3,"__esModule",{value:!0});W3.getNextCallNumber=void 0;var vN=0;function yN(){return vN++}W3.getNextCallNumber=yN});var HC=T($3=>{"use strict";Object.defineProperty($3,"__esModule",{value:!0});$3.Http2SubchannelConnector=void 0;var M5=Re("http2"),NC=Re("tls"),_5=vo(),C4=Ie(),wN=v5(),o1=pt(),PC=ji(),G3=Gi(),s1=Nn(),bN=Re("net"),CN=VC(),_N=C5(),S5="transport",SN="transport_flowctrl",TN=lh().version,{HTTP2_HEADER_AUTHORITY:EN,HTTP2_HEADER_CONTENT_TYPE:MN,HTTP2_HEADER_METHOD:zN,HTTP2_HEADER_PATH:xN,HTTP2_HEADER_TE:ON,HTTP2_HEADER_USER_AGENT:IN}=M5.constants,AN=2e4,DN=Buffer.from("too_many_pings","ascii"),T5=class{constructor(e,t,i,r){this.session=e,this.remoteName=r,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=AN,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new _5.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,G3.subchannelAddressToString)(t),i["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,_5.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[i["grpc.primary_user_agent"],`grpc-node-js/${TN}`,i["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in i&&(this.keepaliveTimeMs=i["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in i&&(this.keepaliveTimeoutMs=i["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in i?this.keepaliveWithoutCalls=i["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,o,a)=>{let c=!1;s===M5.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(DN)&&(c=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+a?.toString()),this.reportDisconnectToOwner(c)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),o1.isTracerEnabled(S5)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,i;let r=this.session.socket,s=r.remoteAddress?(0,G3.stringToSubchannelAddress)(r.remoteAddress,r.remotePort):null,o=r.localAddress?(0,G3.stringToSubchannelAddress)(r.localAddress,r.localPort):null,a;if(this.session.encrypted){let l=r,u=l.getCipher(),h=l.getCertificate(),d=l.getPeerCertificate();a={cipherSuiteStandardName:(e=u.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:u.standardName?null:u.name,localCertificate:h&&"raw"in h?h.raw:null,remoteCertificate:d&&"raw"in d?d.raw:null}}else a=null;return{remoteAddress:s,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(i=this.session.state.remoteWindowSize)!==null&&i!==void 0?i:null}}trace(e){o1.trace(C4.LogVerbosity.DEBUG,S5,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){o1.trace(C4.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){o1.trace(C4.LogVerbosity.DEBUG,SN,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){o1.trace(C4.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0||t.call(e));try{this.session.ping((i,r,s)=>{i&&(this.keepaliveTrace("Ping failed with error "+i.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||t===void 0?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,i,r,s){let o=e.toHttp2Headers();o[EN]=t,o[IN]=this.userAgent,o[MN]="application/grpc",o[zN]="POST",o[xN]=i,o[ON]="trailers";let a;try{a=this.session.request(o)}catch(u){throw this.handleDisconnect(),u}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let c,l;return this.channelzEnabled?(this.streamTracker.addCallStarted(),c={addMessageSent:()=>{var u;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var h;(h=s.onCallEnd)===null||h===void 0||h.call(s,u),this.removeActiveCall(l)},onStreamEnd:u=>{var h;u?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(h=s.onStreamEnd)===null||h===void 0||h.call(s,u)}}):c={addMessageSent:()=>{var u;(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var h;(h=s.onCallEnd)===null||h===void 0||h.call(s,u),this.removeActiveCall(l)},onStreamEnd:u=>{var h;(h=s.onStreamEnd)===null||h===void 0||h.call(s,u)}},l=new CN.Http2SubchannelCall(a,c,r,this,(0,_N.getNextCallNumber)()),this.addActiveCall(l),l}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}shutdown(){this.session.close(),(0,_5.unregisterChannelzRef)(this.channelzRef)}},E5=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){o1.trace(C4.LogVerbosity.DEBUG,S5,(0,s1.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,i,r){return this.isShutdown?Promise.reject():new Promise((s,o)=>{var a,c,l;let u;r.realTarget?(u=(0,s1.uriToString)(r.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,s1.uriToString)(r.realTarget))):(u=null,this.trace("creating HTTP/2 session to "+(0,G3.subchannelAddressToString)(e)));let h=(0,PC.getDefaultAuthority)((a=r.realTarget)!==null&&a!==void 0?a:this.channelTarget),d=t._getConnectionOptions()||{};d.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in i?d.maxSessionMemory=i["grpc-node.max_session_memory"]:d.maxSessionMemory=Number.MAX_SAFE_INTEGER;let m="http://";if("secureContext"in d){if(m="https://",i["grpc.ssl_target_name_override"]){let w=i["grpc.ssl_target_name_override"];d.checkServerIdentity=(A,_)=>(0,NC.checkServerIdentity)(w,_),d.servername=w}else{let w=(l=(c=(0,s1.splitHostPort)(h))===null||c===void 0?void 0:c.host)!==null&&l!==void 0?l:"localhost";d.servername=w}r.socket&&(d.createConnection=(w,A)=>r.socket)}else d.createConnection=(w,A)=>r.socket?r.socket:bN.connect(e);d=Object.assign(Object.assign(Object.assign({},d),e),{enableTrace:i["grpc-node.tls_enable_trace"]===1});let p=M5.connect(m+h,d);this.session=p;let v="Failed to connect";p.unref(),p.once("connect",()=>{p.removeAllListeners(),s(new T5(p,e,i,u)),this.session=null}),p.once("close",()=>{this.session=null,setImmediate(()=>{o(`${v} (${new Date().toISOString()})`)})}),p.once("error",w=>{v=w.message,this.trace("connection failed with error "+v)})})}connect(e,t,i){var r,s;if(this.isShutdown)return Promise.reject();let o=t._getConnectionOptions()||{};if("secureContext"in o){if(o.ALPNProtocols=["h2"],i["grpc.ssl_target_name_override"]){let a=i["grpc.ssl_target_name_override"];o.checkServerIdentity=(c,l)=>(0,NC.checkServerIdentity)(a,l),o.servername=a}else if("grpc.http_connect_target"in i){let a=(0,PC.getDefaultAuthority)((r=(0,s1.parseUri)(i["grpc.http_connect_target"]))!==null&&r!==void 0?r:{path:"localhost"}),c=(0,s1.splitHostPort)(a);o.servername=(s=c?.host)!==null&&s!==void 0?s:a}i["grpc-node.tls_enable_trace"]&&(o.enableTrace=!0)}return(0,wN.getProxiedConnection)(e,i,o).then(a=>this.createSession(e,t,i,a))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};$3.Http2SubchannelConnector=E5});var BC=T(a1=>{"use strict";Object.defineProperty(a1,"__esModule",{value:!0});a1.getSubchannelPool=a1.SubchannelPool=void 0;var kN=Ty(),RN=IC(),LN=Gi(),VN=Nn(),NN=HC(),PN=1e4,_4=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let r=this.pool[t].filter(s=>!s.subchannel.unrefIfOneRef());r.length>0&&(e=!1),this.pool[t]=r}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},PN),(t=(e=this.cleanupTimer).unref)===null||t===void 0||t.call(e))}getOrCreateSubchannel(e,t,i,r){this.ensureCleanupTask();let s=(0,VN.uriToString)(e);if(s in this.pool){let a=this.pool[s];for(let c of a)if((0,LN.subchannelAddressEqual)(t,c.subchannelAddress)&&(0,kN.channelOptionsEqual)(i,c.channelArguments)&&r._equals(c.channelCredentials))return c.subchannel}let o=new RN.Subchannel(e,t,i,r,new NN.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:t,channelArguments:i,channelCredentials:r,subchannel:o}),o.ref(),o}};a1.SubchannelPool=_4;var HN=new _4;function BN(n){return n?HN:new _4}a1.getSubchannelPool=BN});var x5=T(c1=>{"use strict";Object.defineProperty(c1,"__esModule",{value:!0});c1.FilterStackFactory=c1.FilterStack=void 0;var Y3=class{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let i=0;i<this.filters.length;i++)t=this.filters[i].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let i=this.filters.length-1;i>=0;i--)t=this.filters[i].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let i=0;i<this.filters.length;i++)t=this.filters[i].sendMessage(t);return t}receiveMessage(e){let t=e;for(let i=this.filters.length-1;i>=0;i--)t=this.filters[i].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let i=this.filters.length-1;i>=0;i--)t=this.filters[i].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};c1.FilterStack=Y3;var z5=class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new Y3(this.factories.map(e=>e.createFilter()))}};c1.FilterStackFactory=z5});var O5=T(K3=>{"use strict";Object.defineProperty(K3,"__esModule",{value:!0});K3.CompressionAlgorithms=void 0;var FC=function(n){return n[n.identity=0]="identity",n[n.deflate=1]="deflate",n[n.gzip=2]="gzip",n}(FC||(K3.CompressionAlgorithms=FC={}))});var X3=T(Q3=>{"use strict";Object.defineProperty(Q3,"__esModule",{value:!0});Q3.BaseFilter=void 0;var I5=class{sendMetadata(e){return g(this,null,function*(){return e})}receiveMetadata(e){return e}sendMessage(e){return g(this,null,function*(){return e})}receiveMessage(e){return g(this,null,function*(){return e})}receiveTrailers(e){return e}};Q3.BaseFilter=I5});var jC=T(u1=>{"use strict";Object.defineProperty(u1,"__esModule",{value:!0});u1.CompressionFilterFactory=u1.CompressionFilter=void 0;var Z3=Re("zlib"),UC=O5(),FN=Ie(),qN=X3(),UN=pt(),jN=n=>typeof n=="number"&&typeof UC.CompressionAlgorithms[n]=="string",l1=class{writeMessage(e,t){return g(this,null,function*(){let i=e;t&&(i=yield this.compressMessage(i));let r=Buffer.allocUnsafe(i.length+5);return r.writeUInt8(t?1:0,0),r.writeUInt32BE(i.length,1),i.copy(r,5),r})}readMessage(e){return g(this,null,function*(){let t=e.readUInt8(0)===1,i=e.slice(5);return t&&(i=yield this.decompressMessage(i)),i})}},yo=class extends l1{compressMessage(e){return g(this,null,function*(){return e})}writeMessage(e,t){return g(this,null,function*(){let i=Buffer.allocUnsafe(e.length+5);return i.writeUInt8(0,0),i.writeUInt32BE(e.length,1),e.copy(i,5),i})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},A5=class extends l1{compressMessage(e){return new Promise((t,i)=>{Z3.deflate(e,(r,s)=>{r?i(r):t(s)})})}decompressMessage(e){return new Promise((t,i)=>{Z3.inflate(e,(r,s)=>{r?i(r):t(s)})})}},D5=class extends l1{compressMessage(e){return new Promise((t,i)=>{Z3.gzip(e,(r,s)=>{r?i(r):t(s)})})}decompressMessage(e){return new Promise((t,i)=>{Z3.unzip(e,(r,s)=>{r?i(r):t(s)})})}},k5=class extends l1{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function qC(n){switch(n){case"identity":return new yo;case"deflate":return new A5;case"gzip":return new D5;default:return new k5(n)}}var J3=class extends qN.BaseFilter{constructor(e,t){var i;super(),this.sharedFilterConfig=t,this.sendCompression=new yo,this.receiveCompression=new yo,this.currentCompressionAlgorithm="identity";let r=e["grpc.default_compression_algorithm"];if(r!==void 0)if(jN(r)){let s=UC.CompressionAlgorithms[r],o=(i=t.serverSupportedEncodingHeader)===null||i===void 0?void 0:i.split(",");(!o||o.includes(s))&&(this.currentCompressionAlgorithm=s,this.sendCompression=qC(this.currentCompressionAlgorithm))}else UN.log(FN.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${r}`)}sendMetadata(e){return g(this,null,function*(){let t=yield e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t})}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let r=t[0];typeof r=="string"&&(this.receiveCompression=qC(r))}e.remove("grpc-encoding");let i=e.get("grpc-accept-encoding")[0];return i&&(this.sharedFilterConfig.serverSupportedEncodingHeader=i,i.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new yo,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}sendMessage(e){return g(this,null,function*(){var t;let i=yield e,r;return this.sendCompression instanceof yo?r=!1:r=(((t=i.flags)!==null&&t!==void 0?t:0)&2)===0,{message:yield this.sendCompression.writeMessage(i.message,r),flags:i.flags}})}receiveMessage(e){return g(this,null,function*(){return this.receiveCompression.readMessage(yield e)})}};u1.CompressionFilter=J3;var R5=class{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new J3(this.options,this.sharedFilterConfig)}};u1.CompressionFilterFactory=R5});var GC=T(h1=>{"use strict";Object.defineProperty(h1,"__esModule",{value:!0});h1.MaxMessageSizeFilterFactory=h1.MaxMessageSizeFilter=void 0;var WN=X3(),e8=Ie(),WC=fn(),t8=class extends WN.BaseFilter{constructor(e){super(),this.maxSendMessageSize=e8.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=e8.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,"grpc.max_send_message_length"in e&&(this.maxSendMessageSize=e["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in e&&(this.maxReceiveMessageSize=e["grpc.max_receive_message_length"])}sendMessage(e){return g(this,null,function*(){if(this.maxSendMessageSize===-1)return e;{let t=yield e;if(t.message.length>this.maxSendMessageSize)throw{code:e8.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${t.message.length} vs. ${this.maxSendMessageSize})`,metadata:new WC.Metadata};return t}})}receiveMessage(e){return g(this,null,function*(){if(this.maxReceiveMessageSize===-1)return e;{let t=yield e;if(t.length>this.maxReceiveMessageSize)throw{code:e8.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${t.length} vs. ${this.maxReceiveMessageSize})`,metadata:new WC.Metadata};return t}})}};h1.MaxMessageSizeFilter=t8;var L5=class{constructor(e){this.options=e}createFilter(){return new t8(this.options)}};h1.MaxMessageSizeFilterFactory=L5});var n8=T(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.deadlineToString=nr.getRelativeTimeout=nr.getDeadlineTimeoutString=nr.minDeadline=void 0;function GN(...n){let e=1/0;for(let t of n){let i=t instanceof Date?t.getTime():t;i<e&&(e=i)}return e}nr.minDeadline=GN;var $N=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function YN(n){let e=new Date().getTime();n instanceof Date&&(n=n.getTime());let t=Math.max(n-e,0);for(let[i,r]of $N){let s=t/r;if(s<1e8)return String(Math.ceil(s))+i}throw new Error("Deadline is too far in the future")}nr.getDeadlineTimeoutString=YN;var KN=2147483647;function QN(n){let e=n instanceof Date?n.getTime():n,t=new Date().getTime(),i=e-t;return i<0?0:i>KN?1/0:i}nr.getRelativeTimeout=QN;function XN(n){if(n instanceof Date)return n.toISOString();{let e=new Date(n);return Number.isNaN(e.getTime())?""+n:e.toISOString()}}nr.deadlineToString=XN});var r8=T(i8=>{"use strict";Object.defineProperty(i8,"__esModule",{value:!0});i8.restrictControlPlaneStatusCode=void 0;var ir=Ie(),ZN=[ir.Status.OK,ir.Status.INVALID_ARGUMENT,ir.Status.NOT_FOUND,ir.Status.ALREADY_EXISTS,ir.Status.FAILED_PRECONDITION,ir.Status.ABORTED,ir.Status.OUT_OF_RANGE,ir.Status.DATA_LOSS];function JN(n,e){return ZN.includes(n)?{code:ir.Status.INTERNAL,details:`Invalid status from control plane: ${n} ${ir.Status[n]} ${e}`}:{code:n,details:e}}i8.restrictControlPlaneStatusCode=JN});var YC=T(a8=>{"use strict";Object.defineProperty(a8,"__esModule",{value:!0});a8.LoadBalancingCall=void 0;var $C=Qn(),s8=Ie(),eP=n8(),o8=fn(),S4=os(),tP=Nn(),nP=pt(),V5=r8(),iP=Re("http2"),rP="load_balancing_call",N5=class{constructor(e,t,i,r,s,o,a){var c,l;this.channel=e,this.callConfig=t,this.methodName=i,this.host=r,this.credentials=s,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let u=this.methodName.split("/"),h="";u.length>=2&&(h=u[1]);let d=(l=(c=(0,tP.splitHostPort)(this.host))===null||c===void 0?void 0:c.host)!==null&&l!==void 0?l:"localhost";this.serviceUrl=`https://${d}/${h}`}trace(e){nP.trace(s8.LogVerbosity.DEBUG,rP,"["+this.callNumber+"] "+e)}outputStatus(e,t){var i,r;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:t});(i=this.listener)===null||i===void 0||i.onReceiveStatus(s),(r=this.onCallEnded)===null||r===void 0||r.call(this,s.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let i=this.channel.doPick(this.metadata,this.callConfig.pickInformation),r=i.subchannel?"("+i.subchannel.getChannelzRef().id+") "+i.subchannel.getAddress():""+i.subchannel;switch(this.trace("Pick result: "+S4.PickResultType[i.pickResultType]+" subchannel: "+r+" status: "+((e=i.status)===null||e===void 0?void 0:e.code)+" "+((t=i.status)===null||t===void 0?void 0:t.details)),i.pickResultType){case S4.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var c,l,u;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let h=this.metadata.clone();if(h.merge(a),h.get("authorization").length>1&&this.outputStatus({code:s8.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new o8.Metadata},"PROCESSED"),i.subchannel.getConnectivityState()!==$C.ConnectivityState.READY){this.trace("Picked subchannel "+r+" has state "+$C.ConnectivityState[i.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&h.set("grpc-timeout",(0,eP.getDeadlineTimeoutString)(this.deadline));try{this.child=i.subchannel.getRealSubchannel().createCall(h,this.host,this.methodName,{onReceiveMetadata:d=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(d)},onReceiveMessage:d=>{this.trace("Received message"),this.listener.onReceiveMessage(d)},onReceiveStatus:d=>{this.trace("Received status"),d.rstCode===iP.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(d,"REFUSED"):this.outputStatus(d,"PROCESSED")}})}catch(d){this.trace("Failed to start call on picked subchannel "+r+" with error "+d.message),this.outputStatus({code:s8.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+d.message,metadata:new o8.Metadata},"NOT_STARTED");return}(l=(c=this.callConfig).onCommitted)===null||l===void 0||l.call(c),(u=i.onCallStarted)===null||u===void 0||u.call(i),this.onCallEnded=i.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:c,details:l}=(0,V5.restrictControlPlaneStatusCode)(typeof a.code=="number"?a.code:s8.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:c,details:l,metadata:new o8.Metadata},"PROCESSED")});break;case S4.PickResultType.DROP:let{code:s,details:o}=(0,V5.restrictControlPlaneStatusCode)(i.status.code,i.status.details);setImmediate(()=>{this.outputStatus({code:s,details:o,metadata:i.status.metadata},"DROP")});break;case S4.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:c}=(0,V5.restrictControlPlaneStatusCode)(i.status.code,i.status.details);setImmediate(()=>{this.outputStatus({code:a,details:c,metadata:i.status.metadata},"PROCESSED")})}break;case S4.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var i;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(i=this.child)===null||i===void 0||i.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new o8.Metadata},"PROCESSED")}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};a8.LoadBalancingCall=N5});var QC=T(l8=>{"use strict";Object.defineProperty(l8,"__esModule",{value:!0});l8.ResolvingCall=void 0;var d1=Ie(),c8=n8(),KC=fn(),sP=pt(),oP=r8(),aP="resolving_call",P5=class{constructor(e,t,i,r,s,o){this.channel=e,this.method=t,this.filterStackFactory=r,this.credentials=s,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=i.deadline,this.host=i.host,i.parentCall&&(i.flags&d1.Propagate.CANCELLATION&&i.parentCall.on("cancelled",()=>{this.cancelWithStatus(d1.Status.CANCELLED,"Cancelled by parent call")}),i.flags&d1.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+i.parentCall.getDeadline()),this.deadline=(0,c8.minDeadline)(this.deadline,i.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){sP.trace(d1.LogVerbosity.DEBUG,aP,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,c8.deadlineToString)(this.deadline));let e=(0,c8.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(d1.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(i=>i(t)),process.nextTick(()=>{var i;(i=this.listener)===null||i===void 0||i.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let i=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(r=>{this.writeFilterPending=!1,i.sendMessageWithContext(e,r.message),this.pendingHalfClose&&i.halfClose()},r=>{this.cancelWithStatus(r.code,r.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let t=e.config;if(t.status!==d1.Status.OK){let{code:i,details:r}=(0,oP.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:i,details:r,metadata:new KC.Metadata});return}if(t.methodConfig.timeout){let i=new Date;i.setSeconds(i.getSeconds()+t.methodConfig.timeout.seconds),i.setMilliseconds(i.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,c8.minDeadline)(this.deadline,i),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(i=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(i,{onReceiveMetadata:r=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(r))},onReceiveMessage:r=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(r).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:r=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=r:this.outputStatus(r)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},i=>{this.outputStatus(i)})}reportResolverError(e){var t;!((t=this.metadata)===null||t===void 0)&&t.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var i;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(i=this.child)===null||i===void 0||i.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new KC.Metadata})}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};l8.ResolvingCall=P5});var XC=T(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.RetryingCall=Ss.MessageBufferTracker=Ss.RetryThrottler=void 0;var u8=Ie(),cP=fn(),lP=pt(),uP="retrying_call",B5=class{constructor(e,t,i){this.maxTokens=e,this.tokenRatio=t,i?this.tokens=i.tokens*(e/i.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};Ss.RetryThrottler=B5;var F5=class{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var i;let r=(i=this.allocatedPerCall.get(t))!==null&&i!==void 0?i:0;return this.limitPerCall-r<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(t,r+e),this.totalAllocated+=e,!0)}free(e,t){var i;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let r=(i=this.allocatedPerCall.get(t))!==null&&i!==void 0?i:0;if(r<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${r}`);this.allocatedPerCall.set(t,r-e)}freeAll(e){var t;let i=(t=this.allocatedPerCall.get(e))!==null&&t!==void 0?t:0;if(this.totalAllocated<i)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${i} > total allocated ${this.totalAllocated}`);this.totalAllocated-=i,this.allocatedPerCall.delete(e)}};Ss.MessageBufferTracker=F5;var H5="grpc-previous-rpc-attempts",q5=class{constructor(e,t,i,r,s,o,a,c,l){if(this.channel=e,this.callConfig=t,this.methodName=i,this.host=r,this.credentials=s,this.deadline=o,this.callNumber=a,this.bufferTracker=c,this.retryThrottler=l,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let u=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(u.initialBackoff.substring(0,u.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){lP.trace(u8.LogVerbosity.DEBUG,uP,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;(t=this.listener)===null||t===void 0||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new cP.Metadata});for(let{call:i}of this.underlyingCalls)i.cancelWithStatus(e,t)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return(t=this.writeBuffer[e-this.writeBufferOffset])!==null&&t!==void 0?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let i=this.getBufferEntry(t);i.allocated&&this.bufferTracker.free(i.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&this.underlyingCalls[t].state!=="COMPLETED"&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(u8.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,t=-1;for(let[i,r]of this.underlyingCalls.entries())r.state==="ACTIVE"&&r.nextMessageToSend>e&&(e=r.nextMessageToSend,t=i);t===-1?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(i=>i===t||i.toString().toLowerCase()===u8.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let i=Math.random()*this.nextRetryBackoffSec*1e3,r=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,r),i}maybeRetryCall(e,t){if(this.state!=="RETRY"){t(!1);return}let i=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(i.maxAttempts,5)){t(!1);return}let r;if(e===null)r=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else r=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,o;if(this.state!=="RETRY"){t(!1);return}(!((o=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&o!==void 0)||o)&&(t(!0),this.attempts+=1,this.startNewAttempt())},r)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,i){var r,s,o;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((r=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&r!==void 0?r:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let a;if(i===null)a=0;else if(i<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else a=i;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(t),this.reportStatus(e))},a)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(i,a=>{a||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e));break}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(t.length===0)return null;try{return parseInt(t[0])}catch{return-1}}handleChildStatus(e,t){var i;if(this.underlyingCalls[t].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===u8.Status.OK){(i=this.retryThrottler)===null||i===void 0||i.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let r=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,r):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,r);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,i;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let r=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(r.maxAttempts,5))return;let s=(e=r.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(i=(t=this.hedgingTimer).unref)===null||i===void 0||i.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let i=this.attempts-1,r=this.initialMetadata.clone();i>0&&r.set(H5,`${i}`);let s=!1;e.start(r,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),s=!0,i>0&&o.set(H5,`${i}`),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&i>0&&o.metadata.set(H5,`${i}`),this.handleChildStatus(o,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,i;let r=this.underlyingCalls[e],s=r.nextMessageToSend;(i=(t=this.getBufferEntry(s)).callback)===null||i===void 0||i.call(t),this.clearSentMessages(),r.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if(t.state!=="COMPLETED"&&this.getBufferEntry(t.nextMessageToSend)){let i=this.getBufferEntry(t.nextMessageToSend);switch(i.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:r=>{this.handleChildWriteCompleted(e)}},i.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,t){var i;this.trace("write() called with message of length "+t.length);let r={message:t,flags:e.flags},s=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:r,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(i=e.callback)===null||i===void 0||i.call(e);for(let[a,c]of this.underlyingCalls.entries())c.state==="ACTIVE"&&c.nextMessageToSend===s&&c.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(a)}},t)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===s&&a.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};Ss.RetryingCall=q5});var d8=T(h8=>{"use strict";Object.defineProperty(h8,"__esModule",{value:!0});h8.BaseSubchannelWrapper=void 0;var U5=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};h8.BaseSubchannelWrapper=U5});var e_=T(p8=>{"use strict";Object.defineProperty(p8,"__esModule",{value:!0});p8.InternalChannel=void 0;var hP=Kl(),dP=Sy(),fP=BC(),ZC=os(),T4=Ie(),mP=x5(),pP=jC(),JC=ji(),j5=pt(),gP=GC(),vP=v5(),f8=Nn(),rr=Qn(),E4=vo(),yP=YC(),wP=n8(),bP=QC(),W5=C5(),CP=r8(),G5=XC(),_P=d8(),SP=2147483647,TP=1e3,EP=30*60*1e3,m8=new Map,MP=1<<24,zP=1<<20,$5=class extends _P.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(i,r,s,o)=>{t.throttleKeepalive(o)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},Y5=class{constructor(e,t,i){var r,s,o,a,c,l,u,h;if(this.credentials=t,this.options=i,this.connectivityState=rr.ConnectivityState.IDLE,this.currentPicker=new ZC.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new E4.ChannelzCallTracker,this.childrenTracker=new E4.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof hP.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&typeof i!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let d=(0,f8.parseUri)(e);if(d===null)throw new Error(`Could not parse target name "${e}"`);let m=(0,JC.mapUriDefaultScheme)(d);if(m===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},SP),(s=(r=this.callRefTimer).unref)===null||s===void 0||s.call(r),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new E4.ChannelzTrace,this.channelzRef=(0,E4.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,JC.getDefaultAuthority)(m);let p=(0,vP.mapProxyName)(m,i);this.target=p.target,this.options=Object.assign({},this.options,p.extraOptions),this.subchannelPool=(0,fP.getSubchannelPool)(((o=i["grpc.use_local_subchannel_pool"])!==null&&o!==void 0?o:0)===0),this.retryBufferTracker=new G5.MessageBufferTracker((a=i["grpc.retry_buffer_size"])!==null&&a!==void 0?a:MP,(c=i["grpc.per_rpc_retry_buffer_size"])!==null&&c!==void 0?c:zP),this.keepaliveTime=(l=i["grpc.keepalive_time_ms"])!==null&&l!==void 0?l:-1,this.idleTimeoutMs=Math.max((u=i["grpc.client_idle_timeout_ms"])!==null&&u!==void 0?u:EP,TP);let v={createSubchannel:(A,_)=>{let k=this.subchannelPool.getOrCreateSubchannel(this.target,A,Object.assign({},this.options,_),this.credentials);k.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",k.getChannelzRef());let R=new $5(k,this);return this.wrappedSubchannels.add(R),R},updateState:(A,_)=>{this.currentPicker=_;let k=this.pickQueue.slice();this.pickQueue=[],k.length>0&&this.callRefTimerUnref();for(let R of k)R.doPick();this.updateState(A)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:A=>{this.channelzEnabled&&this.childrenTracker.refChild(A)},removeChannelzChild:A=>{this.channelzEnabled&&this.childrenTracker.unrefChild(A)}};this.resolvingLoadBalancer=new dP.ResolvingLoadBalancer(this.target,v,i,(A,_)=>{A.retryThrottling?m8.set(this.getTarget(),new G5.RetryThrottler(A.retryThrottling.maxTokens,A.retryThrottling.tokenRatio,m8.get(this.getTarget()))):m8.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=_,this.currentResolutionError=null,process.nextTick(()=>{let k=this.configSelectionQueue;this.configSelectionQueue=[],k.length>0&&this.callRefTimerUnref();for(let R of k)R.getConfig()})},A=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+A.code+' and details "'+A.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,CP.restrictControlPlaneStatusCode)(A.code,A.details)),{metadata:A.metadata}));let _=this.configSelectionQueue;this.configSelectionQueue=[],_.length>0&&this.callRefTimerUnref();for(let k of _)k.reportResolverError(A)}),this.filterStackFactory=new mP.FilterStackFactory([new gP.MaxMessageSizeFilterFactory(this.options),new pP.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(i,void 0,2));let w=new Error;(0,j5.trace)(T4.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((h=w.stack)===null||h===void 0?void 0:h.substring(w.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,j5.trace)(t??T4.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,f8.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,i,r;!((t=(e=this.callRefTimer).hasRef)===null||t===void 0)&&t.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(r=(i=this.callRefTimer).ref)===null||r===void 0||r.call(i))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(t=(e=this.callRefTimer).unref)===null||t===void 0||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(i=>i===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){(0,j5.trace)(T4.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,f8.uriToString)(this.target)+" "+rr.ConnectivityState[this.connectivityState]+" -> "+rr.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+rr.ConnectivityState[e]),this.connectivityState=e;let t=this.connectivityStateWatchers.slice();for(let i of t)e!==i.currentState&&(i.timer&&clearTimeout(i.timer),this.removeConnectivityStateWatcher(i),i.callback());e!==rr.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let t of this.wrappedSubchannels)t.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(rr.ConnectivityState.IDLE),this.currentPicker=new ZC.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,i;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let s=new Date().valueOf()-this.lastActivityTimestamp.valueOf();s>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-s)},e),(i=(t=this.idleTimer).unref)===null||i===void 0||i.call(t)}maybeStartIdleTimer(){this.connectivityState!==rr.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===T4.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,i,r,s){let o=(0,W5.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+t+'"'),new yP.LoadBalancingCall(this,e,t,i,r,s,o)}createRetryingCall(e,t,i,r,s){let o=(0,W5.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+t+'"'),new G5.RetryingCall(this,e,t,i,r,s,o,this.retryBufferTracker,m8.get(this.getTarget()))}createInnerCall(e,t,i,r,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,t,i,r,s):this.createRetryingCall(e,t,i,r,s)}createResolvingCall(e,t,i,r,s){let o=(0,W5.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,wP.deadlineToString)(t));let a={deadline:t,flags:s??T4.Propagate.DEFAULTS,host:i??this.defaultAuthority,parentCall:r},c=new bP.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),o);return this.onCallStart(),c.addStatusWatcher(l=>{this.onCallEnd(l)}),c}close(){this.resolvingLoadBalancer.destroy(),this.updateState(rr.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,E4.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,f8.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,i){if(this.connectivityState===rr.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let r=null;if(t!==1/0){let o=t instanceof Date?t:new Date(t),a=new Date;if(t===-1/0||o<=a){process.nextTick(i,new Error("Deadline passed without connectivity state change"));return}r=setTimeout(()=>{this.removeConnectivityStateWatcher(s),i(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let s={currentState:e,callback:i,timer:r};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,i,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===rr.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,t,i,r,s)}};p8.InternalChannel=Y5});var Zh=T(g8=>{"use strict";Object.defineProperty(g8,"__esModule",{value:!0});g8.ChannelImplementation=void 0;var xP=Kl(),OP=e_(),K5=class{constructor(e,t,i){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof xP.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&typeof i!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new OP.InternalChannel(e,t,i)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,i){this.internalChannel.watchConnectivityState(e,t,i)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,i,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,i,r,s)}};g8.ChannelImplementation=K5});var u_=T(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.Http2ServerCallStream=si.ServerDuplexStreamImpl=si.ServerWritableStreamImpl=si.ServerReadableStreamImpl=si.ServerUnaryCallImpl=void 0;var s_=Re("events"),f1=Re("http2"),Z5=Re("stream"),o_=Re("zlib"),a_=Re("util"),st=Ie(),J5=fn(),IP=w5(),c_=pt(),z4=Ul(),l_="server_call",AP=(0,a_.promisify)(o_.unzip),DP=(0,a_.promisify)(o_.inflate);function M4(n){c_.trace(st.LogVerbosity.DEBUG,l_,n)}var kP="grpc-accept-encoding",RP="grpc-encoding",t_="grpc-message",n_="grpc-status",i_="grpc-timeout",LP=/(\d{1,8})\s*([HMSmun])/,VP={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},NP={[kP]:"identity,deflate,gzip",[RP]:"identity"},r_={[f1.constants.HTTP2_HEADER_STATUS]:f1.constants.HTTP_STATUS_OK,[f1.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},PP={waitForTrailers:!0},Q5=class extends s_.EventEmitter{constructor(e,t,i){super(),this.call=e,this.metadata=t,this.request=i,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};si.ServerUnaryCallImpl=Q5;var v8=class extends Z5.Readable{constructor(e,t,i,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=i,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,r)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};si.ServerReadableStreamImpl=v8;var x4=class extends Z5.Writable{constructor(e,t,i,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=i,this.request=r,this.cancelled=!1,this.trailingMetadata=new J5.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,i){try{let r=this.call.serializeMessage(e);if(!this.call.write(r)){this.call.once("drain",i);return}}catch(r){this.emit("error",{details:(0,z4.getErrorMessage)(r),code:st.Status.INTERNAL})}i()}_final(e){this.call.sendStatus({code:st.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};si.ServerWritableStreamImpl=x4;var m1=class extends Z5.Duplex{constructor(e,t,i,r,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=i,this.deserialize=r,this.cancelled=!1,this.trailingMetadata=new J5.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",o=>{this.call.sendError(o),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};si.ServerDuplexStreamImpl=m1;m1.prototype._read=v8.prototype._read;m1.prototype._write=x4.prototype._write;m1.prototype._final=x4.prototype._final;var X5=class extends s_.EventEmitter{constructor(e,t,i){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=st.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=st.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",r=>{}),this.stream.once("close",()=>{var r;M4("Request to method "+((r=this.handler)===null||r===void 0?void 0:r.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:st.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in i&&(this.maxSendMessageSize=i["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in i&&(this.maxReceiveMessageSize=i["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){return t==="deflate"?DP(e.subarray(5)):t==="gzip"?AP(e.subarray(5)):t==="identity"?e.subarray(5):Promise.reject({code:st.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,i=Object.assign(Object.assign(Object.assign({},r_),NP),t);this.stream.respond(i,PP)}receiveMetadata(e){let t=J5.Metadata.fromHttp2Headers(e);c_.isTracerEnabled(l_)&&M4("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let i=t.get(i_);if(i.length>0){let r=i[0].toString().match(LP);if(r===null){let a=new Error("Invalid deadline");return a.code=st.Status.OUT_OF_RANGE,this.sendError(a),t}let s=+r[1]*VP[r[2]]|0,o=new Date;this.deadline=o.setMilliseconds(o.getMilliseconds()+s),this.deadlineTimer=setTimeout(HP,s,this),t.remove(i_)}return t.remove(f1.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(f1.constants.HTTP2_HEADER_TE),t.remove(f1.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,i)=>{let{stream:r}=this,s=0,o=this,a=[],c=this.maxReceiveMessageSize;this.stream.on("data",l),this.stream.on("end",u),this.stream.on("error",u);function l(h){if(s+=h.byteLength,c!==-1&&s>c){r.removeListener("data",l),r.removeListener("end",u),r.removeListener("error",u),i({code:st.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${c})`});return}a.push(h)}function u(h){if(r.removeListener("data",l),r.removeListener("end",u),r.removeListener("error",u),h!==void 0){i({code:st.Status.INTERNAL,details:h.message});return}if(s===0){i({code:st.Status.INTERNAL,details:"received empty unary message"});return}o.emit("receiveMessage");let d=Buffer.concat(a,s),p=d.readUInt8(0)===1?e:"identity",v=o.getDecompressedMessage(d,p);if(Buffer.isBuffer(v)){t(o.deserializeMessageWithInternalError(v));return}v.then(w=>t(o.deserializeMessageWithInternalError(w)),w=>i(w.code?w:{code:st.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}deserializeMessageWithInternalError(e){return g(this,null,function*(){try{return this.deserializeMessage(e)}catch(t){throw{details:(0,z4.getErrorMessage)(t),code:st.Status.INTERNAL}}})}serializeMessage(e){let t=this.handler.serialize(e),i=t.byteLength,r=Buffer.allocUnsafe(i+5);return r.writeUInt8(0,0),r.writeUInt32BE(i,1),t.copy(r,5),r}deserializeMessage(e){return this.handler.deserialize(e)}sendUnaryMessage(e,t,i,r){return g(this,null,function*(){if(!this.checkCancelled()){if(i===void 0&&(i=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&i&&(e.metadata=i),this.sendError(e);return}try{let s=this.serializeMessage(t);this.write(s),this.sendStatus({code:st.Status.OK,details:"OK",metadata:i})}catch(s){this.sendError({details:(0,z4.getErrorMessage)(s),code:st.Status.INTERNAL})}}})}sendStatus(e){var t,i;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===st.Status.OK),!this.checkCancelled())if(M4("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+st.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var r;let s=Object.assign({[n_]:e.code,[t_]:encodeURI(e.details)},(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let r=Object.assign(Object.assign({[n_]:e.code,[t_]:encodeURI(e.details)},r_),(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());this.stream.respond(r,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:st.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&typeof e.details=="string"&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:st.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let i=new IP.StreamDecoder,r=!1,s=!1,o=!1,a=()=>g(this,null,function*(){!o&&r&&!s&&(o=!0,yield this.pushOrBufferMessage(e,null))});this.stream.on("data",c=>g(this,null,function*(){let l=i.write(c);s=!0,this.stream.pause();for(let u of l){if(this.maxReceiveMessageSize!==-1&&u.length>this.maxReceiveMessageSize){this.sendError({code:st.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${u.length} vs. ${this.maxReceiveMessageSize})`});return}this.emit("receiveMessage");let d=u.readUInt8(0)===1?t:"identity",m=yield this.getDecompressedMessage(u,d);if(!m)return;yield this.pushOrBufferMessage(e,m)}s=!1,this.stream.resume(),yield a()})),this.stream.once("end",()=>g(this,null,function*(){r=!0,yield a()}))}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),i=e.push(t);if(t===null||i===!1){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,t){return g(this,null,function*(){this.isPushPending?this.bufferedMessages.push(t):yield this.pushMessage(e,t)})}pushMessage(e,t){return g(this,null,function*(){if(t===null){M4("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}M4("Received message of length "+t.length),this.isPushPending=!0;try{let i=yield this.deserializeMessage(t);this.canPush?e.push(i)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(i)}catch(i){this.bufferedMessages.length=0;let r=(0,z4.getErrorCode)(i);(r===null||r<st.Status.OK||r>st.Status.UNAUTHENTICATED)&&(r=st.Status.INTERNAL),e.emit("error",{details:(0,z4.getErrorMessage)(i),code:r})}this.isPushPending=!1,this.bufferedMessages.length>0&&(yield this.pushMessage(e,this.bufferedMessages.shift()))})}getPeer(){var e;let t=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return t?.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};si.Http2ServerCallStream=X5;function HP(n){let e=new Error("Deadline exceeded");e.code=st.Status.DEADLINE_EXCEEDED,n.sendError(e),n.cancelled=!0,n.emit("cancelled","deadline")}});var n7=T(y8=>{"use strict";Object.defineProperty(y8,"__esModule",{value:!0});y8.ServerCredentials=void 0;var h_=_h(),O4=class{static createInsecure(){return new e7}static createSsl(e,t,i=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if(typeof i!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let r=[],s=[];for(let o=0;o<t.length;o++){let a=t[o];if(a===null||typeof a!="object")throw new TypeError(`keyCertPair[${o}] must be an object`);if(!Buffer.isBuffer(a.private_key))throw new TypeError(`keyCertPair[${o}].private_key must be a Buffer`);if(!Buffer.isBuffer(a.cert_chain))throw new TypeError(`keyCertPair[${o}].cert_chain must be a Buffer`);r.push(a.cert_chain),s.push(a.private_key)}return new t7({ca:e||(0,h_.getDefaultRootsData)()||void 0,cert:r,key:s,requestCert:i,ciphers:h_.CIPHER_SUITES})}};y8.ServerCredentials=O4;var e7=class extends O4{_isSecure(){return!1}_getSettings(){return null}},t7=class extends O4{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var m_=T(C8=>{"use strict";Object.defineProperty(C8,"__esModule",{value:!0});C8.Server=void 0;var Ts=Re("http2"),Ar=Ie(),wo=u_(),BP=n7(),d_=ji(),w8=pt(),Ei=Gi(),FP=Nn(),zn=vo(),b8=~(1<<31),qP=~(1<<31),UP=2e4,{HTTP2_HEADER_PATH:f_}=Ts.constants,jP="server";function WP(){}function i7(n){return{code:Ar.Status.UNIMPLEMENTED,details:`The server does not implement the method ${n}`}}function GP(n,e){let t=i7(e);switch(n){case"unary":return(i,r)=>{r(t,null)};case"clientStream":return(i,r)=>{r(t,null)};case"serverStream":return i=>{i.emit("error",t)};case"bidi":return i=>{i.emit("error",t)};default:throw new Error(`Invalid handlerType ${n}`)}}var r7=class{constructor(e){var t,i,r,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new zn.ChannelzTrace,this.callTracker=new zn.ChannelzCallTracker,this.listenerChildrenTracker=new zn.ChannelzChildrenTracker,this.sessionChildrenTracker=new zn.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,zn.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(t=this.options["grpc.max_connection_age_ms"])!==null&&t!==void 0?t:b8,this.maxConnectionAgeGraceMs=(i=this.options["grpc.max_connection_age_grace_ms"])!==null&&i!==void 0?i:b8,this.keepaliveTimeMs=(r=this.options["grpc.keepalive_time_ms"])!==null&&r!==void 0?r:qP,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:UP,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,i,r;let s=this.sessions.get(e),o=e.socket,a=o.remoteAddress?(0,Ei.stringToSubchannelAddress)(o.remoteAddress,o.remotePort):null,c=o.localAddress?(0,Ei.stringToSubchannelAddress)(o.localAddress,o.localPort):null,l;if(e.encrypted){let h=o,d=h.getCipher(),m=h.getCertificate(),p=h.getPeerCertificate();l={cipherSuiteStandardName:(t=d.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:d.standardName?null:d.name,localCertificate:m&&"raw"in m?m.raw:null,remoteCertificate:p&&"raw"in p?p.raw:null}}else l=null;return{remoteAddress:a,localAddress:c,security:l,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(i=e.state.localWindowSize)!==null&&i!==void 0?i:null,remoteFlowControlWindow:(r=e.state.remoteWindowSize)!==null&&r!==void 0?r:null}}}trace(e){w8.trace(Ar.LogVerbosity.DEBUG,jP,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!="object"||t===null||typeof t!="object")throw new Error("addService() requires two objects as arguments");let i=Object.keys(e);if(i.length===0)throw new Error("Cannot add an empty service to a server");i.forEach(r=>{let s=e[r],o;s.requestStream?s.responseStream?o="bidi":o="clientStream":s.responseStream?o="serverStream":o="unary";let a=t[r],c;if(a===void 0&&typeof s.originalName=="string"&&(a=t[s.originalName]),a!==void 0?c=a.bind(t):c=GP(o,r),this.register(s.path,c,s.responseSerialize,s.requestDeserialize,o)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(i=>{let r=e[i];this.unregister(r.path)})}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,i){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(t===null||!(t instanceof BP.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof i!="function")throw new TypeError("callback must be a function");let r=(0,FP.parseUri)(e);if(r===null)throw new Error(`Could not parse port "${e}"`);let s=(0,d_.mapUriDefaultScheme)(r);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let o={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?o.maxSessionMemory=this.options["grpc-node.max_session_memory"]:o.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(o.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let a=(m,p)=>{process.nextTick(()=>i(m,p))},c=()=>{let m;if(t._isSecure()){let p=Object.assign(o,t._getSettings());p.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,m=Ts.createSecureServer(p),m.on("secureConnection",v=>{v.on("error",w=>{this.trace("An incoming TLS connection closed with error: "+w.message)})})}else m=Ts.createServer(o);return m.setTimeout(0,WP),this._setupHandlers(m),m},l=(m,p,v)=>m.length===0?Promise.resolve({port:p,count:v}):Promise.all(m.map(w=>{this.trace("Attempting to bind "+(0,Ei.subchannelAddressToString)(w));let A;(0,Ei.isTcpSubchannelAddress)(w)?A={host:w.host,port:p}:A=w;let _=c();return new Promise((k,R)=>{let U=X=>{this.trace("Failed to bind "+(0,Ei.subchannelAddressToString)(w)+" with error "+X.message),k(X)};_.once("error",U),_.listen(A,()=>{if(this.shutdown){_.close(),k(new Error("bindAsync failed because server is shutdown"));return}let X=_.address(),re;typeof X=="string"?re={path:X}:re={host:X.address,port:X.port};let Le=(0,zn.registerChannelzSocket)((0,Ei.subchannelAddressToString)(re),()=>({localAddress:re,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(Le),this.http2ServerList.push({server:_,channelzRef:Le}),this.trace("Successfully bound "+(0,Ei.subchannelAddressToString)(re)),k("port"in re?re.port:p),_.removeListener("error",U)})})})).then(w=>{let A=0;for(let _ of w)if(typeof _=="number"&&(A+=1,_!==p))throw new Error("Invalid state: multiple port numbers added from single address");return{port:p,count:A+v}}),u=m=>{if(m.length===0)return Promise.resolve({port:0,count:0});let p=m[0],v=c();return new Promise((w,A)=>{let _=k=>{this.trace("Failed to bind "+(0,Ei.subchannelAddressToString)(p)+" with error "+k.message),w(u(m.slice(1)))};v.once("error",_),v.listen(p,()=>{if(this.shutdown){v.close(),w({port:0,count:0});return}let k=v.address(),R={host:k.address,port:k.port},U=(0,zn.registerChannelzSocket)((0,Ei.subchannelAddressToString)(R),()=>({localAddress:R,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(U),this.http2ServerList.push({server:v,channelzRef:U}),this.trace("Successfully bound "+(0,Ei.subchannelAddressToString)(R)),w(l(m.slice(1),k.port,1)),v.removeListener("error",_)})})},h={onSuccessfulResolution:(m,p,v)=>{if(h.onSuccessfulResolution=()=>{},this.shutdown&&a(new Error("bindAsync failed because server is shutdown"),0),m.length===0){a(new Error(`No addresses resolved for port ${e}`),0);return}let w;(0,Ei.isTcpSubchannelAddress)(m[0])?m[0].port===0?w=u(m):w=l(m,m[0].port,0):w=l(m,1,0),w.then(A=>{if(A.count===0){let _=`No address added out of total ${m.length} resolved`;w8.log(Ar.LogVerbosity.ERROR,_),a(new Error(_),0)}else A.count<m.length&&w8.log(Ar.LogVerbosity.INFO,`WARNING Only ${A.count} addresses added out of total ${m.length} resolved`),a(null,A.port)},A=>{let _=`No address added out of total ${m.length} resolved`;w8.log(Ar.LogVerbosity.ERROR,_),a(new Error(_),0)})},onError:m=>{a(new Error(m.details),0)}};(0,d_.createResolver)(s,h,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,zn.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(Ts.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,zn.unregisterChannelzRef)(this.channelzRef)}register(e,t,i,r,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:t,serialize:i,deserialize:r,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=s=>{this.channelzEnabled&&(0,zn.unregisterChannelzRef)(this.channelzRef),e(s)},i=0;function r(){i--,i===0&&t()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:o}of this.http2ServerList)s.listening&&(i++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(o),(0,zn.unregisterChannelzRef)(o)),r()}));this.sessions.forEach((s,o)=>{o.closed||(i+=1,o.close(r))}),i===0&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let i=t[Ts.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof i!="string"||!i.startsWith("application/grpc")?(e.respond({[Ts.constants.HTTP2_HEADER_STATUS]:Ts.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return t===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,i=null){let r=new wo.Http2ServerCallStream(t,null,this.options);e.code===void 0&&(e.code=Ar.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),i?.streamTracker.addCallFailed()),r.sendError(e)}_channelzHandler(e,t){let i=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),i?.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),i?.streamTracker.addCallFailed();return}let r=t[f_],s=this._retrieveHandler(r);if(!s){this._respondWithError(i7(r),e,i);return}let o=new wo.Http2ServerCallStream(e,s,this.options);o.once("callEnd",a=>{a===Ar.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),i&&(o.once("streamEnd",a=>{a?i.streamTracker.addCallSucceeded():i.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{i.messagesSent+=1,i.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{i.messagesReceived+=1,i.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,s,t)||(this.callTracker.addCallFailed(),i?.streamTracker.addCallFailed(),o.sendError({code:Ar.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,t){if(this._verifyContentType(e,t)!==!0)return;let i=t[f_],r=this._retrieveHandler(i);if(!r){this._respondWithError(i7(i),e,null);return}let s=new wo.Http2ServerCallStream(e,r,this.options);this._runHandlerForCall(s,r,t)||s.sendError({code:Ar.Status.INTERNAL,details:`Unknown handler type: ${r.type}`})}_runHandlerForCall(e,t,i){var r;let s=e.receiveMetadata(i),o=(r=s.get("grpc-encoding")[0])!==null&&r!==void 0?r:"identity";s.remove("grpc-encoding");let{type:a}=t;if(a==="unary")$P(e,t,s,o);else if(a==="clientStream")YP(e,t,s,o);else if(a==="serverStream")KP(e,t,s,o);else if(a==="bidi")QP(e,t,s,o);else return!1;return!0}_setupHandlers(e){if(e===null)return;let t=e.address(),i="null";t&&(typeof t=="string"?i=t:i=t.address+":"+t.port),this.serverAddressString=i;let r=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",r.bind(this)),e.on("session",s=>{var o,a,c,l,u;if(!this.started){s.destroy();return}let h=(0,zn.registerChannelzSocket)((o=s.socket.remoteAddress)!==null&&o!==void 0?o:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),d={ref:h,streamTracker:new zn.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,d);let m=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+m),this.sessionChildrenTracker.refChild(h));let p=null,v=null,w=!1;if(this.maxConnectionAgeMs!==b8){let _=this.maxConnectionAgeMs/10,k=Math.random()*_*2-_;p=(c=(a=setTimeout(()=>{var R,U;w=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+m);try{s.goaway(Ts.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==b8&&(v=(U=(R=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||U===void 0?void 0:U.call(R))},this.maxConnectionAgeMs+k)).unref)===null||c===void 0?void 0:c.call(a)}let A=(u=(l=setInterval(()=>{var _,k;let R=(k=(_=setTimeout(()=>{w=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+m),s.close()},this.keepaliveTimeoutMs)).unref)===null||k===void 0?void 0:k.call(_);try{s.ping((U,X,re)=>{clearTimeout(R)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||u===void 0?void 0:u.call(l);s.on("close",()=>{this.channelzEnabled&&(w||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+m),this.sessionChildrenTracker.unrefChild(h),(0,zn.unregisterChannelzRef)(h)),p&&clearTimeout(p),v&&clearTimeout(v),A&&clearTimeout(A),this.sessions.delete(s)})})}};C8.Server=r7;function $P(n,e,t,i){return g(this,null,function*(){try{let r=yield n.receiveUnaryMessage(i);if(r===void 0||n.cancelled)return;let s=new wo.ServerUnaryCallImpl(n,t,r);e.func(s,(o,a,c,l)=>{n.sendUnaryMessage(o,a,c,l)})}catch(r){n.sendError(r)}})}function YP(n,e,t,i){let r=new wo.ServerReadableStreamImpl(n,t,e.deserialize,i);function s(o,a,c,l){r.destroy(),n.sendUnaryMessage(o,a,c,l)}n.cancelled||(r.on("error",s),e.func(r,s))}function KP(n,e,t,i){return g(this,null,function*(){try{let r=yield n.receiveUnaryMessage(i);if(r===void 0||n.cancelled)return;let s=new wo.ServerWritableStreamImpl(n,t,e.serialize,r);e.func(s)}catch(r){n.sendError(r)}})}function QP(n,e,t,i){let r=new wo.ServerDuplexStreamImpl(n,t,e.serialize,e.deserialize,i);n.cancelled||e.func(r)}});var p_=T(_8=>{"use strict";Object.defineProperty(_8,"__esModule",{value:!0});_8.StatusBuilder=void 0;var s7=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};_8.StatusBuilder=s7});var o7=T(Es=>{"use strict";Object.defineProperty(Es,"__esModule",{value:!0});Es.isDuration=Es.durationToMs=Es.msToDuration=void 0;function XP(n){return{seconds:n/1e3|0,nanos:n%1e3*1e6|0}}Es.msToDuration=XP;function ZP(n){return n.seconds*1e3+n.nanos/1e6|0}Es.durationToMs=ZP;function JP(n){return typeof n.seconds=="number"&&typeof n.nanos=="number"}Es.isDuration=JP});var m7=T(Ms=>{"use strict";var a7;Object.defineProperty(Ms,"__esModule",{value:!0});Ms.setup=Ms.OutlierDetectionLoadBalancer=Ms.OutlierDetectionLoadBalancingConfig=void 0;var T8=Qn(),v_=Ie(),bo=o7(),y_=p7(),w_=ns(),eH=n3(),tH=os(),g_=Gi(),nH=d8(),iH=pt(),rH="outlier_detection";function qt(n){iH.trace(v_.LogVerbosity.DEBUG,rH,n)}var f7="outlier_detection",sH=((a7=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&a7!==void 0?a7:"true")==="true",oH={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},aH={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function p1(n,e,t,i){if(e in n&&typeof n[e]!==t){let r=i?`${i}.${e}`:e;throw new Error(`outlier detection config ${r} parse error: expected ${t}, got ${typeof n[e]}`)}}function c7(n,e,t){let i=t?`${t}.${e}`:e;if(e in n){if(!(0,bo.isDuration)(n[e]))throw new Error(`outlier detection config ${i} parse error: expected Duration, got ${typeof n[e]}`);if(!(n[e].seconds>=0&&n[e].seconds<=315576e6&&n[e].nanos>=0&&n[e].nanos<=999999999))throw new Error(`outlier detection config ${i} parse error: values out of range for non-negative Duaration`)}}function S8(n,e,t){let i=t?`${t}.${e}`:e;if(p1(n,e,"number",t),e in n&&!(n[e]>=0&&n[e]<=100))throw new Error(`outlier detection config ${i} parse error: value out of range for percentage (0-100)`)}var I4=class n{constructor(e,t,i,r,s,o,a){if(this.childPolicy=a,a.length>0&&a[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=t??3e4,this.maxEjectionTimeMs=i??3e5,this.maxEjectionPercent=r??10,this.successRateEjection=s?Object.assign(Object.assign({},oH),s):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},aH),o):null}getLoadBalancerName(){return f7}toJsonObject(){return{interval:(0,bo.msToDuration)(this.intervalMs),base_ejection_time:(0,bo.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,bo.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new n(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(c7(e,"interval"),c7(e,"base_ejection_time"),c7(e,"max_ejection_time"),S8(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");p1(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),S8(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),p1(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),p1(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");S8(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),S8(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),p1(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),p1(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new n(e.interval?(0,bo.durationToMs)(e.interval):null,e.base_ejection_time?(0,bo.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,bo.durationToMs)(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(w_.validateLoadBalancingConfig))}};Ms.OutlierDetectionLoadBalancingConfig=I4;var u7=class extends nH.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((i,r,s,o)=>{if(this.childSubchannelState=s,!this.ejected)for(let a of this.stateListeners)a(this,r,s,o)})}getConnectivityState(){return this.ejected?T8.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,T8.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,T8.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function l7(){return{success:0,failure:0}}var h7=class{constructor(){this.activeBucket=l7(),this.inactiveBucket=l7()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=l7()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},d7=class{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType===tH.PickResultType.COMPLETE){let i=t.subchannel,r=i.getMapEntry();if(r){let s=t.onCallEnded;return this.countCalls&&(s=o=>{var a;o===v_.Status.OK?r.counter.addSuccess():r.counter.addFailure(),(a=t.onCallEnded)===null||a===void 0||a.call(t,o)}),Object.assign(Object.assign({},t),{subchannel:i.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},t),{subchannel:i.getWrappedSubchannel()})}else return t}},E8=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new eH.ChildLoadBalancerHandler((0,y_.createChildChannelControlHelper)(e,{createSubchannel:(t,i)=>{let r=e.createSubchannel(t,i),s=this.addressMap.get((0,g_.subchannelAddressToString)(t)),o=new u7(r,s);return s?.currentEjectionTimestamp!==null&&o.eject(),s?.subchannelWrappers.push(o),o},updateState:(t,i)=>{t===T8.ConnectivityState.READY?e.updateState(t,new d7(i,this.isCountingEnabled())):e.updateState(t,i)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())t.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;qt("Running success rate check");let i=t.request_volume,r=0,s=[];for(let[h,d]of this.addressMap){let m=d.counter.getLastSuccesses(),p=d.counter.getLastFailures();qt("Stats for "+h+": successes="+m+" failures="+p+" targetRequestVolume="+i),m+p>=i&&(r+=1,s.push(m/(m+p)))}if(qt("Found "+r+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),r<t.minimum_hosts)return;let o=s.reduce((h,d)=>h+d)/s.length,a=0;for(let h of s){let d=h-o;a+=d*d}let c=a/s.length,l=Math.sqrt(c),u=o-l*(t.stdev_factor/1e3);qt("stdev="+l+" ejectionThreshold="+u);for(let[h,d]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let m=d.counter.getLastSuccesses(),p=d.counter.getLastFailures();if(m+p<i)continue;let v=m/(m+p);if(qt("Checking candidate "+h+" successRate="+v),v<u){let w=Math.random()*100;qt("Candidate "+h+" randomNumber="+w+" enforcement_percentage="+t.enforcement_percentage),w<t.enforcement_percentage&&(qt("Ejecting candidate "+h),this.eject(d,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;qt("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let i=0;for(let r of this.addressMap.values()){let s=r.counter.getLastSuccesses(),o=r.counter.getLastFailures();s+o>=t.request_volume&&(i+=1)}if(!(i<t.minimum_hosts))for(let[r,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(qt("Candidate successes="+o+" failures="+a),o+a<t.request_volume)continue;if(a*100/(a+o)>t.threshold){let l=Math.random()*100;qt("Candidate "+r+" randomNumber="+l+" enforcement_percentage="+t.enforcement_percentage),l<t.enforcement_percentage&&(qt("Ejecting candidate "+r),this.eject(s,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let i of e.subchannelWrappers)i.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,i;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(i=(t=this.ejectionTimer).unref)===null||i===void 0||i.call(t)}runChecks(){let e=new Date;if(qt("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[t,i]of this.addressMap.entries())if(i.currentEjectionTimestamp===null)i.ejectionTimeMultiplier>0&&(i.ejectionTimeMultiplier-=1);else{let r=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(i.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(r*i.ejectionTimeMultiplier,Math.max(r,s))),o<new Date&&(qt("Unejecting "+t),this.uneject(i))}}}updateAddressList(e,t,i){if(!(t instanceof I4))return;let r=new Set;for(let o of e)r.add((0,g_.subchannelAddressToString)(o));for(let o of r)this.addressMap.has(o)||(qt("Adding map entry for "+o),this.addressMap.set(o,{counter:new h7,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let o of this.addressMap.keys())r.has(o)||(qt("Removing map entry for "+o),this.addressMap.delete(o));let s=(0,w_.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,i),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){qt("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let o=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(o)}else qt("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{qt("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let o of this.addressMap.values())this.uneject(o),o.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return f7}};Ms.OutlierDetectionLoadBalancer=E8;function cH(){sH&&(0,y_.registerLoadBalancerType)(f7,E8,I4)}Ms.setup=cH});var p7=T(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.OutlierDetectionLoadBalancingConfig=le.BaseSubchannelWrapper=le.registerAdminService=le.FilterStackFactory=le.BaseFilter=le.PickResultType=le.QueuePicker=le.UnavailablePicker=le.ChildLoadBalancerHandler=le.subchannelAddressToString=le.validateLoadBalancingConfig=le.getFirstUsableConfig=le.registerLoadBalancerType=le.createChildChannelControlHelper=le.BackoffTimeout=le.durationToMs=le.uriToString=le.createResolver=le.registerResolver=le.log=le.trace=void 0;var b_=pt();Object.defineProperty(le,"trace",{enumerable:!0,get:function(){return b_.trace}});Object.defineProperty(le,"log",{enumerable:!0,get:function(){return b_.log}});var C_=ji();Object.defineProperty(le,"registerResolver",{enumerable:!0,get:function(){return C_.registerResolver}});Object.defineProperty(le,"createResolver",{enumerable:!0,get:function(){return C_.createResolver}});var lH=Nn();Object.defineProperty(le,"uriToString",{enumerable:!0,get:function(){return lH.uriToString}});var uH=o7();Object.defineProperty(le,"durationToMs",{enumerable:!0,get:function(){return uH.durationToMs}});var hH=Zc();Object.defineProperty(le,"BackoffTimeout",{enumerable:!0,get:function(){return hH.BackoffTimeout}});var M8=ns();Object.defineProperty(le,"createChildChannelControlHelper",{enumerable:!0,get:function(){return M8.createChildChannelControlHelper}});Object.defineProperty(le,"registerLoadBalancerType",{enumerable:!0,get:function(){return M8.registerLoadBalancerType}});Object.defineProperty(le,"getFirstUsableConfig",{enumerable:!0,get:function(){return M8.getFirstUsableConfig}});Object.defineProperty(le,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return M8.validateLoadBalancingConfig}});var dH=Gi();Object.defineProperty(le,"subchannelAddressToString",{enumerable:!0,get:function(){return dH.subchannelAddressToString}});var fH=n3();Object.defineProperty(le,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return fH.ChildLoadBalancerHandler}});var g7=os();Object.defineProperty(le,"UnavailablePicker",{enumerable:!0,get:function(){return g7.UnavailablePicker}});Object.defineProperty(le,"QueuePicker",{enumerable:!0,get:function(){return g7.QueuePicker}});Object.defineProperty(le,"PickResultType",{enumerable:!0,get:function(){return g7.PickResultType}});var mH=X3();Object.defineProperty(le,"BaseFilter",{enumerable:!0,get:function(){return mH.BaseFilter}});var pH=x5();Object.defineProperty(le,"FilterStackFactory",{enumerable:!0,get:function(){return pH.FilterStackFactory}});var gH=r3();Object.defineProperty(le,"registerAdminService",{enumerable:!0,get:function(){return gH.registerAdminService}});var vH=d8();Object.defineProperty(le,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return vH.BaseSubchannelWrapper}});var yH=m7();Object.defineProperty(le,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return yH.OutlierDetectionLoadBalancingConfig}})});var __=T(z8=>{"use strict";Object.defineProperty(z8,"__esModule",{value:!0});z8.setup=void 0;var wH=ji(),v7=class{constructor(e,t,i){this.listener=t,this.addresses=[],this.hasReturnedResult=!1;let r;e.authority===""?r="/"+e.path:r=e.path,this.addresses=[{path:r}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function bH(){(0,wH.registerResolver)("unix",v7)}z8.setup=bH});var z_=T(I8=>{"use strict";Object.defineProperty(I8,"__esModule",{value:!0});I8.setup=void 0;var S_=Re("net"),x8=Ie(),y7=fn(),T_=ji(),E_=Nn(),CH=pt(),_H="ip_resolver";function M_(n){CH.trace(x8.LogVerbosity.DEBUG,_H,n)}var w7="ipv4",b7="ipv6",SH=443,O8=class{constructor(e,t,i){var r;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,M_("Resolver constructed for target "+(0,E_.uriToString)(e));let s=[];if(!(e.scheme===w7||e.scheme===b7)){this.error={code:x8.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new y7.Metadata};return}let o=e.path.split(",");for(let a of o){let c=(0,E_.splitHostPort)(a);if(c===null){this.error={code:x8.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new y7.Metadata};return}if(e.scheme===w7&&!(0,S_.isIPv4)(c.host)||e.scheme===b7&&!(0,S_.isIPv6)(c.host)){this.error={code:x8.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new y7.Metadata};return}s.push({host:c.host,port:(r=c.port)!==null&&r!==void 0?r:SH})}this.addresses=s,M_("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function TH(){(0,T_.registerResolver)(w7,O8),(0,T_.registerResolver)(b7,O8)}I8.setup=TH});var I_=T(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});sr.setup=sr.PickFirstLoadBalancer=sr.shuffled=sr.PickFirstLoadBalancingConfig=void 0;var x_=ns(),rn=Qn(),A8=os(),EH=pt(),MH=Ie(),zH="pick_first";function C7(n){EH.trace(MH.LogVerbosity.DEBUG,zH,n)}var A4="pick_first",xH=250,D4=class n{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return A4}toJsonObject(){return{[A4]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new n(e.shuffleAddressList===!0)}};sr.PickFirstLoadBalancingConfig=D4;var _7=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:A8.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function O_(n){let e=n.slice();for(let t=e.length-1;t>1;t--){let i=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[i],e[i]=r}return e}sr.shuffled=O_;var D8=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=rn.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(t,i,r,s,o)=>{this.onSubchannelStateUpdate(t,i,r,o)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(rn.ConnectivityState.READY,new _7(this.currentPick)):this.children.length===0?this.updateState(rn.ConnectivityState.IDLE,new A8.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(rn.ConnectivityState.TRANSIENT_FAILURE,new A8.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(rn.ConnectivityState.CONNECTING,new A8.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,i,r){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){i!==rn.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){i===rn.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),i===rn.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,r&&(this.lastError=r),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,i]of this.children.entries())if(t>=e){let r=i.subchannel.getConnectivityState();if(r===rn.ConnectivityState.IDLE||r===rn.ConnectivityState.CONNECTING){this.startConnecting(t);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,i;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===rn.ConnectivityState.IDLE&&(C7("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var r;(r=this.children[e])===null||r===void 0||r.subchannel.startConnecting()})),this.connectionDelayTimeout=(i=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},xH)).unref)===null||i===void 0?void 0:i.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(C7("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){C7(rn.ConnectivityState[this.currentState]+" -> "+rn.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(i=>({subchannel:this.channelControlHelper.createSubchannel(i,{}),hasReportedTransientFailure:!1}));for(let{subchannel:i}of t)i.ref(),this.channelControlHelper.addChannelzChild(i.getChannelzRef());this.resetSubchannelList(),this.children=t;for(let{subchannel:i}of this.children)if(i.addConnectivityStateListener(this.subchannelStateListener),i.getConnectivityState()===rn.ConnectivityState.READY){this.pickSubchannel(i);return}for(let i of this.children)i.subchannel.getConnectivityState()===rn.ConnectivityState.TRANSIENT_FAILURE&&(i.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof D4&&(t.getShuffleAddressList()&&(e=O_(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===rn.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return A4}};sr.PickFirstLoadBalancer=D8;function OH(){(0,x_.registerLoadBalancerType)(A4,D8,D4),(0,x_.registerDefaultLoadBalancerType)(A4)}sr.setup=OH});var D_=T(g1=>{"use strict";Object.defineProperty(g1,"__esModule",{value:!0});g1.setup=g1.RoundRobinLoadBalancer=void 0;var IH=ns(),sn=Qn(),k8=os(),AH=Gi(),DH=pt(),kH=Ie(),RH="round_robin";function A_(n){DH.trace(kH.LogVerbosity.DEBUG,RH,n)}var R8="round_robin",S7=class n{getLoadBalancerName(){return R8}constructor(){}toJsonObject(){return{[R8]:{}}}static createFromJson(e){return new n}},T7=class{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:k8.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},L8=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=sn.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(t,i,r,s,o)=>{this.calculateAndUpdateState(),(r===sn.ConnectivityState.TRANSIENT_FAILURE||r===sn.ConnectivityState.IDLE)&&(o&&(this.lastError=o),this.channelControlHelper.requestReresolution(),t.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(sn.ConnectivityState.READY)>0){let e=this.subchannels.filter(i=>i.getConnectivityState()===sn.ConnectivityState.READY),t=0;this.currentReadyPicker!==null&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(sn.ConnectivityState.READY,new T7(e,t))}else this.countSubchannelsWithState(sn.ConnectivityState.CONNECTING)>0?this.updateState(sn.ConnectivityState.CONNECTING,new k8.QueuePicker(this)):this.countSubchannelsWithState(sn.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(sn.ConnectivityState.TRANSIENT_FAILURE,new k8.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(sn.ConnectivityState.IDLE,new k8.QueuePicker(this))}updateState(e,t){A_(sn.ConnectivityState[this.currentState]+" -> "+sn.ConnectivityState[e]),e===sn.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),A_("Connect to address list "+e.map(i=>(0,AH.subchannelAddressToString)(i))),this.subchannels=e.map(i=>this.channelControlHelper.createSubchannel(i,{}));for(let i of this.subchannels){i.ref(),i.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(i.getChannelzRef());let r=i.getConnectivityState();(r===sn.ConnectivityState.IDLE||r===sn.ConnectivityState.TRANSIENT_FAILURE)&&i.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return R8}};g1.RoundRobinLoadBalancer=L8;function LH(){(0,IH.registerLoadBalancerType)(R8,L8,S7)}g1.setup=LH});var V_=T($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});$.experimental=$.addAdminServicesToServer=$.getChannelzHandlers=$.getChannelzServiceDefinition=$.InterceptorConfigurationError=$.InterceptingCall=$.RequesterBuilder=$.ListenerBuilder=$.StatusBuilder=$.getClientChannel=$.ServerCredentials=$.Server=$.setLogVerbosity=$.setLogger=$.load=$.loadObject=$.CallCredentials=$.ChannelCredentials=$.waitForClientReady=$.closeClient=$.Channel=$.makeGenericClientConstructor=$.makeClientConstructor=$.loadPackageDefinition=$.Client=$.compressionAlgorithms=$.propagate=$.connectivityState=$.status=$.logVerbosity=$.Metadata=$.credentials=void 0;var V8=bh();Object.defineProperty($,"CallCredentials",{enumerable:!0,get:function(){return V8.CallCredentials}});var VH=Zh();Object.defineProperty($,"Channel",{enumerable:!0,get:function(){return VH.ChannelImplementation}});var NH=O5();Object.defineProperty($,"compressionAlgorithms",{enumerable:!0,get:function(){return NH.CompressionAlgorithms}});var PH=Qn();Object.defineProperty($,"connectivityState",{enumerable:!0,get:function(){return PH.ConnectivityState}});var N8=Kl();Object.defineProperty($,"ChannelCredentials",{enumerable:!0,get:function(){return N8.ChannelCredentials}});var k_=Xh();Object.defineProperty($,"Client",{enumerable:!0,get:function(){return k_.Client}});var E7=Ie();Object.defineProperty($,"logVerbosity",{enumerable:!0,get:function(){return E7.LogVerbosity}});Object.defineProperty($,"status",{enumerable:!0,get:function(){return E7.Status}});Object.defineProperty($,"propagate",{enumerable:!0,get:function(){return E7.Propagate}});var R_=pt(),M7=ed();Object.defineProperty($,"loadPackageDefinition",{enumerable:!0,get:function(){return M7.loadPackageDefinition}});Object.defineProperty($,"makeClientConstructor",{enumerable:!0,get:function(){return M7.makeClientConstructor}});Object.defineProperty($,"makeGenericClientConstructor",{enumerable:!0,get:function(){return M7.makeClientConstructor}});var HH=fn();Object.defineProperty($,"Metadata",{enumerable:!0,get:function(){return HH.Metadata}});var BH=m_();Object.defineProperty($,"Server",{enumerable:!0,get:function(){return BH.Server}});var FH=n7();Object.defineProperty($,"ServerCredentials",{enumerable:!0,get:function(){return FH.ServerCredentials}});var qH=p_();Object.defineProperty($,"StatusBuilder",{enumerable:!0,get:function(){return qH.StatusBuilder}});$.credentials={combineChannelCredentials:(n,...e)=>e.reduce((t,i)=>t.compose(i),n),combineCallCredentials:(n,...e)=>e.reduce((t,i)=>t.compose(i),n),createInsecure:N8.ChannelCredentials.createInsecure,createSsl:N8.ChannelCredentials.createSsl,createFromSecureContext:N8.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:V8.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:V8.CallCredentials.createFromGoogleCredential,createEmpty:V8.CallCredentials.createEmpty};var UH=n=>n.close();$.closeClient=UH;var jH=(n,e,t)=>n.waitForReady(e,t);$.waitForClientReady=jH;var WH=(n,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};$.loadObject=WH;var GH=(n,e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};$.load=GH;var $H=n=>{R_.setLogger(n)};$.setLogger=$H;var YH=n=>{R_.setLoggerVerbosity(n)};$.setLogVerbosity=YH;var KH=n=>k_.Client.prototype.getChannel.call(n);$.getClientChannel=KH;var P8=Yh();Object.defineProperty($,"ListenerBuilder",{enumerable:!0,get:function(){return P8.ListenerBuilder}});Object.defineProperty($,"RequesterBuilder",{enumerable:!0,get:function(){return P8.RequesterBuilder}});Object.defineProperty($,"InterceptingCall",{enumerable:!0,get:function(){return P8.InterceptingCall}});Object.defineProperty($,"InterceptorConfigurationError",{enumerable:!0,get:function(){return P8.InterceptorConfigurationError}});var L_=vo();Object.defineProperty($,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return L_.getChannelzServiceDefinition}});Object.defineProperty($,"getChannelzHandlers",{enumerable:!0,get:function(){return L_.getChannelzHandlers}});var QH=r3();Object.defineProperty($,"addAdminServicesToServer",{enumerable:!0,get:function(){return QH.addAdminServicesToServer}});var XH=p7();$.experimental=XH;var ZH=g5(),JH=__(),eB=z_(),tB=I_(),nB=D_(),iB=m7(),rB=vo();ZH.setup(),JH.setup(),eB.setup(),tB.setup(),nB.setup(),iB.setup(),rB.setup()});import{inspect as aB,TextEncoder as cB,TextDecoder as lB}from"util";import{randomBytes as uB}from"crypto";var KI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},vi={},q,Fu=Fu||{},oe=KI||self;function xl(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function Uc(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function QI(n){return Object.prototype.hasOwnProperty.call(n,bu)&&n[bu]||(n[bu]=++XI)}var bu="closure_uid_"+(1e9*Math.random()>>>0),XI=0;function ZI(n,e,t){return n.call.apply(n.bind,arguments)}function JI(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function Zt(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Zt=ZI:Zt=JI,Zt.apply(null,arguments)}function pl(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function Ht(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(i,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(i,o)}}function Zr(){this.s=this.s,this.o=this.o}var eA=0;Zr.prototype.s=!1;Zr.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),eA!=0)&&QI(this)};Zr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var sv=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function qu(n){let e=n.length;if(0<e){let t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function $g(n,e){for(let t=1;t<arguments.length;t++){let i=arguments[t];if(xl(i)){let r=n.length||0,s=i.length||0;n.length=r+s;for(let o=0;o<s;o++)n[r+o]=i[o]}else n.push(i)}}function Jt(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Jt.prototype.h=function(){this.defaultPrevented=!0};var tA=function(){if(!oe.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{let t=()=>{};oe.addEventListener("test",t,e),oe.removeEventListener("test",t,e)}catch{}return n}();function Lc(n){return/^[\s\xa0]*$/.test(n)}function Ol(){var n=oe.navigator;return n&&(n=n.userAgent)?n:""}function Fi(n){return Ol().indexOf(n)!=-1}function Uu(n){return Uu[" "](n),n}Uu[" "]=function(){};function nA(n,e){var t=jA;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var iA=Fi("Opera"),za=Fi("Trident")||Fi("MSIE"),ov=Fi("Edge"),Eu=ov||za,av=Fi("Gecko")&&!(Ol().toLowerCase().indexOf("webkit")!=-1&&!Fi("Edge"))&&!(Fi("Trident")||Fi("MSIE"))&&!Fi("Edge"),rA=Ol().toLowerCase().indexOf("webkit")!=-1&&!Fi("Edge");function cv(){var n=oe.document;return n?n.documentMode:void 0}var Mu;e:{if(gl="",vl=function(){var n=Ol();if(av)return/rv:([^\);]+)(\)|;)/.exec(n);if(ov)return/Edge\/([\d\.]+)/.exec(n);if(za)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(rA)return/WebKit\/(\S+)/.exec(n);if(iA)return/(?:Version)[ \/]?(\S+)/.exec(n)}(),vl&&(gl=vl?vl[1]:""),za&&(yl=cv(),yl!=null&&yl>parseFloat(gl))){Mu=String(yl);break e}Mu=gl}var gl,vl,yl,zu;oe.document&&za?(Cu=cv(),zu=Cu||parseInt(Mu,10)||void 0):zu=void 0;var Cu,sA=zu;function Vc(n,e){if(Jt.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(av){e:{try{Uu(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:oA[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Vc.$.h.call(this)}}Ht(Vc,Jt);var oA={2:"touch",3:"pen",4:"mouse"};Vc.prototype.h=function(){Vc.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var jc="closure_listenable_"+(1e6*Math.random()|0),aA=0;function cA(n,e,t,i,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.la=r,this.key=++aA,this.fa=this.ia=!1}function Il(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function ju(n,e,t){for(let i in n)e.call(t,n[i],i,n)}function lA(n,e){for(let t in n)e.call(void 0,n[t],t,n)}function lv(n){let e={};for(let t in n)e[t]=n[t];return e}var Yg="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function uv(n,e){let t,i;for(let r=1;r<arguments.length;r++){i=arguments[r];for(t in i)n[t]=i[t];for(let s=0;s<Yg.length;s++)t=Yg[s],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function Al(n){this.src=n,this.g={},this.h=0}Al.prototype.add=function(n,e,t,i,r){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var o=Ou(n,e,i,r);return-1<o?(e=n[o],t||(e.ia=!1)):(e=new cA(e,this.src,s,!!i,r),e.ia=t,n.push(e)),e};function xu(n,e){var t=e.type;if(t in n.g){var i=n.g[t],r=sv(i,e),s;(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(Il(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function Ou(n,e,t,i){for(var r=0;r<n.length;++r){var s=n[r];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==i)return r}return-1}var Wu="closure_lm_"+(1e6*Math.random()|0),_u={};function hv(n,e,t,i,r){if(i&&i.once)return fv(n,e,t,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)hv(n,e[s],t,i,r);return null}return t=Yu(t),n&&n[jc]?n.O(e,t,Uc(i)?!!i.capture:!!i,r):dv(n,e,t,!1,i,r)}function dv(n,e,t,i,r,s){if(!e)throw Error("Invalid event type");var o=Uc(r)?!!r.capture:!!r,a=$u(n);if(a||(n[Wu]=a=new Al(n)),t=a.add(e,t,i,o,s),t.proxy)return t;if(i=uA(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)tA||(r=o),r===void 0&&(r=!1),n.addEventListener(e.toString(),i,r);else if(n.attachEvent)n.attachEvent(pv(e.toString()),i);else if(n.addListener&&n.removeListener)n.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return t}function uA(){function n(t){return e.call(n.src,n.listener,t)}let e=hA;return n}function fv(n,e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)fv(n,e[s],t,i,r);return null}return t=Yu(t),n&&n[jc]?n.P(e,t,Uc(i)?!!i.capture:!!i,r):dv(n,e,t,!0,i,r)}function mv(n,e,t,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)mv(n,e[s],t,i,r);else i=Uc(i)?!!i.capture:!!i,t=Yu(t),n&&n[jc]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=Ou(s,t,i,r),-1<t&&(Il(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=$u(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Ou(e,t,i,r)),(t=-1<n?e[n]:null)&&Gu(t))}function Gu(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[jc])xu(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(pv(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=$u(e))?(xu(t,n),t.h==0&&(t.src=null,e[Wu]=null)):Il(n)}}}function pv(n){return n in _u?_u[n]:_u[n]="on"+n}function hA(n,e){if(n.fa)n=!0;else{e=new Vc(e,this);var t=n.listener,i=n.la||n.src;n.ia&&Gu(n),n=t.call(i,e)}return n}function $u(n){return n=n[Wu],n instanceof Al?n:null}var Su="__closure_events_fn_"+(1e9*Math.random()>>>0);function Yu(n){return typeof n=="function"?n:(n[Su]||(n[Su]=function(e){return n.handleEvent(e)}),n[Su])}function Pt(){Zr.call(this),this.i=new Al(this),this.S=this,this.J=null}Ht(Pt,Zr);Pt.prototype[jc]=!0;Pt.prototype.removeEventListener=function(n,e,t,i){mv(this,n,e,t,i)};function Yt(n,e){var t,i=n.J;if(i)for(t=[];i;i=i.J)t.push(i);if(n=n.S,i=e.type||e,typeof e=="string")e=new Jt(e,n);else if(e instanceof Jt)e.target=e.target||n;else{var r=e;e=new Jt(i,n),uv(e,r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];r=wl(o,i,!0,e)&&r}if(o=e.g=n,r=wl(o,i,!0,e)&&r,r=wl(o,i,!1,e)&&r,t)for(s=0;s<t.length;s++)o=e.g=t[s],r=wl(o,i,!1,e)&&r}Pt.prototype.N=function(){if(Pt.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)Il(t[i]);delete n.g[e],n.h--}}this.J=null};Pt.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)};Pt.prototype.P=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};function wl(n,e,t,i){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&xu(n.i,o),r=a.call(c,i)!==!1&&r}}return r&&!i.defaultPrevented}var Ku=oe.JSON.stringify,Iu=class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function dA(){var n=Qu;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Au=class{constructor(){this.h=this.g=null}add(e,t){let i=gv.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}},gv=new Iu(()=>new Du,n=>n.reset()),Du=class{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}};function fA(n){var e=1;n=n.split(":");let t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function mA(n){oe.setTimeout(()=>{throw n},0)}var Nc,Pc=!1,Qu=new Au,vv=()=>{let n=oe.Promise.resolve(void 0);Nc=()=>{n.then(pA)}},pA=()=>{for(var n;n=dA();){try{n.h.call(n.g)}catch(t){mA(t)}var e=gv;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Pc=!1};function Dl(n,e){Pt.call(this),this.h=n||1,this.g=e||oe,this.j=Zt(this.qb,this),this.l=Date.now()}Ht(Dl,Pt);q=Dl.prototype;q.ga=!1;q.T=null;q.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Yt(this,"tick"),this.ga&&(Xu(this),this.start()))}};q.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Xu(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}q.N=function(){Dl.$.N.call(this),Xu(this),delete this.g};function Zu(n,e,t){if(typeof n=="function")t&&(n=Zt(n,t));else if(n&&typeof n.handleEvent=="function")n=Zt(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:oe.setTimeout(n,e||0)}function yv(n){n.g=Zu(()=>{n.g=null,n.i&&(n.i=!1,yv(n))},n.j);let e=n.h;n.h=null,n.m.apply(null,e)}var ku=class extends Zr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:yv(this)}N(){super.N(),this.g&&(oe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Hc(n){Zr.call(this),this.h=n,this.g={}}Ht(Hc,Zr);var Kg=[];function wv(n,e,t,i){Array.isArray(t)||(t&&(Kg[0]=t.toString()),t=Kg);for(var r=0;r<t.length;r++){var s=hv(e,t[r],i||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function bv(n){ju(n.g,function(e,t){this.g.hasOwnProperty(t)&&Gu(e)},n),n.g={}}Hc.prototype.N=function(){Hc.$.N.call(this),bv(this)};Hc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function kl(){this.g=!0}kl.prototype.Ea=function(){this.g=!1};function gA(n,e,t,i,r,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+`
`+t+`
`+o})}function vA(n,e,t,i,r,s,o){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+`
`+t+`
`+s+" "+o})}function Ea(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+wA(n,t)+(i?" "+i:"")})}function yA(n,e){n.info(function(){return"TIMEOUT: "+e})}kl.prototype.info=function(){};function wA(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return Ku(t)}catch{return e}}var co={},Qg=null;function Rl(){return Qg=Qg||new Pt}co.Ta="serverreachability";function Cv(n){Jt.call(this,co.Ta,n)}Ht(Cv,Jt);function Bc(n){let e=Rl();Yt(e,new Cv(e))}co.STAT_EVENT="statevent";function _v(n,e){Jt.call(this,co.STAT_EVENT,n),this.stat=e}Ht(_v,Jt);function hn(n){let e=Rl();Yt(e,new _v(e,n))}co.Ua="timingevent";function Sv(n,e){Jt.call(this,co.Ua,n),this.size=e}Ht(Sv,Jt);function Wc(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return oe.setTimeout(function(){n()},e)}var Ll={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Tv={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Ju(){}Ju.prototype.h=null;function Xg(n){return n.h||(n.h=n.i())}function Ev(){}var Gc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function eh(){Jt.call(this,"d")}Ht(eh,Jt);function th(){Jt.call(this,"c")}Ht(th,Jt);var Ru;function Vl(){}Ht(Vl,Ju);Vl.prototype.g=function(){return new XMLHttpRequest};Vl.prototype.i=function(){return{}};Ru=new Vl;function $c(n,e,t,i){this.l=n,this.j=e,this.m=t,this.W=i||1,this.U=new Hc(this),this.P=bA,n=Eu?125:void 0,this.V=new Dl(n),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Mv}function Mv(){this.i=null,this.g="",this.h=!1}var bA=45e3,zv={},Lu={};q=$c.prototype;q.setTimeout=function(n){this.P=n};function Vu(n,e,t){n.L=1,n.A=Pl(_r(e)),n.u=t,n.S=!0,xv(n,null)}function xv(n,e){n.G=Date.now(),Yc(n),n.B=_r(n.A);var t=n.B,i=n.W;Array.isArray(i)||(i=[String(i)]),Vv(t.i,"t",i),n.o=0,t=n.l.J,n.h=new Mv,n.g=iy(n.l,t?e:null,!n.u),0<n.O&&(n.M=new ku(Zt(n.Pa,n,n.g),n.O)),wv(n.U,n.g,"readystatechange",n.nb),e=n.I?lv(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),Bc(),gA(n.j,n.v,n.B,n.m,n.W,n.u)}q.nb=function(n){n=n.target;let e=this.M;e&&qi(n)==3?e.l():this.Pa(n)};q.Pa=function(n){try{if(n==this.g)e:{let u=qi(this.g);var e=this.g.Ia();let h=this.g.da();if(!(3>u)&&(u!=3||Eu||this.g&&(this.h.h||this.g.ja()||tv(this.g)))){this.J||u!=4||e==7||(e==8||0>=h?Bc(3):Bc(2)),Nl(this);var t=this.g.da();this.ca=t;t:if(Ov(this)){var i=tv(this.g);n="";var r=i.length,s=qi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){so(this),Rc(this);var o="";break t}this.h.i=new oe.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.length=0,this.h.g+=n,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=t==200,vA(this.j,this.v,this.B,this.m,this.W,u,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Lc(a)){var l=a;break t}}l=null}if(t=l)Ea(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Nu(this,t);else{this.i=!1,this.s=3,hn(12),so(this),Rc(this);break e}}this.S?(Iv(this,u,o),Eu&&this.i&&u==3&&(wv(this.U,this.V,"tick",this.mb),this.V.start())):(Ea(this.j,this.m,o,null),Nu(this,o)),u==4&&so(this),this.i&&!this.J&&(u==4?Jv(this.l,this):(this.i=!1,Yc(this)))}else FA(this.g),t==400&&0<o.indexOf("Unknown SID")?(this.s=3,hn(12)):(this.s=0,hn(13)),so(this),Rc(this)}}}catch{}finally{}};function Ov(n){return n.g?n.v=="GET"&&n.L!=2&&n.l.Ha:!1}function Iv(n,e,t){let i=!0,r;for(;!n.J&&n.o<t.length;)if(r=CA(n,t),r==Lu){e==4&&(n.s=4,hn(14),i=!1),Ea(n.j,n.m,null,"[Incomplete Response]");break}else if(r==zv){n.s=4,hn(15),Ea(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}else Ea(n.j,n.m,r,null),Nu(n,r);Ov(n)&&n.o!=0&&(n.h.g=n.h.g.slice(n.o),n.o=0),e!=4||t.length!=0||n.h.h||(n.s=1,hn(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),ah(e),e.M=!0,hn(11))):(Ea(n.j,n.m,t,"[Invalid Chunked Response]"),so(n),Rc(n))}q.mb=function(){if(this.g){var n=qi(this.g),e=this.g.ja();this.o<e.length&&(Nl(this),Iv(this,n,e),this.i&&n!=4&&Yc(this))}};function CA(n,e){var t=n.o,i=e.indexOf(`
`,t);return i==-1?Lu:(t=Number(e.substring(t,i)),isNaN(t)?zv:(i+=1,i+t>e.length?Lu:(e=e.slice(i,i+t),n.o=i+t,e)))}q.cancel=function(){this.J=!0,so(this)};function Yc(n){n.Y=Date.now()+n.P,Av(n,n.P)}function Av(n,e){if(n.C!=null)throw Error("WatchDog timer not null");n.C=Wc(Zt(n.lb,n),e)}function Nl(n){n.C&&(oe.clearTimeout(n.C),n.C=null)}q.lb=function(){this.C=null;let n=Date.now();0<=n-this.Y?(yA(this.j,this.B),this.L!=2&&(Bc(),hn(17)),so(this),this.s=2,Rc(this)):Av(this,this.Y-n)};function Rc(n){n.l.H==0||n.J||Jv(n.l,n)}function so(n){Nl(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,Xu(n.V),bv(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function Nu(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||Pu(t.i,n))){if(!n.K&&Pu(t.i,n)&&t.H==3){try{var i=t.Ja.g.parse(e)}catch{i=null}if(Array.isArray(i)&&i.length==3){var r=i;if(r[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)Tl(t),Fl(t);else break e;oh(t),hn(18)}}else t.Fa=r[1],0<t.Fa-t.V&&37500>r[2]&&t.G&&t.A==0&&!t.v&&(t.v=Wc(Zt(t.ib,t),6e3));if(1>=Hv(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else oo(t,11)}else if((n.K||t.g==n)&&Tl(t),!Lc(e))for(r=t.Ja.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(t.V=l[0],l=l[1],t.H==2)if(l[0]=="c"){t.K=l[1],t.pa=l[2];let u=l[3];u!=null&&(t.ra=u,t.l.info("VER="+t.ra));let h=l[4];h!=null&&(t.Ga=h,t.l.info("SVER="+t.Ga));let d=l[5];d!=null&&typeof d=="number"&&0<d&&(i=1.5*d,t.L=i,t.l.info("backChannelRequestTimeoutMs_="+i)),i=t;let m=n.g;if(m){let p=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=i.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(nh(s,s.h),s.h=null))}if(i.F){let v=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(i.Da=v,tt(i.I,i.F,v))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),i=t;var o=n;if(i.wa=ny(i,i.J?i.pa:null,i.Y),o.K){Bv(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.C&&(Nl(a),Yc(a)),i.g=o}else Xv(i);0<t.j.length&&ql(t)}else l[0]!="stop"&&l[0]!="close"||oo(t,7);else t.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?oo(t,7):sh(t):l[0]!="noop"&&t.h&&t.h.Aa(l),t.A=0)}}Bc(4)}catch{}}function _A(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(xl(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}e=[],t=0;for(i in n)e[t++]=n[i];return e}function SA(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(xl(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(let i in n)e[t++]=i;return e}}}function Dv(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(xl(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=SA(n),i=_A(n),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],t&&t[s],n)}var kv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function TA(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),r=null;if(0<=i){var s=n[t].substring(0,i);r=n[t].substring(i+1)}else s=n[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function ao(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof ao){this.h=n.h,_l(this,n.j),this.s=n.s,this.g=n.g,Sl(this,n.m),this.l=n.l;var e=n.i,t=new Fc;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Zg(this,t),this.o=n.o}else n&&(e=String(n).match(kv))?(this.h=!1,_l(this,e[1]||"",!0),this.s=Dc(e[2]||""),this.g=Dc(e[3]||"",!0),Sl(this,e[4]),this.l=Dc(e[5]||"",!0),Zg(this,e[6]||"",!0),this.o=Dc(e[7]||"")):(this.h=!1,this.i=new Fc(null,this.h))}ao.prototype.toString=function(){var n=[],e=this.j;e&&n.push(kc(e,Jg,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(kc(e,Jg,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(kc(t,t.charAt(0)=="/"?zA:MA,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",kc(t,OA)),n.join("")};function _r(n){return new ao(n)}function _l(n,e,t){n.j=t?Dc(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Sl(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Zg(n,e,t){e instanceof Fc?(n.i=e,IA(n.i,n.h)):(t||(e=kc(e,xA)),n.i=new Fc(e,n.h))}function tt(n,e,t){n.i.set(e,t)}function Pl(n){return tt(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Dc(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function kc(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,EA),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function EA(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var Jg=/[#\/\?@]/g,MA=/[#\?:]/g,zA=/[#\?]/g,xA=/[#\?@]/g,OA=/#/g;function Fc(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Jr(n){n.g||(n.g=new Map,n.h=0,n.i&&TA(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}q=Fc.prototype;q.add=function(n,e){Jr(this),this.i=null,n=xa(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function Rv(n,e){Jr(n),e=xa(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function Lv(n,e){return Jr(n),e=xa(n,e),n.g.has(e)}q.forEach=function(n,e){Jr(this),this.g.forEach(function(t,i){t.forEach(function(r){n.call(e,r,i,this)},this)},this)};q.ta=function(){Jr(this);let n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){let r=n[i];for(let s=0;s<r.length;s++)t.push(e[i])}return t};q.Z=function(n){Jr(this);let e=[];if(typeof n=="string")Lv(this,n)&&(e=e.concat(this.g.get(xa(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};q.set=function(n,e){return Jr(this),this.i=null,n=xa(this,n),Lv(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};q.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function Vv(n,e,t){Rv(n,e),0<t.length&&(n.i=null,n.g.set(xa(n,e),qu(t)),n.h+=t.length)}q.toString=function(){if(this.i)return this.i;if(!this.g)return"";let n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];let s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;o[i]!==""&&(r+="="+encodeURIComponent(String(o[i]))),n.push(r)}}return this.i=n.join("&")};function xa(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function IA(n,e){e&&!n.j&&(Jr(n),n.i=null,n.g.forEach(function(t,i){var r=i.toLowerCase();i!=r&&(Rv(this,i),Vv(this,r,t))},n)),n.j=e}var AA=class{constructor(n,e){this.g=n,this.map=e}};function Nv(n){this.l=n||DA,oe.PerformanceNavigationTiming?(n=oe.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(oe.g&&oe.g.Ka&&oe.g.Ka()&&oe.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var DA=10;function Pv(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function Hv(n){return n.h?1:n.g?n.g.size:0}function Pu(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function nh(n,e){n.g?n.g.add(e):n.h=e}function Bv(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}Nv.prototype.cancel=function(){if(this.i=Fv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let n of this.g.values())n.cancel();this.g.clear()}};function Fv(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(let t of n.g.values())e=e.concat(t.F);return e}return qu(n.i)}var kA=class{stringify(n){return oe.JSON.stringify(n,void 0)}parse(n){return oe.JSON.parse(n,void 0)}};function RA(){this.g=new kA}function LA(n,e,t){let i=t||"";try{Dv(n,function(r,s){let o=r;Uc(r)&&(o=Ku(r)),e.push(i+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function VA(n,e){let t=new kl;if(oe.Image){let i=new Image;i.onload=pl(bl,t,i,"TestLoadImage: loaded",!0,e),i.onerror=pl(bl,t,i,"TestLoadImage: error",!1,e),i.onabort=pl(bl,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=pl(bl,t,i,"TestLoadImage: timeout",!1,e),oe.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}function bl(n,e,t,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function Kc(n){this.l=n.ec||null,this.j=n.ob||!1}Ht(Kc,Ju);Kc.prototype.g=function(){return new Hl(this.l,this.j)};Kc.prototype.i=function(n){return function(){return n}}({});function Hl(n,e){Pt.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=ih,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ht(Hl,Pt);var ih=0;q=Hl.prototype;q.open=function(n,e){if(this.readyState!=ih)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,qc(this)};q.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||oe).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};q.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Qc(this)),this.readyState=ih};q.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,qc(this)),this.g&&(this.readyState=3,qc(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof oe.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qv(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function qv(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}q.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Qc(this):qc(this),this.readyState==3&&qv(this)}};q.Za=function(n){this.g&&(this.response=this.responseText=n,Qc(this))};q.Ya=function(n){this.g&&(this.response=n,Qc(this))};q.ka=function(){this.g&&Qc(this)};function Qc(n){n.readyState=4,n.l=null,n.j=null,n.A=null,qc(n)}q.setRequestHeader=function(n,e){this.v.append(n,e)};q.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};q.getAllResponseHeaders=function(){if(!this.h)return"";let n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function qc(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(Hl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var NA=oe.JSON.parse;function mt(n){Pt.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Uv,this.L=this.M=!1}Ht(mt,Pt);var Uv="",PA=/^https?$/i,HA=["POST","PUT"];q=mt.prototype;q.Oa=function(n){this.M=n};q.ha=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ru.g(),this.C=this.u?Xg(this.u):Xg(Ru),this.g.onreadystatechange=Zt(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){ev(this,s);return}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)t.set(r,i[r]);else if(typeof i.keys=="function"&&typeof i.get=="function")for(let s of i.keys())t.set(s,i.get(s));else throw Error("Unknown input type for opt_headers: "+String(i));i=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),r=oe.FormData&&n instanceof oe.FormData,!(0<=sv(HA,e))||i||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Gv(this),0<this.B&&((this.L=BA(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Zt(this.ua,this)):this.A=Zu(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){ev(this,s)}};function BA(n){return za&&typeof n.timeout=="number"&&n.ontimeout!==void 0}q.ua=function(){typeof Fu<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Yt(this,"timeout"),this.abort(8))};function ev(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,jv(n),Bl(n)}function jv(n){n.F||(n.F=!0,Yt(n,"complete"),Yt(n,"error"))}q.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Yt(this,"complete"),Yt(this,"abort"),Bl(this))};q.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Bl(this,!0)),mt.$.N.call(this)};q.La=function(){this.s||(this.G||this.v||this.l?Wv(this):this.kb())};q.kb=function(){Wv(this)};function Wv(n){if(n.h&&typeof Fu<"u"&&(!n.C[1]||qi(n)!=4||n.da()!=2)){if(n.v&&qi(n)==4)Zu(n.La,0,n);else if(Yt(n,"readystatechange"),qi(n)==4){n.h=!1;try{let o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=o===0){var r=String(n.I).match(kv)[1]||null;!r&&oe.self&&oe.self.location&&(r=oe.self.location.protocol.slice(0,-1)),i=!PA.test(r?r.toLowerCase():"")}t=i}if(t)Yt(n,"complete"),Yt(n,"success");else{n.m=6;try{var s=2<qi(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",jv(n)}}finally{Bl(n)}}}}function Bl(n,e){if(n.g){Gv(n);let t=n.g,i=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||Yt(n,"ready");try{t.onreadystatechange=i}catch{}}}function Gv(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(oe.clearTimeout(n.A),n.A=null)}q.isActive=function(){return!!this.g};function qi(n){return n.g?n.g.readyState:0}q.da=function(){try{return 2<qi(this)?this.g.status:-1}catch{return-1}};q.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};q.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),NA(e)}};function tv(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case Uv:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function FA(n){let e={};n=(n.g&&2<=qi(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let i=0;i<n.length;i++){if(Lc(n[i]))continue;var t=fA(n[i]);let r=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();let s=e[r]||[];e[r]=s,s.push(t)}lA(e,function(i){return i.join(", ")})}q.Ia=function(){return this.m};q.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function $v(n){let e="";return ju(n,function(t,i){e+=i,e+=":",e+=t,e+=`\r
`}),e}function rh(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=$v(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):tt(n,e,t))}function Ic(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function Yv(n){this.Ga=0,this.j=[],this.l=new kl,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Ic("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Ic("baseRetryDelayMs",5e3,n),this.hb=Ic("retryDelaySeedMs",1e4,n),this.eb=Ic("forwardChannelMaxRetries",2,n),this.xa=Ic("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new Nv(n&&n.concurrentRequestLimit),this.Ja=new RA,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}q=Yv.prototype;q.ra=8;q.H=1;function sh(n){if(Kv(n),n.H==3){var e=n.W++,t=_r(n.I);if(tt(t,"SID",n.K),tt(t,"RID",e),tt(t,"TYPE","terminate"),Xc(n,t),e=new $c(n,n.l,e),e.L=2,e.A=Pl(_r(t)),t=!1,oe.navigator&&oe.navigator.sendBeacon)try{t=oe.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&oe.Image&&(new Image().src=e.A,t=!0),t||(e.g=iy(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Yc(e)}ty(n)}function Fl(n){n.g&&(ah(n),n.g.cancel(),n.g=null)}function Kv(n){Fl(n),n.u&&(oe.clearTimeout(n.u),n.u=null),Tl(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&oe.clearTimeout(n.m),n.m=null)}function ql(n){if(!Pv(n.i)&&!n.m){n.m=!0;var e=n.Na;Nc||vv(),Pc||(Nc(),Pc=!0),Qu.add(e,n),n.C=0}}function qA(n,e){return Hv(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=Wc(Zt(n.Na,n,e),ey(n,n.C)),n.C++,!0)}q.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;let r=new $c(this,this.l,n),s=this.s;if(this.U&&(s?(s=lv(s),uv(s,this.U)):s=this.U),this.o!==null||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var i=this.j[t];if("__data__"in i.map&&(i=i.map.__data__,typeof i=="string")){i=i.length;break t}i=void 0}if(i===void 0)break;if(e+=i,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Qv(this,r,e),t=_r(this.I),tt(t,"RID",n),tt(t,"CVER",22),this.F&&tt(t,"X-HTTP-Session-Id",this.F),Xc(this,t),s&&(this.O?e="headers="+encodeURIComponent(String($v(s)))+"&"+e:this.o&&rh(t,this.o,s)),nh(this.i,r),this.bb&&tt(t,"TYPE","init"),this.P?(tt(t,"$req",e),tt(t,"SID","null"),r.aa=!0,Vu(r,t,null)):Vu(r,t,e),this.H=2}}else this.H==3&&(n?nv(this,n):this.j.length==0||Pv(this.i)||nv(this))};function nv(n,e){var t;e?t=e.m:t=n.W++;let i=_r(n.I);tt(i,"SID",n.K),tt(i,"RID",t),tt(i,"AID",n.V),Xc(n,i),n.o&&n.s&&rh(i,n.o,n.s),t=new $c(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=Qv(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),nh(n.i,t),Vu(t,i,e)}function Xc(n,e){n.na&&ju(n.na,function(t,i){tt(e,i,t)}),n.h&&Dv({},function(t,i){tt(e,i,t)})}function Qv(n,e,t){t=Math.min(n.j.length,t);var i=n.h?Zt(n.h.Va,n.h,n):null;e:{var r=n.j;let s=-1;for(;;){let o=["count="+t];s==-1?0<t?(s=r[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<t;c++){let l=r[c].g,u=r[c].map;if(l-=s,0>l)s=Math.max(0,r[c].g-100),a=!1;else try{LA(u,o,"req"+l+"_")}catch{i&&i(u)}}if(a){i=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,i}function Xv(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Nc||vv(),Pc||(Nc(),Pc=!0),Qu.add(e,n),n.A=0}}function oh(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=Wc(Zt(n.Ma,n),ey(n,n.A)),n.A++,!0)}q.Ma=function(){if(this.u=null,Zv(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Wc(Zt(this.jb,this),n)}};q.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,hn(10),Fl(this),Zv(this))};function ah(n){n.B!=null&&(oe.clearTimeout(n.B),n.B=null)}function Zv(n){n.g=new $c(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=_r(n.wa);tt(e,"RID","rpc"),tt(e,"SID",n.K),tt(e,"AID",n.V),tt(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&tt(e,"TO",n.qa),tt(e,"TYPE","xmlhttp"),Xc(n,e),n.o&&n.s&&rh(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=Pl(_r(e)),t.u=null,t.S=!0,xv(t,n)}q.ib=function(){this.v!=null&&(this.v=null,Fl(this),oh(this),hn(19))};function Tl(n){n.v!=null&&(oe.clearTimeout(n.v),n.v=null)}function Jv(n,e){var t=null;if(n.g==e){Tl(n),ah(n),n.g=null;var i=2}else if(Pu(n.i,e))t=e.F,Bv(n.i,e),i=1;else return;if(n.H!=0){if(e.i)if(i==1){t=e.u?e.u.length:0,e=Date.now()-e.G;var r=n.C;i=Rl(),Yt(i,new Sv(i,t)),ql(n)}else Xv(n);else if(r=e.s,r==3||r==0&&0<e.ca||!(i==1&&qA(n,e)||i==2&&oh(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),r){case 1:oo(n,5);break;case 4:oo(n,10);break;case 3:oo(n,6);break;default:oo(n,2)}}}function ey(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function oo(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var i=Zt(n.pb,n);t||(t=new ao("//www.google.com/images/cleardot.gif"),oe.location&&oe.location.protocol=="http"||_l(t,"https"),Pl(t)),VA(t.toString(),i)}else hn(2);n.H=0,n.h&&n.h.za(e),ty(n),Kv(n)}q.pb=function(n){n?(this.l.info("Successfully pinged google.com"),hn(2)):(this.l.info("Failed to ping google.com"),hn(1))};function ty(n){if(n.H=0,n.ma=[],n.h){let e=Fv(n.i);(e.length!=0||n.j.length!=0)&&($g(n.ma,e),$g(n.ma,n.j),n.i.i.length=0,qu(n.j),n.j.length=0),n.h.ya()}}function ny(n,e,t){var i=t instanceof ao?_r(t):new ao(t);if(i.g!="")e&&(i.g=e+"."+i.g),Sl(i,i.m);else{var r=oe.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new ao(null);i&&_l(s,i),e&&(s.g=e),r&&Sl(s,r),t&&(s.l=t),i=s}return t=n.F,e=n.Da,t&&e&&tt(i,t,e),tt(i,"VER",n.ra),Xc(n,i),i}function iy(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n.Ha&&!n.va?new mt(new Kc({ob:t})):new mt(n.va),e.Oa(n.J),e}q.isActive=function(){return!!this.h&&this.h.isActive(this)};function ry(){}q=ry.prototype;q.Ba=function(){};q.Aa=function(){};q.za=function(){};q.ya=function(){};q.isActive=function(){return!0};q.Va=function(){};function El(){if(za&&!(10<=Number(sA)))throw Error("Environmental error: no available transport.")}El.prototype.g=function(n,e){return new Vn(n,e)};function Vn(n,e){Pt.call(this),this.g=new Yv(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Lc(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Lc(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new Oa(this)}Ht(Vn,Pt);Vn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;hn(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=ny(n,null,n.Y),ql(n)};Vn.prototype.close=function(){sh(this.g)};Vn.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=Ku(n),n=t);e.j.push(new AA(e.fb++,n)),e.H==3&&ql(e)};Vn.prototype.N=function(){this.g.h=null,delete this.j,sh(this.g),delete this.g,Vn.$.N.call(this)};function sy(n){eh.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(let t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}Ht(sy,eh);function oy(){th.call(this),this.status=1}Ht(oy,th);function Oa(n){this.g=n}Ht(Oa,ry);Oa.prototype.Ba=function(){Yt(this.g,"a")};Oa.prototype.Aa=function(n){Yt(this.g,new sy(n))};Oa.prototype.za=function(n){Yt(this.g,new oy)};Oa.prototype.ya=function(){Yt(this.g,"b")};function UA(){this.blockSize=-1}function gi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ht(gi,UA);gi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Tu(n,e,t){t||(t=0);var i=Array(16);if(typeof e=="string")for(var r=0;16>r;++r)i[r]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(r=0;16>r;++r)i[r]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],r=n.g[2];var s=n.g[3],o=e+(s^t&(r^s))+i[0]+3614090360&4294967295;e=t+(o<<7&4294967295|o>>>25),o=s+(r^e&(t^r))+i[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(t^s&(e^t))+i[2]+606105819&4294967295,r=s+(o<<17&4294967295|o>>>15),o=t+(e^r&(s^e))+i[3]+3250441966&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(s^t&(r^s))+i[4]+4118548399&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(r^e&(t^r))+i[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(t^s&(e^t))+i[6]+2821735955&4294967295,r=s+(o<<17&4294967295|o>>>15),o=t+(e^r&(s^e))+i[7]+4249261313&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(s^t&(r^s))+i[8]+1770035416&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(r^e&(t^r))+i[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(t^s&(e^t))+i[10]+4294925233&4294967295,r=s+(o<<17&4294967295|o>>>15),o=t+(e^r&(s^e))+i[11]+2304563134&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(s^t&(r^s))+i[12]+1804603682&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(r^e&(t^r))+i[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(t^s&(e^t))+i[14]+2792965006&4294967295,r=s+(o<<17&4294967295|o>>>15),o=t+(e^r&(s^e))+i[15]+1236535329&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(r^s&(t^r))+i[1]+4129170786&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^r&(e^t))+i[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(s^e))+i[11]+643717713&4294967295,r=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(r^s))+i[0]+3921069994&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(t^r))+i[5]+3593408605&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^r&(e^t))+i[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(s^e))+i[15]+3634488961&4294967295,r=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(r^s))+i[4]+3889429448&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(t^r))+i[9]+568446438&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^r&(e^t))+i[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(s^e))+i[3]+4107603335&4294967295,r=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(r^s))+i[8]+1163531501&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(t^r))+i[13]+2850285829&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^r&(e^t))+i[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(s^e))+i[7]+1735328473&4294967295,r=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(r^s))+i[12]+2368359562&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(t^r^s)+i[5]+4294588738&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^r)+i[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^t)+i[11]+1839030562&4294967295,r=s+(o<<16&4294967295|o>>>16),o=t+(r^s^e)+i[14]+4259657740&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(t^r^s)+i[1]+2763975236&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^r)+i[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^t)+i[7]+4139469664&4294967295,r=s+(o<<16&4294967295|o>>>16),o=t+(r^s^e)+i[10]+3200236656&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(t^r^s)+i[13]+681279174&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^r)+i[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^t)+i[3]+3572445317&4294967295,r=s+(o<<16&4294967295|o>>>16),o=t+(r^s^e)+i[6]+76029189&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(t^r^s)+i[9]+3654602809&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^r)+i[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^t)+i[15]+530742520&4294967295,r=s+(o<<16&4294967295|o>>>16),o=t+(r^s^e)+i[2]+3299628645&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(r^(t|~s))+i[0]+4096336452&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~r))+i[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~t))+i[14]+2878612391&4294967295,r=s+(o<<15&4294967295|o>>>17),o=t+(s^(r|~e))+i[5]+4237533241&4294967295,t=r+(o<<21&4294967295|o>>>11),o=e+(r^(t|~s))+i[12]+1700485571&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~r))+i[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~t))+i[10]+4293915773&4294967295,r=s+(o<<15&4294967295|o>>>17),o=t+(s^(r|~e))+i[1]+2240044497&4294967295,t=r+(o<<21&4294967295|o>>>11),o=e+(r^(t|~s))+i[8]+1873313359&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~r))+i[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~t))+i[6]+2734768916&4294967295,r=s+(o<<15&4294967295|o>>>17),o=t+(s^(r|~e))+i[13]+1309151649&4294967295,t=r+(o<<21&4294967295|o>>>11),o=e+(r^(t|~s))+i[4]+4149444226&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~r))+i[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~t))+i[2]+718787259&4294967295,r=s+(o<<15&4294967295|o>>>17),o=t+(s^(r|~e))+i[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+r&4294967295,n.g[3]=n.g[3]+s&4294967295}gi.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(r==0)for(;s<=t;)Tu(this,n,s),s+=this.blockSize;if(typeof n=="string"){for(;s<e;)if(i[r++]=n.charCodeAt(s++),r==this.blockSize){Tu(this,i),r=0;break}}else for(;s<e;)if(i[r++]=n[s++],r==this.blockSize){Tu(this,i),r=0;break}}this.h=r,this.i+=e};gi.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var i=0;32>i;i+=8)n[t++]=this.g[e]>>>i&255;return n};function Ne(n,e){this.h=e;for(var t=[],i=!0,r=n.length-1;0<=r;r--){var s=n[r]|0;i&&s==e||(t[r]=s,i=!1)}this.g=t}var jA={};function ch(n){return-128<=n&&128>n?nA(n,function(e){return new Ne([e|0],0>e?-1:0)}):new Ne([n|0],0>n?-1:0)}function Ui(n){if(isNaN(n)||!isFinite(n))return Ma;if(0>n)return $t(Ui(-n));for(var e=[],t=1,i=0;n>=t;i++)e[i]=n/t|0,t*=Hu;return new Ne(e,0)}function ay(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return $t(ay(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Ui(Math.pow(e,8)),i=Ma,r=0;r<n.length;r+=8){var s=Math.min(8,n.length-r),o=parseInt(n.substring(r,r+s),e);8>s?(s=Ui(Math.pow(e,s)),i=i.R(s).add(Ui(o))):(i=i.R(t),i=i.add(Ui(o)))}return i}var Hu=4294967296,Ma=ch(0),Bu=ch(1),iv=ch(16777216);q=Ne.prototype;q.ea=function(){if(Yn(this))return-$t(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var i=this.D(t);n+=(0<=i?i:Hu+i)*e,e*=Hu}return n};q.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(Cr(this))return"0";if(Yn(this))return"-"+$t(this).toString(n);for(var e=Ui(Math.pow(n,6)),t=this,i="";;){var r=zl(t,e).g;t=Ml(t,r.R(e));var s=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=r,Cr(t))return s+i;for(;6>s.length;)s="0"+s;i=s+i}};q.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function Cr(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function Yn(n){return n.h==-1}q.X=function(n){return n=Ml(this,n),Yn(n)?-1:Cr(n)?0:1};function $t(n){for(var e=n.g.length,t=[],i=0;i<e;i++)t[i]=~n.g[i];return new Ne(t,~n.h).add(Bu)}q.abs=function(){return Yn(this)?$t(this):this};q.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0,r=0;r<=e;r++){var s=i+(this.D(r)&65535)+(n.D(r)&65535),o=(s>>>16)+(this.D(r)>>>16)+(n.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,t[r]=o<<16|s}return new Ne(t,t[t.length-1]&-2147483648?-1:0)};function Ml(n,e){return n.add($t(e))}q.R=function(n){if(Cr(this)||Cr(n))return Ma;if(Yn(this))return Yn(n)?$t(this).R($t(n)):$t($t(this).R(n));if(Yn(n))return $t(this.R($t(n)));if(0>this.X(iv)&&0>n.X(iv))return Ui(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],i=0;i<2*e;i++)t[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<n.g.length;r++){var s=this.D(i)>>>16,o=this.D(i)&65535,a=n.D(r)>>>16,c=n.D(r)&65535;t[2*i+2*r]+=o*c,Cl(t,2*i+2*r),t[2*i+2*r+1]+=s*c,Cl(t,2*i+2*r+1),t[2*i+2*r+1]+=o*a,Cl(t,2*i+2*r+1),t[2*i+2*r+2]+=s*a,Cl(t,2*i+2*r+2)}for(i=0;i<e;i++)t[i]=t[2*i+1]<<16|t[2*i];for(i=e;i<2*e;i++)t[i]=0;return new Ne(t,0)};function Cl(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Ac(n,e){this.g=n,this.h=e}function zl(n,e){if(Cr(e))throw Error("division by zero");if(Cr(n))return new Ac(Ma,Ma);if(Yn(n))return e=zl($t(n),e),new Ac($t(e.g),$t(e.h));if(Yn(e))return e=zl(n,$t(e)),new Ac($t(e.g),e.h);if(30<n.g.length){if(Yn(n)||Yn(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Bu,i=e;0>=i.X(n);)t=rv(t),i=rv(i);var r=Ta(t,1),s=Ta(i,1);for(i=Ta(i,2),t=Ta(t,2);!Cr(i);){var o=s.add(i);0>=o.X(n)&&(r=r.add(t),s=o),i=Ta(i,1),t=Ta(t,1)}return e=Ml(n,r.R(e)),new Ac(r,e)}for(r=Ma;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),i=Math.ceil(Math.log(t)/Math.LN2),i=48>=i?1:Math.pow(2,i-48),s=Ui(t),o=s.R(e);Yn(o)||0<o.X(n);)t-=i,s=Ui(t),o=s.R(e);Cr(s)&&(s=Bu),r=r.add(s),n=Ml(n,o)}return new Ac(r,n)}q.gb=function(n){return zl(this,n).h};q.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)&n.D(i);return new Ne(t,this.h&n.h)};q.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)|n.D(i);return new Ne(t,this.h|n.h)};q.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)^n.D(i);return new Ne(t,this.h^n.h)};function rv(n){for(var e=n.g.length+1,t=[],i=0;i<e;i++)t[i]=n.D(i)<<1|n.D(i-1)>>>31;return new Ne(t,n.h)}function Ta(n,e){var t=e>>5;e%=32;for(var i=n.g.length-t,r=[],s=0;s<i;s++)r[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Ne(r,n.h)}El.prototype.createWebChannel=El.prototype.g;Vn.prototype.send=Vn.prototype.u;Vn.prototype.open=Vn.prototype.m;Vn.prototype.close=Vn.prototype.close;Ll.NO_ERROR=0;Ll.TIMEOUT=8;Ll.HTTP_ERROR=6;Tv.COMPLETE="complete";Ev.EventType=Gc;Gc.OPEN="a";Gc.CLOSE="b";Gc.ERROR="c";Gc.MESSAGE="d";Pt.prototype.listen=Pt.prototype.O;mt.prototype.listenOnce=mt.prototype.P;mt.prototype.getLastError=mt.prototype.Sa;mt.prototype.getLastErrorCode=mt.prototype.Ia;mt.prototype.getStatus=mt.prototype.da;mt.prototype.getResponseJson=mt.prototype.Wa;mt.prototype.getResponseText=mt.prototype.ja;mt.prototype.send=mt.prototype.ha;mt.prototype.setWithCredentials=mt.prototype.Oa;gi.prototype.digest=gi.prototype.l;gi.prototype.reset=gi.prototype.reset;gi.prototype.update=gi.prototype.j;Ne.prototype.add=Ne.prototype.add;Ne.prototype.multiply=Ne.prototype.R;Ne.prototype.modulo=Ne.prototype.gb;Ne.prototype.compare=Ne.prototype.X;Ne.prototype.toNumber=Ne.prototype.ea;Ne.prototype.toString=Ne.prototype.toString;Ne.prototype.getBits=Ne.prototype.D;Ne.fromNumber=Ui;Ne.fromString=ay;var QX=vi.createWebChannelTransport=function(){return new El},XX=vi.getStatEventTarget=function(){return Rl()},ZX=vi.ErrorCode=Ll,JX=vi.EventType=Tv,eZ=vi.Event=co,tZ=vi.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},nZ=vi.FetchXmlHttpFactory=Kc,iZ=vi.WebChannel=Ev,rZ=vi.XhrIo=mt,cy=vi.Md5=gi,lo=vi.Integer=Ne;var Io=og(V_(),1),YS=og(i5(),1);var N_="@firebase/firestore",P_="4.6.0";var It=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};It.UNAUTHENTICATED=new It(null);It.GOOGLE_CREDENTIALS=new It("google-credentials-uid");It.FIRST_PARTY=new It("first-party-uid");It.MOCK_USER=new It("mock-user");var hB="10.11.0";var Q1=hB;function dB(n){Q1=n}function fB(n){return aB(n,{depth:100})}var Rs=new ml("@firebase/firestore");function T1(){return Rs.logLevel}function KS(n){Rs.setLogLevel(n)}function L(n,...e){if(Rs.logLevel<=Bi.DEBUG){let t=e.map(V9);Rs.debug(`Firestore (${Q1}): ${n}`,...t)}}function ht(n,...e){if(Rs.logLevel<=Bi.ERROR){let t=e.map(V9);Rs.error(`Firestore (${Q1}): ${n}`,...t)}}function ai(n,...e){if(Rs.logLevel<=Bi.WARN){let t=e.map(V9);Rs.warn(`Firestore (${Q1}): ${n}`,...t)}}function V9(n){if(typeof n=="string")return n;try{return fB(n)}catch{return n}}function j(n="Unexpected state"){let e=`FIRESTORE (${Q1}) INTERNAL ASSERTION FAILED: `+n;throw ht(e),new Error(e)}function J(n,e){n||j()}function QS(n,e){n||j()}function F(n,e){return n}var b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},O=class extends Ug{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var St=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var K8=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},V7=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(It.UNAUTHENTICATED))}shutdown(){}},N7=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},P7=class{constructor(e){this.authProvider=e,this.currentUser=It.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){let i=this.tokenCounter,r=c=>this.tokenCounter!==i?(i=this.tokenCounter,t(c)):Promise.resolve(),s=new St;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new St,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield r(this.currentUser)}))},a=c=>{L("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.tokenListener),o()};this.authProvider.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.authProvider.getImmediate({optional:!0});c?a(c):(L("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new St)}},0),o()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.tokenCounter!==e?(L("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(J(typeof i.accessToken=="string"),new K8(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.tokenListener)}getUser(){let e=this.auth&&this.auth.getUid();return J(e===null||typeof e=="string"),new It(e)}},H7=class{constructor(e,t,i){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=i,this.type="FirstParty",this.user=It.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},B7=class{constructor(e,t,i){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=i}getToken(){return Promise.resolve(new H7(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(It.FIRST_PARTY))}shutdown(){}invalidateToken(){}},F7=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},q7=class{constructor(e){this.appCheckProvider=e,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(e,t){let i=s=>{s.error!=null&&L("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,L("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{L("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?r(s):L("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(J(typeof t.token=="string"),this.latestAppCheckToken=t.token,new F7(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.tokenListener)}};function mB(n){if(!n)return new V7;switch(n.type){case"firstParty":return new B7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new O(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function pB(n){return uB(n)}var Q8=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="",r=20;for(;i.length<r;){let s=pB(40);for(let o=0;o<s.length;++o)i.length<r&&s[o]<t&&(i+=e.charAt(s[o]%e.length))}return i}};function ue(n,e){return n<e?-1:n>e?1:0}function Ao(n,e,t){return n.length!==e.length?!1:n.every((i,r)=>t(i,e[r]))}function XS(n){return n+"\0"}var H_=-62135596800,B_=1e6,dt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new O(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new O(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<H_)throw new O(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new O(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-t*1e3)*B_);return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return this.seconds*1e3+this.nanoseconds/B_}_compareTo(e){return this.seconds===e.seconds?ue(this.nanoseconds,e.nanoseconds):ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-H_,t=String(e).padStart(12,"0"),i=String(this.nanoseconds).padStart(9,"0");return t+"."+i}};var ne=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new dt(0,0))}static max(){return new n(new dt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return this.timestamp.seconds*1e6+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var F_="__name__",X8=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&j(),i===void 0?i=e.length-t:i>e.length-t&&j(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Te=class n extends X8{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new O(b.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},gB=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Et=class n extends X8{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return gB.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===F_}static keyField(){return new n([F_])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new O(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},o=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new O(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[r+1];if(!(c==="\\"||c==="."||c==="`"))throw new O(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else a==="`"?(o=!o,r++):a==="."&&!o?(s(),r++):(i+=a,r++)}if(s(),o)throw new O(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(Te.fromString(e))}static fromName(e){return new n(Te.fromString(e).popFirst(5))}static empty(){return new n(Te.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Te.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Te.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new n(new Te(e.slice()))}};var k1=-1,vB=0,U7=(()=>{class n{constructor(t,i,r,s){this.indexId=t,this.collectionGroup=i,this.fields=r,this.indexState=s}}return n.UNKNOWN_ID=-1,n})();function N9(n){return n.fields.find(e=>e.kind===2)}function Do(n){return n.fields.filter(e=>e.kind!==2)}function yB(n){let e=Do(n);return e.length===0?0:e[e.length-1].kind}function wB(n){return`id=${n.indexId}|cg=${n.collectionGroup}|f=${n.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}var I1=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var W4=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(vB,ci.min())}};function ZS(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=ne.fromTimestamp(i===1e9?new dt(t+1,0):new dt(t,i));return new ci(r,B.empty(),e)}function JS(n){return new ci(n.readTime,n.key,k1)}var ci=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(ne.min(),B.empty(),k1)}static max(){return new n(ne.max(),B.empty(),k1)}};function P9(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0||(t=B.comparator(n.documentKey,e.documentKey),t!==0)?t:ue(n.largestBatchId,e.largestBatchId)}var eT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Z8=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function js(n){return g(this,null,function*(){if(n.code===b.FAILED_PRECONDITION&&n.message===eT)L("LocalStore","Unexpectedly lost primary lease");else throw n})}var y=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&j(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},c=>i(c))}),o=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(u=>{o[l]=u,++a,a===s&&i(o)},u=>r(u))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};var Bn="SimpleDb",bB=3,J8=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.completionDeferred=new St,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{t.error?this.completionDeferred.reject(new Oo(e,t.error)):this.completionDeferred.resolve()},this.transaction.onerror=i=>{let r=H9(i.target.error);this.completionDeferred.reject(new Oo(e,r))}}static open(e,t,i,r){try{return new n(t,e.transaction(r,i))}catch(s){throw new Oo(t,s)}}get completionPromise(){return this.completionDeferred.promise}abort(e){e&&this.completionDeferred.reject(e),this.aborted||(L(Bn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let e=this.transaction;!this.aborted&&typeof e.commit=="function"&&e.commit()}store(e){let t=this.transaction.objectStore(e);return new W7(t)}},kr=class n{constructor(e,t,i){this.name=e,this.version=t,this.schemaConverter=i,n.getIOSVersion(xc())===12.2&&ht("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return L(Bn,"Removing database:",e),_o(window.indexedDB.deleteDatabase(e)).toPromise()}static isAvailable(){if(!fl())return!1;if(n.isMockPersistence())return!0;let e=xc(),t=n.getIOSVersion(e),i=0<t&&t<10,r=n.getAndroidVersion(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static isMockPersistence(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.USE_MOCK_PERSISTENCE)==="YES"}static getStore(e,t){return e.store(t)}static getIOSVersion(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static getAndroidVersion(e){let t=e.match(/Android ([\d.]+)/i),i=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(i)}ensureDb(e){return g(this,null,function*(){return this.db||(L(Bn,"Opening database:",this.name),this.db=yield new Promise((t,i)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{let o=s.target.result;t(o)},r.onblocked=()=>{i(new Oo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{let o=s.target.error;o.name==="VersionError"?i(new O(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new O(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new Oo(e,o))},r.onupgradeneeded=s=>{L(Bn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.schemaConverter.createOrUpgrade(o,r.transaction,s.oldVersion,this.version).next(()=>{L(Bn,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=t=>this.versionchangelistener(t)),this.db})}setVersionChangeListener(e){this.versionchangelistener=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.ensureDb(e);let a=J8.open(this.db,e,s?"readonly":"readwrite",i),c=r(a).next(l=>(a.maybeCommit(),l)).catch(l=>(a.abort(l),y.reject(l))).toPromise();return c.catch(()=>{}),yield a.completionPromise,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<bB;if(L(Bn,"Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},j7=class{constructor(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(e){this.dbCursor=e}done(){this.shouldStop=!0}skip(e){this.nextKey=e}delete(){return _o(this.dbCursor.delete())}},Oo=class extends O{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Ws(n){return n.name==="IndexedDbTransactionError"}var W7=class{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(L(Bn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(L(Bn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),_o(i)}add(e){L(Bn,"ADD",this.store.name,e,e);let t=this.store.add(e);return _o(t)}get(e){let t=this.store.get(e);return _o(t).next(i=>(i===void 0&&(i=null),L(Bn,"GET",this.store.name,e,i),i))}delete(e){L(Bn,"DELETE",this.store.name,e);let t=this.store.delete(e);return _o(t)}count(){L(Bn,"COUNT",this.store.name);let e=this.store.count();return _o(e)}loadAll(e,t){let i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){let s=r.getAll(i.range);return new y((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}else{let s=this.cursor(i),o=[];return this.iterateCursor(s,(a,c)=>{o.push(c)}).next(()=>o)}}loadFirst(e,t){let i=this.store.getAll(e,t===null?void 0:t);return new y((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}deleteAll(e,t){L(Bn,"DELETE ALL",this.store.name);let i=this.options(e,t);i.keysOnly=!1;let r=this.cursor(i);return this.iterateCursor(r,(s,o,a)=>a.delete())}iterate(e,t){let i;t?i=e:(i={},t=e);let r=this.cursor(i);return this.iterateCursor(r,t)}iterateSerial(e){let t=this.cursor({});return new y((i,r)=>{t.onerror=s=>{let o=H9(s.target.error);r(o)},t.onsuccess=s=>{let o=s.target.result;if(!o){i();return}e(o.primaryKey,o.value).next(a=>{a?o.continue():i()})}})}iterateCursor(e,t){let i=[];return new y((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a){r();return}let c=new j7(a),l=t(a.primaryKey,a.value,c);if(l instanceof y){let u=l.catch(h=>(c.done(),y.reject(h)));i.push(u)}c.isDone?r():c.skipToKey===null?a.continue():a.continue(c.skipToKey)}}).next(()=>y.waitFor(i))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let i=this.store.index(e.index);return e.keysOnly?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}else return this.store.openCursor(e.range,t)}};function _o(n){return new y((e,t)=>{n.onsuccess=i=>{let r=i.target.result;e(r)},n.onerror=i=>{let r=H9(i.target.error);t(r)}})}var q_=!1;function H9(n){let e=kr.getIOSVersion(xc());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let i=new O("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return q_||(q_=!0,setTimeout(()=>{throw i},0)),i}}return n}var H4="IndexBackfiller",CB=15*1e3,_B=60*1e3,SB=50,G7=class{constructor(e,t){this.asyncQueue=e,this.backfiller=t,this.task=null}start(){this.schedule(CB)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}schedule(e){L(H4,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{let t=yield this.backfiller.backfill();L(H4,`Documents written: ${t}`)}catch(t){Ws(t)?L(H4,"Ignoring IndexedDB error during index backfill: ",t):yield js(t)}yield this.schedule(_B)}))}},$7=class{constructor(e,t){this.localStore=e,this.persistence=t}backfill(){return g(this,arguments,function*(e=SB){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.writeIndexEntries(t,e))})}writeIndexEntries(e,t){let i=new Set,r=t,s=!0;return y.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o===null||i.has(o))s=!1;else return L(H4,`Processing collection: ${o}`),this.writeEntriesForCollectionGroup(e,o,r).next(a=>{r-=a,i.add(o)})})).next(()=>t-r)}writeEntriesForCollectionGroup(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.getNewOffset(r,s)).next(a=>(L(H4,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}getNewOffset(e,t){let i=e;return t.changes.forEach((r,s)=>{let o=JS(s);P9(o,i)>0&&(i=o)}),new ci(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Fn=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.setPreviousValue(r),this.writeNewSequenceNumber=r=>i.writeSequenceNumber(r))}setPreviousValue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t}}n.INVALID=-1;return n})(),A1="",Y7="",tT="",nT="";function gn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=U_(e)),e=TB(n.get(t),e);return U_(e)}function TB(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let s=n.charAt(r);switch(s){case"\0":t+=A1+tT;break;case A1:t+=A1+nT;break;default:t+=s}}return t}function U_(n){return n+A1+Y7}function ar(n){let e=n.length;if(J(e>=2),e===2)return J(n.charAt(0)===A1&&n.charAt(1)===Y7),Te.emptyPath();let t=e-2,i=[],r="";for(let s=0;s<e;){let o=n.indexOf(A1,s);switch((o<0||o>t)&&j(),n.charAt(o+1)){case Y7:let c=n.substring(s,o),l;r.length===0?l=c:(r+=c,l=r,r=""),i.push(l);break;case tT:r+=n.substring(s,o),r+="\0";break;case nT:r+=n.substring(s,o+1);break;default:j()}s=o+2}return new Te(i)}var So="remoteDocuments";var g2="owner",v1="owner",v2="mutationQueues",EB="userId",Mi="mutations",iT="batchId",zo="userMutationsIndex",rT=["userId","batchId"];function MB(n){return[n]}function U8(n,e){return[n,gn(e)]}function sT(n,e,t){return[n,gn(e),t]}var zB={},X1="documentMutations",F6="remoteDocumentsV14",xB=["prefixPath","collectionGroup","readTime","documentId"],j8="documentKeyIndex",OB=["prefixPath","collectionGroup","documentId"],oT="collectionGroupIndex",IB=["collectionGroup","readTime","prefixPath","documentId"],y2="remoteDocumentGlobal",K7="remoteDocumentGlobalKey",Z1="targets",AB="targetId",aT="queryTargetsIndex",DB=["canonicalId","targetId"],J1="targetDocuments",kB=["targetId","path"],B9="documentTargetsIndex",RB=["path","targetId"],e6="targetGlobalKey",Wo="targetGlobal",G4="collectionParents",LB=["collectionId","parent"],R1="clientMetadata",VB="clientId",q6="bundles",NB="bundleId",U6="namedQueries",PB="name",F9="indexConfiguration",HB="indexId",Q7="collectionGroupIndex",BB="collectionGroup",j6="indexState",FB=["indexId","uid"],cT="sequenceNumberIndex",qB=["uid","sequenceNumber"],W6="indexEntries",UB=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],lT="documentKeyIndex",jB=["indexId","uid","orderedDocumentKey"],G6="documentOverlays",WB=["userId","collectionPath","documentId"],X7="collectionPathOverlayIndex",GB=["userId","collectionPath","largestBatchId"],uT="collectionGroupOverlayIndex",$B=["userId","collectionGroup","largestBatchId"],YB=[v2,Mi,X1,So,Z1,g2,Wo,J1],KB=YB,QB=[...KB,R1],XB=[...QB,y2],ZB=[...XB,G4],hT=[...ZB,q6,U6],JB=[...hT,G6],dT=[v2,Mi,X1,F6,Z1,g2,Wo,J1,R1,y2,G4,q6,U6,G6],fT=dT,mT=[...fT,F9,j6,W6],eF=mT;function tF(n){if(n===16)return eF;if(n===15)return mT;if(n===14)return fT;if(n===13)return dT;if(n===12)return JB;if(n===11)return hT;j()}var $4=class extends Z8{constructor(e,t){super(),this.simpleDbTransaction=e,this.currentSequenceNumber=t}};function Wt(n,e){let t=F(n);return kr.getStore(t.simpleDbTransaction,e)}function j_(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Go(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function pT(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var nt=class n{constructor(e,t){this.comparator=e,this.root=t||B4.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,B4.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,B4.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new x1(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new x1(this.root,e,this.comparator,!1)}getReverseIterator(){return new x1(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new x1(this.root,e,this.comparator,!0)}},x1=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},B4=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,i,r,s,o){return new n(t??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this,o=r(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let t=this;return!t.left.isRed()&&!t.left.left.isRed()&&(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,i){let r,s=this;if(i(t,s.key)<0)!s.left.isEmpty()&&!s.left.isRed()&&!s.left.left.isRed()&&(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,i),null);else{if(s.left.isRed()&&(s=s.rotateRight()),!s.right.isEmpty()&&!s.right.isRed()&&!s.right.left.isRed()&&(s=s.moveRedRight()),i(t,s.key)===0){if(s.right.isEmpty())return n.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,i))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw j();let t=this.left.check();if(t!==this.right.check())throw j();return t+(this.isRed()?0:1)}}return n.EMPTY=null,n.RED=!0,n.BLACK=!1,n})(),Z7=class{constructor(){this.size=0}get key(){throw j()}get value(){throw j()}get color(){throw j()}get left(){throw j()}get right(){throw j()}copy(e,t,i,r,s){return this}insert(e,t,i){return new B4(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};B4.EMPTY=new Z7;var We=class n{constructor(e){this.comparator=e,this.data=new nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(t!==void 0?i=this.data.getIteratorFrom(t):i=this.data.getIterator();i.hasNext();){let r=i.getNext();if(!e(r.key))return}}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new t6(this.data.getIterator())}getIteratorFrom(e){return new t6(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},t6=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function nF(n,e,t,i,r){let s=n.getIterator(),o=e.getIterator(),a=y1(s),c=y1(o);for(;a||c;){let l=!1,u=!1;if(a&&c){let h=t(a,c);h<0?u=!0:h>0&&(l=!0)}else a!=null?u=!0:l=!0;l?(i(c),c=y1(o)):u?(r(a),a=y1(s)):(a=y1(s),c=y1(o))}}function y1(n){return n.hasNext()?n.getNext():void 0}var qn=class n{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new n([])}unionWith(e){let t=new We(Et.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ao(this.fields,e.fields,(t,i)=>t.isEqual(i))}};function iF(n){return Buffer.from(n,"base64").toString("binary")}function rF(n){return Buffer.from(n,"binary").toString("base64")}function gT(){return!0}var jt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=iF(e);return new n(t)}static fromUint8Array(e){let t=sF(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return rF(this.binaryString)}toUint8Array(){return oF(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};jt.EMPTY_BYTE_STRING=new jt("");function sF(n){let e="";for(let t=0;t<n.length;++t)e+=String.fromCharCode(n[t]);return e}function oF(n){let e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}var aF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Rr(n){if(J(!!n),typeof n=="string"){let e=0,t=aF.exec(n);if(J(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}else{let e=vt(n.seconds),t=vt(n.nanos);return{seconds:e,nanos:t}}}function vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ls(n){return typeof n=="string"?jt.fromBase64String(n):jt.fromUint8Array(n)}var vT="server_timestamp",yT="__type__",wT="__previous_value__",bT="__local_write_time__";function $6(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[yT])===null||t===void 0?void 0:t.stringValue)===vT}function cF(n,e){let t={fields:{[yT]:{stringValue:vT},[bT]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return e&&$6(e)&&(e=q9(e)),e&&(t.fields[wT]=e),{mapValue:t}}function q9(n){let e=n.mapValue.fields[wT];return $6(e)?q9(e):e}function Y4(n){let e=Rr(n.mapValue.fields[bT].timestampValue);return new dt(e.seconds,e.nanos)}var J7=class{constructor(e,t,i,r,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},W_="(default)",Vs=class n{constructor(e,t){this.projectId=e,this.database=t||W_}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===W_}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function lF(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new O(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vs(n.options.projectId,e)}var ks=-1;function w2(n){return n==null}function K4(n){return n===0&&1/n===-1/0}function CT(n){return typeof n=="number"&&Number.isInteger(n)&&!K4(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var _T="__max__",As={mapValue:{fields:{__type__:{stringValue:_T}}}},W8={nullValue:"NULL_VALUE"};function ko(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?$6(n)?4:ST(n)?9007199254740991:10:j()}function zi(n,e){if(n===e)return!0;let t=ko(n),i=ko(e);if(t!==i)return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Y4(n).isEqual(Y4(e));case 3:return uF(n,e);case 5:return n.stringValue===e.stringValue;case 6:return dF(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return hF(n,e);case 2:return fF(n,e);case 9:return Ao(n.arrayValue.values||[],e.arrayValue.values||[],zi);case 10:return mF(n,e);case 9007199254740991:return!0;default:return j()}}function uF(n,e){if(typeof n.timestampValue=="string"&&typeof e.timestampValue=="string"&&n.timestampValue.length===e.timestampValue.length)return n.timestampValue===e.timestampValue;let t=Rr(n.timestampValue),i=Rr(e.timestampValue);return t.seconds===i.seconds&&t.nanos===i.nanos}function hF(n,e){return vt(n.geoPointValue.latitude)===vt(e.geoPointValue.latitude)&&vt(n.geoPointValue.longitude)===vt(e.geoPointValue.longitude)}function dF(n,e){return Ls(n.bytesValue).isEqual(Ls(e.bytesValue))}function fF(n,e){if("integerValue"in n&&"integerValue"in e)return vt(n.integerValue)===vt(e.integerValue);if("doubleValue"in n&&"doubleValue"in e){let t=vt(n.doubleValue),i=vt(e.doubleValue);return t===i?K4(t)===K4(i):isNaN(t)&&isNaN(i)}return!1}function mF(n,e){let t=n.mapValue.fields||{},i=e.mapValue.fields||{};if(j_(t)!==j_(i))return!1;for(let r in t)if(t.hasOwnProperty(r)&&(i[r]===void 0||!zi(t[r],i[r])))return!1;return!0}function Q4(n,e){return(n.values||[]).find(t=>zi(t,e))!==void 0}function Ns(n,e){if(n===e)return 0;let t=ko(n),i=ko(e);if(t!==i)return ue(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ue(n.booleanValue,e.booleanValue);case 2:return pF(n,e);case 3:return G_(n.timestampValue,e.timestampValue);case 4:return G_(Y4(n),Y4(e));case 5:return ue(n.stringValue,e.stringValue);case 6:return yF(n.bytesValue,e.bytesValue);case 7:return gF(n.referenceValue,e.referenceValue);case 8:return vF(n.geoPointValue,e.geoPointValue);case 9:return wF(n.arrayValue,e.arrayValue);case 10:return bF(n.mapValue,e.mapValue);default:throw j()}}function pF(n,e){let t=vt(n.integerValue||n.doubleValue),i=vt(e.integerValue||e.doubleValue);return t<i?-1:t>i?1:t===i?0:isNaN(t)?isNaN(i)?0:-1:1}function G_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ue(n,e);let t=Rr(n),i=Rr(e),r=ue(t.seconds,i.seconds);return r!==0?r:ue(t.nanos,i.nanos)}function gF(n,e){let t=n.split("/"),i=e.split("/");for(let r=0;r<t.length&&r<i.length;r++){let s=ue(t[r],i[r]);if(s!==0)return s}return ue(t.length,i.length)}function vF(n,e){let t=ue(vt(n.latitude),vt(e.latitude));return t!==0?t:ue(vt(n.longitude),vt(e.longitude))}function yF(n,e){let t=Ls(n),i=Ls(e);return t.compareTo(i)}function wF(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let s=Ns(t[r],i[r]);if(s)return s}return ue(t.length,i.length)}function bF(n,e){if(n===As.mapValue&&e===As.mapValue)return 0;if(n===As.mapValue)return 1;if(e===As.mapValue)return-1;let t=n.fields||{},i=Object.keys(t),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let o=0;o<i.length&&o<s.length;++o){let a=ue(i[o],s[o]);if(a!==0)return a;let c=Ns(t[i[o]],r[s[o]]);if(c!==0)return c}return ue(i.length,s.length)}function L1(n){return U9(n)}function U9(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?_F(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?CF(n.bytesValue):"referenceValue"in n?TF(n.referenceValue):"geoPointValue"in n?SF(n.geoPointValue):"arrayValue"in n?MF(n.arrayValue):"mapValue"in n?EF(n.mapValue):j()}function CF(n){return Ls(n).toBase64()}function _F(n){let e=Rr(n);return`time(${e.seconds},${e.nanos})`}function SF(n){return`geo(${n.latitude},${n.longitude})`}function TF(n){return B.fromName(n).toString()}function EF(n){let e=Object.keys(n.fields||{}).sort(),t="{",i=!0;for(let r of e)i?i=!1:t+=",",t+=`${r}:${U9(n.fields[r])}`;return t+"}"}function MF(n){let e="[",t=!0;for(let i of n.values||[])t?t=!1:e+=",",e+=U9(i);return e+"]"}function Ro(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ef(n){return!!n&&"integerValue"in n}function zF(n){return!!n&&"doubleValue"in n}function xF(n){return ef(n)||zF(n)}function X4(n){return!!n&&"arrayValue"in n}function $_(n){return!!n&&"nullValue"in n}function Y_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function G8(n){return!!n&&"mapValue"in n}function F4(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Go(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=F4(i)),e}else if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=F4(n.arrayValue.values[t]);return e}else return Object.assign({},n)}function ST(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===_T}function OF(n){return"nullValue"in n?W8:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ro(Vs.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:j()}function IF(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ro(Vs.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?As:j()}function K_(n,e){let t=Ns(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Q_(n,e){let t=Ns(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var on=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!G8(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){let i=this.getFieldsMap(e.popLast());i[e.lastSegment()]=F4(t)}setAll(e){let t=Et.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=F4(o):r.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());G8(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];(!G8(r)||!r.mapValue.fields)&&(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Go(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n(F4(this.value))}};function TT(n){let e=[];return Go(n.fields,(t,i)=>{let r=new Et([t]);if(G8(i)){let o=TT(i.mapValue).fields;if(o.length===0)e.push(r);else for(let a of o)e.push(r.child(a))}else e.push(r)}),new qn(e)}var Ot=class n{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ne.min(),ne.min(),ne.min(),on.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,ne.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,ne.min(),ne.min(),on.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ne.min(),ne.min(),on.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(ne.min())&&(this.documentType===2||this.documentType===0)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};function AF(n,e,t){let i=e.data.field(n),r=t.data.field(n);return i!==null&&r!==null?Ns(i,r):j()}var hr=class{constructor(e,t){this.position=e,this.inclusive=t}};function ET(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],o=n.position[r];if(s.field.isKeyField())i=B.comparator(B.fromName(o.referenceValue),t.key);else{let a=t.data.field(s.field);i=Ns(o,a)}if(s.dir==="desc"&&(i=i*-1),i!==0)break}return i}function DF(n,e,t){let i=ET(n,e,t);return n.inclusive?i>=0:i>0}function kF(n,e,t){let i=ET(n,e,t);return n.inclusive?i<=0:i<0}function X_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++){let i=n.position[t],r=e.position[t];if(!zi(i,r))return!1}return!0}var Lo=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function RF(n){return n.field.canonicalString()+n.dir}function LF(n){return`${n.field.canonicalString()} (${n.dir})`}function VF(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var n6=class{},ge=class n extends n6{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new rf(e,t,i):t==="array-contains"?new af(e,i):t==="in"?new i6(e,i):t==="not-in"?new cf(e,i):t==="array-contains-any"?new lf(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new sf(e,i):new of(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ns(t,this.value)):t!==null&&ko(this.value)===ko(t)&&this.matchesComparison(Ns(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return j()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Pe=class n extends n6{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new n(e,t)}matches(e){return V1(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.memoizedFlattenedFilters!==null?this.memoizedFlattenedFilters:(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[]),this.memoizedFlattenedFilters)}getFilters(){return Object.assign([],this.filters)}};function V1(n){return n.op==="and"}function tf(n){return n.op==="or"}function j9(n){return MT(n)&&V1(n)}function MT(n){for(let e of n.filters)if(e instanceof Pe)return!1;return!0}function nf(n){if(n instanceof ge)return n.field.canonicalString()+n.op.toString()+L1(n.value);if(j9(n))return n.filters.map(e=>nf(e)).join(",");{let e=n.filters.map(t=>nf(t)).join(",");return`${n.op}(${e})`}}function zT(n,e){if(n instanceof ge)return NF(n,e);if(n instanceof Pe)return PF(n,e);j()}function NF(n,e){return e instanceof ge&&n.op===e.op&&n.field.isEqual(e.field)&&zi(n.value,e.value)}function PF(n,e){return e instanceof Pe&&n.op===e.op&&n.filters.length===e.filters.length?n.filters.reduce((i,r,s)=>i&&zT(r,e.filters[s]),!0):!1}function xT(n,e){let t=n.filters.concat(e);return Pe.create(t,n.op)}function OT(n){return n instanceof ge?BF(n):n instanceof Pe?HF(n):"Filter"}function HF(n){return n.op.toString()+" {"+n.getFilters().map(OT).join(" ,")+"}"}function BF(n){return`${n.field.canonicalString()} ${n.op} ${L1(n.value)}`}var rf=class extends ge{constructor(e,t,i){super(e,t,i),this.key=B.fromName(i.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},sf=class extends ge{constructor(e,t){super(e,"in",t),this.keys=IT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},of=class extends ge{constructor(e,t){super(e,"not-in",t),this.keys=IT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function IT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>B.fromName(i.referenceValue))}var af=class extends ge{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return X4(t)&&Q4(t.arrayValue,this.value)}},i6=class extends ge{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Q4(this.value.arrayValue,t)}},cf=class extends ge{constructor(e,t){super(e,"not-in",t)}matches(e){if(Q4(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Q4(this.value.arrayValue,t)}},lf=class extends ge{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!X4(t)||!t.arrayValue.values?!1:t.arrayValue.values.some(i=>Q4(this.value.arrayValue,i))}};var uf=class{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}};function hf(n,e=null,t=[],i=[],r=null,s=null,o=null){return new uf(n,e,t,i,r,s,o)}function Vo(n){let e=F(n);if(e.memoizedCanonicalId===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>nf(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>RF(i)).join(","),w2(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>L1(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>L1(i)).join(",")),e.memoizedCanonicalId=t}return e.memoizedCanonicalId}function FF(n){let e=n.path.canonicalString();return n.collectionGroup!==null&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>OT(t)).join(", ")}]`),w2(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>LF(t)).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>L1(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>L1(t)).join(",")),`Target(${e})`}function b2(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!VF(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!zT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup!==e.collectionGroup||!n.path.isEqual(e.path)||!X_(n.startAt,e.startAt)?!1:X_(n.endAt,e.endAt)}function r6(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Y6(n,e){return n.filters.filter(t=>t instanceof ge&&t.field.isEqual(e))}function qF(n,e){let t=N9(e);if(t===void 0)return null;for(let i of Y6(n,t.fieldPath))switch(i.op){case"array-contains-any":return i.value.arrayValue.values||[];case"array-contains":return[i.value]}return null}function UF(n,e){let t=new Map;for(let i of Do(e))for(let r of Y6(n,i.fieldPath))switch(r.op){case"==":case"in":t.set(i.fieldPath.canonicalString(),r.value);break;case"not-in":case"!=":return t.set(i.fieldPath.canonicalString(),r.value),Array.from(t.values())}return null}function jF(n,e){let t=[],i=!0;for(let r of Do(e)){let s=r.kind===0?AT(n,r.fieldPath,n.startAt):DT(n,r.fieldPath,n.startAt);t.push(s.value),i&&(i=s.inclusive)}return new hr(t,i)}function WF(n,e){let t=[],i=!0;for(let r of Do(e)){let s=r.kind===0?DT(n,r.fieldPath,n.endAt):AT(n,r.fieldPath,n.endAt);t.push(s.value),i&&(i=s.inclusive)}return new hr(t,i)}function AT(n,e,t){let i=W8,r=!0;for(let s of Y6(n,e)){let o=W8,a=!0;switch(s.op){case"<":case"<=":o=OF(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=W8;break}K_({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let a=t.position[s];K_({value:i,inclusive:r},{value:a,inclusive:t.inclusive})<0&&(i=a,r=t.inclusive);break}}return{value:i,inclusive:r}}function DT(n,e,t){let i=As,r=!0;for(let s of Y6(n,e)){let o=As,a=!0;switch(s.op){case">=":case">":o=IF(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=As;break}Q_({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let a=t.position[s];Q_({value:i,inclusive:r},{value:a,inclusive:t.inclusive})>0&&(i=a,r=t.inclusive);break}}return{value:i,inclusive:r}}function GF(n){let e=new We(Et.comparator),t=!1;for(let i of n.filters)for(let r of i.getFlattenedFilters())r.field.isKeyField()||(r.op==="array-contains"||r.op==="array-contains-any"?t=!0:e=e.add(r.field));for(let i of n.orderBy)i.field.isKeyField()||(e=e.add(i.field));return e.size+(t?1:0)}function $F(n){return n.limit!==null}var xi=class{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}};function kT(n,e,t,i,r,s,o,a){return new xi(n,e,t,i,r,s,o,a)}function ec(n){return new xi(n)}function YF(n,e){return new xi(e,null,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Z_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function KF(n){let e=new We(Et.comparator);return n.filters.forEach(t=>{t.getFlattenedFilters().forEach(r=>{r.isInequality()&&(e=e.add(r.field))})}),e}function QF(n){return new xi(Te.emptyPath(),n)}function XF(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function W9(n){return n.collectionGroup!==null}function N1(n){let e=F(n);if(e.memoizedNormalizedOrderBy===null){e.memoizedNormalizedOrderBy=[];let t=new Set;for(let s of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";KF(e).forEach(s=>{!t.has(s.canonicalString())&&!s.isKeyField()&&e.memoizedNormalizedOrderBy.push(new Lo(s,i))}),t.has(Et.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new Lo(Et.keyField(),i))}return e.memoizedNormalizedOrderBy}function vn(n){let e=F(n);return e.memoizedTarget||(e.memoizedTarget=ZF(e,N1(n))),e.memoizedTarget}function ZF(n,e){if(n.limitType==="F")return hf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new Lo(r.field,s)});let t=n.endAt?new hr(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new hr(n.startAt.position,n.startAt.inclusive):null;return hf(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function G9(n,e){let t=n.filters.concat([e]);return new xi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function JF(n,e){let t=n.explicitOrderBy.concat([e]);return new xi(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function s6(n,e,t){return new xi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function eq(n,e){return new xi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function tq(n,e){return new xi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function C2(n,e){return b2(vn(n),vn(e))&&n.limitType===e.limitType}function RT(n){return`${Vo(vn(n))}|lt:${n.limitType}`}function E1(n){return`Query(target=${FF(vn(n))}; limitType=${n.limitType})`}function _2(n,e){return e.isFoundDocument()&&nq(n,e)&&iq(n,e)&&rq(n,e)&&sq(n,e)}function nq(n,e){let t=e.key.path;return n.collectionGroup!==null?e.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(t):B.isDocumentKey(n.path)?n.path.isEqual(t):n.path.isImmediateParentOf(t)}function iq(n,e){for(let t of N1(n))if(!t.field.isKeyField()&&e.data.field(t.field)===null)return!1;return!0}function rq(n,e){for(let t of n.filters)if(!t.matches(e))return!1;return!0}function sq(n,e){return!(n.startAt&&!kF(n.startAt,N1(n),e)||n.endAt&&!DF(n.endAt,N1(n),e))}function LT(n){return n.collectionGroup||(n.path.length%2===1?n.path.lastSegment():n.path.get(n.path.length-2))}function VT(n){return(e,t)=>{let i=!1;for(let r of N1(n)){let s=oq(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function oq(n,e,t){let i=n.field.isKeyField()?B.comparator(e.key,t.key):AF(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return j()}}var dr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0){this.inner[i]=[[e,t]],this.innerSize++;return}for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e)){r[s]=[e,t];return}r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Go(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return pT(this.inner)}size(){return this.innerSize}};var aq=new nt(B.comparator);function xn(){return aq}var NT=new nt(B.comparator);function N4(...n){let e=NT;for(let t of n)e=e.insert(t.key,t);return e}function cq(){return Z4()}function PT(n){let e=NT;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function cr(){return Z4()}function HT(){return Z4()}function Z4(){return new dr(n=>n.toString(),(n,e)=>n.isEqual(e))}var lq=new nt(B.comparator);function uq(){return lq}var hq=new We(B.comparator);function he(...n){let e=hq;for(let t of n)e=e.add(t);return e}var dq=new We(ue);function $9(){return dq}function BT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:K4(e)?"-0":e}}function FT(n){return{integerValue:""+n}}function qT(n,e){return CT(e)?FT(e):BT(n,e)}var P1=class{constructor(){this._=void 0}};function fq(n,e,t){return n instanceof Ps?cF(t,e):n instanceof Lr?jT(n,e):n instanceof Vr?WT(n,e):gq(n,e)}function mq(n,e,t){return n instanceof Lr?jT(n,e):n instanceof Vr?WT(n,e):t}function UT(n,e){return n instanceof Hs?xF(e)?e:{integerValue:0}:null}function pq(n,e){return n instanceof Lr&&e instanceof Lr||n instanceof Vr&&e instanceof Vr?Ao(n.elements,e.elements,zi):n instanceof Hs&&e instanceof Hs?zi(n.operand,e.operand):n instanceof Ps&&e instanceof Ps}var Ps=class extends P1{},Lr=class extends P1{constructor(e){super(),this.elements=e}};function jT(n,e){let t=GT(e);for(let i of n.elements)t.some(r=>zi(r,i))||t.push(i);return{arrayValue:{values:t}}}var Vr=class extends P1{constructor(e){super(),this.elements=e}};function WT(n,e){let t=GT(e);for(let i of n.elements)t=t.filter(r=>!zi(r,i));return{arrayValue:{values:t}}}var Hs=class extends P1{constructor(e,t){super(),this.serializer=e,this.operand=t}};function gq(n,e){let t=UT(n,e),i=J_(t)+J_(n.operand);return ef(t)&&ef(n.operand)?FT(i):BT(n.serializer,i)}function J_(n){return vt(n.integerValue||n.doubleValue)}function GT(n){return X4(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var No=class{constructor(e,t){this.field=e,this.transform=t}};function vq(n,e){return n.field.isEqual(e.field)&&pq(n.transform,e.transform)}function yq(n,e){return n===void 0&&e===void 0?!0:n&&e?Ao(n,e,(t,i)=>vq(t,i)):!1}var df=class{constructor(e,t){this.version=e,this.transformResults=t}},gt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function K6(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists!==void 0?n.exists===e.isFoundDocument():!0}var H1=class{};function $T(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Fs(n.key,gt.none()):new Bs(n.key,n.data,gt.none());{let t=n.data,i=on.empty(),r=new We(Et.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Oi(n.key,i,new qn(r.toArray()),gt.none())}}function wq(n,e,t){n instanceof Bs?Cq(n,e,t):n instanceof Oi?Sq(n,e,t):Eq(n,e,t)}function q4(n,e,t,i){return n instanceof Bs?_q(n,e,t,i):n instanceof Oi?Tq(n,e,t,i):Mq(n,e,t)}function bq(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=UT(i.transform,r||null);s!=null&&(t===null&&(t=on.empty()),t.set(i.field,s))}return t||null}function eS(n,e){return n.type!==e.type||!n.key.isEqual(e.key)||!n.precondition.isEqual(e.precondition)||!yq(n.fieldTransforms,e.fieldTransforms)?!1:n.type===0?n.value.isEqual(e.value):n.type===1?n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask):!0}var Bs=class extends H1{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}};function Cq(n,e,t){let i=n.value.clone(),r=KT(n.fieldTransforms,e,t.transformResults);i.setAll(r),e.convertToFoundDocument(t.version,i).setHasCommittedMutations()}function _q(n,e,t,i){if(!K6(n.precondition,e))return t;let r=n.value.clone(),s=QT(n.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}var Oi=class extends H1{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Sq(n,e,t){if(!K6(n.precondition,e)){e.convertToUnknownDocument(t.version);return}let i=KT(n.fieldTransforms,e,t.transformResults),r=e.data;r.setAll(YT(n)),r.setAll(i),e.convertToFoundDocument(t.version,r).setHasCommittedMutations()}function Tq(n,e,t,i){if(!K6(n.precondition,e))return t;let r=QT(n.fieldTransforms,i,e),s=e.data;return s.setAll(YT(n)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),t===null?null:t.unionWith(n.fieldMask.fields).unionWith(n.fieldTransforms.map(o=>o.field))}function YT(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function KT(n,e,t){let i=new Map;J(n.length===t.length);for(let r=0;r<t.length;r++){let s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,mq(o,a,t[r]))}return i}function QT(n,e,t){let i=new Map;for(let r of n){let s=r.transform,o=t.data.field(r.field);i.set(r.field,fq(s,o,e))}return i}var Fs=class extends H1{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};function Eq(n,e,t){e.convertToNoDocument(t.version).setHasCommittedMutations()}function Mq(n,e,t){return K6(n.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):t}var J4=class extends H1{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var e2=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];if(s.key.isEqual(e.key)){let o=i[r];wq(s,e,o)}}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=q4(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=q4(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=HT();return this.mutations.forEach(r=>{let s=e.get(r.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;let c=$T(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(ne.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),he())}isEqual(e){return this.batchId===e.batchId&&Ao(this.mutations,e.mutations,(t,i)=>eS(t,i))&&Ao(this.baseMutations,e.baseMutations,(t,i)=>eS(t,i))}},ff=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){J(e.mutations.length===i.length);let r=uq(),s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new n(e,t,i,r)}};var t2=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var mf=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ut=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n}(Ut||{});function XT(n){switch(n){case b.OK:return j();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0;default:return j()}}function zq(n){return XT(n)&&n!==b.ABORTED}function $8(n){if(n===void 0)return ht("GRPC error has no .code"),b.UNKNOWN;switch(n){case Ut.OK:return b.OK;case Ut.CANCELLED:return b.CANCELLED;case Ut.UNKNOWN:return b.UNKNOWN;case Ut.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Ut.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Ut.INTERNAL:return b.INTERNAL;case Ut.UNAVAILABLE:return b.UNAVAILABLE;case Ut.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Ut.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Ut.NOT_FOUND:return b.NOT_FOUND;case Ut.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Ut.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Ut.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Ut.ABORTED:return b.ABORTED;case Ut.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Ut.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Ut.DATA_LOSS:return b.DATA_LOSS;default:return j()}}var pf=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var z7=null;function ZT(){return new cB}function xq(){return new lB("utf-8")}var Oq=new lo([4294967295,4294967295],0);function tS(n){let e=ZT().encode(n),t=new cy;return t.update(e),new Uint8Array(t.digest())}function nS(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0),o=new lo([t,i],0),a=new lo([r,s],0);return[o,a]}var gf=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new xo(`Invalid padding: ${t}`);if(i<0)throw new xo(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new xo(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new xo(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=e.length*8-t,this.bitCountInInteger=lo.fromNumber(this.bitCount)}getBitIndex(e,t,i){let r=e.add(t.multiply(lo.fromNumber(i)));return r.compare(Oq)===1&&(r=new lo([r.getBits(0),r.getBits(1)],0)),r.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){let t=this.bitmap[Math.floor(e/8)],i=e%8;return(t&1<<i)!==0}mightContain(e){if(this.bitCount===0)return!1;let t=tS(e),[i,r]=nS(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(i,r,s);if(!this.isBitSet(o))return!1}return!0}static create(e,t,i){let r=e%8===0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,r,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.bitCount===0)return;let t=tS(e),[i,r]=nS(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(i,r,s);this.setBit(o)}}setBit(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},xo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var n2=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,i2.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(ne.min(),r,new nt(ue),xn(),he())}},i2=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,he(),he(),he())}};var D1=class{constructor(e,t,i,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=i,this.newDoc=r}},o6=class{constructor(e,t){this.targetId=e,this.existenceFilter=t}},a6=class{constructor(e,t,i=jt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},c6=class{constructor(){this.pendingResponses=0,this.documentChanges=rS(),this._resumeToken=jt.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return this.pendingResponses!==0}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=he(),t=he(),i=he();return this.documentChanges.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:j()}}),new i2(this._resumeToken,this._current,e,t,i)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=rS()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,J(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}},Iq="WatchChangeAggregator",vf=class{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=xn(),this.pendingDocumentTargetMapping=iS(),this.pendingTargetResets=new nt(ue)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let i=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&i.updateResumeToken(e.resumeToken);break;case 1:i.recordTargetResponse(),i.isPending||i.clearPendingChanges(),i.updateResumeToken(e.resumeToken);break;case 2:i.recordTargetResponse(),i.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(i.markCurrent(),i.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),i.updateResumeToken(e.resumeToken));break;default:j()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((i,r)=>{this.isActiveTarget(r)&&t(r)})}handleExistenceFilter(e){let t=e.targetId,i=e.existenceFilter.count,r=this.targetDataForActiveTarget(t);if(r){let s=r.target;if(r6(s))if(i===0){let o=new B(s.path);this.removeDocumentFromTarget(t,o,Ot.newNoDocument(o,ne.min()))}else J(i===1);else{let o=this.getCurrentDocumentCountForTarget(t);if(o!==i){let a=this.parseBloomFilter(e),c=a?this.applyBloomFilter(a,e,o):1;if(c!==0){this.resetTarget(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,l)}z7?.notifyOnExistenceFilterMismatch(Aq(o,e.existenceFilter,this.metadataProvider.getDatabaseId(),a,c))}}}}parseBloomFilter(e){let t=e.existenceFilter.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,o;try{o=Ls(i).toUint8Array()}catch(c){if(c instanceof pf)return ai("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}let a;try{a=new gf(o,r,s)}catch(c){return c instanceof xo?ai("BloomFilter error: ",c):ai("Applying bloom filter failed: ",c),null}return a.bitCount===0?null:a}applyBloomFilter(e,t,i){let r=t.existenceFilter.count,s=this.filterRemovedDocuments(e,t.targetId);return r===i-s?0:2}filterRemovedDocuments(e,t){let i=this.metadataProvider.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let o=this.metadataProvider.getDatabaseId(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.removeDocumentFromTarget(t,s,null),r++)}),r}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((s,o)=>{let a=this.targetDataForActiveTarget(o);if(a){if(s.current&&r6(a.target)){let c=new B(a.target.path);this.pendingDocumentUpdates.get(c)===null&&!this.targetContainsDocument(o,c)&&this.removeDocumentFromTarget(o,c,Ot.newNoDocument(c,e))}s.hasPendingChanges&&(t.set(o,s.toTargetChange()),s.clearPendingChanges())}});let i=he();this.pendingDocumentTargetMapping.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.targetDataForActiveTarget(c);return l&&l.purpose!=="TargetPurposeLimboResolution"?(a=!1,!1):!0}),a&&(i=i.add(s))}),this.pendingDocumentUpdates.forEach((s,o)=>o.setReadTime(e));let r=new n2(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,i);return this.pendingDocumentUpdates=xn(),this.pendingDocumentTargetMapping=iS(),this.pendingTargetResets=new nt(ue),r}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let i=this.targetContainsDocument(e,t.key)?2:0;this.ensureTargetState(e).addDocumentChange(t.key,i),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,i){if(!this.isActiveTarget(e))return;let r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,1):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),i&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,i))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let i=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+i.addedDocuments.size-i.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new c6,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new We(ue),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}isActiveTarget(e){let t=this.targetDataForActiveTarget(e)!==null;return t||L(Iq,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new c6),this.metadataProvider.getRemoteKeysForTarget(e).forEach(i=>{this.removeDocumentFromTarget(e,i,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}};function iS(){return new nt(B.comparator)}function rS(){return new nt(B.comparator)}function Aq(n,e,t,i,r){var s,o,a,c,l,u;let h={localCacheCount:n,existenceFilterCount:e.count,databaseId:t.database,projectId:t.projectId},d=e.unchangedNames;return d&&(h.bloomFilter={applied:r===0,hashCount:(s=d?.hashCount)!==null&&s!==void 0?s:0,bitmapLength:(c=(a=(o=d?.bits)===null||o===void 0?void 0:o.bitmap)===null||a===void 0?void 0:a.length)!==null&&c!==void 0?c:0,padding:(u=(l=d?.bits)===null||l===void 0?void 0:l.padding)!==null&&u!==void 0?u:0,mightContain:m=>{var p;return(p=i?.mightContain(m))!==null&&p!==void 0?p:!1}}),h}var Dq=(()=>{let n={};return n.asc="ASCENDING",n.desc="DESCENDING",n})(),kq=(()=>{let n={};return n["<"]="LESS_THAN",n["<="]="LESS_THAN_OR_EQUAL",n[">"]="GREATER_THAN",n[">="]="GREATER_THAN_OR_EQUAL",n["=="]="EQUAL",n["!="]="NOT_EQUAL",n["array-contains"]="ARRAY_CONTAINS",n.in="IN",n["not-in"]="NOT_IN",n["array-contains-any"]="ARRAY_CONTAINS_ANY",n})(),Rq=(()=>{let n={};return n.and="AND",n.or="OR",n})();var yf=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Lq(n){let e=n.code===void 0?b.UNKNOWN:$8(n.code);return new O(e,n.message||"")}function wf(n,e){return n.useProto3Json||w2(e)?e:{value:e}}function Vq(n){let e;return typeof n=="object"?e=n.value:e=n,w2(e)?null:e}function B1(n,e){if(n.useProto3Json){let i=new Date(e.seconds*1e3).toISOString().replace(/\.\d*/,"").replace("Z",""),r=("000000000"+e.nanoseconds).slice(-9);return`${i}.${r}Z`}else return{seconds:""+e.seconds,nanos:e.nanoseconds}}function Nq(n){let e=Rr(n);return new dt(e.seconds,e.nanos)}function JT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Pq(n,e){return n.useProto3Json?(J(e===void 0||typeof e=="string"),jt.fromBase64String(e||"")):(J(e===void 0||e instanceof Buffer||e instanceof Uint8Array),jt.fromUint8Array(e||new Uint8Array))}function Hq(n,e){return B1(n,e.toTimestamp())}function Tt(n){return J(!!n),ne.fromTimestamp(Nq(n))}function Y9(n,e){return bf(n,e).canonicalString()}function bf(n,e){let t=Bq(n).child("documents");return e===void 0?t:t.child(e)}function eE(n){let e=Te.fromString(n);return J(uE(e)),e}function r2(n,e){return Y9(n.databaseId,e.path)}function lr(n,e){let t=eE(e);if(t.get(1)!==n.databaseId.projectId)throw new O(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new O(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(iE(t))}function tE(n,e){return Y9(n.databaseId,e)}function nE(n){let e=eE(n);return e.length===4?Te.emptyPath():iE(e)}function Cf(n){return new Te(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Bq(n){return new Te(["projects",n.projectId,"databases",n.database])}function iE(n){return J(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function sS(n,e,t){return{name:r2(n,e),fields:t.value.mapValue.fields}}function Fq(n,e){return{name:r2(n,e.key),fields:e.data.value.mapValue.fields,updateTime:B1(n,e.version.toTimestamp()),createTime:B1(n,e.createTime.toTimestamp())}}function rE(n,e,t){let i=lr(n,e.name),r=Tt(e.updateTime),s=e.createTime?Tt(e.createTime):ne.min(),o=new on({mapValue:{fields:e.fields}}),a=Ot.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function qq(n,e){J(!!e.found),e.found.name,e.found.updateTime;let t=lr(n,e.found.name),i=Tt(e.found.updateTime),r=e.found.createTime?Tt(e.found.createTime):ne.min(),s=new on({mapValue:{fields:e.found.fields}});return Ot.newFoundDocument(t,i,r,s)}function Uq(n,e){J(!!e.missing),J(!!e.readTime);let t=lr(n,e.missing),i=Tt(e.readTime);return Ot.newNoDocument(t,i)}function jq(n,e){return"found"in e?qq(n,e):"missing"in e?Uq(n,e):j()}function Wq(n,e){let t;if("targetChange"in e){e.targetChange;let i=Gq(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=Pq(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&Lq(o);t=new a6(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=lr(n,i.document.name),s=Tt(i.document.updateTime),o=i.document.createTime?Tt(i.document.createTime):ne.min(),a=new on({mapValue:{fields:i.document.fields}}),c=Ot.newFoundDocument(r,s,o,a),l=i.targetIds||[],u=i.removedTargetIds||[];t=new D1(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=lr(n,i.document),s=i.readTime?Tt(i.readTime):ne.min(),o=Ot.newNoDocument(r,s),a=i.removedTargetIds||[];t=new D1([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=lr(n,i.document),s=i.removedTargetIds||[];t=new D1([],s,r,null)}else if("filter"in e){e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,o=new mf(r,s),a=i.targetId;t=new o6(a,o)}else return j();return t}function Gq(n){return n==="NO_CHANGE"?0:n==="ADD"?1:n==="REMOVE"?2:n==="CURRENT"?3:n==="RESET"?4:j()}function $q(n){if(!("targetChange"in n))return ne.min();let e=n.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?ne.min():Tt(e.readTime)}function s2(n,e){let t;if(e instanceof Bs)t={update:sS(n,e.key,e.value)};else if(e instanceof Fs)t={delete:r2(n,e.key)};else if(e instanceof Oi)t={update:sS(n,e.key,e.data),updateMask:MU(e.fieldMask)};else if(e instanceof J4)t={verify:r2(n,e.key)};else return j();return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>Zq(n,i))),e.precondition.isNone||(t.currentDocument=Yq(n,e.precondition)),t}function _f(n,e){let t=e.currentDocument?Kq(e.currentDocument):gt.none(),i=e.updateTransforms?e.updateTransforms.map(r=>Jq(n,r)):[];if(e.update){e.update.name;let r=lr(n,e.update.name),s=new on({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=zU(e.updateMask);return new Oi(r,s,o,t,i)}else return new Bs(r,s,t,i)}else if(e.delete){let r=lr(n,e.delete);return new Fs(r,t)}else if(e.verify){let r=lr(n,e.verify);return new J4(r,t)}else return j()}function Yq(n,e){return e.updateTime!==void 0?{updateTime:Hq(n,e.updateTime)}:e.exists!==void 0?{exists:e.exists}:j()}function Kq(n){return n.updateTime!==void 0?gt.updateTime(Tt(n.updateTime)):n.exists!==void 0?gt.exists(n.exists):gt.none()}function Qq(n,e){let t=n.updateTime?Tt(n.updateTime):Tt(e);return t.isEqual(ne.min())&&(t=Tt(e)),new df(t,n.transformResults||[])}function Xq(n,e){return n&&n.length>0?(J(e!==void 0),n.map(t=>Qq(t,e))):[]}function Zq(n,e){let t=e.transform;if(t instanceof Ps)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof Lr)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof Vr)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof Hs)return{fieldPath:e.field.canonicalString(),increment:t.operand};throw j()}function Jq(n,e){let t=null;if("setToServerValue"in e)J(e.setToServerValue==="REQUEST_TIME"),t=new Ps;else if("appendMissingElements"in e){let r=e.appendMissingElements.values||[];t=new Lr(r)}else if("removeAllFromArray"in e){let r=e.removeAllFromArray.values||[];t=new Vr(r)}else"increment"in e?t=new Hs(n,e.increment):j();let i=Et.fromServerFormat(e.fieldPath);return new No(i,t)}function sE(n,e){return{documents:[tE(n,e.path)]}}function eU(n){let e=n.documents.length;J(e===1);let t=n.documents[0];return vn(ec(nE(t)))}function oE(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=tE(n,r);let s=sU(e.filters);s&&(t.structuredQuery.where=s);let o=aU(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=wf(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=lU(e.startAt)),e.endAt&&(t.structuredQuery.endAt=uU(e.endAt)),{queryTarget:t,parent:r}}function aE(n){let e=nE(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){J(i===1);let u=t.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=oU(t.where));let o=[];t.orderBy&&(o=cU(t.orderBy));let a=null;t.limit&&(a=Vq(t.limit));let c=null;t.startAt&&(c=hU(t.startAt));let l=null;return t.endAt&&(l=dU(t.endAt)),kT(e,r,o,s,a,"F",c,l)}function tU(n){return vn(aE(n))}function nU(n,e){let t=iU(e.purpose);return t==null?null:{"goog-listen-tags":t}}function iU(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j()}}function rU(n,e){let t,i=e.target;if(r6(i)?t={documents:sE(n,i)}:t={query:oE(n,i).queryTarget},t.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){t.resumeToken=JT(n,e.resumeToken);let r=wf(n,e.expectedCount);r!==null&&(t.expectedCount=r)}else if(e.snapshotVersion.compareTo(ne.min())>0){t.readTime=B1(n,e.snapshotVersion.toTimestamp());let r=wf(n,e.expectedCount);r!==null&&(t.expectedCount=r)}return t}function sU(n){if(n.length!==0)return lE(Pe.create(n,"and"))}function oU(n){let e=cE(n);return e instanceof Pe&&j9(e)?e.getFilters():[e]}function cE(n){return n.unaryFilter!==void 0?SU(n):n.fieldFilter!==void 0?TU(n):n.compositeFilter!==void 0?EU(n):j()}function aU(n){if(n.length!==0)return n.map(e=>wU(e))}function cU(n){return n.map(e=>bU(e))}function lU(n){return{before:n.inclusive,values:n.position}}function uU(n){return{before:!n.inclusive,values:n.position}}function hU(n){let e=!!n.before,t=n.values||[];return new hr(t,e)}function dU(n){let e=!n.before,t=n.values||[];return new hr(t,e)}function fU(n){return Dq[n]}function mU(n){switch(n){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function pU(n){return kq[n]}function gU(n){return Rq[n]}function vU(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return j();default:return j()}}function yU(n){switch(n){case"AND":return"and";case"OR":return"or";default:return j()}}function M1(n){return{fieldPath:n.canonicalString()}}function O1(n){return Et.fromServerFormat(n.fieldPath)}function wU(n){return{field:M1(n.field),direction:fU(n.dir)}}function bU(n){return new Lo(O1(n.field),mU(n.direction))}function lE(n){return n instanceof ge?_U(n):n instanceof Pe?CU(n):j()}function CU(n){let e=n.getFilters().map(t=>lE(t));return e.length===1?e[0]:{compositeFilter:{op:gU(n.op),filters:e}}}function _U(n){if(n.op==="=="){if(Y_(n.value))return{unaryFilter:{field:M1(n.field),op:"IS_NAN"}};if($_(n.value))return{unaryFilter:{field:M1(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Y_(n.value))return{unaryFilter:{field:M1(n.field),op:"IS_NOT_NAN"}};if($_(n.value))return{unaryFilter:{field:M1(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:M1(n.field),op:pU(n.op),value:n.value}}}function SU(n){switch(n.unaryFilter.op){case"IS_NAN":let e=O1(n.unaryFilter.field);return ge.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=O1(n.unaryFilter.field);return ge.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let i=O1(n.unaryFilter.field);return ge.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let r=O1(n.unaryFilter.field);return ge.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return j();default:return j()}}function TU(n){return ge.create(O1(n.fieldFilter.field),vU(n.fieldFilter.op),n.fieldFilter.value)}function EU(n){return Pe.create(n.compositeFilter.filters.map(e=>cE(e)),yU(n.compositeFilter.op))}function MU(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function zU(n){let e=n.fieldPaths||[];return new qn(e.map(t=>Et.fromServerFormat(t)))}function uE(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var F1=class n{constructor(e,t,i,r,s=ne.min(),o=ne.min(),a=jt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var l6=class{constructor(e){this.remoteSerializer=e}};function xU(n,e){let t;if(e.document)t=rE(n.remoteSerializer,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let i=B.fromSegments(e.noDocument.path),r=Ho(e.noDocument.readTime);t=Ot.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else if(e.unknownDocument){let i=B.fromSegments(e.unknownDocument.path),r=Ho(e.unknownDocument.version);t=Ot.newUnknownDocument(i,r)}else return j();return e.readTime&&t.setReadTime(OU(e.readTime)),t}function oS(n,e){let t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Q6(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=Fq(n.remoteSerializer,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Po(e.version)};else if(e.isUnknownDocument())i.unknownDocument={path:t.path.toArray(),version:Po(e.version)};else return j();return i}function Q6(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function OU(n){let e=new dt(n[0],n[1]);return ne.fromTimestamp(e)}function Po(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ho(n){let e=new dt(n.seconds,n.nanoseconds);return ne.fromTimestamp(e)}function IU(n,e,t){let i=t.baseMutations.map(s=>s2(n.remoteSerializer,s)),r=t.mutations.map(s=>s2(n.remoteSerializer,s));return{userId:e,batchId:t.batchId,localWriteTimeMs:t.localWriteTime.toMillis(),baseMutations:i,mutations:r}}function To(n,e){let t=(e.baseMutations||[]).map(s=>_f(n.remoteSerializer,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let c=e.mutations[s+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let i=e.mutations.map(s=>_f(n.remoteSerializer,s)),r=dt.fromMillis(e.localWriteTimeMs);return new e2(e.batchId,r,t,i)}function P4(n){let e=Ho(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ho(n.lastLimboFreeSnapshotVersion):ne.min(),i;return AU(n.query)?i=eU(n.query):i=tU(n.query),new F1(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,jt.fromBase64String(n.resumeToken))}function hE(n,e){let t=Po(e.snapshotVersion),i=Po(e.lastLimboFreeSnapshotVersion),r;r6(e.target)?r=sE(n.remoteSerializer,e.target):r=oE(n.remoteSerializer,e.target).queryTarget;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Vo(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function AU(n){return n.documents!==void 0}function DU(n){return{id:n.bundleId,createTime:Ho(n.createTime),version:n.version}}function kU(n){return{bundleId:n.id,createTime:Po(Tt(n.createTime)),version:n.version}}function RU(n){return{name:n.name,query:K9(n.bundledQuery),readTime:Ho(n.readTime)}}function LU(n){return{name:n.name,readTime:Po(Tt(n.readTime)),bundledQuery:n.bundledQuery}}function K9(n){let e=aE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?s6(e,e.limit,"L"):e}function VU(n){return{name:n.name,query:K9(n.bundledQuery),readTime:Tt(n.readTime)}}function NU(n){return{id:n.id,version:n.version,createTime:Tt(n.createTime)}}function x7(n,e){return new t2(e.largestBatchId,_f(n.remoteSerializer,e.overlayMutation))}function PU(n,e,t){let[i,r,s]=dE(e,t.mutation.key);return{userId:e,collectionPath:r,documentId:s,collectionGroup:t.mutation.key.getCollectionGroup(),largestBatchId:t.largestBatchId,overlayMutation:s2(n.remoteSerializer,t.mutation)}}function dE(n,e){let t=e.path.lastSegment(),i=gn(e.path.popLast());return[n,i,t]}function HU(n){return{indexId:n.indexId,collectionGroup:n.collectionGroup,fields:n.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}function BU(n,e){let t=e?new W4(e.sequenceNumber,new ci(Ho(e.readTime),new B(ar(e.documentKey)),e.largestBatchId)):W4.empty(),i=n.fields.map(([r,s])=>new I1(Et.fromServerFormat(r),s));return new U7(n.indexId,n.collectionGroup,i,t)}function aS(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Po(i.readTime),documentKey:gn(i.documentKey.path),largestBatchId:i.largestBatchId}}var Sf=class{getBundleMetadata(e,t){return cS(e).get(t).next(i=>{if(i)return DU(i)})}saveBundleMetadata(e,t){return cS(e).put(kU(t))}getNamedQuery(e,t){return lS(e).get(t).next(i=>{if(i)return RU(i)})}saveNamedQuery(e,t){return lS(e).put(LU(t))}};function cS(n){return Wt(n,q6)}function lS(n){return Wt(n,U6)}var u6=class n{constructor(e,t){this.serializer=e,this.userId=t}static forUser(e,t){let i=t.uid||"";return new n(e,i)}getOverlay(e,t){return k4(e).get(dE(this.userId,t)).next(i=>i?x7(this.serializer,i):null)}getOverlays(e,t){let i=cr();return y.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){let r=[];return i.forEach((s,o)=>{let a=new t2(t,o);r.push(this.saveOverlay(e,a))}),y.waitFor(r)}removeOverlaysForBatchId(e,t,i){let r=new Set;t.forEach(o=>r.add(gn(o.getCollectionPath())));let s=[];return r.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(k4(e).deleteAll(X7,a))}),y.waitFor(s)}getOverlaysForCollection(e,t,i){let r=cr(),s=gn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return k4(e).loadAll(X7,o).next(a=>{for(let c of a){let l=x7(this.serializer,c);r.set(l.getKey(),l)}return r})}getOverlaysForCollectionGroup(e,t,i,r){let s=cr(),o,a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return k4(e).iterate({index:uT,range:a},(c,l,u)=>{let h=x7(this.serializer,l);s.size()<r||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>s)}saveOverlay(e,t){return k4(e).put(PU(this.serializer,this.userId,t))}};function k4(n){return Wt(n,G6)}var FU=5,qU=10,UU=13,uS=15,jU=20,WU=25,GU=30,$U=37,YU=45,KU=50,QU=55,XU=60,ZU=2,Dr=class{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,FU);else if("booleanValue"in e)this.writeValueTypeLabel(t,qU),t.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(t,uS),t.writeNumber(vt(e.integerValue));else if("doubleValue"in e){let i=vt(e.doubleValue);isNaN(i)?this.writeValueTypeLabel(t,UU):(this.writeValueTypeLabel(t,uS),K4(i)?t.writeNumber(0):t.writeNumber(i))}else if("timestampValue"in e){let i=e.timestampValue;this.writeValueTypeLabel(t,jU),typeof i=="string"&&(i=Rr(i)),t.writeString(`${i.seconds||""}`),t.writeNumber(i.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,GU),t.writeBytes(Ls(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.writeValueTypeLabel(t,YU),t.writeNumber(i.latitude||0),t.writeNumber(i.longitude||0)}else"mapValue"in e?ST(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):j()}writeIndexString(e,t){this.writeValueTypeLabel(t,WU),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let i=e.fields||{};this.writeValueTypeLabel(t,QU);for(let r of Object.keys(i))this.writeIndexString(r,t),this.writeIndexValueAux(i[r],t)}writeIndexArray(e,t){let i=e.values||[];this.writeValueTypeLabel(t,KU);for(let r of i)this.writeIndexValueAux(r,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,$U),B.fromName(e).path.forEach(r=>{this.writeValueTypeLabel(t,XU),this.writeUnlabeledIndexString(r,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(ZU)}};Dr.INSTANCE=new Dr;var hS="\uD800",dS="\uDBFF",w1=0,fS=255,mS=1,b1=255,pS=255,gS=0,JU=64,ej=8,tj=1024;function nj(n){let e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,!1),new Uint8Array(e.buffer)}function ij(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n=n<<4),n>>6||(e+=2,n=n<<2),n>>7||(e+=1),e}function rj(n){let e=0;for(let t=0;t<8;++t){let i=ij(n[t]&255);if(e+=i,i!==8)break}return e}function vS(n){let e=JU-rj(n);return Math.ceil(e/ej)}var Tf=class{constructor(){this.buffer=new Uint8Array(tj),this.position=0}writeBytesAscending(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.writeByteAscending(i.value),i=t.next();this.writeSeparatorAscending()}writeBytesDescending(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.writeByteDescending(i.value),i=t.next();this.writeSeparatorDescending()}writeUtf8Ascending(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.writeByteAscending(i);else if(i<2048)this.writeByteAscending(960|i>>>6),this.writeByteAscending(128|63&i);else if(t<hS||dS<t)this.writeByteAscending(480|i>>>12),this.writeByteAscending(128|63&i>>>6),this.writeByteAscending(128|63&i);else{let r=t.codePointAt(0);this.writeByteAscending(240|r>>>18),this.writeByteAscending(128|63&r>>>12),this.writeByteAscending(128|63&r>>>6),this.writeByteAscending(128|63&r)}}this.writeSeparatorAscending()}writeUtf8Descending(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.writeByteDescending(i);else if(i<2048)this.writeByteDescending(960|i>>>6),this.writeByteDescending(128|63&i);else if(t<hS||dS<t)this.writeByteDescending(480|i>>>12),this.writeByteDescending(128|63&i>>>6),this.writeByteDescending(128|63&i);else{let r=t.codePointAt(0);this.writeByteDescending(240|r>>>18),this.writeByteDescending(128|63&r>>>12),this.writeByteDescending(128|63&r>>>6),this.writeByteDescending(128|63&r)}}this.writeSeparatorDescending()}writeNumberAscending(e){let t=this.toOrderedBits(e),i=vS(t);this.ensureAvailable(1+i),this.buffer[this.position++]=i&255;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=t[r]&255}writeNumberDescending(e){let t=this.toOrderedBits(e),i=vS(t);this.ensureAvailable(1+i),this.buffer[this.position++]=~(i&255);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(t[r]&255)}writeInfinityAscending(){this.writeEscapedByteAscending(b1),this.writeEscapedByteAscending(pS)}writeInfinityDescending(){this.writeEscapedByteDescending(b1),this.writeEscapedByteDescending(pS)}reset(){this.position=0}seed(e){this.ensureAvailable(e.length),this.buffer.set(e,this.position),this.position+=e.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(e){let t=nj(e),i=(t[0]&128)!==0;t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}writeByteAscending(e){let t=e&255;t===w1?(this.writeEscapedByteAscending(w1),this.writeEscapedByteAscending(fS)):t===b1?(this.writeEscapedByteAscending(b1),this.writeEscapedByteAscending(gS)):this.writeEscapedByteAscending(t)}writeByteDescending(e){let t=e&255;t===w1?(this.writeEscapedByteDescending(w1),this.writeEscapedByteDescending(fS)):t===b1?(this.writeEscapedByteDescending(b1),this.writeEscapedByteDescending(gS)):this.writeEscapedByteDescending(e)}writeSeparatorAscending(){this.writeEscapedByteAscending(w1),this.writeEscapedByteAscending(mS)}writeSeparatorDescending(){this.writeEscapedByteDescending(w1),this.writeEscapedByteDescending(mS)}writeEscapedByteAscending(e){this.ensureAvailable(1),this.buffer[this.position++]=e}writeEscapedByteDescending(e){this.ensureAvailable(1),this.buffer[this.position++]=~e}ensureAvailable(e){let t=e+this.position;if(t<=this.buffer.length)return;let i=this.buffer.length*2;i<t&&(i=t);let r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}},Ef=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesAscending(e)}writeString(e){this.orderedCode.writeUtf8Ascending(e)}writeNumber(e){this.orderedCode.writeNumberAscending(e)}writeInfinity(){this.orderedCode.writeInfinityAscending()}},Mf=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesDescending(e)}writeString(e){this.orderedCode.writeUtf8Descending(e)}writeNumber(e){this.orderedCode.writeNumberDescending(e)}writeInfinity(){this.orderedCode.writeInfinityDescending()}},Eo=class{constructor(){this.orderedCode=new Tf,this.ascending=new Ef(this.orderedCode),this.descending=new Mf(this.orderedCode)}seed(e){this.orderedCode.seed(e)}forKind(e){return e===0?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}};var Mo=class n{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}successor(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new n(this.indexId,this.documentKey,this.arrayValue,i)}};function zs(n,e){let t=n.indexId-e.indexId;return t!==0||(t=yS(n.arrayValue,e.arrayValue),t!==0)||(t=yS(n.directionalValue,e.directionalValue),t!==0)?t:B.comparator(n.documentKey,e.documentKey)}function yS(n,e){for(let t=0;t<n.length&&t<e.length;++t){let i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}var h6=class{constructor(e){this.inequalityFilters=new We((t,i)=>Et.comparator(t.field,i.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.orderBys=e.orderBy,this.equalityFilters=[];for(let t of e.filters){let i=t;i.isInequality()?this.inequalityFilters=this.inequalityFilters.add(i):this.equalityFilters.push(i)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(e){if(J(e.collectionGroup===this.collectionId),this.hasMultipleInequality)return!1;let t=N9(e);if(t!==void 0&&!this.hasMatchingEqualityFilter(t))return!1;let i=Do(e),r=new Set,s=0,o=0;for(;s<i.length&&this.hasMatchingEqualityFilter(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.inequalityFilters.size>0){let a=this.inequalityFilters.getIterator().getNext();if(!r.has(a.field.canonicalString())){let c=i[s];if(!this.matchesFilter(a,c)||!this.matchesOrderBy(this.orderBys[o++],c))return!1}++s}for(;s<i.length;++s){let a=i[s];if(o>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[o++],a))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let e=new We(Et.comparator),t=[];for(let i of this.equalityFilters){if(i.field.isKeyField())continue;if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new I1(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new I1(i.field,0))}}for(let i of this.orderBys)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new I1(i.field,i.dir==="asc"?0:1)));return new U7(U7.UNKNOWN_ID,this.collectionId,t,W4.empty())}hasMatchingEqualityFilter(e){for(let t of this.equalityFilters)if(this.matchesFilter(t,e))return!0;return!1}matchesFilter(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}matchesOrderBy(e,t){return e.field.isEqual(t.fieldPath)?t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc":!1}};function fE(n){var e,t;if(J(n instanceof ge||n instanceof Pe),n instanceof ge)if(n instanceof i6){let r=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ge.create(n.field,"==",s)))||[];return Pe.create(r,"or")}else return n;let i=n.filters.map(r=>fE(r));return Pe.create(i,n.op)}function sj(n){if(n.getFilters().length===0)return[];let e=zf(fE(n));return J(mE(e)),Q9(e)||X9(e)?[e]:e.getFilters()}function Q9(n){return n instanceof ge}function X9(n){return n instanceof Pe&&j9(n)}function mE(n){return Q9(n)||X9(n)||oj(n)}function oj(n){if(n instanceof Pe&&tf(n)){for(let e of n.getFilters())if(!Q9(e)&&!X9(e))return!1;return!0}return!1}function zf(n){if(J(n instanceof ge||n instanceof Pe),n instanceof ge)return n;if(n.filters.length===1)return zf(n.filters[0]);let e=n.filters.map(i=>zf(i)),t=Pe.create(e,n.op);return t=d6(t),mE(t)?t:(J(t instanceof Pe),J(V1(t)),J(t.filters.length>1),t.filters.reduce((i,r)=>Z9(i,r)))}function Z9(n,e){J(n instanceof ge||n instanceof Pe),J(e instanceof ge||e instanceof Pe);let t;return n instanceof ge?e instanceof ge?t=aj(n,e):t=wS(n,e):e instanceof ge?t=wS(e,n):t=cj(n,e),d6(t)}function aj(n,e){return Pe.create([n,e],"and")}function cj(n,e){if(J(n.filters.length>0&&e.filters.length>0),V1(n)&&V1(e))return xT(n,e.getFilters());let t=tf(n)?n:e,i=tf(n)?e:n,r=t.filters.map(s=>Z9(s,i));return Pe.create(r,"or")}function wS(n,e){if(V1(e))return xT(e,n.getFilters());{let t=e.filters.map(i=>Z9(n,i));return Pe.create(t,"or")}}function d6(n){if(J(n instanceof ge||n instanceof Pe),n instanceof ge)return n;let e=n.getFilters();if(e.length===1)return d6(e[0]);if(MT(n))return n;let t=e.map(r=>d6(r)),i=[];return t.forEach(r=>{r instanceof ge?i.push(r):r instanceof Pe&&(r.op===n.op?i.push(...r.filters):i.push(r))}),i.length===1?i[0]:Pe.create(i,n.op)}var xf=class{constructor(){this.collectionParentIndex=new o2}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),y.resolve()}getCollectionParents(e,t){return y.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return y.resolve()}deleteFieldIndex(e,t){return y.resolve()}deleteAllFieldIndexes(e){return y.resolve()}createTargetIndexes(e,t){return y.resolve()}getDocumentsMatchingTarget(e,t){return y.resolve(null)}getIndexType(e,t){return y.resolve(0)}getFieldIndexes(e,t){return y.resolve([])}getNextCollectionGroupToUpdate(e){return y.resolve(null)}getMinOffset(e,t){return y.resolve(ci.min())}getMinOffsetFromCollectionGroup(e,t){return y.resolve(ci.min())}updateCollectionGroup(e,t,i){return y.resolve()}updateIndexEntries(e,t){return y.resolve()}},o2=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new We(Te.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new We(Te.comparator)).toArray()}};var bS="IndexedDbIndexManager",H8=new Uint8Array(0),Of=class{constructor(e,t){this.databaseId=t,this.collectionParentsCache=new o2,this.targetToDnfSubTargets=new dr(i=>Vo(i),(i,r)=>b2(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.collectionParentsCache.has(t)){let i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.collectionParentsCache.add(t)});let s={collectionId:i,parent:gn(r)};return CS(e).put(s)}return y.resolve()}getCollectionParents(e,t){let i=[],r=IDBKeyRange.bound([t,""],[XS(t),""],!1,!0);return CS(e).loadAll(r).next(s=>{for(let o of s){if(o.collectionId!==t)break;i.push(ar(o.parent))}return i})}addFieldIndex(e,t){let i=R4(e),r=HU(t);delete r.indexId;let s=i.add(r);if(t.indexState){let o=_1(e);return s.next(a=>{o.put(aS(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}else return s.next()}deleteFieldIndex(e,t){let i=R4(e),r=_1(e),s=C1(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=R4(e),i=C1(e),r=_1(e);return t.deleteAll().next(()=>i.deleteAll()).next(()=>r.deleteAll())}createTargetIndexes(e,t){return y.forEach(this.getSubTargets(t),i=>this.getIndexType(e,i).next(r=>{if(r===0||r===1){let o=new h6(i).buildTargetIndex();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let i=C1(e),r=!0,s=new Map;return y.forEach(this.getSubTargets(t),o=>this.getFieldIndex(e,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=he(),a=[];return y.forEach(s,(c,l)=>{L(bS,`Using index ${wB(c)} to execute ${Vo(t)}`);let u=qF(l,c),h=UF(l,c),d=jF(l,c),m=WF(l,c),p=this.encodeBound(c,l,d),v=this.encodeBound(c,l,m),w=this.encodeValues(c,l,h),A=this.generateIndexRanges(c.indexId,u,p,d.inclusive,v,m.inclusive,w);return y.forEach(A,_=>i.loadFirst(_,t.limit).next(k=>{k.forEach(R=>{let U=B.fromSegments(R.documentKey);o.has(U)||(o=o.add(U),a.push(U))})}))}).next(()=>a)}else return y.resolve(null)})}getSubTargets(e){let t=this.targetToDnfSubTargets.get(e);return t||(e.filters.length===0?t=[e]:t=sj(Pe.create(e.filters,"and")).map(r=>hf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.targetToDnfSubTargets.set(e,t),t)}generateIndexRanges(e,t,i,r,s,o,a){let c=(t!=null?t.length:1)*Math.max(i.length,s.length),l=c/(t!=null?t.length:1),u=[];for(let h=0;h<c;++h){let d=t?this.encodeSingleElement(t[h/l]):H8,m=this.generateLowerBound(e,d,i[h%l],r),p=this.generateUpperBound(e,d,s[h%l],o),v=a.map(w=>this.generateLowerBound(e,d,w,!0));u.push(...this.createRange(m,p,v))}return u}generateLowerBound(e,t,i,r){let s=new Mo(e,B.empty(),t,i);return r?s:s.successor()}generateUpperBound(e,t,i,r){let s=new Mo(e,B.empty(),t,i);return r?s.successor():s}getFieldIndex(e,t){let i=new h6(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(let a of s)i.servedByIndex(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let i=2,r=this.getSubTargets(t);return y.forEach(r,s=>this.getFieldIndex(e,s).next(o=>{o?i!==0&&o.fields.length<GF(s)&&(i=1):i=0})).next(()=>$F(t)&&r.length>1&&i===2?1:i)}encodeDirectionalElements(e,t){let i=new Eo;for(let r of Do(e)){let s=t.data.field(r.fieldPath);if(s==null)return null;let o=i.forKind(r.kind);Dr.INSTANCE.writeIndexValue(s,o)}return i.encodedBytes()}encodeSingleElement(e){let t=new Eo;return Dr.INSTANCE.writeIndexValue(e,t.forKind(0)),t.encodedBytes()}encodeDirectionalKey(e,t){let i=new Eo;return Dr.INSTANCE.writeIndexValue(Ro(this.databaseId,t),i.forKind(yB(e))),i.encodedBytes()}encodeValues(e,t,i){if(i===null)return[];let r=[];r.push(new Eo);let s=0;for(let o of Do(e)){let a=i[s++];for(let c of r)if(this.isInFilter(t,o.fieldPath)&&X4(a))r=this.expandIndexValues(r,o,a);else{let l=c.forKind(o.kind);Dr.INSTANCE.writeIndexValue(a,l)}}return this.getEncodedBytes(r)}encodeBound(e,t,i){return this.encodeValues(e,t,i.position)}getEncodedBytes(e){let t=[];for(let i=0;i<e.length;++i)t[i]=e[i].encodedBytes();return t}expandIndexValues(e,t,i){let r=[...e],s=[];for(let o of i.arrayValue.values||[])for(let a of r){let c=new Eo;c.seed(a.encodedBytes()),Dr.INSTANCE.writeIndexValue(o,c.forKind(t.kind)),s.push(c)}return s}isInFilter(e,t){return!!e.filters.find(i=>i instanceof ge&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(e,t){let i=R4(e),r=_1(e);return(t?i.loadAll(Q7,IDBKeyRange.bound(t,t)):i.loadAll()).next(s=>{let o=[];return y.forEach(s,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(BU(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((i,r)=>{let s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:ue(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){let r=R4(e),s=_1(e);return this.getNextSequenceNumber(e).next(o=>r.loadAll(Q7,IDBKeyRange.bound(t,t)).next(a=>y.forEach(a,c=>s.put(aS(c.indexId,this.uid,o,i)))))}updateIndexEntries(e,t){let i=new Map;return y.forEach(t,(r,s)=>{let o=i.get(r.collectionGroup);return(o?y.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(c=>(i.set(r.collectionGroup,c),y.forEach(c,l=>this.getExistingIndexEntries(e,r,l).next(u=>{let h=this.computeIndexEntries(s,l);return u.isEqual(h)?y.resolve():this.updateEntries(e,s,l,u,h)}))))})}addIndexEntry(e,t,i,r){return C1(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(i,t.key),documentKey:t.key.path.toArray()})}deleteIndexEntry(e,t,i,r){return C1(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.encodeDirectionalKey(i,t.key),t.key.path.toArray()])}getExistingIndexEntries(e,t,i){let r=C1(e),s=new We(zs);return r.iterate({index:lT,range:IDBKeyRange.only([i.indexId,this.uid,this.encodeDirectionalKey(i,t)])},(o,a)=>{s=s.add(new Mo(i.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}computeIndexEntries(e,t){let i=new We(zs),r=this.encodeDirectionalElements(t,e);if(r==null)return i;let s=N9(t);if(s!=null){let o=e.data.field(s.fieldPath);if(X4(o))for(let a of o.arrayValue.values||[])i=i.add(new Mo(t.indexId,e.key,this.encodeSingleElement(a),r))}else i=i.add(new Mo(t.indexId,e.key,H8,r));return i}updateEntries(e,t,i,r,s){L(bS,"Updating index entries for document '%s'",t.key);let o=[];return nF(r,s,zs,a=>{o.push(this.addIndexEntry(e,t,i,a))},a=>{o.push(this.deleteIndexEntry(e,t,i,a))}),y.waitFor(o)}getNextSequenceNumber(e){let t=1;return _1(e).iterate({index:cT,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,o)=>{o.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((o,a)=>zs(o,a)).filter((o,a,c)=>!a||zs(o,c[a-1])!==0);let r=[];r.push(e);for(let o of i){let a=zs(o,e),c=zs(o,t);if(a===0)r[0]=e.successor();else if(a>0&&c<0)r.push(o),r.push(o.successor());else if(c>0)break}r.push(t);let s=[];for(let o=0;o<r.length;o+=2){if(this.isRangeMatchable(r[o],r[o+1]))return[];let a=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,H8,[]],c=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,H8,[]];s.push(IDBKeyRange.bound(a,c))}return s}isRangeMatchable(e,t){return zs(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(_S)}getMinOffset(e,t){return y.mapArray(this.getSubTargets(t),i=>this.getFieldIndex(e,i).next(r=>r||j())).next(_S)}};function CS(n){return Wt(n,G4)}function C1(n){return Wt(n,W6)}function R4(n){return Wt(n,F9)}function _1(n){return Wt(n,j6)}function _S(n){J(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){let r=n[i].indexState.offset;P9(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new ci(e.readTime,e.documentKey,t)}function pE(n,e,t){let i=n.store(Mi),r=n.store(X1),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=i.iterate({range:o},(u,h,d)=>(a++,d.delete()));s.push(c.next(()=>{J(a===1)}));let l=[];for(let u of t.mutations){let h=sT(e,u.key.path,t.batchId);s.push(r.delete(h)),l.push(u.key)}return y.waitFor(s).next(()=>l)}function f6(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else if(n.noDocument)e=n.noDocument;else throw j();return JSON.stringify(e).length}var m6=class n{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.documentKeysByBatchId={}}static forUser(e,t,i,r){J(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,i,r)}checkEmpty(e){let t=!0,i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xs(e).iterate({index:zo,range:i},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,i,r){let s=z1(e),o=xs(e);return o.add({}).next(a=>{J(typeof a=="number");let c=new e2(a,t,i,r),l=IU(this.serializer,this.userId,c),u=[],h=new We((d,m)=>ue(d.canonicalString(),m.canonicalString()));for(let d of r){let m=sT(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(s.put(m,zB))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.documentKeysByBatchId[a]=c.keys()}),y.waitFor(u).next(()=>c)})}lookupMutationBatch(e,t){return xs(e).get(t).next(i=>i?(J(i.userId===this.userId),To(this.serializer,i)):null)}lookupMutationKeys(e,t){return this.documentKeysByBatchId[t]?y.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){let r=i.keys();return this.documentKeysByBatchId[t]=r,r}else return null})}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]),s=null;return xs(e).iterate({index:zo,range:r},(o,a,c)=>{a.userId===this.userId&&(J(a.batchId>=i),s=To(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),i=ks;return xs(e).iterate({index:zo,range:t,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,ks],[this.userId,Number.POSITIVE_INFINITY]);return xs(e).loadAll(zo,t).next(i=>i.map(r=>To(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){let i=U8(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return z1(e).iterate({range:r},(o,a,c)=>{let[l,u,h]=o,d=ar(u);if(l!==this.userId||!t.path.isEqual(d)){c.done();return}return xs(e).get(h).next(m=>{if(!m)throw j();J(m.userId===this.userId),s.push(To(this.serializer,m))})}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new We(ue),r=[];return t.forEach(s=>{let o=U8(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=z1(e).iterate({range:a},(l,u,h)=>{let[d,m,p]=l,v=ar(m);if(d!==this.userId||!s.path.isEqual(v)){h.done();return}i=i.add(p)});r.push(c)}),y.waitFor(r).next(()=>this.lookupMutationBatches(e,i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=U8(this.userId,i),o=IDBKeyRange.lowerBound(s),a=new We(ue);return z1(e).iterate({range:o},(c,l,u)=>{let[h,d,m]=c,p=ar(d);if(h!==this.userId||!i.isPrefixOf(p)){u.done();return}p.length===r&&(a=a.add(m))}).next(()=>this.lookupMutationBatches(e,a))}lookupMutationBatches(e,t){let i=[],r=[];return t.forEach(s=>{r.push(xs(e).get(s).next(o=>{if(o===null)throw j();J(o.userId===this.userId),i.push(To(this.serializer,o))}))}),y.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return pE(e.simpleDbTransaction,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.removeCachedMutationKeys(t.batchId)}),y.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}removeCachedMutationKeys(e){delete this.documentKeysByBatchId[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return y.resolve();let i=IDBKeyRange.lowerBound(MB(this.userId)),r=[];return z1(e).iterate({range:i},(s,o,a)=>{if(s[0]!==this.userId){a.done();return}else{let l=ar(s[1]);r.push(l)}}).next(()=>{J(r.length===0)})})}containsKey(e,t){return gE(e,this.userId,t)}getMutationQueueMetadata(e){return vE(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:ks,lastStreamToken:""})}};function gE(n,e,t){let i=U8(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i),o=!1;return z1(n).iterate({range:s,keysOnly:!0},(a,c,l)=>{let[u,h,d]=a;u===e&&h===r&&(o=!0),l.done()}).next(()=>o)}function lj(n,e){let t=!1;return vE(n).iterateSerial(i=>gE(n,i,e).next(r=>(r&&(t=!0),y.resolve(!r)))).next(()=>t)}function xs(n){return Wt(n,Mi)}function z1(n){return Wt(n,X1)}function vE(n){return Wt(n,v2)}var O7=2,q1=class n{constructor(e){this.lastId=e}next(){return this.lastId+=O7,this.lastId}static forTargetCache(){return new n(2-O7)}static forSyncEngine(){return new n(1-O7)}};var If=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.retrieveMetadata(e).next(t=>{let i=new q1(t.highestTargetId);return t.highestTargetId=i.next(),this.saveMetadata(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.retrieveMetadata(e).next(t=>ne.fromTimestamp(new dt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.retrieveMetadata(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.retrieveMetadata(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.saveMetadata(e,r)))}addTargetData(e,t){return this.saveTargetData(e,t).next(()=>this.retrieveMetadata(e).next(i=>(i.targetCount+=1,this.updateMetadataFromTargetData(t,i),this.saveMetadata(e,i))))}updateTargetData(e,t){return this.saveTargetData(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>S1(e).delete(t.targetId)).next(()=>this.retrieveMetadata(e)).next(i=>(J(i.targetCount>0),i.targetCount-=1,this.saveMetadata(e,i)))}removeTargets(e,t,i){let r=0,s=[];return S1(e).iterate((o,a)=>{let c=P4(a);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(e,c)))}).next(()=>y.waitFor(s)).next(()=>r)}forEachTarget(e,t){return S1(e).iterate((i,r)=>{let s=P4(r);t(s)})}retrieveMetadata(e){return SS(e).get(e6).next(t=>(J(t!==null),t))}saveMetadata(e,t){return SS(e).put(e6,t)}saveTargetData(e,t){return S1(e).put(hE(this.serializer,t))}updateMetadataFromTargetData(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.retrieveMetadata(e).next(t=>t.targetCount)}getTargetData(e,t){let i=Vo(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]),s=null;return S1(e).iterate({range:r,index:aT},(o,a,c)=>{let l=P4(a);b2(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,i){let r=[],s=Is(e);return t.forEach(o=>{let a=gn(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))}),y.waitFor(r)}removeMatchingKeys(e,t,i){let r=Is(e);return y.forEach(t,s=>{let o=gn(s.path);return y.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){let i=Is(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){let i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Is(e),s=he();return r.iterate({range:i,keysOnly:!0},(o,a,c)=>{let l=ar(o[1]),u=new B(l);s=s.add(u)}).next(()=>s)}containsKey(e,t){let i=gn(t.path),r=IDBKeyRange.bound([i],[XS(i)],!1,!0),s=0;return Is(e).iterate({index:B9,keysOnly:!0,range:r},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}getTargetDataForTarget(e,t){return S1(e).get(t).next(i=>i?P4(i):null)}};function S1(n){return Wt(n,Z1)}function SS(n){return Wt(n,Wo)}function Is(n){return Wt(n,J1)}var TS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},S2=-1,yE=40*1024*1024,oi=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};oi.DEFAULT_COLLECTION_PERCENTILE=10;oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;oi.DEFAULT=new oi(yE,oi.DEFAULT_COLLECTION_PERCENTILE,oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);oi.DISABLED=new oi(S2,0,0);var ES="LruGarbageCollector",MS=1*1024*1024,uj=1*60*1e3,hj=5*60*1e3;function zS([n,e],[t,i]){let r=ue(n,t);return r===0?ue(e,i):r}var Af=class{constructor(e){this.maxElements=e,this.buffer=new We(zS),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();zS(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Df=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==S2&&this.scheduleGC(uj)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return this.gcTask!==null}scheduleGC(e){L(ES,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.gcTask=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ws(t)?L(ES,"Ignoring IndexedDB error during garbage collection: ",t):yield js(t)}yield this.scheduleGC(hj)}))}},kf=class{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return y.resolve(Fn.INVALID);let i=new Af(t);return this.delegate.forEachTarget(e,r=>i.addElement(r.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,r=>i.addElement(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.delegate.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===S2?(L("LruGarbageCollector","Garbage collection skipped; disabled"),y.resolve(TS)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(L("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),TS):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let i,r,s,o,a,c,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(L("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>{if(l=Date.now(),T1()<=Bi.DEBUG){let d=`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in ${a-o}ms
	Removed ${s} targets in ${c-a}ms
	Removed ${h} documents in ${l-c}ms
Total Duration: ${l-u}ms`;L("LruGarbageCollector",d)}return y.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:h})})}};function dj(n,e){return new kf(n,e)}var Rf=class{constructor(e,t){this.db=e,this.garbageCollector=dj(this,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}forEachOrphanedDocumentSequenceNumber(e,t){return this.forEachOrphanedDocument(e,(i,r)=>t(r))}addReference(e,t,i){return B8(e,i)}removeReference(e,t,i){return B8(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return B8(e,t)}isPinned(e,t){return lj(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[],o=0;return this.forEachOrphanedDocument(e,(c,l)=>{if(l<=t){let u=this.isPinned(e,c).next(h=>{if(!h)return o++,r.getEntry(e,c).next(()=>(r.removeEntry(c,ne.min()),Is(e).delete(fj(c))))});s.push(u)}}).next(()=>y.waitFor(s)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return B8(e,t)}forEachOrphanedDocument(e,t){let i=Is(e),r=Fn.INVALID,s;return i.iterate({index:B9},([o,a],{path:c,sequenceNumber:l})=>{o===0?(r!==Fn.INVALID&&t(new B(ar(s)),r),r=l,s=c):r=Fn.INVALID}).next(()=>{r!==Fn.INVALID&&t(new B(ar(s)),r)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function fj(n){return[0,gn(n.path)]}function mj(n,e){return{targetId:0,path:gn(n.path),sequenceNumber:e}}function B8(n,e){return Is(n).put(mj(e,n.currentSequenceNumber))}var p6=class{constructor(){this.changes=new dr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ot.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?y.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Lf=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Co(e).put(i)}removeEntry(e,t,i){return Co(e).delete(pj(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.setMetadata(e,i)))}getEntry(e,t){let i=Ot.newInvalidDocument(t);return Co(e).iterate({index:j8,range:IDBKeyRange.only(L4(t))},(r,s)=>{i=this.maybeDecodeDocument(t,s)}).next(()=>i)}getSizedEntry(e,t){let i={size:0,document:Ot.newInvalidDocument(t)};return Co(e).iterate({index:j8,range:IDBKeyRange.only(L4(t))},(r,s)=>{i={document:this.maybeDecodeDocument(t,s),size:f6(s)}}).next(()=>i)}getEntries(e,t){let i=xn();return this.forEachDbEntry(e,t,(r,s)=>{let o=this.maybeDecodeDocument(r,s);i=i.insert(r,o)}).next(()=>i)}getSizedEntries(e,t){let i=xn(),r=new nt(B.comparator);return this.forEachDbEntry(e,t,(s,o)=>{let a=this.maybeDecodeDocument(s,o);i=i.insert(s,a),r=r.insert(s,f6(o))}).next(()=>({documents:i,sizeMap:r}))}forEachDbEntry(e,t,i){if(t.isEmpty())return y.resolve();let r=new We(IS);t.forEach(c=>r=r.add(c));let s=IDBKeyRange.bound(L4(r.first()),L4(r.last())),o=r.getIterator(),a=o.getNext();return Co(e).iterate({index:j8,range:s},(c,l,u)=>{let h=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&IS(a,h)<0;)i(a,null),a=o.getNext();a&&a.isEqual(h)&&(i(a,l),a=o.hasNext()?o.getNext():null),a?u.skip(L4(a)):u.done()}).next(()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,i,r,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Q6(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Co(e).loadAll(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let u=xn();for(let h of l){let d=this.maybeDecodeDocument(B.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);d.isFoundDocument()&&(_2(t,d)||r.has(d.key))&&(u=u.insert(d.key,d))}return u})}getAllFromCollectionGroup(e,t,i,r){let s=xn(),o=OS(t,i),a=OS(t,ci.max());return Co(e).iterate({index:oT,range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{let h=this.maybeDecodeDocument(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===r&&u.done()}).next(()=>s)}newChangeBuffer(e){return new Vf(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return xS(e).get(K7).next(t=>(J(!!t),t))}setMetadata(e,t){return xS(e).put(K7,t)}maybeDecodeDocument(e,t){if(t){let i=xU(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(ne.min())))return i}return Ot.newInvalidDocument(e)}};function wE(n){return new Lf(n)}var Vf=class extends p6{constructor(e,t){super(),this.documentCache=e,this.trackRemovals=t,this.documentStates=new dr(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){let t=[],i=0,r=new We((s,o)=>ue(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.documentStates.get(s);if(t.push(this.documentCache.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=oS(this.documentCache.serializer,o);r=r.add(s.path.popLast());let l=f6(c);i+=l-a.size,t.push(this.documentCache.addEntry(e,s,c))}else if(i-=a.size,this.trackRemovals){let c=oS(this.documentCache.serializer,o.convertToNoDocument(ne.min()));t.push(this.documentCache.addEntry(e,s,c))}}),r.forEach(s=>{t.push(this.documentCache.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.documentCache.updateMetadata(e,i)),y.waitFor(t)}getFromCache(e,t){return this.documentCache.getSizedEntry(e,t).next(i=>(this.documentStates.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.documentCache.getSizedEntries(e,t).next(({documents:i,sizeMap:r})=>(r.forEach((s,o)=>{this.documentStates.set(s,{size:o,readTime:i.get(s).readTime})}),i))}};function xS(n){return Wt(n,y2)}function Co(n){return Wt(n,F6)}function L4(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function pj(n,e){let t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],Q6(e),t[t.length-1]]}function OS(n,e){let t=e.documentKey.path.toArray();return[n,Q6(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function IS(n,e){let t=n.path.toArray(),i=e.path.toArray(),r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=ue(t[s],i[s]),r)return r;return r=ue(t.length,i.length),r||(r=ue(t[t.length-2],i[i.length-2]),r)?r:ue(t[t.length-1],i[i.length-1])}var gj=16;var Nf=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var g6=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&q4(i.mutation,r,qn.empty(),dt.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,he()).next(()=>i))}getLocalViewOfDocuments(e,t,i=he()){let r=cr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=N4();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let i=cr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,he()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=xn(),o=Z4(),a=cq();return t.forEach((c,l)=>{let u=i.get(l.key);r.has(l.key)&&(u===void 0||u.mutation instanceof Oi)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),q4(u.mutation,l,u.mutation.getFieldMask(),dt.now())):o.set(l.key,qn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),t.forEach((l,u)=>{var h;return a.set(l,new Nf(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let i=Z4(),r=new nt((o,a)=>o-a),s=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let u=i.get(c)||qn.empty();u=a.applyToLocalView(l,u),i.set(c,u);let h=(r.get(a.batchId)||he()).add(c);r=r.insert(a.batchId,h)})}).next(()=>{let o=[],a=r.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,u=c.value,h=HT();u.forEach(d=>{if(!s.has(d)){let m=$T(t.get(d),i.get(d));m!==null&&h.set(d,m),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return y.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return XF(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):W9(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):y.resolve(cr()),a=k1,c=s;return o.next(l=>y.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?y.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,he())).next(u=>({batchId:a,changes:PT(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(i=>{let r=N4();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,o=N4();return this.indexManager.getCollectionParents(e,s).next(a=>y.forEach(a,c=>{let l=YF(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,i,r).next(u=>{u.forEach((h,d)=>{o=o.insert(h,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((c,l)=>{let u=l.getKey();o.get(u)===null&&(o=o.insert(u,Ot.newInvalidDocument(u)))});let a=N4();return o.forEach((c,l)=>{let u=s.get(c);u!==void 0&&q4(u.mutation,l,qn.empty(),dt.now()),_2(t,l)&&(a=a.insert(c,l))}),a})}};var Pf=class{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return y.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,NU(t)),y.resolve()}getNamedQuery(e,t){return y.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,VU(t)),y.resolve()}};var Hf=class{constructor(){this.overlays=new nt(B.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return y.resolve(this.overlays.get(t))}getOverlays(e,t){let i=cr();return y.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.saveOverlay(e,t,s)}),y.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.overlayByBatchId.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.overlayByBatchId.delete(i)),y.resolve()}getOverlaysForCollection(e,t,i){let r=cr(),s=t.length+1,o=new B(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return y.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new nt((l,u)=>l-u),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let d=s.get(u.largestBatchId);d===null&&(d=cr(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=cr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,d)=>a.set(h,d)),!(a.size()>=r)););return y.resolve(a)}saveOverlay(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let o=this.overlayByBatchId.get(r.largestBatchId).delete(i.key);this.overlayByBatchId.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new t2(t,i));let s=this.overlayByBatchId.get(t);s===void 0&&(s=he(),this.overlayByBatchId.set(t,s)),this.overlayByBatchId.set(t,s.add(i.key))}};var a2=class{constructor(){this.refsByKey=new We(xt.compareByKey),this.refsByTarget=new We(xt.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let i=new xt(e,t);this.refsByKey=this.refsByKey.add(i),this.refsByTarget=this.refsByTarget.add(i)}addReferences(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.removeRef(new xt(e,t))}removeReferences(e,t){e.forEach(i=>this.removeReference(i,t))}removeReferencesForId(e){let t=new B(new Te([])),i=new xt(t,e),r=new xt(t,e+1),s=[];return this.refsByTarget.forEachInRange([i,r],o=>{this.removeRef(o),s.push(o.key)}),s}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new B(new Te([])),i=new xt(t,e),r=new xt(t,e+1),s=he();return this.refsByTarget.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new xt(e,0),i=this.refsByKey.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},xt=class{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return B.comparator(e.key,t.key)||ue(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return ue(e.targetOrBatchId,t.targetOrBatchId)||B.comparator(e.key,t.key)}};var Bf=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new We(xt.compareByKey)}checkEmpty(e){return y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new e2(s,t,i,r);this.mutationQueue.push(o);for(let a of r)this.batchesByDocumentKey=this.batchesByDocumentKey.add(new xt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return y.resolve(o)}lookupMutationBatch(e,t){return y.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.indexOfBatchId(i),s=r<0?0:r;return y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return y.resolve(this.mutationQueue.length===0?ks:this.nextBatchId-1)}getAllMutationBatches(e){return y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new xt(t,0),r=new xt(t,Number.POSITIVE_INFINITY),s=[];return this.batchesByDocumentKey.forEachInRange([i,r],o=>{let a=this.findMutationBatch(o.targetOrBatchId);s.push(a)}),y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new We(ue);return t.forEach(r=>{let s=new xt(r,0),o=new xt(r,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([s,o],a=>{i=i.add(a.targetOrBatchId)})}),y.resolve(this.findMutationBatches(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;B.isDocumentKey(s)||(s=s.child(""));let o=new xt(new B(s),0),a=new We(ue);return this.batchesByDocumentKey.forEachWhile(c=>{let l=c.key.path;return i.isPrefixOf(l)?(l.length===r&&(a=a.add(c.targetOrBatchId)),!0):!1},o),y.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(i=>{let r=this.findMutationBatch(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){let i=this.indexOfExistingBatchId(t.batchId,"removed");J(i===0),this.mutationQueue.shift();let r=this.batchesByDocumentKey;return y.forEach(t.mutations,s=>{let o=new xt(s.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.batchesByDocumentKey=r})}removeCachedMutationKeys(e){}containsKey(e,t){let i=new xt(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(i);return y.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,y.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){if(this.mutationQueue.length===0)return 0;let t=this.mutationQueue[0].batchId;return e-t}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};function vj(){return new nt(B.comparator)}var Ff=class{constructor(e){this.sizer=e,this.docs=vj(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.sizer(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return y.resolve(i?i.document.mutableCopy():Ot.newInvalidDocument(t))}getEntries(e,t){let i=xn();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Ot.newInvalidDocument(r))}),y.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=xn(),o=t.path,a=new B(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||P9(JS(u),i)<=0||!r.has(u.key)&&!_2(t,u)||(s=s.insert(u.key,u.mutableCopy()))}return y.resolve(s)}getAllFromCollectionGroup(e,t,i,r){j()}forEachDocumentKey(e,t){return y.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new qf(this)}getSize(e){return y.resolve(this.size)}};function yj(n){return new Ff(n)}var qf=class extends p6{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.documentCache.addEntry(e,r)):this.documentCache.removeEntry(i)}),y.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}};var Uf=class{constructor(e){this.persistence=e,this.targets=new dr(t=>Vo(t),b2),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new a2,this.targetCount=0,this.targetIdGenerator=q1.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((i,r)=>t(r)),y.resolve()}getLastRemoteSnapshotVersion(e){return y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return y.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),y.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),y.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new q1(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,y.resolve()}updateTargetData(e,t){return this.saveTargetData(t),y.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,y.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.targets.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.targets.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),y.waitFor(s).next(()=>r)}getTargetCount(e){return y.resolve(this.targetCount)}getTargetData(e,t){let i=this.targets.get(t)||null;return y.resolve(i)}addMatchingKeys(e,t,i){return this.references.addReferences(t,i),y.resolve()}removeMatchingKeys(e,t,i){this.references.removeReferences(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),y.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),y.resolve()}getMatchingKeysForTargetId(e,t){let i=this.references.referencesForId(t);return y.resolve(i)}containsKey(e,t){return y.resolve(this.references.containsKey(t))}};var wj="MemoryPersistence",v6=class{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new Fn(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new Uf(this);let i=r=>this.referenceDelegate.documentSize(r);this.indexManager=new xf,this.remoteDocumentCache=yj(i),this.serializer=new l6(t),this.bundleCache=new Pf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Hf,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.mutationQueues[e.toKey()];return i||(i=new Bf(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=i),i}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,i){L(wj,"Starting transaction:",e);let r=new jf(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),i(r).next(s=>this.referenceDelegate.onTransactionCommitted(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}mutationQueuesContainKey(e,t){return y.or(Object.values(this.mutationQueues).map(i=>()=>i.containsKey(e,t)))}},jf=class extends Z8{constructor(e){super(),this.currentSequenceNumber=e}},y6=class n{constructor(e){this.persistence=e,this.localViewReferences=new a2,this._orphanedDocuments=null}static factory(e){return new n(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw j()}addReference(e,t,i){return this.localViewReferences.addReference(i,t),this.orphanedDocuments.delete(i.toString()),y.resolve()}removeReference(e,t,i){return this.localViewReferences.removeReference(i,t),this.orphanedDocuments.add(i.toString()),y.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),y.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(s=>this.orphanedDocuments.add(s.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.orphanedDocuments.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return y.forEach(this.orphanedDocuments,r=>{let s=B.fromPath(r);return this.isReferenced(e,s).next(o=>{o||i.removeEntry(s,ne.min())})}).next(()=>(this._orphanedDocuments=null,i.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(i=>{i?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return y.or([()=>y.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}};var Wf=class{constructor(e){this.serializer=e}createOrUpgrade(e,t,i,r){let s=new J8("createOrUpgrade",t);i<1&&r>=1&&(Cj(e),_j(e),AS(e),Tj(e));let o=y.resolve();return i<3&&r>=3&&(i!==0&&(zj(e),AS(e)),o=o.next(()=>Oj(s))),i<4&&r>=4&&(i!==0&&(o=o.next(()=>Sj(e,s))),o=o.next(()=>{Ij(e)})),i<5&&r>=5&&(o=o.next(()=>this.removeAcknowledgedMutations(s))),i<6&&r>=6&&(o=o.next(()=>(Mj(e),this.addDocumentGlobal(s)))),i<7&&r>=7&&(o=o.next(()=>this.ensureSequenceNumbers(s))),i<8&&r>=8&&(o=o.next(()=>this.createCollectionParentIndex(e,s))),i<9&&r>=9&&(o=o.next(()=>{xj(e)})),i<10&&r>=10&&(o=o.next(()=>this.rewriteCanonicalIds(s))),i<11&&r>=11&&(o=o.next(()=>{Aj(e),Dj(e)})),i<12&&r>=12&&(o=o.next(()=>{Rj(e)})),i<13&&r>=13&&(o=o.next(()=>Ej(e)).next(()=>this.rewriteRemoteDocumentCache(e,s)).next(()=>e.deleteObjectStore(So))),i<14&&r>=14&&(o=o.next(()=>this.runOverlayMigration(e,s))),i<15&&r>=15&&(o=o.next(()=>kj(e))),i<16&&r>=16&&(o=o.next(()=>{t.objectStore(j6).clear()}).next(()=>{t.objectStore(W6).clear()})),o}addDocumentGlobal(e){let t=0;return e.store(So).iterate((i,r)=>{t+=f6(r)}).next(()=>{let i={byteSize:t};return e.store(y2).put(K7,i)})}removeAcknowledgedMutations(e){let t=e.store(v2),i=e.store(Mi);return t.loadAll().next(r=>y.forEach(r,s=>{let o=IDBKeyRange.bound([s.userId,ks],[s.userId,s.lastAcknowledgedBatchId]);return i.loadAll(zo,o).next(a=>y.forEach(a,c=>{J(c.userId===s.userId);let l=To(this.serializer,c);return pE(e,s.userId,l).next(()=>{})}))}))}ensureSequenceNumbers(e){let t=e.store(J1),i=e.store(So);return e.store(Wo).get(e6).next(s=>{let o=c=>t.put({targetId:0,path:gn(c),sequenceNumber:s.highestListenSequenceNumber}),a=[];return i.iterate((c,l)=>{let u=new Te(c),h=bj(u);a.push(t.get(h).next(d=>d?y.resolve():o(u)))}).next(()=>y.waitFor(a))})}createCollectionParentIndex(e,t){e.createObjectStore(G4,{keyPath:LB});let i=t.store(G4),r=new o2,s=o=>{if(r.add(o)){let a=o.lastSegment(),c=o.popLast();return i.put({collectionId:a,parent:gn(c)})}};return t.store(So).iterate({keysOnly:!0},(o,a)=>{let c=new Te(o);return s(c.popLast())}).next(()=>t.store(X1).iterate({keysOnly:!0},([o,a,c],l)=>{let u=ar(a);return s(u.popLast())}))}rewriteCanonicalIds(e){let t=e.store(Z1);return t.iterate((i,r)=>{let s=P4(r),o=hE(this.serializer,s);return t.put(o)})}rewriteRemoteDocumentCache(e,t){let i=t.store(So),r=[];return i.iterate((s,o)=>{let a=t.store(F6),c=Lj(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(l))}).next(()=>y.waitFor(r))}runOverlayMigration(e,t){let i=t.store(Mi),r=wE(this.serializer),s=new v6(y6.factory,this.serializer.remoteSerializer);return i.loadAll().next(o=>{let a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:he();To(this.serializer,c).keys().forEach(d=>u=u.add(d)),a.set(c.userId,u)}),y.forEach(a,(c,l)=>{let u=new It(l),h=u6.forUser(this.serializer,u),d=s.getIndexManager(u),m=m6.forUser(u,this.serializer,d,s.referenceDelegate);return new g6(r,m,h,d).recalculateAndSaveOverlaysForDocumentKeys(new $4(t,Fn.INVALID),c).next()})})}};function bj(n){return[0,gn(n)]}function Cj(n){n.createObjectStore(g2)}function _j(n){n.createObjectStore(v2,{keyPath:EB}),n.createObjectStore(Mi,{keyPath:iT,autoIncrement:!0}).createIndex(zo,rT,{unique:!0}),n.createObjectStore(X1)}function Sj(n,e){return e.store(Mi).loadAll().next(i=>{n.deleteObjectStore(Mi),n.createObjectStore(Mi,{keyPath:iT,autoIncrement:!0}).createIndex(zo,rT,{unique:!0});let s=e.store(Mi),o=i.map(a=>s.put(a));return y.waitFor(o)})}function Tj(n){n.createObjectStore(So)}function Ej(n){let e=n.createObjectStore(F6,{keyPath:xB});e.createIndex(j8,OB),e.createIndex(oT,IB)}function Mj(n){n.createObjectStore(y2)}function AS(n){n.createObjectStore(J1,{keyPath:kB}).createIndex(B9,RB,{unique:!0}),n.createObjectStore(Z1,{keyPath:AB}).createIndex(aT,DB,{unique:!0}),n.createObjectStore(Wo)}function zj(n){n.deleteObjectStore(J1),n.deleteObjectStore(Z1),n.deleteObjectStore(Wo)}function xj(n){n.objectStoreNames.contains("remoteDocumentChanges")&&n.deleteObjectStore("remoteDocumentChanges")}function Oj(n){let e=n.store(Wo),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ne.min().toTimestamp(),targetCount:0};return e.put(e6,t)}function Ij(n){n.createObjectStore(R1,{keyPath:VB})}function Aj(n){n.createObjectStore(q6,{keyPath:NB})}function Dj(n){n.createObjectStore(U6,{keyPath:PB})}function kj(n){n.createObjectStore(F9,{keyPath:HB,autoIncrement:!0}).createIndex(Q7,BB,{unique:!1}),n.createObjectStore(j6,{keyPath:FB}).createIndex(cT,qB,{unique:!1}),n.createObjectStore(W6,{keyPath:UB}).createIndex(lT,jB,{unique:!1})}function Rj(n){let e=n.createObjectStore(G6,{keyPath:WB});e.createIndex(X7,GB,{unique:!1}),e.createIndex(uT,$B,{unique:!1})}function Lj(n){return n.document?new B(Te.fromString(n.document.name).popFirst(5)):n.noDocument?B.fromSegments(n.noDocument.path):n.unknownDocument?B.fromSegments(n.unknownDocument.path):j()}var Os="IndexedDbPersistence",I7=30*60*1e3,A7=5e3,Vj=4e3,D7="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Nj="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",Pj="firestore_zombie",bE="main",Gf=class n{constructor(e,t,i,r,s,o,a,c,l,u,h=gj){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.queue=s,this.window=o,this.document=a,this.sequenceNumberSyncer=l,this.forceOwningTab=u,this.schemaVersion=h,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=d=>Promise.resolve(),!n.isAvailable())throw new O(b.UNIMPLEMENTED,Nj);this.referenceDelegate=new Rf(this,r),this.dbName=t+bE,this.serializer=new l6(c),this.simpleDb=new kr(this.dbName,this.schemaVersion,new Wf(this.serializer)),this.targetCache=new If(this.referenceDelegate,this.serializer),this.remoteDocumentCache=wE(this.serializer),this.bundleCache=new Sf,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,u===!1&&ht(Os,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new O(b.FAILED_PRECONDITION,D7);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.targetCache.getHighestSequenceNumber(e))}).then(e=>{this.listenSequence=new Fn(e,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(e=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(e)))}setPrimaryStateListener(e){return this.primaryStateListener=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.simpleDb.setVersionChangeListener(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.updateClientMetadataAndTryBecomePrimary())})))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>F8(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(e).next(i=>{i||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(e)).next(i=>this.isPrimary&&!i?this.releasePrimaryLeaseIfHeld(e).next(()=>!1):i?this.acquireOrExtendPrimaryLease(e).next(()=>!0):!1)).catch(e=>{if(Ws(e))return L(Os,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return L(Os,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.queue.enqueueRetryable(()=>this.primaryStateListener(e)),this.isPrimary=e})}verifyPrimaryLease(e){return V4(e).get(v1).next(i=>y.resolve(this.isLocalClient(i)))}removeClientMetadata(e){return F8(e).delete(this.clientId)}maybeGarbageCollectMultiClientState(){return g(this,null,function*(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,I7)){this.lastGarbageCollectionTime=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let i=Wt(t,R1);return i.loadAll().next(r=>{let s=this.filterActiveClients(r,I7),o=r.filter(a=>s.indexOf(a)===-1);return y.forEach(o,a=>i.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.webStorage)for(let t of e)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(t.clientId))}})}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",Vj,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(e){return e?e.ownerId===this.clientId:!1}canActAsPrimary(e){return this.forceOwningTab?y.resolve(!0):V4(e).get(v1).next(i=>{if(i!==null&&this.isWithinAge(i.leaseTimestampMs,A7)&&!this.isClientZombied(i.ownerId)){if(this.isLocalClient(i)&&this.networkEnabled)return!0;if(!this.isLocalClient(i)){if(!i.allowTabSynchronization)throw new O(b.FAILED_PRECONDITION,D7);return!1}}return this.networkEnabled&&this.inForeground?!0:F8(e).loadAll().next(s=>this.filterActiveClients(s,A7).find(a=>{if(this.clientId!==a.clientId){let c=!this.networkEnabled&&a.networkEnabled,l=!this.inForeground&&a.inForeground,u=this.networkEnabled===a.networkEnabled;if(c||l&&u)return!0}return!1})===void 0)}).next(i=>(this.isPrimary!==i&&L(Os,`Client ${i?"is":"is not"} eligible for a primary lease.`),i))}shutdown(){return g(this,null,function*(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),yield this.simpleDb.runTransaction("shutdown","readwrite",[g2,R1],e=>{let t=new $4(e,Fn.INVALID);return this.releasePrimaryLeaseIfHeld(t).next(()=>this.removeClientMetadata(t))}),this.simpleDb.close(),this.removeClientZombiedEntry()})}filterActiveClients(e,t){return e.filter(i=>this.isWithinAge(i.updateTimeMs,t)&&!this.isClientZombied(i.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",e=>F8(e).loadAll().next(t=>this.filterActiveClients(t,I7).map(i=>i.clientId)))}get started(){return this._started}getMutationQueue(e,t){return m6.forUser(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Of(e,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(e){return u6.forUser(this.serializer,e)}getBundleCache(){return this.bundleCache}runTransaction(e,t,i){L(Os,"Starting transaction:",e);let r=t==="readonly"?"readonly":"readwrite",s=tF(this.schemaVersion),o;return this.simpleDb.runTransaction(e,r,s,a=>(o=new $4(a,this.listenSequence?this.listenSequence.next():Fn.INVALID),t==="readwrite-primary"?this.verifyPrimaryLease(o).next(c=>c?!0:this.canActAsPrimary(o)).next(c=>{if(!c)throw ht(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new O(b.FAILED_PRECONDITION,eT);return i(o)}).next(c=>this.acquireOrExtendPrimaryLease(o).next(()=>c)):this.verifyAllowTabSynchronization(o).next(()=>i(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}verifyAllowTabSynchronization(e){return V4(e).get(v1).next(i=>{if(i!==null&&this.isWithinAge(i.leaseTimestampMs,A7)&&!this.isClientZombied(i.ownerId)&&!this.isLocalClient(i)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!i.allowTabSynchronization))throw new O(b.FAILED_PRECONDITION,D7)})}acquireOrExtendPrimaryLease(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return V4(e).put(v1,t)}static isAvailable(){return kr.isAvailable()}releasePrimaryLeaseIfHeld(e){let t=V4(e);return t.get(v1).next(i=>this.isLocalClient(i)?(L(Os,"Releasing primary lease."),t.delete(v1)):y.resolve())}isWithinAge(e,t){let i=Date.now(),r=i-t,s=i;return e<r?!1:e>s?(ht(`Detected an update time that is in the future: ${e} > ${s}`),!1):!0}attachVisibilityHandler(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground=this.document.visibilityState==="visible")}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.windowUnloadHandler=()=>{this.markClientZombied();let t=/(?:Version|Mobile)\/1[456]/;yu()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(e){var t;try{let i=((t=this.webStorage)===null||t===void 0?void 0:t.getItem(this.zombiedClientLocalStorageKey(e)))!==null;return L(Os,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return ht(Os,"Failed to get zombied client id.",i),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){ht("Failed to set zombie client id.",e)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch{}}zombiedClientLocalStorageKey(e){return`${Pj}_${this.persistenceKey}_${e}`}};function V4(n){return Wt(n,g2)}function F8(n){return Wt(n,R1)}function J9(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}function Hj(n){return g(this,null,function*(){if(!kr.isAvailable())return Promise.resolve();let e=n+bE;yield kr.delete(e)})}var em="LocalStore",Bj=5*60*1e6,c2=class{constructor(e,t,i,r){this.persistence=e,this.queryEngine=t,this.serializer=r,this.targetDataByTarget=new nt(ue),this.targetIdByTarget=new dr(s=>Vo(s),b2),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(i)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new g6(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}};function CE(n,e,t,i){return new c2(n,e,t,i)}function _E(n,e){return g(this,null,function*(){let t=F(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,t.initializeUserComponents(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],c=[],l=he();for(let u of s){a.push(u.batchId);for(let h of u.mutations)l=l.add(h.key)}for(let u of o){c.push(u.batchId);for(let h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next(u=>({affectedDocuments:u,removedBatchIds:a,addedBatchIds:c}))})})})}function Fj(n,e){let t=F(n),i=dt.now(),r=e.reduce((a,c)=>a.add(c.key),he()),s,o;return t.persistence.runTransaction("Locally write mutations","readwrite",a=>{let c=xn(),l=he();return t.remoteDocuments.getEntries(a,r).next(u=>{c=u,c.forEach((h,d)=>{d.isValidDocument()||(l=l.add(h))})}).next(()=>t.localDocuments.getOverlayedDocuments(a,c)).next(u=>{s=u;let h=[];for(let d of e){let m=bq(d,s.get(d.key).overlayedDocument);m!=null&&h.push(new Oi(d.key,m,TT(m.value.mapValue),gt.exists(!0)))}return t.mutationQueue.addMutationBatch(a,i,h,e)}).next(u=>{o=u;let h=u.applyToLocalDocumentSet(s,l);return t.documentOverlayCache.saveOverlays(a,u.batchId,h)})}).then(()=>({batchId:o.batchId,changes:PT(s)}))}function qj(n,e){let t=F(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return Zj(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,Uj(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function Uj(n){let e=he();for(let t=0;t<n.mutationResults.length;++t)n.mutationResults[t].transformResults.length>0&&(e=e.add(n.batch.mutations[t].key));return e}function jj(n,e){let t=F(n);return t.persistence.runTransaction("Reject batch","readwrite-primary",i=>{let r;return t.mutationQueue.lookupMutationBatch(i,e).next(s=>(J(s!==null),r=s.keys(),t.mutationQueue.removeMutationBatch(i,s))).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,r)).next(()=>t.localDocuments.getDocuments(i,r))})}function Wj(n){let e=F(n);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",t=>e.mutationQueue.getHighestUnacknowledgedBatchId(t))}function SE(n){let e=F(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.targetCache.getLastRemoteSnapshotVersion(t))}function Gj(n,e){let t=F(n),i=e.snapshotVersion,r=t.targetDataByTarget;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});r=t.targetDataByTarget;let a=[];e.targetChanges.forEach((u,h)=>{let d=r.get(h);if(!d)return;a.push(t.targetCache.removeMatchingKeys(s,u.removedDocuments,h).next(()=>t.targetCache.addMatchingKeys(s,u.addedDocuments,h)));let m=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(jt.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,i)),r=r.insert(h,m),$j(d,m,u)&&a.push(t.targetCache.updateTargetData(s,m))});let c=xn(),l=he();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(TE(s,o,e.documentUpdates).next(u=>{c=u.changedDocuments,l=u.existenceChangedKeys})),!i.isEqual(ne.min())){let u=t.targetCache.getLastRemoteSnapshotVersion(s).next(h=>t.targetCache.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(u)}return y.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.targetDataByTarget=r,s))}function TE(n,e,t){let i=he(),r=he();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=xn();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(ne.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):L(em,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{changedDocuments:o,existenceChangedKeys:r}})}function $j(n,e,t){return n.resumeToken.approximateByteSize()===0||e.snapshotVersion.toMicroseconds()-n.snapshotVersion.toMicroseconds()>=Bj?!0:t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size>0}function Yj(n,e){return g(this,null,function*(){let t=F(n);try{yield t.persistence.runTransaction("notifyLocalViewChanges","readwrite",i=>y.forEach(e,r=>y.forEach(r.addedKeys,s=>t.persistence.referenceDelegate.addReference(i,r.targetId,s)).next(()=>y.forEach(r.removedKeys,s=>t.persistence.referenceDelegate.removeReference(i,r.targetId,s)))))}catch(i){if(Ws(i))L(em,"Failed to update sequence numbers: "+i);else throw i}for(let i of e){let r=i.targetId;if(!i.fromCache){let s=t.targetDataByTarget.get(r),o=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(o);t.targetDataByTarget=t.targetDataByTarget.insert(r,a)}}})}function Kj(n,e){let t=F(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=ks),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Qj(n,e){let t=F(n);return t.persistence.runTransaction("read document","readonly",i=>t.localDocuments.getDocument(i,e))}function U1(n,e){let t=F(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.targetCache.getTargetData(i,e).next(s=>s?(r=s,y.resolve(r)):t.targetCache.allocateTargetId(i).next(o=>(r=new F1(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.targetCache.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.targetDataByTarget.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.targetDataByTarget=t.targetDataByTarget.insert(i.targetId,i),t.targetIdByTarget.set(e,i.targetId)),i})}function Xj(n,e,t){let i=F(n),r=i.targetIdByTarget.get(t);return r!==void 0?y.resolve(i.targetDataByTarget.get(r)):i.targetCache.getTargetData(e,t)}function j1(n,e,t){return g(this,null,function*(){let i=F(n),r=i.targetDataByTarget.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(Ws(o))L(em,`Failed to update sequence numbers for target ${e}: ${o}`);else throw o}i.targetDataByTarget=i.targetDataByTarget.remove(e),i.targetIdByTarget.delete(r.target)})}function X6(n,e,t){let i=F(n),r=ne.min(),s=he();return i.persistence.runTransaction("Execute query","readwrite",o=>Xj(i,o,vn(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.targetCache.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>i.queryEngine.getDocumentsMatchingQuery(o,e,t?r:ne.min(),t?s:he())).next(a=>(zE(i,LT(e),a),{documents:a,remoteKeys:s})))}function Zj(n,e,t,i){let r=t.batch,s=r.keys(),o=y.resolve();return s.forEach(a=>{o=o.next(()=>i.getEntry(e,a)).next(c=>{let l=t.docVersions.get(a);J(l!==null),c.version.compareTo(l)<0&&(r.applyToRemoteDocument(c,t),c.isValidDocument()&&(c.setReadTime(t.commitVersion),i.addEntry(c)))})}),o.next(()=>n.mutationQueue.removeMutationBatch(e,r))}function Jj(n,e){let t=F(n),i=F(t.mutationQueue);return t.persistence.runTransaction("Lookup mutation documents","readonly",r=>i.lookupMutationKeys(r,e).next(s=>s?t.localDocuments.getDocuments(r,s):y.resolve(null)))}function eW(n,e){F(F(n,c2).mutationQueue).removeCachedMutationKeys(e)}function tW(n){return F(F(n,c2).persistence).getActiveClients()}function EE(n,e){let t=F(n),i=F(t.targetCache),r=t.targetDataByTarget.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.getTargetDataForTarget(s,e).next(o=>o?o.target:null))}function ME(n,e){let t=F(n),i=t.collectionGroupReadTime.get(e)||ne.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.remoteDocuments.getAllFromCollectionGroup(r,e,ZS(i,k1),Number.MAX_SAFE_INTEGER)).then(r=>(zE(t,e,r),r))}function zE(n,e,t){let i=n.collectionGroupReadTime.get(e)||ne.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.collectionGroupReadTime.set(e,i)}function nW(n){return vn(ec(Te.fromString(`__bundle__/docs/${n}`)))}function iW(n,e,t,i){return g(this,null,function*(){let r=F(n),s=he(),o=xn();for(let l of t){let u=e.toDocumentKey(l.metadata.name);l.document&&(s=s.add(u));let h=e.toMutableDocument(l);h.setReadTime(e.toSnapshotVersion(l.metadata.readTime)),o=o.insert(u,h)}let a=r.remoteDocuments.newChangeBuffer({trackRemovals:!0}),c=yield U1(r,nW(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",l=>TE(l,a,o).next(u=>(a.apply(l),u)).next(u=>r.targetCache.removeMatchingKeysForTargetId(l,c.targetId).next(()=>r.targetCache.addMatchingKeys(l,s,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(l,u.changedDocuments,u.existenceChangedKeys)).next(()=>u.changedDocuments)))})}function rW(n,e){let t=F(n),i=Tt(e.createTime);return t.persistence.runTransaction("hasNewerBundle","readonly",r=>t.bundleCache.getBundleMetadata(r,e.id)).then(r=>!!r&&r.createTime.compareTo(i)>=0)}function sW(n,e){let t=F(n);return t.persistence.runTransaction("Save bundle","readwrite",i=>t.bundleCache.saveBundleMetadata(i,e))}function oW(n,e){let t=F(n);return t.persistence.runTransaction("Get named query","readonly",i=>t.bundleCache.getNamedQuery(i,e))}function aW(i,r){return g(this,arguments,function*(n,e,t=he()){let s=yield U1(n,vn(K9(e.bundledQuery))),o=F(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Tt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.bundleCache.saveNamedQuery(a,e);let l=s.withResumeToken(jt.EMPTY_BYTE_STRING,c);return o.targetDataByTarget=o.targetDataByTarget.insert(l.targetId,l),o.targetCache.updateTargetData(a,l).next(()=>o.targetCache.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.targetCache.addMatchingKeys(a,t,s.targetId)).next(()=>o.bundleCache.saveNamedQuery(a,e))})})}var $f=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var cW=100;function lW(){return yu()?8:kr.getAndroidVersion(xc())>0?6:4}var w6=class{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=cW,this.relativeIndexReadCostPerDocument=lW()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.performQueryUsingIndex(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.performQueryUsingRemoteKeys(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new $f;return this.executeFullCollectionScan(e,t,o).next(a=>{if(s.result=a,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,o,a.size)})}).next(()=>s.result)}createCacheIndexes(e,t,i,r){return i.documentReadCount<this.indexAutoCreationMinCollectionSize?(T1()<=Bi.DEBUG&&L("QueryEngine","SDK will not create cache indexes for query:",E1(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),y.resolve()):(T1()<=Bi.DEBUG&&L("QueryEngine","Query:",E1(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.relativeIndexReadCostPerDocument*r?(T1()<=Bi.DEBUG&&L("QueryEngine","The SDK decides to create cache indexes for query:",E1(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vn(t))):y.resolve())}performQueryUsingIndex(e,t){if(Z_(t))return y.resolve(null);let i=vn(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=s6(t,null,"F"),i=vn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let o=he(...s);return this.localDocumentsView.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(c=>{let l=this.applyQuery(t,a);return this.needsRefill(t,l,o,c.readTime)?this.performQueryUsingIndex(e,s6(t,null,"F")):this.appendRemainingResults(e,l,t,c)}))})))}performQueryUsingRemoteKeys(e,t,i,r){return Z_(t)||r.isEqual(ne.min())?y.resolve(null):this.localDocumentsView.getDocuments(e,i).next(s=>{let o=this.applyQuery(t,s);return this.needsRefill(t,o,i,r)?y.resolve(null):(T1()<=Bi.DEBUG&&L("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),E1(t)),this.appendRemainingResults(e,o,t,ZS(r,k1)).next(a=>a))})}applyQuery(e,t){let i=new We(VT(e));return t.forEach((r,s)=>{_2(e,s)&&(i=i.add(s))}),i}needsRefill(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return s?s.hasPendingWrites||s.version.compareTo(r)>0:!1}executeFullCollectionScan(e,t,i){return T1()<=Bi.DEBUG&&L("QueryEngine","Using full collection scan to execute query:",E1(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,ci.min(),i)}appendRemainingResults(e,t,i,r){return this.localDocumentsView.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var xE="firestore_clients";function DS(n,e){return`${xE}_${n}_${e}`}var OE="firestore_mutations";function kS(n,e,t){let i=`${OE}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}var IE="firestore_targets";function k7(n,e){return`${IE}_${n}_${e}`}var uW="firestore_online_state";function hW(n){return`${uW}_${n}`}var dW="firestore_bundle_loaded_v2";function fW(n){return`${dW}_${n}`}var mW="firestore_sequence_number";function pW(n){return`${mW}_${n}`}var or="SharedClientState",b6=class n{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static fromWebStorageEntry(e,t,i){let r=JSON.parse(i),s=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object"),o;return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(o=new O(r.error.code,r.error.message))),s?new n(e,t,r.state,o):(ht(or,`Failed to parse mutation state for ID '${t}': ${i}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},U4=class n{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static fromWebStorageEntry(e,t){let i=JSON.parse(t),r=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object"),s;return r&&i.error&&(r=typeof i.error.message=="string"&&typeof i.error.code=="string",r&&(s=new O(i.error.code,i.error.message))),r?new n(e,i.state,s):(ht(or,`Failed to parse target state for ID '${e}': ${t}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},C6=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static fromWebStorageEntry(e,t){let i=JSON.parse(t),r=typeof i=="object"&&i.activeTargetIds instanceof Array,s=$9();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=CT(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new n(e,s):(ht(or,`Failed to parse client data for instance '${e}': ${t}`),null)}},Yf=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static fromWebStorageEntry(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ht(or,`Failed to parse online state: ${e}`),null)}},l2=class{constructor(){this.activeTargetIds=$9()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},j4=class{constructor(e,t,i,r,s){this.window=e,this.queue=t,this.persistenceKey=i,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new nt(ue),this.started=!1,this.earlyEvents=[];let o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.localClientStorageKey=DS(this.persistenceKey,this.localClientId),this.sequenceNumberKey=pW(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new l2),this.clientStateKeyRe=new RegExp(`^${xE}_${o}_([^_]*)$`),this.mutationBatchKeyRe=new RegExp(`^${OE}_${o}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=new RegExp(`^${IE}_${o}_(\\d+)$`),this.onlineStateKey=hW(this.persistenceKey),this.bundleLoadedKey=fW(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(e){return!!(e&&e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.getActiveClients();for(let i of e){if(i===this.localClientId)continue;let r=this.getItem(DS(this.persistenceKey,i));if(r){let s=C6.fromWebStorageEntry(i,r);s&&(this.activeClients=this.activeClients.insert(s.clientId,s))}}this.persistClientState();let t=this.storage.getItem(this.onlineStateKey);if(t){let i=this.fromWebStorageOnlineState(t);i&&this.handleOnlineStateEvent(i)}for(let i of this.earlyEvents)this.handleWebStorageEvent(i);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(e){let t=!1;return this.activeClients.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.persistMutationState(e,"pending")}updateMutationState(e,t,i){this.persistMutationState(e,t,i),this.removeMutationState(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(k7(this.persistenceKey,e));if(i){let r=U4.fromWebStorageEntry(e,i);r&&(t=r.state)}}return this.localClientState.addQueryTarget(e),this.persistClientState(),t}removeLocalQueryTarget(e){this.localClientState.removeQueryTarget(e),this.persistClientState()}isLocalQueryTarget(e){return this.localClientState.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(k7(this.persistenceKey,e))}updateQueryState(e,t,i){this.persistQueryTargetState(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.removeMutationState(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.persistOnlineState(e)}notifyBundleLoaded(e){this.persistBundleLoadedState(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return L(or,"READ",e,t),t}setItem(e,t){L(or,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){L(or,"REMOVE",e),this.storage.removeItem(e)}handleWebStorageEvent(e){let t=e;if(t.storageArea===this.storage){if(L(or,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey){ht("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(()=>g(this,null,function*(){if(!this.started){this.earlyEvents.push(t);return}if(t.key!==null){if(this.clientStateKeyRe.test(t.key))if(t.newValue!=null){let i=this.fromWebStorageClientState(t.key,t.newValue);if(i)return this.handleClientStateEvent(i.clientId,i)}else{let i=this.fromWebStorageClientStateKey(t.key);return this.handleClientStateEvent(i,null)}else if(this.mutationBatchKeyRe.test(t.key)){if(t.newValue!==null){let i=this.fromWebStorageMutationMetadata(t.key,t.newValue);if(i)return this.handleMutationBatchEvent(i)}}else if(this.queryTargetKeyRe.test(t.key)){if(t.newValue!==null){let i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue);if(i)return this.handleQueryTargetEvent(i)}}else if(t.key===this.onlineStateKey){if(t.newValue!==null){let i=this.fromWebStorageOnlineState(t.newValue);if(i)return this.handleOnlineStateEvent(i)}}else if(t.key===this.sequenceNumberKey){let i=gW(t.newValue);i!==Fn.INVALID&&this.sequenceNumberHandler(i)}else if(t.key===this.bundleLoadedKey){let i=this.fromWebStoreBundleLoadedState(t.newValue);yield Promise.all(i.map(r=>this.syncEngine.synchronizeWithChangedDocuments(r)))}}}))}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(e,t,i){let r=new b6(this.currentUser,e,t,i),s=kS(this.persistenceKey,this.currentUser,e);this.setItem(s,r.toWebStorageJSON())}removeMutationState(e){let t=kS(this.persistenceKey,this.currentUser,e);this.removeItem(t)}persistOnlineState(e){let t={clientId:this.localClientId,onlineState:e};this.storage.setItem(this.onlineStateKey,JSON.stringify(t))}persistQueryTargetState(e,t,i){let r=k7(this.persistenceKey,e),s=new U4(e,t,i);this.setItem(r,s.toWebStorageJSON())}persistBundleLoadedState(e){let t=JSON.stringify(Array.from(e));this.setItem(this.bundleLoadedKey,t)}fromWebStorageClientStateKey(e){let t=this.clientStateKeyRe.exec(e);return t?t[1]:null}fromWebStorageClientState(e,t){let i=this.fromWebStorageClientStateKey(e);return C6.fromWebStorageEntry(i,t)}fromWebStorageMutationMetadata(e,t){let i=this.mutationBatchKeyRe.exec(e),r=Number(i[1]),s=i[2]!==void 0?i[2]:null;return b6.fromWebStorageEntry(new It(s),r,t)}fromWebStorageQueryTargetMetadata(e,t){let i=this.queryTargetKeyRe.exec(e),r=Number(i[1]);return U4.fromWebStorageEntry(r,t)}fromWebStorageOnlineState(e){return Yf.fromWebStorageEntry(e)}fromWebStoreBundleLoadedState(e){return JSON.parse(e)}handleMutationBatchEvent(e){return g(this,null,function*(){if(e.user.uid!==this.currentUser.uid){L(or,`Ignoring mutation for non-active user ${e.user.uid}`);return}return this.syncEngine.applyBatchState(e.batchId,e.state,e.error)})}handleQueryTargetEvent(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)}handleClientStateEvent(e,t){let i=t?this.activeClients.insert(e,t):this.activeClients.remove(e),r=this.extractActiveQueryTargets(this.activeClients),s=this.extractActiveQueryTargets(i),o=[],a=[];return s.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.applyActiveTargetsChange(o,a).then(()=>{this.activeClients=i})}handleOnlineStateEvent(e){this.activeClients.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}extractActiveQueryTargets(e){let t=$9();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}};function gW(n){let e=Fn.INVALID;if(n!=null)try{let t=JSON.parse(n);J(typeof t=="number"),e=t}catch(t){ht(or,"Failed to read sequence number from WebStorage",t)}return e}var _6=class{constructor(){this.localState=new l2,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,i){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new l2,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Kf=class{addCallback(e){}shutdown(){}};var Qf=class{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}};var q8=null;function vW(){return 268435456+Math.round(2147483648*Math.random())}function R7(){return q8===null?q8=vW():q8++,"0x"+q8.toString(16)}function yW(n){return new Promise((e,t)=>{n((i,r)=>{i?t(i):e(r)})})}var wW="1.9.1",pn="GrpcConnection",bW=`gl-node/${process.versions.node} fire/${Q1} grpc/${wW}`;function L7(n,e,t,i){J(e===null||e.type==="OAuth");let r=new Io.Metadata;return e&&e.headers.forEach((s,o)=>r.set(o,s)),t&&t.headers.forEach((s,o)=>r.set(o,s)),i&&r.set("X-Firebase-GMPID",i),r.set("X-Goog-Api-Client",bW),r.set("Google-Cloud-Resource-Prefix",n),r.set("x-goog-request-params",n),r}var Xf=class{constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}get shouldResourcePathBeIncludedInRequest(){return!0}ensureActiveStub(){if(!this.cachedStub){L(pn,"Creating Firestore stub.");let e=this.databaseInfo.ssl?Io.credentials.createSsl():Io.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,i,r,s){let o=R7(),a=this.ensureActiveStub(),c=L7(this.databasePath,r,s,this.databaseInfo.appId),l=Object.assign({database:this.databasePath},i);return yW(u=>(L(pn,`RPC '${e}' ${o} invoked with request:`,i),a[e](l,c,(h,d)=>{h?(L(pn,`RPC '${e}' ${o} failed with error:`,h),u(new O($8(h.code),h.message))):(L(pn,`RPC '${e}' ${o} completed with response:`,d),u(void 0,d))})))}invokeStreamingRPC(e,t,i,r,s,o){let a=R7(),c=[],l=new St;L(pn,`RPC '${e}' ${a} invoked (streaming) with request:`,i);let u=this.ensureActiveStub(),h=L7(this.databasePath,r,s,this.databaseInfo.appId),d=Object.assign(Object.assign({},i),{database:this.databasePath}),m=u[e](d,h),p=!1;return m.on("data",v=>{L(pn,`RPC ${e} ${a} received result:`,v),c.push(v),o!==void 0&&c.length===o&&(p=!0,l.resolve(c))}),m.on("end",()=>{L(pn,`RPC '${e}' ${a} completed.`),p||(p=!0,l.resolve(c))}),m.on("error",v=>{L(pn,`RPC '${e}' ${a} failed with error:`,v);let w=$8(v.code);l.reject(new O(w,v.message))}),l.promise}openStream(e,t,i){let r=R7(),s=this.ensureActiveStub(),o=L7(this.databasePath,t,i,this.databaseInfo.appId),a=s[e](o),c=!1,l=h=>{c||(c=!0,u.callOnClose(h),a.end())},u=new Qf({sendFn:h=>{if(c)L(pn,`RPC '${e}' stream ${r} not sending because gRPC stream is closed:`,h);else{L(pn,`RPC '${e}' stream ${r} sending:`,h);try{a.write(h)}catch(d){throw ht("Failure sending:",h),ht("Error:",d),d}}},closeFn:()=>{L(pn,`RPC '${e}' stream ${r} closed locally via close().`),l()}});return a.on("data",h=>{c||(L(pn,`RPC '${e}' stream ${r} received:`,h),u.callOnMessage(h))}),a.on("end",()=>{L(pn,`RPC '${e}' stream ${r} ended.`),l()}),a.on("error",h=>{if(!c){ai(pn,`RPC '${e}' stream ${r} error. Code:`,h.code,"Message:",h.message);let d=$8(h.code);l(new O(d,h.message))}}),L(pn,`Opening RPC '${e}' stream ${r} to ${this.databaseInfo.host}`),setTimeout(()=>{u.callOnOpen()},0),u}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}},AE={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}},CW={nested:AE},_W=Object.freeze({__proto__:null,nested:AE,default:CW});var SW={longs:String,enums:String,defaults:!0,oneofs:!1};function TW(){let n=YS.fromJSON(_W,SW);return Io.loadPackageDefinition(n)}function EW(n){let e=TW();return new Xf(e,n)}function MW(){return new Kf}function DE(){return process.env.USE_MOCK_PERSISTENCE==="YES"?window:null}function zW(){return null}function T2(n){return new yf(n,!1)}var xW="ExponentialBackoff",OW=1e3,IW=1.5,AW=60*1e3,u2=class{constructor(e,t,i=OW,r=IW,s=AW){this.queue=e,this.timerId=t,this.initialDelayMs=i,this.backoffFactor=r,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),i=Math.max(0,Date.now()-this.lastAttemptTime),r=Math.max(0,t-i);r>0&&L(xW,`Backing off for ${r} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,r,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var RS="PersistentStream",DW=60*1e3,kW=10*1e3,S6=class{constructor(e,t,i,r,s,o,a,c){this.queue=e,this.idleTimerId=i,this.healthTimerId=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.backoff=new u2(e,t)}isStarted(){return this.state===1||this.state===5||this.isOpen()}isOpen(){return this.state===2||this.state===3}start(){if(this.state===4){this.performBackoff();return}this.auth()}stop(){return g(this,null,function*(){this.isStarted()&&(yield this.close(0))})}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&this.idleTimer===null&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,DW,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}handleIdleCloseTimer(){return g(this,null,function*(){if(this.isOpen())return this.close(0)})}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}close(e,t){return g(this,null,function*(){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,e!==4?this.backoff.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(ht(t.toString()),ht("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===b.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.onClose(t)})}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.closeCount===t&&this.startStream(i,r)},i=>{e(()=>{let r=new O(b.UNKNOWN,"Fetching auth token failed: "+i.message);return this.handleStreamClose(r)})})}startStream(e,t){let i=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onOpen(()=>{i(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,kW,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(r=>{i(()=>this.handleStreamClose(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(()=>g(this,null,function*(){this.state=0,this.start()}))}handleStreamClose(e){return L(RS,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(L(RS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Zf=class extends S6{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onMessage(e){this.backoff.reset();let t=Wq(this.serializer,e),i=$q(e);return this.listener.onWatchChange(t,i)}watch(e){let t={};t.database=Cf(this.serializer),t.addTarget=rU(this.serializer,e);let i=nU(this.serializer,e);i&&(t.labels=i),this.sendRequest(t)}unwatch(e){let t={};t.database=Cf(this.serializer),t.removeTarget=e,this.sendRequest(t)}},Jf=class extends S6{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s,this.handshakeComplete_=!1}get handshakeComplete(){return this.handshakeComplete_}start(){this.handshakeComplete_=!1,this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete_&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onMessage(e){if(J(!!e.streamToken),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();let t=Xq(e.writeResults,e.commitTime),i=Tt(e.commitTime);return this.listener.onMutationResult(i,t)}else return J(!e.writeResults||e.writeResults.length===0),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()}writeHandshake(){let e={};e.database=Cf(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>s2(this.serializer,i))};this.sendRequest(t)}};var e9=class{},t9=class extends e9{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new O(b.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,i,r){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.invokeRPC(e,bf(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new O(b.UNKNOWN,s.toString())})}invokeStreamingRPC(e,t,i,r,s){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.invokeStreamingRPC(e,bf(t,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new O(b.UNKNOWN,o.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}};function RW(n,e,t,i){return new t9(n,e,t,i)}function LW(n,e){return g(this,null,function*(){let t=F(n),i={writes:e.map(r=>s2(t.serializer,r))};yield t.invokeRPC("Commit",t.serializer.databaseId,Te.emptyPath(),i)})}function VW(n,e){return g(this,null,function*(){let t=F(n),i={documents:e.map(a=>r2(t.serializer,a))},r=yield t.invokeStreamingRPC("BatchGetDocuments",t.serializer.databaseId,Te.emptyPath(),i,e.length),s=new Map;r.forEach(a=>{let c=jq(t.serializer,a);s.set(c.key.toString(),c)});let o=[];return e.forEach(a=>{let c=s.get(a.toString());J(!!c),o.push(c)}),o})}function NW(n,e,t){let i=F(n);return i.verifyInitialized(),new Jf(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,t)}function PW(n,e,t){let i=F(n);return i.verifyInitialized(),new Zf(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,t)}var HW="OnlineStateTracker",LS=1,VS=10*1e3,n9=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){this.watchStreamFailures===0&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",VS,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${VS/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){this.state==="Online"?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=LS&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${LS} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e==="Online"&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(ht(t),this.shouldWarnClientIsOffline=!1):L(HW,t)}clearOnlineStateTimer(){this.onlineStateTimer!==null&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}};var Bo="RemoteStore",BW=10,i9=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=s,this.connectivityMonitor.addCallback(o=>{i.enqueueAndForget(()=>g(this,null,function*(){Gs(this)&&(L(Bo,"Restarting streams for network reachability change."),yield iG(this))}))}),this.onlineStateTracker=new n9(i,r)}};function FW(n,e,t,i,r){return new i9(n,e,t,i,r)}function qW(n){let e=F(n);return e.offlineCauses.delete(0),E2(e)}function E2(n){return g(this,null,function*(){if(Gs(n))for(let e of n.onNetworkStatusChange)yield e(!0)})}function UW(n){return g(this,null,function*(){let e=F(n);e.offlineCauses.add(0),yield tc(e),e.onlineStateTracker.set("Offline")})}function tc(n){return g(this,null,function*(){for(let e of n.onNetworkStatusChange)yield e(!1)})}function jW(n){return g(this,null,function*(){let e=F(n);L(Bo,"RemoteStore shutting down."),e.offlineCauses.add(5),yield tc(e),e.connectivityMonitor.shutdown(),e.onlineStateTracker.set("Unknown")})}function Z6(n,e){let t=F(n);t.listenTargets.has(e.targetId)||(t.listenTargets.set(e.targetId,e),im(t)?nm(t):rc(t).isOpen()&&tm(t,e))}function nc(n,e){let t=F(n),i=rc(t);t.listenTargets.delete(e),i.isOpen()&&kE(t,e),t.listenTargets.size===0&&(i.isOpen()?i.markIdle():Gs(t)&&t.onlineStateTracker.set("Unknown"))}function tm(n,e){if(n.watchChangeAggregator.recordPendingTargetRequest(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rc(n).watch(e)}function kE(n,e){n.watchChangeAggregator.recordPendingTargetRequest(e),rc(n).unwatch(e)}function nm(n){n.watchChangeAggregator=new vf({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),getTargetDataForTarget:e=>n.listenTargets.get(e)||null,getDatabaseId:()=>n.datastore.serializer.databaseId}),rc(n).start(),n.onlineStateTracker.handleWatchStreamStart()}function im(n){return Gs(n)&&!rc(n).isStarted()&&n.listenTargets.size>0}function Gs(n){return F(n).offlineCauses.size===0}function RE(n){n.watchChangeAggregator=void 0}function WW(n){return g(this,null,function*(){n.listenTargets.forEach((e,t)=>{tm(n,e)})})}function GW(n,e){return g(this,null,function*(){RE(n),im(n)?(n.onlineStateTracker.handleWatchStreamFailure(e),nm(n)):n.onlineStateTracker.set("Unknown")})}function $W(n,e,t){return g(this,null,function*(){if(n.onlineStateTracker.set("Online"),e instanceof a6&&e.state===2&&e.cause){try{yield KW(n,e)}catch(i){L(Bo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield T6(n,i)}return}if(e instanceof D1?n.watchChangeAggregator.handleDocumentChange(e):e instanceof o6?n.watchChangeAggregator.handleExistenceFilter(e):n.watchChangeAggregator.handleTargetChange(e),!t.isEqual(ne.min()))try{let i=yield SE(n.localStore);t.compareTo(i)>=0&&(yield YW(n,t))}catch(i){L(Bo,"Failed to raise snapshot:",i),yield T6(n,i)}})}function T6(n,e,t){return g(this,null,function*(){if(Ws(e))n.offlineCauses.add(1),yield tc(n),n.onlineStateTracker.set("Offline"),t||(t=()=>SE(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){L(Bo,"Retrying IndexedDB access"),yield t(),n.offlineCauses.delete(1),yield E2(n)}));else throw e})}function LE(n,e){return e().catch(t=>T6(n,t,e))}function YW(n,e){let t=n.watchChangeAggregator.createRemoteEvent(e);return t.targetChanges.forEach((i,r)=>{if(i.resumeToken.approximateByteSize()>0){let s=n.listenTargets.get(r);s&&n.listenTargets.set(r,s.withResumeToken(i.resumeToken,e))}}),t.targetMismatches.forEach((i,r)=>{let s=n.listenTargets.get(i);if(!s)return;n.listenTargets.set(i,s.withResumeToken(jt.EMPTY_BYTE_STRING,s.snapshotVersion)),kE(n,i);let o=new F1(s.target,i,r,s.sequenceNumber);tm(n,o)}),n.remoteSyncer.applyRemoteEvent(t)}function KW(n,e){return g(this,null,function*(){let t=e.cause;for(let i of e.targetIds)n.listenTargets.has(i)&&(yield n.remoteSyncer.rejectListen(i,t),n.listenTargets.delete(i),n.watchChangeAggregator.removeTarget(i))})}function ic(n){return g(this,null,function*(){let e=F(n),t=$s(e),i=e.writePipeline.length>0?e.writePipeline[e.writePipeline.length-1].batchId:ks;for(;QW(e);)try{let r=yield Kj(e.localStore,i);if(r===null){e.writePipeline.length===0&&t.markIdle();break}else i=r.batchId,XW(e,r)}catch(r){yield T6(e,r)}VE(e)&&NE(e)})}function QW(n){return Gs(n)&&n.writePipeline.length<BW}function XW(n,e){n.writePipeline.push(e);let t=$s(n);t.isOpen()&&t.handshakeComplete&&t.writeMutations(e.mutations)}function VE(n){return Gs(n)&&!$s(n).isStarted()&&n.writePipeline.length>0}function NE(n){$s(n).start()}function ZW(n){return g(this,null,function*(){$s(n).writeHandshake()})}function JW(n){return g(this,null,function*(){let e=$s(n);for(let t of n.writePipeline)e.writeMutations(t.mutations)})}function eG(n,e,t){return g(this,null,function*(){let i=n.writePipeline.shift(),r=ff.from(i,e,t);yield LE(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield ic(n)})}function tG(n,e){return g(this,null,function*(){e&&$s(n).handshakeComplete&&(yield nG(n,e)),VE(n)&&NE(n)})}function nG(n,e){return g(this,null,function*(){if(zq(e.code)){let t=n.writePipeline.shift();$s(n).inhibitBackoff(),yield LE(n,()=>n.remoteSyncer.rejectFailedWrite(t.batchId,e)),yield ic(n)}})}function iG(n){return g(this,null,function*(){let e=F(n);e.offlineCauses.add(4),yield tc(e),e.onlineStateTracker.set("Unknown"),e.offlineCauses.delete(4),yield E2(e)})}function NS(n,e){return g(this,null,function*(){let t=F(n);t.asyncQueue.verifyOperationInProgress(),L(Bo,"RemoteStore received new credentials");let i=Gs(t);t.offlineCauses.add(3),yield tc(t),i&&t.onlineStateTracker.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.offlineCauses.delete(3),yield E2(t)})}function r9(n,e){return g(this,null,function*(){let t=F(n);e?(t.offlineCauses.delete(2),yield E2(t)):e||(t.offlineCauses.add(2),yield tc(t),t.onlineStateTracker.set("Unknown"))})}function rc(n){return n.watchStream||(n.watchStream=PW(n.datastore,n.asyncQueue,{onOpen:WW.bind(null,n),onClose:GW.bind(null,n),onWatchChange:$W.bind(null,n)}),n.onNetworkStatusChange.push(e=>g(this,null,function*(){e?(n.watchStream.inhibitBackoff(),im(n)?nm(n):n.onlineStateTracker.set("Unknown")):(yield n.watchStream.stop(),RE(n))}))),n.watchStream}function $s(n){return n.writeStream||(n.writeStream=NW(n.datastore,n.asyncQueue,{onOpen:ZW.bind(null,n),onClose:tG.bind(null,n),onHandshakeComplete:JW.bind(null,n),onMutationResult:eG.bind(null,n)}),n.onNetworkStatusChange.push(e=>g(this,null,function*(){e?(n.writeStream.inhibitBackoff(),yield ic(n)):(yield n.writeStream.stop(),n.writePipeline.length>0&&(L(Bo,`Stopping write stream with ${n.writePipeline.length} pending writes`),n.writePipeline=[]))}))),n.writeStream}var rG="AsyncQueue",s9=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new St,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let o=Date.now()+i,a=new n(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new O(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function sc(n,e){if(ht(rG,`${e}: ${n}`),Ws(n))return new O(b.UNAVAILABLE,`${e}: ${n}`);throw n}var E6=class n{constructor(e){e?this.comparator=(t,i)=>e(t,i)||B.comparator(t.key,i.key):this.comparator=(t,i)=>B.comparator(t.key,i.key),this.keyedMap=N4(),this.sortedSet=new nt(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var M6=class{constructor(){this.changeMap=new nt(B.comparator)}track(e){let t=e.doc.key,i=this.changeMap.get(t);if(!i){this.changeMap=this.changeMap.insert(t,e);return}e.type!==0&&i.type===3?this.changeMap=this.changeMap.insert(t,e):e.type===3&&i.type!==1?this.changeMap=this.changeMap.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.changeMap=this.changeMap.remove(t):e.type===1&&i.type===2?this.changeMap=this.changeMap.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):j()}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,i)=>{e.push(i)}),e}},W1=class n{constructor(e,t,i,r,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,i,r,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,E6.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!C2(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var o9=class{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}};function sG(){return new a9}var a9=class{constructor(){this.queries=new dr(e=>RT(e),C2),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}};function rm(n,e){return g(this,null,function*(){let t=F(n),i=3,r=e.query,s=t.queries.get(r);s?!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(i=2):(s=new o9,i=e.listensToRemoteStore()?0:1);try{switch(i){case 0:s.viewSnap=yield t.onListen(r,!0);break;case 1:s.viewSnap=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r);break;default:break}}catch(o){let a=sc(o,`Initialization of query '${E1(e.query)}' failed`);e.onError(a);return}t.queries.set(r,s),s.listeners.push(e),e.applyOnlineStateChange(t.onlineState),s.viewSnap&&e.onViewSnapshot(s.viewSnap)&&om(t)})}function sm(n,e){return g(this,null,function*(){let t=F(n),i=e.query,r=3,s=t.queries.get(i);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),s.listeners.length===0?r=e.listensToRemoteStore()?0:1:!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function oG(n,e){let t=F(n),i=!1;for(let r of e){let s=r.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.onViewSnapshot(r)&&(i=!0);o.viewSnap=r}}i&&om(t)}function aG(n,e,t){let i=F(n),r=i.queries.get(e);if(r)for(let s of r.listeners)s.onError(t);i.queries.delete(e)}function cG(n,e){let t=F(n);t.onlineState=e;let i=!1;t.queries.forEach((r,s)=>{for(let o of s.listeners)o.applyOnlineStateChange(e)&&(i=!0)}),i&&om(t)}function lG(n,e){F(n).snapshotsInSyncListeners.add(e),e.next()}function uG(n,e){F(n).snapshotsInSyncListeners.delete(e)}function om(n){n.snapshotsInSyncListeners.forEach(e=>{e.next()})}var PE=function(n){return n.Default="default",n.Cache="cache",n}(PE||{}),h2=class{constructor(e,t,i){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=i||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new W1(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache||!this.listensToRemoteStore())return!0;let i=t!=="Offline";return this.options.waitForSyncWhenOnline&&i?!1:!e.docs.isEmpty()||e.hasCachedResults||t==="Offline"}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return e.syncStateChanged||t?this.options.includeMetadataChanges===!0:!1}raiseInitialEvent(e){e=W1.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==PE.Cache}};var c9=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.addedKeys=i,this.removedKeys=r}static fromSnapshot(e,t){let i=he(),r=he();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key);break}return new n(e,t.fromCache,i,r)}};var z6=class{constructor(e){this.serializer=e}toDocumentKey(e){return lr(this.serializer,e)}toMutableDocument(e){return e.metadata.exists?rE(this.serializer,e.document,!1):Ot.newNoDocument(this.toDocumentKey(e.metadata.name),this.toSnapshotVersion(e.metadata.readTime))}toSnapshotVersion(e){return Tt(e)}},l9=class{constructor(e,t,i){this.bundleMetadata=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=HE(e)}addSizedElement(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;let i=Te.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}getQueryDocumentMapping(e){let t=new Map,i=new z6(this.serializer);for(let r of e)if(r.metadata.queries){let s=i.toDocumentKey(r.metadata.name);for(let o of r.metadata.queries){let a=(t.get(o)||he()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield iW(this.localStore,new z6(this.serializer),this.documents,this.bundleMetadata.id),t=this.getQueryDocumentMapping(this.documents);for(let i of this.queries)yield aW(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:e}})}};function HE(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}function hG(n){return{taskState:"Success",documentsLoaded:n.totalDocuments,bytesLoaded:n.totalBytes,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var x6=class{constructor(e){this.key=e}},O6=class{constructor(e){this.key=e}},I6=class{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=he(),this.mutatedKeys=he(),this.docComparator=VT(e),this.documentSet=new E6(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let i=t?t.changeSet:new M6,r=t?t.documentSet:this.documentSet,s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1,c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{let d=r.get(u),m=_2(this.query,h)?h:null,p=d?this.mutatedKeys.has(d.key):!1,v=m?m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations:!1,w=!1;d&&m?d.data.isEqual(m.data)?p!==v&&(i.track({type:3,doc:m}),w=!0):this.shouldWaitForSyncedDocument(d,m)||(i.track({type:2,doc:m}),w=!0,(c&&this.docComparator(m,c)>0||l&&this.docComparator(m,l)<0)&&(a=!0)):!d&&m?(i.track({type:0,doc:m}),w=!0):d&&!m&&(i.track({type:1,doc:d}),w=!0,(c||l)&&(a=!0)),w&&(m?(o=o.add(m),v?s=s.add(u):s=s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{documentSet:o,changeSet:i,needsRefill:a,mutatedKeys:s}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let o=e.changeSet.getChanges();o.sort((h,d)=>dG(h.type,d.type)||this.docComparator(h.doc,d.doc)),this.applyTargetChange(i),r=r??!1;let a=t&&!r?this.updateLimboDocuments():[],l=this.limboDocuments.size===0&&this.current&&!r?1:0,u=l!==this.syncState;return this.syncState=l,o.length===0&&!u?{limboChanges:a}:{snapshot:new W1(this.query,e.documentSet,s,o,e.mutatedKeys,l===0,u,!1,i?i.resumeToken.approximateByteSize()>0:!1),limboChanges:a}}applyOnlineStateChange(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new M6,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!(this._syncedDocuments.has(e)||!this.documentSet.has(e)||this.documentSet.get(e).hasLocalMutations)}applyTargetChange(e){e&&(e.addedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.delete(t)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=he(),this.documentSet.forEach(i=>{this.shouldBeInLimbo(i.key)&&(this.limboDocuments=this.limboDocuments.add(i.key))});let t=[];return e.forEach(i=>{this.limboDocuments.has(i)||t.push(new O6(i))}),this.limboDocuments.forEach(i=>{e.has(i)||t.push(new x6(i))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=he();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return W1.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===0,this.hasCachedResults)}};function dG(n,e){let t=i=>{switch(i){case 0:return 1;case 2:return 2;case 3:return 2;case 1:return 0;default:return j()}};return t(n)-t(e)}var Ys="SyncEngine",u9=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},h9=class{constructor(e){this.key=e,this.receivedDocument=!1}},d9=class{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.syncEngineListener={},this.queryViewsByQuery=new dr(a=>RT(a),C2),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new nt(B.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new a2,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=q1.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return this._isPrimaryClient===!0}};function fG(n,e,t,i,r,s,o){let a=new d9(n,e,t,i,r,s);return o&&(a._isPrimaryClient=!0),a}function mG(n,e,t=!0){return g(this,null,function*(){let i=J6(n),r,s=i.queryViewsByQuery.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.computeInitialSnapshot()):r=yield BE(i,e,t,!0),r})}function pG(n,e){return g(this,null,function*(){let t=J6(n);yield BE(t,e,!0,!1)})}function BE(n,e,t,i){return g(this,null,function*(){let r=yield U1(n.localStore,vn(e)),s=r.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return i&&(a=yield am(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&Z6(n.remoteStore,r),a})}function am(n,e,t,i,r){return g(this,null,function*(){n.applyDocChanges=(h,d,m)=>MG(n,h,d,m);let s=yield X6(n.localStore,e,!0),o=new I6(e,s.remoteKeys),a=o.computeDocChanges(s.documents),c=i2.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),l=o.applyChanges(a,n.isPrimaryClient,c);um(n,t,l.limboChanges);let u=new u9(e,t,o);return n.queryViewsByQuery.set(e,u),n.queriesByTarget.has(t)?n.queriesByTarget.get(t).push(e):n.queriesByTarget.set(t,[e]),l.snapshot})}function gG(n,e,t){return g(this,null,function*(){let i=F(n),r=i.queryViewsByQuery.get(e),s=i.queriesByTarget.get(r.targetId);if(s.length>1){i.queriesByTarget.set(r.targetId,s.filter(o=>!C2(o,e))),i.queryViewsByQuery.delete(e);return}i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield j1(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&nc(i.remoteStore,r.targetId),G1(i,r.targetId)}).catch(js))):(G1(i,r.targetId),yield j1(i.localStore,r.targetId,!0))})}function vG(n,e){return g(this,null,function*(){let t=F(n),i=t.queryViewsByQuery.get(e),r=t.queriesByTarget.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),nc(t.remoteStore,i.targetId))})}function yG(n,e,t){return g(this,null,function*(){let i=dm(n);try{let r=yield Fj(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),TG(i,r.batchId,t),yield Br(i,r.changes),yield ic(i.remoteStore)}catch(r){let s=sc(r,"Failed to persist write");t.reject(s)}})}function FE(n,e){return g(this,null,function*(){let t=F(n);try{let i=yield Gj(t.localStore,e);e.targetChanges.forEach((r,s)=>{let o=t.activeLimboResolutionsByTarget.get(s);o&&(J(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.receivedDocument=!0:r.modifiedDocuments.size>0?J(o.receivedDocument):r.removedDocuments.size>0&&(J(o.receivedDocument),o.receivedDocument=!1))}),yield Br(t,i,e)}catch(i){yield js(i)}})}function PS(n,e,t){let i=F(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.queryViewsByQuery.forEach((s,o)=>{let a=o.view.applyOnlineStateChange(e);a.snapshot&&r.push(a.snapshot)}),cG(i.eventManager,e),r.length&&i.syncEngineListener.onWatchChange(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function wG(n,e,t){return g(this,null,function*(){let i=F(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.activeLimboResolutionsByTarget.get(e),s=r&&r.key;if(s){let o=new nt(B.comparator);o=o.insert(s,Ot.newNoDocument(s,ne.min()));let a=he().add(s),c=new n2(ne.min(),new Map,new nt(ue),o,a);yield FE(i,c),i.activeLimboTargetsByKey=i.activeLimboTargetsByKey.remove(s),i.activeLimboResolutionsByTarget.delete(e),hm(i)}else yield j1(i.localStore,e,!1).then(()=>G1(i,e,t)).catch(js)})}function bG(n,e){return g(this,null,function*(){let t=F(n),i=e.batch.batchId;try{let r=yield qj(t.localStore,e);lm(t,i,null),cm(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield Br(t,r)}catch(r){yield js(r)}})}function CG(n,e,t){return g(this,null,function*(){let i=F(n);try{let r=yield jj(i.localStore,e);lm(i,e,t),cm(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield Br(i,r)}catch(r){yield js(r)}})}function _G(n,e){return g(this,null,function*(){let t=F(n);Gs(t.remoteStore)||L(Ys,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let i=yield Wj(t.localStore);if(i===ks){e.resolve();return}let r=t.pendingWritesCallbacks.get(i)||[];r.push(e),t.pendingWritesCallbacks.set(i,r)}catch(i){let r=sc(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}})}function cm(n,e){(n.pendingWritesCallbacks.get(e)||[]).forEach(t=>{t.resolve()}),n.pendingWritesCallbacks.delete(e)}function SG(n,e){n.pendingWritesCallbacks.forEach(t=>{t.forEach(i=>{i.reject(new O(b.CANCELLED,e))})}),n.pendingWritesCallbacks.clear()}function TG(n,e,t){let i=n.mutationUserCallbacks[n.currentUser.toKey()];i||(i=new nt(ue)),i=i.insert(e,t),n.mutationUserCallbacks[n.currentUser.toKey()]=i}function lm(n,e,t){let i=F(n),r=i.mutationUserCallbacks[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.mutationUserCallbacks[i.currentUser.toKey()]=r}}function G1(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.queriesByTarget.get(e))n.queryViewsByQuery.delete(i),t&&n.syncEngineListener.onWatchError(i,t);n.queriesByTarget.delete(e),n.isPrimaryClient&&n.limboDocumentRefs.removeReferencesForId(e).forEach(r=>{n.limboDocumentRefs.containsKey(r)||qE(n,r)})}function qE(n,e){n.enqueuedLimboResolutions.delete(e.path.canonicalString());let t=n.activeLimboTargetsByKey.get(e);t!==null&&(nc(n.remoteStore,t),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(e),n.activeLimboResolutionsByTarget.delete(t),hm(n))}function um(n,e,t){for(let i of t)i instanceof x6?(n.limboDocumentRefs.addReference(i.key,e),EG(n,i)):i instanceof O6?(L(Ys,"Document no longer in limbo: "+i.key),n.limboDocumentRefs.removeReference(i.key,e),n.limboDocumentRefs.containsKey(i.key)||qE(n,i.key)):j()}function EG(n,e){let t=e.key,i=t.path.canonicalString();!n.activeLimboTargetsByKey.get(t)&&!n.enqueuedLimboResolutions.has(i)&&(L(Ys,"New document in limbo: "+t),n.enqueuedLimboResolutions.add(i),hm(n))}function hm(n){for(;n.enqueuedLimboResolutions.size>0&&n.activeLimboTargetsByKey.size<n.maxConcurrentLimboResolutions;){let e=n.enqueuedLimboResolutions.values().next().value;n.enqueuedLimboResolutions.delete(e);let t=new B(Te.fromString(e)),i=n.limboTargetIdGenerator.next();n.activeLimboResolutionsByTarget.set(i,new h9(t)),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.insert(t,i),Z6(n.remoteStore,new F1(vn(ec(t.path)),i,"TargetPurposeLimboResolution",Fn.INVALID))}}function Br(n,e,t){return g(this,null,function*(){let i=F(n),r=[],s=[],o=[];i.queryViewsByQuery.isEmpty()||(i.queryViewsByQuery.forEach((a,c)=>{o.push(i.applyDocChanges(c,e,t).then(l=>{if((l||t)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){r.push(l);let u=c9.fromSnapshot(c.targetId,l);s.push(u)}}))}),yield Promise.all(o),i.syncEngineListener.onWatchChange(r),yield Yj(i.localStore,s))})}function MG(n,e,t,i){return g(this,null,function*(){let r=e.view.computeDocChanges(t);r.needsRefill&&(r=yield X6(n.localStore,e.query,!1).then(({documents:c})=>e.view.computeDocChanges(c,r)));let s=i&&i.targetChanges.get(e.targetId),o=i&&i.targetMismatches.get(e.targetId)!=null,a=e.view.applyChanges(r,n.isPrimaryClient,s,o);return um(n,e.targetId,a.limboChanges),a.snapshot})}function zG(n,e){return g(this,null,function*(){let t=F(n);if(!t.currentUser.isEqual(e)){L(Ys,"User change. New user:",e.toKey());let r=yield _E(t.localStore,e);t.currentUser=e,SG(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Br(t,r.affectedDocuments)}})}function xG(n,e){let t=F(n),i=t.activeLimboResolutionsByTarget.get(e);if(i&&i.receivedDocument)return he().add(i.key);{let r=he(),s=t.queriesByTarget.get(e);if(!s)return r;for(let o of s){let a=t.queryViewsByQuery.get(o);r=r.unionWith(a.view.syncedDocuments)}return r}}function OG(n,e){return g(this,null,function*(){let t=F(n),i=yield X6(t.localStore,e.query,!0),r=e.view.synchronizeWithPersistedState(i);return t.isPrimaryClient&&um(t,e.targetId,r.limboChanges),r})}function IG(n,e){return g(this,null,function*(){let t=F(n);return ME(t.localStore,e).then(i=>Br(t,i))})}function AG(n,e,t,i){return g(this,null,function*(){let r=F(n),s=yield Jj(r.localStore,e);if(s===null){L(Ys,"Cannot apply mutation batch with id: "+e);return}t==="pending"?yield ic(r.remoteStore):t==="acknowledged"||t==="rejected"?(lm(r,e,i||null),cm(r,e),eW(r.localStore,e)):j(),yield Br(r,s)})}function DG(n,e){return g(this,null,function*(){let t=F(n);if(J6(t),dm(t),e===!0&&t._isPrimaryClient!==!0){let i=t.sharedClientState.getAllActiveQueryTargets(),r=yield HS(t,i.toArray());t._isPrimaryClient=!0,yield r9(t.remoteStore,!0);for(let s of r)Z6(t.remoteStore,s)}else if(e===!1&&t._isPrimaryClient!==!1){let i=[],r=Promise.resolve();t.queriesByTarget.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?i.push(o):r=r.then(()=>(G1(t,o),j1(t.localStore,o,!0))),nc(t.remoteStore,o)}),yield r,yield HS(t,i),kG(t),t._isPrimaryClient=!1,yield r9(t.remoteStore,!1)}})}function kG(n){let e=F(n);e.activeLimboResolutionsByTarget.forEach((t,i)=>{nc(e.remoteStore,i)}),e.limboDocumentRefs.removeAllReferences(),e.activeLimboResolutionsByTarget=new Map,e.activeLimboTargetsByKey=new nt(B.comparator)}function HS(n,e,t){return g(this,null,function*(){let i=F(n),r=[],s=[];for(let o of e){let a,c=i.queriesByTarget.get(o);if(c&&c.length!==0){a=yield U1(i.localStore,vn(c[0]));for(let l of c){let u=i.queryViewsByQuery.get(l),h=yield OG(i,u);h.snapshot&&s.push(h.snapshot)}}else{let l=yield EE(i.localStore,o);a=yield U1(i.localStore,l),yield am(i,UE(l),o,!1,a.resumeToken)}r.push(a)}return i.syncEngineListener.onWatchChange(s),r})}function UE(n){return kT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function RG(n){let e=F(n);return tW(e.localStore)}function LG(n,e,t,i){return g(this,null,function*(){let r=F(n);if(r._isPrimaryClient){L(Ys,"Ignoring unexpected query state notification.");return}let s=r.queriesByTarget.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield ME(r.localStore,LT(s[0])),a=n2.createSynthesizedRemoteEventForCurrentChange(e,t==="current",jt.EMPTY_BYTE_STRING);yield Br(r,o,a);break}case"rejected":{yield j1(r.localStore,e,!0),G1(r,e,i);break}default:j()}})}function VG(n,e,t){return g(this,null,function*(){let i=J6(n);if(i._isPrimaryClient){for(let r of e){if(i.queriesByTarget.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){L(Ys,"Adding an already active target "+r);continue}let o=yield EE(i.localStore,r),a=yield U1(i.localStore,o);yield am(i,UE(o),a.targetId,!1,a.resumeToken),Z6(i.remoteStore,a)}for(let r of t)i.queriesByTarget.has(r)&&(yield j1(i.localStore,r,!1).then(()=>{nc(i.remoteStore,r),G1(i,r)}).catch(js))}})}function J6(n){let e=F(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=FE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xG.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wG.bind(null,e),e.syncEngineListener.onWatchChange=oG.bind(null,e.eventManager),e.syncEngineListener.onWatchError=aG.bind(null,e.eventManager),e}function dm(n){let e=F(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=CG.bind(null,e),e}function NG(n,e,t){let i=F(n);PG(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}function PG(n,e,t){return g(this,null,function*(){try{let i=yield e.getMetadata();if(yield rW(n.localStore,i))return yield e.close(),t._completeWith(hG(i)),Promise.resolve(new Set);t._updateProgress(HE(i));let s=new l9(i,n.localStore,e.serializer),o=yield e.nextElement();for(;o;){let c=yield s.addSizedElement(o);c&&t._updateProgress(c),o=yield e.nextElement()}let a=yield s.complete();return yield Br(n,a.changedDocs,void 0),yield sW(n.localStore,i),t._completeWith(a.progress),Promise.resolve(a.changedCollectionGroups)}catch(i){return ai(Ys,`Loading bundle failed with ${i}`),t._failWith(i),Promise.resolve(new Set)}})}var d2=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=T2(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return CE(this.persistence,new w6,e.initialUser,this.serializer)}createPersistence(e){return new v6(y6.factory,this.serializer)}createSharedClientState(e){return new _6}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var A6=class n extends d2{constructor(e,t,i){super(),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield ou(n.prototype,this,"initialize").call(this,e),yield this.onlineComponentProvider.initialize(this,e),yield dm(this.onlineComponentProvider.syncEngine),yield ic(this.onlineComponentProvider.remoteStore),yield this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return CE(this.persistence,new w6,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let i=this.persistence.referenceDelegate.garbageCollector;return new Df(i,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let i=new $7(t,this.persistence);return new G7(e.asyncQueue,i)}createPersistence(e){let t=J9(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?oi.withCacheSize(this.cacheSizeBytes):oi.DEFAULT;return new Gf(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,DE(),zW(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new _6}},f9=class n extends A6{constructor(e,t){super(e,t,!1),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield ou(n.prototype,this,"initialize").call(this,e);let t=this.onlineComponentProvider.syncEngine;this.sharedClientState instanceof j4&&(this.sharedClientState.syncEngine={applyBatchState:AG.bind(null,t),applyTargetState:LG.bind(null,t),applyActiveTargetsChange:VG.bind(null,t),getActiveClients:RG.bind(null,t),synchronizeWithChangedDocuments:IG.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.setPrimaryStateListener(i=>g(this,null,function*(){yield DG(this.onlineComponentProvider.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=DE();if(!j4.isAvailable(t))throw new O(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let i=J9(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new j4(t,e.asyncQueue,i,e.clientId,e.initialUser)}},f2=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>PS(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=zG.bind(null,this.syncEngine),yield r9(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return sG()}createDatastore(e){let t=T2(e.databaseInfo.databaseId),i=EW(e.databaseInfo);return RW(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return FW(this.localStore,this.datastore,e.asyncQueue,t=>PS(this.syncEngine,t,0),MW())}createSyncEngine(e,t){return fG(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e;yield jW(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};var HG=10240;function BG(n,e=HG){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}function fm(n,e,t){if(!t)throw new O(b.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function mm(n,e,t,i){if(e===!0&&i===!0)throw new O(b.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function BS(n){if(!B.isDocumentKey(n))throw new O(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function FS(n){if(B.isDocumentKey(n))throw new O(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function FG(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function M2(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=qG(n);return e?`a custom ${e} object`:"an object"}}else return typeof n=="function"?"a function":j()}function qG(n){return n.constructor?n.constructor.name:null}function Ee(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new O(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=M2(n);throw new O(b.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function jE(n,e){if(e<=0)throw new O(b.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function UG(n,e){if(!(n instanceof Uint8Array))throw new O(b.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${M2(n)}`);return BG(n,e)}var $1=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.observer.error?this.scheduleEvent(this.observer.error,e):ht("Uncaught Error in snapshot listener:",e.toString())}mute(){this.muted=!0}scheduleEvent(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var m9=class{constructor(e,t){this.payload=e,this.byteLength=t}isBundleMetadata(){return"metadata"in this.payload}};var p9=class{constructor(e,t){this.reader=e,this.serializer=t,this.metadata=new St,this.buffer=new Uint8Array,this.textDecoder=xq(),this.nextElementImpl().then(i=>{i&&i.isBundleMetadata()?this.metadata.resolve(i.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i?.payload)}`))},i=>this.metadata.reject(i))}close(){return this.reader.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}nextElement(){return g(this,null,function*(){return yield this.getMetadata(),this.nextElementImpl()})}nextElementImpl(){return g(this,null,function*(){let e=yield this.readLength();if(e===null)return null;let t=this.textDecoder.decode(e),i=Number(t);isNaN(i)&&this.raiseError(`length string (${t}) is not valid number`);let r=yield this.readJsonString(i);return new m9(JSON.parse(r),e.length+i)})}indexOfOpenBracket(){return this.buffer.findIndex(e=>e===123)}readLength(){return g(this,null,function*(){for(;this.indexOfOpenBracket()<0&&!(yield this.pullMoreDataToBuffer()););if(this.buffer.length===0)return null;let e=this.indexOfOpenBracket();e<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}readJsonString(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.pullMoreDataToBuffer())&&this.raiseError("Reached the end of bundle when more is expected.");let t=this.textDecoder.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}raiseError(e){throw this.reader.cancel(),new Error(`Invalid bundle format: ${e}`)}pullMoreDataToBuffer(){return g(this,null,function*(){let e=yield this.reader.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};function jG(n,e){return new p9(n,e)}var g9=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new O(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield VW(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Fs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{let r=B.fromPath(i);this.mutations.push(new J4(r,this.precondition(r)))}),yield LW(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else if(e.isNoDocument())t=ne.min();else throw j();let i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new O(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ne.min())?gt.exists(!1):gt.updateTime(t):gt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ne.min()))throw new O(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gt.updateTime(t)}else return gt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var v9=class{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.attemptsRemaining=i.maxAttempts,this.backoff=new u2(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(()=>g(this,null,function*(){let e=new g9(this.datastore),t=this.tryRunUpdateFunction(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.handleTransactionError(r)}))}).catch(i=>{this.handleTransactionError(i)})}))}tryRunUpdateFunction(e){try{let t=this.updateFunction(e);return w2(t)||!t.catch||!t.then?(this.deferred.reject(Error("Transaction callback must return a Promise")),null):t}catch(t){return this.deferred.reject(t),null}}handleTransactionError(e){this.attemptsRemaining>0&&this.isRetryableTransactionError(e)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(e)}isRetryableTransactionError(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!XT(t)}return!1}};var qs="FirestoreClient",WG=100,GG=11,$G=20,YG=22,y9=class{constructor(e,t,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=It.UNAUTHENTICATED,this.clientId=Q8.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,s=>g(this,null,function*(){L(qs,"Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(i,s=>(L(qs,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:WG}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new O(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new St;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=sc(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function Y8(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),L(qs,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>g(this,null,function*(){i.isEqual(r)||(yield _E(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function w9(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield pm(n);L(qs,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>NS(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>NS(e.remoteStore,r)),n._onlineComponents=e})}function WE(n){return n.name==="FirebaseError"?n.code===b.FAILED_PRECONDITION||n.code===b.UNIMPLEMENTED:typeof DOMException<"u"&&n instanceof DOMException?n.code===YG||n.code===$G||n.code===GG:!0}function pm(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){L(qs,"Using user provided OfflineComponentProvider");try{yield Y8(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!WE(t))throw t;ai("Error using user provided cache. Falling back to memory cache: "+t),yield Y8(n,new d2)}}else L(qs,"Using default OfflineComponentProvider"),yield Y8(n,new d2);return n._offlineComponents})}function e0(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(L(qs,"Using user provided OnlineComponentProvider"),yield w9(n,n._uninitializedComponentsProvider._online)):(L(qs,"Using default OnlineComponentProvider"),yield w9(n,new f2))),n._onlineComponents})}function GE(n){return pm(n).then(e=>e.persistence)}function gm(n){return pm(n).then(e=>e.localStore)}function $E(n){return e0(n).then(e=>e.remoteStore)}function vm(n){return e0(n).then(e=>e.syncEngine)}function KG(n){return e0(n).then(e=>e.datastore)}function Y1(n){return g(this,null,function*(){let e=yield e0(n),t=e.eventManager;return t.onListen=mG.bind(null,e.syncEngine),t.onUnlisten=gG.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=pG.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=vG.bind(null,e.syncEngine),t})}function QG(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield GE(n),t=yield $E(n);return e.setNetworkEnabled(!0),qW(t)}))}function XG(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield GE(n),t=yield $E(n);return e.setNetworkEnabled(!1),UW(t)}))}function ZG(n){let e=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let t=yield vm(n);return _G(t,e)})),e.promise}function JG(n,e,t,i){let r=new $1(i),s=new h2(e,r,t);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let o=yield Y1(n);return rm(o,s)})),()=>{r.mute(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let o=yield Y1(n);return sm(o,s)}))}}function e$(n,e){let t=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let i=yield gm(n);return s$(i,e,t)})),t.promise}function YE(n,e,t={}){let i=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let r=yield Y1(n);return o$(r,n.asyncQueue,e,t,i)})),i.promise}function t$(n,e){let t=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let i=yield gm(n);return a$(i,e,t)})),t.promise}function KE(n,e,t={}){let i=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let r=yield Y1(n);return c$(r,n.asyncQueue,e,t,i)})),i.promise}function n$(n,e){let t=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let i=yield vm(n);return yG(i,e,t)})),t.promise}function i$(n,e){let t=new $1(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let i=yield Y1(n);return lG(i,t)})),()=>{t.mute(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let i=yield Y1(n);return uG(i,t)}))}}function r$(n,e,t){let i=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let r=yield KG(n);new v9(n.asyncQueue,r,t,e,i).run()})),i.promise}function s$(n,e,t){return g(this,null,function*(){try{let i=yield Qj(n,e);i.isFoundDocument()?t.resolve(i):i.isNoDocument()?t.resolve(null):t.reject(new O(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(i){let r=sc(i,`Failed to get document '${e} from cache`);t.reject(r)}})}function o$(n,e,t,i,r){let s=new $1({next:a=>{e.enqueueAndForget(()=>sm(n,o));let c=a.docs.has(t);!c&&a.fromCache?r.reject(new O(b.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&i&&i.source==="server"?r.reject(new O(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(a)},error:a=>r.reject(a)}),o=new h2(ec(t.path),s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return rm(n,o)}function a$(n,e,t){return g(this,null,function*(){try{let i=yield X6(n,e,!0),r=new I6(e,i.remoteKeys),s=r.computeDocChanges(i.documents),o=r.applyChanges(s,!1);t.resolve(o.snapshot)}catch(i){let r=sc(i,`Failed to execute query '${e} against cache`);t.reject(r)}})}function c$(n,e,t,i,r){let s=new $1({next:a=>{e.enqueueAndForget(()=>sm(n,o)),a.fromCache&&i.source==="server"?r.reject(new O(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(a)},error:a=>r.reject(a)}),o=new h2(t,s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return rm(n,o)}function l$(n,e,t,i){let r=h$(t,T2(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){NG(yield vm(n),r,i)}))}function u$(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return oW(yield gm(n),e)}))}function h$(n,e){let t;return typeof n=="string"?t=ZT().encode(n):t=n,jG(UG(t),e)}function d$(n,e){return n.timeoutSeconds===e.timeoutSeconds}function QE(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var f$="ComponentProvider",qS=new Map;function m$(n){let e=qS.get(n);e&&(L(f$,"Removing Datastore"),qS.delete(n),e.terminate())}function p$(n,e,t,i){return new J7(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,QE(i.experimentalLongPollingOptions),i.useFetchStreams)}var XE="firestore.googleapis.com",US=!0,jS=5,WS=30,g$=!0,D6=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new O(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=XE,this.ssl=US}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:US;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=yE;else{if(e.cacheSizeBytes!==S2&&e.cacheSizeBytes<MS)throw new O(b.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${MS}`);this.cacheSizeBytes=e.cacheSizeBytes}mm("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=g$:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=QE((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),v$(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&d$(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function v$(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new O(b.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<jS)throw new O(b.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is ${jS})`);if(n.timeoutSeconds>WS)throw new O(b.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is ${WS})`)}}var Fo=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new D6({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new O(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new O(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new D6(e),e.credentials!==void 0&&(this._authCredentials=mB(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return m$(this),Promise.resolve()}};function ZE(n,e,t,i={}){var r;n=Ee(n,Fo);let s=n._getSettings(),o=`${e}:${t}`;if(s.host!==XE&&s.host!==o&&ai("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,c;if(typeof i.mockUserToken=="string")a=i.mockUserToken,c=It.MOCK_USER;else{a=qg(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let l=i.mockUserToken.sub||i.mockUserToken.user_id;if(!l)throw new O(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new It(l)}n._authCredentials=new N7(new K8(a,c))}}var Kt=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Qe=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ur(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},ur=class n extends Kt{constructor(e,t,i){super(e,t,ec(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Qe(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function ym(n,e,...t){if(n=ut(n),fm("collection","path",e),n instanceof Fo){let i=Te.fromString(e,...t);return FS(i),new ur(n,null,i)}else{if(!(n instanceof Qe)&&!(n instanceof ur))throw new O(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Te.fromString(e,...t));return FS(i),new ur(n.firestore,null,i)}}function JE(n,e){if(n=Ee(n,Fo),fm("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new O(b.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Kt(n,null,QF(e))}function z2(n,e,...t){if(n=ut(n),arguments.length===1&&(e=Q8.newId()),fm("doc","path",e),n instanceof Fo){let i=Te.fromString(e,...t);return BS(i),new Qe(n,null,new B(i))}else{if(!(n instanceof Qe)&&!(n instanceof ur))throw new O(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Te.fromString(e,...t));return BS(i),new Qe(n.firestore,n instanceof ur?n.converter:null,new B(i))}}function wm(n,e){return n=ut(n),e=ut(e),(n instanceof Qe||n instanceof ur)&&(e instanceof Qe||e instanceof ur)?n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter:!1}function bm(n,e){return n=ut(n),e=ut(e),n instanceof Kt&&e instanceof Kt?n.firestore===e.firestore&&C2(n._query,e._query)&&n.converter===e.converter:!1}var y$="AsyncQueue",b9=class{constructor(){this.tail=Promise.resolve(),this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new u2(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()}}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new St;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}retryNextOp(){return g(this,null,function*(){if(this.retryableOps.length!==0){try{yield this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(Ws(e))L(y$,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}})}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(i=>{this.failure=i,this.operationInProgress=!1;let r=b$(i);throw ht("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.operationInProgress=!1,i))));return this.tail=t,t}enqueueAfterDelay(e,t,i){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let r=s9.createAndSchedule(this,e,t,i,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(r),r}verifyNotFailed(){this.failure&&j()}verifyOperationInProgress(){}drain(){return g(this,null,function*(){let e;do e=this.tail,yield e;while(e!==this.tail)})}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.delayedOperations)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}};function w$(){return new b9}function b$(n){let e=n.message||"";return n.stack&&(n.stack.includes(n.message)?e=n.stack:e=n.message+`
`+n.stack),e}var C9=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new St,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var eM=S2,ot=class extends Fo{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=w$(),this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||tM(this),this._firestoreClient.terminate()}};function Rt(n){return n._firestoreClient||tM(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function tM(n){var e,t,i;let r=n._freezeSettings(),s=p$(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._firestoreClient=new y9(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}function nM(n,e){n=Ee(n,ot),hM(n);let t=Rt(n);if(t._uninitializedComponentsProvider)throw new O(b.FAILED_PRECONDITION,"SDK cache is already specified.");ai("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let i=n._freezeSettings(),r=new f2,s=new A6(r,i.cacheSizeBytes,e?.forceOwnership);return rM(t,r,s)}function iM(n){n=Ee(n,ot),hM(n);let e=Rt(n);if(e._uninitializedComponentsProvider)throw new O(b.FAILED_PRECONDITION,"SDK cache is already specified.");ai("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),i=new f2,r=new f9(i,t.cacheSizeBytes);return rM(e,i,r)}function rM(n,e,t){let i=new St;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield Y8(n,t),yield w9(n,e),i.resolve()}catch(r){let s=r;if(!WE(s))throw s;ai("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}})).then(()=>i.promise)}function sM(n){if(n._initialized&&!n._terminated)throw new O(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new St;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield Hj(J9(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function oM(n){n=Ee(n,ot);let e=Rt(n);return ZG(e)}function aM(n){n=Ee(n,ot);let e=Rt(n);return QG(e)}function cM(n){n=Ee(n,ot);let e=Rt(n);return XG(e)}function lM(n,e){n=Ee(n,ot);let t=Rt(n),i=new C9;return l$(t,n._databaseId,e,i),i}function uM(n,e){n=Ee(n,ot);let t=Rt(n);return u$(t,e).then(i=>i?new Kt(n,null,i.query):null)}function hM(n){if(n._initialized||n._terminated)throw new O(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}function C$(n,e=!0){dB(Wg),Oc(new ro("firestore",(t,{instanceIdentifier:i,options:r})=>{let s=t.getProvider("app").getImmediate(),o=new ot(new P7(t.getProvider("auth-internal")),new q7(t.getProvider("app-check-internal")),lF(s,i),s);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),Xr(N_,P_,n),Xr(N_,P_,"esm2017")}var fr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(jt.fromBase64String(e))}catch(t){throw new O(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ii=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new O(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Nr=class{constructor(e){this._methodName=e}};var qo=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new O(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new O(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ue(this._lat,e._lat)||ue(this._long,e._long)}};var _$=/^__.*__$/,_9=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Oi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Bs(e,this.data,t,this.fieldTransforms)}},k6=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Oi(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function dM(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j()}}var R6=class n{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.contextWith({path:i,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.contextWith({path:i,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return L6(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(dM(this.dataSource)&&_$.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},S9=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||T2(e)}createContext(e,t,i,r=!1){return new R6({dataSource:e,methodName:t,targetDoc:i,path:Et.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function $o(n){let e=n._freezeSettings(),t=T2(n._databaseId);return new S9(n._databaseId,!!e.ignoreUndefinedProperties,t)}function t0(n,e,t,i,r,s={}){let o=n.createContext(s.merge||s.mergeFields?2:0,e,t,r);Sm("Data must be an object, but it was:",o,i);let a=pM(i,o),c,l;if(s.merge)c=new qn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let h of s.mergeFields){let d=x9(e,h,t);if(!o.contains(d))throw new O(b.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);vM(u,d)||u.push(d)}c=new qn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new _9(new on(a),c,l)}var m2=class n extends Nr{_toFieldTransform(e){if(e.dataSource===2)e.fieldMask.push(e.path);else throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(e){return e instanceof n}};function fM(n,e,t){return new R6({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var T9=class n extends Nr{_toFieldTransform(e){return new No(e.path,new Ps)}isEqual(e){return e instanceof n}},E9=class n extends Nr{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=fM(this,e,!0),i=this._elements.map(s=>Yo(s,t)),r=new Lr(i);return new No(e.path,r)}isEqual(e){return e instanceof n&&wu(this._elements,e._elements)}},M9=class n extends Nr{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=fM(this,e,!0),i=this._elements.map(s=>Yo(s,t)),r=new Vr(i);return new No(e.path,r)}isEqual(e){return e instanceof n&&wu(this._elements,e._elements)}},z9=class n extends Nr{constructor(e,t){super(e),this._operand=t}_toFieldTransform(e){let t=new Hs(e.serializer,qT(e.serializer,this._operand));return new No(e.path,t)}isEqual(e){return e instanceof n&&this._operand===e._operand}};function Cm(n,e,t,i){let r=n.createContext(1,e,t);Sm("Data must be an object, but it was:",r,i);let s=[],o=on.empty();Go(i,(c,l)=>{let u=Tm(e,c,t);l=ut(l);let h=r.childContextForFieldPath(u);if(l instanceof m2)s.push(u);else{let d=Yo(l,h);d!=null&&(s.push(u),o.set(u,d))}});let a=new qn(s);return new k6(o,a,r.fieldTransforms)}function _m(n,e,t,i,r,s){let o=n.createContext(1,e,t),a=[x9(e,i,t)],c=[r];if(s.length%2!==0)throw new O(b.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(x9(e,s[d])),c.push(s[d+1]);let l=[],u=on.empty();for(let d=a.length-1;d>=0;--d)if(!vM(l,a[d])){let m=a[d],p=c[d];p=ut(p);let v=o.childContextForFieldPath(m);if(p instanceof m2)l.push(m);else{let w=Yo(p,v);w!=null&&(l.push(m),u.set(m,w))}}let h=new qn(l);return new k6(u,h,o.fieldTransforms)}function mM(n,e,t,i=!1){let r=n.createContext(i?4:3,e);return Yo(t,r)}function Yo(n,e){if(n=ut(n),gM(n))return Sm("Unsupported field value:",e,n),pM(n,e);if(n instanceof Nr)return T$(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return S$(n,e)}else return E$(n,e)}function pM(n,e){let t={};return pT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Go(n,(i,r)=>{let s=Yo(r,e.childContextForField(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function S$(n,e){let t=[],i=0;for(let r of n){let s=Yo(r,e.childContextForArray(i));s==null&&(s={nullValue:"NULL_VALUE"}),t.push(s),i++}return{arrayValue:{values:t}}}function T$(n,e){if(!dM(e.dataSource))throw e.createError(`${n._methodName}() can only be used with update() and set()`);if(!e.path)throw e.createError(`${n._methodName}() is not currently supported inside arrays`);let t=n._toFieldTransform(e);t&&e.fieldTransforms.push(t)}function E$(n,e){if(n=ut(n),n===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return qT(e.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let t=dt.fromDate(n);return{timestampValue:B1(e.serializer,t)}}else if(n instanceof dt){let t=new dt(n.seconds,Math.floor(n.nanoseconds/1e3)*1e3);return{timestampValue:B1(e.serializer,t)}}else{if(n instanceof qo)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof fr)return{bytesValue:JT(e.serializer,n._byteString)};if(n instanceof Qe){let t=e.databaseId,i=n.firestore._databaseId;if(!i.isEqual(t))throw e.createError(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${t.projectId}/${t.database}`);return{referenceValue:Y9(n.firestore._databaseId||e.databaseId,n._key.path)}}else throw e.createError(`Unsupported field value: ${M2(n)}`)}}function gM(n){return typeof n=="object"&&n!==null&&!(n instanceof Array)&&!(n instanceof Date)&&!(n instanceof dt)&&!(n instanceof qo)&&!(n instanceof fr)&&!(n instanceof Qe)&&!(n instanceof Nr)}function Sm(n,e,t){if(!gM(t)||!FG(t)){let i=M2(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function x9(n,e,t){if(e=ut(e),e instanceof Ii)return e._internalPath;if(typeof e=="string")return Tm(n,e);throw L6("Field path arguments must be of type string or ",n,!1,void 0,t)}var M$=new RegExp("[~\\*/\\[\\]]");function Tm(n,e,t){if(e.search(M$)>=0)throw L6(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ii(...e.split("."))._internalPath}catch{throw L6(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function L6(n,e,t,i,r){let s=i&&!i.isEmpty(),o=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new O(b.INVALID_ARGUMENT,a+n+c)}function vM(n,e){return n.some(t=>t.isEqual(e))}var Uo=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document)if(this._converter){let e=new O9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}else return this._userDataWriter.convertValue(this._document.data.value);else return}get(e){if(this._document){let t=this._document.data.field(n0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},O9=class extends Uo{data(){return super.data()}};function n0(n,e){return typeof e=="string"?Tm(n,e):e instanceof Ii?e._internalPath:e._delegate._internalPath}function yM(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new O(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var p2=class{},jo=class extends p2{};function Fr(n,e,...t){let i=[];e instanceof p2&&i.push(e),i=i.concat(t),R$(i);for(let r of i)n=r._apply(n);return n}var V6=class n extends jo{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return xM(e._query,t),new Kt(e.firestore,e.converter,G9(e._query,t))}_parse(e){let t=$o(e.firestore);return z$(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function wM(n,e,t){let i=e,r=n0("where",n);return V6._create(r,i,t)}var I9=class n extends p2{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Pe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(D$(e._query,t),new Kt(e.firestore,e.converter,G9(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var A9=class n extends jo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=x$(e._query,this._field,this._direction);return new Kt(e.firestore,e.converter,JF(e._query,t))}};function bM(n,e="asc"){let t=e,i=n0("orderBy",n);return A9._create(i,t)}var N6=class n extends jo{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new Kt(e.firestore,e.converter,s6(e._query,this._limit,this._limitType))}};function CM(n){return jE("limit",n),N6._create("limit",n,"F")}function _M(n){return jE("limitToLast",n),N6._create("limitToLast",n,"L")}var P6=class n extends jo{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=zM(e,this.type,this._docOrFields,this._inclusive);return new Kt(e.firestore,e.converter,eq(e._query,t))}};function SM(...n){return P6._create("startAt",n,!0)}function TM(...n){return P6._create("startAfter",n,!1)}var H6=class n extends jo{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=zM(e,this.type,this._docOrFields,this._inclusive);return new Kt(e.firestore,e.converter,tq(e._query,t))}};function EM(...n){return H6._create("endBefore",n,!1)}function MM(...n){return H6._create("endAt",n,!0)}function zM(n,e,t,i){if(t[0]=ut(t[0]),t[0]instanceof Uo)return O$(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=$o(n.firestore);return I$(n._query,n.firestore._databaseId,r,e,t,i)}}function z$(n,e,t,i,r,s,o){let a;if(r.isKeyField()){if(s==="array-contains"||s==="array-contains-any")throw new O(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if(s==="in"||s==="not-in"){$S(o,s);let l=[];for(let u of o)l.push(GS(i,n,u));a={arrayValue:{values:l}}}else a=GS(i,n,o)}else(s==="in"||s==="not-in"||s==="array-contains-any")&&$S(o,s),a=mM(t,e,o,s==="in"||s==="not-in");return ge.create(r,s,a)}function x$(n,e,t){if(n.startAt!==null)throw new O(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(n.endAt!==null)throw new O(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Lo(e,t)}function O$(n,e,t,i,r){if(!i)throw new O(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${t}().`);let s=[];for(let o of N1(n))if(o.field.isKeyField())s.push(Ro(e,i.key));else{let a=i.data.field(o.field);if($6(a))throw new O(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(a!==null)s.push(a);else{let c=o.field.canonicalString();throw new O(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${c}' (used as the orderBy) does not exist.`)}}return new hr(s,r)}function I$(n,e,t,i,r,s){let o=n.explicitOrderBy;if(r.length>o.length)throw new O(b.INVALID_ARGUMENT,`Too many arguments provided to ${i}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let a=[];for(let c=0;c<r.length;c++){let l=r[c];if(o[c].field.isKeyField()){if(typeof l!="string")throw new O(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${i}(), but got a ${typeof l}`);if(!W9(n)&&l.indexOf("/")!==-1)throw new O(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${i}() must be a plain document ID, but '${l}' contains a slash.`);let h=n.path.child(Te.fromString(l));if(!B.isDocumentKey(h))throw new O(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${i}() must result in a valid document path, but '${h}' is not because it contains an odd number of segments.`);let d=new B(h);a.push(Ro(e,d))}else{let h=mM(t,i,l);a.push(h)}}return new hr(a,s)}function GS(n,e,t){if(t=ut(t),typeof t=="string"){if(t==="")throw new O(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!W9(e)&&t.indexOf("/")!==-1)throw new O(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(Te.fromString(t));if(!B.isDocumentKey(i))throw new O(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ro(n,new B(i))}else{if(t instanceof Qe)return Ro(n,t._key);throw new O(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${M2(t)}.`)}}function $S(n,e){if(!Array.isArray(n)||n.length===0)throw new O(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function A$(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function xM(n,e){let t=k$(n.filters,A$(e.op));if(t!==null)throw t===e.op?new O(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new O(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function D$(n,e){let t=n,i=e.getFlattenedFilters();for(let r of i)xM(t,r),t=G9(t,r)}function k$(n,e){for(let t of n)for(let i of t.getFlattenedFilters())if(e.indexOf(i.op)>=0)return i.op;return null}function R$(n){let e=n.filter(i=>i instanceof I9).length,t=n.filter(i=>i instanceof V6).length;if(e>1||e>0&&t>0)throw new O(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}var K1=class{convertValue(e,t="none"){switch(ko(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ls(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw j()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Go(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new qo(vt(e.latitude),vt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=q9(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Y4(e));default:return null}}convertTimestamp(e){let t=Rr(e);return new dt(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Te.fromString(e);J(uE(i));let r=new Vs(i.get(1),i.get(3)),s=new B(i.popFirst(5));return r.isEqual(t)||ht(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function i0(n,e,t){let i;return n?t&&(t.merge||t.mergeFields)?i=n.toFirestore(e,t):i=n.toFirestore(e):i=e,i}var D9=class extends K1{constructor(e){super(),this.firestore=e}convertBytes(e){return new fr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Qe(this.firestore,null,t)}};function k9(n){return L$(n,["next","error","complete"])}function L$(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}var Pr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},li=class extends Uo{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document)if(this._converter){let t=new Us(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}else return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);else return}get(e,t={}){if(this._document){let i=this._document.data.field(n0("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},Us=class extends li{data(e={}){return super.data(e)}},Ai=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Pr(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Us(this._firestore,this._userDataWriter,i.key,i,new Pr(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new O(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return(!this._cachedChanges||this._cachedChangesIncludeMetadataChanges!==t)&&(this._cachedChanges=V$(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function V$(n,e){if(n._snapshot.oldDocs.isEmpty()){let t=0;return n._snapshot.docChanges.map(i=>{let r=new Us(n._firestore,n._userDataWriter,i.doc.key,i.doc,new Pr(n._snapshot.mutatedKeys.has(i.doc.key),n._snapshot.fromCache),n.query.converter);return i.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}else{let t=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(i=>e||i.type!==3).map(i=>{let r=new Us(n._firestore,n._userDataWriter,i.doc.key,i.doc,new Pr(n._snapshot.mutatedKeys.has(i.doc.key),n._snapshot.fromCache),n.query.converter),s=-1,o=-1;return i.type!==0&&(s=t.indexOf(i.doc.key),t=t.delete(i.doc.key)),i.type!==1&&(t=t.add(i.doc),o=t.indexOf(i.doc.key)),{type:N$(i.type),doc:r,oldIndex:s,newIndex:o}})}}function N$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j()}}function Em(n,e){return n instanceof li&&e instanceof li?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Ai&&e instanceof Ai?n._firestore===e._firestore&&bm(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot):!1}function OM(n){n=Ee(n,Qe);let e=Ee(n.firestore,ot),t=Rt(e);return YE(t,n._key).then(i=>Om(e,n,i))}var Hr=class extends K1{constructor(e){super(),this.firestore=e}convertBytes(e){return new fr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Qe(this.firestore,null,t)}};function IM(n){n=Ee(n,Qe);let e=Ee(n.firestore,ot),t=Rt(e),i=new Hr(e);return e$(t,n._key).then(r=>new li(e,i,n._key,r,new Pr(r!==null&&r.hasLocalMutations,!0),n.converter))}function AM(n){n=Ee(n,Qe);let e=Ee(n.firestore,ot),t=Rt(e);return YE(t,n._key,{source:"server"}).then(i=>Om(e,n,i))}function DM(n){n=Ee(n,Kt);let e=Ee(n.firestore,ot),t=Rt(e),i=new Hr(e);return yM(n._query),KE(t,n._query).then(r=>new Ai(e,i,n,r))}function kM(n){n=Ee(n,Kt);let e=Ee(n.firestore,ot),t=Rt(e),i=new Hr(e);return t$(t,n._query).then(r=>new Ai(e,i,n,r))}function RM(n){n=Ee(n,Kt);let e=Ee(n.firestore,ot),t=Rt(e),i=new Hr(e);return KE(t,n._query,{source:"server"}).then(r=>new Ai(e,i,n,r))}function Mm(n,e,t){n=Ee(n,Qe);let i=Ee(n.firestore,ot),r=i0(n.converter,e,t),s=$o(i),a=t0(s,"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,gt.none());return oc(i,[a])}function zm(n,e,t,...i){n=Ee(n,Qe);let r=Ee(n.firestore,ot),s=$o(r);e=ut(e);let o;typeof e=="string"||e instanceof Ii?o=_m(s,"updateDoc",n._key,e,t,i):o=Cm(s,"updateDoc",n._key,e);let a=o.toMutation(n._key,gt.exists(!0));return oc(r,[a])}function LM(n){let e=Ee(n.firestore,ot),t=[new Fs(n._key,gt.none())];return oc(e,t)}function VM(n,e){let t=Ee(n.firestore,ot),i=z2(n),r=i0(n.converter,e),s=$o(n.firestore),a=t0(s,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,gt.exists(!1));return oc(t,[a]).then(()=>i)}function xm(n,...e){var t,i,r;n=ut(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]=="object"&&!k9(e[o])&&(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(k9(e[o])){let d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(i=d.error)===null||i===void 0?void 0:i.bind(d),e[o+2]=(r=d.complete)===null||r===void 0?void 0:r.bind(d)}let c,l,u;if(n instanceof Qe)l=Ee(n.firestore,ot),u=ec(n._key.path),c={next:d=>{e[o]&&e[o](Om(l,n,d))},error:e[o+1],complete:e[o+2]};else{let d=Ee(n,Kt);l=Ee(d.firestore,ot),u=d._query;let m=new Hr(l);c={next:p=>{e[o]&&e[o](new Ai(l,m,d,p))},error:e[o+1],complete:e[o+2]},yM(n._query)}let h=Rt(l);return JG(h,u,a,c)}function NM(n,e){n=Ee(n,ot);let t=Rt(n),i=k9(e)?e:{next:e};return i$(t,i)}function oc(n,e){let t=Rt(n);return n$(t,e)}function Om(n,e,t){let i=t.docs.get(e._key),r=new Hr(n);return new li(n,r,e._key,i,new Pr(t.hasPendingWrites,t.fromCache),e.converter)}var P$={maxAttempts:5};function H$(n){if(n.maxAttempts<1)throw new O(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}var B6=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=$o(e)}set(e,t,i){this._verifyNotCommitted();let r=Ds(e,this._firestore),s=i0(r.converter,t,i),o=t0(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,i);return this._mutations.push(o.toMutation(r._key,gt.none())),this}update(e,t,i,...r){this._verifyNotCommitted();let s=Ds(e,this._firestore);t=ut(t);let o;return typeof t=="string"||t instanceof Ii?o=_m(this._dataReader,"WriteBatch.update",s._key,t,i,r):o=Cm(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,gt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Ds(e,this._firestore);return this._mutations=this._mutations.concat(new Fs(t._key,gt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new O(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Ds(n,e){if(n=ut(n),n.firestore!==e)throw new O(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var R9=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=$o(e)}get(e){let t=Ds(e,this._firestore),i=new D9(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||r.length!==1)return j();let s=r[0];if(s.isFoundDocument())return new Uo(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new Uo(this._firestore,i,t._key,null,t.converter);throw j()})}set(e,t,i){let r=Ds(e,this._firestore),s=i0(r.converter,t,i),o=t0(this._dataReader,"Transaction.set",r._key,s,r.converter!==null,i);return this._transaction.set(r._key,o),this}update(e,t,i,...r){let s=Ds(e,this._firestore);t=ut(t);let o;return typeof t=="string"||t instanceof Ii?o=_m(this._dataReader,"Transaction.update",s._key,t,i,r):o=Cm(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){let t=Ds(e,this._firestore);return this._transaction.delete(t._key),this}};var L9=class extends R9{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Ds(e,this._firestore),i=new Hr(this._firestore);return super.get(e).then(r=>new li(this._firestore,i,t._key,r._document,new Pr(!1,!1),t.converter))}};function PM(n,e,t){n=Ee(n,ot);let i=Object.assign(Object.assign({},P$),t);H$(i);let r=Rt(n);return r$(r,s=>e(new L9(n,s)),i)}function HM(){return new m2("deleteField")}function BM(){return new T9("serverTimestamp")}function FM(...n){return new E9("arrayUnion",n)}function qM(...n){return new M9("arrayRemove",n)}function UM(n){return new z9("increment",n)}C$("node");var B$="@firebase/firestore-compat",F$="0.3.29";function Lm(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new O("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function jM(){if(typeof Uint8Array>"u")throw new O("unimplemented","Uint8Arrays are not available in this environment.")}function WM(){if(!gT())throw new O("unimplemented","Blobs are unavailable in Firestore in this environment.")}var r0=class n{constructor(e){this._delegate=e}static fromBase64String(e){return WM(),new n(fr.fromBase64String(e))}static fromUint8Array(e){return jM(),new n(fr.fromUint8Array(e))}toBase64(){return WM(),this._delegate.toBase64()}toUint8Array(){return jM(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Im(n){return q$(n,["next","error","complete"])}function q$(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}var Am=class{enableIndexedDbPersistence(e,t){return nM(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return iM(e._delegate)}clearIndexedDbPersistence(e){return sM(e._delegate)}},s0=class{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof Vs||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&ai("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){ZE(this._delegate,e,t,i)}enableNetwork(){return aM(this._delegate)}disableNetwork(){return cM(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,mm("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return oM(this._delegate)}onSnapshotsInSync(e){return NM(this._delegate,e)}get app(){if(!this._appCompat)throw new O("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new lc(this,ym(this._delegate,e))}catch(t){throw yn(t,"collection()","Firestore.collection()")}}doc(e){try{return new mr(this,z2(this._delegate,e))}catch(t){throw yn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Zo(this,JE(this._delegate,e))}catch(t){throw yn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return PM(this._delegate,t=>e(new o0(this,t)))}batch(){return Rt(this._delegate),new a0(new B6(this._delegate,e=>oc(this._delegate,e)))}loadBundle(e){return lM(this._delegate,e)}namedQuery(e){return uM(this._delegate,e).then(t=>t?new Zo(this,t):null)}},ac=class extends K1{constructor(e){super(),this.firestore=e}convertBytes(e){return new r0(new fr(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return mr.forKey(t,this.firestore,null)}};function U$(n){KS(n)}var o0=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ac(e)}get(e){let t=Ko(e);return this._delegate.get(t).then(i=>new Qo(this._firestore,new li(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){let r=Ko(e);return i?(Lm("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let s=Ko(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){let t=Ko(e);return this._delegate.delete(t),this}},a0=class{constructor(e){this._delegate=e}set(e,t,i){let r=Ko(e);return i?(Lm("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let s=Ko(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){let t=Ko(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},cc=class n{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){let i=new Us(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Xo(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let i=n.INSTANCES,r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new n(e,new ac(e),t),r.set(t,s)),s}};cc.INSTANCES=new WeakMap;var mr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ac(e)}static forPath(e,t,i){if(e.length%2!==0)throw new O("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Qe(t._delegate,i,new B(e)))}static forKey(e,t,i){return new n(t,new Qe(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new lc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new lc(this.firestore,ym(this._delegate,e))}catch(t){throw yn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ut(e),e instanceof Qe?wm(this._delegate,e):!1}set(e,t){t=Lm("DocumentReference.set",t);try{return t?Mm(this._delegate,e,t):Mm(this._delegate,e)}catch(i){throw yn(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?zm(this._delegate,e):zm(this._delegate,e,t,...i)}catch(r){throw yn(r,"updateDoc()","DocumentReference.update()")}}delete(){return LM(this._delegate)}onSnapshot(...e){let t=GM(e),i=$M(e,r=>new Qo(this.firestore,new li(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return xm(this._delegate,t,i)}get(e){let t;return e?.source==="cache"?t=IM(this._delegate):e?.source==="server"?t=AM(this._delegate):t=OM(this._delegate),t.then(i=>new Qo(this.firestore,new li(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(cc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function yn(n,e,t){return n.message=n.message.replace(e,t),n}function GM(n){for(let e of n)if(typeof e=="object"&&!Im(e))return e;return{}}function $M(n,e){var t,i;let r;return Im(n[0])?r=n[0]:Im(n[1])?r=n[1]:typeof n[0]=="function"?r={next:n[0],error:n[1],complete:n[2]}:r={next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:(t=r.error)===null||t===void 0?void 0:t.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}var Qo=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new mr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Em(this._delegate,e._delegate)}},Xo=class extends Qo{data(e){let t=this._delegate.data(e);return this._delegate._converter||QS(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Zo=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ac(e)}where(e,t,i){try{return new n(this.firestore,Fr(this._delegate,wM(e,t,i)))}catch(r){throw yn(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Fr(this._delegate,bM(e,t)))}catch(i){throw yn(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Fr(this._delegate,CM(e)))}catch(t){throw yn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Fr(this._delegate,_M(e)))}catch(t){throw yn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Fr(this._delegate,SM(...e)))}catch(t){throw yn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Fr(this._delegate,TM(...e)))}catch(t){throw yn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Fr(this._delegate,EM(...e)))}catch(t){throw yn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Fr(this._delegate,MM(...e)))}catch(t){throw yn(t,"endAt()","Query.endAt()")}}isEqual(e){return bm(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=kM(this._delegate):e?.source==="server"?t=RM(this._delegate):t=DM(this._delegate),t.then(i=>new x2(this.firestore,new Ai(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){let t=GM(e),i=$M(e,r=>new x2(this.firestore,new Ai(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return xm(this._delegate,t,i)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(cc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Dm=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Xo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},x2=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Zo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Xo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Dm(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new Xo(this._firestore,i))})}isEqual(e){return Em(this._delegate,e._delegate)}},lc=class n extends Zo{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new mr(this.firestore,e):null}doc(e){try{return e===void 0?new mr(this.firestore,z2(this._delegate)):new mr(this.firestore,z2(this._delegate,e))}catch(t){throw yn(t,"doc()","CollectionReference.doc()")}}add(e){return VM(this._delegate,e).then(t=>new mr(this.firestore,t))}isEqual(e){return wm(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(cc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Ko(n){return Ee(n,Qe)}var km=class n{constructor(...e){this._delegate=new Ii(...e)}static documentId(){return new n(Et.keyField().canonicalString())}isEqual(e){return e=ut(e),e instanceof Ii?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Rm=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=BM();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=HM();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=FM(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=qM(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=UM(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var j$={Firestore:s0,GeoPoint:qo,Timestamp:dt,Blob:r0,Transaction:o0,WriteBatch:a0,DocumentReference:mr,DocumentSnapshot:Qo,Query:Zo,QueryDocumentSnapshot:Xo,QuerySnapshot:x2,CollectionReference:lc,FieldPath:km,FieldValue:Rm,setLogLevel:U$,CACHE_SIZE_UNLIMITED:eM};function W$(n,e){n.INTERNAL.registerComponent(new ro("firestore-compat",t=>{let i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},j$)))}function G$(n){W$(n,(e,t)=>new s0(e,t,new Am)),n.registerVersion(B$,F$,"node")}G$(un);var $$="firebase",Y$="10.11.0";Xr($$,Y$,"app");var ea=new Ig("ANGULARFIRE2_VERSION");var K$=(n,e)=>{let t=e?[e]:Gg(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},Jo=class{constructor(){return K$(Q$)}},Q$="app-check";function Vm(){}var c0=class{zone;delegate;constructor(e,t=lg){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,i)}},Nm=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Vm,{},Vm,Vm)),t.pipe(il({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},l0=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new c0(Zone.current)),this.insideAngular=t.run(()=>new c0(Zone.current,J2)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(M(ze))};static \u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function YM(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function qee(n){return n.pipe(Gr(YM().outsideAngular))}function On(n){return X$(YM())(n)}function X$(n){return function(t){return t=t.lift(new Nm(n.ngZone)),t.pipe(ma(n.outsideAngular),Gr(n.insideAngular))}}var Z$=new Map,J$={activated:!1,tokenObservers:[]},eY={initialized:!1,enabled:!1};function Di(n){return Z$.get(n)||Object.assign({},J$)}function ez(){return eY}var tY="https://content-firebaseappcheck.googleapis.com/v1";var nY="exchangeDebugToken",QM={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Xee=24*60*60*1e3;var Hm=class{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return g(this,null,function*(){this.stop();try{this.pending=new vu,this.pending.promise.catch(t=>{}),yield iY(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new vu,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function iY(n){return new Promise(e=>{setTimeout(e,n)})}var rY={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Ks=new jg("appCheck","AppCheck",rY);function tz(n){if(!Di(n).activated)throw Ks.create("use-before-activation",{appName:n.name})}function nz(i,r){return g(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let m=yield o.getHeartbeatsHeader();m&&(s["X-Firebase-Client"]=m)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(n,a)}catch(m){throw Ks.create("fetch-network-error",{originalErrorMessage:m?.message})}if(c.status!==200)throw Ks.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(m){throw Ks.create("fetch-parse-error",{originalErrorMessage:m?.message})}let u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw Ks.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let h=Number(u[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}})}function iz(n,e){let{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${tY}/projects/${t}/apps/${i}:${nY}?key=${r}`,body:{debug_token:e}}}var sY="firebase-app-check-database",oY=1,Bm="firebase-app-check-store";var u0=null;function aY(){return u0||(u0=new Promise((n,e)=>{try{let t=indexedDB.open(sY,oY);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(Ks.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=i=>{let r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore(Bm,{keyPath:"compositeKey"})}}}catch(t){e(Ks.create("storage-open",{originalErrorMessage:t?.message}))}}),u0)}function cY(n,e){return lY(uY(n),e)}function lY(n,e){return g(this,null,function*(){let i=(yield aY()).transaction(Bm,"readwrite"),s=i.objectStore(Bm).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},i.onerror=c=>{var l;a(Ks.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function uY(n){return`${n.options.appId}-${n.name}`}var Fm=new ml("@firebase/app-check");function Pm(n,e){return fl()?cY(n,e).catch(t=>{Fm.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function rz(){return ez().enabled}function sz(){return g(this,null,function*(){let n=ez();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var hY={error:"UNKNOWN_ERROR"};function dY(n){return Fg.encodeString(JSON.stringify(n),!1)}function qm(n,e=!1){return g(this,null,function*(){let t=n.app;tz(t);let i=Di(t),r=i.token,s;if(r&&!O2(r)&&(i.token=void 0,r=void 0),!r){let c=yield i.cachedTokenPromise;c&&(O2(c)?r=c:yield Pm(t,void 0))}if(!e&&r&&O2(r))return{token:r.token};let o=!1;if(rz()){i.exchangeTokenPromise||(i.exchangeTokenPromise=nz(iz(t,yield sz()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),o=!0);let c=yield i.exchangeTokenPromise;return yield Pm(t,c),i.token=c,{token:c.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),o=!0),r=yield Di(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Fm.warn(c.message):Fm.error(c),s=c}let a;return r?s?O2(r)?a={token:r.token,internalError:s}:a=ZM(s):(a={token:r.token},i.token=r,yield Pm(t,r)):a=ZM(s),o&&gY(t,a),a})}function fY(n){return g(this,null,function*(){let e=n.app;tz(e);let{provider:t}=Di(e);if(rz()){let i=yield sz(),{token:r}=yield nz(iz(e,i),n.heartbeatServiceProvider);return{token:r}}else{let{token:i}=yield t.getToken();return{token:i}}})}function mY(n,e,t,i){let{app:r}=n,s=Di(r),o={next:t,error:i,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&O2(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),XM(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>XM(n))}function oz(n,e){let t=Di(n),i=t.tokenObservers.filter(r=>r.next!==e);i.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function XM(n){let{app:e}=n,t=Di(e),i=t.tokenRefresher;i||(i=pY(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function pY(n){let{app:e}=n;return new Hm(()=>g(this,null,function*(){let t=Di(e),i;if(t.token?i=yield qm(n,!0):i=yield qm(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let t=Di(e);if(t.token){let i=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,r=t.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now())}else return 0},QM.RETRIAL_MIN_WAIT,QM.RETRIAL_MAX_WAIT)}function gY(n,e){let t=Di(n).tokenObservers;for(let i of t)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function O2(n){return n.expireTimeMillis-Date.now()>0}function ZM(n){return{token:dY(hY),error:n}}var Um=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Di(this.app);for(let t of e)oz(this.app,t.next);return Promise.resolve()}};function vY(n,e){return new Um(n,e)}function yY(n){return{getToken:e=>qm(n,e),getLimitedUseToken:()=>fY(n),addTokenListener:e=>mY(n,"INTERNAL",e),removeTokenListener:e=>oz(n.app,e)}}var wY="@firebase/app-check",bY="0.8.3";var CY="app-check",JM="app-check-internal";function _Y(){Oc(new ro(CY,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return vY(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(JM).initialize()})),Oc(new ro(JM,n=>{let e=n.getProvider("app-check").getImmediate();return yY(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Xr(wY,bY)}_Y();var SY=["localhost","0.0.0.0","127.0.0.1"],lte=typeof window<"u"&&SY.includes(window.location.hostname);var TY="firebase",EY="10.11.0";un.registerVersion(TY,EY,"app-compat");var MY=["ngOnDestroy"],lz=(n,e,t,i={})=>new Proxy(n,{get:(r,s)=>t.runOutsideAngular(()=>{if(n[s])return i?.spy?.get&&i.spy.get(s,n[s]),n[s];if(MY.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,l)=>o.then(u=>{let h=u?.(...l);return i?.spy?.apply&&i.spy.apply(s,l,h),h})})})});var h0=class{constructor(e){return e}},uc=new Ce("angularfire2.app.options"),hc=new Ce("angularfire2.app.name");function I2(n,e,t){let i=typeof t=="string"&&t||"[DEFAULT]",r=typeof t=="object"&&t||{};r.name=r.name||i;let o=un.apps.filter(a=>a&&a.name===r.name)[0]||e.runOutsideAngular(()=>un.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;zY("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new h0(o)}var zY=(n,...e)=>{io()&&typeof console<"u"&&console[n](...e)},xY={provide:h0,useFactory:I2,deps:[uc,ze,[new rl,hc]]},bte=(()=>{class n{static initializeApp(t,i){return{ngModule:n,providers:[{provide:uc,useValue:t},{provide:hc,useValue:i}]}}constructor(t){un.registerVersion("angularfire",ea.full,"core"),un.registerVersion("angularfire",ea.full,"app-compat"),un.registerVersion("angular",Ag.full,t.toString())}static \u0275fac=function(i){return new(i||n)(M(Ni))};static \u0275mod=_e({type:n});static \u0275inj=be({providers:[xY]})}return n})();function d0(n,e,t,i,r){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return OY(r,o)||(cz("error",`${e} was already initialized on the ${t} Firebase App with different settings.${IY?" You may need to reload as Firebase is not HMR aware.":""}`),cz("warn",{is:r,was:o})),s;{let a=i();return globalThis.\u0275AngularfireInstanceCache.push([n,a,r]),a}}function OY(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var IY=typeof module<"u"&&!!module.hot,cz=(n,...e)=>{io()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var jm=new Ce("angularfire2.auth.use-emulator"),Wm=new Ce("angularfire2.auth.settings"),Gm=new Ce("angularfire2.auth.tenant-id"),$m=new Ce("angularfire2.auth.langugage-code"),Ym=new Ce("angularfire2.auth.use-device-language"),Km=new Ce("angularfire.auth.persistence"),Qm=(n,e,t,i,r,s,o,a)=>d0(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),i&&(c.tenantId=i),c.languageCode=r,s&&c.useDeviceLanguage(),o)for(let[l,u]of Object.entries(o))c.settings[l]=u;return a&&c.setPersistence(a),c},[t,i,r,s,o,a]),Xm=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,i,r,s,o,a,c,l,u,h,d,m){let p=new ae,v=kt(void 0).pipe(Gr(o.outsideAngular),yr(()=>s.runOutsideAngular(()=>import("./chunk-JTOZDI5E.mjs"))),Je(()=>I2(t,s,i)),Je(w=>Qm(w,s,a,l,u,h,c,d)),Ec({bufferSize:1,refCount:!1}));if(ul(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=kt(null);else{v.pipe(gg()).subscribe();let w=v.pipe(yr(k=>k.getRedirectResult().then(R=>R,()=>null)),On,Ec({bufferSize:1,refCount:!1})),A=v.pipe(yr(k=>new bn(R=>({unsubscribe:s.runOutsideAngular(()=>k.onAuthStateChanged(U=>R.next(U),U=>R.error(U),()=>R.complete()))})))),_=v.pipe(yr(k=>new bn(R=>({unsubscribe:s.runOutsideAngular(()=>k.onIdTokenChanged(U=>R.next(U),U=>R.error(U),()=>R.complete()))}))));this.authState=w.pipe(au(A),ma(o.outsideAngular),Gr(o.insideAngular)),this.user=w.pipe(au(_),ma(o.outsideAngular),Gr(o.insideAngular)),this.idToken=this.user.pipe(yr(k=>k?Gn(k.getIdToken()):kt(null))),this.idTokenResult=this.user.pipe(yr(k=>k?Gn(k.getIdTokenResult()):kt(null))),this.credential=el(w,p,this.authState.pipe(Nt(k=>!k))).pipe(Je(k=>k?.user?k:null),ma(o.outsideAngular),Gr(o.insideAngular))}return lz(this,v,s,{spy:{apply:(w,A,_)=>{(w.startsWith("signIn")||w.startsWith("createUser"))&&_.then(k=>p.next(k))}}})}static \u0275fac=function(i){return new(i||n)(M(uc),M(hc,8),M(Ni),M(ze),M(l0),M(jm,8),M(Wm,8),M(Gm,8),M($m,8),M(Ym,8),M(Km,8),M(Jo,8))};static \u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Lte=(()=>{class n{constructor(){un.registerVersion("angularfire",ea.full,"auth-compat")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=be({providers:[Xm]})}return n})();function DY(n,e=J2){return new bn(t=>{let i;return e!=null?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}function uz(n,e){return DY(n,e)}function kY(n,e){return uz(n,e).pipe(_n(void 0),va(),Je(t=>{let[i,r]=t;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}function ep(n,e){return uz(n,e).pipe(Je(t=>({payload:t,type:"query"})))}var f0=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let i=this.ref.collection(e),{ref:r,query:s}=pz(i,t);return new p0(r,s,this.afs)}snapshotChanges(){return kY(this.ref,this.afs.schedulers.outsideAngular).pipe(On)}valueChanges(e={}){return this.snapshotChanges().pipe(Je(({payload:t})=>e.idField?Li(wt({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Gn(this.ref.get(e)).pipe(On)}};function m0(n,e){return ep(n,e).pipe(_n(void 0),va(),Je(t=>{let[i,r]=t,s=r.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((a,c)=>{let l=s.find(h=>h.doc.ref.isEqual(a.ref)),u=i?.payload.docs.find(h=>h.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&u&&JSON.stringify(u.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function hz(n,e,t){return m0(n,t).pipe(nl((i,r)=>RY(i,r.map(s=>s.payload),e),[]),eo(),Je(i=>i.map(r=>({type:r.type,payload:r}))))}function RY(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=LY(n,i))}),n}function Zm(n,e,t,...i){let r=n.slice();return r.splice(e,t,...i),r}function LY(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return Zm(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return Zm(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Zm(n,e.oldIndex,1);break}return n}function dz(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var p0=class{ref;query;afs;constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=m0(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Je(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(_n(void 0),va(),Nt(([i,r])=>r.length>0||!i),Je(([,i])=>i),On)}auditTrail(e){return this.stateChanges(e).pipe(nl((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=dz(e);return hz(this.query,t,this.afs.schedulers.outsideAngular).pipe(On)}valueChanges(e={}){return ep(this.query,this.afs.schedulers.outsideAngular).pipe(Je(t=>t.payload.docs.map(i=>e.idField?Li(wt({},i.data()),{[e.idField]:i.id}):i.data())),On)}get(e){return Gn(this.query.get(e)).pipe(On)}add(e){return this.ref.add(e)}doc(e){return new f0(this.ref.doc(e),this.afs)}},Jm=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?m0(this.query,this.afs.schedulers.outsideAngular).pipe(On):m0(this.query,this.afs.schedulers.outsideAngular).pipe(Je(t=>t.filter(i=>e.indexOf(i.type)>-1)),Nt(t=>t.length>0),On)}auditTrail(e){return this.stateChanges(e).pipe(nl((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=dz(e);return hz(this.query,t,this.afs.schedulers.outsideAngular).pipe(On)}valueChanges(e={}){return ep(this.query,this.afs.schedulers.outsideAngular).pipe(Je(i=>i.payload.docs.map(r=>e.idField?wt({[e.idField]:r.id},r.data()):r.data())),On)}get(e){return Gn(this.query.get(e)).pipe(On)}},fz=new Ce("angularfire2.enableFirestorePersistence"),mz=new Ce("angularfire2.firestore.persistenceSettings"),VY=new Ce("angularfire2.firestore.settings"),NY=new Ce("angularfire2.firestore.use-emulator");function pz(n,e=t=>t){return{query:e(n),ref:n}}var PY=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,i,r,s,o,a,c,l,u,h,d,m,p,v,w,A,_){this.schedulers=c;let k=I2(t,a,i),R=u;h&&Qm(k,a,d,p,v,w,m,A),[this.firestore,this.persistenceEnabled$]=d0(`${k.name}.firestore`,"AngularFirestore",k.name,()=>{let U=a.runOutsideAngular(()=>k.firestore());if(s&&U.settings(s),R&&U.useEmulator(...R),r&&!ul(o)){let X=()=>{try{return Gn(U.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(re){return typeof console<"u"&&console.warn(re),kt(!1)}};return[U,a.runOutsideAngular(X)]}else return[U,kt(!1)]},[s,R,r])}collection(t,i){let r;typeof t=="string"?r=this.firestore.collection(t):r=t;let{ref:s,query:o}=pz(r,i),a=this.schedulers.ngZone.run(()=>s);return new p0(a,o,this)}collectionGroup(t,i){let r=i||(o=>o),s=this.firestore.collectionGroup(t);return new Jm(r(s),this)}doc(t){let i;typeof t=="string"?i=this.firestore.doc(t):i=t;let r=this.schedulers.ngZone.run(()=>i);return new f0(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(i){return new(i||n)(M(uc),M(hc,8),M(fz,8),M(VY,8),M(Ni),M(ze),M(l0),M(mz,8),M(NY,8),M(Xm,8),M(jm,8),M(Wm,8),M(Gm,8),M($m,8),M(Ym,8),M(Km,8),M(Jo,8))};static \u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Qte=(()=>{class n{constructor(){un.registerVersion("angularfire",ea.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:fz,useValue:!0},{provide:mz,useValue:t}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=be({providers:[PY]})}return n})();function Lt(n,e){HY(n)&&(n="100%");var t=BY(n);return n=e===360?n:Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(String(n*e),10)/100),Math.abs(n-e)<1e-6?1:(e===360?n=(n<0?n%e+e:n%e)/parseFloat(String(e)):n=n%e/parseFloat(String(e)),n)}function A2(n){return Math.min(1,Math.max(0,n))}function HY(n){return typeof n=="string"&&n.indexOf(".")!==-1&&parseFloat(n)===1}function BY(n){return typeof n=="string"&&n.indexOf("%")!==-1}function g0(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function D2(n){return n<=1?"".concat(Number(n)*100,"%"):n}function Qs(n){return n.length===1?"0"+n:String(n)}function gz(n,e,t){return{r:Lt(n,255)*255,g:Lt(e,255)*255,b:Lt(t,255)*255}}function np(n,e,t){n=Lt(n,255),e=Lt(e,255),t=Lt(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s=0,o=0,a=(i+r)/2;if(i===r)o=0,s=0;else{var c=i-r;switch(o=a>.5?c/(2-i-r):c/(i+r),i){case n:s=(e-t)/c+(e<t?6:0);break;case e:s=(t-n)/c+2;break;case t:s=(n-e)/c+4;break;default:break}s/=6}return{h:s,s:o,l:a}}function tp(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*(6*t):t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function vz(n,e,t){var i,r,s;if(n=Lt(n,360),e=Lt(e,100),t=Lt(t,100),e===0)r=t,s=t,i=t;else{var o=t<.5?t*(1+e):t+e-t*e,a=2*t-o;i=tp(a,o,n+1/3),r=tp(a,o,n),s=tp(a,o,n-1/3)}return{r:i*255,g:r*255,b:s*255}}function ta(n,e,t){n=Lt(n,255),e=Lt(e,255),t=Lt(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s=0,o=i,a=i-r,c=i===0?0:a/i;if(i===r)s=0;else{switch(i){case n:s=(e-t)/a+(e<t?6:0);break;case e:s=(t-n)/a+2;break;case t:s=(n-e)/a+4;break;default:break}s/=6}return{h:s,s:c,v:o}}function yz(n,e,t){n=Lt(n,360)*6,e=Lt(e,100),t=Lt(t,100);var i=Math.floor(n),r=n-i,s=t*(1-e),o=t*(1-r*e),a=t*(1-(1-r)*e),c=i%6,l=[t,o,s,s,a,t][c],u=[a,t,t,o,s,s][c],h=[s,s,a,t,t,o][c];return{r:l*255,g:u*255,b:h*255}}function na(n,e,t,i){var r=[Qs(Math.round(n).toString(16)),Qs(Math.round(e).toString(16)),Qs(Math.round(t).toString(16))];return i&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function wz(n,e,t,i,r){var s=[Qs(Math.round(n).toString(16)),Qs(Math.round(e).toString(16)),Qs(Math.round(t).toString(16)),Qs(FY(i))];return r&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function FY(n){return Math.round(parseFloat(n)*255).toString(16)}function ip(n){return In(n)/255}function In(n){return parseInt(n,16)}function bz(n){return{r:n>>16,g:(n&65280)>>8,b:n&255}}var k2={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function An(n){var e={r:0,g:0,b:0},t=1,i=null,r=null,s=null,o=!1,a=!1;return typeof n=="string"&&(n=jY(n)),typeof n=="object"&&(qr(n.r)&&qr(n.g)&&qr(n.b)?(e=gz(n.r,n.g,n.b),o=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):qr(n.h)&&qr(n.s)&&qr(n.v)?(i=D2(n.s),r=D2(n.v),e=yz(n.h,i,r),o=!0,a="hsv"):qr(n.h)&&qr(n.s)&&qr(n.l)&&(i=D2(n.s),s=D2(n.l),e=vz(n.h,i,s),o=!0,a="hsl"),Object.prototype.hasOwnProperty.call(n,"a")&&(t=n.a)),t=g0(t),{ok:o,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}var qY="[-\\+]?\\d+%?",UY="[-\\+]?\\d*\\.\\d+%?",Xs="(?:".concat(UY,")|(?:").concat(qY,")"),rp="[\\s|\\(]+(".concat(Xs,")[,|\\s]+(").concat(Xs,")[,|\\s]+(").concat(Xs,")\\s*\\)?"),sp="[\\s|\\(]+(".concat(Xs,")[,|\\s]+(").concat(Xs,")[,|\\s]+(").concat(Xs,")[,|\\s]+(").concat(Xs,")\\s*\\)?"),ki={CSS_UNIT:new RegExp(Xs),rgb:new RegExp("rgb"+rp),rgba:new RegExp("rgba"+sp),hsl:new RegExp("hsl"+rp),hsla:new RegExp("hsla"+sp),hsv:new RegExp("hsv"+rp),hsva:new RegExp("hsva"+sp),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function jY(n){if(n=n.trim().toLowerCase(),n.length===0)return!1;var e=!1;if(k2[n])n=k2[n],e=!0;else if(n==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t=ki.rgb.exec(n);return t?{r:t[1],g:t[2],b:t[3]}:(t=ki.rgba.exec(n),t?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=ki.hsl.exec(n),t?{h:t[1],s:t[2],l:t[3]}:(t=ki.hsla.exec(n),t?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=ki.hsv.exec(n),t?{h:t[1],s:t[2],v:t[3]}:(t=ki.hsva.exec(n),t?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=ki.hex8.exec(n),t?{r:In(t[1]),g:In(t[2]),b:In(t[3]),a:ip(t[4]),format:e?"name":"hex8"}:(t=ki.hex6.exec(n),t?{r:In(t[1]),g:In(t[2]),b:In(t[3]),format:e?"name":"hex"}:(t=ki.hex4.exec(n),t?{r:In(t[1]+t[1]),g:In(t[2]+t[2]),b:In(t[3]+t[3]),a:ip(t[4]+t[4]),format:e?"name":"hex8"}:(t=ki.hex3.exec(n),t?{r:In(t[1]+t[1]),g:In(t[2]+t[2]),b:In(t[3]+t[3]),format:e?"name":"hex"}:!1)))))))))}function qr(n){return!!ki.CSS_UNIT.exec(String(n))}var v0=function(){function n(e,t){e===void 0&&(e=""),t===void 0&&(t={});var i;if(e instanceof n)return e;typeof e=="number"&&(e=bz(e)),this.originalInput=e;var r=An(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=t.format)!==null&&i!==void 0?i:r.format,this.gradientType=t.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}return n.prototype.isDark=function(){return this.getBrightness()<128},n.prototype.isLight=function(){return!this.isDark()},n.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},n.prototype.getLuminance=function(){var e=this.toRgb(),t,i,r,s=e.r/255,o=e.g/255,a=e.b/255;return s<=.03928?t=s/12.92:t=Math.pow((s+.055)/1.055,2.4),o<=.03928?i=o/12.92:i=Math.pow((o+.055)/1.055,2.4),a<=.03928?r=a/12.92:r=Math.pow((a+.055)/1.055,2.4),.2126*t+.7152*i+.0722*r},n.prototype.getAlpha=function(){return this.a},n.prototype.setAlpha=function(e){return this.a=g0(e),this.roundA=Math.round(100*this.a)/100,this},n.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},n.prototype.toHsv=function(){var e=ta(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},n.prototype.toHsvString=function(){var e=ta(this.r,this.g,this.b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this.a===1?"hsv(".concat(t,", ").concat(i,"%, ").concat(r,"%)"):"hsva(".concat(t,", ").concat(i,"%, ").concat(r,"%, ").concat(this.roundA,")")},n.prototype.toHsl=function(){var e=np(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},n.prototype.toHslString=function(){var e=np(this.r,this.g,this.b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this.a===1?"hsl(".concat(t,", ").concat(i,"%, ").concat(r,"%)"):"hsla(".concat(t,", ").concat(i,"%, ").concat(r,"%, ").concat(this.roundA,")")},n.prototype.toHex=function(e){return e===void 0&&(e=!1),na(this.r,this.g,this.b,e)},n.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},n.prototype.toHex8=function(e){return e===void 0&&(e=!1),wz(this.r,this.g,this.b,this.a,e)},n.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},n.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},n.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},n.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(t,", ").concat(i,")"):"rgba(".concat(e,", ").concat(t,", ").concat(i,", ").concat(this.roundA,")")},n.prototype.toPercentageRgb=function(){var e=function(t){return"".concat(Math.round(Lt(t,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},n.prototype.toPercentageRgbString=function(){var e=function(t){return Math.round(Lt(t,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},n.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+na(this.r,this.g,this.b,!1),t=0,i=Object.entries(k2);t<i.length;t++){var r=i[t],s=r[0],o=r[1];if(e===o)return s}return!1},n.prototype.toString=function(e){var t=!!e;e=e??this.format;var i=!1,r=this.a<1&&this.a>=0,s=!t&&r&&(e.startsWith("hex")||e==="name");return s?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},n.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},n.prototype.clone=function(){return new n(this.toString())},n.prototype.lighten=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l+=e/100,t.l=A2(t.l),new n(t)},n.prototype.brighten=function(e){e===void 0&&(e=10);var t=this.toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),new n(t)},n.prototype.darken=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l-=e/100,t.l=A2(t.l),new n(t)},n.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},n.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},n.prototype.desaturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s-=e/100,t.s=A2(t.s),new n(t)},n.prototype.saturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s+=e/100,t.s=A2(t.s),new n(t)},n.prototype.greyscale=function(){return this.desaturate(100)},n.prototype.spin=function(e){var t=this.toHsl(),i=(t.h+e)%360;return t.h=i<0?360+i:i,new n(t)},n.prototype.mix=function(e,t){t===void 0&&(t=50);var i=this.toRgb(),r=new n(e).toRgb(),s=t/100,o={r:(r.r-i.r)*s+i.r,g:(r.g-i.g)*s+i.g,b:(r.b-i.b)*s+i.b,a:(r.a-i.a)*s+i.a};return new n(o)},n.prototype.analogous=function(e,t){e===void 0&&(e=6),t===void 0&&(t=30);var i=this.toHsl(),r=360/t,s=[this];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,s.push(new n(i));return s},n.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new n(e)},n.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var t=this.toHsv(),i=t.h,r=t.s,s=t.v,o=[],a=1/e;e--;)o.push(new n({h:i,s:r,v:s})),s=(s+a)%1;return o},n.prototype.splitcomplement=function(){var e=this.toHsl(),t=e.h;return[this,new n({h:(t+72)%360,s:e.s,l:e.l}),new n({h:(t+216)%360,s:e.s,l:e.l})]},n.prototype.onBackground=function(e){var t=this.toRgb(),i=new n(e).toRgb(),r=t.a+i.a*(1-t.a);return new n({r:(t.r*t.a+i.r*i.a*(1-t.a))/r,g:(t.g*t.a+i.g*i.a*(1-t.a))/r,b:(t.b*t.a+i.b*i.a*(1-t.a))/r,a:r})},n.prototype.triad=function(){return this.polyad(3)},n.prototype.tetrad=function(){return this.polyad(4)},n.prototype.polyad=function(e){for(var t=this.toHsl(),i=t.h,r=[this],s=360/e,o=1;o<e;o++)r.push(new n({h:(i+o*s)%360,s:t.s,l:t.l}));return r},n.prototype.equals=function(e){return this.toRgbString()===new n(e).toRgbString()},n}();var y0=2,Cz=.16,WY=.05,GY=.05,$Y=.15,Mz=5,zz=4,YY=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function _z(n){var e=n.r,t=n.g,i=n.b,r=ta(e,t,i);return{h:r.h*360,s:r.s,v:r.v}}function w0(n){var e=n.r,t=n.g,i=n.b;return"#".concat(na(e,t,i,!1))}function KY(n,e,t){var i=t/100,r={r:(e.r-n.r)*i+n.r,g:(e.g-n.g)*i+n.g,b:(e.b-n.b)*i+n.b};return r}function Sz(n,e,t){var i;return Math.round(n.h)>=60&&Math.round(n.h)<=240?i=t?Math.round(n.h)-y0*e:Math.round(n.h)+y0*e:i=t?Math.round(n.h)+y0*e:Math.round(n.h)-y0*e,i<0?i+=360:i>=360&&(i-=360),i}function Tz(n,e,t){if(n.h===0&&n.s===0)return n.s;var i;return t?i=n.s-Cz*e:e===zz?i=n.s+Cz:i=n.s+WY*e,i>1&&(i=1),t&&e===Mz&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function Ez(n,e,t){var i;return t?i=n.v+GY*e:i=n.v-$Y*e,i>1&&(i=1),Number(i.toFixed(2))}function dc(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],i=An(n),r=Mz;r>0;r-=1){var s=_z(i),o=w0(An({h:Sz(s,r,!0),s:Tz(s,r,!0),v:Ez(s,r,!0)}));t.push(o)}t.push(w0(i));for(var a=1;a<=zz;a+=1){var c=_z(i),l=w0(An({h:Sz(c,a),s:Tz(c,a),v:Ez(c,a)}));t.push(l)}return e.theme==="dark"?YY.map(function(u){var h=u.index,d=u.opacity,m=w0(KY(An(e.backgroundColor||"#141414"),An(t[h]),d*100));return m}):t}var op={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Qt={},ap={};Object.keys(op).forEach(function(n){Qt[n]=dc(op[n]),Qt[n].primary=Qt[n][5],ap[n]=dc(op[n],{theme:"dark",backgroundColor:"#141414"}),ap[n].primary=ap[n][5]});var pne=Qt.red,gne=Qt.volcano,vne=Qt.gold,yne=Qt.orange,wne=Qt.yellow,bne=Qt.lime,Cne=Qt.green,_ne=Qt.cyan,Sne=Qt.blue,Tne=Qt.geekblue,Ene=Qt.purple,Mne=Qt.magenta,zne=Qt.grey,xne=Qt.grey;var Ur="[@ant-design/icons-angular]:";function ZY(n){console.error(`${Ur} ${n}.`)}function Iz(n){io()&&console.warn(`${Ur} ${n}.`)}function xz(n){return dc(n)[0]}function b0(n,e){switch(e){case"fill":return`${n}-fill`;case"outline":return`${n}-o`;case"twotone":return`${n}-twotone`;case void 0:return n;default:throw new Error(`${Ur}Theme "${e}" is not a recognized theme!`)}}function JY(n,e,t,i){return`${b0(n,e)}-${t}-${i}`}function eK(n){return n==="o"?"outline":n}function tK(n){return n.endsWith("-fill")||n.endsWith("-o")||n.endsWith("-twotone")}function Az(n){return typeof n=="object"&&typeof n.name=="string"&&(typeof n.theme=="string"||n.theme===void 0)&&typeof n.icon=="string"}function nK(n){let e=n.split("-"),t=eK(e.splice(e.length-1,1)[0]);return{name:e.join("-"),theme:t,icon:""}}function iK(n){return n.cloneNode(!0)}function rK(n){return n.replace(/['"]#333['"]/g,'"primaryColor"').replace(/['"]#E6E6E6['"]/g,'"secondaryColor"').replace(/['"]#D9D9D9['"]/g,'"secondaryColor"').replace(/['"]#D8D8D8['"]/g,'"secondaryColor"')}function C0(n){let e=n.split(":");switch(e.length){case 1:return[n,""];case 2:return[e[1],e[0]];default:throw new Error(`${Ur}The icon type ${n} is not valid!`)}}function sK(n){return C0(n)[1]!==""}function oK(){return new Error(`${Ur}Type should have a namespace. Try "namespace:${name}".`)}function Oz(n){return new Error(`${Ur}the icon ${n} does not exist or is not registered.`)}function aK(){return ZY('you need to import "HttpClientModule" to use dynamic importing.'),null}function cK(n){return new Error(`${Ur}The url "${n}" is unsafe.`)}function lK(){return new Error(`${Ur}<svg> tag not found.`)}function uK(){return new Error(`${Ur}Importing timeout error.`)}var hK="__ant_icon_load",dK=new Ce("ant_icons"),cp=(()=>{let e=class e{set twoToneColor({primaryColor:i,secondaryColor:r}){this._twoToneColorPalette.primaryColor=i,this._twoToneColorPalette.secondaryColor=r||xz(i)}get twoToneColor(){return wt({},this._twoToneColorPalette)}get _disableDynamicLoading(){return!1}constructor(i,r,s,o,a){this._rendererFactory=i,this._handler=r,this._document=s,this.sanitizer=o,this._antIcons=a,this.defaultTheme="outline",this._svgDefinitions=new Map,this._svgRenderedDefinitions=new Map,this._inProgressFetches=new Map,this._assetsUrlRoot="",this._twoToneColorPalette={primaryColor:"#333333",secondaryColor:"#E6E6E6"},this._enableJsonpLoading=!1,this._jsonpIconLoad$=new ae,this._renderer=this._rendererFactory.createRenderer(null,null),this._handler&&(this._http=new Bg(this._handler)),this._antIcons&&this.addIcon(...this._antIcons)}useJsonpLoading(){this._enableJsonpLoading?Iz("You are already using jsonp loading."):(this._enableJsonpLoading=!0,window[hK]=i=>{this._jsonpIconLoad$.next(i)})}changeAssetsSource(i){this._assetsUrlRoot=i.endsWith("/")?i:i+"/"}addIcon(...i){i.forEach(r=>{this._svgDefinitions.set(b0(r.name,r.theme),r)})}addIconLiteral(i,r){let[s,o]=C0(i);if(!o)throw oK();this.addIcon({name:i,icon:r})}clear(){this._svgDefinitions.clear(),this._svgRenderedDefinitions.clear()}getRenderedContent(i,r){let s=Az(i)?i:this._svgDefinitions.get(i)||null;if(!s&&this._disableDynamicLoading)throw Oz(i);return(s?kt(s):this._loadIconDynamically(i)).pipe(Je(a=>{if(!a)throw Oz(i);return this._loadSVGFromCacheOrCreateNew(a,r)}))}getCachedIcons(){return this._svgDefinitions}_loadIconDynamically(i){if(!this._http&&!this._enableJsonpLoading)return kt(aK());let r=this._inProgressFetches.get(i);if(!r){let[s,o]=C0(i),a=o?{name:i,icon:""}:nK(s),c=this._enableJsonpLoading?".js":".svg",l=(o?`${this._assetsUrlRoot}assets/${o}/${s}`:`${this._assetsUrlRoot}assets/${a.theme}/${a.name}`)+c,u=this.sanitizer.sanitize(Tg.URL,l);if(!u)throw cK(l);r=(this._enableJsonpLoading?this._loadIconDynamicallyWithJsonp(a,u):this._http.get(u,{responseType:"text"}).pipe(Je(d=>Li(wt({},a),{icon:d})))).pipe(il(d=>this.addIcon(d)),tl(()=>this._inProgressFetches.delete(i)),fg(()=>kt(null)),vg()),this._inProgressFetches.set(i,r)}return r}_loadIconDynamicallyWithJsonp(i,r){return new bn(s=>{let o=this._document.createElement("script"),a=setTimeout(()=>{c(),s.error(uK())},6e3);o.src=r;function c(){o.parentNode.removeChild(o),clearTimeout(a)}this._document.body.appendChild(o),this._jsonpIconLoad$.pipe(Nt(l=>l.name===i.name&&l.theme===i.theme),Vi(1)).subscribe(l=>{s.next(l),c()})})}_loadSVGFromCacheOrCreateNew(i,r){let s,o=r||this._twoToneColorPalette.primaryColor,a=xz(o)||this._twoToneColorPalette.secondaryColor,c=i.theme==="twotone"?JY(i.name,i.theme,o,a):i.theme===void 0?i.name:b0(i.name,i.theme),l=this._svgRenderedDefinitions.get(c);return l?s=l.icon:(s=this._setSVGAttribute(this._colorizeSVGIcon(this._createSVGElementFromString(sK(i.name)?i.icon:rK(i.icon)),i.theme==="twotone",o,a)),this._svgRenderedDefinitions.set(c,Li(wt({},i),{icon:s}))),iK(s)}_createSVGElementFromString(i){let r=this._document.createElement("div");r.innerHTML=i;let s=r.querySelector("svg");if(!s)throw lK;return s}_setSVGAttribute(i){return this._renderer.setAttribute(i,"width","1em"),this._renderer.setAttribute(i,"height","1em"),i}_colorizeSVGIcon(i,r,s,o){if(r){let a=i.childNodes,c=a.length;for(let l=0;l<c;l++){let u=a[l];u.getAttribute("fill")==="secondaryColor"?this._renderer.setAttribute(u,"fill",o):this._renderer.setAttribute(u,"fill",s)}}return this._renderer.setAttribute(i,"fill","currentColor"),i}};e.\u0275fac=function(r){return new(r||e)(M(Ca),M(hl,8),M(bt,8),M(dl),M(dK,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac});let n=e;return n})();function fK(n,e){return n.type===e.type&&n.theme===e.theme&&n.twoToneColor===e.twoToneColor}var Dz=(()=>{let e=class e{constructor(i,r,s){this._iconService=i,this._elementRef=r,this._renderer=s}ngOnChanges(i){(i.type||i.theme||i.twoToneColor)&&this._changeIcon()}_changeIcon(){return new Promise(i=>{if(!this.type){this._clearSVGElement(),i(null);return}let r=this._getSelfRenderMeta();this._iconService.getRenderedContent(this._parseIconType(this.type,this.theme),this.twoToneColor).subscribe(s=>{let o=this._getSelfRenderMeta();fK(r,o)?(this._setSVGElement(s),i(s)):i(null)})})}_getSelfRenderMeta(){return{type:this.type,theme:this.theme,twoToneColor:this.twoToneColor}}_parseIconType(i,r){if(Az(i))return i;{let[s,o]=C0(i);return o?i:tK(s)?(r&&Iz(`'type' ${s} already gets a theme inside so 'theme' ${r} would be ignored`),s):b0(s,r||this._iconService.defaultTheme)}}_setSVGElement(i){this._clearSVGElement(),this._renderer.appendChild(this._elementRef.nativeElement,i)}_clearSVGElement(){let i=this._elementRef.nativeElement,r=i.childNodes,s=r.length;for(let o=s-1;o>=0;o--){let a=r[o];a.tagName?.toLowerCase()==="svg"&&this._renderer.removeChild(i,a)}}};e.\u0275fac=function(r){return new(r||e)(H(cp),H(Ve),H(Pi))},e.\u0275dir=Fe({type:e,selectors:[["","antIcon",""]],inputs:{type:"type",theme:"theme",twoToneColor:"twoToneColor"},features:[Xt]});let n=e;return n})();var _0={isTestMode:!1};var kz={},mK="[NG-ZORRO]:";function pK(...n){let e=n.reduce((t,i)=>t+i.toString(),"");return kz[e]?!1:(kz[e]=!0,!0)}function gK(n,...e){(_0.isTestMode||io()&&pK(...e))&&n(...e)}var ia=(...n)=>gK((...e)=>console.warn(mK,...e),...n);function Rz(n){return n!=null&&`${n}`!="false"}function R2(n,e=0){return lp(n)?Number(n):e}function lp(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function fc(n){return Array.isArray(n)?n:[n]}function ft(n){return n==null?"":typeof n=="string"?n:`${n}px`}function S0(n){return n instanceof Ve?n.nativeElement:n}function tie(n){let e;return n==null?e=[]:Array.isArray(n)?e=n:e=[n],e}function nie(n,e){if(!n||!e||n.length!==e.length)return!1;let t=n.length;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function iie(n){return typeof n<"u"&&n!==null}function rie(n){return typeof n>"u"||n===null}function sie(n){return typeof n=="string"&&n!==""}function oie(n){return n instanceof Tn}function vK(n){return Rz(n)}function yK(n,e=0){return lp(n)?Number(n):e}function Nz(n){return ft(n)}function aie(n,...e){return typeof n=="function"?n(...e):n}function Pz(n,e){function t(i,r,s){let o=`$$__zorroPropDecorator__${r}`;return Object.prototype.hasOwnProperty.call(i,o)&&ia(`The prop "${o}" is already exist, it will be overrided by ${n} decorator.`),Object.defineProperty(i,o,{configurable:!0,writable:!0}),{get(){return s&&s.get?s.get.bind(this)():this[o]},set(a){s&&s.set&&s.set.bind(this)(e(a)),this[o]=e(a)}}}return t}function Un(){return Pz("InputBoolean",vK)}function cie(n){return Pz("InputNumber",e=>yK(e,n))}function lie(n){if(!n.getClientRects().length)return{top:0,left:0};let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView;return{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}}function wK(n){return!!n&&typeof n.then=="function"&&typeof n.catch=="function"}function uie(n){return typeof n=="number"&&isFinite(n)}function hie(n,e){return Math.round(n*Math.pow(10,e))/Math.pow(10,e)}var bK=typeof window<"u",die=bK&&window.mozInnerScreenX!=null;var up,hp,Lz={position:"absolute",top:"-9999px",width:"50px",height:"50px"};function fie(n="vertical",e="ant"){if(typeof document>"u"||typeof window>"u")return 0;let t=n==="vertical";if(t&&up)return up;if(!t&&hp)return hp;let i=document.createElement("div");Object.keys(Lz).forEach(s=>{i.style[s]=Lz[s]}),i.className=`${e}-hide-scrollbar scroll-div-append-to-body`,t?i.style.overflowY="scroll":i.style.overflowX="scroll",document.body.appendChild(i);let r=0;return t?(r=i.offsetWidth-i.clientWidth,up=r):(r=i.offsetHeight-i.clientHeight,hp=r),document.body.removeChild(i),r}function mie(){let n=new ae;return Promise.resolve().then(()=>n.next()),n.pipe(Vi(1))}function pie(n){return pa(n)?n:wK(n)?Gn(Promise.resolve(n)):kt(n)}function fp(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var CK="rc-util-key";function Hz({mark:n}={}){return n?n.startsWith("data-")?n:`data-${n}`:CK}function mp(n){return n.attachTo?n.attachTo:document.querySelector("head")||document.body}function Vz(n,e={}){if(!fp())return null;let t=document.createElement("style");e.cspNonce&&(t.nonce=e.cspNonce),t.innerHTML=n;let i=mp(e),{firstChild:r}=i;return e.prepend&&i.prepend?i.prepend(t):e.prepend&&r?i.insertBefore(t,r):i.appendChild(t),t}var dp=new Map;function _K(n,e={}){let t=mp(e);return Array.from(dp.get(t)?.children||[]).find(i=>i.tagName==="STYLE"&&i.getAttribute(Hz(e))===n)}function Bz(n,e,t={}){let i=mp(t);if(!dp.has(i)){let o=Vz("",t),{parentNode:a}=o;dp.set(i,a),a.removeChild(o)}let r=_K(e,t);if(r)return t.cspNonce&&r.nonce!==t.cspNonce&&(r.nonce=t.cspNonce),r.innerHTML!==n&&(r.innerHTML=n),r;let s=Vz(n,t);return s?.setAttribute(Hz(t),e),s}function gie(n,e,t){return{[`${n}-status-success`]:e==="success",[`${n}-status-warning`]:e==="warning",[`${n}-status-error`]:e==="error",[`${n}-status-validating`]:e==="validating",[`${n}-has-feedback`]:t}}var Fz={name:"bars",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'};var qz={name:"calendar",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z" /></svg>'},Uz={name:"caret-down",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'};var jz={name:"caret-up",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'};var Wz={name:"check-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z" /></svg>'},Gz={name:"check-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z" /><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /></svg>'};var $z={name:"check",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z" /></svg>'};var Yz={name:"caret-down",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'};var Kz={name:"close-circle",theme:"fill",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z" /></svg>'};var Qz={name:"close-circle",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z" /></svg>'},Xz={name:"clock-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z" /></svg>'};var Zz={name:"close",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z" /></svg>'};var Jz={name:"caret-up",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'};var ex={name:"copy",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z" /></svg>'};var tx={name:"delete",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z" /></svg>'};var nx={name:"double-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z" /></svg>'};var ix={name:"double-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 00188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 00492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z" /></svg>'};var rx={name:"down",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z" /></svg>'};var sx={name:"edit",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z" /></svg>'},ox={name:"ellipsis",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'};var ax={name:"exclamation-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z" /></svg>'};var cx={name:"exclamation-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'};var lx={name:"file",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.7c6 6 9.4 14.1 9.4 22.6V928c0 17.7-14.3 32-32 32H192c-17.7 0-32-14.3-32-32V96c0-17.7 14.3-32 32-32h424.7c8.5 0 16.7 3.4 22.7 9.4l215.2 215.3zM790.2 326L602 137.8V326h188.2z" /></svg>'};var ux={name:"filter",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M349 838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V642H349v196zm531.1-684H143.9c-24.5 0-39.8 26.7-27.5 48l221.3 376h348.8l221.3-376c12.1-21.3-3.2-48-27.7-48z" /></svg>'};var hx={name:"info-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z" /></svg>'};var dx={name:"info-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'};var fx={name:"file",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z" /></svg>'};var mx={name:"left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z" /></svg>'};var yie={name:"lock",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z" /></svg>'};var px={name:"loading",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z" /></svg>'};var gx={name:"eye",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z" /></svg>'};var vx={name:"paper-clip",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z" /></svg>'};var yx={name:"question-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z" /></svg>'};var wx={name:"right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z" /></svg>'};var bx={name:"rotate-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H188V494h440v326z" /><path d="M819.3 328.5c-78.8-100.7-196-153.6-314.6-154.2l-.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7.4 12.6-6.1v-63.9c12.9.1 25.9.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8a325.95 325.95 0 016.5 140.9h74.9c14.8-103.6-11.3-213-81-302.3z" /></svg>'};var Cx={name:"rotate-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-.4-12.6 6.1l-.2 64c-118.6.5-235.8 53.4-314.6 154.2A399.75 399.75 0 00123.5 631h74.9c-.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8z" /><path d="M880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H396V494h440v326z" /></svg>'};var _x={name:"search",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z" /></svg>'};var pp={name:"star",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z" /></svg>'};var Sx={name:"swap-right",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M873.1 596.2l-164-208A32 32 0 00684 376h-64.8c-6.7 0-10.4 7.7-6.3 13l144.3 183H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h695.9c26.8 0 41.7-30.8 25.2-51.8z" /></svg>'};var Tx={name:"upload",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z" /></svg>'},Ex={name:"up",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z" /></svg>'};var wie={name:"user",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z" /></svg>'};var Mx={name:"vertical-align-top",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z" /></svg>'};var zx={name:"zoom-in",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'};var xx={name:"zoom-out",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'};var SK=["success","processing","error","default","warning"],TK=["pink","red","yellow","orange","cyan","green","blue","purple","geekblue","magenta","volcano","gold","lime"];function _ie(n){return TK.indexOf(n)!==-1}function Sie(n){return SK.indexOf(n)!==-1}var T0=2,Ox=.16,EK=.05,MK=.05,zK=.15,Rx=5,Lx=4,xK=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function Ix({r:n,g:e,b:t}){let i=ta(n,e,t);return{h:i.h*360,s:i.s,v:i.v}}function E0({r:n,g:e,b:t}){return`#${na(n,e,t,!1)}`}function OK(n,e,t){let i=t/100;return{r:(e.r-n.r)*i+n.r,g:(e.g-n.g)*i+n.g,b:(e.b-n.b)*i+n.b}}function Ax(n,e,t){let i;return Math.round(n.h)>=60&&Math.round(n.h)<=240?i=t?Math.round(n.h)-T0*e:Math.round(n.h)+T0*e:i=t?Math.round(n.h)+T0*e:Math.round(n.h)-T0*e,i<0?i+=360:i>=360&&(i-=360),i}function Dx(n,e,t){if(n.h===0&&n.s===0)return n.s;let i;return t?i=n.s-Ox*e:e===Lx?i=n.s+Ox:i=n.s+EK*e,i>1&&(i=1),t&&e===Rx&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function kx(n,e,t){let i;return t?i=n.v+MK*e:i=n.v-zK*e,i>1&&(i=1),Number(i.toFixed(2))}function gp(n,e={}){let t=[],i=An(n);for(let r=Rx;r>0;r-=1){let s=Ix(i),o=E0(An({h:Ax(s,r,!0),s:Dx(s,r,!0),v:kx(s,r,!0)}));t.push(o)}t.push(E0(i));for(let r=1;r<=Lx;r+=1){let s=Ix(i),o=E0(An({h:Ax(s,r),s:Dx(s,r),v:kx(s,r)}));t.push(o)}return e.theme==="dark"?xK.map(({index:r,opacity:s})=>E0(OK(An(e.backgroundColor||"#141414"),An(t[r]),s*100))):t}var IK=new Ce("nz-config");var AK=`-ant-${Date.now()}-${Math.random()}`;function DK(n,e){let t={},i=(o,a)=>{let c=o.clone();return c=a?.(c)||c,c.toRgbString()},r=(o,a)=>{let c=new v0(o),l=gp(c.toRgbString());t[`${a}-color`]=i(c),t[`${a}-color-disabled`]=l[1],t[`${a}-color-hover`]=l[4],t[`${a}-color-active`]=l[7],t[`${a}-color-outline`]=c.clone().setAlpha(.2).toRgbString(),t[`${a}-color-deprecated-bg`]=l[1],t[`${a}-color-deprecated-border`]=l[3]};if(e.primaryColor){r(e.primaryColor,"primary");let o=new v0(e.primaryColor),a=gp(o.toRgbString());a.forEach((l,u)=>{t[`primary-${u+1}`]=l}),t["primary-color-deprecated-l-35"]=i(o,l=>l.lighten(35)),t["primary-color-deprecated-l-20"]=i(o,l=>l.lighten(20)),t["primary-color-deprecated-t-20"]=i(o,l=>l.tint(20)),t["primary-color-deprecated-t-50"]=i(o,l=>l.tint(50)),t["primary-color-deprecated-f-12"]=i(o,l=>l.setAlpha(l.getAlpha()*.12));let c=new v0(a[0]);t["primary-color-active-deprecated-f-30"]=i(c,l=>l.setAlpha(l.getAlpha()*.3)),t["primary-color-active-deprecated-d-02"]=i(c,l=>l.darken(2))}return e.successColor&&r(e.successColor,"success"),e.warningColor&&r(e.warningColor,"warning"),e.errorColor&&r(e.errorColor,"error"),e.infoColor&&r(e.infoColor,"info"),`
  :root {
    ${Object.keys(t).map(o=>`--${n}-${o}: ${t[o]};`).join(`
`)}
  }
  `.trim()}function Vx(n,e,t){let i=DK(n,e);fp()?Bz(i,`${AK}-dynamic-theme`,{cspNonce:t}):ia("NzConfigService: SSR do not support dynamic theme with css variables.")}var Nx=function(n){return n!==void 0},Px="ant",ra=(()=>{let e=class e{constructor(i,r){this.configUpdated$=new ae,this.config=i||{},this.cspNonce=r,this.config.theme&&Vx(this.getConfig().prefixCls?.prefixCls||Px,this.config.theme,r)}getConfig(){return this.config}getConfigForComponent(i){return this.config[i]}getConfigChangeEventForComponent(i){return this.configUpdated$.pipe(Nt(r=>r===i),pg(void 0))}set(i,r){this.config[i]=wt(wt({},this.config[i]),r),i==="theme"&&this.config.theme&&Vx(this.getConfig().prefixCls?.prefixCls||Px,this.config.theme,this.cspNonce),this.configUpdated$.next(i)}};e.\u0275fac=function(r){return new(r||e)(M(IK,8),M(ba,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Hx(){return function(e,t,i){let r=`$$__zorroConfigDecorator__${t}`;return Object.defineProperty(e,r,{configurable:!0,writable:!0,enumerable:!1}),{get(){let s=i?.get?i.get.bind(this)():this[r],o=(this.propertyAssignCounter?.[t]||0)>1,a=this.nzConfigService.getConfigForComponent(this._nzModuleName)?.[t];return o&&Nx(s)?s:Nx(a)?a:s},set(s){this.propertyAssignCounter=this.propertyAssignCounter||{},this.propertyAssignCounter[t]=(this.propertyAssignCounter[t]||0)+1,i?.set?i.set.bind(this)(s):this[r]=s},configurable:!0,enumerable:!0}}}var wp;try{wp=typeof Intl<"u"&&Intl.v8BreakIterator}catch{wp=!1}var wn=(()=>{let e=class e{constructor(i){this._platformId=i,this.isBrowser=this._platformId?Hg(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||wp)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(r){return new(r||e)(M(Ni))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Fie=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({});let n=e;return n})();var L2;function kK(){if(L2==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>L2=!0}))}finally{L2=L2||!1}return L2}function qie(n){return kK()?n:!!n.capture}var Ri=function(n){return n[n.NORMAL=0]="NORMAL",n[n.NEGATED=1]="NEGATED",n[n.INVERTED=2]="INVERTED",n}(Ri||{}),M0,sa;function z0(){if(sa==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return sa=!1,sa;if("scrollBehavior"in document.documentElement.style)sa=!0;else{let n=Element.prototype.scrollTo;n?sa=!/\{\s*\[native code\]\s*\}/.test(n.toString()):sa=!1}}return sa}function mc(){if(typeof document!="object"||!document)return Ri.NORMAL;if(M0==null){let n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";let t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),M0=Ri.NORMAL,n.scrollLeft===0&&(n.scrollLeft=1,M0=n.scrollLeft===0?Ri.NEGATED:Ri.INVERTED),n.remove()}return M0}var yp;function RK(){if(yp==null){let n=typeof document<"u"?document.head:null;yp=!!(n&&(n.createShadowRoot||n.attachShadow))}return yp}function Uie(n){if(RK()){let e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function bp(n){return n.composedPath?n.composedPath()[0]:n.target}function Cp(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var LK=[Fz,qz,jz,Jz,Uz,Yz,Wz,Gz,$z,Xz,Qz,Kz,Zz,ex,tx,nx,ix,rx,sx,ox,cx,ax,gx,lx,fx,ux,dx,hx,mx,px,vx,yx,wx,Cx,bx,pp,_x,pp,Tx,Mx,Ex,Sx,zx,xx],Fx=new Ce("nz_icons"),ore=new Ce("nz_icon_default_twotone_color"),Bx="#1890ff",qx=(()=>{let e=class e extends cp{get _disableDynamicLoading(){return!this.platform.isBrowser}ngOnDestroy(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}normalizeSvgElement(i){i.getAttribute("viewBox")||this._renderer.setAttribute(i,"viewBox","0 0 1024 1024"),(!i.getAttribute("width")||!i.getAttribute("height"))&&(this._renderer.setAttribute(i,"width","1em"),this._renderer.setAttribute(i,"height","1em")),i.getAttribute("fill")||this._renderer.setAttribute(i,"fill","currentColor")}fetchFromIconfont(i){let{scriptUrl:r}=i;if(this._document&&!this.iconfontCache.has(r)){let s=this._renderer.createElement("script");this._renderer.setAttribute(s,"src",r),this._renderer.setAttribute(s,"data-namespace",r.replace(/^(https?|http):/g,"")),this._renderer.appendChild(this._document.body,s),this.iconfontCache.add(r)}}createIconfontIcon(i){return this._createSVGElementFromString(`<svg><use xlink:href="${i}"></svg>`)}constructor(i,r,s,o,a,c,l){super(i,a,c,r,[...LK,...l||[]]),this.nzConfigService=s,this.platform=o,this.configUpdated$=new ae,this.iconfontCache=new Set,this.subscription=null,this.onConfigChange(),this.configDefaultTwotoneColor(),this.configDefaultTheme()}onConfigChange(){this.subscription=this.nzConfigService.getConfigChangeEventForComponent("icon").subscribe(()=>{this.configDefaultTwotoneColor(),this.configDefaultTheme(),this.configUpdated$.next()})}configDefaultTheme(){let i=this.getConfig();this.defaultTheme=i.nzTheme||"outline"}configDefaultTwotoneColor(){let r=this.getConfig().nzTwotoneColor||Bx,s=Bx;r&&(r.startsWith("#")?s=r:ia("Twotone color must be a hex color!")),this.twoToneColor={primaryColor:s}}getConfig(){return this.nzConfigService.getConfigForComponent("icon")||{}}};e.\u0275fac=function(r){return new(r||e)(M(Ca),M(dl),M(ra),M(wn),M(hl,8),M(bt,8),M(Fx,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ux=new Ce("nz_icons_patch"),jx=(()=>{let e=class e{constructor(i,r){this.extraIcons=i,this.rootIconService=r,this.patched=!1}doPatch(){this.patched||(this.extraIcons.forEach(i=>this.rootIconService.addIcon(i)),this.patched=!0)}};e.\u0275fac=function(r){return new(r||e)(M(Ux,2),M(qx))},e.\u0275prov=me({token:e,factory:e.\u0275fac});let n=e;return n})(),pc=(()=>{let e=class e extends Dz{set nzSpin(i){this.spin=i}set nzType(i){this.type=i}set nzTheme(i){this.theme=i}set nzTwotoneColor(i){this.twoToneColor=i}set nzIconfont(i){this.iconfont=i}constructor(i,r,s,o,a,c){super(o,s,a),this.ngZone=i,this.changeDetectorRef=r,this.iconService=o,this.renderer=a,this.cacheClassName=null,this.nzRotate=0,this.spin=!1,this.destroy$=new ae,c&&c.doPatch(),this.el=s.nativeElement}ngOnChanges(i){let{nzType:r,nzTwotoneColor:s,nzSpin:o,nzTheme:a,nzRotate:c}=i;r||s||o||a?this.changeIcon2():c?this.handleRotate(this.el.firstChild):this._setSVGElement(this.iconService.createIconfontIcon(`#${this.iconfont}`))}ngOnInit(){this.renderer.setAttribute(this.el,"class",`anticon ${this.el.className}`.trim())}ngAfterContentChecked(){if(!this.type){let i=this.el.children,r=i.length;if(!this.type&&i.length)for(;r--;){let s=i[r];s.tagName.toLowerCase()==="svg"&&this.iconService.normalizeSvgElement(s)}}}ngOnDestroy(){this.destroy$.next()}changeIcon2(){this.setClassName(),this.ngZone.runOutsideAngular(()=>{Gn(this._changeIcon()).pipe(lt(this.destroy$)).subscribe({next:i=>{this.ngZone.run(()=>{this.changeDetectorRef.detectChanges(),i&&(this.setSVGData(i),this.handleSpin(i),this.handleRotate(i))})},error:ia})})}handleSpin(i){this.spin||this.type==="loading"?this.renderer.addClass(i,"anticon-spin"):this.renderer.removeClass(i,"anticon-spin")}handleRotate(i){this.nzRotate?this.renderer.setAttribute(i,"style",`transform: rotate(${this.nzRotate}deg)`):this.renderer.removeAttribute(i,"style")}setClassName(){this.cacheClassName&&this.renderer.removeClass(this.el,this.cacheClassName),this.cacheClassName=`anticon-${this.type}`,this.renderer.addClass(this.el,this.cacheClassName)}setSVGData(i){this.renderer.setAttribute(i,"data-icon",this.type),this.renderer.setAttribute(i,"aria-hidden","true")}};e.\u0275fac=function(r){return new(r||e)(H(ze),H(pi),H(Ve),H(qx),H(Pi),H(jx,8))},e.\u0275dir=Fe({type:e,selectors:[["","nz-icon",""]],hostVars:2,hostBindings:function(r,s){r&2&&wr("anticon",!0)},inputs:{nzSpin:"nzSpin",nzRotate:"nzRotate",nzType:"nzType",nzTheme:"nzTheme",nzTwotoneColor:"nzTwotoneColor",nzIconfont:"nzIconfont"},exportAs:["nzIcon"],standalone:!0,features:[Hi,Xt]});let n=e;return Cn([Un()],n.prototype,"nzSpin",null),n})(),O0=(()=>{let e=class e{static forRoot(i){return{ngModule:e,providers:[{provide:Fx,useValue:i}]}}static forChild(i){return{ngModule:e,providers:[jx,{provide:Ux,useValue:i}]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({});let n=e;return n})();var V2=class{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;e!=null&&(this._attachedHost=null,e.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},N2=class extends V2{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}},P2=class extends V2{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}},_p=class extends V2{constructor(e){super(),this.element=e instanceof Ve?e.nativeElement:e}},I0=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){if(e instanceof N2)return this._attachedPortal=e,this.attachComponentPortal(e);if(e instanceof P2)return this._attachedPortal=e,this.attachTemplatePortal(e);if(this.attachDomPortal&&e instanceof _p)return this._attachedPortal=e,this.attachDomPortal(e)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var A0=class extends I0{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{this._document;let a=o.element;a.parentNode;let c=this._document.createComment("dom-portal");a.parentNode.insertBefore(c,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=s}attachComponentPortal(e){let i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||ya.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);r!==-1&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}};var mre=(()=>{let e=class e extends I0{constructor(i,r,s){super(),this._componentFactoryResolver=i,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new Sn,this.attachDomPortal=o=>{this._document;let a=o.element;a.parentNode;let c=this._document.createComment("dom-portal");o.setAttachedHost(this),a.parentNode.insertBefore(c,a),this._getRootNode().appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=s}get portal(){return this._attachedPortal}set portal(i){this.hasAttached()&&!i&&!this._isInitialized||(this.hasAttached()&&super.detach(),i&&super.attach(i),this._attachedPortal=i||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(i){i.setAttachedHost(this);let r=i.viewContainerRef!=null?i.viewContainerRef:this._viewContainerRef,o=(i.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(i.component),a=r.createComponent(o,r.length,i.injector||r.injector,i.projectableNodes||void 0);return r!==this._viewContainerRef&&this._getRootNode().appendChild(a.hostView.rootNodes[0]),super.setDisposeFn(()=>a.destroy()),this._attachedPortal=i,this._attachedRef=a,this.attached.emit(a),a}attachTemplatePortal(i){i.setAttachedHost(this);let r=this._viewContainerRef.createEmbeddedView(i.templateRef,i.context,{injector:i.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=i,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){let i=this._viewContainerRef.element.nativeElement;return i.nodeType===i.ELEMENT_NODE?i:i.parentNode}};e.\u0275fac=function(r){return new(r||e)(H(sl),H(Yr),H(bt))},e.\u0275dir=Fe({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[Ue.None,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[Hi]});let n=e;return n})();var Gx=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({});let n=e;return n})();var jn=(()=>{let e=class e{};e.SLOW="0.3s",e.BASE="0.2s",e.FAST="0.1s";let n=e;return n})(),an=(()=>{let e=class e{};e.EASE_BASE_OUT="cubic-bezier(0.7, 0.3, 0.1, 1)",e.EASE_BASE_IN="cubic-bezier(0.9, 0, 0.3, 0.7)",e.EASE_OUT="cubic-bezier(0.215, 0.61, 0.355, 1)",e.EASE_IN="cubic-bezier(0.55, 0.055, 0.675, 0.19)",e.EASE_IN_OUT="cubic-bezier(0.645, 0.045, 0.355, 1)",e.EASE_OUT_BACK="cubic-bezier(0.12, 0.4, 0.29, 1.46)",e.EASE_IN_BACK="cubic-bezier(0.71, -0.46, 0.88, 0.6)",e.EASE_IN_OUT_BACK="cubic-bezier(0.71, -0.46, 0.29, 1.46)",e.EASE_OUT_CIRC="cubic-bezier(0.08, 0.82, 0.17, 1)",e.EASE_IN_CIRC="cubic-bezier(0.6, 0.04, 0.98, 0.34)",e.EASE_IN_OUT_CIRC="cubic-bezier(0.78, 0.14, 0.15, 0.86)",e.EASE_OUT_QUINT="cubic-bezier(0.23, 1, 0.32, 1)",e.EASE_IN_QUINT="cubic-bezier(0.755, 0.05, 0.855, 0.06)",e.EASE_IN_OUT_QUINT="cubic-bezier(0.86, 0, 0.07, 1)";let n=e;return n})(),vre=$n("collapseMotion",[Ln("expanded",ce({height:"*"})),Ln("collapsed",ce({height:0,overflow:"hidden"})),Ln("hidden",ce({height:0,overflow:"hidden",borderTopWidth:"0"})),et("expanded => collapsed",$e(`150ms ${an.EASE_IN_OUT}`)),et("expanded => hidden",$e(`150ms ${an.EASE_IN_OUT}`)),et("collapsed => expanded",$e(`150ms ${an.EASE_IN_OUT}`)),et("hidden => expanded",$e(`150ms ${an.EASE_IN_OUT}`))]),yre=$n("treeCollapseMotion",[et("* => *",[pu("nz-tree-node:leave,nz-tree-builtin-node:leave",[ce({overflow:"hidden"}),gu(0,[$e(`150ms ${an.EASE_IN_OUT}`,ce({height:0,opacity:0,"padding-bottom":0}))])],{optional:!0}),pu("nz-tree-node:enter,nz-tree-builtin-node:enter",[ce({overflow:"hidden",height:0,opacity:0,"padding-bottom":0}),gu(0,[$e(`150ms ${an.EASE_IN_OUT}`,ce({overflow:"hidden",height:"*",opacity:"*","padding-bottom":"*"}))])],{optional:!0})])]),wre=$n("fadeMotion",[et(":enter",[ce({opacity:0}),$e(`${jn.BASE}`,ce({opacity:1}))]),et(":leave",[ce({opacity:1}),$e(`${jn.BASE}`,ce({opacity:0}))])]),bre=$n("helpMotion",[et(":enter",[ce({opacity:0,transform:"translateY(-5px)"}),$e(`${jn.SLOW} ${an.EASE_IN_OUT}`,ce({opacity:1,transform:"translateY(0)"}))]),et(":leave",[ce({opacity:1,transform:"translateY(0)"}),$e(`${jn.SLOW} ${an.EASE_IN_OUT}`,ce({opacity:0,transform:"translateY(-5px)"}))])]),$x=$n("moveUpMotion",[et("* => enter",[ce({transformOrigin:"0 0",transform:"translateY(-100%)",opacity:0}),$e(`${jn.BASE}`,ce({transformOrigin:"0 0",transform:"translateY(0%)",opacity:1}))]),et("* => leave",[ce({transformOrigin:"0 0",transform:"translateY(0%)",opacity:1}),$e(`${jn.BASE}`,ce({transformOrigin:"0 0",transform:"translateY(-100%)",opacity:0}))])]),Cre=$n("notificationMotion",[Ln("enterRight",ce({opacity:1,transform:"translateX(0)"})),et("* => enterRight",[ce({opacity:0,transform:"translateX(5%)"}),$e("100ms linear")]),Ln("enterLeft",ce({opacity:1,transform:"translateX(0)"})),et("* => enterLeft",[ce({opacity:0,transform:"translateX(-5%)"}),$e("100ms linear")]),Ln("enterTop",ce({opacity:1,transform:"translateY(0)"})),et("* => enterTop",[ce({opacity:0,transform:"translateY(-5%)"}),$e("100ms linear")]),Ln("enterBottom",ce({opacity:1,transform:"translateY(0)"})),et("* => enterBottom",[ce({opacity:0,transform:"translateY(5%)"}),$e("100ms linear")]),Ln("leave",ce({opacity:0,transform:"scaleY(0.8)",transformOrigin:"0% 0%"})),et("* => leave",[ce({opacity:1,transform:"scaleY(1)",transformOrigin:"0% 0%"}),$e("100ms linear")])]),VK=`${jn.BASE} ${an.EASE_OUT_QUINT}`,NK=`${jn.BASE} ${an.EASE_IN_QUINT}`,_re=$n("slideMotion",[Ln("void",ce({opacity:0,transform:"scaleY(0.8)"})),Ln("enter",ce({opacity:1,transform:"scaleY(1)"})),et("void => *",[$e(VK)]),et("* => void",[$e(NK)])]),Sre=$n("slideAlertMotion",[et(":leave",[ce({opacity:1,transform:"scaleY(1)",transformOrigin:"0% 0%"}),$e(`${jn.SLOW} ${an.EASE_IN_OUT_CIRC}`,ce({opacity:0,transform:"scaleY(0)",transformOrigin:"0% 0%"}))])]),Tre=$n("zoomBigMotion",[et("void => active",[ce({opacity:0,transform:"scale(0.8)"}),$e(`${jn.BASE} ${an.EASE_OUT_CIRC}`,ce({opacity:1,transform:"scale(1)"}))]),et("active => void",[ce({opacity:1,transform:"scale(1)"}),$e(`${jn.BASE} ${an.EASE_IN_OUT_CIRC}`,ce({opacity:0,transform:"scale(0.8)"}))])]),Ere=$n("zoomBadgeMotion",[et(":enter",[ce({opacity:0,transform:"scale(0) translate(50%, -50%)"}),$e(`${jn.SLOW} ${an.EASE_OUT_BACK}`,ce({opacity:1,transform:"scale(1) translate(50%, -50%)"}))]),et(":leave",[ce({opacity:1,transform:"scale(1) translate(50%, -50%)"}),$e(`${jn.SLOW} ${an.EASE_IN_BACK}`,ce({opacity:0,transform:"scale(0) translate(50%, -50%)"}))])]),Mre=$n("thumbMotion",[Ln("from",ce({transform:"translateX({{ transform }}px)",width:"{{ width }}px"}),{params:{transform:0,width:0}}),Ln("to",ce({transform:"translateX({{ transform }}px)",width:"{{ width }}px"}),{params:{transform:100,width:0}}),et("from => to",$e(`300ms ${an.EASE_IN_OUT}`))]);var Yx=(()=>{let e=class e{static ngTemplateContextGuard(i,r){return!0}recreateView(){this.viewContainer.clear();let i=this.nzStringTemplateOutlet instanceof Tn,r=i?this.nzStringTemplateOutlet:this.templateRef;this.embeddedViewRef=this.viewContainer.createEmbeddedView(r,i?this.nzStringTemplateOutletContext:this.context)}updateContext(){let r=this.nzStringTemplateOutlet instanceof Tn?this.nzStringTemplateOutletContext:this.context,s=this.embeddedViewRef.context;if(r)for(let o of Object.keys(r))s[o]=r[o]}constructor(i,r){this.viewContainer=i,this.templateRef=r,this.embeddedViewRef=null,this.context=new Sp,this.nzStringTemplateOutletContext=null,this.nzStringTemplateOutlet=null}ngOnChanges(i){let{nzStringTemplateOutletContext:r,nzStringTemplateOutlet:s}=i,o=()=>{let c=!1;if(s)if(s.firstChange)c=!0;else{let h=s.previousValue instanceof Tn,d=s.currentValue instanceof Tn;c=h||d}return r&&(h=>{let d=Object.keys(h.previousValue||{}),m=Object.keys(h.currentValue||{});if(d.length===m.length){for(let p of m)if(d.indexOf(p)===-1)return!0;return!1}else return!0})(r)||c};s&&(this.context.$implicit=s.currentValue),o()?this.recreateView():this.updateContext()}};e.\u0275fac=function(r){return new(r||e)(H(Yr),H(Tn))},e.\u0275dir=Fe({type:e,selectors:[["","nzStringTemplateOutlet",""]],inputs:{nzStringTemplateOutletContext:"nzStringTemplateOutletContext",nzStringTemplateOutlet:"nzStringTemplateOutlet"},exportAs:["nzStringTemplateOutlet"],standalone:!0,features:[Xt]});let n=e;return n})(),Sp=class{},Kx=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({});let n=e;return n})();var Qx=["moz","ms","webkit"];function HK(){let n=0;return function(e){let t=new Date().getTime(),i=Math.max(0,16-(t-n)),r=setTimeout(()=>{e(t+i)},i);return n=t+i,r}}function BK(){if(typeof window>"u")return()=>0;if(window.requestAnimationFrame)return window.requestAnimationFrame.bind(window);let n=Qx.filter(e=>`${e}RequestAnimationFrame`in window)[0];return n?window[`${n}RequestAnimationFrame`]:HK()}function Dre(n){if(typeof window>"u")return null;if(window.cancelAnimationFrame)return window.cancelAnimationFrame(n);let e=Qx.filter(t=>`${t}CancelAnimationFrame`in window||`${t}CancelRequestAnimationFrame`in window)[0];return e?(window[`${e}CancelAnimationFrame`]||window[`${e}CancelRequestAnimationFrame`]).call(this,n):clearTimeout(n)}var Tp=BK();var Xx=new Set,oa,Ep=(()=>{let e=class e{constructor(i,r){this._platform=i,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):qK}matchMedia(i){return(this._platform.WEBKIT||this._platform.BLINK)&&FK(i,this._nonce),this._matchMedia(i)}};e.\u0275fac=function(r){return new(r||e)(M(wn),M(ba,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function FK(n,e){if(!Xx.has(n))try{oa||(oa=document.createElement("style"),e&&oa.setAttribute("nonce",e),oa.setAttribute("type","text/css"),document.head.appendChild(oa)),oa.sheet&&(oa.sheet.insertRule(`@media ${n} {body{ }}`,0),Xx.add(n))}catch(t){console.error(t)}}function qK(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var qre=(()=>{let e=class e{constructor(i,r){this._mediaMatcher=i,this._zone=r,this._queries=new Map,this._destroySubject=new ae}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(i){return Zx(fc(i)).some(s=>this._registerQuery(s).mql.matches)}observe(i){let s=Zx(fc(i)).map(a=>this._registerQuery(a).observable),o=hg(s);return o=dg(o.pipe(Vi(1)),o.pipe(yg(1),mg(0))),o.pipe(Je(a=>{let c={matches:!1,breakpoints:{}};return a.forEach(({matches:l,query:u})=>{c.matches=c.matches||l,c.breakpoints[u]=l}),c}))}_registerQuery(i){if(this._queries.has(i))return this._queries.get(i);let r=this._mediaMatcher.matchMedia(i),o={observable:new bn(a=>{let c=l=>this._zone.run(()=>a.next(l));return r.addListener(c),()=>{r.removeListener(c)}}).pipe(_n(r),Je(({matches:a})=>({query:i,matches:a})),lt(this._destroySubject)),mql:r};return this._queries.set(i,o),o}};e.\u0275fac=function(r){return new(r||e)(M(Ep),M(ze))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Zx(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var Mp=()=>{},jK=(()=>{let e=class e{constructor(i,r){this.ngZone=i,this.rendererFactory2=r,this.resizeSource$=new ae,this.listeners=0,this.disposeHandle=Mp,this.handler=()=>{this.ngZone.run(()=>{this.resizeSource$.next()})},this.renderer=this.rendererFactory2.createRenderer(null,null)}ngOnDestroy(){this.handler=Mp}subscribe(){return this.registerListener(),this.resizeSource$.pipe(ga(16),tl(()=>this.unregisterListener()))}unsubscribe(){this.unregisterListener()}registerListener(){this.listeners===0&&this.ngZone.runOutsideAngular(()=>{this.disposeHandle=this.renderer.listen("window","resize",this.handler)}),this.listeners+=1}unregisterListener(){this.listeners-=1,this.listeners===0&&(this.disposeHandle(),this.disposeHandle=Mp)}};e.\u0275fac=function(r){return new(r||e)(M(ze),M(Ca))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),WK=new Map,Jx=(()=>{let e=class e{constructor(){this._singletonRegistry=new Map}get singletonRegistry(){return _0.isTestMode?WK:this._singletonRegistry}registerSingletonWithKey(i,r){let s=this.singletonRegistry.has(i),o=s?this.singletonRegistry.get(i):this.withNewTarget(r);s||this.singletonRegistry.set(i,o)}unregisterSingletonWithKey(i){this.singletonRegistry.has(i)&&this.singletonRegistry.delete(i)}getSingletonWithKey(i){return this.singletonRegistry.has(i)?this.singletonRegistry.get(i).target:null}withNewTarget(i){return{target:i}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function GK(n,e,t,i){let r=t-e,s=n/(i/2);return s<1?r/2*s*s*s+e:r/2*((s-=2)*s*s+2)+e}var Yre=(()=>{let e=class e{constructor(i,r){this.ngZone=i,this.doc=r}setScrollTop(i,r=0){i===window?(this.doc.body.scrollTop=r,this.doc.documentElement.scrollTop=r):i.scrollTop=r}getOffset(i){let r={top:0,left:0};if(!i||!i.getClientRects().length)return r;let s=i.getBoundingClientRect();if(s.width||s.height){let o=i.ownerDocument.documentElement;r.top=s.top-o.clientTop,r.left=s.left-o.clientLeft}else r.top=s.top,r.left=s.left;return r}getScroll(i,r=!0){if(typeof window>"u")return 0;let s=r?"scrollTop":"scrollLeft",o=0;return this.isWindow(i)?o=i[r?"pageYOffset":"pageXOffset"]:i instanceof Document?o=i.documentElement[s]:i&&(o=i[s]),i&&!this.isWindow(i)&&typeof o!="number"&&(o=(i.ownerDocument||i).documentElement[s]),o}isWindow(i){return i!=null&&i===i.window}scrollTo(i,r=0,s={}){let o=i||window,a=this.getScroll(o),c=Date.now(),{easing:l,callback:u,duration:h=450}=s,d=()=>{let p=Date.now()-c,v=(l||GK)(p>h?h:p,a,r,h);this.isWindow(o)?o.scrollTo(window.pageXOffset,v):o instanceof HTMLDocument||o.constructor.name==="HTMLDocument"?o.documentElement.scrollTop=v:o.scrollTop=v,p<h?Tp(d):typeof u=="function"&&this.ngZone.run(u)};this.ngZone.runOutsideAngular(()=>Tp(d))}};e.\u0275fac=function(r){return new(r||e)(M(ze),M(bt))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),eO=function(n){return n.xxl="xxl",n.xl="xl",n.lg="lg",n.md="md",n.sm="sm",n.xs="xs",n}(eO||{}),$K={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)"},Kre={xs:"(max-width: 479.98px)",sm:"(max-width: 575.98px)",md:"(max-width: 767.98px)",lg:"(max-width: 991.98px)",xl:"(max-width: 1199.98px)",xxl:"(max-width: 1599.98px)"},Qre=(()=>{let e=class e{constructor(i,r){this.resizeService=i,this.mediaMatcher=r,this.destroy$=new ae,this.resizeService.subscribe().pipe(lt(this.destroy$)).subscribe(()=>{})}ngOnDestroy(){this.destroy$.next()}subscribe(i,r){if(r){let s=()=>this.matchMedia(i,!0);return this.resizeService.subscribe().pipe(Je(s),_n(s()),eo((o,a)=>o[0]===a[0]),Je(o=>o[1]))}else{let s=()=>this.matchMedia(i);return this.resizeService.subscribe().pipe(Je(s),_n(s()),eo())}}matchMedia(i,r){let s=eO.md,o={};return Object.keys(i).map(a=>{let c=a,l=this.mediaMatcher.matchMedia($K[c]).matches;o[a]=l,l&&(s=c)}),r?[s,o]:s}};e.\u0275fac=function(r){return new(r||e)(M(jK),M(Ep))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),D0=(()=>{let e=class e extends ae{ngOnDestroy(){this.next(),this.complete()}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=lu(e)))(s||e)}})(),e.\u0275prov=me({token:e,factory:e.\u0275fac});let n=e;return n})();var YK=new Ce("cdk-dir-doc",{providedIn:"root",factory:KK});function KK(){return to(bt)}var QK=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function XK(n){let e=n?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?QK.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var pr=(()=>{let e=class e{constructor(i){if(this.value="ltr",this.change=new Sn,i){let r=i.body?i.body.dir:null,s=i.documentElement?i.documentElement.dir:null;this.value=XK(r||s||"ltr")}}ngOnDestroy(){this.change.complete()}};e.\u0275fac=function(r){return new(r||e)(M(YK,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var H2=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({});let n=e;return n})();var xp=class{};function nO(n){return n&&typeof n.connect=="function"&&!(n instanceof ag)}var k0=class extends xp{constructor(e){super(),this._data=e}connect(){return pa(this._data)?this._data:kt(this._data)}disconnect(){}},B2=function(n){return n[n.REPLACED=0]="REPLACED",n[n.INSERTED=1]="INSERTED",n[n.MOVED=2]="MOVED",n[n.REMOVED=3]="REMOVED",n}(B2||{}),Op=new Ce("_ViewRepeater");var R0=class{constructor(){this.viewCacheSize=20,this._viewCache=[]}applyChanges(e,t,i,r,s){e.forEachOperation((o,a,c)=>{let l,u;if(o.previousIndex==null){let h=()=>i(o,a,c);l=this._insertView(h,c,t,r(o)),u=l?B2.INSERTED:B2.REPLACED}else c==null?(this._detachAndCacheView(a,t),u=B2.REMOVED):(l=this._moveView(a,c,t,r(o)),u=B2.MOVED);s&&s({context:l?.context,operation:u,record:o})})}detach(){for(let e of this._viewCache)e.destroy();this._viewCache=[]}_insertView(e,t,i,r){let s=this._insertViewFromCache(t,i);if(s){s.context.$implicit=r;return}let o=e();return i.createEmbeddedView(o.templateRef,o.context,o.index)}_detachAndCacheView(e,t){let i=t.detach(e);this._maybeCacheView(i,t)}_moveView(e,t,i,r){let s=i.get(e);return i.move(s,t),s.context.$implicit=r,s}_maybeCacheView(e,t){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(e);else{let i=t.indexOf(e);i===-1?e.destroy():t.remove(i)}}_insertViewFromCache(e,t){let i=this._viewCache.pop();return i&&t.insert(i,e),i||null}};var ZK=["contentWrapper"],JK=["*"],oO=new Ce("VIRTUAL_SCROLL_STRATEGY"),Ip=class{constructor(e,t,i){this._scrolledIndexChange=new ae,this.scrolledIndexChange=this._scrolledIndexChange.pipe(eo()),this._viewport=null,this._itemSize=e,this._minBufferPx=t,this._maxBufferPx=i}attach(e){this._viewport=e,this._updateTotalContentSize(),this._updateRenderedRange()}detach(){this._scrolledIndexChange.complete(),this._viewport=null}updateItemAndBufferSize(e,t,i){i<t,this._itemSize=e,this._minBufferPx=t,this._maxBufferPx=i,this._updateTotalContentSize(),this._updateRenderedRange()}onContentScrolled(){this._updateRenderedRange()}onDataLengthChanged(){this._updateTotalContentSize(),this._updateRenderedRange()}onContentRendered(){}onRenderedOffsetChanged(){}scrollToIndex(e,t){this._viewport&&this._viewport.scrollToOffset(e*this._itemSize,t)}_updateTotalContentSize(){this._viewport&&this._viewport.setTotalContentSize(this._viewport.getDataLength()*this._itemSize)}_updateRenderedRange(){if(!this._viewport)return;let e=this._viewport.getRenderedRange(),t={start:e.start,end:e.end},i=this._viewport.getViewportSize(),r=this._viewport.getDataLength(),s=this._viewport.measureScrollOffset(),o=this._itemSize>0?s/this._itemSize:0;if(t.end>r){let c=Math.ceil(i/this._itemSize),l=Math.max(0,Math.min(o,r-c));o!=l&&(o=l,s=l*this._itemSize,t.start=Math.floor(o)),t.end=Math.max(0,Math.min(r,t.start+c))}let a=s-t.start*this._itemSize;if(a<this._minBufferPx&&t.start!=0){let c=Math.ceil((this._maxBufferPx-a)/this._itemSize);t.start=Math.max(0,t.start-c),t.end=Math.min(r,Math.ceil(o+(i+this._minBufferPx)/this._itemSize))}else{let c=t.end*this._itemSize-(s+i);if(c<this._minBufferPx&&t.end!=r){let l=Math.ceil((this._maxBufferPx-c)/this._itemSize);l>0&&(t.end=Math.min(r,t.end+l),t.start=Math.max(0,Math.floor(o-this._minBufferPx/this._itemSize)))}}this._viewport.setRenderedRange(t),this._viewport.setRenderedContentOffset(this._itemSize*t.start),this._scrolledIndexChange.next(Math.floor(o))}};function eQ(n){return n._scrollStrategy}var xse=(()=>{let e=class e{constructor(){this._itemSize=20,this._minBufferPx=100,this._maxBufferPx=200,this._scrollStrategy=new Ip(this.itemSize,this.minBufferPx,this.maxBufferPx)}get itemSize(){return this._itemSize}set itemSize(i){this._itemSize=R2(i)}get minBufferPx(){return this._minBufferPx}set minBufferPx(i){this._minBufferPx=R2(i)}get maxBufferPx(){return this._maxBufferPx}set maxBufferPx(i){this._maxBufferPx=R2(i)}ngOnChanges(){this._scrollStrategy.updateItemAndBufferSize(this.itemSize,this.minBufferPx,this.maxBufferPx)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Fe({type:e,selectors:[["cdk-virtual-scroll-viewport","itemSize",""]],inputs:{itemSize:"itemSize",minBufferPx:"minBufferPx",maxBufferPx:"maxBufferPx"},standalone:!0,features:[Kr([{provide:oO,useFactory:eQ,deps:[bg(()=>e)]}]),Xt]});let n=e;return n})(),tQ=20,gc=(()=>{let e=class e{constructor(i,r,s){this._ngZone=i,this._platform=r,this._scrolled=new ae,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=s}register(i){this.scrollContainers.has(i)||this.scrollContainers.set(i,i.elementScrolled().subscribe(()=>this._scrolled.next(i)))}deregister(i){let r=this.scrollContainers.get(i);r&&(r.unsubscribe(),this.scrollContainers.delete(i))}scrolled(i=tQ){return this._platform.isBrowser?new bn(r=>{this._globalSubscription||this._addGlobalListener();let s=i>0?this._scrolled.pipe(ga(i)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{s.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):kt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((i,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(i,r){let s=this.getAncestorScrollContainers(i);return this.scrolled(r).pipe(Nt(o=>!o||s.indexOf(o)>-1))}getAncestorScrollContainers(i){let r=[];return this.scrollContainers.forEach((s,o)=>{this._scrollableContainsElement(o,i)&&r.push(o)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(i,r){let s=S0(r),o=i.getElementRef().nativeElement;do if(s==o)return!0;while(s=s.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let i=this._getWindow();return Tc(i.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}};e.\u0275fac=function(r){return new(r||e)(M(ze),M(wn),M(bt,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ap=(()=>{let e=class e{constructor(i,r,s,o){this.elementRef=i,this.scrollDispatcher=r,this.ngZone=s,this.dir=o,this._destroyed=new ae,this._elementScrolled=new bn(a=>this.ngZone.runOutsideAngular(()=>Tc(this.elementRef.nativeElement,"scroll").pipe(lt(this._destroyed)).subscribe(a)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(i){let r=this.elementRef.nativeElement,s=this.dir&&this.dir.value=="rtl";i.left==null&&(i.left=s?i.end:i.start),i.right==null&&(i.right=s?i.start:i.end),i.bottom!=null&&(i.top=r.scrollHeight-r.clientHeight-i.bottom),s&&mc()!=Ri.NORMAL?(i.left!=null&&(i.right=r.scrollWidth-r.clientWidth-i.left),mc()==Ri.INVERTED?i.left=i.right:mc()==Ri.NEGATED&&(i.left=i.right?-i.right:i.right)):i.right!=null&&(i.left=r.scrollWidth-r.clientWidth-i.right),this._applyScrollToOptions(i)}_applyScrollToOptions(i){let r=this.elementRef.nativeElement;z0()?r.scrollTo(i):(i.top!=null&&(r.scrollTop=i.top),i.left!=null&&(r.scrollLeft=i.left))}measureScrollOffset(i){let r="left",s="right",o=this.elementRef.nativeElement;if(i=="top")return o.scrollTop;if(i=="bottom")return o.scrollHeight-o.clientHeight-o.scrollTop;let a=this.dir&&this.dir.value=="rtl";return i=="start"?i=a?s:r:i=="end"&&(i=a?r:s),a&&mc()==Ri.INVERTED?i==r?o.scrollWidth-o.clientWidth-o.scrollLeft:o.scrollLeft:a&&mc()==Ri.NEGATED?i==r?o.scrollLeft+o.scrollWidth-o.clientWidth:-o.scrollLeft:i==r?o.scrollLeft:o.scrollWidth-o.clientWidth-o.scrollLeft}};e.\u0275fac=function(r){return new(r||e)(H(Ve),H(gc),H(ze),H(pr,8))},e.\u0275dir=Fe({type:e,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0});let n=e;return n})(),nQ=20,F2=(()=>{let e=class e{constructor(i,r,s){this._platform=i,this._change=new ae,this._changeListener=o=>{this._change.next(o)},this._document=s,r.runOutsideAngular(()=>{if(i.isBrowser){let o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let i=this._getWindow();i.removeEventListener("resize",this._changeListener),i.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let i={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),i}getViewportRect(){let i=this.getViewportScrollPosition(),{width:r,height:s}=this.getViewportSize();return{top:i.top,left:i.left,bottom:i.top+s,right:i.left+r,height:s,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let i=this._document,r=this._getWindow(),s=i.documentElement,o=s.getBoundingClientRect(),a=-o.top||i.body.scrollTop||r.scrollY||s.scrollTop||0,c=-o.left||i.body.scrollLeft||r.scrollX||s.scrollLeft||0;return{top:a,left:c}}change(i=nQ){return i>0?this._change.pipe(ga(i)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let i=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:i.innerWidth,height:i.innerHeight}:{width:0,height:0}}};e.\u0275fac=function(r){return new(r||e)(M(wn),M(ze),M(bt,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),iO=new Ce("VIRTUAL_SCROLLABLE"),iQ=(()=>{let e=class e extends Ap{constructor(i,r,s,o){super(i,r,s,o)}measureViewportSize(i){let r=this.elementRef.nativeElement;return i==="horizontal"?r.clientWidth:r.clientHeight}};e.\u0275fac=function(r){return new(r||e)(H(Ve),H(gc),H(ze),H(pr,8))},e.\u0275dir=Fe({type:e,features:[Hi]});let n=e;return n})();function rQ(n,e){return n.start==e.start&&n.end==e.end}var sQ=typeof requestAnimationFrame<"u"?ug:cg,oQ=(()=>{let e=class e extends iQ{get orientation(){return this._orientation}set orientation(i){this._orientation!==i&&(this._orientation=i,this._calculateSpacerSize())}constructor(i,r,s,o,a,c,l,u){super(i,c,s,a),this.elementRef=i,this._changeDetectorRef=r,this._scrollStrategy=o,this.scrollable=u,this._platform=to(wn),this._detachedSubject=new ae,this._renderedRangeSubject=new ae,this._orientation="vertical",this.appendOnly=!1,this.scrolledIndexChange=new bn(h=>this._scrollStrategy.scrolledIndexChange.subscribe(d=>Promise.resolve().then(()=>this.ngZone.run(()=>h.next(d))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=vr.EMPTY,this._viewportChanges=l.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(_n(null),ga(0,sQ),lt(this._destroyed)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(i){this._forOf,this.ngZone.runOutsideAngular(()=>{this._forOf=i,this._forOf.dataStream.pipe(lt(this._detachedSubject)).subscribe(r=>{let s=r.length;s!==this._dataLength&&(this._dataLength=s,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(i){return this.getElementRef().nativeElement.getBoundingClientRect()[i]}setTotalContentSize(i){this._totalContentSize!==i&&(this._totalContentSize=i,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(i){rQ(this._renderedRange,i)||(this.appendOnly&&(i={start:0,end:Math.max(this._renderedRange.end,i.end)}),this._renderedRangeSubject.next(this._renderedRange=i),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(i,r="to-start"){i=this.appendOnly&&r==="to-start"?0:i;let s=this.dir&&this.dir.value=="rtl",o=this.orientation=="horizontal",a=o?"X":"Y",l=`translate${a}(${Number((o&&s?-1:1)*i)}px)`;this._renderedContentOffset=i,r==="to-end"&&(l+=` translate${a}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=l&&(this._renderedContentTransform=l,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(i,r="auto"){let s={behavior:r};this.orientation==="horizontal"?s.start=i:s.top=i,this.scrollable.scrollTo(s)}scrollToIndex(i,r="auto"){this._scrollStrategy.scrollToIndex(i,r)}measureScrollOffset(i){let r;return this.scrollable==this?r=s=>super.measureScrollOffset(s):r=s=>this.scrollable.measureScrollOffset(s),Math.max(0,r(i??(this.orientation==="horizontal"?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(i){let r,s="left",o="right",a=this.dir?.value=="rtl";i=="start"?r=a?o:s:i=="end"?r=a?s:o:i?r=i:r=this.orientation==="horizontal"?"left":"top";let c=this.scrollable.measureBoundingClientRectWithScrollOffset(r);return this.elementRef.nativeElement.getBoundingClientRect()[r]-c}measureRenderedContentSize(){let i=this._contentWrapper.nativeElement;return this.orientation==="horizontal"?i.offsetWidth:i.offsetHeight}measureRangeSize(i){return this._forOf?this._forOf.measureRangeSize(i,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(i){i&&this._runAfterChangeDetection.push(i),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());let i=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(let r of i)r()}_calculateSpacerSize(){this._totalContentHeight=this.orientation==="horizontal"?"":`${this._totalContentSize}px`,this._totalContentWidth=this.orientation==="horizontal"?`${this._totalContentSize}px`:""}};e.\u0275fac=function(r){return new(r||e)(H(Ve),H(pi),H(ze),H(oO,8),H(pr,8),H(gc),H(F2),H(iO,8))},e.\u0275cmp=$r({type:e,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(r,s){if(r&1&&Og(ZK,7),r&2){let o;cl(o=ll())&&(s._contentWrapper=o.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(r,s){r&2&&wr("cdk-virtual-scroll-orientation-horizontal",s.orientation==="horizontal")("cdk-virtual-scroll-orientation-vertical",s.orientation!=="horizontal")},inputs:{orientation:"orientation",appendOnly:[Ue.HasDecoratorInputTransform,"appendOnly","appendOnly",br]},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[Kr([{provide:Ap,useFactory:(i,r)=>i||r,deps:[[new rl,new Cg(iO)],e]}]),ol,Hi,Qr],ngContentSelectors:JK,decls:4,vars:4,consts:[["contentWrapper",""],[1,"cdk-virtual-scroll-content-wrapper"],[1,"cdk-virtual-scroll-spacer"]],template:function(r,s){r&1&&(Mc(),no(0,"div",1,0),zc(2),Sa(),mi(3,"div",2)),r&2&&(kn(3),al("width",s._totalContentWidth)("height",s._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0});let n=e;return n})();function rO(n,e,t){let i=t;if(!i.getBoundingClientRect)return 0;let r=i.getBoundingClientRect();return n==="horizontal"?e==="start"?r.left:r.right:e==="start"?r.top:r.bottom}var Ose=(()=>{let e=class e{get cdkVirtualForOf(){return this._cdkVirtualForOf}set cdkVirtualForOf(i){this._cdkVirtualForOf=i,nO(i)?this._dataSourceChanges.next(i):this._dataSourceChanges.next(new k0(pa(i)?i:Array.from(i||[])))}get cdkVirtualForTrackBy(){return this._cdkVirtualForTrackBy}set cdkVirtualForTrackBy(i){this._needsUpdate=!0,this._cdkVirtualForTrackBy=i?(r,s)=>i(r+(this._renderedRange?this._renderedRange.start:0),s):void 0}set cdkVirtualForTemplate(i){i&&(this._needsUpdate=!0,this._template=i)}get cdkVirtualForTemplateCacheSize(){return this._viewRepeater.viewCacheSize}set cdkVirtualForTemplateCacheSize(i){this._viewRepeater.viewCacheSize=R2(i)}constructor(i,r,s,o,a,c){this._viewContainerRef=i,this._template=r,this._differs=s,this._viewRepeater=o,this._viewport=a,this.viewChange=new ae,this._dataSourceChanges=new ae,this.dataStream=this._dataSourceChanges.pipe(_n(null),va(),yr(([l,u])=>this._changeDataSource(l,u)),Ec(1)),this._differ=null,this._needsUpdate=!1,this._destroyed=new ae,this.dataStream.subscribe(l=>{this._data=l,this._onRenderedDataChange()}),this._viewport.renderedRangeStream.pipe(lt(this._destroyed)).subscribe(l=>{this._renderedRange=l,this.viewChange.observers.length&&c.run(()=>this.viewChange.next(this._renderedRange)),this._onRenderedDataChange()}),this._viewport.attach(this)}measureRangeSize(i,r){if(i.start>=i.end)return 0;i.start<this._renderedRange.start||i.end>this._renderedRange.end;let s=i.start-this._renderedRange.start,o=i.end-i.start,a,c;for(let l=0;l<o;l++){let u=this._viewContainerRef.get(l+s);if(u&&u.rootNodes.length){a=c=u.rootNodes[0];break}}for(let l=o-1;l>-1;l--){let u=this._viewContainerRef.get(l+s);if(u&&u.rootNodes.length){c=u.rootNodes[u.rootNodes.length-1];break}}return a&&c?rO(r,"end",c)-rO(r,"start",a):0}ngDoCheck(){if(this._differ&&this._needsUpdate){let i=this._differ.diff(this._renderedItems);i?this._applyChanges(i):this._updateContext(),this._needsUpdate=!1}}ngOnDestroy(){this._viewport.detach(),this._dataSourceChanges.next(void 0),this._dataSourceChanges.complete(),this.viewChange.complete(),this._destroyed.next(),this._destroyed.complete(),this._viewRepeater.detach()}_onRenderedDataChange(){this._renderedRange&&(this._renderedItems=this._data.slice(this._renderedRange.start,this._renderedRange.end),this._differ||(this._differ=this._differs.find(this._renderedItems).create((i,r)=>this.cdkVirtualForTrackBy?this.cdkVirtualForTrackBy(i,r):r)),this._needsUpdate=!0)}_changeDataSource(i,r){return i&&i.disconnect(this),this._needsUpdate=!0,r?r.connect(this):kt()}_updateContext(){let i=this._data.length,r=this._viewContainerRef.length;for(;r--;){let s=this._viewContainerRef.get(r);s.context.index=this._renderedRange.start+r,s.context.count=i,this._updateComputedContextProperties(s.context),s.detectChanges()}}_applyChanges(i){this._viewRepeater.applyChanges(i,this._viewContainerRef,(o,a,c)=>this._getEmbeddedViewArgs(o,c),o=>o.item),i.forEachIdentityChange(o=>{let a=this._viewContainerRef.get(o.currentIndex);a.context.$implicit=o.item});let r=this._data.length,s=this._viewContainerRef.length;for(;s--;){let o=this._viewContainerRef.get(s);o.context.index=this._renderedRange.start+s,o.context.count=r,this._updateComputedContextProperties(o.context)}}_updateComputedContextProperties(i){i.first=i.index===0,i.last=i.index===i.count-1,i.even=i.index%2===0,i.odd=!i.even}_getEmbeddedViewArgs(i,r){return{templateRef:this._template,context:{$implicit:i.item,cdkVirtualForOf:this._cdkVirtualForOf,index:-1,count:-1,first:!1,last:!1,odd:!1,even:!1},index:r}}};e.\u0275fac=function(r){return new(r||e)(H(Yr),H(Tn),H(kg),H(Op),H(oQ,4),H(ze))},e.\u0275dir=Fe({type:e,selectors:[["","cdkVirtualFor","","cdkVirtualForOf",""]],inputs:{cdkVirtualForOf:"cdkVirtualForOf",cdkVirtualForTrackBy:"cdkVirtualForTrackBy",cdkVirtualForTemplate:"cdkVirtualForTemplate",cdkVirtualForTemplateCacheSize:"cdkVirtualForTemplateCacheSize"},standalone:!0,features:[Kr([{provide:Op,useClass:R0}])]});let n=e;return n})();var sO=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({});let n=e;return n})(),Dp=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({imports:[H2,sO,H2,sO]});let n=e;return n})();function aO(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}var cO=z0(),kp=class{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){let e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=ft(-this._previousScrollPosition.left),e.style.top=ft(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let e=this._document.documentElement,t=this._document.body,i=e.style,r=t.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),cO&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),cO&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}};var Rp=class{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(this._scrollSubscription)return;let e=this._scrollDispatcher.scrolled(0).pipe(Nt(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{let t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},L0=class{enable(){}disable(){}attach(){}};function Lp(n,e){return e.some(t=>{let i=n.bottom<t.top,r=n.top>t.bottom,s=n.right<t.left,o=n.left>t.right;return i||r||s||o})}function lO(n,e){return e.some(t=>{let i=n.top<t.top,r=n.bottom>t.bottom,s=n.left<t.left,o=n.right>t.right;return i||r||s||o})}var Vp=class{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(!this._scrollSubscription){let e=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(e).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();Lp(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},lQ=(()=>{let e=class e{constructor(i,r,s,o){this._scrollDispatcher=i,this._viewportRuler=r,this._ngZone=s,this.noop=()=>new L0,this.close=a=>new Rp(this._scrollDispatcher,this._ngZone,this._viewportRuler,a),this.block=()=>new kp(this._viewportRuler,this._document),this.reposition=a=>new Vp(this._scrollDispatcher,this._viewportRuler,this._ngZone,a),this._document=o}};e.\u0275fac=function(r){return new(r||e)(M(gc),M(F2),M(ze),M(bt))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),V0=class{constructor(e){if(this.scrollStrategy=new L0,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){let t=Object.keys(e);for(let i of t)e[i]!==void 0&&(this[i]=e[i])}}},at=class{constructor(e,t,i,r,s){this.offsetX=i,this.offsetY=r,this.panelClass=s,this.originX=e.originX,this.originY=e.originY,this.overlayX=t.overlayX,this.overlayY=t.overlayY}};var Np=class{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}};var mO=(()=>{let e=class e{constructor(i){this._attachedOverlays=[],this._document=i}ngOnDestroy(){this.detach()}add(i){this.remove(i),this._attachedOverlays.push(i)}remove(i){let r=this._attachedOverlays.indexOf(i);r>-1&&this._attachedOverlays.splice(r,1),this._attachedOverlays.length===0&&this.detach()}};e.\u0275fac=function(r){return new(r||e)(M(bt))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),uQ=(()=>{let e=class e extends mO{constructor(i,r){super(i),this._ngZone=r,this._keydownListener=s=>{let o=this._attachedOverlays;for(let a=o.length-1;a>-1;a--)if(o[a]._keydownEvents.observers.length>0){let c=o[a]._keydownEvents;this._ngZone?this._ngZone.run(()=>c.next(s)):c.next(s);break}}}add(i){super.add(i),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}};e.\u0275fac=function(r){return new(r||e)(M(bt),M(ze,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),hQ=(()=>{let e=class e extends mO{constructor(i,r,s){super(i),this._platform=r,this._ngZone=s,this._cursorStyleIsSet=!1,this._pointerDownListener=o=>{this._pointerDownEventTarget=bp(o)},this._clickListener=o=>{let a=bp(o),c=o.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:a;this._pointerDownEventTarget=null;let l=this._attachedOverlays.slice();for(let u=l.length-1;u>-1;u--){let h=l[u];if(h._outsidePointerEvents.observers.length<1||!h.hasAttached())continue;if(h.overlayElement.contains(a)||h.overlayElement.contains(c))break;let d=h._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>d.next(o)):d.next(o)}}}add(i){if(super.add(i),!this._isAttached){let r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let i=this._document.body;i.removeEventListener("pointerdown",this._pointerDownListener,!0),i.removeEventListener("click",this._clickListener,!0),i.removeEventListener("auxclick",this._clickListener,!0),i.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(i.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(i){i.addEventListener("pointerdown",this._pointerDownListener,!0),i.addEventListener("click",this._clickListener,!0),i.addEventListener("auxclick",this._clickListener,!0),i.addEventListener("contextmenu",this._clickListener,!0)}};e.\u0275fac=function(r){return new(r||e)(M(bt),M(wn),M(ze,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),pO=(()=>{let e=class e{constructor(i,r){this._platform=r,this._document=i}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let i="cdk-overlay-container";if(this._platform.isBrowser||Cp()){let s=this._document.querySelectorAll(`.${i}[platform="server"], .${i}[platform="test"]`);for(let o=0;o<s.length;o++)s[o].remove()}let r=this._document.createElement("div");r.classList.add(i),Cp()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}};e.\u0275fac=function(r){return new(r||e)(M(bt),M(wn))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Pp=class{constructor(e,t,i,r,s,o,a,c,l,u=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=c,this._outsideClickDispatcher=l,this._animationsDisabled=u,this._backdropElement=null,this._backdropClick=new ae,this._attachments=new ae,this._detachments=new ae,this._locationChanges=vr.EMPTY,this._backdropClickHandler=h=>this._backdropClick.next(h),this._backdropTransitionendHandler=h=>{this._disposeBackdrop(h.target)},this._keydownEvents=new ae,this._outsidePointerEvents=new ae,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Vi(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof t?.onDestroy=="function"&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){let e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=wt(wt({},this._config),e),this._updateElementSize()}setDirection(e){this._config=Li(wt({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){let e=this._config.direction;return e?typeof e=="string"?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let e=this._pane.style;e.width=ft(this._config.width),e.height=ft(this._config.height),e.minWidth=ft(this._config.minWidth),e.minHeight=ft(this._config.minHeight),e.maxWidth=ft(this._config.maxWidth),e.maxHeight=ft(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){let e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(e){if(this._animationsDisabled){this._disposeBackdrop(e);return}e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){let r=fc(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{let e=this._ngZone.onStable.pipe(lt(el(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){let e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},uO="cdk-overlay-connected-position-bounding-box",dQ=/([A-Za-z%]+)$/,Hp=class{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new ae,this._resizeSubscription=vr.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._overlayRef&&this._overlayRef,this._validatePositions(),e.hostElement.classList.add(uO),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[],o;for(let a of this._preferredPositions){let c=this._getOriginPoint(e,r,a),l=this._getOverlayPoint(c,t,a),u=this._getOverlayFit(l,t,i,a);if(u.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(a,c);return}if(this._canFitWithFlexibleDimensions(u,l,i)){s.push({position:a,origin:c,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(c,a)});continue}(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:l,originPoint:c,position:a,overlayRect:t})}if(s.length){let a=null,c=-1;for(let l of s){let u=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);u>c&&(c=u,a=l)}this._isPushed=!1,this._applyPosition(a.position,a.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(o.position,o.originPoint);return}this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&aa(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(uO),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,e.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r;if(i.originX=="center")r=e.left+e.width/2;else{let o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r=i.originX=="start"?o:a}t.left<0&&(r-=t.left);let s;return i.originY=="center"?s=e.top+e.height/2:s=i.originY=="top"?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r;i.overlayX=="center"?r=-t.width/2:i.overlayX==="start"?r=this._isRtl()?-t.width:0:r=this._isRtl()?0:-t.width;let s;return i.overlayY=="center"?s=-t.height/2:s=i.overlayY=="top"?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){let s=dO(t),{x:o,y:a}=e,c=this._getOffset(r,"x"),l=this._getOffset(r,"y");c&&(o+=c),l&&(a+=l);let u=0-o,h=o+s.width-i.width,d=0-a,m=a+s.height-i.height,p=this._subtractOverflows(s.width,u,h),v=this._subtractOverflows(s.height,d,m),w=p*v;return{visibleArea:w,isCompletelyWithinViewport:s.width*s.height===w,fitsInViewportVertically:v===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){let r=i.bottom-t.y,s=i.right-t.x,o=hO(this._overlayRef.getConfig().minHeight),a=hO(this._overlayRef.getConfig().minWidth),c=e.fitsInViewportVertically||o!=null&&o<=r,l=e.fitsInViewportHorizontally||a!=null&&a<=s;return c&&l}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};let r=dO(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),c=Math.max(s.top-i.top-e.y,0),l=Math.max(s.left-i.left-e.x,0),u=0,h=0;return r.width<=s.width?u=l||-o:u=e.x<this._viewportMargin?s.left-i.left-e.x:0,r.height<=s.height?h=c||-a:h=e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:h},{x:e.x+u,y:e.y+h}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){let i=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!fQ(this._lastScrollVisibility,i)){let r=new Np(e,i);this._positionChanges.next(r)}this._lastScrollVisibility=i}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;let t=this._boundingBox.querySelectorAll(this._transformOriginSelector),i,r=e.overlayY;e.overlayX==="center"?i="center":this._isRtl()?i=e.overlayX==="start"?"right":"left":i=e.overlayX==="start"?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){let i=this._viewportRect,r=this._isRtl(),s,o,a;if(t.overlayY==="top")o=e.y,s=i.height-o+this._viewportMargin;else if(t.overlayY==="bottom")a=i.height-e.y+this._viewportMargin*2,s=i.height-a+this._viewportMargin;else{let m=Math.min(i.bottom-e.y+i.top,e.y),p=this._lastBoundingBoxSize.height;s=m*2,o=e.y-m,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}let c=t.overlayX==="start"&&!r||t.overlayX==="end"&&r,l=t.overlayX==="end"&&!r||t.overlayX==="start"&&r,u,h,d;if(l)d=i.width-e.x+this._viewportMargin*2,u=e.x-this._viewportMargin;else if(c)h=e.x,u=i.right-e.x;else{let m=Math.min(i.right-e.x+i.left,e.x),p=this._lastBoundingBoxSize.width;u=m*2,h=e.x-m,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.x-p/2)}return{top:o,left:h,bottom:a,right:d,width:u,height:s}}_setBoundingBoxStyles(e,t){let i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));let r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{let s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=ft(i.height),r.top=ft(i.top),r.bottom=ft(i.bottom),r.width=ft(i.width),r.left=ft(i.left),r.right=ft(i.right),t.overlayX==="center"?r.alignItems="center":r.alignItems=t.overlayX==="end"?"flex-end":"flex-start",t.overlayY==="center"?r.justifyContent="center":r.justifyContent=t.overlayY==="bottom"?"flex-end":"flex-start",s&&(r.maxHeight=ft(s)),o&&(r.maxWidth=ft(o))}this._lastBoundingBoxSize=i,aa(this._boundingBox.style,r)}_resetBoundingBoxStyles(){aa(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){aa(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){let i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){let u=this._viewportRuler.getViewportScrollPosition();aa(i,this._getExactOverlayY(t,e,u)),aa(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",c=this._getOffset(t,"x"),l=this._getOffset(t,"y");c&&(a+=`translateX(${c}px) `),l&&(a+=`translateY(${l}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=ft(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=ft(o.maxWidth):s&&(i.maxWidth="")),aa(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);if(this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),e.overlayY==="bottom"){let o=this._document.documentElement.clientHeight;r.bottom=`${o-(s.y+this._overlayRect.height)}px`}else r.top=ft(s.y);return r}_getExactOverlayX(e,t,i){let r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i));let o;if(this._isRtl()?o=e.overlayX==="end"?"left":"right":o=e.overlayX==="end"?"right":"left",o==="right"){let a=this._document.documentElement.clientWidth;r.right=`${a-(s.x+this._overlayRect.width)}px`}else r.left=ft(s.x);return r}_getScrollVisibility(){let e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:lO(e,i),isOriginOutsideView:Lp(e,i),isOverlayClipped:lO(t,i),isOverlayOutsideView:Lp(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){let e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return t==="x"?e.offsetX==null?this._offsetX:e.offsetX:e.offsetY==null?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&fc(e).forEach(t=>{t!==""&&this._appliedPanelClasses.indexOf(t)===-1&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){let e=this._origin;if(e instanceof Ve)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();let t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}};function aa(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function hO(n){if(typeof n!="number"&&n!=null){let[e,t]=n.split(dQ);return!t||t==="px"?parseFloat(e):null}return n||null}function dO(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}function fQ(n,e){return n===e?!0:n.isOriginClipped===e.isOriginClipped&&n.isOriginOutsideView===e.isOriginOutsideView&&n.isOverlayClipped===e.isOverlayClipped&&n.isOverlayOutsideView===e.isOverlayOutsideView}var fO="cdk-global-overlay-wrapper",Bp=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){let t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(fO),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,c=(r==="100%"||r==="100vw")&&(!o||o==="100%"||o==="100vw"),l=(s==="100%"||s==="100vh")&&(!a||a==="100%"||a==="100vh"),u=this._xPosition,h=this._xOffset,d=this._overlayRef.getConfig().direction==="rtl",m="",p="",v="";c?v="flex-start":u==="center"?(v="center",d?p=h:m=h):d?u==="left"||u==="end"?(v="flex-end",m=h):(u==="right"||u==="start")&&(v="flex-start",p=h):u==="left"||u==="start"?(v="flex-start",m=h):(u==="right"||u==="end")&&(v="flex-end",p=h),e.position=this._cssPosition,e.marginLeft=c?"0":m,e.marginTop=l?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=c?"0":p,t.justifyContent=v,t.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(fO),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}},mQ=(()=>{let e=class e{constructor(i,r,s,o){this._viewportRuler=i,this._document=r,this._platform=s,this._overlayContainer=o}global(){return new Bp}flexibleConnectedTo(i){return new Hp(i,this._viewportRuler,this._document,this._platform,this._overlayContainer)}};e.\u0275fac=function(r){return new(r||e)(M(F2),M(bt),M(wn),M(pO))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),pQ=0,vc=(()=>{let e=class e{constructor(i,r,s,o,a,c,l,u,h,d,m,p){this.scrollStrategies=i,this._overlayContainer=r,this._componentFactoryResolver=s,this._positionBuilder=o,this._keyboardDispatcher=a,this._injector=c,this._ngZone=l,this._document=u,this._directionality=h,this._location=d,this._outsideClickDispatcher=m,this._animationsModuleType=p}create(i){let r=this._createHostElement(),s=this._createPaneElement(r),o=this._createPortalOutlet(s),a=new V0(i);return a.direction=a.direction||this._directionality.value,new Pp(o,r,s,a,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations")}position(){return this._positionBuilder}_createPaneElement(i){let r=this._document.createElement("div");return r.id=`cdk-overlay-${pQ++}`,r.classList.add("cdk-overlay-pane"),i.appendChild(r),r}_createHostElement(){let i=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(i),i}_createPortalOutlet(i){return this._appRef||(this._appRef=this._injector.get(Dg)),new A0(i,this._componentFactoryResolver,this._appRef,this._injector,this._document)}};e.\u0275fac=function(r){return new(r||e)(M(lQ),M(pO),M(sl),M(mQ),M(uQ),M(ya),M(ze),M(bt),M(pr),M(Rg),M(hQ),M(wa,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),gQ=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],gO=new Ce("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let n=to(vc);return()=>n.scrollStrategies.reposition()}}),Fp=(()=>{let e=class e{constructor(i){this.elementRef=i}};e.\u0275fac=function(r){return new(r||e)(H(Ve))},e.\u0275dir=Fe({type:e,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0});let n=e;return n})(),vO=(()=>{let e=class e{get offsetX(){return this._offsetX}set offsetX(i){this._offsetX=i,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(i){this._offsetY=i,this._position&&this._updatePositionStrategy(this._position)}get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(i){this._disposeOnNavigation=i}constructor(i,r,s,o,a){this._overlay=i,this._dir=a,this._backdropSubscription=vr.EMPTY,this._attachSubscription=vr.EMPTY,this._detachSubscription=vr.EMPTY,this._positionSubscription=vr.EMPTY,this._disposeOnNavigation=!1,this._ngZone=to(ze),this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.hasBackdrop=!1,this.lockPosition=!1,this.flexibleDimensions=!1,this.growAfterOpen=!1,this.push=!1,this.backdropClick=new Sn,this.positionChange=new Sn,this.attach=new Sn,this.detach=new Sn,this.overlayKeydown=new Sn,this.overlayOutsideClick=new Sn,this._templatePortal=new P2(r,s),this._scrollStrategyFactory=o,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(i){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),i.origin&&this.open&&this._position.apply()),i.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=gQ);let i=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=i.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=i.detachments().subscribe(()=>this.detach.emit()),i.keydownEvents().subscribe(r=>{this.overlayKeydown.next(r),r.keyCode===27&&!this.disableClose&&!aO(r)&&(r.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(r=>{this.overlayOutsideClick.next(r)})}_buildConfig(){let i=this._position=this.positionStrategy||this._createPositionStrategy(),r=new V0({direction:this._dir,positionStrategy:i,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(r.width=this.width),(this.height||this.height===0)&&(r.height=this.height),(this.minWidth||this.minWidth===0)&&(r.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(r.minHeight=this.minHeight),this.backdropClass&&(r.backdropClass=this.backdropClass),this.panelClass&&(r.panelClass=this.panelClass),r}_updatePositionStrategy(i){let r=this.positions.map(s=>({originX:s.originX,originY:s.originY,overlayX:s.overlayX,overlayY:s.overlayY,offsetX:s.offsetX||this.offsetX,offsetY:s.offsetY||this.offsetY,panelClass:s.panelClass||void 0}));return i.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(r).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let i=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(i),i}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof Fp?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(i=>{this.backdropClick.emit(i)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(wg(()=>this.positionChange.observers.length>0)).subscribe(i=>{this._ngZone.run(()=>this.positionChange.emit(i)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)(H(vc),H(Tn),H(Yr),H(gO),H(pr,8))},e.\u0275dir=Fe({type:e,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[Ue.None,"cdkConnectedOverlayOrigin","origin"],positions:[Ue.None,"cdkConnectedOverlayPositions","positions"],positionStrategy:[Ue.None,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[Ue.None,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[Ue.None,"cdkConnectedOverlayOffsetY","offsetY"],width:[Ue.None,"cdkConnectedOverlayWidth","width"],height:[Ue.None,"cdkConnectedOverlayHeight","height"],minWidth:[Ue.None,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[Ue.None,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[Ue.None,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[Ue.None,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[Ue.None,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[Ue.None,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[Ue.None,"cdkConnectedOverlayOpen","open"],disableClose:[Ue.None,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[Ue.None,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[Ue.HasDecoratorInputTransform,"cdkConnectedOverlayHasBackdrop","hasBackdrop",br],lockPosition:[Ue.HasDecoratorInputTransform,"cdkConnectedOverlayLockPosition","lockPosition",br],flexibleDimensions:[Ue.HasDecoratorInputTransform,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",br],growAfterOpen:[Ue.HasDecoratorInputTransform,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",br],push:[Ue.HasDecoratorInputTransform,"cdkConnectedOverlayPush","push",br],disposeOnNavigation:[Ue.HasDecoratorInputTransform,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",br]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[ol,Xt]});let n=e;return n})();function vQ(n){return()=>n.scrollStrategies.reposition()}var yQ={provide:gO,deps:[vc],useFactory:vQ},Kse=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({providers:[vc,yQ],imports:[H2,Gx,Dp,Dp]});let n=e;return n})();function wQ(n,e){n&1&&mi(0,"span",10)}function bQ(n,e){n&1&&mi(0,"span",11)}function CQ(n,e){n&1&&mi(0,"span",12)}function _Q(n,e){n&1&&mi(0,"span",13)}function SQ(n,e){n&1&&mi(0,"span",14)}function TQ(n,e){if(n&1&&(hu(0),mi(1,"span",15),du()),n&2){let t=mu();kn(),Rn("innerHTML",t.instance.content,Eg)}}function EQ(n,e){if(n&1){let t=zg();no(0,"nz-message",2),fu("destroyed",function(r){_g(t);let s=mu();return Sg(s.remove(r.id,r.userAction))}),Sa()}if(n&2){let t=e.$implicit;Rn("instance",t)}}var MQ=0,qp=class{constructor(e,t,i){this.nzSingletonService=e,this.overlay=t,this.injector=i}remove(e){this.container&&(e?this.container.remove(e):this.container.removeAll())}getInstanceId(){return`${this.componentPrefix}-${MQ++}`}withContainer(e){let t=this.nzSingletonService.getSingletonWithKey(this.componentPrefix);if(t)return t;let i=this.overlay.create({hasBackdrop:!1,scrollStrategy:this.overlay.scrollStrategies.noop(),positionStrategy:this.overlay.position().global()}),r=new N2(e,null,this.injector),s=i.attach(r),o=i.hostElement;return o.style.zIndex="1010",t||(this.container=t=s.instance,this.nzSingletonService.registerSingletonWithKey(this.componentPrefix,t),this.container.afterAllInstancesRemoved.subscribe(()=>{this.container=void 0,this.nzSingletonService.unregisterSingletonWithKey(this.componentPrefix),i.dispose()})),t}},zQ=(()=>{let e=class e{constructor(i,r){this.cdr=i,this.nzConfigService=r,this.instances=[],this._afterAllInstancesRemoved=new ae,this.afterAllInstancesRemoved=this._afterAllInstancesRemoved.asObservable(),this.destroy$=new ae,this.updateConfig()}ngOnInit(){this.subscribeConfigChange()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}create(i){let r=this.onCreate(i);return this.instances.length>=this.config.nzMaxStack&&(this.instances=this.instances.slice(1)),this.instances=[...this.instances,r],this.readyInstances(),r}remove(i,r=!1){this.instances.map((s,o)=>({index:o,instance:s})).filter(({instance:s})=>s.messageId===i).forEach(({index:s,instance:o})=>{this.instances.splice(s,1),this.instances=[...this.instances],this.onRemove(o,r),this.readyInstances()}),this.instances.length||this.onAllInstancesRemoved()}removeAll(){this.instances.forEach(i=>this.onRemove(i,!1)),this.instances=[],this.readyInstances(),this.onAllInstancesRemoved()}onCreate(i){return i.options=this.mergeOptions(i.options),i.onClose=new ae,i}onRemove(i,r){i.onClose.next(r),i.onClose.complete()}onAllInstancesRemoved(){this._afterAllInstancesRemoved.next(),this._afterAllInstancesRemoved.complete()}readyInstances(){this.cdr.detectChanges()}mergeOptions(i){let{nzDuration:r,nzAnimate:s,nzPauseOnHover:o}=this.config;return wt({nzDuration:r,nzAnimate:s,nzPauseOnHover:o},i)}};e.\u0275fac=function(r){return new(r||e)(H(pi),H(ra))},e.\u0275dir=Fe({type:e});let n=e;return n})(),xQ=(()=>{let e=class e{constructor(i){this.cdr=i,this.destroyed=new Sn,this.animationStateChanged=new ae,this.userAction=!1,this.eraseTimer=null}ngOnInit(){this.options=this.instance.options,this.options.nzAnimate&&(this.instance.state="enter",this.animationStateChanged.pipe(Nt(i=>i.phaseName==="done"&&i.toState==="leave"),Vi(1)).subscribe(()=>{clearTimeout(this.closeTimer),this.destroyed.next({id:this.instance.messageId,userAction:this.userAction})})),this.autoClose=this.options.nzDuration>0,this.autoClose&&(this.initErase(),this.startEraseTimeout())}ngOnDestroy(){this.autoClose&&this.clearEraseTimeout(),this.animationStateChanged.complete()}onEnter(){this.autoClose&&this.options.nzPauseOnHover&&(this.clearEraseTimeout(),this.updateTTL())}onLeave(){this.autoClose&&this.options.nzPauseOnHover&&this.startEraseTimeout()}destroy(i=!1){this.userAction=i,this.options.nzAnimate?(this.instance.state="leave",this.cdr.detectChanges(),this.closeTimer=setTimeout(()=>{this.closeTimer=void 0,this.destroyed.next({id:this.instance.messageId,userAction:i})},200)):this.destroyed.next({id:this.instance.messageId,userAction:i})}initErase(){this.eraseTTL=this.options.nzDuration,this.eraseTimingStart=Date.now()}updateTTL(){this.autoClose&&(this.eraseTTL-=Date.now()-this.eraseTimingStart)}startEraseTimeout(){this.eraseTTL>0?(this.clearEraseTimeout(),this.eraseTimer=setTimeout(()=>this.destroy(),this.eraseTTL),this.eraseTimingStart=Date.now()):this.destroy()}clearEraseTimeout(){this.eraseTimer!==null&&(clearTimeout(this.eraseTimer),this.eraseTimer=null)}};e.\u0275fac=function(r){return new(r||e)(H(pi))},e.\u0275dir=Fe({type:e});let n=e;return n})(),wO=(()=>{let e=class e extends xQ{constructor(i){super(i),this.destroyed=new Sn}};e.\u0275fac=function(r){return new(r||e)(H(pi))},e.\u0275cmp=$r({type:e,selectors:[["nz-message"]],inputs:{instance:"instance"},outputs:{destroyed:"destroyed"},exportAs:["nzMessage"],standalone:!0,features:[Hi,Qr],decls:10,vars:9,consts:[[1,"ant-message-notice",3,"mouseenter","mouseleave"],[1,"ant-message-notice-content"],[1,"ant-message-custom-content",3,"ngClass"],[3,"ngSwitch"],["nz-icon","","nzType","check-circle",4,"ngSwitchCase"],["nz-icon","","nzType","info-circle",4,"ngSwitchCase"],["nz-icon","","nzType","exclamation-circle",4,"ngSwitchCase"],["nz-icon","","nzType","close-circle",4,"ngSwitchCase"],["nz-icon","","nzType","loading",4,"ngSwitchCase"],[4,"nzStringTemplateOutlet"],["nz-icon","","nzType","check-circle"],["nz-icon","","nzType","info-circle"],["nz-icon","","nzType","exclamation-circle"],["nz-icon","","nzType","close-circle"],["nz-icon","","nzType","loading"],[3,"innerHTML"]],template:function(r,s){r&1&&(no(0,"div",0),fu("@moveUpMotion.done",function(a){return s.animationStateChanged.next(a)})("mouseenter",function(){return s.onEnter()})("mouseleave",function(){return s.onLeave()}),no(1,"div",1)(2,"div",2),hu(3,3),_a(4,wQ,1,0,"span",4)(5,bQ,1,0,"span",5)(6,CQ,1,0,"span",6)(7,_Q,1,0,"span",7)(8,SQ,1,0,"span",8),du(),_a(9,TQ,2,1,"ng-container",9),Sa()()()),r&2&&(Rn("@moveUpMotion",s.instance.state),kn(2),Rn("ngClass","ant-message-"+s.instance.type),kn(),Rn("ngSwitch",s.instance.type),kn(),Rn("ngSwitchCase","success"),kn(),Rn("ngSwitchCase","info"),kn(),Rn("ngSwitchCase","warning"),kn(),Rn("ngSwitchCase","error"),kn(),Rn("ngSwitchCase","loading"),kn(),Rn("nzStringTemplateOutlet",s.instance.content))},dependencies:[Lg,Ng,Pg,O0,pc,Kx,Yx],encapsulation:2,data:{animation:[$x]},changeDetection:0});let n=e;return n})(),N0="message",OQ={nzAnimate:!0,nzDuration:3e3,nzMaxStack:7,nzPauseOnHover:!0,nzTop:24,nzDirection:"ltr"},bO=(()=>{let e=class e extends zQ{constructor(i,r){super(i,r),this.dir="ltr";let s=this.nzConfigService.getConfigForComponent(N0);this.dir=s?.nzDirection||"ltr"}subscribeConfigChange(){this.nzConfigService.getConfigChangeEventForComponent(N0).pipe(lt(this.destroy$)).subscribe(()=>{this.updateConfig();let i=this.nzConfigService.getConfigForComponent(N0);if(i){let{nzDirection:r}=i;this.dir=r||this.dir}})}updateConfig(){this.config=wt(wt(wt({},OQ),this.config),this.nzConfigService.getConfigForComponent(N0)),this.top=Nz(this.config.nzTop),this.cdr.markForCheck()}};e.\u0275fac=function(r){return new(r||e)(H(pi),H(ra))},e.\u0275cmp=$r({type:e,selectors:[["nz-message-container"]],exportAs:["nzMessageContainer"],standalone:!0,features:[Hi,Qr],decls:2,vars:5,consts:[[1,"ant-message"],[3,"instance","destroyed",4,"ngFor","ngForOf"],[3,"destroyed","instance"]],template:function(r,s){r&1&&(no(0,"div",0),_a(1,EQ,1,1,"nz-message",1),Sa()),r&2&&(al("top",s.top),wr("ant-message-rtl",s.dir==="rtl"),kn(),Rn("ngForOf",s.instances))},dependencies:[wO,Vg],encapsulation:2,changeDetection:0});let n=e;return n})(),poe=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({imports:[bO,wO]});let n=e;return n})(),goe=(()=>{let e=class e extends qp{constructor(i,r,s){super(i,r,s),this.componentPrefix="message-"}success(i,r){return this.createInstance({type:"success",content:i},r)}error(i,r){return this.createInstance({type:"error",content:i},r)}info(i,r){return this.createInstance({type:"info",content:i},r)}warning(i,r){return this.createInstance({type:"warning",content:i},r)}loading(i,r){return this.createInstance({type:"loading",content:i},r)}create(i,r,s){return this.createInstance({type:i,content:r},s)}createInstance(i,r){return this.container=this.withContainer(bO),this.container.create(Li(wt({},i),{createdAt:new Date,messageId:this.getInstanceId(),options:r}))}};e.\u0275fac=function(r){return new(r||e)(M(Jx),M(vc),M(ya))},e.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Gt(n){"@babel/helpers - typeof";return Gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(n)}function S(n,e){if(e.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+e.length+" present")}function N(n){S(1,arguments);var e=Object.prototype.toString.call(n);return n instanceof Date||Gt(n)==="object"&&e==="[object Date]"?new Date(n.getTime()):typeof n=="number"||e==="[object Number]"?new Date(n):((typeof n=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function gr(n){S(1,arguments);var e=N(n);return e.setHours(0,0,0,0),e}function q2(n){S(1,arguments);var e=N(n);return e.setHours(23,59,59,999),e}function CO(){return q2(Date.now())}function Up(n){return S(1,arguments),n instanceof Date||Gt(n)==="object"&&Object.prototype.toString.call(n)==="[object Date]"}function P0(n){if(S(1,arguments),!Up(n)&&typeof n!="number")return!1;var e=N(n);return!isNaN(Number(e))}function ie(n){if(n===null||n===!0||n===!1)return NaN;var e=Number(n);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function U2(n,e){S(2,arguments);var t=N(n).getTime(),i=ie(e);return new Date(t+i)}function j2(n,e){S(2,arguments);var t=ie(e);return U2(n,-t)}var IQ=864e5;function jp(n){S(1,arguments);var e=N(n),t=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var i=e.getTime(),r=t-i;return Math.floor(r/IQ)+1}function ui(n){S(1,arguments);var e=1,t=N(n),i=t.getUTCDay(),r=(i<e?7:0)+i-e;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function W2(n){S(1,arguments);var e=N(n),t=e.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(t+1,0,4),i.setUTCHours(0,0,0,0);var r=ui(i),s=new Date(0);s.setUTCFullYear(t,0,4),s.setUTCHours(0,0,0,0);var o=ui(s);return e.getTime()>=r.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function Wp(n){S(1,arguments);var e=W2(n),t=new Date(0);t.setUTCFullYear(e,0,4),t.setUTCHours(0,0,0,0);var i=ui(t);return i}var AQ=6048e5;function G2(n){S(1,arguments);var e=N(n),t=ui(e).getTime()-Wp(e).getTime();return Math.round(t/AQ)+1}var DQ={};function cn(){return DQ}function Wn(n,e){var t,i,r,s,o,a,c,l;S(1,arguments);var u=cn(),h=ie((t=(i=(r=(s=e?.weekStartsOn)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&r!==void 0?r:u.weekStartsOn)!==null&&i!==void 0?i:(c=u.locale)===null||c===void 0||(l=c.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&t!==void 0?t:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=N(n),m=d.getUTCDay(),p=(m<h?7:0)+m-h;return d.setUTCDate(d.getUTCDate()-p),d.setUTCHours(0,0,0,0),d}function ca(n,e){var t,i,r,s,o,a,c,l;S(1,arguments);var u=N(n),h=u.getUTCFullYear(),d=cn(),m=ie((t=(i=(r=(s=e?.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&r!==void 0?r:d.firstWeekContainsDate)!==null&&i!==void 0?i:(c=d.locale)===null||c===void 0||(l=c.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&t!==void 0?t:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(h+1,0,m),p.setUTCHours(0,0,0,0);var v=Wn(p,e),w=new Date(0);w.setUTCFullYear(h,0,m),w.setUTCHours(0,0,0,0);var A=Wn(w,e);return u.getTime()>=v.getTime()?h+1:u.getTime()>=A.getTime()?h:h-1}function Gp(n,e){var t,i,r,s,o,a,c,l;S(1,arguments);var u=cn(),h=ie((t=(i=(r=(s=e?.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&r!==void 0?r:u.firstWeekContainsDate)!==null&&i!==void 0?i:(c=u.locale)===null||c===void 0||(l=c.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&t!==void 0?t:1),d=ca(n,e),m=new Date(0);m.setUTCFullYear(d,0,h),m.setUTCHours(0,0,0,0);var p=Wn(m,e);return p}var kQ=6048e5;function $2(n,e){S(1,arguments);var t=N(n),i=Wn(t,e).getTime()-Gp(t,e).getTime();return Math.round(i/kQ)+1}function De(n,e){for(var t=n<0?"-":"",i=Math.abs(n).toString();i.length<e;)i="0"+i;return t+i}var RQ={y:function(e,t){var i=e.getUTCFullYear(),r=i>0?i:1-i;return De(t==="yy"?r%100:r,t.length)},M:function(e,t){var i=e.getUTCMonth();return t==="M"?String(i+1):De(i+1,2)},d:function(e,t){return De(e.getUTCDate(),t.length)},a:function(e,t){var i=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];case"aaaa":default:return i==="am"?"a.m.":"p.m."}},h:function(e,t){return De(e.getUTCHours()%12||12,t.length)},H:function(e,t){return De(e.getUTCHours(),t.length)},m:function(e,t){return De(e.getUTCMinutes(),t.length)},s:function(e,t){return De(e.getUTCSeconds(),t.length)},S:function(e,t){var i=t.length,r=e.getUTCMilliseconds(),s=Math.floor(r*Math.pow(10,i-3));return De(s,t.length)}},jr=RQ;var yc={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},LQ={G:function(e,t,i){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"});case"GGGGG":return i.era(r,{width:"narrow"});case"GGGG":default:return i.era(r,{width:"wide"})}},y:function(e,t,i){if(t==="yo"){var r=e.getUTCFullYear(),s=r>0?r:1-r;return i.ordinalNumber(s,{unit:"year"})}return jr.y(e,t)},Y:function(e,t,i,r){var s=ca(e,r),o=s>0?s:1-s;if(t==="YY"){var a=o%100;return De(a,2)}return t==="Yo"?i.ordinalNumber(o,{unit:"year"}):De(o,t.length)},R:function(e,t){var i=W2(e);return De(i,t.length)},u:function(e,t){var i=e.getUTCFullYear();return De(i,t.length)},Q:function(e,t,i){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return De(r,2);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,i){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return De(r,2);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,i){var r=e.getUTCMonth();switch(t){case"M":case"MM":return jr.M(e,t);case"Mo":return i.ordinalNumber(r+1,{unit:"month"});case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,i){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return De(r+1,2);case"Lo":return i.ordinalNumber(r+1,{unit:"month"});case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,i,r){var s=$2(e,r);return t==="wo"?i.ordinalNumber(s,{unit:"week"}):De(s,t.length)},I:function(e,t,i){var r=G2(e);return t==="Io"?i.ordinalNumber(r,{unit:"week"}):De(r,t.length)},d:function(e,t,i){return t==="do"?i.ordinalNumber(e.getUTCDate(),{unit:"date"}):jr.d(e,t)},D:function(e,t,i){var r=jp(e);return t==="Do"?i.ordinalNumber(r,{unit:"dayOfYear"}):De(r,t.length)},E:function(e,t,i){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"});case"EEEE":default:return i.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,i,r){var s=e.getUTCDay(),o=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return De(o,2);case"eo":return i.ordinalNumber(o,{unit:"day"});case"eee":return i.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(s,{width:"short",context:"formatting"});case"eeee":default:return i.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,i,r){var s=e.getUTCDay(),o=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return De(o,t.length);case"co":return i.ordinalNumber(o,{unit:"day"});case"ccc":return i.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(s,{width:"narrow",context:"standalone"});case"cccccc":return i.day(s,{width:"short",context:"standalone"});case"cccc":default:return i.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,i){var r=e.getUTCDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return De(s,t.length);case"io":return i.ordinalNumber(s,{unit:"day"});case"iii":return i.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(r,{width:"short",context:"formatting"});case"iiii":default:return i.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,i){var r=e.getUTCHours(),s=r/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,i){var r=e.getUTCHours(),s;switch(r===12?s=yc.noon:r===0?s=yc.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,i){var r=e.getUTCHours(),s;switch(r>=17?s=yc.evening:r>=12?s=yc.afternoon:r>=4?s=yc.morning:s=yc.night,t){case"B":case"BB":case"BBB":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,i){if(t==="ho"){var r=e.getUTCHours()%12;return r===0&&(r=12),i.ordinalNumber(r,{unit:"hour"})}return jr.h(e,t)},H:function(e,t,i){return t==="Ho"?i.ordinalNumber(e.getUTCHours(),{unit:"hour"}):jr.H(e,t)},K:function(e,t,i){var r=e.getUTCHours()%12;return t==="Ko"?i.ordinalNumber(r,{unit:"hour"}):De(r,t.length)},k:function(e,t,i){var r=e.getUTCHours();return r===0&&(r=24),t==="ko"?i.ordinalNumber(r,{unit:"hour"}):De(r,t.length)},m:function(e,t,i){return t==="mo"?i.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):jr.m(e,t)},s:function(e,t,i){return t==="so"?i.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):jr.s(e,t)},S:function(e,t){return jr.S(e,t)},X:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();if(o===0)return"Z";switch(t){case"X":return SO(o);case"XXXX":case"XX":return la(o);case"XXXXX":case"XXX":default:return la(o,":")}},x:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();switch(t){case"x":return SO(o);case"xxxx":case"xx":return la(o);case"xxxxx":case"xxx":default:return la(o,":")}},O:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+_O(o,":");case"OOOO":default:return"GMT"+la(o,":")}},z:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+_O(o,":");case"zzzz":default:return"GMT"+la(o,":")}},t:function(e,t,i,r){var s=r._originalDate||e,o=Math.floor(s.getTime()/1e3);return De(o,t.length)},T:function(e,t,i,r){var s=r._originalDate||e,o=s.getTime();return De(o,t.length)}};function _O(n,e){var t=n>0?"-":"+",i=Math.abs(n),r=Math.floor(i/60),s=i%60;if(s===0)return t+String(r);var o=e||"";return t+String(r)+o+De(s,2)}function SO(n,e){if(n%60===0){var t=n>0?"-":"+";return t+De(Math.abs(n)/60,2)}return la(n,e)}function la(n,e){var t=e||"",i=n>0?"-":"+",r=Math.abs(n),s=De(Math.floor(r/60),2),o=De(r%60,2);return i+s+t+o}var TO=LQ;var EO=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},MO=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},VQ=function(e,t){var i=e.match(/(P+)(p+)?/)||[],r=i[1],s=i[2];if(!s)return EO(e,t);var o;switch(r){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",EO(r,t)).replace("{{time}}",MO(s,t))},NQ={p:MO,P:VQ},Y2=NQ;function Zs(n){var e=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return e.setUTCFullYear(n.getFullYear()),n.getTime()-e.getTime()}var PQ=["D","DD"],HQ=["YY","YYYY"];function H0(n){return PQ.indexOf(n)!==-1}function B0(n){return HQ.indexOf(n)!==-1}function wc(n,e,t){if(n==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var BQ={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},FQ=function(e,t,i){var r,s=BQ[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"in "+r:r+" ago":r},zO=FQ;function K2(n){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.width?String(e.width):n.defaultWidth,i=n.formats[t]||n.formats[n.defaultWidth];return i}}var qQ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},UQ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},jQ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},WQ={date:K2({formats:qQ,defaultWidth:"full"}),time:K2({formats:UQ,defaultWidth:"full"}),dateTime:K2({formats:jQ,defaultWidth:"full"})},xO=WQ;var GQ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},$Q=function(e,t,i,r){return GQ[e]},OO=$Q;function ua(n){return function(e,t){var i=t!=null&&t.context?String(t.context):"standalone",r;if(i==="formatting"&&n.formattingValues){var s=n.defaultFormattingWidth||n.defaultWidth,o=t!=null&&t.width?String(t.width):s;r=n.formattingValues[o]||n.formattingValues[s]}else{var a=n.defaultWidth,c=t!=null&&t.width?String(t.width):n.defaultWidth;r=n.values[c]||n.values[a]}var l=n.argumentCallback?n.argumentCallback(e):e;return r[l]}}var YQ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},KQ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},QQ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},XQ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ZQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},JQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},eX=function(e,t){var i=Number(e),r=i%100;if(r>20||r<10)switch(r%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},tX={ordinalNumber:eX,era:ua({values:YQ,defaultWidth:"wide"}),quarter:ua({values:KQ,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:ua({values:QQ,defaultWidth:"wide"}),day:ua({values:XQ,defaultWidth:"wide"}),dayPeriod:ua({values:ZQ,defaultWidth:"wide",formattingValues:JQ,defaultFormattingWidth:"wide"})},IO=tX;function ha(n){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.width,r=i&&n.matchPatterns[i]||n.matchPatterns[n.defaultMatchWidth],s=e.match(r);if(!s)return null;var o=s[0],a=i&&n.parsePatterns[i]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(a)?iX(a,function(h){return h.test(o)}):nX(a,function(h){return h.test(o)}),l;l=n.valueCallback?n.valueCallback(c):c,l=t.valueCallback?t.valueCallback(l):l;var u=e.slice(o.length);return{value:l,rest:u}}}function nX(n,e){for(var t in n)if(n.hasOwnProperty(t)&&e(n[t]))return t}function iX(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return t}function $p(n){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.match(n.matchPattern);if(!i)return null;var r=i[0],s=e.match(n.parsePattern);if(!s)return null;var o=n.valueCallback?n.valueCallback(s[0]):s[0];o=t.valueCallback?t.valueCallback(o):o;var a=e.slice(r.length);return{value:o,rest:a}}}var rX=/^(\d+)(th|st|nd|rd)?/i,sX=/\d+/i,oX={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},aX={any:[/^b/i,/^(a|c)/i]},cX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},lX={any:[/1/i,/2/i,/3/i,/4/i]},uX={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},hX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},dX={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},fX={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},mX={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},pX={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},gX={ordinalNumber:$p({matchPattern:rX,parsePattern:sX,valueCallback:function(e){return parseInt(e,10)}}),era:ha({matchPatterns:oX,defaultMatchWidth:"wide",parsePatterns:aX,defaultParseWidth:"any"}),quarter:ha({matchPatterns:cX,defaultMatchWidth:"wide",parsePatterns:lX,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:ha({matchPatterns:uX,defaultMatchWidth:"wide",parsePatterns:hX,defaultParseWidth:"any"}),day:ha({matchPatterns:dX,defaultMatchWidth:"wide",parsePatterns:fX,defaultParseWidth:"any"}),dayPeriod:ha({matchPatterns:mX,defaultMatchWidth:"any",parsePatterns:pX,defaultParseWidth:"any"})},AO=gX;var vX={code:"en-US",formatDistance:zO,formatLong:xO,formatRelative:OO,localize:IO,match:AO,options:{weekStartsOn:0,firstWeekContainsDate:1}},DO=vX;var F0=DO;var yX=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,wX=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,bX=/^'([^]*?)'?$/,CX=/''/g,_X=/[a-zA-Z]/;function kO(n,e,t){var i,r,s,o,a,c,l,u,h,d,m,p,v,w,A,_,k,R;S(2,arguments);var U=String(e),X=cn(),re=(i=(r=t?.locale)!==null&&r!==void 0?r:X.locale)!==null&&i!==void 0?i:F0,Le=ie((s=(o=(a=(c=t?.firstWeekContainsDate)!==null&&c!==void 0?c:t==null||(l=t.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&a!==void 0?a:X.firstWeekContainsDate)!==null&&o!==void 0?o:(h=X.locale)===null||h===void 0||(d=h.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(Le>=1&&Le<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Xe=ie((m=(p=(v=(w=t?.weekStartsOn)!==null&&w!==void 0?w:t==null||(A=t.locale)===null||A===void 0||(_=A.options)===null||_===void 0?void 0:_.weekStartsOn)!==null&&v!==void 0?v:X.weekStartsOn)!==null&&p!==void 0?p:(k=X.locale)===null||k===void 0||(R=k.options)===null||R===void 0?void 0:R.weekStartsOn)!==null&&m!==void 0?m:0);if(!(Xe>=0&&Xe<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!re.localize)throw new RangeError("locale must contain localize property");if(!re.formatLong)throw new RangeError("locale must contain formatLong property");var ve=N(n);if(!P0(ve))throw new RangeError("Invalid time value");var z=Zs(ve),Be=j2(ve,z),x={firstWeekContainsDate:Le,weekStartsOn:Xe,locale:re,_originalDate:ve},f=U.match(wX).map(function(V){var se=V[0];if(se==="p"||se==="P"){var Oe=Y2[se];return Oe(V,re.formatLong)}return V}).join("").match(yX).map(function(V){if(V==="''")return"'";var se=V[0];if(se==="'")return SX(V);var Oe=TO[se];if(Oe)return!(t!=null&&t.useAdditionalWeekYearTokens)&&B0(V)&&wc(V,e,String(n)),!(t!=null&&t.useAdditionalDayOfYearTokens)&&H0(V)&&wc(V,e,String(n)),Oe(Be,V,re.localize,x);if(se.match(_X))throw new RangeError("Format string contains an unescaped latin alphabet character `"+se+"`");return V}).join("");return f}function SX(n){var e=n.match(bX);return e?e[1].replace(CX,"'"):n}function RO(n){S(1,arguments);var e=ie(n);return N(e*1e3)}function LO(){return gr(Date.now())}function q0(n,e){S(2,arguments);var t=N(n),i=ie(e);return isNaN(i)?new Date(NaN):(i&&t.setDate(t.getDate()+i),t)}function U0(n,e){S(2,arguments);var t=N(n),i=ie(e);if(isNaN(i))return new Date(NaN);if(!i)return t;var r=t.getDate(),s=new Date(t.getTime());s.setMonth(t.getMonth()+i+1,0);var o=s.getDate();return r>=o?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}function j0(n,e){var t,i,r,s,o,a,c,l;S(1,arguments);var u=cn(),h=ie((t=(i=(r=(s=e?.weekStartsOn)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&r!==void 0?r:u.weekStartsOn)!==null&&i!==void 0?i:(c=u.locale)===null||c===void 0||(l=c.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&t!==void 0?t:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=N(n),m=d.getDay(),p=(m<h?7:0)+m-h;return d.setDate(d.getDate()-p),d.setHours(0,0,0,0),d}function Js(n){return S(1,arguments),j0(n,{weekStartsOn:1})}function Yp(n){S(1,arguments);var e=N(n),t=e.getFullYear(),i=new Date(0);i.setFullYear(t+1,0,4),i.setHours(0,0,0,0);var r=Js(i),s=new Date(0);s.setFullYear(t,0,4),s.setHours(0,0,0,0);var o=Js(s);return e.getTime()>=r.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function Kp(n){S(1,arguments);var e=Yp(n),t=new Date(0);t.setFullYear(e,0,4),t.setHours(0,0,0,0);var i=Js(t);return i}var TX=864e5;function VO(n,e){S(2,arguments);var t=gr(n),i=gr(e),r=t.getTime()-Zs(t),s=i.getTime()-Zs(i);return Math.round((r-s)/TX)}var EX=6e4;function NO(n,e){S(2,arguments);var t=ie(e);return U2(n,t*EX)}function PO(n,e){S(2,arguments);var t=ie(e);return U0(n,t*12)}var MX=365.2425,zX=Math.pow(10,8)*24*60*60*1e3,W0=6e4,G0=36e5,HO=1e3,vce=-zX;var xX=3600;var BO=xX*24,yce=BO*7,OX=BO*MX,IX=OX/12,wce=IX*3;function $0(n,e){S(2,arguments);var t=gr(n),i=gr(e);return t.getTime()===i.getTime()}function FO(n,e){S(2,arguments);var t=N(n),i=N(e),r=t.getFullYear()-i.getFullYear(),s=t.getMonth()-i.getMonth();return r*12+s}function qO(n,e){S(2,arguments);var t=N(n),i=N(e);return t.getFullYear()-i.getFullYear()}function da(n,e){return S(2,arguments),N(n).getTime()-N(e).getTime()}var UO={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},AX="trunc";function bc(n){return n?UO[n]:UO[AX]}function jO(n,e,t){S(2,arguments);var i=da(n,e)/G0;return bc(t?.roundingMethod)(i)}function WO(n,e,t){S(2,arguments);var i=da(n,e)/W0;return bc(t?.roundingMethod)(i)}function Qp(n){S(1,arguments);var e=N(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function GO(n){S(1,arguments);var e=N(n);return q2(e).getTime()===Qp(e).getTime()}function $O(n,e,t){S(2,arguments);var i=da(n,e)/1e3;return bc(t?.roundingMethod)(i)}function Y0(n){S(1,arguments);var e=N(n);return e.setSeconds(0,0),e}function YO(n){S(1,arguments);var e=N(n);return e.setDate(1),e.setHours(0,0,0,0),e}function Xp(n,e){if(n==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n}function Zp(n){S(1,arguments);var e=N(n),t=e.getFullYear(),i=e.getMonth(),r=new Date(0);return r.setFullYear(t,i+1,0),r.setHours(0,0,0,0),r.getDate()}var DX=6048e5;function KO(n){S(1,arguments);var e=N(n),t=Js(e).getTime()-Kp(e).getTime();return Math.round(t/DX)+1}function QO(n){return S(1,arguments),N(n).getDate()===1}function K0(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function Jp(n,e){if(n){if(typeof n=="string")return K0(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return K0(n,e)}}function Q0(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Jp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var i=0,r=function(){};return{s:r,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){t=t.call(n)},n:function(){var l=t.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function D(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Q2(n,e){return Q2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},Q2(n,e)}function Y(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Q2(n,e)}function Cc(n){return Cc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Cc(n)}function X0(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(X0=function(){return!!n})()}function eg(n,e){if(e&&(Gt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D(n)}function K(n){var e=X0();return function(){var i=Cc(n),r;if(e){var s=Cc(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return eg(this,r)}}function W(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function tg(n,e){if(Gt(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(Gt(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function X2(n){var e=tg(n,"string");return Gt(e)=="symbol"?e:String(e)}function XO(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,X2(i.key),i)}}function G(n,e,t){return e&&XO(n.prototype,e),t&&XO(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function I(n,e,t){return e=X2(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var kX=10,ZO=function(){function n(){W(this,n),I(this,"priority",void 0),I(this,"subPriority",0)}return G(n,[{key:"validate",value:function(t,i){return!0}}]),n}(),JO=function(n){Y(t,n);var e=K(t);function t(i,r,s,o,a){var c;return W(this,t),c=e.call(this),c.value=i,c.validateValue=r,c.setValue=s,c.priority=o,a&&(c.subPriority=a),c}return G(t,[{key:"validate",value:function(r,s){return this.validateValue(r,this.value,s)}},{key:"set",value:function(r,s,o){return this.setValue(r,s,this.value,o)}}]),t}(ZO),eI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",kX),I(D(i),"subPriority",-1),i}return G(t,[{key:"set",value:function(r,s){if(s.timestampIsSet)return r;var o=new Date(0);return o.setFullYear(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()),o.setHours(r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()),o}}]),t}(ZO);var Q=function(){function n(){W(this,n),I(this,"incompatibleTokens",void 0),I(this,"priority",void 0),I(this,"subPriority",void 0)}return G(n,[{key:"run",value:function(t,i,r,s){var o=this.parse(t,i,r,s);return o?{setter:new JO(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(t,i,r){return!0}}]),n}();var tI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",140),I(D(i),"incompatibleTokens",["R","u","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"G":case"GG":case"GGG":return o.era(r,{width:"abbreviated"})||o.era(r,{width:"narrow"});case"GGGGG":return o.era(r,{width:"narrow"});case"GGGG":default:return o.era(r,{width:"wide"})||o.era(r,{width:"abbreviated"})||o.era(r,{width:"narrow"})}}},{key:"set",value:function(r,s,o){return s.era=o,r.setUTCFullYear(o,0,1),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var Me={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},hi={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function He(n,e){return n&&{value:e(n.value),rest:n.rest}}function we(n,e){var t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function di(n,e){var t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};var i=t[1]==="+"?1:-1,r=t[2]?parseInt(t[2],10):0,s=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:i*(r*G0+s*W0+o*HO),rest:e.slice(t[0].length)}}function Z0(n){return we(Me.anyDigitsSigned,n)}function de(n,e){switch(n){case 1:return we(Me.singleDigit,e);case 2:return we(Me.twoDigits,e);case 3:return we(Me.threeDigits,e);case 4:return we(Me.fourDigits,e);default:return we(new RegExp("^\\d{1,"+n+"}"),e)}}function _c(n,e){switch(n){case 1:return we(Me.singleDigitSigned,e);case 2:return we(Me.twoDigitsSigned,e);case 3:return we(Me.threeDigitsSigned,e);case 4:return we(Me.fourDigitsSigned,e);default:return we(new RegExp("^-?\\d{1,"+n+"}"),e)}}function Sc(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function J0(n,e){var t=e>0,i=t?e:1-e,r;if(i<=50)r=n||100;else{var s=i+50,o=Math.floor(s/100)*100,a=n>=s%100;r=n+o-(a?100:0)}return t?r:1-r}function eu(n){return n%400===0||n%4===0&&n%100!==0}var nI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",130),I(D(i),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){var a=function(l){return{year:l,isTwoDigitYear:s==="yy"}};switch(s){case"y":return He(de(4,r),a);case"yo":return He(o.ordinalNumber(r,{unit:"year"}),a);default:return He(de(s.length,r),a)}}},{key:"validate",value:function(r,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(r,s,o){var a=r.getUTCFullYear();if(o.isTwoDigitYear){var c=J0(o.year,a);return r.setUTCFullYear(c,0,1),r.setUTCHours(0,0,0,0),r}var l=!("era"in s)||s.era===1?o.year:1-o.year;return r.setUTCFullYear(l,0,1),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var iI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",130),I(D(i),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){var a=function(l){return{year:l,isTwoDigitYear:s==="YY"}};switch(s){case"Y":return He(de(4,r),a);case"Yo":return He(o.ordinalNumber(r,{unit:"year"}),a);default:return He(de(s.length,r),a)}}},{key:"validate",value:function(r,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(r,s,o,a){var c=ca(r,a);if(o.isTwoDigitYear){var l=J0(o.year,c);return r.setUTCFullYear(l,0,a.firstWeekContainsDate),r.setUTCHours(0,0,0,0),Wn(r,a)}var u=!("era"in s)||s.era===1?o.year:1-o.year;return r.setUTCFullYear(u,0,a.firstWeekContainsDate),r.setUTCHours(0,0,0,0),Wn(r,a)}}]),t}(Q);var rI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",130),I(D(i),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s){return s==="R"?_c(4,r):_c(s.length,r)}},{key:"set",value:function(r,s,o){var a=new Date(0);return a.setUTCFullYear(o,0,4),a.setUTCHours(0,0,0,0),ui(a)}}]),t}(Q);var sI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",130),I(D(i),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s){return s==="u"?_c(4,r):_c(s.length,r)}},{key:"set",value:function(r,s,o){return r.setUTCFullYear(o,0,1),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var oI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",120),I(D(i),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"Q":case"QQ":return de(s.length,r);case"Qo":return o.ordinalNumber(r,{unit:"quarter"});case"QQQ":return o.quarter(r,{width:"abbreviated",context:"formatting"})||o.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(r,{width:"wide",context:"formatting"})||o.quarter(r,{width:"abbreviated",context:"formatting"})||o.quarter(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=1&&s<=4}},{key:"set",value:function(r,s,o){return r.setUTCMonth((o-1)*3,1),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var aI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",120),I(D(i),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"q":case"qq":return de(s.length,r);case"qo":return o.ordinalNumber(r,{unit:"quarter"});case"qqq":return o.quarter(r,{width:"abbreviated",context:"standalone"})||o.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(r,{width:"wide",context:"standalone"})||o.quarter(r,{width:"abbreviated",context:"standalone"})||o.quarter(r,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(r,s){return s>=1&&s<=4}},{key:"set",value:function(r,s,o){return r.setUTCMonth((o-1)*3,1),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var cI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),I(D(i),"priority",110),i}return G(t,[{key:"parse",value:function(r,s,o){var a=function(l){return l-1};switch(s){case"M":return He(we(Me.month,r),a);case"MM":return He(de(2,r),a);case"Mo":return He(o.ordinalNumber(r,{unit:"month"}),a);case"MMM":return o.month(r,{width:"abbreviated",context:"formatting"})||o.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return o.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(r,{width:"wide",context:"formatting"})||o.month(r,{width:"abbreviated",context:"formatting"})||o.month(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=11}},{key:"set",value:function(r,s,o){return r.setUTCMonth(o,1),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var lI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",110),I(D(i),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){var a=function(l){return l-1};switch(s){case"L":return He(we(Me.month,r),a);case"LL":return He(de(2,r),a);case"Lo":return He(o.ordinalNumber(r,{unit:"month"}),a);case"LLL":return o.month(r,{width:"abbreviated",context:"standalone"})||o.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return o.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(r,{width:"wide",context:"standalone"})||o.month(r,{width:"abbreviated",context:"standalone"})||o.month(r,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=11}},{key:"set",value:function(r,s,o){return r.setUTCMonth(o,1),r.setUTCHours(0,0,0,0),r}}]),t}(Q);function ng(n,e,t){S(2,arguments);var i=N(n),r=ie(e),s=$2(i,t)-r;return i.setUTCDate(i.getUTCDate()-s*7),i}var uI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",100),I(D(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"w":return we(Me.week,r);case"wo":return o.ordinalNumber(r,{unit:"week"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=53}},{key:"set",value:function(r,s,o,a){return Wn(ng(r,o,a),a)}}]),t}(Q);function ig(n,e){S(2,arguments);var t=N(n),i=ie(e),r=G2(t)-i;return t.setUTCDate(t.getUTCDate()-r*7),t}var hI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",100),I(D(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"I":return we(Me.week,r);case"Io":return o.ordinalNumber(r,{unit:"week"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=53}},{key:"set",value:function(r,s,o){return ui(ig(r,o))}}]),t}(Q);var RX=[31,28,31,30,31,30,31,31,30,31,30,31],LX=[31,29,31,30,31,30,31,31,30,31,30,31],dI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",90),I(D(i),"subPriority",1),I(D(i),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"d":return we(Me.date,r);case"do":return o.ordinalNumber(r,{unit:"date"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){var o=r.getUTCFullYear(),a=eu(o),c=r.getUTCMonth();return a?s>=1&&s<=LX[c]:s>=1&&s<=RX[c]}},{key:"set",value:function(r,s,o){return r.setUTCDate(o),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var fI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",90),I(D(i),"subpriority",1),I(D(i),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"D":case"DD":return we(Me.dayOfYear,r);case"Do":return o.ordinalNumber(r,{unit:"date"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){var o=r.getUTCFullYear(),a=eu(o);return a?s>=1&&s<=366:s>=1&&s<=365}},{key:"set",value:function(r,s,o){return r.setUTCMonth(0,o),r.setUTCHours(0,0,0,0),r}}]),t}(Q);function fa(n,e,t){var i,r,s,o,a,c,l,u;S(2,arguments);var h=cn(),d=ie((i=(r=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(a=t.locale)===null||a===void 0||(c=a.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&s!==void 0?s:h.weekStartsOn)!==null&&r!==void 0?r:(l=h.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&i!==void 0?i:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=N(n),p=ie(e),v=m.getUTCDay(),w=p%7,A=(w+7)%7,_=(A<d?7:0)+p-v;return m.setUTCDate(m.getUTCDate()+_),m}var mI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",90),I(D(i),"incompatibleTokens",["D","i","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"E":case"EE":case"EEE":return o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(r,{width:"wide",context:"formatting"})||o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=6}},{key:"set",value:function(r,s,o,a){return r=fa(r,o,a),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var pI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",90),I(D(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o,a){var c=function(u){var h=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+h};switch(s){case"e":case"ee":return He(de(s.length,r),c);case"eo":return He(o.ordinalNumber(r,{unit:"day"}),c);case"eee":return o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"eeeee":return o.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return o.day(r,{width:"wide",context:"formatting"})||o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=6}},{key:"set",value:function(r,s,o,a){return r=fa(r,o,a),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var gI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",90),I(D(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o,a){var c=function(u){var h=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+h};switch(s){case"c":case"cc":return He(de(s.length,r),c);case"co":return He(o.ordinalNumber(r,{unit:"day"}),c);case"ccc":return o.day(r,{width:"abbreviated",context:"standalone"})||o.day(r,{width:"short",context:"standalone"})||o.day(r,{width:"narrow",context:"standalone"});case"ccccc":return o.day(r,{width:"narrow",context:"standalone"});case"cccccc":return o.day(r,{width:"short",context:"standalone"})||o.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return o.day(r,{width:"wide",context:"standalone"})||o.day(r,{width:"abbreviated",context:"standalone"})||o.day(r,{width:"short",context:"standalone"})||o.day(r,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=6}},{key:"set",value:function(r,s,o,a){return r=fa(r,o,a),r.setUTCHours(0,0,0,0),r}}]),t}(Q);function rg(n,e){S(2,arguments);var t=ie(e);t%7===0&&(t=t-7);var i=1,r=N(n),s=r.getUTCDay(),o=t%7,a=(o+7)%7,c=(a<i?7:0)+t-s;return r.setUTCDate(r.getUTCDate()+c),r}var vI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",90),I(D(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){var a=function(l){return l===0?7:l};switch(s){case"i":case"ii":return de(s.length,r);case"io":return o.ordinalNumber(r,{unit:"day"});case"iii":return He(o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"}),a);case"iiiii":return He(o.day(r,{width:"narrow",context:"formatting"}),a);case"iiiiii":return He(o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"}),a);case"iiii":default:return He(o.day(r,{width:"wide",context:"formatting"})||o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"}),a)}}},{key:"validate",value:function(r,s){return s>=1&&s<=7}},{key:"set",value:function(r,s,o){return r=rg(r,o),r.setUTCHours(0,0,0,0),r}}]),t}(Q);var yI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",80),I(D(i),"incompatibleTokens",["b","B","H","k","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"a":case"aa":case"aaa":return o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(r,{width:"wide",context:"formatting"})||o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(r,s,o){return r.setUTCHours(Sc(o),0,0,0),r}}]),t}(Q);var wI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",80),I(D(i),"incompatibleTokens",["a","B","H","k","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"b":case"bb":case"bbb":return o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(r,{width:"wide",context:"formatting"})||o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(r,s,o){return r.setUTCHours(Sc(o),0,0,0),r}}]),t}(Q);var bI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",80),I(D(i),"incompatibleTokens",["a","b","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"B":case"BB":case"BBB":return o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(r,{width:"wide",context:"formatting"})||o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(r,s,o){return r.setUTCHours(Sc(o),0,0,0),r}}]),t}(Q);var CI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",70),I(D(i),"incompatibleTokens",["H","K","k","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"h":return we(Me.hour12h,r);case"ho":return o.ordinalNumber(r,{unit:"hour"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=12}},{key:"set",value:function(r,s,o){var a=r.getUTCHours()>=12;return a&&o<12?r.setUTCHours(o+12,0,0,0):!a&&o===12?r.setUTCHours(0,0,0,0):r.setUTCHours(o,0,0,0),r}}]),t}(Q);var _I=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",70),I(D(i),"incompatibleTokens",["a","b","h","K","k","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"H":return we(Me.hour23h,r);case"Ho":return o.ordinalNumber(r,{unit:"hour"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=23}},{key:"set",value:function(r,s,o){return r.setUTCHours(o,0,0,0),r}}]),t}(Q);var SI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",70),I(D(i),"incompatibleTokens",["h","H","k","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"K":return we(Me.hour11h,r);case"Ko":return o.ordinalNumber(r,{unit:"hour"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=11}},{key:"set",value:function(r,s,o){var a=r.getUTCHours()>=12;return a&&o<12?r.setUTCHours(o+12,0,0,0):r.setUTCHours(o,0,0,0),r}}]),t}(Q);var TI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",70),I(D(i),"incompatibleTokens",["a","b","h","H","K","t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"k":return we(Me.hour24h,r);case"ko":return o.ordinalNumber(r,{unit:"hour"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=24}},{key:"set",value:function(r,s,o){var a=o<=24?o%24:o;return r.setUTCHours(a,0,0,0),r}}]),t}(Q);var EI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",60),I(D(i),"incompatibleTokens",["t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"m":return we(Me.minute,r);case"mo":return o.ordinalNumber(r,{unit:"minute"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=59}},{key:"set",value:function(r,s,o){return r.setUTCMinutes(o,0,0),r}}]),t}(Q);var MI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",50),I(D(i),"incompatibleTokens",["t","T"]),i}return G(t,[{key:"parse",value:function(r,s,o){switch(s){case"s":return we(Me.second,r);case"so":return o.ordinalNumber(r,{unit:"second"});default:return de(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=59}},{key:"set",value:function(r,s,o){return r.setUTCSeconds(o,0),r}}]),t}(Q);var zI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",30),I(D(i),"incompatibleTokens",["t","T"]),i}return G(t,[{key:"parse",value:function(r,s){var o=function(c){return Math.floor(c*Math.pow(10,-s.length+3))};return He(de(s.length,r),o)}},{key:"set",value:function(r,s,o){return r.setUTCMilliseconds(o),r}}]),t}(Q);var xI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",10),I(D(i),"incompatibleTokens",["t","T","x"]),i}return G(t,[{key:"parse",value:function(r,s){switch(s){case"X":return di(hi.basicOptionalMinutes,r);case"XX":return di(hi.basic,r);case"XXXX":return di(hi.basicOptionalSeconds,r);case"XXXXX":return di(hi.extendedOptionalSeconds,r);case"XXX":default:return di(hi.extended,r)}}},{key:"set",value:function(r,s,o){return s.timestampIsSet?r:new Date(r.getTime()-o)}}]),t}(Q);var OI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",10),I(D(i),"incompatibleTokens",["t","T","X"]),i}return G(t,[{key:"parse",value:function(r,s){switch(s){case"x":return di(hi.basicOptionalMinutes,r);case"xx":return di(hi.basic,r);case"xxxx":return di(hi.basicOptionalSeconds,r);case"xxxxx":return di(hi.extendedOptionalSeconds,r);case"xxx":default:return di(hi.extended,r)}}},{key:"set",value:function(r,s,o){return s.timestampIsSet?r:new Date(r.getTime()-o)}}]),t}(Q);var II=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",40),I(D(i),"incompatibleTokens","*"),i}return G(t,[{key:"parse",value:function(r){return Z0(r)}},{key:"set",value:function(r,s,o){return[new Date(o*1e3),{timestampIsSet:!0}]}}]),t}(Q);var AI=function(n){Y(t,n);var e=K(t);function t(){var i;W(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),I(D(i),"priority",20),I(D(i),"incompatibleTokens","*"),i}return G(t,[{key:"parse",value:function(r){return Z0(r)}},{key:"set",value:function(r,s,o){return[new Date(o),{timestampIsSet:!0}]}}]),t}(Q);var DI={G:new tI,y:new nI,Y:new iI,R:new rI,u:new sI,Q:new oI,q:new aI,M:new cI,L:new lI,w:new uI,I:new hI,d:new dI,D:new fI,E:new mI,e:new pI,c:new gI,i:new vI,a:new yI,b:new wI,B:new bI,h:new CI,H:new _I,K:new SI,k:new TI,m:new EI,s:new MI,S:new zI,X:new xI,x:new OI,t:new II,T:new AI};var VX=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,NX=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,PX=/^'([^]*?)'?$/,HX=/''/g,BX=/\S/,FX=/[a-zA-Z]/;function kI(n,e,t,i){var r,s,o,a,c,l,u,h,d,m,p,v,w,A,_,k,R,U;S(3,arguments);var X=String(n),re=String(e),Le=cn(),Xe=(r=(s=i?.locale)!==null&&s!==void 0?s:Le.locale)!==null&&r!==void 0?r:F0;if(!Xe.match)throw new RangeError("locale must contain match property");var ve=ie((o=(a=(c=(l=i?.firstWeekContainsDate)!==null&&l!==void 0?l:i==null||(u=i.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&c!==void 0?c:Le.firstWeekContainsDate)!==null&&a!==void 0?a:(d=Le.locale)===null||d===void 0||(m=d.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(ve>=1&&ve<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var z=ie((p=(v=(w=(A=i?.weekStartsOn)!==null&&A!==void 0?A:i==null||(_=i.locale)===null||_===void 0||(k=_.options)===null||k===void 0?void 0:k.weekStartsOn)!==null&&w!==void 0?w:Le.weekStartsOn)!==null&&v!==void 0?v:(R=Le.locale)===null||R===void 0||(U=R.options)===null||U===void 0?void 0:U.weekStartsOn)!==null&&p!==void 0?p:0);if(!(z>=0&&z<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(re==="")return X===""?N(t):new Date(NaN);var Be={firstWeekContainsDate:ve,weekStartsOn:z,locale:Xe},x=[new eI],f=re.match(NX).map(function(ye){var C=ye[0];if(C in Y2){var E=Y2[C];return E(ye,Xe.formatLong)}return ye}).join("").match(VX),V=[],se=Q0(f),Oe;try{var ke=function(){var C=Oe.value;!(i!=null&&i.useAdditionalWeekYearTokens)&&B0(C)&&wc(C,re,n),!(i!=null&&i.useAdditionalDayOfYearTokens)&&H0(C)&&wc(C,re,n);var E=C[0],P=DI[E];if(P){var ee=P.incompatibleTokens;if(Array.isArray(ee)){var Z=V.find(function(Mt){return ee.includes(Mt.token)||Mt.token===E});if(Z)throw new RangeError("The format string mustn't contain `".concat(Z.fullToken,"` and `").concat(C,"` at the same time"))}else if(P.incompatibleTokens==="*"&&V.length>0)throw new RangeError("The format string mustn't contain `".concat(C,"` and any other token at the same time"));V.push({token:E,fullToken:C});var fe=P.run(X,C,Xe.match,Be);if(!fe)return{v:new Date(NaN)};x.push(fe.setter),X=fe.rest}else{if(E.match(FX))throw new RangeError("Format string contains an unescaped latin alphabet character `"+E+"`");if(C==="''"?C="'":E==="'"&&(C=qX(C)),X.indexOf(C)===0)X=X.slice(C.length);else return{v:new Date(NaN)}}};for(se.s();!(Oe=se.n()).done;){var it=ke();if(Gt(it)==="object")return it.v}}catch(ye){se.e(ye)}finally{se.f()}if(X.length>0&&BX.test(X))return new Date(NaN);var qe=x.map(function(ye){return ye.priority}).sort(function(ye,C){return C-ye}).filter(function(ye,C,E){return E.indexOf(ye)===C}).map(function(ye){return x.filter(function(C){return C.priority===ye}).sort(function(C,E){return E.subPriority-C.subPriority})}).map(function(ye){return ye[0]}),Dt=N(t);if(isNaN(Dt.getTime()))return new Date(NaN);var Ge=j2(Dt,Zs(Dt)),Ze={},yt=Q0(qe),ct;try{for(yt.s();!(ct=yt.n()).done;){var Vt=ct.value;if(!Vt.validate(Ge,Be))return new Date(NaN);var fi=Vt.set(Ge,Ze,Be);Array.isArray(fi)?(Ge=fi[0],Xp(Ze,fi[1])):Ge=fi}}catch(ye){yt.e(ye)}finally{yt.f()}return Ge}function qX(n){return n.match(PX)[1].replace(HX,"'")}function tu(n){S(1,arguments);var e=N(n);return e.setMinutes(0,0,0),e}function RI(n,e){S(2,arguments);var t=tu(n),i=tu(e);return t.getTime()===i.getTime()}function LI(n,e){S(2,arguments);var t=Y0(n),i=Y0(e);return t.getTime()===i.getTime()}function VI(n,e){S(2,arguments);var t=N(n),i=N(e);return t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()}function nu(n){S(1,arguments);var e=N(n);return e.setMilliseconds(0),e}function NI(n,e){S(2,arguments);var t=nu(n),i=nu(e);return t.getTime()===i.getTime()}function PI(n,e){S(2,arguments);var t=N(n),i=N(e);return t.getFullYear()===i.getFullYear()}function HI(n){return S(1,arguments),$0(n,Date.now())}function iu(n,e){S(2,arguments);var t=N(n),i=ie(e),r=t.getFullYear(),s=t.getDate(),o=new Date(0);o.setFullYear(r,i,15),o.setHours(0,0,0,0);var a=Zp(o);return t.setMonth(i,Math.min(s,a)),t}function BI(n,e){if(S(2,arguments),Gt(e)!=="object"||e===null)throw new RangeError("values parameter must be an object");var t=N(n);return isNaN(t.getTime())?new Date(NaN):(e.year!=null&&t.setFullYear(e.year),e.month!=null&&(t=iu(t,e.month)),e.date!=null&&t.setDate(ie(e.date)),e.hours!=null&&t.setHours(ie(e.hours)),e.minutes!=null&&t.setMinutes(ie(e.minutes)),e.seconds!=null&&t.setSeconds(ie(e.seconds)),e.milliseconds!=null&&t.setMilliseconds(ie(e.milliseconds)),t)}function FI(n,e,t){var i,r,s,o,a,c,l,u;S(2,arguments);var h=cn(),d=ie((i=(r=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(a=t.locale)===null||a===void 0||(c=a.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&s!==void 0?s:h.weekStartsOn)!==null&&r!==void 0?r:(l=h.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&i!==void 0?i:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=N(n),p=ie(e),v=m.getDay(),w=p%7,A=(w+7)%7,_=7-d,k=p<0||p>6?p-(v+_)%7:(A+_)%7-(v+_)%7;return q0(m,k)}function qI(n,e){S(2,arguments);var t=N(n),i=ie(e);return isNaN(t.getTime())?new Date(NaN):(t.setFullYear(i),t)}var Mde=(()=>{let e=class e{setHiddenAttribute(){this.hidden?typeof this.hidden=="string"?this.renderer.setAttribute(this.elementRef.nativeElement,"hidden",this.hidden):this.renderer.setAttribute(this.elementRef.nativeElement,"hidden",""):this.renderer.removeAttribute(this.elementRef.nativeElement,"hidden")}constructor(i,r){this.elementRef=i,this.renderer=r,this.hidden=null,this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","")}ngOnChanges(){this.setHiddenAttribute()}ngAfterViewInit(){this.setHiddenAttribute()}};e.\u0275fac=function(r){return new(r||e)(H(Ve),H(Pi))},e.\u0275dir=Fe({type:e,selectors:[["","nz-button",""],["nz-button-group"],["","nz-icon",""],["","nz-menu-item",""],["","nz-submenu",""],["nz-select-top-control"],["nz-select-placeholder"],["nz-input-group"]],inputs:{hidden:"hidden"},standalone:!0,features:[Xt]});let n=e;return n})(),UI=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({});let n=e;return n})();var sg=class{get waveAttributeName(){return this.insertExtraNode?"ant-click-animating":"ant-click-animating-without-extra-node"}constructor(e,t,i,r,s){this.triggerElement=e,this.ngZone=t,this.insertExtraNode=i,this.platformId=r,this.cspNonce=s,this.waveTransitionDuration=400,this.styleForPseudo=null,this.extraNode=null,this.lastTime=0,this.onClick=o=>{!this.triggerElement||!this.triggerElement.getAttribute||this.triggerElement.getAttribute("disabled")||o.target.tagName==="INPUT"||this.triggerElement.className.indexOf("disabled")>=0||this.fadeOutWave()},this.platform=new wn(this.platformId),this.clickHandler=this.onClick.bind(this),this.bindTriggerEvent()}bindTriggerEvent(){this.platform.isBrowser&&this.ngZone.runOutsideAngular(()=>{this.removeTriggerEvent(),this.triggerElement&&this.triggerElement.addEventListener("click",this.clickHandler,!0)})}removeTriggerEvent(){this.triggerElement&&this.triggerElement.removeEventListener("click",this.clickHandler,!0)}removeStyleAndExtraNode(){this.styleForPseudo&&document.body.contains(this.styleForPseudo)&&(document.body.removeChild(this.styleForPseudo),this.styleForPseudo=null),this.insertExtraNode&&this.triggerElement.contains(this.extraNode)&&this.triggerElement.removeChild(this.extraNode)}destroy(){this.removeTriggerEvent(),this.removeStyleAndExtraNode()}fadeOutWave(){let e=this.triggerElement,t=this.getWaveColor(e);e.setAttribute(this.waveAttributeName,"true"),!(Date.now()<this.lastTime+this.waveTransitionDuration)&&(this.isValidColor(t)&&(this.styleForPseudo||(this.styleForPseudo=document.createElement("style"),this.cspNonce&&(this.styleForPseudo.nonce=this.cspNonce)),this.styleForPseudo.innerHTML=`
      [ant-click-animating-without-extra-node='true']::after, .ant-click-animating-node {
        --antd-wave-shadow-color: ${t};
      }`,document.body.appendChild(this.styleForPseudo)),this.insertExtraNode&&(this.extraNode||(this.extraNode=document.createElement("div")),this.extraNode.className="ant-click-animating-node",e.appendChild(this.extraNode)),this.lastTime=Date.now(),this.runTimeoutOutsideZone(()=>{e.removeAttribute(this.waveAttributeName),this.removeStyleAndExtraNode()},this.waveTransitionDuration))}isValidColor(e){return!!e&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&this.isNotGrey(e)&&!/rgba\(\d*, \d*, \d*, 0\)/.test(e)&&e!=="transparent"}isNotGrey(e){let t=e.match(/rgba?\((\d*), (\d*), (\d*)(, [\.\d]*)?\)/);return t&&t[1]&&t[2]&&t[3]?!(t[1]===t[2]&&t[2]===t[3]):!0}getWaveColor(e){let t=getComputedStyle(e);return t.getPropertyValue("border-top-color")||t.getPropertyValue("border-color")||t.getPropertyValue("background-color")}runTimeoutOutsideZone(e,t){this.ngZone.runOutsideAngular(()=>setTimeout(e,t))}},UX={disabled:!1},jI=new Ce("nz-wave-global-options");function jX(n){return cu([{provide:jI,useValue:n}])}var Vde=(()=>{let e=class e{get disabled(){return this.waveDisabled}get rendererRef(){return this.waveRenderer}constructor(i,r,s,o,a,c){this.ngZone=i,this.elementRef=r,this.config=s,this.animationType=o,this.platformId=a,this.cspNonce=c,this.nzWaveExtraNode=!1,this.waveDisabled=!1,this.waveDisabled=this.isConfigDisabled()}isConfigDisabled(){let i=!1;return this.config&&typeof this.config.disabled=="boolean"&&(i=this.config.disabled),this.animationType==="NoopAnimations"&&(i=!0),i}ngOnDestroy(){this.waveRenderer&&this.waveRenderer.destroy()}ngOnInit(){this.renderWaveIfEnabled()}renderWaveIfEnabled(){!this.waveDisabled&&this.elementRef.nativeElement&&(this.waveRenderer=new sg(this.elementRef.nativeElement,this.ngZone,this.nzWaveExtraNode,this.platformId,this.cspNonce))}disable(){this.waveDisabled=!0,this.waveRenderer&&(this.waveRenderer.removeTriggerEvent(),this.waveRenderer.removeStyleAndExtraNode())}enable(){this.waveDisabled=this.isConfigDisabled()||!1,this.waveRenderer&&this.waveRenderer.bindTriggerEvent()}};e.\u0275fac=function(r){return new(r||e)(H(ze),H(Ve),H(jI,8),H(wa,8),H(Ni),H(ba,8))},e.\u0275dir=Fe({type:e,selectors:[["","nz-wave",""],["button","nz-button","",3,"nzType","link",3,"nzType","text"]],inputs:{nzWaveExtraNode:"nzWaveExtraNode"},exportAs:["nzWave"],standalone:!0});let n=e;return n})(),WI=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({providers:[jX(UX)]});let n=e;return n})();var WX=["nz-button",""],$I=["*"];function GX(n,e){n&1&&mi(0,"span",0)}var GI="button",$X=(()=>{let e=class e{insertSpan(i,r){i.forEach(s=>{if(s.nodeName==="#text"){let o=r.createElement("span"),a=r.parentNode(s);r.insertBefore(a,o,s),r.appendChild(o,s)}})}get iconOnly(){let i=Array.from(this.elementRef?.nativeElement?.childNodes||[]),r=i.every(o=>o.nodeName!=="#text"),s=i.filter(o=>!(o.nodeName==="#comment"||o?.attributes?.getNamedItem("nz-icon"))).length==0;return!!this.nzIconDirectiveElement&&s&&r}constructor(i,r,s,o,a,c){this.ngZone=i,this.elementRef=r,this.cdr=s,this.renderer=o,this.nzConfigService=a,this.directionality=c,this._nzModuleName=GI,this.nzBlock=!1,this.nzGhost=!1,this.nzSearch=!1,this.nzLoading=!1,this.nzDanger=!1,this.disabled=!1,this.tabIndex=null,this.nzType=null,this.nzShape=null,this.nzSize="default",this.dir="ltr",this.destroy$=new ae,this.loading$=new ae,this.nzConfigService.getConfigChangeEventForComponent(GI).pipe(lt(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe(lt(this.destroy$)).subscribe(i=>{this.dir=i,this.cdr.detectChanges()}),this.dir=this.directionality.value,this.ngZone.runOutsideAngular(()=>{Tc(this.elementRef.nativeElement,"click",{capture:!0}).pipe(lt(this.destroy$)).subscribe(i=>{(this.disabled&&i.target?.tagName==="A"||this.nzLoading)&&(i.preventDefault(),i.stopImmediatePropagation())})})}ngOnChanges(i){let{nzLoading:r}=i;r&&this.loading$.next(this.nzLoading)}ngAfterViewInit(){this.insertSpan(this.elementRef.nativeElement.childNodes,this.renderer)}ngAfterContentInit(){this.loading$.pipe(_n(this.nzLoading),Nt(()=>!!this.nzIconDirectiveElement),lt(this.destroy$)).subscribe(i=>{let r=this.nzIconDirectiveElement.nativeElement;i?this.renderer.setStyle(r,"display","none"):this.renderer.removeStyle(r,"display")})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(r){return new(r||e)(H(ze),H(Ve),H(pi),H(Pi),H(ra),H(pr,8))},e.\u0275cmp=$r({type:e,selectors:[["button","nz-button",""],["a","nz-button",""]],contentQueries:function(r,s,o){if(r&1&&xg(o,pc,5,Ve),r&2){let a;cl(a=ll())&&(s.nzIconDirectiveElement=a.first)}},hostAttrs:[1,"ant-btn"],hostVars:32,hostBindings:function(r,s){r&2&&(uu("tabindex",s.disabled?-1:s.tabIndex===null?null:s.tabIndex)("disabled",s.disabled||null),wr("ant-btn-primary",s.nzType==="primary")("ant-btn-dashed",s.nzType==="dashed")("ant-btn-link",s.nzType==="link")("ant-btn-text",s.nzType==="text")("ant-btn-circle",s.nzShape==="circle")("ant-btn-round",s.nzShape==="round")("ant-btn-lg",s.nzSize==="large")("ant-btn-sm",s.nzSize==="small")("ant-btn-dangerous",s.nzDanger)("ant-btn-loading",s.nzLoading)("ant-btn-background-ghost",s.nzGhost)("ant-btn-block",s.nzBlock)("ant-input-search-button",s.nzSearch)("ant-btn-rtl",s.dir==="rtl")("ant-btn-icon-only",s.iconOnly))},inputs:{nzBlock:"nzBlock",nzGhost:"nzGhost",nzSearch:"nzSearch",nzLoading:"nzLoading",nzDanger:"nzDanger",disabled:"disabled",tabIndex:"tabIndex",nzType:"nzType",nzShape:"nzShape",nzSize:"nzSize"},exportAs:["nzButton"],standalone:!0,features:[Xt,Qr],attrs:WX,ngContentSelectors:$I,decls:2,vars:1,consts:[["nz-icon","","nzType","loading"]],template:function(r,s){r&1&&(Mc(),_a(0,GX,1,0,"span",0),zc(1)),r&2&&Mg(0,s.nzLoading?0:-1)},dependencies:[O0,pc],encapsulation:2,changeDetection:0});let n=e;return Cn([Un()],n.prototype,"nzBlock",void 0),Cn([Un()],n.prototype,"nzGhost",void 0),Cn([Un()],n.prototype,"nzSearch",void 0),Cn([Un()],n.prototype,"nzLoading",void 0),Cn([Un()],n.prototype,"nzDanger",void 0),Cn([Un()],n.prototype,"disabled",void 0),Cn([Hx()],n.prototype,"nzSize",void 0),n})(),e5e=(()=>{let e=class e{constructor(i){this.directionality=i,this.nzSize="default",this.dir="ltr",this.destroy$=new ae}ngOnInit(){this.dir=this.directionality.value,this.directionality.change?.pipe(lt(this.destroy$)).subscribe(i=>{this.dir=i})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(r){return new(r||e)(H(pr,8))},e.\u0275cmp=$r({type:e,selectors:[["nz-button-group"]],hostAttrs:[1,"ant-btn-group"],hostVars:6,hostBindings:function(r,s){r&2&&wr("ant-btn-group-lg",s.nzSize==="large")("ant-btn-group-sm",s.nzSize==="small")("ant-btn-group-rtl",s.dir==="rtl")},inputs:{nzSize:"nzSize"},exportAs:["nzButtonGroup"],standalone:!0,features:[Qr],ngContentSelectors:$I,decls:1,vars:0,template:function(r,s){r&1&&(Mc(),zc(0))},encapsulation:2,changeDetection:0});let n=e;return n})(),t5e=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({imports:[$X,UI,WI]});let n=e;return n})();var YI="nz-animate-disabled",a5e=(()=>{let e=class e{constructor(i,r,s){this.element=i,this.renderer=r,this.animationType=s,this.nzNoAnimation=!1}ngOnChanges(){this.updateClass()}ngAfterViewInit(){this.updateClass()}updateClass(){let i=S0(this.element);i&&(this.nzNoAnimation||this.animationType==="NoopAnimations"?this.renderer.addClass(i,YI):this.renderer.removeClass(i,YI))}};e.\u0275fac=function(r){return new(r||e)(H(Ve),H(Pi),H(wa,8))},e.\u0275dir=Fe({type:e,selectors:[["","nzNoAnimation",""]],inputs:{nzNoAnimation:"nzNoAnimation"},exportAs:["nzNoAnimation"],standalone:!0,features:[Xt]});let n=e;return Cn([Un()],n.prototype,"nzNoAnimation",void 0),n})();var ln={top:new at({originX:"center",originY:"top"},{overlayX:"center",overlayY:"bottom"}),topCenter:new at({originX:"center",originY:"top"},{overlayX:"center",overlayY:"bottom"}),topLeft:new at({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"}),topRight:new at({originX:"end",originY:"top"},{overlayX:"end",overlayY:"bottom"}),right:new at({originX:"end",originY:"center"},{overlayX:"start",overlayY:"center"}),rightTop:new at({originX:"end",originY:"top"},{overlayX:"start",overlayY:"top"}),rightBottom:new at({originX:"end",originY:"bottom"},{overlayX:"start",overlayY:"bottom"}),bottom:new at({originX:"center",originY:"bottom"},{overlayX:"center",overlayY:"top"}),bottomCenter:new at({originX:"center",originY:"bottom"},{overlayX:"center",overlayY:"top"}),bottomLeft:new at({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"}),bottomRight:new at({originX:"end",originY:"bottom"},{overlayX:"end",overlayY:"top"}),left:new at({originX:"start",originY:"center"},{overlayX:"end",overlayY:"center"}),leftTop:new at({originX:"start",originY:"top"},{overlayX:"end",overlayY:"top"}),leftBottom:new at({originX:"start",originY:"bottom"},{overlayX:"end",overlayY:"bottom"})},y5e=[ln.top,ln.right,ln.bottom,ln.left],w5e=[ln.bottomLeft,ln.bottomRight,ln.topLeft,ln.topRight,ln.topCenter,ln.bottomCenter],b5e=[new at({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"bottom"}),new at({originX:"start",originY:"bottom"},{overlayX:"end",overlayY:"bottom"})],C5e=[ln.bottomLeft,new at({originX:"start",originY:"bottom"},{overlayX:"end",overlayY:"top"})];function YX(n){for(let e in ln)if(n.connectionPair.originX===ln[e].originX&&n.connectionPair.originY===ln[e].originY&&n.connectionPair.overlayX===ln[e].overlayX&&n.connectionPair.overlayY===ln[e].overlayY)return e}var ru={bottomLeft:new at({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"},void 0,2),topLeft:new at({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"},void 0,-2),bottomRight:new at({originX:"end",originY:"bottom"},{overlayX:"end",overlayY:"top"},void 0,2),topRight:new at({originX:"end",originY:"top"},{overlayX:"end",overlayY:"bottom"},void 0,-2)},_5e=[ru.bottomLeft,ru.topLeft,ru.bottomRight,ru.topRight],S5e=(()=>{let e=class e{constructor(i,r){this.cdkConnectedOverlay=i,this.nzDestroyService=r,this.nzArrowPointAtCenter=!1,this.cdkConnectedOverlay.backdropClass="nz-overlay-transparent-backdrop",this.cdkConnectedOverlay.positionChange.pipe(lt(this.nzDestroyService)).subscribe(s=>{this.nzArrowPointAtCenter&&this.updateArrowPosition(s)})}updateArrowPosition(i){let r=this.getOriginRect(),s=YX(i),o=0,a=0;s==="topLeft"||s==="bottomLeft"?o=r.width/2-14:s==="topRight"||s==="bottomRight"?o=-(r.width/2-14):s==="leftTop"||s==="rightTop"?a=r.height/2-10:(s==="leftBottom"||s==="rightBottom")&&(a=-(r.height/2-10)),(this.cdkConnectedOverlay.offsetX!==o||this.cdkConnectedOverlay.offsetY!==a)&&(this.cdkConnectedOverlay.offsetY=a,this.cdkConnectedOverlay.offsetX=o,this.cdkConnectedOverlay.overlayRef.updatePosition())}getFlexibleConnectedPositionStrategyOrigin(){return this.cdkConnectedOverlay.origin instanceof Fp?this.cdkConnectedOverlay.origin.elementRef:this.cdkConnectedOverlay.origin}getOriginRect(){let i=this.getFlexibleConnectedPositionStrategyOrigin();if(i instanceof Ve)return i.nativeElement.getBoundingClientRect();if(i instanceof Element)return i.getBoundingClientRect();let r=i.width||0,s=i.height||0;return{top:i.y,bottom:i.y+s,left:i.x,right:i.x+r,height:s,width:r}}};e.\u0275fac=function(r){return new(r||e)(H(vO),H(D0))},e.\u0275dir=Fe({type:e,selectors:[["","cdkConnectedOverlay","","nzConnectedOverlay",""]],inputs:{nzArrowPointAtCenter:"nzArrowPointAtCenter"},exportAs:["nzConnectedOverlay"],features:[Kr([D0])]});let n=e;return Cn([Un()],n.prototype,"nzArrowPointAtCenter",void 0),n})(),T5e=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=_e({type:e}),e.\u0275inj=be({});let n=e;return n})();function E5e(n,e){e&&(n._host.style.zIndex=`${e}`)}export{ea as a,Jo as b,l0 as c,qee as d,On as e,lz as f,uc as g,hc as h,I2 as i,bte as j,d0 as k,Xm as l,Lte as m,dt as n,qo as o,Fr as p,wM as q,DM as r,BM as s,UM as t,PY as u,Qte as v,vre as w,yre as x,wre as y,bre as z,Cre as A,_re as B,Tre as C,Ere as D,Yx as E,Kx as F,mK as G,ia as H,R2 as I,S0 as J,tie as K,nie as L,iie as M,rie as N,sie as O,oie as P,vK as Q,yK as R,Nz as S,aie as T,Un as U,cie as V,lie as W,wK as X,uie as Y,hie as Z,fie as _,mie as $,pie as aa,gie as ba,yie as ca,wie as da,SK as ea,TK as fa,_ie as ga,Sie as ha,ra as ia,Hx as ja,wn as ka,Fie as la,qie as ma,Uie as na,bp as oa,pc as pa,O0 as qa,N2 as ra,P2 as sa,I0 as ta,mre as ua,Gx as va,Dre as wa,Tp as xa,Ep as ya,qre as za,jK as Aa,Jx as Ba,Yre as Ca,eO as Da,$K as Ea,Kre as Fa,Qre as Ga,D0 as Ha,pr as Ia,H2 as Ja,xse as Ka,F2 as La,oQ as Ma,Ose as Na,Dp as Oa,aO as Pa,V0 as Qa,at as Ra,uQ as Sa,Pp as Ta,vc as Ua,Fp as Va,vO as Wa,Kse as Xa,qp as Ya,zQ as Za,xQ as _a,poe as $a,goe as ab,q0 as bb,U0 as cb,j0 as db,gr as eb,VO as fb,NO as gb,PO as hb,$0 as ib,P0 as jb,FO as kb,qO as lb,jO as mb,WO as nb,GO as ob,$O as pb,YO as qb,CO as rb,K2 as sb,ua as tb,ha as ub,$p as vb,kO as wb,RO as xb,KO as yb,QO as zb,kI as Ab,RI as Bb,LI as Cb,VI as Db,NI as Eb,PI as Fb,HI as Gb,iu as Hb,BI as Ib,FI as Jb,qI as Kb,LO as Lb,a5e as Mb,ln as Nb,y5e as Ob,YX as Pb,ru as Qb,_5e as Rb,S5e as Sb,T5e as Tb,E5e as Ub,Mde as Vb,Vde as Wb,WI as Xb,$X as Yb,e5e as Zb,t5e as _b};
