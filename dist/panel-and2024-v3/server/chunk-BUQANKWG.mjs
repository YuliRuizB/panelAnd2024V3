import './polyfills.server.mjs';
import{a as hi,b as fi}from"./chunk-E2J5DNFH.mjs";import{a as $t,c as Wt,d as Xt,e as jt}from"./chunk-XETQPEAE.mjs";import{a as lt}from"./chunk-5I6MK62D.mjs";import{a as ct}from"./chunk-URZPRQ6M.mjs";import{a as di,b as ci,d as _i}from"./chunk-LCT442D4.mjs";import{a as si}from"./chunk-YFOJLMAY.mjs";import{a as Re,b as Yt,d as ni}from"./chunk-ISICPXPS.mjs";import{a as mi,c as ui,d as pi}from"./chunk-MLIUFOA2.mjs";import{c as st}from"./chunk-MICHUJBG.mjs";import{a as Rt}from"./chunk-CN7MJXIE.mjs";import{a as li}from"./chunk-FVN25E7W.mjs";import{a as dt,b as oi}from"./chunk-VO6QGIAK.mjs";import{a as ii,h as ai}from"./chunk-OK6AXCXD.mjs";import{A as ti,B as nt,C as at,D as rt,E as ot,G as ri,a as Je,c as Ee,d as Ve,e as Kt,k as Pe,n as Ye,o as Ze,w as tt,x as ei,z as it}from"./chunk-JLDYJE72.mjs";import{$ as Mt,P as ve,Q as Ce,R as je,S as be,_ as Ge,aa as Ut,b as We,c as D,ca as At,d as se,da as He,e as de,ea as Ii,f as Nt,fa as Qe,g as Xe,h as kt,ha as Gt,i as ce,ja as De,k as me,m as ue,pa as we,q as pe,qa as Te,sa as et,t as ge,ta as Zt,u as ze}from"./chunk-MXAABQE2.mjs";import{a as Lt,b as Ot}from"./chunk-SBJPP4XY.mjs";import{a as Bt,c as qt,f as Ke,g as Ht,h as Qt,j as Jt}from"./chunk-YVJKCECQ.mjs";import{Rb as xe,Sb as Se,Ub as ye,Wa as ee,Za as _e,m as Ct,na as fe,p as he,tb as bt}from"./chunk-GACYMIHG.mjs";import{$ as Vt,Ab as _t,Bb as gt,Bc as Tt,C as Et,Cb as zt,Cc as le,Db as y,Dc as qe,Eb as r,Fb as z,G as ht,Gb as b,Ha as Ae,Hb as L,Ia as o,Ib as Be,Ja as O,Jb as w,Kb as T,Kc as Ft,L as ae,Lb as F,Mc as $e,Ob as vt,Pb as A,T as K,Tb as M,Ua as v,Ub as Ue,V as k,Vb as q,Wa as d,X as Y,Xb as V,ca as ft,d as te,da as I,ha as Z,hb as t,ib as i,jb as C,kb as re,lb as oe,nb as S,o as yt,oa as h,pa as f,q as P,qb as g,sb as p,v as Dt,vb as Me,vd as It,xb as Pt,yb as wt}from"./chunk-AV3XNHWO.mjs";import{a as xt}from"./chunk-UYFIRDFP.mjs";import{a as R,b as Oe,h as Fi,j as G}from"./chunk-H6KHSOBK.mjs";var ie=Fi(Ii());var Li=["download"],Oi=["searchBar"],Ai=s=>({open:s}),Bi=()=>({y:"calc(100vh - 120px)"}),qi=()=>[];function $i(s,m){if(s&1&&(t(0,"nz-option",59),r(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(),b(" ",e.name," ")}}function Wi(s,m){s&1&&C(0,"span",60)}function Xi(s,m){s&1&&C(0,"i",67)}function ji(s,m){if(s&1){let e=S();t(0,"tr",63),g("click",function(){let a=h(e).$implicit,l=p(2);return f(l.userSelected(a))}),t(1,"td")(2,"div",64)(3,"div"),C(4,"nz-avatar",65),i(),t(5,"div")(6,"h6"),v(7,Xi,1,0,"i",66),r(8),i(),re(9),t(10,"p"),r(11),C(12,"br"),r(13),i(),oe(),i()()()()}if(s&2){let e=m.$implicit;o(4),d("nzSize",30)("nzSrc",e.photoURL),o(3),d("ngIf",e.disabled),o(),b(" ",e.displayName," "),o(3),b(" ",e.email," "),o(2),b(" ",e.customerName," ")}}function Gi(s,m){if(s&1&&(t(0,"nz-table",61,25)(2,"tbody"),v(3,ji,14,6,"tr",62),i()()),s&2){let e=y(1),n=p();d("nzData",n.devicesList)("nzShowPagination",!0)("nzPageSize",30)("nzScroll",vt(5,Bi)),o(3),d("ngForOf",e.data)}}function Hi(s,m){s&1&&C(0,"i",80)}function Qi(s,m){if(s&1){let e=S();t(0,"li",81),g("click",function(){h(e);let a=p(2);return f(a.setUserDisabled(!0))}),r(1,"Suspender Usuario "),i()}}function Ji(s,m){if(s&1){let e=S();t(0,"li",81),g("click",function(){h(e);let a=p(2);return f(a.setUserDisabled(!1))}),r(1,"Reactivar Usuario "),i()}}function Ki(s,m){if(s&1&&(t(0,"div",68),re(1),t(2,"div",69)(3,"a",70),C(4,"i",71),i(),t(5,"div"),C(6,"nz-avatar",72),i(),t(7,"div",73)(8,"h6"),v(9,Hi,1,0,"i",74),r(10),i(),t(11,"p"),C(12,"nz-badge",75),t(13,"span"),r(14),i()()()(),oe(),t(15,"div")(16,"a",76),C(17,"i",77),i(),t(18,"nz-dropdown-menu",null,26)(20,"ul",78),v(21,Qi,2,0,"li",79)(22,Ji,2,0,"li",79),i()()()()),s&2){let e=y(19),n=p();o(3),d("routerLink",vt(10,qi)),o(3),d("nzSrc",n.currentUserSelected.photoURL),o(3),d("ngIf",n.currentUserSelected.disabled),o(),b(" ",n.currentUserSelected.displayName," "),o(2),d("nzStatus",n.currentUserSelected.emailVerified?"success":"error"),o(2),b(" ",n.currentUserSelected.email," "),o(2),d("nzDropdownMenu",e)("nzTrigger","click"),o(5),d("ngIf",!n.currentUserSelected.disabled),o(),d("ngIf",n.currentUserSelected.disabled)}}function Yi(s,m){s&1&&(t(0,"nz-tag",108),r(1,"Cortes\xEDa "),i()),s&2&&d("nzColor","yellow")}function Zi(s,m){s&1&&(t(0,"nz-tag",108),r(1,"Pagado "),i()),s&2&&d("nzColor","cyan")}function en(s,m){s&1&&(t(0,"nz-tag",108),r(1,"Pagado Parcial"),i()),s&2&&d("nzColor","red")}function tn(s,m){s&1&&(t(0,"nz-tag",108),r(1,"Baja"),i()),s&2&&d("nzColor","magenta")}function nn(s,m){if(s&1&&(t(0,"nz-tag",108),r(1),i()),s&2){let e=p().$implicit;d("nzColor","blue"),o(),z(e.payment)}}function an(s,m){s&1&&(t(0,"nz-tag",108),r(1,"Activo"),i()),s&2&&d("nzColor","cyan")}function rn(s,m){if(s&1&&(t(0,"span"),r(1),M(2,"currency"),i()),s&2){let e=p().$implicit;o(),z(Ue(2,1,e.amountPayment))}}function on(s,m){if(s&1){let e=S();t(0,"tr",63),g("click",function(){let a=h(e).$implicit,l=p(3);return f(l.boardingPassSelected(a))}),t(1,"td")(2,"nz-tag",108),r(3),i(),t(4,"span",109),r(5),M(6,"date"),i()(),t(7,"td"),r(8),i(),t(9,"td"),v(10,Yi,2,1,"nz-tag",110)(11,Zi,2,1,"nz-tag",110)(12,en,2,1,"nz-tag",110)(13,tn,2,1,"nz-tag",110)(14,nn,2,2,"nz-tag",110)(15,an,2,1,"nz-tag",110),i(),t(16,"td"),r(17),M(18,"currency"),i(),t(19,"td"),v(20,rn,3,3,"span",111),i(),t(21,"td")(22,"a",112),C(23,"i",113),i(),t(24,"nz-dropdown-menu",null,26)(26,"ul",78)(27,"li",81),g("click",function(){let a=h(e).$implicit,l=p(3);return f(l.deletePurchase(a.id))}),r(28,"Eliminar Boleto"),i(),t(29,"li",81),g("click",function(){let a=h(e).$implicit,l=p(3);return f(l.activatePurchase(a.id,!1))}),r(30,"Suspender Boleto"),i(),t(31,"li",81),g("click",function(){let a=h(e).$implicit,l=p(3);return f(l.activatePurchase(a.id,!0))}),r(32,"Activar Boleto"),i()()()()()}if(s&2){let e=m.$implicit,n=y(25);o(2),d("nzColor","blue"),o(),z(e.name),o(2),b(" ",q(6,15,e.creation_date,"medium")," "),o(3),Be("",e.routeName," / ",e.stopName," / ",e.round,""),o(2),d("ngIf",e.status==="completed"&&!!e.is_courtesy),o(),d("ngIf",e.status==="completed"&&!e.is_courtesy),o(),d("ngIf",e.status!=="completed"),o(),d("ngIf",e.status!=="completed"&&e.baja===!0),o(),d("ngIf",e.status!=="completed"),o(),d("ngIf",e.active),o(2),b(" ",Ue(18,18,e.amount)," "),o(3),d("ngIf",e.payment=="Anticipo"),o(2),d("nzDropdownMenu",n)}}function ln(s,m){if(s&1&&(t(0,"nz-table",107,25)(2,"thead")(3,"tr")(4,"th"),r(5,"Pase"),i(),t(6,"th"),r(7,"Operaci\xF3n"),i(),t(8,"th"),r(9,"Estatus "),i(),t(10,"th"),r(11,"Precio"),i(),t(12,"th"),r(13,"Abono"),i()()(),t(14,"tbody"),v(15,on,33,20,"tr",62),i()()),s&2){let e=y(1),n=p(2);d("nzData",n.latestPurchases)("nzPageSize",3)("nzLoading",n.loadingLatestPurchases)("nzLoadingDelay",500),o(15),d("ngForOf",e.data)}}function sn(s,m){s&1&&(t(0,"nz-tag",108),r(1,"OpenPay "),i()),s&2&&d("nzColor","blue")}function dn(s,m){s&1&&(t(0,"nz-tag",108),r(1,"Pago Portal "),i()),s&2&&d("nzColor","blue")}function cn(s,m){if(s&1&&(t(0,"span"),r(1),M(2,"currency"),i()),s&2){let e=p().$implicit;o(),z(Ue(2,1,e.amountPayment))}}function mn(s,m){if(s&1){let e=S();t(0,"tr")(1,"td")(2,"nz-tag",108),r(3),i(),t(4,"span",109),r(5),M(6,"date"),i()(),t(7,"td"),r(8),i(),t(9,"td"),v(10,sn,2,1,"nz-tag",110)(11,dn,2,1,"nz-tag",110),t(12,"nz-tag",108),r(13),i()(),t(14,"td"),r(15),M(16,"currency"),i(),t(17,"td"),v(18,cn,3,3,"span",111),i(),t(19,"td")(20,"a",112),C(21,"i",114),i(),t(22,"nz-dropdown-menu",null,26)(24,"ul",78)(25,"li",81),g("click",function(){let a=h(e).$implicit,l=p(3);return f(l.generatePurchasePDF(a))}),r(26,"Generar Pdf"),i()()()()()}if(s&2){let e=m.$implicit,n=y(23);o(2),d("nzColor","blue"),o(),z(e.name),o(2),b(" ",q(6,13,e.creation_date,"medium")," "),o(3),Be("",e.routeName," / ",e.stopName," / ",e.round,""),o(2),d("ngIf",e.isOpenpay==="true"),o(),d("ngIf",e.authorization==="portalAuth"),o(),d("nzColor","green"),o(),b("",e.typePayment," "),o(2),b(" ",Ue(16,16,e.amount)," "),o(3),d("ngIf",e.payment=="Anticipo"),o(2),d("nzDropdownMenu",n)}}function un(s,m){if(s&1&&(t(0,"nz-table",107,29)(2,"thead")(3,"tr")(4,"th"),r(5,"Pase"),i(),t(6,"th"),r(7,"Operaci\xF3n"),i(),t(8,"th"),r(9,"Datos "),i(),t(10,"th"),r(11,"Precio"),i(),t(12,"th"),r(13,"Abono"),i()()(),t(14,"tbody"),v(15,mn,27,18,"tr",106),i()()),s&2){let e=y(1),n=p(2);d("nzData",n.latestPurRequest)("nzPageSize",3)("nzLoading",n.loadinglatestPurRequest)("nzLoadingDelay",500),o(15),d("ngForOf",e.data)}}function pn(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),M(3,"date"),i(),t(4,"td"),r(5),i()()),s&2){let e=m.$implicit;o(2),z(q(3,2,e.createdAt.toDate(),"dd/MM/yyyy")),o(3),z(e.msg)}}function hn(s,m){if(s&1){let e=S();t(0,"div"),C(1,"nz-divider",115),t(2,"textarea",116),F("ngModelChange",function(a){h(e);let l=p(2);return T(l.newMessage,a)||(l.newMessage=a),f(a)}),i()(),t(3,"button",84),g("click",function(){h(e);let a=p(2);return f(a.showModalMessageCenter())}),C(4,"i",67),r(5,"Enviar Mensaje"),i()}if(s&2){let e=p(2);o(2),w("ngModel",e.newMessage)}}function fn(s,m){if(s&1){let e=S();t(0,"nz-tabset",82)(1,"nz-tab",83),g("nzClick",function(){h(e);let a=p();return f(a.nzClicOptionInformacion())}),t(2,"div")(3,"button",84),g("click",function(){h(e);let a=p();return f(a.showModalEditUser(a.currentUserSelected))}),C(4,"i",67),r(5,"Editar Usuario"),i()(),t(6,"div")(7,"nz-descriptions",85)(8,"nz-descriptions-item",86)(9,"div",87),r(10),i()(),t(11,"nz-descriptions-item",88),r(12),i(),t(13,"nz-descriptions-item",89),r(14),i(),t(15,"nz-descriptions-item",90),r(16),i(),t(17,"nz-descriptions-item",91),r(18),i(),t(19,"nz-descriptions-item",92),r(20),i(),t(21,"nz-descriptions-item",93),r(22),i(),t(23,"nz-descriptions-item",94),r(24),i(),r(25),t(26,"nz-descriptions-item",95),r(27),i(),t(28,"nz-descriptions-item",96),r(29),i(),t(30,"nz-descriptions-item",97),r(31),i(),t(32,"nz-descriptions-item",98),r(33),i(),t(34,"nz-descriptions-item",99),r(35),i(),t(36,"nz-descriptions-item",100),r(37),i()()()(),t(38,"nz-tab",101)(39,"button",84),g("click",function(){h(e);let a=p();return f(a.showModal())}),C(40,"i",67),r(41,"Nuevo Pase"),i(),v(42,ln,16,5,"nz-table",102),i(),t(43,"nz-tab",103),v(44,un,16,5,"nz-table",102),i(),t(45,"nz-tab",104),g("nzClick",function(){h(e);let a=p();return f(a.nzClicOption())}),t(46,"nz-table",105,27)(48,"thead")(49,"tr")(50,"th"),r(51,"Fecha"),i(),t(52,"th"),r(53,"Mensaje"),i()()(),t(54,"tbody"),v(55,pn,6,5,"tr",106),i()(),v(56,hn,6,1,"ng-template",null,28,V),i()()}if(s&2){let e=y(47),n=y(57),a=p();o(10),b(" ",a.currentUserSelected.firstName,""),o(2),z(a.currentUserSelected.lastName),o(2),z(a.currentUserSelected.email),o(2),z(a.currentUserSelected.emailVerified),o(2),z(a.currentUserSelected.displayName),o(2),z(a.currentUserSelected.customerName),o(2),b(" ",a.currentUserSelected.defaultRouteName,""),o(2),z(a.currentUserSelected.defaultStopName),o(),b(" ",a.currentUserSelected.turno," "),o(2),b(" ",a.currentUserSelected.turno==="1"?"Sencillo":a.currentUserSelected.turno==="2"?"Redondo":a.currentUserSelected.turno===""?"No definido":""," "),o(2),z(a.currentUserSelected.phoneNumber),o(2),z(a.currentUserSelected.studentId),o(2),z(a.currentUserSelected.userName),o(2),z(a.currentUserSelected.status),o(2),z(a.currentUserSelected.roundTrip),o(5),d("ngIf",a.latestPurchases),o(2),d("ngIf",a.latestPurRequest),o(2),d("nzData",a.userChatMessageData)("nzPageSize",3)("nzFooter",n)("nzLoadingDelay",500),o(9),d("ngForOf",e.data)}}function _n(s,m){s&1&&r(0," Nuevo pase ")}function gn(s,m){if(s&1&&(re(0),r(1),oe()),s&2){let e=p().$implicit;o(),b("(",e.frequencies,")")}}function zn(s,m){if(s&1&&(t(0,"div")(1,"nz-option",59),C(2,"i",67),r(3),v(4,gn,2,1,"ng-container",111),r(5),i()()),s&2){let e=m.$implicit;o(),d("nzLabel",e.name)("nzValue",e.productId),o(2),b(" ",e.name," "),o(),d("ngIf",e.frequencies),o(),b(" $",e.price," ")}}function vn(s,m){if(s&1&&(t(0,"nz-option",59),C(1,"i",67),r(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.routeId),o(2),b(" ",e.name,"")}}function Cn(s,m){if(s&1&&(t(0,"nz-option",59),C(1,"i",67),r(2),C(3,"br"),r(4),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.stopPointId),o(2),b(" ",e.name," "),o(2),b(" ",e.description," ")}}function bn(s,m){s&1&&(t(0,"div",130)(1,"nz-form-item")(2,"nz-form-label"),r(3,"Fecha Compromiso "),i(),C(4,"nz-date-picker",142),i()())}function xn(s,m){if(s&1){let e=S();t(0,"nz-form-item")(1,"nz-upload",143),g("nzChange",function(a){h(e);let l=p(2);return f(l.handleChange2(a))}),t(2,"p",144)(3,"span",67),r(4,"Cargar"),i()(),t(5,"p",145),r(6,"Arrastra el documento a subir"),i(),t(7,"p",146),r(8," Soporte para un solo archivo. Prohibido subir datos corruptos o archivos maliciosos. "),i()()()}s&2&&(o(),d("nzMultiple",!1)("nzLimit",1)("nzSize",50)("nzFileType","image/png,image/jpeg,image/gif,image/bmp"))}function Sn(s,m){if(s&1){let e=S();t(0,"form",117),g("ngSubmit",function(){h(e);let a=p();return f(a.submitForm())}),t(1,"nz-form-item")(2,"nz-form-label"),r(3,"Servicio"),i(),t(4,"nz-select",118),g("ngModelChange",function(a){h(e);let l=p();return f(l.onProductSelected(a,l.products))}),v(5,zn,6,5,"div",106),i()(),t(6,"nz-form-item")(7,"nz-form-label"),r(8,"Operaci\xF3n"),i(),t(9,"nz-select",119),g("ngModelChange",function(a){h(e);let l=p();return f(l.onRouteSelected(a,l.routes))}),v(10,vn,3,3,"nz-option",41),i()(),t(11,"nz-form-item")(12,"nz-form-label"),r(13,"Estaciones"),i(),t(14,"nz-select",120),g("ngModelChange",function(a){h(e);let l=p();return f(l.onStopPointSelected(a,l.stopPoints))}),v(15,Cn,5,4,"nz-option",41),i()(),t(16,"nz-form-item")(17,"nz-form-label"),r(18,"Turno"),i(),t(19,"nz-select",121),C(20,"nz-option",122)(21,"nz-option",123)(22,"nz-option",124),i()(),t(23,"nz-form-item")(24,"nz-form-label"),r(25,"Tipo de Pago"),i(),t(26,"nz-select",125),g("ngModelChange",function(a){h(e);let l=p();return f(l.changePayment(a))}),C(27,"nz-option",126)(28,"nz-option",127)(29,"nz-option",128),i()(),t(30,"nz-form-item")(31,"div",129)(32,"div",130)(33,"nz-form-label"),r(34,"Cantidad a pagar "),i(),t(35,"nz-input-number",131),g("ngModelChange",function(a){h(e);let l=p();return f(l.onAmountChange(a))}),i()(),v(36,bn,5,0,"div",132),i()(),t(37,"div",129)(38,"div",130)(39,"nz-form-item")(40,"nz-form-label"),r(41,"Total a pagar"),i(),t(42,"nz-input-number",133),g("ngModelChange",function(a){h(e);let l=p();return f(l.onAmountChange(a))}),i()()(),t(43,"div",130)(44,"nz-form-item")(45,"nz-form-label"),r(46,"\xBFEs cortes\xEDa?"),i(),t(47,"nz-switch",134),g("ngModelChange",function(a){h(e);let l=p();return f(l.onCourtesyChange(a))}),i()()()(),t(48,"nz-form-item")(49,"nz-form-label"),r(50,"Tipo de Referencia"),i(),t(51,"nz-select",135),g("ngModelChange",function(a){h(e);let l=p();return f(l.changePaymentType(a))}),C(52,"nz-option",136)(53,"nz-option",137)(54,"nz-option",138),i()(),v(55,xn,9,4,"nz-form-item",111),t(56,"nz-form-item")(57,"nz-form-control")(58,"label",139),r(59,"Activar pase"),i()()(),t(60,"div",129)(61,"div",130)(62,"nz-form-item")(63,"nz-form-label"),r(64,"V\xE1lido desde"),i(),C(65,"nz-date-picker",140),i()(),t(66,"div",130)(67,"nz-form-item")(68,"nz-form-label"),r(69,"V\xE1lido hasta"),i(),t(70,"nz-date-picker",141),g("ngModelChange",function(a){h(e);let l=p();return f(l.onChangeValidTo(a))}),i()()()()()}if(s&2){let e=p();d("formGroup",e.validateForm),o(5),d("ngForOf",e.products),o(5),d("ngForOf",e.routes),o(5),d("ngForOf",e.stopPoints),o(20),d("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar),o(),d("ngIf",e.isAnticipo),o(6),d("disabled",!1)("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar),o(13),d("ngIf",e.ifValidPayment),o(15),d("nzDisabledDate",e.disabledDate)}}function yn(s,m){if(s&1){let e=S();t(0,"button",147),g("click",function(){h(e);let a=p();return f(a.handleCancel())}),r(1,"Cancelar"),i(),t(2,"button",148),g("click",function(){h(e);let a=p();return f(a.submitForm())}),r(3,"Generar Pase"),i()}if(s&2){let e=p();o(2),d("nzLoading",e.isConfirmLoading)}}function Dn(s,m){s&1&&r(0," Productos ")}function En(s,m){if(s&1&&(re(0),r(1),oe()),s&2){let e=p(2).$implicit;o(),b("(",e.frequencies,")")}}function Vn(s,m){if(s&1&&(t(0,"nz-option",59),C(1,"i",67),r(2),v(3,En,2,1,"ng-container",111),r(4),i()),s&2){let e=p().$implicit;d("nzLabel",e.name)("nzValue",e.productId),o(2),b(" ",e.name," "),o(),d("ngIf",e.frequencies),o(),b(" $",e.price," ")}}function Pn(s,m){if(s&1&&(t(0,"div"),v(1,Vn,5,5,"nz-option",151),i()),s&2){let e=m.$implicit;o(),d("ngIf",e.type=="Producto")}}function wn(s,m){if(s&1){let e=S();t(0,"form",117),g("ngSubmit",function(){h(e);let a=p();return f(a.submitForm())}),t(1,"nz-form-item")(2,"nz-form-label"),r(3,"Producto"),i(),t(4,"nz-select",118),g("ngModelChange",function(a){h(e);let l=p();return f(l.onProductSelected(a,l.products))}),v(5,Pn,2,1,"div",106),i()(),t(6,"div",129)(7,"div",130)(8,"nz-form-item")(9,"nz-form-label"),r(10,"Cantidad a pagar"),i(),t(11,"nz-input-number",149),g("ngModelChange",function(a){h(e);let l=p();return f(l.onAmountChange(a))}),i()()(),t(12,"div",130)(13,"nz-form-item")(14,"nz-form-label"),r(15,"\xBFEs cortes\xEDa?"),i(),t(16,"nz-switch",134),g("ngModelChange",function(a){h(e);let l=p();return f(l.onCourtesyChange(a))}),i()()()(),t(17,"div",129)(18,"div",130)(19,"nz-form-item")(20,"nz-form-label"),r(21,"V\xE1lido desde"),i(),C(22,"nz-date-picker",140),i()(),t(23,"div",130)(24,"nz-form-item")(25,"nz-form-label"),r(26,"V\xE1lido hasta"),i(),C(27,"nz-date-picker",150),i()()()()}if(s&2){let e=p();d("formGroup",e.validateForm),o(5),d("ngForOf",e.products),o(6),d("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function Tn(s,m){if(s&1){let e=S();t(0,"button",147),g("click",function(){h(e);let a=p();return f(a.handleCancelProduct())}),r(1,"Cancelar"),i(),t(2,"button",148),g("click",function(){h(e);let a=p();return f(a.submitFormProduct())}),r(3,"Guardar"),i()}if(s&2){let e=p();o(2),d("nzLoading",e.isConfirmLoading)}}function Fn(s,m){s&1&&r(0," Editar Usuario ")}function In(s,m){if(s&1&&(t(0,"nz-option",59),C(1,"i",67),r(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.uid),o(2),b(" ",e.name,"")}}function Nn(s,m){if(s&1&&(t(0,"nz-option",59),C(1,"i",67),r(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.routeId),o(2),b(" ",e.name,"")}}function kn(s,m){if(s&1&&(t(0,"nz-option",59),C(1,"i",67),r(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(2),b(" ",e.name," ")}}function Mn(s,m){if(s&1){let e=S();t(0,"form",117),g("ngSubmit",function(){h(e);let a=p();return f(a.submitForm())}),t(1,"nz-form-item")(2,"nz-form-label",152),r(3,"Nombre"),i(),t(4,"nz-form-control",152),C(5,"input",153),i()(),t(6,"nz-form-item")(7,"nz-form-label",152),r(8,"Apellidos"),i(),t(9,"nz-form-control",152),C(10,"input",154),i()(),t(11,"nz-form-item")(12,"nz-form-label",152),r(13,"Display Name"),i(),t(14,"nz-form-control",152),C(15,"input",155),i()(),t(16,"nz-form-item")(17,"nz-form-label",152),r(18,"Usuario"),i(),t(19,"nz-form-control",152),C(20,"input",156),i()(),t(21,"nz-form-item")(22,"nz-form-label",152),r(23,"Tel\xE9fono"),i(),t(24,"nz-form-control",152),C(25,"input",157),i()(),t(26,"nz-form-item")(27,"nz-form-label",152),r(28,"Identificaci\xF3n"),i(),t(29,"nz-form-control",152),C(30,"input",158),i()(),t(31,"nz-form-item")(32,"nz-form-label",152),r(33,"Email"),i(),t(34,"nz-form-control",152),C(35,"input",159),i()(),t(36,"nz-form-item")(37,"nz-form-label",152),r(38,"Empresa"),i(),t(39,"nz-form-control",152)(40,"nz-select",160),g("ngModelChange",function(a){h(e);let l=p();return f(l.onCustomerSelected(a,l.customers))}),v(41,In,3,3,"nz-option",41),i()()(),t(42,"nz-form-item")(43,"nz-form-label",152),r(44,"Operaci\xF3n"),i(),t(45,"nz-form-control",152)(46,"nz-select",161),g("ngModelChange",function(a){h(e);let l=p();return f(l.onRouteEditUserSelected(a,l.userRoutes))}),v(47,Nn,3,3,"nz-option",41),i()()(),t(48,"nz-form-item")(49,"nz-form-label",152),r(50,"Estaci\xF3n"),i(),t(51,"nz-form-control",152)(52,"nz-select",162),g("ngModelChange",function(a){h(e);let l=p();return f(l.onStopPointEditUserSelected(a,l.stopPointsList))}),v(53,kn,3,3,"nz-option",41),i()()(),t(54,"nz-form-item")(55,"nz-form-label",152),r(56,"Turno"),i(),t(57,"nz-select",163),C(58,"nz-option",122)(59,"nz-option",123)(60,"nz-option",124),i()()()}if(s&2){let e=p();d("formGroup",e.validateEditForm),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(3),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(3),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(3),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(3),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(3),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(3),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(3),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(2),d("ngForOf",e.customers),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(2),d("ngForOf",e.userRoutes),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(2),d("ngForOf",e.stopPointsList),o(2),d("nzSm",6)("nzXs",24)}}function Un(s,m){if(s&1){let e=S();t(0,"button",147),g("click",function(){h(e);let a=p();return f(a.handleCancel())}),r(1,"Cancelar"),i(),t(2,"button",147),g("click",function(){h(e);let a=p();return f(a.submitEditForm())}),r(3,"Guardar"),i()}}function Rn(s,m){s&1&&C(0,"nz-badge",208)}function Ln(s,m){s&1&&C(0,"nz-badge",209)}function On(s,m){s&1&&C(0,"nz-badge",210)}function An(s,m){s&1&&C(0,"nz-badge",211)}function Bn(s,m){s&1&&C(0,"nz-badge",210)}function qn(s,m){if(s&1){let e=S();t(0,"a",214),g("nzOnConfirm",function(){h(e);let a=p(3);return f(a.onCanUpdatePayment())})("nzOnCancel",function(){h(e);let a=p(3);return f(a.handleCancel())}),t(1,"small"),r(2,"Editar"),i()()}}function $n(s,m){if(s&1){let e=S();t(0,"nz-input-number",215),g("ngModelChange",function(a){h(e);let l=p(3);return f(l.onPaymentUpdated(a))}),i()}if(s&2){let e=p(3);d("ngModel",e.lastPurchase==null?null:e.lastPurchase.amount)("nzMin",1)("nzMax",1e4)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function Wn(s,m){if(s&1&&(t(0,"nz-descriptions-item",167),r(1),v(2,qn,3,0,"a",212)(3,$n,1,6,"nz-input-number",213),i()),s&2){let e=p(2);o(),L(" ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.currency," ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.amountPayment," "),o(),d("ngIf",!e.canUpdatePayment&&(e.lastPurchase==null?null:e.lastPurchase.status)!="completed"&&(e.lastPurchase==null?null:e.lastPurchase.baja)===!1),o(),d("ngIf",e.canUpdatePayment)}}function Xn(s,m){if(s&1&&(t(0,"nz-descriptions-item",167),r(1),i()),s&2){let e=p(2);o(),L(" ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.currency," ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.amount," ")}}function jn(s,m){if(s&1&&(t(0,"div")(1,"a",216),r(2,"Ver Comprobante"),i()()),s&2){let e=p().$implicit;o(),Me("href",e.fileURL,Ae)}}function Gn(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),M(3,"date"),i(),t(4,"td"),r(5),i(),t(6,"td"),r(7),i(),t(8,"td"),r(9),i(),t(10,"td"),r(11),i(),t(12,"td"),v(13,jn,3,1,"div",111),i()()),s&2){let e=m.$implicit;o(2),b(" ",q(3,6,e.creation_date,"medium"),""),o(3),z(e.name),o(2),z(e.payment),o(2),z(e.typePayment),o(2),b(" $ ",e.amountPayment,""),o(2),d("ngIf",e.typePayment=="Transferencia")}}function Hn(s,m){if(s&1){let e=S();t(0,"div"),C(1,"nz-qrcode",217)(2,"a",null,32),r(4),t(5,"button",218),g("click",function(){h(e);let a=p(2);return f(a.downloadImg())}),r(6,"Descargar"),i()()}if(s&2){let e=p(2);o(),wt("nzValue","",e.currentUserSelected==null?null:e.currentUserSelected.uid,"-",e.lastPurchase==null?null:e.lastPurchase.idBoardingPass,"-",e.lastPurchase==null?null:e.lastPurchase.stopId,""),o(3),Be(" ",e.currentUserSelected==null?null:e.currentUserSelected.uid,"-",e.lastPurchase==null?null:e.lastPurchase.idBoardingPass,"-",e.lastPurchase==null?null:e.lastPurchase.stopId," ")}}function Qn(s,m){if(s&1){let e=S();t(0,"div"),C(1,"nz-qrcode",217)(2,"a",null,32),r(4),t(5,"button",218),g("click",function(){h(e);let a=p(2);return f(a.downloadImg())}),r(6,"Descargar"),i()()}if(s&2){let e=p(2);o(),Pt("nzValue","",e.currentUserSelected==null?null:e.currentUserSelected.uid,"-",e.lastPurchase==null?null:e.lastPurchase.idBoardingPass,""),o(3),L(" ",e.currentUserSelected==null?null:e.currentUserSelected.uid,"-",e.lastPurchase==null?null:e.lastPurchase.idBoardingPass," ")}}function Jn(s,m){if(s&1&&C(0,"nz-avatar",219),s&2){let e=p(2);d("nzSrc",e.currentUserSelected.photoURL)}}function Kn(s,m){if(s&1){let e=S();t(0,"div",164)(1,"nz-tabset",82)(2,"nz-tab",165)(3,"div")(4,"nz-descriptions",85)(5,"nz-descriptions-item",166),r(6),i(),t(7,"nz-descriptions-item",167),v(8,Rn,1,0,"nz-badge",168)(9,Ln,1,0,"nz-badge",169)(10,On,1,0,"nz-badge",170),i(),t(11,"nz-descriptions-item",171),v(12,An,1,0,"nz-badge",172)(13,Bn,1,0,"nz-badge",170),i(),t(14,"nz-descriptions-item",173),r(15),M(16,"date"),i(),t(17,"nz-descriptions-item",174),r(18),i(),t(19,"nz-descriptions-item",175),r(20),M(21,"date"),i(),t(22,"nz-descriptions-item",176),r(23),M(24,"date"),i(),t(25,"nz-descriptions-item",177),r(26),i(),v(27,Wn,4,4,"nz-descriptions-item",178)(28,Xn,2,2,"nz-descriptions-item",178),t(29,"nz-descriptions-item",179),r(30),i(),t(31,"nz-descriptions-item",93),r(32),i(),t(33,"nz-descriptions-item",180),r(34),i(),t(35,"nz-descriptions-item",95),r(36),i(),t(37,"nz-descriptions-item",181),r(38),i(),t(39,"nz-descriptions-item",182),r(40),i(),t(41,"nz-descriptions-item",183),r(42),M(43,"date"),i(),t(44,"nz-descriptions-item",184),r(45),i(),t(46,"nz-descriptions-item",185),r(47),i()(),C(48,"br"),i()(),t(49,"nz-tab",186),g("nzClick",function(){h(e);let a=p();return f(a.nzClicOption())}),t(50,"nz-table",187,30)(52,"thead")(53,"tr")(54,"th"),r(55,"Fecha"),i(),t(56,"th"),r(57,"Nombre"),i(),t(58,"th"),r(59,"Tipo de Referencia"),i(),t(60,"th"),r(61,"Tipo de Pago"),i(),t(62,"th"),r(63,"Monto"),i(),t(64,"th"),r(65,"Comprobante"),i()()(),t(66,"tbody"),v(67,Gn,14,9,"tr",106),i()()(),t(68,"nz-tab",188),C(69,"app-shared-usage-history",189),i(),t(70,"nz-tab",190),v(71,Hn,7,7,"div",111)(72,Qn,7,5,"div",111),i(),t(73,"nz-tab",191)(74,"div",192)(75,"div",193)(76,"div",194)(77,"nz-card",191)(78,"button",147),g("click",function(){h(e);let a=p();return f(a.downloadPdf())}),r(79,"Imprimir"),i()()()(),t(80,"div",195)(81,"div",196)(82,"nz-card",197),C(83,"nz-card-meta",198),t(84,"div")(85,"div")(86,"B",199),r(87,"Credencial And 2024 "),i()(),t(88,"div")(89,"a",199),r(90),i(),r(91," / "),t(92,"a",199),r(93),i()(),t(94,"div",200)(95,"a",199),r(96),i()()(),t(97,"div",201),C(98,"nz-qrcode",202),i()(),v(99,Jn,1,1,"ng-template",null,31,V),i(),t(101,"div",194)(102,"nz-card",197)(103,"div",203)(104,"div",204)(105,"div",205),C(106,"nz-card",206),i()(),t(107,"div",204)(108,"div",205),C(109,"nz-card",206),i()(),t(110,"div",204)(111,"div",205),C(112,"nz-card",206),i()(),t(113,"div",204)(114,"div",205),C(115,"nz-card",206),i()(),t(116,"div",204)(117,"div",205),C(118,"nz-card",206),i()(),t(119,"div",204)(120,"div",205),C(121,"nz-card",206),i()()(),t(122,"div",203)(123,"a",207),r(124," Derechos reservados Apps And. Esta credencial es intransferible"),i()()()()()()()()()}if(s&2){let e,n=y(51),a=y(100),l=p();o(6),z(l.lastPurchase==null?null:l.lastPurchase.name),o(2),d("ngIf",l.lastPurchase.status=="completed"),o(),d("ngIf",l.lastPurchase.status=="partial"),o(),d("ngIf",l.lastPurchase.status=="in_progress"),o(2),d("ngIf",l.lastPurchase.active),o(),d("ngIf",!l.lastPurchase.active),o(2),b(" ",q(16,51,l.lastPurchase==null?null:l.lastPurchase.operation_date,"medium")," "),o(3),b("",l.lastPurchase!=null&&l.lastPurchase.is_courtesy?"Si":"No"," "),o(2),b(" ",l.lastPurchase!=null&&l.lastPurchase.validFrom?q(21,54,l.lastPurchase==null||l.lastPurchase.validFrom==null?null:l.lastPurchase.validFrom.toDate(),"medium"):"",""),o(3),b(" ",l.canUpdateValidTo?null:q(24,57,l.lastPurchase==null||l.lastPurchase.validTo==null?null:l.lastPurchase.validTo.toDate(),"medium")," "),o(3),L("",l.lastPurchase==null?null:l.lastPurchase.currency," ",l.lastPurchase==null?null:l.lastPurchase.price," "),o(),d("ngIf",(l.lastPurchase==null?null:l.lastPurchase.status)=="partial"),o(),d("ngIf",(l.lastPurchase==null?null:l.lastPurchase.status)!=="partial"),o(2),z(l.lastPurchase==null?null:l.lastPurchase.authorization),o(2),b("",l.lastPurchase==null?null:l.lastPurchase.routeName," "),o(2),L("",l.lastPurchase==null?null:l.lastPurchase.stopName," ",l.lastPurchase==null?null:l.lastPurchase.stopDescription,""),o(2),z(l.lastPurchase==null?null:l.lastPurchase.round),o(2),L(" ",l.lastPurchase==null?null:l.lastPurchase.currency," ",l.lastPurchase==null?null:l.lastPurchase.amountPayment," "),o(2),b(" ",l.lastPurchase==null?null:l.lastPurchase.payment," "),o(2),b(" ",q(43,60,l.lastPurchase==null?null:l.lastPurchase.promiseDate,"mediumDate")," "),o(3),b(" ",l.lastPurchase==null?null:l.lastPurchase.typePayment," "),o(2),b(" ",l.lastPurchase==null?null:l.lastPurchase.description," "),o(3),d("nzData",l.lastestPurchaseDetail)("nzPageSize",3)("nzLoadingDelay",500),o(17),d("ngForOf",n.data),o(2),d("userId",l.currentUserSelected.uid)("boardingPassId",(e=l.lastPurchase.id)!==null&&e!==void 0?e:""),o(2),d("ngIf",l.requiredFields),o(),d("ngIf",!l.requiredFields),o(3),d("nzGutter",8),o(),d("nzSpan",8),o(4),d("nzGutter",8),o(),d("nzSpan",8),o(),d("nzBordered",!0),o(),Me("nzTitle",l.currentUserSelected.displayName),d("nzAvatar",a),o(7),b("Operaci\xF3n: ",l.currentUserSelected.defaultRouteName," "),o(3),b(" Turno :",l.currentUserSelected.defaultRound,""),o(3),b(" Identificaci\xF3n: ",l.currentUserSelected.studentId,""),o(5),d("nzSpan",8),o(),d("nzBordered",!0),o(4),d("nzBordered",!0),o(3),d("nzBordered",!0),o(3),d("nzBordered",!0),o(3),d("nzBordered",!0),o(3),d("nzBordered",!0),o(3),d("nzBordered",!0)}}function Yn(s,m){s&1&&r(0," Comprobante de Pago ")}function Zn(s,m){if(s&1&&(t(0,"div",222)(1,"nz-card"),C(2,"nz-card-meta",223),t(3,"div",222)(4,"p")(5,"strong"),r(6,"Producto:"),i(),r(7),i(),t(8,"p")(9,"strong"),r(10,"Descripci\xF3n:"),i(),r(11),i(),t(12,"p")(13,"strong"),r(14,"Pago:"),i(),r(15),i(),t(16,"p")(17,"strong"),r(18,"Tipo:"),i(),r(19),i(),t(20,"p")(21,"strong"),r(22,"Tipo de Pago:"),i(),r(23),i(),t(24,"p")(25,"strong"),r(26,"Costo Total:"),i(),r(27),i(),t(28,"p")(29,"strong"),r(30,"Costo:"),i(),r(31),i(),t(32,"p")(33,"strong"),r(34,"Autorizaci\xF3n:"),i(),r(35),i(),t(36,"p")(37,"strong"),r(38,"Fecha de Creaci\xF3n :"),i(),r(39),i(),t(40,"p")(41,"strong"),r(42,"Cantidad de Viajes:"),i(),r(43),i(),t(44,"p")(45,"strong"),r(46,"Viajes Actuales:"),i(),r(47),i(),t(48,"p")(49,"strong"),r(50,"Nombre de la Operaci\xF3n:"),i(),r(51),i(),t(52,"p")(53,"strong"),r(54,"Turno:"),i(),r(55),i(),t(56,"p")(57,"strong"),r(58,"Parada:"),i(),r(59),i(),t(60,"p")(61,"strong"),r(62,"Fecha Valida inicial:"),i(),r(63),i(),t(64,"p")(65,"strong"),r(66,"Fecha Valida final:"),i(),r(67),i()()()()),s&2){let e=m.$implicit;o(7),b(" ",e.name,""),o(4),b(" ",e.description,""),o(4),b(" ",e.typePayment,""),o(4),b(" ",e.type,""),o(4),b(" ",e.method,""),o(4),b(" ",e.price,""),o(4),b(" ",e.amount,""),o(4),b(" ",e.authorization,""),o(4),b(" ",e.creation_date,""),o(4),b(" ",e.amountTrips,""),o(4),b(" ",e.currentTrips,""),o(4),b(" ",e.routeName,""),o(4),b(" ",e.round,""),o(4),b(" ",e.stopName,""),o(4),b(" ",e.validFrom,""),o(4),b(" ",e.validTo,"")}}function ea(s,m){if(s&1&&(t(0,"div",220),v(1,Zn,68,16,"div",221),i()),s&2){let e=p();o(),d("ngForOf",e.reciboPago)}}function ta(s,m){if(s&1){let e=S();t(0,"button",147),g("click",function(){h(e);let a=p();return f(a.handleCancel())}),r(1,"Cancelar"),i(),t(2,"button",148),g("click",function(){h(e);let a=p();return f(a.generatePDFInfo())}),r(3,"Generar PDF"),i()}if(s&2){let e=p();o(2),d("nzLoading",e.isConfirmLoading)}}function ia(s,m){s&1&&(t(0,"div"),r(1," Nuevo pase "),i())}function na(s,m){if(s&1&&(re(0),r(1),oe()),s&2){let e=p().$implicit;o(),b("(",e.frequencies,")")}}function aa(s,m){if(s&1&&(t(0,"div")(1,"nz-option",59),C(2,"i",67),r(3),v(4,na,2,1,"ng-container",111),r(5),i()()),s&2){let e=m.$implicit;o(),d("nzLabel",e.name)("nzValue",e.productId),o(2),b(" ",e.name," "),o(),d("ngIf",e.frequencies),o(),b(" $",e.price," ")}}function ra(s,m){if(s&1&&(t(0,"nz-option",59),C(1,"i",67),r(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.routeId),o(2),b(" ",e.name,"")}}function oa(s,m){if(s&1&&(t(0,"nz-option",59),C(1,"i",67),r(2),C(3,"br"),r(4),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.stopPointId),o(2),b(" ",e.name," "),o(2),b(" ",e.description,"")}}function la(s,m){if(s&1){let e=S();t(0,"div")(1,"form",117),g("ngSubmit",function(){h(e);let a=p(2);return f(a.submitForm())}),t(2,"nz-form-item")(3,"nz-form-label"),r(4,"Servicio"),i(),t(5,"nz-select",118),g("ngModelChange",function(a){h(e);let l=p(2);return f(l.onProductSelected(a,l.products))}),v(6,aa,6,5,"div",106),i()(),t(7,"nz-form-item")(8,"nz-form-label"),r(9,"Operaci\xF3n"),i(),t(10,"nz-select",119),g("ngModelChange",function(a){h(e);let l=p(2);return f(l.onRouteSelected(a,l.routes))}),v(11,ra,3,3,"nz-option",41),i()(),t(12,"nz-form-item")(13,"nz-form-label"),r(14,"Estaci\xF3n"),i(),t(15,"nz-select",120),g("ngModelChange",function(a){h(e);let l=p(2);return f(l.onStopPointSelected(a,l.stopPoints))}),v(16,oa,5,4,"nz-option",41),i()(),t(17,"nz-form-item")(18,"nz-form-label"),r(19,"Turno"),i(),t(20,"nz-select",121),C(21,"nz-option",122)(22,"nz-option",123)(23,"nz-option",124),i()(),t(24,"div",129)(25,"div",130)(26,"nz-form-item")(27,"nz-form-label"),r(28,"Cantidad a pagar"),i(),t(29,"nz-input-number",149),g("ngModelChange",function(a){h(e);let l=p(2);return f(l.onAmountChange(a))}),i()()(),t(30,"div",130)(31,"nz-form-item")(32,"nz-form-label"),r(33,"\xBFEs cortes\xEDa?"),i(),t(34,"nz-switch",134),g("ngModelChange",function(a){h(e);let l=p(2);return f(l.onCourtesyChange(a))}),i()()()(),t(35,"nz-form-item")(36,"nz-form-control")(37,"label",139),r(38,"Activar pase"),i()()(),t(39,"div",129)(40,"div",130)(41,"nz-form-item")(42,"nz-form-label"),r(43,"V\xE1lido desde"),i(),C(44,"nz-date-picker",140),i()(),t(45,"div",130)(46,"nz-form-item")(47,"nz-form-label"),r(48,"V\xE1lido hasta"),i(),C(49,"nz-date-picker",150),i()()()()()}if(s&2){let e=p(2);o(),d("formGroup",e.validateForm),o(5),d("ngForOf",e.products),o(5),d("ngForOf",e.routes),o(5),d("ngForOf",e.stopPoints),o(13),d("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function sa(s,m){if(s&1){let e=S();t(0,"tr")(1,"td",230),F("nzCheckedChange",function(a){let l=h(e).$implicit,c=p(3);return T(c.mapOfCheckedId[l.id],a)||(c.mapOfCheckedId[l.id]=a),f(a)}),g("nzCheckedChange",function(){h(e);let a=p(3);return f(a.refreshStatus())}),i(),t(2,"td"),r(3),i(),t(4,"td"),r(5),i(),t(6,"td"),r(7),i()()}if(s&2){let e=m.$implicit,n=p(3);o(),w("nzChecked",n.mapOfCheckedId[e.id]),o(2),z(e.studentId),o(2),z(e.displayName),o(2),z(e.email)}}function da(s,m){if(s&1){let e=S();t(0,"div")(1,"nz-table",228,33),g("nzCurrentPageDataChange",function(a){h(e);let l=p(2);return f(l.currentPageDataChange(a))}),t(3,"thead")(4,"tr")(5,"th",229),F("nzCheckedChange",function(a){h(e);let l=p(2);return T(l.isAllDisplayDataChecked,a)||(l.isAllDisplayDataChecked=a),f(a)}),g("nzCheckedChange",function(a){h(e);let l=p(2);return f(l.checkAllData(a))}),i(),t(6,"th"),r(7,"Id"),i(),t(8,"th"),r(9,"Nombre"),i(),t(10,"th"),r(11,"Email / Tel\xE9fono"),i()()(),t(12,"tbody"),v(13,sa,8,4,"tr",106),i()()()}if(s&2){let e=y(2),n=p(2);o(),d("nzData",n.devicesList)("nzSize","middle"),o(4),d("nzSelections",n.listOfSelection),w("nzChecked",n.isAllDisplayDataChecked),d("nzIndeterminate",n.isIndeterminate),o(8),d("ngForOf",e.data)}}function ca(s,m){if(s&1){let e=S();t(0,"nz-date-picker",234),g("ngModelChange",function(a){h(e);let l=p(3);return f(l.onValidToUpdated(a))}),i()}if(s&2){let e=p(3);d("ngModel",e.lastPurchase==null?null:e.lastPurchase.due_date)}}function ma(s,m){if(s&1){let e=S();t(0,"a",235),g("nzOnConfirm",function(){h(e);let a=p(3);return f(a.onCanUpdateValidTo())})("nzOnCancel",function(){h(e);let a=p(3);return f(a.handleCancel())}),t(1,"small"),r(2,"Editar"),i()()}}function ua(s,m){if(s&1){let e=S();t(0,"a",236),g("nzOnConfirm",function(){h(e);let a=p(3);return f(a.onCanUpdatePayment())})("nzOnCancel",function(){h(e);let a=p(3);return f(a.handleCancel())}),t(1,"small"),r(2,"Editar"),i()()}}function pa(s,m){if(s&1){let e=S();t(0,"nz-input-number",215),g("ngModelChange",function(a){h(e);let l=p(3);return f(l.onPaymentUpdated(a))}),i()}if(s&2){let e=p(3);d("ngModel",e.lastPurchase==null?null:e.lastPurchase.amount)("nzMin",1)("nzMax",12e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function ha(s,m){if(s&1&&(t(0,"div")(1,"div")(2,"nz-descriptions",85)(3,"nz-descriptions-item",166),r(4),i(),t(5,"nz-descriptions-item",174),r(6),i(),t(7,"nz-descriptions-item",175),r(8),M(9,"date"),i(),t(10,"nz-descriptions-item",176),r(11),M(12,"date"),v(13,ca,1,1,"nz-date-picker",231)(14,ma,3,0,"a",232),i(),t(15,"nz-descriptions-item",177),r(16),i(),t(17,"nz-descriptions-item",167),r(18),v(19,ua,3,0,"a",233)(20,pa,1,6,"nz-input-number",213),i(),t(21,"nz-descriptions-item",179),r(22),i(),t(23,"nz-descriptions-item",93),r(24),i(),t(25,"nz-descriptions-item",180),r(26),i(),t(27,"nz-descriptions-item",95),r(28),i(),t(29,"nz-descriptions-item",185),r(30),i()(),C(31,"br"),i(),r(32),i()),s&2){let e=p(2);o(4),z(e.validateForm.controls.product_description.value),o(2),b("",e.validateForm.controls.is_courtesy.value?"Si":"No"," "),o(2),b(" ",q(9,19,e.lastPurchase==null||e.lastPurchase.validFrom==null?null:e.lastPurchase.validFrom.toDate(),e.lastPurchase!=null&&e.lastPurchase.validFrom?"medium":"")," "),o(3),b(" ",q(12,22,e.lastPurchase==null||e.lastPurchase.validTo==null?null:e.lastPurchase.validTo.toDate(),e.canUpdateValidTo?"mediumDate":"")," "),o(2),d("ngIf",e.canUpdateValidTo),o(),d("ngIf",!e.canUpdateValidTo&&(e.lastPurchase==null?null:e.lastPurchase.status)!="completed"),o(2),L("",e.lastPurchase==null?null:e.lastPurchase.currency," ",e.lastPurchase==null?null:e.lastPurchase.price," "),o(2),L(" ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.currency," ",e.canUpdatePayment||e.lastPurchase==null?null:e.lastPurchase.amount," "),o(),d("ngIf",!e.canUpdatePayment&&(e.lastPurchase==null?null:e.lastPurchase.status)!="completed"),o(),d("ngIf",e.canUpdatePayment),o(2),z(e.lastPurchase==null?null:e.lastPurchase.authorization),o(2),b("",e.lastPurchase==null?null:e.lastPurchase.routeName," "),o(2),L("",e.lastPurchase==null?null:e.lastPurchase.stopName," ",e.lastPurchase==null?null:e.lastPurchase.stopDescription,""),o(2),z(e.lastPurchase==null?null:e.lastPurchase.round),o(2),b(" ",e.lastPurchase==null?null:e.lastPurchase.description," "),o(2),b(" ",e.actualSelectedRows," ")}}function fa(s,m){if(s&1&&(t(0,"div")(1,"nz-steps",224),C(2,"nz-step",225)(3,"nz-step",226)(4,"nz-step",227),i(),C(5,"br"),t(6,"div"),v(7,la,50,9,"div",111)(8,da,14,6,"div",111)(9,ha,33,25,"div",111),i()()),s&2){let e=p();o(),d("nzCurrent",e.current),o(6),d("ngIf",e.current==0),o(),d("ngIf",e.current==1),o(),d("ngIf",e.current==2)}}function _a(s,m){if(s&1){let e=S();t(0,"button",241),g("click",function(){h(e);let a=p(2);return f(a.pre())}),t(1,"span"),r(2,"Anterior"),i()()}if(s&2){let e=p(2);d("disabled",e.isCreatingBoardingPasses)}}function ga(s,m){if(s&1){let e=S();t(0,"button",241),g("click",function(){h(e);let a=p(2);return f(a.next())}),t(1,"span"),r(2,"Siguiente"),i()()}if(s&2){let e=p(2);d("disabled",e.isCreatingBoardingPasses)}}function za(s,m){if(s&1){let e=S();t(0,"button",148),g("click",function(){h(e);let a=p(2);return f(a.createMultipleBoardingPasses())}),t(1,"span"),r(2,"Crear Pases"),i()()}if(s&2){let e=p(2);d("nzLoading",e.isCreatingBoardingPasses)}}function va(s,m){if(s&1){let e=S();t(0,"button",147),g("click",function(){h(e);let a=p(2);return f(a.done())}),t(1,"span"),r(2,"Terminar"),i()()}}function Ca(s,m){if(s&1&&(t(0,"div",237),v(1,_a,3,1,"button",238)(2,ga,3,1,"button",238)(3,za,3,1,"button",239)(4,va,3,0,"button",240),i()),s&2){let e=p();o(),d("ngIf",e.current>0&&!e.isDone),o(),d("ngIf",e.current<2),o(),d("ngIf",e.current===2&&!e.isDone),o(),d("ngIf",e.current===2&&e.isDone)}}function ba(s,m){s&1&&r(0," Liquidaci\xF3n de Pase ")}function xa(s,m){if(s&1){let e=S();t(0,"nz-form-item")(1,"nz-upload",143),g("nzChange",function(a){h(e);let l=p(2);return f(l.handleChange2(a))}),t(2,"p",144)(3,"span",67),r(4,"Cargar"),i()(),t(5,"p",145),r(6,"Arrastra el documento a subir"),i(),t(7,"p",146),r(8," Soporte para un solo archivo. Prohibido subir datos corruptos o archivos maliciosos. "),i()()()}s&2&&(o(),d("nzMultiple",!1)("nzLimit",1)("nzSize",50)("nzFileType","image/png,image/jpeg,image/gif,image/bmp"))}function Sa(s,m){if(s&1){let e=S();t(0,"form",117),g("ngSubmit",function(){h(e);let a=p();return f(a.createLiquidacion())}),t(1,"nz-form-item")(2,"nz-form-label"),r(3,"Producto Seleccionado"),i(),C(4,"input",242),i(),t(5,"nz-form-item")(6,"nz-form-label"),r(7,"Costo Total del Producto"),i(),C(8,"nz-input-number",243),i(),t(9,"nz-form-item")(10,"nz-form-label"),r(11,"Total abonado"),i(),C(12,"nz-input-number",244),i(),t(13,"nz-form-item")(14,"nz-form-label"),r(15,"Cantidad a liquidar"),i(),C(16,"nz-input-number",245),i(),t(17,"nz-form-item")(18,"label",246),g("ngModelChange",function(){h(e);let a=p();return f(a.bajaCheck())}),t(19,"span"),r(20,"Baja"),i()()(),t(21,"nz-form-item")(22,"div",129)(23,"div",130)(24,"nz-form-item")(25,"nz-form-label"),r(26,"V\xE1lido desde"),i(),C(27,"nz-date-picker",140),i()(),t(28,"div",130)(29,"nz-form-item")(30,"nz-form-label"),r(31,"V\xE1lido hasta"),i(),C(32,"nz-date-picker",150),i()()()(),t(33,"nz-form-item")(34,"nz-form-label"),r(35,"Tipo de Referencia"),i(),t(36,"nz-select",135),g("ngModelChange",function(a){h(e);let l=p();return f(l.changeLiqPaymentType(a))}),C(37,"nz-option",136)(38,"nz-option",137)(39,"nz-option",138),i()(),v(40,xa,9,4,"nz-form-item",111),i()}if(s&2){let e=p();d("formGroup",e.validateLiqForm),o(40),d("ngIf",e.ifValidLiqPayment)}}function ya(s,m){if(s&1){let e=S();t(0,"button",247),g("click",function(){h(e);let a=p();return f(a.createLiquidacion())}),t(1,"span"),r(2,"Submit"),i()(),t(3,"button",247),g("click",function(){h(e);let a=p();return f(a.handleCancel())}),t(4,"span"),r(5,"Cancel"),i()()}}function Da(s,m){s&1&&r(0," Nuevas credenciales ")}function Ea(s,m){if(s&1){let e=S();t(0,"div")(1,"form",117),g("ngSubmit",function(){h(e);let a=p(2);return f(a.createMultipleCredentials())}),t(2,"div",129)(3,"div",130)(4,"nz-form-item")(5,"nz-form-label"),r(6,"V\xE1lido desde"),i(),C(7,"nz-date-picker",140),i()(),t(8,"div",130)(9,"nz-form-item")(10,"nz-form-label"),r(11,"V\xE1lido hasta"),i(),C(12,"nz-date-picker",150),i()(),t(13,"div",130)(14,"nz-form-item")(15,"nz-form-control")(16,"label",139),r(17,"Activar credencial"),i()()()()()()()}if(s&2){let e=p(2);o(),d("formGroup",e.credentialForm)}}function Va(s,m){if(s&1){let e=S();t(0,"tr")(1,"td",230),F("nzCheckedChange",function(a){let l=h(e).$implicit,c=p(3);return T(c.mapOfCredentialsCheckedId[l.uid],a)||(c.mapOfCredentialsCheckedId[l.uid]=a),f(a)}),g("nzCheckedChange",function(){h(e);let a=p(3);return f(a.refreshCredentialsStatus())}),i(),t(2,"td"),r(3),i(),t(4,"td"),r(5),i(),t(6,"td"),r(7),i(),t(8,"td"),r(9),i()()}if(s&2){let e=m.$implicit,n=p(3);o(),w("nzChecked",n.mapOfCredentialsCheckedId[e.uid]),o(2),z(e.customerName),o(2),z(e.studentId),o(2),z(e.displayName),o(2),z(e.email)}}function Pa(s,m){if(s&1){let e=S();t(0,"div")(1,"nz-table",228,33),g("nzCurrentPageDataChange",function(a){h(e);let l=p(2);return f(l.currentCredentialsPageDataChange(a))}),t(3,"thead")(4,"tr")(5,"th",229),F("nzCheckedChange",function(a){h(e);let l=p(2);return T(l.isCredentialsAllDisplayDataChecked,a)||(l.isCredentialsAllDisplayDataChecked=a),f(a)}),g("nzCheckedChange",function(a){h(e);let l=p(2);return f(l.checkCredentialsAllData(a))}),i(),t(6,"th",251),r(7,"Empresa"),i(),t(8,"th",251),r(9,"Id"),i(),t(10,"th",251),r(11,"Nombre"),i(),t(12,"th",251),r(13,"Email / Tel\xE9fono"),i()()(),t(14,"tbody"),v(15,Va,10,5,"tr",106),i()()()}if(s&2){let e=y(2),n=p(2);o(),d("nzData",n.usersByAccount)("nzSize","middle"),o(4),d("nzSelections",n.listOfCredentialsSelection),w("nzChecked",n.isCredentialsAllDisplayDataChecked),d("nzIndeterminate",n.isCredentialsIndeterminate),o(10),d("ngForOf",e.data)}}function wa(s,m){if(s&1&&(t(0,"div"),r(1),i()),s&2){let e=p(3);o(),b(" Se crear\xE1n ",e.actualSelectedRows," credenciales para los usuarios seleccionados. ")}}function Ta(s,m){s&1&&(t(0,"div"),r(1," No has seleccionado ning\xFAn usuario para crear una credencial. "),i())}function Fa(s,m){if(s&1&&(t(0,"div"),v(1,wa,2,1,"div",111)(2,Ta,2,0,"div",111),i()),s&2){let e=p(2);o(),d("ngIf",e.actualSelectedRows>0),o(),d("ngIf",e.actualSelectedRows===0)}}function Ia(s,m){if(s&1&&(t(0,"div")(1,"div"),r(2),i()()),s&2){let e=p(2);o(2),b(" Se crearon ",e.actualSelectedRows,". ")}}function Na(s,m){if(s&1&&(t(0,"nz-steps",224),C(1,"nz-step",248)(2,"nz-step",249)(3,"nz-step",227),i(),C(4,"br"),t(5,"div",250),v(6,Ea,18,1,"div",111)(7,Pa,16,6,"div",111)(8,Fa,3,2,"div",111)(9,Ia,3,1,"div",111),i()),s&2){let e=p();d("nzCurrent",e.current),o(6),d("ngIf",e.current==0),o(),d("ngIf",e.current==1),o(),d("ngIf",e.current==2),o(),d("ngIf",e.current==3)}}function ka(s,m){if(s&1){let e=S();t(0,"button",247),g("click",function(){h(e);let a=p(2);return f(a.pre())}),t(1,"span"),r(2,"Anterior"),i()()}}function Ma(s,m){if(s&1){let e=S();t(0,"button",255),g("click",function(){h(e);let a=p(2);return f(a.next())}),t(1,"span"),r(2,"Siguiente"),i()()}if(s&2){let e=p(2);d("disabled",e.credentialForm.invalid)}}function Ua(s,m){if(s&1){let e=S();t(0,"button",256),g("click",function(){h(e);let a=p(2);return f(a.createMultipleCredentials())}),t(1,"span"),r(2,"Crear Credenciales"),i()()}if(s&2){let e=p(2);d("disabled",e.actualSelectedRows===0)("nzLoading",e.isCreatingCredentials)}}function Ra(s,m){if(s&1){let e=S();t(0,"button",247),g("click",function(){h(e);let a=p(2);return f(a.done())}),t(1,"span"),r(2,"Terminar"),i()()}}function La(s,m){if(s&1&&(t(0,"div",237),v(1,ka,3,0,"button",252)(2,Ma,3,1,"button",253)(3,Ua,3,2,"button",254)(4,Ra,3,0,"button",252),i()),s&2){let e=p();o(),d("ngIf",e.current>0&&!e.isDone),o(),d("ngIf",e.current<2),o(),d("ngIf",e.current===2&&!e.isDone),o(),d("ngIf",e.current===3&&e.isDone)}}function Oa(s,m){s&1&&r(0," Nueva credencial ")}function Aa(s,m){if(s&1){let e=S();t(0,"div",250)(1,"form",117),g("ngSubmit",function(){h(e);let a=p();return f(a.createCredential())}),t(2,"div",129)(3,"div",130)(4,"nz-form-item")(5,"nz-form-label"),r(6,"V\xE1lido desde"),i(),C(7,"nz-date-picker",140),i()(),t(8,"div",130)(9,"nz-form-item")(10,"nz-form-label"),r(11,"V\xE1lido hasta"),i(),C(12,"nz-date-picker",150),i()(),t(13,"div",130)(14,"nz-form-item")(15,"nz-form-control")(16,"label",139),r(17,"Activar credencial"),i()()()()()()()}if(s&2){let e=p();o(),d("formGroup",e.credentialForm)}}function Ba(s,m){if(s&1){let e=S();t(0,"button",256),g("click",function(){h(e);let a=p();return f(a.createCredential())}),t(1,"span"),r(2,"Crear Credencial"),i()()}if(s&2){let e=p();d("disabled",e.credentialForm.invalid)("nzLoading",e.isCreatingCredentials)}}var ao=(()=>{let m=class m{constructor(n,a,l,c,u,_){this.afs=n,this.modalService=a,this.fb=l,this.aff=c,this.bucketStorage=u,this.msg=_,this.authService=I(_e),this.userService=I(Qe),this.routesService=I(et),this.dashboardService=I(li),this.productsService=I(dt),this.customersService=I(He),this.size=40,this.rolService=I(Je),this.hasBeenFiltered=!1,this.loadedDevicesList=[],this.reciboPago=[],this.newMessage="",this.loadingChatMessages=!1,this.current=0,this.isDone=!1,this.isCreatingBoardingPasses=!1,this.isCreatingCredentials=!1,this.isCollapsed=!0,this.listOfSelection=[{text:"Seleccionar todas las p\xE1ginas",onSelect:()=>{this.checkAllData(!0)}},{text:"Deseleccionar todas las p\xE1ginas",onSelect:()=>{this.checkAllData(!1),this.refreshStatus()}}],this.listOfCredentialsSelection=[{text:"Seleccionar todas las p\xE1ginas",onSelect:()=>{this.checkCredentialsAllData(!0)}},{text:"Deseleccionar todas las p\xE1ginas",onSelect:()=>{this.checkCredentialsAllData(!1),this.refreshCredentialsStatus()}}],this.isAllDisplayDataChecked=!1,this.isIndeterminate=!1,this.listOfDisplayData=[],this.mapOfCheckedId={},this.isCredentialsAllDisplayDataChecked=!1,this.isCredentialsIndeterminate=!1,this.listOfCredentialsDisplayData=[],this.listOfCredentialsAllData=[],this.mapOfCredentialsCheckedId={},this.isContentOpen=!1,this.isUserSelected=!1,this.isLoadingUsers=!1,this.loadingLastPurchase=!1,this.isBoardingPassSelected=!1,this.isCredentialSelected=!1,this.isLoadingPayments=!1,this.hasBeenLoaded=!1,this.loadingUserCredentials=!1,this.loadingLatestPurchases=!1,this.loadinglatestPurRequest=!1,this.isVisible=!1,this.isProductVisible=!1,this.isEditUserVisible=!1,this.isModalCredentialVisible=!1,this.isConfirmLoading=!1,this.productSelectedValue="",this.checked=!1,this.routes=[],this.userRoutes=[],this.products=[],this.stopPoints=[],this.stopPointsList=[],this.usersByAccount=[],this.productsReference=[],this.newCustomerIdEditMode="",this.resetClientEditInfo=!1,this.newRouteIdEditeMode="",this.newStepIdEditeMode="",this.accountId$=new te,this.routeId$=new te,this.canUpdatePayment=!1,this.canUpdateValidTo=!1,this.jobTypeIdCustomerSelected="",this.elementType="url",this.customersList=[],this.stopSubscription$=new te,this.isVisibleBulk=!1,this.isLoadingBulk=!1,this.isConfirmLoadingBulk=!1,this.isVisibleBulkCredentials=!1,this.isLoadingBulkCredentials=!1,this.isConfirmLoadingBulkCredentials=!1,this.isConfirmPagoLoading=!1,this.formatterPercent=x=>`${x} %`,this.parserPercent=x=>x.replace(" %",""),this.formatterDollar=x=>`$ ${x}`,this.parserDollar=x=>x.replace("$ ",""),this.selectedUsersForCredentials=[],this.ifValidPayment=!1,this.ifValidLiqPayment=!1,this.isValidDescriptionPaymentType=!1,this.paymentSelected="",this.isAnticipo=!1,this.fileListInfo=[],this.disabledDate=x=>!1,this.fileUrl="http://themenate.com/applicator/dist/assets/images/avatars/thumb-13.jpg",this.autosave=!0,this.uploading=!1,this.bucketPath="dashboard/",this.uploadvalue=0,this.infoLoad=[],this.purchaseActive=!1,this.isVisiblePurchasePay=!1,this.accountsService=I(Ke),this.infoSegment=[],this.requiredFields=!1,this.productSelected=[],this.switchValueUsers=!0,this.checkOptionsOne=[],this.selectedOption="",this.userCustomerId="",this.beforeUpload=x=>!1,this.authService.user.subscribe(x=>{this.user=x,this.user&&(this.userCustomerId=this.user.customerId,this.accountsService.getSegmentLevel(this.user.idSegment).pipe(P(E=>{if(E&&E.payload){let N=E.payload.id,U=E.payload.data?E.payload.data():{};return R({id:N},U)}else return console.warn("Unexpected payload structure:",E),{}})).subscribe(E=>{this.infoSegment=E,this.filldata()}))})}filldata(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.accountId$.pipe(K(x=>G(this,null,function*(){return this.afs.collection("customers").doc(x)}))).subscribe(x=>{this.customers=x}):this.accountId$.pipe(K(x=>this.afs.collection("customers",E=>E.where("active","==",!0)).valueChanges({idField:"uid"}))).subscribe(x=>{this.customers=x}),this.accountId$.pipe(K(_=>this.afs.collection("customers").doc(_).collection("routes",x=>x.where("active","==",!0)).valueChanges({idField:"routeId"}))).subscribe(_=>{this.routes=_});let a=this.accountId$.pipe(K(_=>this.afs.collection("customers").doc(_).collection("products",x=>x.where("active","==",!0)).valueChanges({idField:"productId"}))),l=this.accountId$.pipe(K(_=>this.afs.collection("customers").doc(_).collection("products",x=>x.where("active","==",!0)).valueChanges({idField:"productId"}))),c=this.accountId$.pipe(K(_=>this.afs.collection("users",x=>x.where("customerId","==",_).where("active","==",!0).orderBy("studentId")).valueChanges({idField:"uid"}))),u=this.routeId$.pipe(K(_=>this.afs.collection("customers").doc(this.currentSelectedCustomerId).collection("routes").doc(_).collection("stops",x=>x.orderBy("order","asc").where("active","==",!0)).valueChanges({idField:"stopPointId"})));l.subscribe(_=>{this.products=_}),u.subscribe(_=>{this.stopPoints=_}),c.subscribe(_=>{this.usersByAccount=_}),this.getCustomersList()}log(n){this.devicesList=[]}ngOnInit(){this.credentialForm=this.fb.group({active:[!0,[D.required]],validFrom:[new Date,[D.required]],validTo:[new Date,[D.required]]}),this.validateForm=this.fb.group({active:[!0,[D.required]],amount:[0,[D.required]],authorization:[""],category:["",[D.required]],conciliated:[!1,[D.required]],creation_date:[new Date().toISOString(),[D.required]],currency:["MXN",[D.required]],customer_id:["",[D.required]],customerId:[""],date_created:[new Date,[D.required]],due_date:[new Date,[D.required]],description:["",[D.required]],error_message:[""],fee:this.fb.group({amount:[0],currency:["MXN"],tax:[0]}),is_courtesy:[!1],method:["cash",[D.required]],name:["",[D.required]],operation_date:[new Date().toISOString(),[D.required]],operation_type:["in",[D.required]],order_id:[""],payment_method:this.fb.group({barcode_url:[""],reference:[""],type:["cash"]}),price:[0,[D.required]],product_description:["",[D.required]],product_id:["",[D.required]],round:["",[D.required]],routeId:["",[D.required]],routeName:["",[D.required]],status:["completed",[D.required]],stopDescription:["",[D.required]],stopId:["",[D.required]],stopName:["",[D.required]],transaction_type:["charge",[D.required]],validFrom:[new Date,[D.required]],validTo:[new Date,[D.required]],isTaskIn:[!1,[D.required]],isTaskOut:[!1,[D.required]],isOpenpay:[!1,[D.required]],paidApp:["web",[D.required]],realValidTo:[],payment:["",[D.required]],amountPayment:[0,[D.required]],typePayment:[""],promiseDate:[new Date],baja:[""],fileURL:[""],frequencies:[""]});let n=new Date;this.validateForm.controls.promiseDate.setValue(n),this.validateForm.controls.validTo.setValue(""),this.validateForm.controls.validFrom.setValue(n),this.validateEditForm=this.fb.group({firstName:[""],lastName:[""],displayName:[""],userName:["",[D.required]],studenId:["",[D.required]],email:["",[D.required]],customerName:["",[D.required]],defaultRoute:["",[D.required]],defaultRouteName:[""],defaultRound:[""],routeId:["",[D.required]],customerId:[""],phoneNumber:[""],defaultStopId:[""],defaultStopName:[""]}),this.validateLiqForm=this.fb.group({customerId:[""],amount:new Xe({value:"",disabled:!0}),productSelected:[""],alreadyPayment:new Xe({value:"",disabled:!0}),completeAmount:new Xe({value:"",disabled:!0}),validFrom:[""],validTo:[""],typePayment:[""],fileURL:[""]})}sendMessage(n,a){this.msg.create(n,a)}ngOnDestroy(){this.hasBeenLoaded=!1,this.loadedDevicesList=[],this.users&&this.users.unsubscribe(),this.routesSubscription&&this.routesSubscription.unsubscribe(),this.productsSubscription&&this.productsSubscription.unsubscribe(),this.stopSubscription$.next(void 0),this.stopSubscription$.complete(),this.customerSuscription&&this.customerSuscription.unsubscribe(),this.usersSubscription&&this.usersSubscription.unsubscribe(),this.userChatMessagesSubscription&&this.userChatMessagesSubscription.unsubscribe()}showModalCredential(){this.isModalCredentialVisible=!0}onBulkCredentialsSelected(n){this.accountId$.next(n),this.currentSelectedCustomerId=n,this.isVisibleBulkCredentials=!0}createCredential(){if(this.credentialForm.valid){let n=this.credentialForm.controls.validFrom.value||new Date,a=this.credentialForm.controls.validTo.value||new Date,l=this.credentialForm.controls.active.value||!1;this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.isCreatingCredentials=!0,this.customersService.createCredential(this.currentUserSelected.uid,this.currentUserSelected.studentId,n,a,l).then(c=>{this.isModalCredentialVisible=!1}),this.isCreatingCredentials=!1,this.isDone=!0):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}}activateCredential(n,a){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.activateCredential(this.currentUserSelected.uid,n,a),this.currentUserSelected.paymentId=n):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}deleteCredential(n){this.userlevelAccess=="1"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.deleteCredential(this.currentUserSelected.uid,n),this.isBoardingPassSelected=!1):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}getUserCredentials(n){this.loadingUserCredentials=!0,this.customersService.getUserCredentials(n).pipe(Y(a=>{this.userCredentials=a}),Et(a=>(console.error("Error fetching user credentials:",a),this.userCredentials=null,yt(null))),ae(()=>{this.loadingUserCredentials=!1})).subscribe()}currentCredentialsPageDataChange(n){this.listOfCredentialsDisplayData=n,this.refreshCredentialsStatus()}refreshCredentialsStatus(){let n=this.usersByAccount.length>0&&this.usersByAccount.every(l=>this.mapOfCredentialsCheckedId[l.uid]),a=this.usersByAccount.some(l=>this.mapOfCredentialsCheckedId[l.uid]);this.isCredentialsAllDisplayDataChecked=n,this.isCredentialsIndeterminate=a&&!n}checkCredentialsAllData(n){this.usersByAccount.forEach(a=>this.mapOfCredentialsCheckedId[a.uid]=n)}checkCredentialsValidBoardingPass(n){let a=this.usersByAccount.map(l=>this.customersService.getLatestValidUserPurchases(l.uid).pipe(ht(1),P(c=>c.map(u=>{let _=u.payload.doc.id,x=u.payload.doc.data();return R({id:_},x)})),Y(c=>{this.mapOfCredentialsCheckedId[l.uid]=c.length>0})));Dt(a).subscribe()}createMultipleCredentials(){this.current++;let n=this.credentialForm.controls.validFrom.value||new Date,a=this.credentialForm.controls.validTo.value||new Date,l=this.credentialForm.controls.active.value||!1;this.userlevelAccess!="3"?(this.isCreatingCredentials=!0,this.selectedUsersForCredentials.forEach(c=>{this.customersService.createCredential(c.uid,c.studentId,n,a,l).then(u=>{})}),this.isCreatingCredentials=!1,this.isDone=!0):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}showModalProduct(){this.isProductVisible=!0}onProductSelected(n,a){this.productSelected=[];let c=ie.filter(a,u=>u.productId==n)[0];this.productSelected=c,this.validateForm.controls.name.setValue(c.name),this.validateForm.controls.description.setValue(c.description),this.validateForm.controls.product_description.setValue(c.description),this.validateForm.controls.amount.setValue(c.price),this.validateForm.controls.is_courtesy.setValue(!1),this.validateForm.controls.price.setValue(c.price),this.validateForm.controls.category.setValue(c.category),this.validateForm.controls.validFrom.setValue(c.validFrom.toDate()),this.validateForm.controls.validTo.setValue(c.validTo.toDate()),this.validateForm.controls.realValidTo.setValue(c.validTo.toDate().toISOString()),this.validateForm.controls.isTaskIn.setValue(c.isTaskIn),this.validateForm.controls.isTaskOut.setValue(c.isTaskOut),this.validateForm.controls.frequencies.setValue(c.frequencies)}searchloadUsers(){this.getUsersList()}getUsersList(){this.isLoadingUsers=!0;let n=this.afs.collection("users");n=this.afs.collection("users",a=>a.where("customerId","==",this.selectedOption)),this.usersSubscription=n.snapshotChanges().pipe(P(a=>a.map(l=>{let c=l.payload.doc.id,u=l.payload.doc.data();return R({id:c},u)}))).subscribe(a=>{this.loadUsers(a),this.isCollapsed=!1})}setUserDisabled(n){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.setUserDisabled(this.currentUserSelected.uid,n),this.currentUserSelected.disabled=n):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}loadUsers(n){let a=new Map,l=[];for(let c of n)c.displayName!==null&&c.displayName!==void 0&&!a.has(c.displayName)&&(a.set(c.displayName,!0),l.push(c));l.sort((c,u)=>c.displayName.localeCompare(u.displayName)),this.devicesList=l,this.loadedDevicesList=l,this.displayData=l}userSelected(n){this.currentUserSelected=n,this.currentSelectedCustomerId=this.currentUserSelected.customerId,this.accountId$.next(this.currentUserSelected.customerId),this.isUserSelected=!0,this.isBoardingPassSelected=!1,this.requiredFields=!1,this.getJobType(n.customerId),this.getLatestPurchases(n.uid),this.getLastestPurchaseRequest(n.uid),this.getUserCredentials(n.uid),this.getUserChatMessages(n.uid),this.lastPurchase=void 0,this.productsReference=null}copyDataToUserCollection(){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?this.customersService.saveOldBoardingPassToUserCollection(this.currentUserSelected.paymentId):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}getUserChatMessages(n){this.loadingChatMessages=!0,this.userChatMessagesSubscription&&this.userChatMessagesSubscription.unsubscribe(),this.userChatMessagesSubscription=this.dashboardService.getUserChatMessages(n,10).subscribe(a=>{this.userChatMessageData=a,this.loadingChatMessages=!1})}getJobType(n){this.dashboardService.getJobType(n).pipe(k(this.stopSubscription$),P(a=>a.jobTypeID)).subscribe(a=>{a!==void 0&&a.length>0&&this.dashboardService.getJobTypeInfo(a).pipe(k(this.stopSubscription$),P(l=>l.requiredFields)).subscribe(l=>{this.requiredFields=l})},a=>{console.error("Error fetching job type:",a)})}onBulkBoardingPassSelected(n){this.accountId$.next(n),this.currentSelectedCustomerId=n,this.isVisibleBulk=!0}onCourtesyChange(n){n&&this.validateForm.controls.amount.setValue(0)}onAmountChange(n){n>0&&this.validateForm.controls.is_courtesy.setValue(!1)}onCanUpdatePayment(){if(this.canUpdatePayment=!0,this.lastPurchase!==void 0){var n=Number(this.lastPurchase.amountPayment),a=Number(this.lastPurchase.amount);this.validateLiqForm.controls.productSelected.setValue(this.lastPurchase.name),this.validateLiqForm.controls.alreadyPayment.setValue(n),this.validateLiqForm.controls.amount.setValue(a),this.validateLiqForm.controls.completeAmount.setValue(a-n),this.validateLiqForm.controls.validFrom.setValue(this.lastPurchase.validFrom.toDate()),this.productSelectedValue=this.lastPurchase.name}else console.error("lastPurchase is undefined")}createLiquidacion(){let n=this.validateLiqForm.controls.validTo.value||new Date,a=this.validateLiqForm.controls.typePayment.value;if(this.lastPurchase!==void 0){let u=this.lastPurchase?String(this.lastPurchase.id):void 0;if(n=="")this.msg.error("Se requiere  seleccionar una fecha de terminaci\xF3n de pase.");else if(a=="")this.msg.error("Se requiere  seleccionar un tipo de referencia.");else if(this.currentUserSelected&&this.currentUserSelected.uid){var l,c=this.validateLiqForm.controls.fileURL.value||"";let _=this.productSelected?.amountTrips||0,x=this.productSelected?.frequencies||0,E=this.productSelected?.weeks||0,N=this.productSelected?.rangeWeeks||{},U={authorization:"portalAuth",operation_type:"in",method:this.validateLiqForm.controls.payment.value,transaction_type:"charge",card:{type:"",brand:"",address:"",card_number:"",holder_name:"",expiration_year:"",expiration_month:"",allows_charges:"",allows_payouts:"",bank_name:"",bank_code:"",points_card:"",points_type:""},status:"completed",conciliated:!1,creation_date:new Date().toISOString(),operation_date:new Date().toISOString(),description:"Liquidaci\xF3n a traves del portal",error_message:"",order_id:"portalOrder",currency:"MXN",amount:this.validateLiqForm.controls.amountPayment.value,customer:{name:this.currentUserSelected.firstName,last_name:this.currentUserSelected.lastName,email:this.currentUserSelected.email,phone_number:this.currentUserSelected.phoneNumber,address:"",creation_date:"",external_id:"",clabe:""},product:{product_id:this.validateLiqForm.controls.product_id.value,amountTrips:_,frequencies:x,rangeWeeks:N,weeks:E,name:this.productSelected.name},customerId:this.currentUserSelected.customerId,active:!0,category:"permanente",date_created:new Date().toISOString(),product_description:"Liquidaci\xF3n a traves del portal",product_id:this.validateLiqForm.controls.product_id.value,name:this.validateLiqForm.controls.name.value,isTaskIn:"false",isTaskOut:"false",type:"Servicio",isOpenpay:!1,paidApp:"portal",price:this.lastPurchase.price,round:this.validateLiqForm.controls.round.value,routeId:this.validateLiqForm.controls.routeId.value,routeName:this.validateLiqForm.controls.routeName.value,stopDescription:"",stopId:this.validateLiqForm.controls.stopId.value,stopName:this.validateLiqForm.controls.stopDescription.value,validFrom:this.validateLiqForm.controls.validFrom.value,validTo:n,idBoardingPass:this.currentUserSelected.uid,idPurchasteRequest:"",is_courtesy:!1,typePayment:a};l={active:!0,amountPayment:this.validateLiqForm.controls.completeAmount.value,payment:"Liquidacion",status:this.validateForm.controls.status.value,customer_id:this.currentUserSelected.customerId,creation_date:this.validateForm.controls.creation_date.value,name:this.lastPurchase.name,price:this.lastPurchase.price,operation_date:this.validateForm.controls.operation_date.value,routeId:this.lastPurchase.routeId,routeName:this.lastPurchase.routeName,round:this.lastPurchase.round,stopName:this.validateForm.controls.stopDescription.value,stopId:this.validateForm.controls.stopId.value,typePayment:a,validFrom:this.validateForm.controls.validFrom.value,idBoardingPass:this.currentUserSelected.uid,idPurchasteRequest:"",baja:!1,validTo:n,type:"Servicio",fileURL:c},this.userlevelAccess!="3"?u!==void 0?this.customersService.saveBoardingPassDetailToUserPurchaseCollection(this.currentUserSelected.uid,u,U).then(B=>{if(this.msg.success("El registro se genero correctamente"),this.lastPurchase&&this.lastPurchase.realValidTo!==void 0){let j=new Date(this.lastPurchase.realValidTo);this.lastPurchase.validTo=Ct.fromDate(j),this.lastPurchase.status="completed",this.lastPurchase.active=!0,this.lastPurchase.typePayment=this.validateLiqForm.controls.typePayment.value,this.lastPurchase.status="completed",this.lastPurchase.price=this.validateLiqForm.controls.amount.value,this.lastPurchase.amountPayment=this.validateLiqForm.controls.amount.value,this.lastPurchase.payment="Liquidacion";let W=this.currentUserSelected.status;W=="preRegister"&&this.userService.updateUserPreRegister(this.currentUserSelected.uid,W),this.customersService.createPurchaseCloud(U,this.currentUserSelected,u),this.customersService.updateBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.lastPurchase).then(H=>{this.msg.success("Se actualizo el pase"),this.canUpdatePayment=!1}).catch(H=>{this.isConfirmLoading=!1})}}).catch(B=>{console.log("error")}):console.error("lastPurchase id is undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}else console.error("currentUserSelected or uid is null or undefined")}else console.error("lastPurchase is undefined")}onPaymentUpdated(n){if(this.lastPurchase!==void 0){if(+this.lastPurchase.price===n){if(this.lastPurchase.status="completed",this.lastPurchase.amount=n,this.lastPurchase.active=!0,this.lastPurchase?.realValidTo!==void 0){let a=new Date(this.lastPurchase.realValidTo);this.lastPurchase.validTo=Ct.fromDate(a)}}else this.lastPurchase.amount=n;this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.updateBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.lastPurchase).then(a=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(a=>{this.isConfirmLoading=!1}),this.canUpdatePayment=!1):console.error("currentUserSelected or uid is null or undefined"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}}getLastPurchase(n){this.loadingLastPurchase=!0,this.lastPurchase=void 0,this.customersService.getLastPurchase(n).valueChanges().subscribe(a=>{this.lastPurchase=a,this.productsReference=a,this.loadingLastPurchase=!1},a=>{this.loadingLastPurchase=!1,this.lastPurchase=void 0,this.productsReference=null})}activatePurchase(n,a){this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.activatePurchase(this.currentUserSelected.uid,n,a),this.currentUserSelected.paymentId=n):console.error("currentUserSelected or uid is null or undefined")}deletePurchase(n){this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.deletePurchase(this.currentUserSelected.uid,n),this.isBoardingPassSelected=!1,this.userService.updateUserPreRegister(this.currentUserSelected.uid,this.currentUserSelected.status)):console.error("currentUserSelected or uid is null or undefined")}getLatestPurchases(n){this.loadingLatestPurchases=!0,this.customersService.getLatestUserPurchases(n,10).pipe(P(a=>a.map(l=>{let c=l.payload.doc.id,u=l.payload.doc.data();return R({id:c},u)}))).subscribe(a=>{this.latestPurchases=a,this.loadingLatestPurchases=!1},a=>{this.latestPurchases=null,this.loadingLatestPurchases=!1})}getLastestPurchaseRequest(n){this.loadinglatestPurRequest=!0,this.customersService.getLatestUserPurchasesRequest(n,10).pipe(P(a=>a.map(l=>{let c=l.payload.doc.id,u=l.payload.doc.data();return R({id:c},u)}))).subscribe(a=>{this.latestPurRequest=a,this.loadinglatestPurRequest=!1},a=>{this.latestPurRequest=null,this.loadinglatestPurRequest=!1})}getLatestPurchaseDetail(n,a){this.customersService.getLatestUserPurchaseDetail(n,10,a).pipe(P(l=>l.map(c=>{let u=c.payload.doc.id,_=c.payload.doc.data();return R({id:u},_)}))).subscribe(l=>{this.lastestPurchaseDetail=l},l=>{this.lastestPurchaseDetail=null})}reassingBoardingPass(n,a){if(this.userlevelAccess!="3")if(this.currentUserSelected&&this.currentUserSelected.uid){if(this.lastPurchase!==void 0){let l=this.lastPurchase.id,c=this.currentUserSelected.uid;this.afs.collection("users").doc(this.currentUserSelected.id).collection("boardingPasses").doc(this.lastPurchase.id).set(this.lastPurchase).then(_=>{this.afs.collection("users").doc(c).collection("boardingPasses").doc(l).delete()})}}else console.error("currentUserSelected or uid is null or undefined");else this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}bajaBoardingPass(n,a){if(this.currentUserSelected&&this.currentUserSelected.uid){let l=this.afs.collection("users").doc(this.currentUserSelected.id).collection("boardingPasses").doc(n),c={baja:!0};l.update(c).then(u=>{}).catch(u=>{this.sendMessage("error: ",u)})}else console.error("currentUserSelected or uid is null or undefined")}boardingPassSelected(n){this.currentUserSelected&&(this.isBoardingPassSelected=!0,this.lastPurchase=n,this.productsReference=n)}createMultipleBoardingPasses(){this.isCreatingBoardingPasses=!0,setTimeout(()=>{this.isCreatingBoardingPasses=!1,this.isDone=!0},2e3)}showModal(){this.isVisible=!0}showModalEditUser(n){this.isEditUserVisible=!0,this.validateEditForm.controls.firstName.setValue(n.firstName),this.validateEditForm.controls.lastName.setValue(n.lastName),this.validateEditForm.controls.displayName.setValue(n.displayName),this.validateEditForm.controls.userName.setValue(n.userName),this.validateEditForm.controls.studenId.setValue(n.studentId),this.validateEditForm.controls.email.setValue(n.email),this.validateEditForm.controls.customerId.setValue(n.customerId),this.validateEditForm.controls.customerName.setValue(n.customerName),this.validateEditForm.controls.phoneNumber.setValue(n.phoneNumber),this.validateEditForm.controls.defaultRound.setValue(n.defaultRound),this.fillCustomerRouteEditUser(n.customerId),this.fillStopsEditUser(n.customerId,n.defaultRoute),this.validateEditForm.controls.routeId.setValue(n.defaultRoute),this.validateEditForm.controls.defaultRoute.setValue(n.defaultRoute),this.validateEditForm.controls.defaultRouteName.setValue(n.defaultRouteName),this.validateEditForm.controls.defaultStopId.setValue(n.defaultStopId),this.validateEditForm.controls.defaultStopName.setValue(n.defaultStopName)}fillCustomerRouteEditUser(n){this.routesService.getRoutes(n).pipe(k(this.stopSubscription$),P(a=>a.map(l=>{let c=l.payload.doc.id,u=l.payload.doc.data();return R({id:c},u)}))).subscribe(a=>{this.userRoutes=a})}fillStopsEditUser(n,a){this.routesService.getRouteStopPoints(n,a).pipe(k(this.stopSubscription$),P(l=>l.map(c=>{let u=c.payload.doc.id,_=c.payload.doc.data();return Oe(R({},_),{id:u})}))).subscribe(l=>{this.stopPointsList=l})}showModalMessageCenter(){return G(this,null,function*(){if(this.currentUserSelected&&this.currentUserSelected.uid){let n={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"Apps And Informa",msg:this.newMessage,requestId:"suhB7YFAh6PYXCRuJhfD",token:this.currentUserSelected.token,uid:this.currentUserSelected.uid,result:""},a={timestamp:new Date,title:"Apps And Informa General",from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",requestId:"suhB7YFAh6PYXCRuJhfD",body:this.newMessage,token:this.currentUserSelected.token,uid:this.currentUserSelected.uid};this.dashboardService.setMessage(a,this.currentUserSelected.uid),this.dashboardService.setChatMessage(n).then(()=>{this.newMessage=""})}else console.error("currentUserSelected or uid is null or undefined")})}onRouteEditUserSelected(n,a){if(n!=null&&n!=""){let c=ie.filter(a,u=>u.routeId==n)[0];if(this.currentUserSelected&&this.currentUserSelected.uid){this.validateEditForm.controls.defaultRouteName.setValue(c.name);let u=this.currentUserSelected.customerId,_=this.currentUserSelected.defaultRoute;u!=this.newCustomerIdEditMode&&_!=c.routeId?(this.newRouteIdEditeMode=c.routeId,this.fillStopsEditUser(this.newCustomerIdEditMode,c.routeId)):this.newRouteIdEditeMode=_}else console.error("currentUserSelected or uid is null or undefined")}}onRouteSelected(n,a){this.routeId$.next(n);let c=ie.filter(a,u=>u.routeId==n)[0];this.validateForm.controls.routeName.setValue(c.name)}onStopPointEditUserSelected(n,a){if(n!=null&&n!=""){let c=ie.filter(a,u=>u.id==n)[0];this.validateEditForm.controls.defaultStopName.setValue(c.name),this.newCustomerIdEditMode!=""&&(this.resetClientEditInfo=!0)}}onStopPointSelected(n,a){let c=ie.filter(a,u=>u.stopPointId==n)[0];this.validateForm.controls.stopName.setValue(c.name),this.validateForm.controls.stopDescription.setValue(c.description)}onCustomerSelected(n,a){if(this.resetClientEditInfo=!1,n!=null){let c=ie.filter(a,u=>u.uid==n)[0];this.currentUserSelected&&this.currentUserSelected.uid?(this.validateEditForm.controls.customerName.setValue(c.name),this.currentUserSelected.customerId!=c.uid?(this.newCustomerIdEditMode=c.uid,this.fillCustomerRouteEditUser(c.uid)):this.newCustomerIdEditMode=""):console.error("currentUserSelected or uid is null or undefined")}}onCanUpdateValidTo(){this.canUpdateValidTo=!0}onValidToUpdated(n){this.canUpdateValidTo=!1}handleOk(){this.isConfirmLoading=!0,setTimeout(()=>{this.isVisible=!1,this.isConfirmLoading=!1},3e3)}handleCancel(){this.isVisible=!1,this.isVisibleBulk=!1,this.isVisibleBulkCredentials=!1,this.isModalCredentialVisible=!1,this.isEditUserVisible=!1,this.isVisiblePurchasePay=!1,this.canUpdatePayment=!1}handleCancelProduct(){this.isProductVisible=!1}refreshList(){this.hasBeenLoaded=!1,this.getUsersList()}getItems(n){let a=n;if(!a){this.devicesList=this.loadedDevicesList.slice();return}let l=a.toLowerCase();this.devicesList=this.loadedDevicesList.filter(c=>Object.values(c).some(u=>String(u).toLowerCase().includes(l)))}initializeItems(){this.devicesList=this.loadedDevicesList}showDeleteConfirm(){if(this.currentUserSelected&&this.currentUserSelected.uid){let n=this.currentUserSelected.uid;this.modalService.confirm({nzTitle:"\xBFEst\xE1 seguro de eliminar esta cuenta?",nzContent:'<b style="color: red;">Toda la informaci\xF3n relacionada a esta cuenta ser\xE1 eliminada permanentemente.</b>',nzOkText:"Eliminar",nzOnOk:()=>{this.customersService.deleteUser(n),this.currentUserSelected={uid:"",studentId:"",emailVerified:"",paymentId:"",turno:"",roundTrip:"",disabled:null,customerId:"",firstName:"",lastName:"",email:"",photoURL:"",phoneNumber:"",status:"",id:"",token:"",defaultRoute:"",displayName:"",userName:"",customerName:"",defaultRound:"",defaultRouteName:"",defaultStopName:"",defaultStopId:""},this.isUserSelected=!1},nzCancelText:"No",nzOnCancel:()=>console.log("Cancel")})}else console.error("currentUserSelected or uid is null or undefined")}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(console.log(this.userCustomerId),this.afs.collection("customers").doc(this.userCustomerId).snapshotChanges().pipe(k(this.stopSubscription$),P(a=>{let l=a.payload.id,c=a.payload.data();return R({id:l},c)}),Y(a=>(console.log(a),this.customersList=[a],this.checkOptionsOne=[{value:a.id,label:a.name}],console.log(this.checkOptionsOne),a))).subscribe()):this.afs.collection("customers",a=>a.orderBy("name")).snapshotChanges().pipe(k(this.stopSubscription$),P(a=>a.map(l=>{let c=l.payload.doc.id,u=l.payload.doc.data();return R({id:c},u)})),Y(a=>(this.customersList=a,this.checkOptionsOne=a.map(l=>({value:l.id,label:l.name})),a))).subscribe()}currentPageDataChange(n){this.listOfDisplayData=n,this.refreshStatus()}refreshStatus(){this.isAllDisplayDataChecked=this.devicesList.every(n=>this.mapOfCheckedId[n.id]),this.isIndeterminate=this.devicesList.some(n=>this.mapOfCheckedId[n.id])&&!this.devicesList}checkAllData(n){this.devicesList.forEach(a=>this.mapOfCheckedId[a.id]=n)}submitForm(){if(this.validateSubmit()){var a,l,c=0;if(this.currentUserSelected&&this.currentUserSelected.uid){let E=this.currentUserSelected.uid;this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId),this.validateForm.controls.customerId.setValue(this.currentUserSelected.customerId);let N=this.validateForm.controls.amount.value,U=this.validateForm.controls.payment.value;U=="Anticipo"&&(N=this.validateForm.controls.amountPayment.value);let B=this.validateForm.controls.frequencies.value||0;B>0&&(c=Number(B)*80);let j=this.productSelected?.weeks||0,W=this.fb.group({}),H=this.productSelected?.rangeWeeks||{};for(let[X,ke]of Object.entries(H))W.addControl(X,this.fb.control(ke));let Q=this.validateForm.controls.price.value,$=this.validateForm.controls.validTo.value||new Date,Ne=this.validateForm.controls.is_courtesy.value||!1;this.validateForm.controls.due_date.setValue($.toISOString()),N!=Q&&!Ne&&this.validateForm.controls.status.setValue("partial");var u=this.validateForm.controls.promiseDate.value||"",_=this.validateForm.controls.creation_date.value.toString();let Le=this.validateForm.controls.typePayment.value;U=="Mensualidad"&&(u=this.validateForm.controls.validTo.value||new Date);for(let X in this.validateForm.controls)this.validateForm.controls[X].markAsDirty(),this.validateForm.controls[X].updateValueAndValidity();if(this.validateForm.valid){this.isConfirmLoading=!0;var x=this.validateForm.controls.fileURL.value||"";let X={authorization:"portalAuth",operation_type:"in",method:this.validateForm.controls.payment.value,transaction_type:"charge",card:{type:"",brand:"",address:"",card_number:"",holder_name:"",expiration_year:"",expiration_month:"",allows_charges:"",allows_payouts:"",bank_name:"",bank_code:"",points_card:"",points_type:""},status:this.validateForm.controls.status.value,conciliated:!1,creation_date:_,operation_date:new Date().toISOString(),description:"Pago a traves de portal",error_message:"",order_id:"portalOrder",currency:"MXN",amount:this.validateForm.controls.amountPayment.value,customer:{name:this.currentUserSelected.firstName,last_name:this.currentUserSelected.lastName,email:this.currentUserSelected.email,phone_number:this.currentUserSelected.phoneNumber,address:"",creation_date:"",external_id:"",clabe:""},product:{product_id:this.validateForm.controls.product_id.value,amountTrips:c,frequencies:B,rangeWeeks:W.value,weeks:j,name:this.productSelected.name},customerId:this.currentUserSelected.customerId,active:!0,category:"permanente",date_created:new Date().toISOString(),product_description:"Pago a traves de portal",product_id:this.validateForm.controls.product_id.value,name:this.validateForm.controls.name.value,isTaskIn:"false",isTaskOut:"false",type:"Servicio",isOpenpay:!1,paidApp:"portal",price:Q,round:this.validateForm.controls.round.value,routeId:this.validateForm.controls.routeId.value,routeName:this.validateForm.controls.routeName.value,stopDescription:"",stopId:this.validateForm.controls.stopId.value,stopName:this.validateForm.controls.stopDescription.value,validFrom:this.validateForm.controls.validFrom.value,validTo:$,idBoardingPass:this.currentUserSelected.uid,idPurchasteRequest:"",is_courtesy:!1,typePayment:U,amountTrips:c,currentTrips:0};this.userlevelAccess!="3"?(a={active:!0,amountPayment:N,payment:U,status:this.validateForm.controls.status.value,customer_id:this.currentUserSelected.customerId,customerId:this.currentUserSelected.customerId,creation_date:_,name:this.validateForm.controls.name.value,price:Q,operation_date:this.validateForm.controls.operation_date.value,routeId:this.validateForm.controls.routeId.value,routeName:this.validateForm.controls.routeName.value,round:this.validateForm.controls.round.value,stopName:this.validateForm.controls.stopDescription.value,stopId:this.validateForm.controls.stopId.value,typePayment:Le,validFrom:this.validateForm.controls.validFrom.value,validTo:$,idBoardingPass:this.currentUserSelected.uid,idPurchaseRequest:"",baja:!1,type:"Servicio",fileURL:x},this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,X).then(ke=>{this.isVisible=!1,this.isConfirmLoading=!1,this.customersService.getLatestValidUserPurchasesAdvance(E,2,u,U,_).pipe(ht(1),P(J=>J.map(ne=>{let ut=ne.payload.doc.data(),pt=ne.payload.doc.id;return R({id:pt},ut)}))).subscribe(J=>{this.customersService.saveBoardingPassDetailToUserPurchaseCollection(E,J[0].id,X).then(ne=>{this.sendUser=X,this.idBoardingPass=J[0].id,this.purchaseActive=!0,this.customersService.createPurchaseCloud(this.sendUser,this.currentUserSelected,this.idBoardingPass),console.log(X)}).catch(ne=>{console.log("error")})},J=>{console.log(J)})}).catch(ke=>{this.isConfirmLoading=!1})):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}}else console.error("currentUserSelected or uid is null or undefined")}}submitReceipt(){}createPurchaseRequest(n,a){return G(this,null,function*(){let l=this.afs.createId(),c=this.afs.collection("users").doc(n).collection("purchaseRequests").doc(l).set(a).then(()=>(console.log("Recibo de compra correctamente generado!"),l)).catch(u=>(console.error("Error writing document: ",u),""))})}validateSubmit(){if(this.validateForm.controls.product_id.value=="")return this.msg.error("Es necesario seleccionar un producto, favor de validar."),!1;if(this.validateForm.controls.round.value=="")return this.msg.error("Es necesario seleccionar un turno, favor de validar."),!1;let l=this.validateForm.controls.payment.value;if(l=="")return this.msg.error("Es necesario seleccionar un Tipo de Pago, favor de validar."),!1;let c=this.validateForm.controls.promiseDate.value,u=this.validateForm.controls.validTo.value,_=this.validateForm.controls.validFrom.value;if(l=="Anticipo"&&c=="")return this.msg.error("Al seleccionar anticipo es necesario proporcionar una fecha compromiso, favor de validar."),!1;let x=this.validateForm.controls.amountPayment.value,E=this.validateForm.controls.amount.value;if(x=="0")return this.msg.error("Es necesario porporcionar una cantidad a pagar, favor de validar."),!1;if(E<x)return this.msg.error("La cantidad a pagar es mayor al total a pagar, favor de validar."),!1;if(l=="Mensualidad"&&E!=x)return this.msg.error("La cantidad a pagar debe ser igual al total a pagar ya se que selecciono el tipo de pago Mensualidad, favor de validar."),!1;let N=this.validateForm.controls.typePayment.value;return N==""?(this.msg.error("Es necesario seleccionar un tipo de Referencia, favor de validar."),!1):N=="Sistema"&&l=="Anticipo"?(this.msg.error("No puedes seleccionar el tipo de referencia Sistema,si estas generando un anticipo, favor de validar."),!1):N=="Transferencia"&&this.fileListInfo.name==null?(this.msg.error("Es necesario tener un comprobante anexado al pago, favor de agregar uno."),!1):!0}calculateDiff(n,a){let l=new Date(n),c=new Date(a);return Math.floor((c.getTime()-l.getTime())/1e3/60/60/24)}submitEditForm(){if(this.currentUserSelected&&this.currentUserSelected.uid){let n=this.validateEditForm.controls.customerId.value==null?"":this.validateEditForm.controls.customerId.value,a=this.validateEditForm.controls.customerName.value==null?"":this.validateEditForm.controls.customerName.value,l=this.validateEditForm.controls.defaultRound.value==null?"":this.validateEditForm.controls.defaultRound.value,c=this.validateEditForm.controls.defaultRoute.value==null?"":this.validateEditForm.controls.defaultRoute.value,u=this.validateEditForm.controls.defaultRouteName.value==null?"":this.validateEditForm.controls.defaultRouteName.value,_=this.validateEditForm.controls.displayName.value==null?"":this.validateEditForm.controls.displayName.value,x=this.validateEditForm.controls.email.value==null?"":this.validateEditForm.controls.email.value,E=this.validateEditForm.controls.firstName.value==null?"":this.validateEditForm.controls.firstName.value,N=this.validateEditForm.controls.lastName.value==null?"":this.validateEditForm.controls.lastName.value,U=this.validateEditForm.controls.phoneNumber.value==null?"":this.validateEditForm.controls.phoneNumber.value,B=this.validateEditForm.controls.studenId.value==null?"":this.validateEditForm.controls.studenId.value,j=this.validateEditForm.controls.userName.value==null?"":this.validateEditForm.controls.userName.value,W=this.validateEditForm.controls.defaultStopId.value==null?"":this.validateEditForm.controls.defaultStopId.value,H=this.validateEditForm.controls.defaultStopName.value==null?"":this.validateEditForm.controls.defaultStopName.value,Q=this.currentUserSelected.uid,$=!0;this.newCustomerIdEditMode!=""&&!this.resetClientEditInfo&&(this.msg.error("Al cambiar de  Empresa es necesario asignar una operaci\xF3n y estaci\xF3n acorde a la empresa."),$=!1),j==""&&(this.msg.error("El Usuario es un valor requerido, favor de validar."),$=!1),B==""&&(this.msg.error("La Identificaci\xF3n es un valor requerido, favor de validar, si no se tiene un valor poner 0"),$=!1),x==""&&(this.msg.error("El Email es un valor requerido, favor de validar."),$=!1),n==""&&(this.msg.error("La Empresa es un valor requerido, favor de validar"),$=!1),c==""&&(this.msg.error(" La operaci\xF3n es un valor requerido, favor de validar"),$=!1);let Ne={uid:Q,customerId:n,customerName:a,defaultRound:l,defaultRoute:c,defaultRouteName:u,displayName:_,email:x,firstName:E,lastName:N,phoneNumber:U,studentId:B,userName:j,defaultStopId:W,defaultStopName:H};$&&this.customersService.updateUser(Q,Ne).then(Le=>{this.isEditUserVisible=!1,this.currentUserSelected.firstName=E,this.currentUserSelected.lastName=N,this.currentUserSelected.displayName=_,this.currentUserSelected.userName=j,this.currentUserSelected.studentId=B,this.currentUserSelected.email=x,this.currentUserSelected.customerId=n,this.currentUserSelected.customerName=a,this.currentUserSelected.phoneNumber=U,this.currentUserSelected.defaultRound=l,this.currentUserSelected.defaultRoute=c,this.currentUserSelected.defaultRouteName=u,this.currentUserSelected.defaultStopName=H,this.currentUserSelected.defaultStopId=W})}else console.error("currentUserSelected or uid is null or undefined")}submitFormProduct(){this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId),this.validateForm.controls.customerId.setValue(this.currentUserSelected.customerId);let n=this.validateForm.controls.amount.value,a=this.validateForm.controls.price.value,l=this.validateForm.controls.validTo.value,c=this.validateForm.controls.is_courtesy.value||!1;this.validateForm.controls.due_date.setValue(l.toISOString()),n!=a&&!c&&this.validateForm.controls.status.setValue("partial");for(let u in this.validateForm.controls)this.validateForm.controls[u].markAsDirty(),this.validateForm.controls[u].updateValueAndValidity();this.validateForm.valid&&(this.isConfirmLoading=!0,this.userlevelAccess!="3"?this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.validateForm.value).then(u=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(u=>{this.isConfirmLoading=!1}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador."))}pre(){this.current-=1}next(){if(this.current+=1,this.current===2){let n=[];this.usersByAccount.forEach(a=>{this.mapOfCredentialsCheckedId[a.uid]===!0&&n.push(a)}),this.actualSelectedRows=n.length,this.selectedUsersForCredentials=n}}done(){this.isVisibleBulk=!1,this.isVisibleBulkCredentials=!1,setTimeout(()=>{this.current=0,this.isDone=!0},500)}nzClicOption(){this.productsReference!==null&&this.getLatestPurchaseDetail(this.currentUserSelected.uid,this.productsReference.id)}nzClicOptionInformacion(){this.isBoardingPassSelected=!1}getBase64(n,a){let l=new FileReader;l.readAsDataURL(n),l.onload=()=>a(l.result),l.onerror=c=>console.log("Error: ",c)}handleChange2(n){if(n.file.status!=="uploading"){let l=n.file.status;this.fileListInfo=n.fileList,n.file.originFileObj&&this.getBase64(n.file.originFileObj,c=>{this.fileUrl=c;let u=n.file.name,_=`${this.bucketPath}/${u}`,x=this.bucketStorage.ref(_);this.task=this.bucketStorage.ref(_).putString(c,"data_url"),this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(P(E=>Number((E/100).toFixed(2)))).subscribe(E=>{this.uploading=E!=0,this.uploadvalue=E}),this.task.snapshotChanges().pipe(ae(()=>{this.uploading=!1,this.downloadURL=x.getDownloadURL(),this.downloadURL.subscribe(E=>G(this,null,function*(){this.updateAdvanceURL(E),E.length>0?this.sendMessage("success",`${n.file.name} Archivo cargado satisfactoriamente.`):l==="error"&&this.sendMessage("error",`${n.file.name} archivo fallido, favor de validar.`)}))})).subscribe()})}}changePayment(n){this.validateForm.controls.amountPayment.setValue(0),this.paymentSelected=n,n=="Mensualidad"?(this.isValidDescriptionPaymentType=!1,this.isAnticipo=!1,this.validateForm.controls.amountPayment.setValue(this.validateForm.controls.amount.value)):n=="Anticipo"?(this.isValidDescriptionPaymentType=!0,this.isAnticipo=!0,this.validateForm.controls.amountPayment.setValue(0)):(this.isAnticipo=!1,this.isValidDescriptionPaymentType=!0,this.validateForm.controls.amountPayment.setValue(0))}onChangeValidTo(n){let a=this.validateForm.controls.validFrom.value;if(this.paymentSelected=="Anticipo"){let l=this.credentialForm.controls.validTo.value||new Date}}changePaymentType(n){n=="Sistema"||n=="Efectivo"?this.ifValidPayment=!1:this.ifValidPayment=!0}changeLiqPaymentType(n){n=="Sistema"||n=="Efectivo"?this.ifValidLiqPayment=!1:this.ifValidLiqPayment=!0}updateAdvanceURL(n){return G(this,null,function*(){this.validateForm.controls.fileURL.patchValue(n)})}updateAdvanceLURL(n){return G(this,null,function*(){this.validateLiqForm.controls.fileURL.patchValue(n)})}downloadPdf(){try{var n=new Re;xt(document.getElementById("credencial")).then(a=>{let l=a.toDataURL("image/png"),c=new Re("p","pt","a4");var u=c.internal.pageSize.getWidth(),_=a.height*u/a.width;c.addImage(l,"PNG",10,10,u,_),c.save("credencial.pdf")})}catch(a){console.error(a)}}generatePDFInfo(){try{var n=new Re;xt(document.getElementById("recibo")).then(a=>{let l=a.toDataURL("image/png"),c=new Re("p","pt","a4");var u=c.internal.pageSize.getWidth(),_=a.height*u/a.width;c.addImage(l,"PNG",10,10,u,_),c.save("recibo.pdf")})}catch(a){console.error(a)}}generatePurchasePDF(n){console.log(n),this.reciboPago.push({amount:n.amount,amountTrips:n.amountTrips,authorization:n.authorization,creation_date:n.creation_date,currentTrips:n.currentTrips,description:n.description,method:n.method,name:n.name,price:n.price,routeName:n.routeName,round:n.round,stopName:n.stopName,type:n.type,typePayment:n.typePayment,validFrom:n.validFrom,validTo:n.validTo}),this.isVisiblePurchasePay=!0}bajaCheck(){}downloadImg(){let n=document.getElementById("download")?.querySelector("canvas");if(n){this.download.nativeElement.href=n.toDataURL("image/png"),this.download.nativeElement.download="ng-zorro-antd";let a=new MouseEvent("click");this.download.nativeElement.dispatchEvent(a)}}};m.\u0275fac=function(a){return new(a||m)(O(he),O(Gt),O(pe),O(At),O(lt),O(ee))},m.\u0275cmp=Z({type:m,selectors:[["ng-component"]],viewQuery:function(a,l){if(a&1&&(_t(Li,5),_t(Oi,5)),a&2){let c;gt(c=zt())&&(l.download=c.first),gt(c=zt())&&(l.searchbar=c.first)}},decls:92,vars:52,consts:[["searchInput",""],["suffixIconSearch",""],["modalTitle",""],["modalContent",""],["modalPassFooter",""],["modalTitleProduct",""],["modalContentProduct",""],["modalFooter",""],["modalUserTitle",""],["modalUserContent",""],["modalUserFooter",""],["modalTitlePay",""],["modalContentPay",""],["modalPassFooterPay",""],["modalContentBulk",""],["modalFooterBulk",""],["modalTitleLiq",""],["modalContentLiquidacion",""],["modalFooterLiquidacion",""],["modalTitleBulkCredentials",""],["modalContentBulkCredentials",""],["modalFooterBulkCredentials",""],["modalTitleUserCredential",""],["modalContentCredential",""],["modalFooterCredential",""],["basicTable",""],["chatSetting","nzDropdownMenu"],["basicChatData",""],["messageCenterFooterTemplate",""],["basicTablePurchase",""],["tableReference",""],["avatarTemplate",""],["download",""],["rowSelectionTable",""],[2,"margin-right","15px","margin-left","15px","background-color","#f9fbfd !important"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"chat-header",2,"background-color","#f9f9f9"],[3,"nzHeader","nzActive"],[2,"display","flex","align-items","center","gap","15px"],["nzPlaceHolder","Selecciona un cliente",2,"width","450px",3,"ngModelChange","ngModel"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[2,"flex-grow","1",3,"nzSuffix"],["type","text","nz-input","","placeholder","Buscar",3,"keyup"],["nz-button","","nzType","primary",1,"m-r-10",3,"click"],["nzCollapsible","",2,"background-color","white","border","1px solid #ccc !important","height","100vh","overflow-y","auto",3,"nzCollapsedChange","nzCollapsed","nzWidth","nzTrigger"],[1,"chat-input"],["style","height: 100%;",3,"nzData","nzShowPagination","nzPageSize","nzScroll",4,"ngIf"],[2,"background-color","white","border","1px solid #ccc !important"],["nz-icon","",1,"trigger",3,"click","nzType"],[2,"background-color","white !important","border","1px solid #ccc !important","padding","20px",3,"ngClass"],[1,"conversation"],[1,"conversation-wrapper"],["class","conversation-header justify-content-between",4,"ngIf"],["style","width: 100% !important; overflow-y: scroll !important; height: 100% !important; ",4,"ngIf"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter","nzWidth"],["class","footer",4,"ngIf"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzWidth","nzTitle","nzContent","nzFooter"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon","","nzType","search"],[2,"height","100%",3,"nzData","nzShowPagination","nzPageSize","nzScroll"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"media","align-items-center",2,"height","60px"],["nzShape","square","nzIcon","user",1,"shadow",3,"nzSize","nzSrc"],["nz-icon","",4,"ngIf"],["nz-icon",""],[1,"conversation-header","justify-content-between"],[1,"media","align-items-center"],[1,"m-r-20","d-md-none","d-block","text-dark","font-size-18","m-t-5",3,"routerLink"],["nz-icon","","type","left-circle","theme","outline"],["nzShape","square","nzIcon","user",1,"shadow",3,"nzSrc"],[1,"p-l-15"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436",4,"ngIf"],[3,"nzStatus"],["nz-dropdown","","nzPlacement","bottomRight",1,"text-dark","font-size-18",3,"nzDropdownMenu","nzTrigger"],["nz-icon","","theme","outline"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436"],["nz-menu-item","",3,"click"],[2,"width","100% !important","overflow-y","scroll !important","height","100% !important"],["nzTitle","Informacion General",3,"nzClick"],["nz-button","",1,"m-r-10",3,"click"],["nzBordered","","nzSize","small"],["nzTitle","Nombre"],[1,"custom-label-style"],["nzTitle","Apellidos"],["nzTitle","Email"],["nzTitle","Correo Valido"],["nzTitle","Display Name"],["nzTitle","Empresa"],["nzTitle","Operaci\xF3n"],["nzTitle","Estaciones"],["nzTitle","Turno"],["nzTitle","Telefono"],["nzTitle","Identificaci\xF3n"],["nzTitle","Usuario"],["nzTitle","Estatus"],["nzTitle","Tipo de Viaje"],["nzTitle","Pases"],[3,"nzData","nzPageSize","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Comprobante de Pago"],["nzTitle","Mensajes",3,"nzClick"],[3,"nzData","nzPageSize","nzFooter","nzLoadingDelay"],[4,"ngFor","ngForOf"],[3,"nzData","nzPageSize","nzLoading","nzLoadingDelay"],[3,"nzColor"],["nz-text","","nzType","secondary"],[3,"nzColor",4,"ngIf"],[4,"ngIf"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","nzTheme","outline"],["nz-icon","","nzType","ellipsis","theme","outline"],["nzPlain","","nzText","Mensaje"],["rows","4","nz-input","","placeholder","Mensaje",3,"ngModelChange","ngModel"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],["formControlName","product_id","nzAllowClear","","nzPlaceHolder","Seleccionar producto / servicio",2,"width","320px",3,"ngModelChange"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","320px",3,"ngModelChange"],["formControlName","stopId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",2,"width","320px",3,"ngModelChange"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","200px"],["nzValue","D\xEDa","nzLabel","D\xEDa"],["nzValue","Tarde","nzLabel","Tarde"],["nzValue","Noche","nzLabel","Noche"],["formControlName","payment","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de Pago",2,"width","200px",3,"ngModelChange"],["nzValue","Mensualidad","nzLabel","Mensualidad"],["nzValue","Anticipo","nzLabel","Anticipo"],["nzValue","Liquidacion","nzLabel","Liquidaci\xF3n"],[1,"row"],[1,"col-md-6"],["formControlName","amountPayment",3,"ngModelChange","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["class","col-md-6",4,"ngIf"],["formControlName","amount",3,"ngModelChange","disabled","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["formControlName","is_courtesy","nzCheckedChildren","Si","nzUnCheckedChildren","No",3,"ngModelChange"],["formControlName","typePayment","nzAllowClear","","nzPlaceHolder","Selecciona una Referencia",2,"width","200px",3,"ngModelChange"],["nzValue","Transferencia","nzLabel","Transferencia"],["nzValue","Efectivo","nzLabel","Efectivo"],["nzValue","Sistema","nzLabel","Pago por Sistema"],["nz-checkbox","","formControlName","active"],["formControlName","validFrom"],["formControlName","validTo",3,"ngModelChange","nzDisabledDate"],["formControlName","promiseDate"],["nzName","comprobante","nzType","drag","zAction","/api/posts/",3,"nzChange","nzMultiple","nzLimit","nzSize","nzFileType"],[1,"ant-upload-drag-icon"],[1,"ant-upload-text"],[1,"ant-upload-hint"],["nz-button","",3,"click"],["nz-button","",3,"click","nzLoading"],["formControlName","amount",3,"ngModelChange","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["formControlName","validTo"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngIf"],[3,"nzSm","nzXs"],["nz-input","","formControlName","firstName","id","firstName"],["nz-input","","formControlName","lastName","id","lastName"],["nz-input","","formControlName","displayName","id","displayName"],["nz-input","","formControlName","userName","id","userName"],["nz-input","","formControlName","phoneNumber","id","phoneNumber"],["nz-input","","formControlName","studenId","id","studenId"],["nz-input","","formControlName","email","id","email"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Selecciona la empresa",3,"ngModelChange"],["formControlName","defaultRoute","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",3,"ngModelChange"],["formControlName","defaultStopId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["formControlName","defaultRound","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","320px"],[1,"footer"],["nzTitle","Detalles"],["nzTitle","Producto"],["nzTitle","Pagado"],["nzStatus","success","nzText","Si",4,"ngIf"],["nzStatus","processing","nzText","Parcial",4,"ngIf"],["nzStatus","warning","nzText","No",4,"ngIf"],["nzTitle","Activo"],["nzStatus","processing","nzText","Si",4,"ngIf"],["nzTitle","Fecha de compra"],["nzTitle","Pase Cortes\xEDa"],["nzTitle","Valido desde"],["nzTitle","Valido hasta"],["nzTitle","Precio"],["nzTitle","Pagado",4,"ngIf"],["nzTitle","Autorizaci\xF3n"],["nzTitle","Estaci\xF3n"],["nzTitle","Monto Abonado"],["nzTitle","Tipo de Referencia"],["nzTitle","Fecha Compromiso"],["nzTitle","Tipo de Pago"],["nzTitle","Informaci\xF3n de la compra"],["nzTitle","Referencias",3,"nzClick"],[3,"nzData","nzPageSize","nzLoadingDelay"],["nzTitle","Historial de Uso"],[3,"userId","boardingPassId"],["nzTitle","C\xF3digo QR"],["nzTitle","Credencial"],[2,"background","#ECECEC","padding","30px"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nz-row","","id","credencial","credencial","",3,"nzGutter"],["nz-col","",2,"margin-right","76px",3,"nzSpan"],[1,"rounded-margins",2,"width","400px","border-radius","20px","height","310px","background-color","#73C2FBFE",3,"nzBordered"],["nzDescription","",2,"color","black",3,"nzAvatar","nzTitle"],[2,"color","black"],[2,"margin-bottom","1px"],[2,"display","flex","justify-content","center","align-items","center"],["nzValue","currentUserSelected?.uid-lastPurchase?.idBoardingPass"],[2,"display","flex","flex-wrap","wrap","height","100%"],[2,"width","33.33%","box-sizing","border-box","padding","5px","height","130px"],[2,"border","1px solid black","padding","5px","height","100%"],["nzTitle","",2,"background-image","url('../../../assets/images/logo/andlogoSL.png')","background-position","center","background-size","contain","height","100%",3,"nzBordered"],[2,"color","black","font-size","12px"],["nzStatus","success","nzText","Si"],["nzStatus","processing","nzText","Parcial"],["nzStatus","warning","nzText","No"],["nzStatus","processing","nzText","Si"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEditar el pago?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],[3,"ngModel","nzMin","nzMax","nzStep","nzFormatter","nzParser","ngModelChange",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEditar el pago?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel"],[3,"ngModelChange","ngModel","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["target","_blank",3,"href"],[3,"nzValue"],["nz-button","","nzType","primary",3,"click"],[3,"nzSrc"],["id","recibo","recibo",""],["class","recibo",4,"ngFor","ngForOf"],[1,"recibo"],["nzTitle","Recibo","nzDescription","And"],["nzSize","small",3,"nzCurrent"],["nzTitle","Pase","nzDescription","Crear el pase."],["nzTitle","Empresas","nzDescription","Seleccionar las empresas."],["nzTitle","Confirmar","nzDescription","Validar la creaci\xF3n."],["nzShowSizeChanger","",3,"nzCurrentPageDataChange","nzData","nzSize"],["nzShowCheckbox","","nzShowRowSelection","",3,"nzCheckedChange","nzSelections","nzChecked","nzIndeterminate"],["nzShowCheckbox","",3,"nzCheckedChange","nzChecked"],[3,"ngModel","ngModelChange",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEst\xE1s seguro de modificar la vigencia?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","\xBFVas a recibir dinero?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],[3,"ngModelChange","ngModel"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEst\xE1s seguro de modificar la vigencia?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel"],["nz-popconfirm","","nzPopconfirmTitle","\xBFVas a recibir dinero?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel"],[1,"steps-action"],["nz-button","",3,"disabled","click",4,"ngIf"],["nz-button","",3,"nzLoading","click",4,"ngIf"],["nz-button","",3,"click",4,"ngIf"],["nz-button","",3,"click","disabled"],["nz-input","","formControlName","productSelected"],["formControlName","amount"],["formControlName","alreadyPayment"],["formControlName","completeAmount"],["nz-checkbox","","formControlName","baja",3,"ngModelChange"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nzTitle","Credencial","nzDescription","Crear la credencial."],["nzTitle","Usuarios","nzDescription","Seleccionar los usuarios."],[1,"steps-content","overflow-auto"],[2,"color","#4F6F57"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"click",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"disabled","click",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"disabled","nzLoading","click",4,"ngIf"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","disabled"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","disabled","nzLoading"]],template:function(a,l){if(a&1){let c=S();t(0,"div",34)(1,"nz-layout")(2,"nz-page-header",35)(3,"nz-page-header-title",36),r(4,"General"),i(),t(5,"nz-page-header-subtitle"),r(6,"Listado general de Usuariosw "),i(),t(7,"nz-page-header-content")(8,"div",37)(9,"nz-collapse")(10,"nz-collapse-panel",38)(11,"div",39)(12,"nz-select",40),F("ngModelChange",function(_){return h(c),T(l.selectedOption,_)||(l.selectedOption=_),f(_)}),g("ngModelChange",function(_){return h(c),f(l.log(_))}),v(13,$i,2,3,"nz-option",41),i(),t(14,"nz-input-group",42)(15,"input",43,0),g("keyup",function(){h(c);let _=y(16);return f(l.getItems(_.value))}),i()(),v(17,Wi,1,0,"ng-template",null,1,V),t(19,"button",44),g("click",function(){return h(c),f(l.searchloadUsers())}),r(20,"Cargar Usuarios"),i()()()()()()(),t(21,"nz-layout")(22,"nz-sider",45),F("nzCollapsedChange",function(_){return h(c),T(l.isCollapsed,_)||(l.isCollapsed=_),f(_)}),t(23,"div",46),v(24,Gi,4,6,"nz-table",47),i()(),t(25,"nz-layout")(26,"nz-header",48)(27,"span",49),g("click",function(){return h(c),f(l.isCollapsed=!l.isCollapsed)}),i()(),t(28,"nz-content",50)(29,"div",51)(30,"div",52),v(31,Ki,23,11,"div",53),t(32,"div"),v(33,fn,58,22,"nz-tabset",54),t(34,"nz-modal",55),F("nzVisibleChange",function(_){return h(c),T(l.isVisible,_)||(l.isVisible=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancel())}),v(35,_n,1,0,"ng-template",null,2,V)(37,Sn,71,18,"ng-template",null,3,V)(39,yn,4,1,"ng-template",null,4,V),i(),t(41,"nz-modal",55),F("nzVisibleChange",function(_){return h(c),T(l.isProductVisible,_)||(l.isProductVisible=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancelProduct())}),v(42,Dn,1,0,"ng-template",null,5,V)(44,wn,28,7,"ng-template",null,6,V)(46,Tn,4,1,"ng-template",null,7,V),i(),t(48,"nz-modal",56),F("nzVisibleChange",function(_){return h(c),T(l.isEditUserVisible,_)||(l.isEditUserVisible=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancel())}),v(49,Fn,1,0,"ng-template",null,8,V)(51,Mn,61,46,"ng-template",null,9,V)(53,Un,4,0,"ng-template",null,10,V),i()(),v(55,Kn,125,63,"div",57),i()()()()()()(),t(56,"nz-modal",55),F("nzVisibleChange",function(_){return h(c),T(l.isVisiblePurchasePay,_)||(l.isVisiblePurchasePay=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancel())}),v(57,Yn,1,0,"ng-template",null,11,V)(59,ea,2,1,"ng-template",null,12,V)(61,ta,4,1,"ng-template",null,13,V),i(),t(63,"nz-modal",55),F("nzVisibleChange",function(_){return h(c),T(l.isVisibleBulk,_)||(l.isVisibleBulk=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancel())}),t(64,"div"),v(65,ia,2,0,"ng-template",null,2,V)(67,fa,10,4,"ng-template",null,14,V)(69,Ca,5,4,"ng-template",null,15,V),i()(),t(71,"nz-modal",55),F("nzVisibleChange",function(_){return h(c),T(l.canUpdatePayment,_)||(l.canUpdatePayment=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancel())}),v(72,ba,1,0,"ng-template",null,16,V)(74,Sa,41,2,"ng-template",null,17,V)(76,ya,6,0,"ng-template",null,18,V),i(),t(78,"nz-modal",58),F("nzVisibleChange",function(_){return h(c),T(l.isVisibleBulkCredentials,_)||(l.isVisibleBulkCredentials=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancel())}),v(79,Da,1,0,"ng-template",null,19,V)(81,Na,10,5,"ng-template",null,20,V)(83,La,5,4,"ng-template",null,21,V),i(),t(85,"nz-modal",58),F("nzVisibleChange",function(_){return h(c),T(l.isModalCredentialVisible,_)||(l.isModalCredentialVisible=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancel())}),v(86,Oa,1,0,"ng-template",null,22,V)(88,Aa,18,1,"ng-template",null,23,V)(90,Ba,3,2,"ng-template",null,24,V),i()}if(a&2){let c=y(18),u=y(36),_=y(38),x=y(40),E=y(43),N=y(45),U=y(47),B=y(50),j=y(52),W=y(54),H=y(58),Q=y(60),$=y(62),Ne=y(68),Le=y(70),X=y(73),ke=y(75),J=y(77),ne=y(82),ut=y(84),pt=y(89),Ti=y(91);o(2),d("nzGhost",!1),o(8),d("nzHeader","Filtros avanzados")("nzActive",!0),o(2),w("ngModel",l.selectedOption),o(),d("ngForOf",l.customersList),o(),d("nzSuffix",c),o(8),w("nzCollapsed",l.isCollapsed),d("nzWidth",330)("nzTrigger",null),o(2),d("ngIf",(l.devicesList==null?null:l.devicesList.length)>0),o(3),d("nzType",l.isCollapsed?"menu-unfold":"menu-fold"),o(),d("ngClass",A(50,Ai,l.isContentOpen)),o(3),d("ngIf",l.isUserSelected),o(2),d("ngIf",l.isUserSelected),o(),w("nzVisible",l.isVisible),d("nzTitle",u)("nzContent",_)("nzFooter",x),o(7),w("nzVisible",l.isProductVisible),d("nzTitle",E)("nzContent",N)("nzFooter",U),o(7),w("nzVisible",l.isEditUserVisible),d("nzTitle",B)("nzContent",j)("nzFooter",W)("nzWidth",600),o(7),d("ngIf",l.isBoardingPassSelected),o(),w("nzVisible",l.isVisiblePurchasePay),d("nzTitle",H)("nzContent",Q)("nzFooter",$),o(7),w("nzVisible",l.isVisibleBulk),d("nzTitle","Emitir m\xFAltiples pases")("nzContent",Ne)("nzFooter",Le),o(8),w("nzVisible",l.canUpdatePayment),d("nzTitle",X)("nzContent",ke)("nzFooter",J),o(7),w("nzVisible",l.isVisibleBulkCredentials),d("nzWidth",800)("nzTitle","Emitir m\xFAltiples credenciales")("nzContent",ne)("nzFooter",ut),o(7),w("nzVisible",l.isModalCredentialVisible),d("nzWidth",800)("nzTitle","Emitir credencial")("nzContent",pt)("nzFooter",Ti)}},dependencies:[Tt,le,qe,Yt,fe,ze,ge,Ce,ve,be,je,Ge,Ut,Mt,ai,Zt,at,tt,it,ei,ot,nt,rt,ti,De,Rt,si,ci,di,mi,ri,st,pi,ui,fi,hi,jt,Wt,$t,Xt,qt,Bt,Ht,Qt,Jt,ye,xe,Se,Lt,Ot,Pe,Ee,Ve,Kt,ii,we,Te,It,ce,We,se,de,me,ue,kt,Ze,Ye,oi,ni,_i,$e,Ft],styles:[".centered-header[_ngcontent-%COMP%]{justify-content:center;align-items:center}.header-content[_ngcontent-%COMP%]{text-align:center}.recibo[_ngcontent-%COMP%]{margin-bottom:10px;width:500px}.horizontal-checkbox[_ngcontent-%COMP%]{display:inline-block;margin-right:8px}.chat-container[_ngcontent-%COMP%]{width:300px;display:flex;flex-direction:column;border:1px solid #ccc;border-radius:5px;overflow:hidden;font-family:Arial,sans-serif;background-color:#fff}.chat-header[_ngcontent-%COMP%]{padding:10px;text-align:center;font-weight:700;border:1px solid #edf2f9}.chat-list[_ngcontent-%COMP%]{flex:1;height:150px;overflow-y:auto;padding:10px;background-color:#fff}.chat-message[_ngcontent-%COMP%]{padding:5px;margin-bottom:10px;border-radius:5px;background-color:#fff;border:1px solid #ddd}.chat-message[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{font-weight:700;margin-right:5px}.chat-input[_ngcontent-%COMP%]{display:flex;height:400px;padding:10px;background-color:#fff;border-top:1px solid}.chat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:10px;border:1px solid #ccc;border-radius:5px}.chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;margin-left:10px;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer}.chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.trigger[_ngcontent-%COMP%]{font-size:18px;line-height:64px;padding:0 24px;cursor:pointer;transition:color .3s}.trigger[_ngcontent-%COMP%]:hover{color:#f9f9f9}nz-header[_ngcontent-%COMP%]{background:#fff;padding:0}"]});let s=m;return s})();var wi=(()=>{let m=class m{constructor(n,a){this.afs=n,this.messageService=a}getFiles(){return this.afs.collectionGroup("quality",a=>a.where("active","==",!0).orderBy("folder","desc")).valueChanges()}saveFileCollection(n){let a=this.afs.createId();return n.uid=a,console.log(a),this.afs.collection("quality").doc(a).set(n)}deletePurchase(n){this.filesCollection=this.afs.collection("quality").doc(n),this.filesCollection.delete().then(()=>{this.sendMessage("success","Se borro con \xE9xito el Archivo")}).catch(a=>{this.sendMessage("error",`\xA1Oops! Algo sali\xF3 mal cuando se intentaba borrar un archivo ... ${a}`)})}sendMessage(n,a){this.messageService.create(n,a)}};m.\u0275fac=function(a){return new(a||m)(ft(he),ft(ee))},m.\u0275prov=Vt({token:m,factory:m.\u0275fac,providedIn:"root"});let s=m;return s})();function qa(s,m){if(s&1&&C(0,"nz-option",22),s&2){let e=m.$implicit;d("nzValue",e)("nzLabel",e)}}function $a(s,m){s&1&&C(0,"input",23)}function Wa(s,m){if(s&1){let e=S();t(0,"button",11),g("click",function(){h(e);let a=p();return f(a.newFolderSave())}),r(1,"\u2713"),i()}}function Xa(s,m){if(s&1){let e=S();t(0,"button",24),g("click",function(){h(e);let a=p();return f(a.handleOKEdit())}),r(1,"Aceptar"),i(),t(2,"button",11),g("click",function(){h(e);let a=p();return f(a.handleCancelEdit())}),r(3,"Cancelar"),i()}if(s&2){let e=p();d("nzLoading",e.isConfirmLoading)}}function ja(s,m){if(s&1&&(t(0,"div")(1,"a",27),r(2,"Ver Comprobante"),i()()),s&2){let e=p(2);o(),Me("href",e.urlFile,Ae)}}function Ga(s,m){if(s&1){let e=S();t(0,"div")(1,"form",25)(2,"nz-form-item")(3,"button",11),g("click",function(){h(e);let a=p();return f(a.changeOption(1))}),r(4,"Ver"),i(),t(5,"button",11),g("click",function(){h(e);let a=p();return f(a.changeOption(2))}),r(6,"Borrar"),i()(),t(7,"nz-form-item"),v(8,ja,3,1,"div",26),i()()()}if(s&2){let e=p();o(8),d("ngIf",e.isVerVisible)}}var fo=(()=>{let m=class m{constructor(n,a,l){this.msg=n,this.bucketStorage=a,this.fb=l,this.rolService=I(Je),this.authService=I(_e),this.isConfirmLoading=!1,this.fileUrl="http://themenate.com/applicator/dist/assets/images/avatars/thumb-13.jpg",this.autosave=!0,this.uploading=!1,this.bucketPath="/quality1/quality/",this.view="Ver",this.isVerVisible=!1,this.isEditModalVisible=!1,this.urlFile="",this.uploadvalue=0,this.rowFolders=[],this.addNewFolder=!1,this.selectedRecord=[],this.rowGroupPanelShow="always",this.infoLoad=[],this.qualityService=I(wi),this.authService.user.subscribe(c=>{this.user=c,this.user&&this.user.rolId!=null&&this.rolService.getRol(this.user.rolId).valueChanges().subscribe(u=>{this.infoLoad=u,this.userlevelAccess=this.infoLoad.optionAccessLavel})})}ngOnInit(){this.validateForm=this.fb.group({folder:[""],fileUrl:[""],fileName:[""],NewFolderName:[""]}),this.loadFiles()}sendMessage(n,a){this.msg.create(n,a)}loadFiles(){this.qualitySubscription=this.qualityService.getFiles().subscribe(n=>{if(this.rowData=n,n.length>=0){n.forEach(l=>{this.rowFolders.push(l.folder)});let a=Array.from(new Set(this.rowFolders));this.rowFolders=a}})}ngOnDestroy(){this.qualitySubscription.unsubscribe()}submitForm(){var n,a=this.fileURL||"",l=this.validateForm.controls.folder.value||"",c=this.fileName||"No-Name",u=new Date;l==""&&this.msg.error("Se requiere seleccionar una carpeta para almacenenar."),a==""&&this.msg.error("Se requiere tener un archivo para subir."),n={active:!0,folder:l,fileUrl:a,fileName:c,creation_date:u,uid:""},this.userlevelAccess!="3"?this.qualityService.saveFileCollection(n).then(_=>{this.msg.success("Se subio el archivo con \xE9xito."),this.refreshTable()}).catch(_=>{this.msg.error("Se presento un error."+_)}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}changeFolder(n){}newFolder(){this.addNewFolder=!0}handleChange(n){if(n.file.status!=="uploading"){let l=n.file.status;this.fileListInfo=n.fileList,n.file.originFileObj&&this.getBase64(n.file.originFileObj,c=>{this.fileUrl=c;let u=n.file.name,_=`${this.bucketPath}/${u}`,x=this.bucketStorage.ref(_);this.task=this.bucketStorage.ref(_).putString(c,"data_url"),this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(P(E=>Number((E/100).toFixed(2)))).subscribe(E=>{this.uploading=E!=0,this.uploadvalue=E}),this.task.snapshotChanges().pipe(ae(()=>{this.uploading=!1,this.downloadURL=x.getDownloadURL(),this.downloadURL.subscribe(E=>G(this,null,function*(){this.updateURL(E),E.length>0?this.sendMessage("success",`${n.file.name} Archivo cargado satisfactoriamente.`):l==="error"&&this.sendMessage("error",`${n.file.name} archivo fallido, favor de validar.`)}))})).subscribe()})}}updateURL(n){return G(this,null,function*(){this.fileURL=n})}getBase64(n,a){let l=new FileReader;l.readAsDataURL(n),l.onload=()=>a(l.result),l.onerror=c=>console.log("Error: ",c)}refreshTable(){this.loadFiles()}newFolderSave(){let n=this.validateForm.get("NewFolderName");n&&n.value!==null&&(this.rowFolders.push(n.value),this.addNewFolder=!1,this.validateForm.controls.NewFolderName.setValue(""))}handleOKEdit(){this.isVerVisible?this.isVerVisible=!0:this.userlevelAccess=="1"?(this.qualityService.deletePurchase(this.selectedUid),this.refreshTable(),this.isEditModalVisible=!1):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}changeOption(n){n==2?this.isVerVisible=!1:this.isVerVisible=!0}handleCancelEdit(){this.isEditModalVisible=!1}handleChangeUpload(n){n.file.status!=="uploading"&&(n.file.status==="done"?this.msg.success(`${n.file.name} file uploaded successfully`):n.file.status==="error"&&this.msg.error(`${n.file.name} file upload failed.`),n.file.originFileObj&&this.getBase64(n.file.originFileObj,a=>{this.fileUrl=a;let l=this.bucketStorage.ref(this.bucketPath+n.file.name);this.task=this.bucketStorage.ref(this.bucketPath+n.file.name).putString(a,"data_url"),this.fileName=n.file.name;var c=this.bucketStorage.ref(this.bucketPath).child(n.file.name);this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(P(u=>Number((u/100).toFixed(2)))).subscribe(u=>{this.uploading=u!=0,this.uploadvalue=u}),this.task.snapshotChanges().pipe(ae(()=>{this.downloadURL=l.getDownloadURL(),this.downloadURL.subscribe(u=>G(this,null,function*(){this.updateURL(u)}))})).subscribe()}))}};m.\u0275fac=function(a){return new(a||m)(O(ee),O(lt),O(pe))},m.\u0275cmp=Z({type:m,selectors:[["ng-component"]],decls:44,vars:8,consts:[["modalFooterEdit",""],["modalContent",""],[2,"margin","buttom 15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],["nz-form","","nzLayout","vertical",3,"formGroup"],[1,"body"],[1,"row"],[1,"col-md-4"],["formControlName","folder","nzAllowClear","","nzPlaceHolder","Selecciona una carpeta donde almacenar el documento.",2,"width","200px",3,"ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],[1,"col-md-8"],["style","width: 350px;","nz-input","","placeholder","Ingresa el nombre de la carpeta","formControlName","NewFolderName",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"click",4,"ngIf"],[1,"col-md-2"],["zAction","/api/posts/",3,"nzChange"],["nz-button",""],["nz-icon",""],[1,"col-md-10"],[1,"col-md-12"],["nzTitle","Detalle Archivo","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],[3,"nzValue","nzLabel"],["nz-input","","placeholder","Ingresa el nombre de la carpeta","formControlName","NewFolderName",2,"width","350px"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","nzLoading"],["nz-form",""],[4,"ngIf"],["target","_blank",3,"href"]],template:function(a,l){if(a&1){let c=S();t(0,"div",2)(1,"div",3)(2,"nz-page-header",4)(3,"nz-page-header-title"),r(4,"Calidad"),i(),t(5,"nz-page-header-subtitle"),r(6," Repositorio "),i()(),t(7,"form",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"nz-form-item")(12,"nz-form-label"),r(13,"Carpeta"),i(),t(14,"nz-select",9),g("ngModelChange",function(_){return h(c),f(l.changeFolder(_))}),v(15,qa,1,2,"nz-option",10),i(),t(16,"button",11),g("click",function(){return h(c),f(l.newFolder())}),r(17,"+"),i()()(),t(18,"div",12),v(19,$a,1,0,"input",13)(20,Wa,2,0,"button",14),i()(),t(21,"div",7)(22,"div",15)(23,"nz-form-item")(24,"nz-upload",16),g("nzChange",function(_){return h(c),f(l.handleChangeUpload(_))}),t(25,"button",17),C(26,"span",18),r(27," Cargar Archivo "),i()()()(),t(28,"div",19)(29,"nz-form-item")(30,"button",11),g("click",function(){return h(c),f(l.submitForm())}),r(31,"Subir"),i()()()()(),t(32,"div",7)(33,"div",15)(34,"button",11),g("click",function(){return h(c),f(l.refreshTable())}),r(35,"Actualizar"),i()(),C(36,"div",19),i(),t(37,"div",7),C(38,"div",20),i()()(),t(39,"nz-modal",21),F("nzVisibleChange",function(_){return h(c),T(l.isEditModalVisible,_)||(l.isEditModalVisible=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancelEdit())}),v(40,Xa,4,1,"ng-template",null,0,V),i(),v(42,Ga,9,1,"ng-template",null,1,V),i()}if(a&2){let c=y(41),u=y(43);o(2),d("nzGhost",!1),o(5),d("formGroup",l.validateForm),o(8),d("ngForOf",l.rowFolders),o(4),d("ngIf",l.addNewFolder),o(),d("ngIf",l.addNewFolder),o(19),w("nzVisible",l.isEditModalVisible),d("nzContent",u)("nzFooter",c)}},dependencies:[le,qe,fe,ze,ge,Ce,ve,be,Ge,De,st,ye,xe,Se,Pe,Ee,Ve,we,Te,ce,We,se,de,me,ue,Nt],styles:[".footer[_ngcontent-%COMP%]{height:100%!important;position:absolute;padding:0 25px;display:flex;justify-content:space-between}.body[_ngcontent-%COMP%]{overflow-y:auto;padding:15px 25px;position:relative;width:100%}"]});let s=m;return s})();var Fe=s=>({passes:s}),Ie=s=>({data:s});function Ha(s,m){if(s&1&&(t(0,"nz-option",43),r(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(),b(" ",e.name,"")}}function Qa(s,m){if(s&1&&(t(0,"nz-option",43),C(1,"i",44),r(2),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(2),L(" ",e.name," $",e.price," ")}}function Ja(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),i(),t(7,"td"),r(8),i(),t(9,"td"),r(10),i()()),s&2){let e=m.$implicit,n=p();o(2),z(e.customerName),o(2),z(e.routeName),o(2),z(n.customCellRenderer(A(7,Ie,A(5,Fe,e.passes)))),o(2),z(n.customCellRendererMonto(A(11,Ie,A(9,Fe,e.passes)))),o(2),z(n.formatPermission(e.permission))}}function Ka(s,m){if(s&1&&(t(0,"nz-option",43),r(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(),b(" ",e.name,"")}}function Ya(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),i(),t(7,"td"),r(8),i(),t(9,"td"),r(10),i()()),s&2){let e=m.$implicit,n=p();o(2),z(e.customerName),o(2),z(e.routeName),o(2),z(n.customCellRenderer(A(7,Ie,A(5,Fe,e.passes)))),o(2),z(n.customCellRendererMonto(A(11,Ie,A(9,Fe,e.passes)))),o(2),z(n.formatPermission(e.permission))}}function Za(s,m){if(s&1&&(t(0,"nz-option",43),r(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(),b(" ",e.name," ")}}function er(s,m){if(s&1&&(t(0,"div")(1,"nz-option",43),C(2,"i",44),r(3),i()()),s&2){let e=m.$implicit;o(),d("nzLabel",e.name)("nzValue",e.id),o(2),L(" ",e.name," $",e.price," ")}}function tr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",43),C(2,"i",44),r(3),i()()),s&2){let e=m.$implicit;o(),d("nzLabel",e.name)("nzValue",e.id),o(2),b(" ",e.name," ")}}function ir(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),i(),t(7,"td"),r(8),i(),t(9,"td"),r(10),i()()),s&2){let e=m.$implicit,n=p();o(2),z(e.customerName),o(2),z(e.routeName),o(2),z(n.customCellRenderer(A(7,Ie,A(5,Fe,e.passes)))),o(2),z(n.customCellRendererMonto(A(11,Ie,A(9,Fe,e.passes)))),o(2),z(n.formatPermission(e.permission))}}function nr(s,m){if(s&1&&(t(0,"nz-option",43),r(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(),b(" ",e.name," ")}}function ar(s,m){if(s&1&&(t(0,"div")(1,"nz-option",43),C(2,"i",44),r(3),i()()),s&2){let e=m.$implicit;o(),d("nzLabel",e.name)("nzValue",e.id),o(2),L(" ",e.name," $",e.price," ")}}function rr(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),i(),t(7,"td"),r(8),i(),t(9,"td"),r(10),i(),t(11,"td"),r(12),i(),t(13,"td"),r(14),i(),t(15,"td"),r(16),i(),t(17,"td"),r(18),i(),t(19,"td"),r(20),i()()),s&2){let e=m.$implicit,n=p();o(2),z(e.customerName),o(2),z(e.routeName),o(2),z(e.round),o(2),z(e.stopName),o(2),z(e.name),o(2),z(n.formatPermission(e.isTaskIn)),o(2),z(n.formatPermission(e.isTaskOut)),o(2),z(n.formatPermission(e.is_courtesy)),o(2),z(n.formatValidTo(e.validFrom)),o(2),z(n.formatValidTo(e.validTo))}}function or(s,m){if(s&1&&(t(0,"nz-option",43),r(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(),b(" ",e.name," ")}}function lr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",43),C(2,"i",44),r(3),i()()),s&2){let e=m.$implicit;o(),d("nzLabel",e.name)("nzValue",e.id),o(2),L(" ",e.name," $",e.price," ")}}function sr(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),i(),t(7,"td"),r(8),i(),t(9,"td"),r(10),i(),t(11,"td"),r(12),i(),t(13,"td"),r(14),i(),t(15,"td"),r(16),i(),t(17,"td"),r(18),i(),t(19,"td"),r(20),i()()),s&2){let e=m.$implicit,n=p();o(2),z(e.customerName),o(2),z(e.routeName),o(2),z(e.round),o(2),z(e.amountPayment),o(2),z(n.formatPromiseDate(e.promiseDate)),o(2),z(n.calculateDaysDifference(e.promiseDate)),o(2),b(" ",e.name,""),o(2),z(n.formatMeteSacaCortesia(e)),o(2),z(n.formatValidTo(e.validFrom)),o(2),z(n.formatValidTo(e.validTo))}}function dr(s,m){if(s&1&&(t(0,"nz-option",43),r(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(),b(" ",e.name," ")}}function cr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",43),C(2,"i",44),r(3),i()()),s&2){let e=m.$implicit;o(),d("nzLabel",e.name)("nzValue",e.id),o(2),L(" ",e.name," $",e.price," ")}}function mr(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),i(),t(7,"td"),r(8),i(),t(9,"td"),r(10),i(),t(11,"td"),r(12),i(),t(13,"td"),r(14),i(),t(15,"td"),r(16),i(),t(17,"td"),r(18),i(),t(19,"td"),r(20),i(),t(21,"td"),r(22),i()()),s&2){let e=m.$implicit,n=p();o(2),z(e.customerName),o(2),z(e.routeName),o(2),z(e.round),o(2),z(e.amountPayment),o(2),z(n.calculatePendingPayment(e)),o(2),z(n.formatPromiseDate(e.promiseDate)),o(2),z(n.calculateDaysDifference(e.promiseDate)),o(2),b(" ",e.name,""),o(2),z(n.formatMeteSacaCortesia(e)),o(2),z(n.formatValidTo(e.validFrom)),o(2),z(n.formatValidTo(e.validTo))}}function ur(s,m){if(s&1&&(t(0,"nz-option",43),r(1),i()),s&2){let e=m.$implicit;d("nzLabel",e.name)("nzValue",e.id),o(),b(" ",e.name," ")}}function pr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",43),C(2,"i",44),r(3),i()()),s&2){let e=m.$implicit;o(),d("nzLabel",e.name)("nzValue",e.id),o(2),L(" ",e.name," $",e.price," ")}}function hr(s,m){if(s&1&&(t(0,"div")(1,"nz-option",43),C(2,"i",44),r(3),i()()),s&2){let e=m.$implicit;o(),d("nzLabel",e.routeName)("nzValue",e.routeId),o(2),b(" ",e.routeName," ")}}function fr(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),i(),t(7,"td"),r(8),i(),t(9,"td"),r(10),i(),t(11,"td"),r(12),i(),t(13,"td"),r(14),i(),t(15,"td"),r(16),i(),t(17,"td"),r(18),i(),t(19,"td"),r(20),i(),t(21,"td"),r(22),i()()),s&2){let e=m.$implicit,n=p();o(2),z(e.customerName),o(2),z(e.routeName),o(2),z(e.round),o(2),z(e.amountPayment),o(2),z(n.calculatePendingPayment(e)),o(2),z(n.formatPromiseDate(e.promiseDate)),o(2),z(n.calculateDaysDifference(e.promiseDate)),o(2),b(" ",e.name,""),o(2),z(n.formatMeteSacaCortesia(e)),o(2),z(n.formatValidTo(e.validFrom)),o(2),z(n.formatValidTo(e.validTo))}}function _r(s,m){if(s&1&&(t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),i(),t(5,"td"),r(6),i(),t(7,"td"),r(8),i(),t(9,"td"),r(10),i(),t(11,"td"),r(12),i(),t(13,"td"),r(14),i(),t(15,"td"),r(16),i(),t(17,"td"),r(18),i(),t(19,"td"),r(20),i(),t(21,"td"),r(22),i()()),s&2){let e=m.$implicit,n=p();o(2),z(e.customerName),o(2),z(e.routeName),o(2),z(e.round),o(2),z(e.amountPayment),o(2),z(n.calculatePendingPayment(e)),o(2),z(n.formatPromiseDate(e.promiseDate)),o(2),z(n.calculateDaysDifference(e.promiseDate)),o(2),b(" ",e.name,""),o(2),z(n.formatMeteSacaCortesia(e)),o(2),z(n.formatValidTo(e.validFrom)),o(2),z(n.formatValidTo(e.validTo))}}function gr(s,m){if(s&1){let e=S();t(0,"button",21),g("click",function(){h(e);let a=p();return f(a.handleOK())}),r(1,"Aceptar"),i()}}function zr(s,m){if(s&1&&(t(0,"div")(1,"form",45)(2,"nz-form-item")(3,"nz-form-label",46),r(4,"Empresa:"),i(),t(5,"nz-form-control",46),r(6),i()(),t(7,"nz-form-item")(8,"nz-form-label",46),r(9,"Turno:"),i(),t(10,"nz-form-control",46),r(11),i()(),t(12,"nz-form-item")(13,"nz-form-label",46),r(14,"Operaci\xF3n:"),i(),t(15,"nz-form-control",46),r(16),i()(),t(17,"nz-form-item")(18,"nz-form-label",46),r(19,"Display:"),i(),t(20,"nz-form-control",46),r(21),i()(),t(22,"nz-form-item")(23,"nz-form-label",46),r(24,"Correo:"),i(),t(25,"nz-form-control",46),r(26),i()(),t(27,"nz-form-item")(28,"nz-form-label",46),r(29,"Nombre:"),i(),t(30,"nz-form-control",46),r(31),i()(),t(32,"nz-form-item")(33,"nz-form-label",46),r(34,"Apellidos:"),i(),t(35,"nz-form-control",46),r(36),i()(),t(37,"nz-form-item")(38,"nz-form-label",46),r(39,"Tel\xE9fono:"),i(),t(40,"nz-form-control",46),r(41),i()(),t(42,"nz-form-item")(43,"nz-form-label",46),r(44,"Identificaci\xF3n:"),i(),t(45,"nz-form-control",46),r(46),i()()()()),s&2){let e=p();o(),d("formGroup",e.signupForm),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupForm.get("customerName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupForm.get("defaultRound").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupForm.get("defaultRouteName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupForm.get("displayName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupForm.get("email").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupForm.get("firstName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupForm.get("lastName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupForm.get("phone").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupForm.get("studentId").value)}}function vr(s,m){if(s&1&&(t(0,"div")(1,"form",45)(2,"nz-form-item")(3,"nz-form-label",46),r(4,"Empresa:"),i(),t(5,"nz-form-control",46),r(6),i()(),t(7,"nz-form-item")(8,"nz-form-label",46),r(9,"Turno:"),i(),t(10,"nz-form-control",46),r(11),i()(),t(12,"nz-form-item")(13,"nz-form-label",46),r(14,"Operaci\xF3n:"),i(),t(15,"nz-form-control",46),r(16),i()(),t(17,"nz-form-item")(18,"nz-form-label",46),r(19,"Display:"),i(),t(20,"nz-form-control",46),r(21),i()(),t(22,"nz-form-item")(23,"nz-form-label",46),r(24,"Correo:"),i(),t(25,"nz-form-control",46),r(26),i()(),t(27,"nz-form-item")(28,"nz-form-label",46),r(29,"Nombre:"),i(),t(30,"nz-form-control",46),r(31),i()(),t(32,"nz-form-item")(33,"nz-form-label",46),r(34,"Apellidos:"),i(),t(35,"nz-form-control",46),r(36),i()(),t(37,"nz-form-item")(38,"nz-form-label",46),r(39,"Tel\xE9fono:"),i(),t(40,"nz-form-control",46),r(41),i()(),t(42,"nz-form-item")(43,"nz-form-label",46),r(44,"Identificaci\xF3n:"),i(),t(45,"nz-form-control",46),r(46),i()()()()),s&2){let e=p();o(),d("formGroup",e.signupFormCV),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupFormCV.get("customerName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupFormCV.get("defaultRound").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupFormCV.get("defaultRouteName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupFormCV.get("displayName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupFormCV.get("email").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupFormCV.get("firstName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupFormCV.get("lastName").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupFormCV.get("phone").value),o(2),d("nzSm",6)("nzXs",24),o(2),d("nzSm",14)("nzXs",24),o(),z(e.signupFormCV.get("studentId").value)}}function Cr(s,m){if(s&1){let e=S();t(0,"button",21),g("click",function(){h(e);let a=p();return f(a.handleOK())}),r(1,"Aceptar"),i()}}var Io=(()=>{let m=class m{constructor(n,a,l){this.fb=n,this.msg=a,this.afs=l,this.authService=I(_e),this.usersService=I(Qe),this.usersServices=I(He),this.routesService=I(et),this.productsService=I(dt),this.accountsService=I(Ke),this.stopSubscription$=new te,this.sumOfField=0,this.rowData=[],this.rowDataPay=[],this.rowDataPayTurn=[],this.rowDataPayCV=[],this.rowDataPayCVByR=[],this.TotalUsers=0,this.TotalMPP=0,this.TotalMPByRoute=0,this.usersList=[],this.usersListA=[],this.usersListCV=[],this.routesList=[],this.products=[],this.amountCV=0,this.priceCV=0,this.accountId$=new te,this.productsListV=[],this.shift=[],this.isModalVisible=!1,this.isModalVisibleCV=!1,this.customersList=[],this.checkOptionsOne=[],this.infoSegment=[],this.userCustomerId="",this.validateForm=this.fb.group({id:[null],customerId:[null]}),this.validateFormO=this.fb.group({id:[null],customerId:[null]}),this.validateFormPase=this.fb.group({id:[null],customerId:[null]}),this.validateFormTurn=this.fb.group({id:[null],turno:[""],customerId:[null]}),this.validateFormAnticipos=this.fb.group({id:[null],turno:[""],customerId:[null]}),this.validateFormCV=this.fb.group({id:[null],customerId:[null]}),this.validateFormCVByRoute=this.fb.group({id:[null],routeId:[""],customerId:[null]}),this.signupForm=this.fb.group({id:[],customerName:[""],defaultRound:[""],defaultRouteName:[""],displayName:[""],email:[""],firstName:[""],lastName:[""],phone:[""],studentId:[""]}),this.signupFormCV=this.fb.group({id:[],customerName:[""],defaultRound:[""],defaultRouteName:[""],displayName:[""],email:[""],firstName:[""],lastName:[""],phone:[""],studentId:[""]}),this.shift=[{id:"D\xEDa",name:"D\xEDa"},{id:"Tarde",name:"Tarde"},{id:"Noche",name:"Noche"}],this.validateForm.get("id")?.valueChanges.subscribe(c=>{console.log("Selected Product ID:",c)}),this.authService.user.subscribe(c=>{this.user=c,this.user&&(this.userCustomerId=this.user.customerId,this.accountsService.getSegmentLevel(this.user.idSegment).pipe(P(u=>{if(u&&u.payload){let _=u.payload.id,x=u.payload.data?u.payload.data():{};return R({id:_},x)}else return console.warn("Unexpected payload structure:",u),{}})).subscribe(u=>{this.infoSegment=u,this.getCustomersList()}))})}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(console.log(this.userCustomerId),this.afs.collection("customers").doc(this.userCustomerId).snapshotChanges().pipe(k(this.stopSubscription$),P(a=>{let l=a.payload.id,c=a.payload.data();return R({id:l},c)}),Y(a=>(console.log(a),this.customersList=[a],this.checkOptionsOne=[{value:a.id,label:a.name}],console.log(this.checkOptionsOne),a))).subscribe()):this.afs.collection("customers",a=>a.orderBy("name")).snapshotChanges().pipe(k(this.stopSubscription$),P(a=>a.map(l=>{let c=l.payload.doc.id,u=l.payload.doc.data();return R({id:c},u)})),Y(a=>(this.customersList=a,this.checkOptionsOne=a.map(l=>({value:l.id,label:l.name})),a))).subscribe()}ngOnInit(){}onFirstDataRendered(n){setTimeout(function(){},0)}ngOnDestroy(){this.stopSubscription$&&(this.stopSubscription$.next(void 0),this.stopSubscription$.complete()),this.productsSubscription&&this.productsSubscription.unsubscribe(),this.accountsSubscription&&this.accountsSubscription.unsubscribe()}getSubscriptionsByRoute(n,a){this.usersService.getBoardingPassesByRoutebyCustomerId(n,a).pipe(k(this.stopSubscription$)).subscribe(l=>{this.rowData=l})}getSubscriptionsByTurn(n,a){this.usersService.getBoardingPassesByTurn(n,a).pipe(k(this.stopSubscription$)).subscribe(l=>{this.rowDataPayTurn=l,console.log(this.rowDataPayTurn),this.TotalUsers=this.sumAllPasses(this.rowDataPayTurn)})}sumAllPasses(n){let a=0;return n.forEach(l=>{if(l&&Array.isArray(l.passes)){let c=l.passes.length;a+=l.passes.length}}),a}sumAllCV(n){let a=0;return n.forEach(l=>{l&&Array.isArray(l.passes)&&l.passes.forEach(c=>{this.amountCV=c.amountPayment,this.priceCV=c.amount;let u=this.priceCV-this.amountCV;a+=u})}),a}sumAllCVByR(n){let a=0;return n.forEach(l=>{l&&Array.isArray(l.passes)&&l.passes.forEach(c=>{this.amountCV=c.amountPayment,this.priceCV=c.amount;let u=this.priceCV-this.amountCV;a+=u})}),a}getSubscriptions(n){this.usersService.getBoardingPassesByProduct(n).pipe(k(this.stopSubscription$)).subscribe(a=>{this.rowDataPay=a})}getSubscriptionsPase(n){this.usersService.getBoardingPassesByProduct(n).pipe(k(this.stopSubscription$)).subscribe(a=>{this.createNestedTableData(a)})}getSubscriptionsAnticipos(n){this.usersService.getBoardingPassesByAnticipos(n).pipe(k(this.stopSubscription$)).subscribe(a=>{this.createNestedTableDataA(a)})}getSubscriptionsCV(n){this.usersService.getBoardingPassesByCV(n).pipe(k(this.stopSubscription$)).subscribe(a=>{this.rowDataPayCV=a,this.TotalMPP=this.sumAllCV(this.rowDataPayCV),this.createNestedTableDataCV(a)})}getSubscriptionsCVByRoute(n){this.usersService.getBoardingPassBySingleRoute(n,this.routeIdSelected).pipe(k(this.stopSubscription$)).subscribe(a=>{console.log(a),this.rowDataPayCVByR=a,this.TotalMPByRoute=this.sumAllCVByR(this.rowDataPayCVByR),this.createNestedTableDataCVByRoute(a)})}createNestedTableDataA(n){this.usersListA=[];for(let a=0;a<n.length;++a){n[a].key=a,n[a].expand=!1,n[a].routeName=n[a].passes[0].routeName;for(let l=0;l<n[a].passes.length;++l)n[a].passes[l].key=a,n[a].passes[l].customerName=n[a].customerName,this.usersListA.push(n[a].passes[l])}}createNestedTableDataCV(n){this.usersListCV=[];for(let a=0;a<n.length;++a){n[a].key=a,n[a].expand=!1,n[a].routeName=n[a].passes[0].routeName;for(let l=0;l<n[a].passes.length;++l)n[a].passes[l].key=a,n[a].passes[l].customerName=n[a].customerName,this.usersListCV.push(n[a].passes[l])}}createNestedTableDataCVByRoute(n){this.usersListCVByR=[];for(let a=0;a<n.length;++a){n[a].key=a,n[a].expand=!1,n[a].routeName=n[a].passes[0].routeName;for(let l=0;l<n[a].passes.length;++l)n[a].passes[l].key=a,n[a].passes[l].customerName=n[a].customerName,this.usersListCVByR.push(n[a].passes[l])}if(this.usersListCVByR.length>0){this.usersListCVByRDetalle=[],console.log(this.usersListCVByR);for(let a of this.usersListCVByR)this.usersService.getUserInfo(a.uid).subscribe(l=>{let c={displayName:l.payload.data().displayName,studentId:l.payload.data().studentId,phone:l.payload.data().phone,email:l.payload.data().email,amountPayment:a.amountPayment,amount:a.amount,promiseDate:a.promiseDate};this.usersListCVByRDetalle.some(_=>_.studentId===l.payload.data().studentId)||this.usersListCVByRDetalle.push(c)})}}createNestedTableData(n){this.routesList=[],this.usersList=[];for(let a=0;a<n.length;++a){n[a].key=a,n[a].expand=!1,n[a].routeName=n[a].passes[0].routeName;for(let l=0;l<n[a].passes.length;++l)n[a].passes[l].key=a,n[a].passes[l].customerName=n[a].customerName,this.usersList.push(n[a].passes[l])}this.routesList=n}onProductSelect(n){console.log("Selected Product ID s:",n)}onProductSelectByRoute(n){this.routeIdSelected="",this.routes=[],this.routeSubscription=this.usersService.getBoardingPassRoute(n).pipe(k(this.stopSubscription$)).subscribe(a=>{this.routes=a,console.log(this.routes)})}onRouteSelectByRoute(n){this.routeIdSelected=n}submitFormO(){let n=this.validateFormO.controls.customerId.value;this.getSubscriptionsByRoute(this.user.vendorId,n)}submitForm(){if(console.log(this.selectedOption),this.validateForm.valid){console.log("Form Submitted:",this.validateForm.value),this.rowDataPay=[];let n=this.validateForm.controls.id.value;this.getSubscriptions(n)}else console.error("Form is invalid")}submitFormTurn(){this.rowDataPayTurn=[],this.TotalUsers=0;let n=this.validateFormTurn.controls.id.value,a=this.validateFormTurn.controls.turno.value;this.getSubscriptionsByTurn(n,a)}submitFormPase(){this.rowDataPay=[];let n=this.validateFormPase.controls.id.value;this.getSubscriptionsPase(n)}submitFormAnticipos(){this.usersListA=[];let n=this.validateFormAnticipos.controls.id.value;this.getSubscriptionsAnticipos(n)}submitFormCV(){this.usersListCV=[];let n=this.validateFormCV.controls.id.value;this.TotalMPP=0,this.getSubscriptionsCV(n)}submitFormCVByRoute(){let n=this.validateFormCVByRoute.controls.id.value;this.TotalMPByRoute=0,this.getSubscriptionsCVByRoute(n),this.usersListCVByRDetalle=[],this.FusersListCVByRDetalle=[]}onRowClicked(n){this.accountsSubscription=this.usersService.getUserInfo(n.data.uid).subscribe(a=>{this.signupForm.reset(),this.signupForm.controls.customerName.setValue(a.payload.data().customerName),this.signupForm.controls.defaultRound.setValue(a.payload.data().defaultRound),this.signupForm.controls.defaultRouteName.setValue(a.payload.data().defaultRouteName),this.signupForm.controls.displayName.setValue(a.payload.data().displayName),this.signupForm.controls.email.setValue(a.payload.data().email),this.signupForm.controls.firstName.setValue(a.payload.data().firstName),this.signupForm.controls.lastName.setValue(a.payload.data().lastName),this.signupForm.controls.phone.setValue(a.payload.data().phone),this.signupForm.controls.studentId.setValue(a.payload.data().studentId),this.isModalVisible=!0})}onRowClickedCV(n){this.accountsSubscription=this.usersService.getUserInfo(n.data.uid).subscribe(a=>{this.signupFormCV.reset(),this.signupFormCV.controls.customerName.setValue(a.payload.data().customerName),this.signupFormCV.controls.defaultRound.setValue(a.payload.data().defaultRound),this.signupFormCV.controls.defaultRouteName.setValue(a.payload.data().defaultRouteName),this.signupFormCV.controls.displayName.setValue(a.payload.data().displayName),this.signupFormCV.controls.email.setValue(a.payload.data().email),this.signupFormCV.controls.firstName.setValue(a.payload.data().firstName),this.signupFormCV.controls.lastName.setValue(a.payload.data().lastName),this.signupFormCV.controls.phone.setValue(a.payload.data().phone),this.signupFormCV.controls.studentId.setValue(a.payload.data().studentId),this.isModalVisibleCV=!0})}detalleCVbyR(){this.TotalMPByRoute==0?this.sendMessage("error","Se requiere seleccionar un producto y operaci\xF3n para detallar."):this.FusersListCVByRDetalle=this.usersListCVByRDetalle}sendMessage(n,a){this.msg.create(n,a)}handleOK(){this.isModalVisible=!1,this.isModalVisibleCV=!1}handleCancel(){this.isModalVisible=!1,this.isModalVisibleCV=!1}customCellRenderer(n){return n.data.passes.reduce(c=>c+1,0).toString()}customCellRendererMonto(n){return n.data.passes.reduce((u,_)=>u+_.amount,0).toLocaleString("en-US",{style:"currency",currency:"USD"})}formatPermission(n){return n?"Si":"No"}formatValidTo(n){if(!n)return"";let a=new Date(n.seconds*1e3);return bt(a,"MMMM dd yyyy",{locale:ct})}formatMeteSacaCortesia(n){let a=n.isTaskIn?"Si":"No",l=n.isTaskOut?"Si":"No",c=n.is_courtesy?"Si":"No";return`${a} / ${l} / ${c}`}calculateDaysDifference(n){if(!n)return"";let l=n.toDate(),c=new Date,u=l.getTime()-c.getTime();return Math.floor(u/(1e3*60*60*24))+" d\xEDas"}formatPromiseDate(n){if(!n)return"";let a=new Date(n);return bt(a,"MMMM dd yyyy",{locale:ct})}calculatePendingPayment(n){return(n.amount-n.amountPayment).toLocaleString("en-US",{style:"currency",currency:"USD"})}log(n){console.log(n),this.sub=this.usersServices.getAccountProducts(n).pipe(P(a=>a.map(l=>{let c=l.payload.doc.id,u=l.payload.doc.data();return Oe(R({},u),{id:c})}))).subscribe(a=>{this.products=a,this.products.length===0&&this.sendMessage("error","No hay productos relacionados a este cliente.")})}};m.\u0275fac=function(a){return new(a||m)(O(pe),O(ee),O(he))},m.\u0275cmp=Z({type:m,selectors:[["ng-component"]],decls:291,vars:54,consts:[["basicTable",""],["basicTable1",""],["basicTable2",""],["basicTable3",""],["basicTable4",""],["basicTable5",""],["basicTable6",""],["modalFooter",""],["modalcontent",""],["modalcontentCV",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],["nzTitle","Pagos Por Producto / Servicio"],[2,"margin-bottom","10px"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],["formControlName","customerId","nzPlaceHolder","Selecciona un cliente",2,"width","650px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","id","nzAllowClear","","nzPlaceHolder","Seleccionar producto / servicio",2,"width","650px",3,"ngModelChange"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["ngSkipHydration","",3,"nzData"],[4,"ngFor","ngForOf"],["nzTitle","Pagos por Operaci\xF3n"],["formControlName","customerId","nzPlaceHolder","Selecciona un cliente",2,"width","650px"],["nzTitle","Pagos por turno"],["id","turn"],["nz-form","","nzLayout","horizontal",1,"horizontal-form",3,"ngSubmit","formGroup"],[1,"form-container"],[1,"form-row"],[1,"form-item"],["formControlName","turno","nzAllowClear","","nzPlaceHolder","Turno",2,"width","100px"],["nzTitle","Pases"],["nzTitle","Anticipos"],["nzTitle","Cartera Vencida"],["nzTitle","Cartera General"],["nzTitle","Cartera Vencida por Operaci\xF3n"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Seleccionar la Operaci\xF3n ",2,"width","450px",3,"ngModelChange"],[2,"margin-top","10px","margin-bottom","10 px"],[2,"margin-top","10px"],["nzTitle","Datos Pase - Anticipo","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzTitle","Datos Pase  - Cartera Vencida","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""],["nz-form","",3,"formGroup"],[3,"nzSm","nzXs"]],template:function(a,l){if(a&1){let c=S();t(0,"div",10)(1,"div",11)(2,"nz-page-header",12)(3,"nz-page-header-title",13),r(4,"Reportes"),i(),t(5,"nz-page-header-subtitle"),r(6,"Reportes General "),i()()(),t(7,"div",14)(8,"nz-tabset")(9,"nz-tab",15)(10,"div",16)(11,"form",17),g("ngSubmit",function(){return h(c),f(l.submitForm())}),t(12,"nz-select",18),g("ngModelChange",function(_){return h(c),f(l.log(_))}),v(13,Ha,2,3,"nz-option",19),i(),t(14,"nz-select",20),g("ngModelChange",function(_){return h(c),f(l.onProductSelect(_))}),v(15,Qa,3,4,"nz-option",19),i(),t(16,"button",21),g("click",function(){return h(c),f(l.submitForm())}),r(17,"Aceptar"),i()()(),t(18,"div")(19,"nz-table",22,0)(21,"thead")(22,"tr")(23,"th"),r(24,"Empresa"),i(),t(25,"th"),r(26,"Operaci\xF3n"),i(),t(27,"th"),r(28,"Usuarios"),i(),t(29,"th"),r(30,"Monto"),i(),t(31,"th"),r(32,"Activa"),i()()(),t(33,"tbody"),v(34,Ja,11,13,"tr",23),i()()()(),t(35,"nz-tab",24)(36,"div",16)(37,"form",17),g("ngSubmit",function(){return h(c),f(l.submitFormO())}),t(38,"nz-select",25),v(39,Ka,2,3,"nz-option",19),i(),t(40,"button",21),g("click",function(){return h(c),f(l.submitFormO())}),r(41,"Aceptar"),i()()(),t(42,"div")(43,"nz-table",22,1)(45,"thead")(46,"tr")(47,"th"),r(48,"Empresa"),i(),t(49,"th"),r(50,"Operaci\xF3n"),i(),t(51,"th"),r(52,"Usuarios"),i(),t(53,"th"),r(54,"Monto"),i(),t(55,"th"),r(56,"Activa"),i()()(),t(57,"tbody"),v(58,Ya,11,13,"tr",23),i()()()(),t(59,"nz-tab",26)(60,"div",27)(61,"div",16)(62,"form",28),g("ngSubmit",function(){return h(c),f(l.submitFormTurn())}),t(63,"div",29)(64,"div",30)(65,"div",31)(66,"nz-select",18),g("ngModelChange",function(_){return h(c),f(l.log(_))}),v(67,Za,2,3,"nz-option",19),i()()(),t(68,"div",30)(69,"div",31)(70,"nz-select",20),g("ngModelChange",function(_){return h(c),f(l.onProductSelect(_))}),v(71,er,4,4,"div",23),i()(),t(72,"div",31)(73,"nz-select",32),v(74,tr,4,3,"div",23),i()(),t(75,"div",31)(76,"button",21),g("click",function(){return h(c),f(l.submitFormTurn())}),r(77,"Aceptar"),i()()()()(),t(78,"div",30),r(79),i()(),t(80,"div")(81,"nz-table",22,2)(83,"thead")(84,"tr")(85,"th"),r(86,"Empresa"),i(),t(87,"th"),r(88,"Operaci\xF3n"),i(),t(89,"th"),r(90,"Usuarios"),i(),t(91,"th"),r(92,"Monto"),i(),t(93,"th"),r(94,"Activa"),i()()(),t(95,"tbody"),v(96,ir,11,13,"tr",23),i()()()()(),t(97,"nz-tab",33)(98,"div",16)(99,"form",17),g("ngSubmit",function(){return h(c),f(l.submitFormPase())}),t(100,"nz-select",18),g("ngModelChange",function(_){return h(c),f(l.log(_))}),v(101,nr,2,3,"nz-option",19),i(),t(102,"nz-select",20),g("ngModelChange",function(_){return h(c),f(l.onProductSelect(_))}),v(103,ar,4,4,"div",23),i(),t(104,"button",21),g("click",function(){return h(c),f(l.submitForm())}),r(105,"Aceptar"),i()()(),t(106,"div")(107,"nz-table",22,3)(109,"thead")(110,"tr")(111,"th"),r(112,"Empresa"),i(),t(113,"th"),r(114,"Operaci\xF3n"),i(),t(115,"th"),r(116,"Turno"),i(),t(117,"th"),r(118,"Estaci\xF3n"),i(),t(119,"th"),r(120,"Pase"),i(),t(121,"th"),r(122,"Mete"),i(),t(123,"th"),r(124,"Saca"),i(),t(125,"th"),r(126,"Pase Cortes\xEDa"),i(),t(127,"th"),r(128,"V\xE1lido desde"),i(),t(129,"th"),r(130,"V\xE1lido hasta"),i()()(),t(131,"tbody"),v(132,rr,21,10,"tr",23),i()()()(),t(133,"nz-tab",34)(134,"div",16)(135,"form",17),g("ngSubmit",function(){return h(c),f(l.submitFormAnticipos())}),t(136,"nz-select",18),g("ngModelChange",function(_){return h(c),f(l.log(_))}),v(137,or,2,3,"nz-option",19),i(),t(138,"nz-select",20),g("ngModelChange",function(_){return h(c),f(l.onProductSelect(_))}),v(139,lr,4,4,"div",23),i(),t(140,"button",21),g("click",function(){return h(c),f(l.submitFormAnticipos())}),r(141,"Aceptar"),i()()(),t(142,"div")(143,"nz-table",22,3)(145,"thead")(146,"tr")(147,"th"),r(148,"Empresa"),i(),t(149,"th"),r(150,"Operaci\xF3n"),i(),t(151,"th"),r(152,"Turno"),i(),t(153,"th"),r(154,"Monto Anticipo"),i(),t(155,"th"),r(156,"Promesa de Pago"),i(),t(157,"th"),r(158,"D\xEDas vencidos"),i(),t(159,"th"),r(160,"Pase"),i(),t(161,"th"),r(162,"Mete / Saca / Cortes\xEDa"),i(),t(163,"th"),r(164,"V\xE1lido desde"),i(),t(165,"th"),r(166,"V\xE1lido hasta"),i()()(),t(167,"tbody"),v(168,sr,21,10,"tr",23),i()()()(),t(169,"nz-tab",35)(170,"nz-tabset")(171,"nz-tab",36)(172,"div",16)(173,"form",17),g("ngSubmit",function(){return h(c),f(l.submitFormCV())}),t(174,"nz-select",18),g("ngModelChange",function(_){return h(c),f(l.log(_))}),v(175,dr,2,3,"nz-option",19),i(),t(176,"nz-select",20),g("ngModelChange",function(_){return h(c),f(l.onProductSelect(_))}),v(177,cr,4,4,"div",23),i(),t(178,"button",21),g("click",function(){return h(c),f(l.submitFormCV())}),r(179,"Aceptar"),i()(),t(180,"div",30),r(181),M(182,"currency"),i()(),t(183,"div")(184,"nz-table",22,4)(186,"thead")(187,"tr")(188,"th"),r(189,"Empresa"),i(),t(190,"th"),r(191,"Operaci\xF3n"),i(),t(192,"th"),r(193,"Turno"),i(),t(194,"th"),r(195,"Monto Anticipo"),i(),t(196,"th"),r(197,"Pendiente de Pago"),i(),t(198,"th"),r(199,"Promesa de Pago"),i(),t(200,"th"),r(201,"D\xEDas vencidos"),i(),t(202,"th"),r(203,"Pase"),i(),t(204,"th"),r(205,"Mete / Saca / Cortes\xEDa"),i(),t(206,"th"),r(207,"V\xE1lido desde"),i(),t(208,"th"),r(209,"V\xE1lido hasta"),i()()(),t(210,"tbody"),v(211,mr,23,11,"tr",23),i()()()(),t(212,"nz-tab",37)(213,"div",16)(214,"form",17),g("ngSubmit",function(){return h(c),f(l.submitFormCVByRoute())}),t(215,"nz-select",18),g("ngModelChange",function(_){return h(c),f(l.log(_))}),v(216,ur,2,3,"nz-option",19),i(),t(217,"nz-select",20),g("ngModelChange",function(_){return h(c),f(l.onProductSelectByRoute(_))}),v(218,pr,4,4,"div",23),i(),t(219,"nz-select",38),g("ngModelChange",function(_){return h(c),f(l.onRouteSelectByRoute(_))}),v(220,hr,4,3,"div",23),i(),t(221,"button",21),g("click",function(){return h(c),f(l.submitFormCVByRoute())}),r(222,"Aceptar"),i()(),t(223,"div",30),r(224),M(225,"currency"),i()(),t(226,"div")(227,"nz-table",22,5)(229,"thead")(230,"tr")(231,"th"),r(232,"Empresa"),i(),t(233,"th"),r(234,"Operaci\xF3n"),i(),t(235,"th"),r(236,"Turno"),i(),t(237,"th"),r(238,"Monto Anticipo"),i(),t(239,"th"),r(240,"Pendiente de Pago"),i(),t(241,"th"),r(242,"Promesa de Pago"),i(),t(243,"th"),r(244,"D\xEDas vencidos"),i(),t(245,"th"),r(246,"Pase"),i(),t(247,"th"),r(248,"Mete / Saca / Cortes\xEDa"),i(),t(249,"th"),r(250,"V\xE1lido desde"),i(),t(251,"th"),r(252,"V\xE1lido hasta"),i()()(),t(253,"tbody"),v(254,fr,23,11,"tr",23),i()()(),t(255,"div",39)(256,"button",21),g("click",function(){return h(c),f(l.detalleCVbyR())}),r(257,"Mostrar Detalle"),i()(),t(258,"div",40)(259,"nz-table",22,6)(261,"thead")(262,"tr")(263,"th"),r(264,"Nombre"),i(),t(265,"th"),r(266,"Identificaci\xF3n"),i(),t(267,"th"),r(268,"Telefono"),i(),t(269,"th"),r(270,"Correo"),i(),t(271,"th"),r(272,"Monto Anticipo"),i(),t(273,"th"),r(274,"Pendiente de Pago"),i(),t(275,"th"),r(276,"Promesa de Pago"),i(),t(277,"th"),r(278,"D\xEDas vencidos"),i()()(),t(279,"tbody"),v(280,_r,23,11,"tr",23),i()()()()()()()()(),t(281,"nz-modal",41),F("nzVisibleChange",function(_){return h(c),T(l.isModalVisible,_)||(l.isModalVisible=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancel())}),v(282,gr,2,0,"ng-template",null,7,V),i(),v(284,zr,47,46,"ng-template",null,8,V),t(286,"nz-modal",42),F("nzVisibleChange",function(_){return h(c),T(l.isModalVisibleCV,_)||(l.isModalVisibleCV=_),f(_)}),g("nzOnCancel",function(){return h(c),f(l.handleCancel())}),v(287,vr,47,46,"ng-template",null,9,V)(289,Cr,2,0,"ng-template",null,7,V),i()}if(a&2){let c=y(20),u=y(44),_=y(82),x=y(108),E=y(185),N=y(228),U=y(260),B=y(283),j=y(285),W=y(288);o(2),d("nzGhost",!1),o(9),d("formGroup",l.validateForm),o(2),d("ngForOf",l.customersList),o(2),d("ngForOf",l.products),o(4),d("nzData",l.rowDataPay),o(15),d("ngForOf",c.data),o(3),d("formGroup",l.validateFormO),o(2),d("ngForOf",l.customersList),o(4),d("nzData",l.rowData),o(15),d("ngForOf",u.data),o(4),d("formGroup",l.validateFormTurn),o(5),d("ngForOf",l.customersList),o(4),d("ngForOf",l.products),o(3),d("ngForOf",l.shift),o(5),b(" Usuarios totales: ",l.TotalUsers," "),o(2),d("nzData",l.rowDataPayTurn),o(15),d("ngForOf",_.data),o(3),d("formGroup",l.validateFormPase),o(2),d("ngForOf",l.customersList),o(2),d("ngForOf",l.products),o(4),d("nzData",l.usersList),o(25),d("ngForOf",x.data),o(3),d("formGroup",l.validateFormAnticipos),o(2),d("ngForOf",l.customersList),o(2),d("ngForOf",l.products),o(4),d("nzData",l.usersList),o(25),d("ngForOf",x.data),o(5),d("formGroup",l.validateFormCV),o(2),d("ngForOf",l.customersList),o(2),d("ngForOf",l.products),o(4),b(" Total monto pendiente pago: ",q(182,48,l.TotalMPP,"USD")," "),o(3),d("nzData",l.usersListCV),o(27),d("ngForOf",E.data),o(3),d("formGroup",l.validateFormCVByRoute),o(2),d("ngForOf",l.customersList),o(2),d("ngForOf",l.products),o(2),d("ngForOf",l.routes),o(4),b(" Total monto pendiente pago: ",q(225,51,l.TotalMPByRoute,"USD")," "),o(3),d("nzData",l.usersListCVByR),o(27),d("ngForOf",N.data),o(5),d("nzData",l.FusersListCVByRDetalle),o(21),d("ngForOf",U.data),o(),w("nzVisible",l.isModalVisible),d("nzContent",j)("nzFooter",B),o(5),w("nzVisible",l.isModalVisibleCV),d("nzContent",W)("nzFooter",B)}},dependencies:[le,fe,ze,ge,Ce,ve,be,je,at,tt,it,ot,nt,rt,De,ye,xe,Se,Pe,Ee,Ve,we,Te,ce,se,de,me,ue,Ze,Ye,$e],styles:[".footer[_ngcontent-%COMP%]{height:100%!important;position:absolute;padding:0 25px;display:flex;justify-content:space-between}.body[_ngcontent-%COMP%]{overflow-y:auto;padding:15px 25px;position:relative;width:100%}.horizontal-form[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.form-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.form-item[_ngcontent-%COMP%]{margin-right:10px}"]});let s=m;return s})();var Mo=(()=>{let m=class m{};m.\u0275fac=function(a){return new(a||m)},m.\u0275cmp=Z({type:m,selectors:[["ng-component"]],decls:0,vars:0,template:function(a,l){},encapsulation:2});let s=m;return s})();export{ao as a,fo as b,Io as c,Mo as d};
