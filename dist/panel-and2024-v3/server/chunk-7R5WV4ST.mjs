import './polyfills.server.mjs';
import{a as Lt,b as Pe,c as kt}from"./chunk-TARYIRPL.mjs";import{a as De}from"./chunk-IKP4FAXK.mjs";import{a as et,b as Ot}from"./chunk-KHADD2LA.mjs";import{a as Ze,h as Nt}from"./chunk-ZUCQC5O6.mjs";import{a as Pt}from"./chunk-TB4X4XFH.mjs";import{A as se,C as le,D as de,E as me,F as ce,H as Mt,a as Te,c as ee,d as te,k as ie,n as Se,o as Ce,x as oe,z as Dt}from"./chunk-HJULLPBY.mjs";import{P as Xe,Q as Ye,R as Qe,S as Fe,_ as ge,b as $,c as b,d as q,da as Ve,e as H,ea as ft,fa as ve,h as We,i as Ge,j as yt,ja as we,k as W,m as G,pa as ne,q as J,qa as re,sa as ae,t as Je,ta as Ke,u as Ie}from"./chunk-AJSA5OVW.mjs";import{d as Et}from"./chunk-MD57JE7O.mjs";import{a as It,c as Ft,f as Z,g as Vt,h as wt,j as Tt}from"./chunk-6LQQHYT7.mjs";import{Lb as ht,Va as Y,Vb as K,Wb as _e,Ya as Q,Yb as ze,ab as ut,la as Ee,p as X}from"./chunk-HW47JO5W.mjs";import{Ab as be,Eb as $e,Fb as qe,G as he,Gb as He,Hb as E,Ia as R,Ib as o,Ja as s,Jb as I,Ka as O,Kb as h,Kc as B,Lb as fe,Lc as j,Mb as ye,Mc as bt,Nb as P,Ob as N,Pb as M,Pc as Re,Sb as Oe,V as w,X as k,Xb as Le,Ya as z,Zb as ke,_a as m,ac as L,d as A,da as y,ha as U,mb as n,nb as i,ob as S,pa as f,pb as Ct,q as v,qa as g,qb as xt,sb as V,vb as _,xb as u}from"./chunk-OPSN3ZKU.mjs";import{a as C,b as ue,h as ct,j as pt}from"./chunk-H6KHSOBK.mjs";var tt=ct(ft());var Xt=["searchBar"],Yt=["searchBarE"],Qt=["searchBarC"];function Kt(l,p){if(l&1){let e=V();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td")(10,"a",36),_("click",function(){let t=f(e).$implicit,r=u();return g(r.showModalIn(t))}),o(11,"Editar"),i()()()}if(l&2){let e=p.$implicit,a=u();s(2),I(e.customerName),s(2),fe("",e.firstName," ",e.lastName,""),s(2),I(e.email),s(2),I(e.status),s(2),m("nzSize",a.size)}}function Zt(l,p){if(l&1){let e=V();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td")(10,"a",36),_("click",function(){let t=f(e).$implicit,r=u();return g(r.showModalInE(t))}),o(11,"Editar"),i()()()}if(l&2){let e=p.$implicit,a=u();s(2),I(e.customerName),s(2),fe("",e.firstName," ",e.lastName,""),s(2),I(e.vendorName),s(2),I(e.status),s(2),m("nzSize",a.size)}}function ei(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit;m("nzColor","red"),s(),h("",e.status," ")}}function ti(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit;m("nzColor","green"),s(),h("",e.status," ")}}function ii(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit;m("nzColor","blue"),s(),h("",e.status," ")}}function ni(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit;m("nzColor","gray"),s(),h("",e.status," ")}}function ri(l,p){if(l&1){let e=V();n(0,"li",42),_("click",function(){f(e);let t=u().$implicit,r=u();return g(r.generarPase(t.userId,t.uid))}),o(1,"Generar Pase"),i()}}function ai(l,p){if(l&1){let e=V();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),z(10,ei,2,2,"nz-tag",37)(11,ti,2,2,"nz-tag",37)(12,ii,2,2,"nz-tag",37)(13,ni,2,2,"nz-tag",37),i(),n(14,"td")(15,"a",38),o(16,"Ver Comprobante"),i()(),n(17,"td")(18,"a",39),S(19,"i",40),i(),n(20,"nz-dropdown-menu",null,15)(22,"ul",41)(23,"li",42),_("click",function(){let t=f(e).$implicit,r=u();return g(r.openModal(t.userId,t.customerName,t.stopInfo.routeName,t.stopInfo.round))}),o(24,"Ver Usuario"),i(),n(25,"li",42),_("click",function(){let t=f(e).$implicit,r=u();return g(r.validarPago(t.uid,t.userId))}),o(26,"Validar Pago"),i(),n(27,"li",42),_("click",function(){let t=f(e).$implicit,r=u();return g(r.rechazarPago(t.uid,t.userId))}),o(28,"Rechazar Pago"),i(),z(29,ri,2,0,"li",43),i()()()()}if(l&2){let e=p.$implicit,a=E(21),t=u();s(2),I(e.date),s(2),I(e.customerName),s(2),I(e.product.description),s(2),I(e.product.price),s(2),m("ngIf",e.status==="rejected"),s(),m("ngIf",e.status==="complete"),s(),m("ngIf",e.status==="accepted"),s(),m("ngIf",e.status==="pending"),s(2),be("href",e.url,R),s(3),m("nzDropdownMenu",a),s(11),m("ngIf",t.readytoGenerateBoardinPass)}}function oi(l,p){l&1&&o(0,` Nuevo pase
`)}function si(l,p){if(l&1&&S(0,"nz-option",77),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function li(l,p){if(l&1&&(Ct(0),o(1),xt()),l&2){let e=u().$implicit;s(),h("(",e.frequencies,")")}}function di(l,p){if(l&1&&(n(0,"div")(1,"nz-option",78),S(2,"i",79),o(3),z(4,li,2,1,"ng-container",80),o(5),i()()),l&2){let e=p.$implicit;s(),m("nzLabel",e.name)("nzValue",e.id),s(2),h(" ",e.name," "),s(),m("ngIf",e.frequencies),s(),h(" $",e.price," ")}}function mi(l,p){if(l&1&&(n(0,"nz-option",78),S(1,"i",79),o(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.routeId),s(2),h(" ",e.name,"")}}function ci(l,p){if(l&1&&(n(0,"nz-option",78),S(1,"i",79),o(2),S(3,"br"),o(4),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.stopPointId),s(2),h(" ",e.name," "),s(2),h(" ",e.description," ")}}function pi(l,p){l&1&&(n(0,"div",66)(1,"nz-form-item")(2,"nz-form-label"),o(3,"Fecha Compromiso "),i(),S(4,"nz-date-picker",81),i()())}function ui(l,p){if(l&1){let e=V();n(0,"form",45),_("ngSubmit",function(){f(e);let t=u();return g(t.submitForm())}),n(1,"nz-form-item")(2,"nz-form-label",46),o(3,"Empresa"),i(),n(4,"nz-select",47),_("ngModelChange",function(t){f(e);let r=u();return g(r.onCustomerSelected(t))}),z(5,si,1,2,"nz-option",48),i()(),n(6,"nz-form-item")(7,"nz-form-label",46),o(8,"Servicio"),i(),n(9,"nz-select",49),_("ngModelChange",function(t){f(e);let r=u();return g(r.onProductSelected(t,r.products))}),z(10,di,6,5,"div",29),i()(),n(11,"nz-form-item")(12,"nz-form-label",46),o(13,"Operaci\xF3n"),i(),n(14,"nz-select",50),_("ngModelChange",function(t){f(e);let r=u();return g(r.onRouteSelected(t,r.routes))}),z(15,mi,3,3,"nz-option",51),i()(),n(16,"nz-form-item")(17,"nz-form-label",46),o(18,"Estaciones"),i(),n(19,"nz-select",52),z(20,ci,5,4,"nz-option",51),i()(),n(21,"nz-form-item")(22,"nz-form-label",46),o(23,"Turno"),i(),n(24,"nz-select",53),S(25,"nz-option",54)(26,"nz-option",55)(27,"nz-option",56),i()(),n(28,"nz-form-item")(29,"nz-form-label",46),o(30,"Tipo de Pago"),i(),n(31,"nz-select",57),_("ngModelChange",function(t){f(e);let r=u();return g(r.changePayment(t))}),S(32,"nz-option",58)(33,"nz-option",59)(34,"nz-option",60),i()(),n(35,"nz-form-item")(36,"div",61)(37,"div",62)(38,"nz-form-label"),o(39,"Cantidad a pagar "),i(),n(40,"nz-input-number",63),_("ngModelChange",function(t){f(e);let r=u();return g(r.onAmountChange(t))}),i()(),z(41,pi,5,0,"div",64),i()(),n(42,"div",61)(43,"div",62)(44,"nz-form-item")(45,"nz-form-label"),o(46,"Total a pagar"),i(),n(47,"nz-input-number",65),_("ngModelChange",function(t){f(e);let r=u();return g(r.onAmountChange(t))}),i()()(),n(48,"div",66)(49,"nz-form-item")(50,"nz-form-label"),o(51,"\xBFEs cortes\xEDa?"),i(),n(52,"nz-switch",67),_("ngModelChange",function(t){f(e);let r=u();return g(r.onCourtesyChange(t))}),i()()()(),n(53,"nz-form-item")(54,"nz-form-label",68),o(55,"Tipo de Referencia"),i(),n(56,"nz-select",69),S(57,"nz-option",70)(58,"nz-option",71)(59,"nz-option",72),i()(),n(60,"nz-form-item")(61,"nz-form-control")(62,"label",73),o(63,"Activar pase"),i()()(),n(64,"div",61)(65,"div",74)(66,"nz-form-item")(67,"nz-form-label"),o(68,"V\xE1lido desde"),i(),S(69,"nz-date-picker",75),i()(),n(70,"div",74)(71,"nz-form-item")(72,"nz-form-label"),o(73,"V\xE1lido hasta"),i(),n(74,"nz-date-picker",76),_("ngModelChange",function(t){f(e);let r=u();return g(r.onChangeValidTo(t))}),i()()()()()}if(l&2){let e=u();m("formGroup",e.validateForm),s(5),m("ngForOf",e.customers),s(5),m("ngForOf",e.products),s(5),m("ngForOf",e.routes),s(5),m("ngForOf",e.stopPoints),s(20),m("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar),s(),m("ngIf",e.isAnticipo),s(6),m("disabled",!1)("nzMin",50)("nzMax",5e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar),s(27),m("nzDisabledDate",e.disabledDate)}}function hi(l,p){if(l&1){let e=V();n(0,"button",82),_("click",function(){f(e);let t=u();return g(t.handleCancel())}),o(1,"Cancelar"),i(),n(2,"button",83),_("click",function(){f(e);let t=u();return g(t.submitForm())}),o(3,"Generar Pase"),i()}if(l&2){let e=u();s(2),m("nzLoading",e.isConfirmLoading)}}function fi(l,p){if(l&1&&(n(0,"div")(1,"form",84)(2,"nz-row",85)(3,"nz-col",86)(4,"nz-form-label",87),o(5,"Cliente"),i()(),n(6,"nz-col",88)(7,"nz-form-control"),S(8,"input",89),i()()(),n(9,"nz-row",85)(10,"nz-col",86)(11,"nz-form-label",90),o(12,"Operaci\xF3n"),i()(),n(13,"nz-col",88)(14,"nz-form-control"),S(15,"input",91),i()()(),n(16,"nz-row",85)(17,"nz-col",86)(18,"nz-form-label",92),o(19,"Nombre"),i()(),n(20,"nz-col",88)(21,"nz-form-control"),S(22,"input",93),i()()(),n(23,"nz-row",85)(24,"nz-col",86)(25,"nz-form-label",94),o(26,"Horario"),i()(),n(27,"nz-col",88)(28,"nz-form-control"),S(29,"input",95),i()()(),n(30,"nz-row",85)(31,"nz-col",86)(32,"nz-form-label",96),o(33,"Tel\xE9fono"),i()(),n(34,"nz-col",88)(35,"nz-form-control"),S(36,"input",97),i()()(),n(37,"nz-row",85)(38,"nz-col",86)(39,"nz-form-label",98),o(40,"Correo"),i()(),n(41,"nz-col",88)(42,"nz-form-control"),S(43,"input",99),i()()(),n(44,"nz-row",85)(45,"nz-col",86)(46,"nz-form-label",100),o(47,"Identificaci\xF3n"),i()(),n(48,"nz-col",88)(49,"nz-form-control"),S(50,"input",101),i()()()()()),l&2){let e=u();s(),m("formGroup",e.viewDetalle),s(),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16),s(7),m("nzGutter",16)}}function gi(l,p){if(l&1){let e=V();n(0,"button",102),_("click",function(){f(e);let t=u();return g(t.handleCancelView())}),o(1,"Aceptar"),i()}}function _i(l,p){if(l&1&&(n(0,"div")(1,"form",84)(2,"nz-form-item")(3,"nz-form-label",103),o(4,"Estatus"),i(),n(5,"nz-form-control",104)(6,"nz-select",105),S(7,"nz-option",106),i()()()()()),l&2){let e=u();s(),m("formGroup",e.signupForm),s(2),m("nzSm",8)("nzXs",24),s(2),m("nzSm",16)("nzXs",24)}}function zi(l,p){if(l&1){let e=V();n(0,"button",102),_("click",function(){f(e);let t=u();return g(t.handleOKEdit())}),o(1,"Aceptar"),i(),n(2,"button",102),_("click",function(){f(e);let t=u();return g(t.handleCancelEdit())}),o(3,"Cancelar"),i()}}function vi(l,p){if(l&1&&S(0,"nz-option",114),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id)}}function Si(l,p){if(l&1&&(n(0,"div")(1,"form",84)(2,"nz-form-item")(3,"nz-form-label",107),o(4,"Empresa "),i(),n(5,"nz-select",108),z(6,vi,1,2,"nz-option",109),i()(),n(7,"nz-form-item")(8,"nz-form-label",110),o(9,"Estatus"),i(),n(10,"nz-select",111),S(11,"nz-option",112)(12,"nz-option",113),i()()()()),l&2){let e=u();s(),m("formGroup",e.signupFormE),s(2),m("nzSpan",4),s(2),m("nzMaxTagCount",3),s(),m("ngForOf",e.listOfCustomer),s(2),m("nzSm",4),s(2),m("nzMaxTagCount",3)}}function Ci(l,p){if(l&1){let e=V();n(0,"button",102),_("click",function(){f(e);let t=u();return g(t.handleOKEditE())}),o(1,"Aceptar"),i(),n(2,"button",102),_("click",function(){f(e);let t=u();return g(t.handleCancelEditE())}),o(3,"Cancelar"),i()}}var Xn=(()=>{class l{constructor(e,a,t){this.fb=e,this.messageService=a,this.afs=t,this.dataUsuariosList=[],this.dataEjecutoresList=[],this.dataTransferList=[],this.isEditModal=!1,this.isEditModalE=!1,this.isViewInfo=!1,this.isVisible1=!1,this.dashboardService=y(De),this.authService=y(Q),this.usersService=y(ve),this.accountsService=y(Z),this.customersService=y(Ve),this.productsService=y(et),this.routesService=y(ae),this.stopSubscription$=new A,this.size="large",this.readytoGenerateBoardinPass=!1,this.currentUserSelected=[],this.products=[],this.stopPoints=[],this.paymentSelected="",this.productSelected=[],this.isConfirmLoading=!1,this.disabledDate=r=>!1,this.formatterPercent=r=>`${r} %`,this.parserPercent=r=>r.replace(" %",""),this.formatterDollar=r=>`$ ${r}`,this.parserDollar=r=>r.replace("$ ",""),this.isAnticipo=!1,this.isValidDescriptionPaymentType=!1,this.currentLine="",this.stopIdValue=""}ngOnInit(){this.authService.user.subscribe(a=>{a&&(this.user=a,this.user!==null&&this.user!==void 0&&this.user.idSegment!==void 0&&this.accountsService.getSegmentLevel(this.user.idSegment).pipe(w(this.stopSubscription$),v(t=>{let r=t.payload.id,d=t.payload.data();return C({id:r},d)}),k(t=>(this.infoSegment=t,t))).subscribe())}),this.signupForm=this.fb.group({status:[""],id:[""]}),this.signupFormE=this.fb.group({status:[""],id:[""],customerId:[""],customerName:[""]}),this.viewDetalle=this.fb.group({status:[""],id:[""],name:[""],customerId:[""],customerName:[""],email:[""],phoneNumber:[""],studentId:[""],defaultRouteName:[""],defaultRound:[""]}),this.validateForm=this.fb.group({active:[!0,[b.required]],amount:[0,[b.required]],authorization:[""],category:["",[b.required]],conciliated:[!1,[b.required]],creation_date:[new Date().toISOString(),[b.required]],currency:["MXN",[b.required]],customer_id:["",[b.required]],customerId:[""],date_created:[new Date,[b.required]],due_date:[new Date,[b.required]],description:["",[b.required]],error_message:[""],fee:this.fb.group({amount:[0],currency:["MXN"],tax:[0]}),is_courtesy:[!1],method:["cash",[b.required]],name:["",[b.required]],operation_date:[new Date().toISOString(),[b.required]],operation_type:["in",[b.required]],order_id:[""],payment_method:this.fb.group({barcode_url:[""],reference:[""],type:["cash"]}),price:[0,[b.required]],product_description:["",[b.required]],product_id:["",[b.required]],round:["",[b.required]],routeId:["",[b.required]],routeName:["",[b.required]],status:["completed",[b.required]],stopDescription:["",[b.required]],stopId:["",[b.required]],stopName:["",[b.required]],transaction_type:["charge",[b.required]],validFrom:[new Date,[b.required]],validTo:[new Date,[b.required]],isTaskIn:[!1,[b.required]],isTaskOut:[!1,[b.required]],isOpenpay:[!1,[b.required]],paidApp:["web",[b.required]],realValidTo:[],payment:["",[b.required]],amountPayment:[0,[b.required]],typePayment:[""],promiseDate:[new Date],baja:[""],fileURL:[""],frequencies:[""]});let e=new Date;this.validateForm.controls.promiseDate.setValue(e),this.validateForm.controls.validTo.setValue(""),this.validateForm.controls.validFrom.setValue(e),this.validateForm.get("stopId").valueChanges.subscribe(a=>{this.onStopPointSelected(a,this.stopPoints)})}fillData(){this.dataUsuariosList.length<=1&&(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.usersService.getPreRegisterInfoByCustomer(this.user.customerId).subscribe(e=>{this.dataUsuarios=e,this.dataUsuariosList=this.dataUsuarios}):this.usersService.getPreRegisterInfo().subscribe(e=>{this.dataUsuarios=e,this.dataUsuariosList=this.dataUsuarios}))}fillDataT(){this.dataTransferList.length<=1&&(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.usersService.getTransferInfoByCustomer(this.user.customerId).subscribe(e=>{this.dataTransfer=e,this.dataTransferList=this.dataTransfer}),this.accountsService.getAccountsByCustomer(this.user.customerId).pipe(w(this.stopSubscription$),v(e=>e.map(a=>{let t=a.payload.doc.id,r=a.payload.doc.data();return C({id:t},r)}))).subscribe(e=>{this.customers=e}),this.routesService.getProducts(this.user.customerId).pipe(w(this.stopSubscription$),v(e=>e.map(a=>{let t=a.payload.doc.id,r=a.payload.doc.data();return C({id:t},r)}))).subscribe(e=>{this.products=e})):this.usersService.getTransferInfo().subscribe(e=>{this.dataTransfer=e,this.dataTransferList=this.dataTransfer,this.cCollection=this.afs.collection("customers",a=>a.where("active","==",!0)),this.customerSubscription=this.cCollection.snapshotChanges().pipe(v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.customers=a})}))}fillDataE(){this.dataEjecutoresList.length<=1&&(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.dataEjecutores=[],this.usersService.getVendorId(this.user.customerId).pipe(w(this.stopSubscription$),v(e=>e.map(a=>{let t=a.payload.doc.id,r=a.payload.doc.data();return ue(C({},r),{id:t})}))).subscribe(e=>{e.forEach(a=>{this.usersService.getPreRegisterInfoEByVendor(a.id).subscribe(t=>{this.dataEjecutores=[...this.dataEjecutores,...t],this.dataEjecutoresList=[...this.dataEjecutores]})})})):this.usersService.getPreRegisterInfoE().subscribe(e=>{this.dataEjecutores=e,this.dataEjecutoresList=this.dataEjecutores})),this.infoSegment.nivelNum==1?this.accountsService.getAccountsByCustomer(this.user.customerId).pipe(w(this.stopSubscription$),v(e=>{let a=e.payload.id,t=e.payload.data();return C({id:a},t)})).subscribe(e=>{this.listOfCustomer=[e]}):this.accountsService.getAccounts().pipe(w(this.stopSubscription$),v(e=>e.map(a=>{let t=a.payload.doc.id,r=a.payload.doc.data();return C({id:t},r)}))).subscribe(e=>{this.listOfCustomer=e})}ngOnDestroy(){this.stopSubscription$.next(!1),this.stopSubscription$.complete(),this.dataUsuariosList=[],this.dataEjecutoresList=[]}showModalInE(e){this.signupFormE.controls.status.setValue(e.status),this.signupFormE.controls.id.setValue(e.uid),this.isEditModalE=!0}showModalIn(e){this.signupForm.controls.id.setValue(e.uid),this.signupForm.controls.status.setValue(e.status),this.isEditModal=!0}openModal(e,a,t,r){this.isViewInfo=!0,this.usersService.getUserInfo(e).subscribe(d=>{let c=d.payload.data();if(this.currentUserSelected=c,c){let x={id:c.displayName,name:c.displayName,studentId:c.studentId,phoneNumber:c.phoneNumber,email:c.email,customerName:a,customerId:c.customerId,defaultRouteName:t,defaultRound:r};this.viewDetalle.patchValue(C({},x))}})}searchUser(){}handleCancelEdit(){this.isEditModal=!1}handleCancelView(){this.isViewInfo=!1}handleCancelEditE(){this.isEditModalE=!1}handleOKEdit(){this.usersService.updateUserPreRegister(this.signupForm.controls.id.value,this.signupForm.controls.status.value),this.isEditModal=!1}handleOKEditE(){let e=this.signupFormE.value;this.usersService.updateUserPreRegisterE(this.signupFormE.controls.id.value,this.signupFormE.controls.status.value,this.signupFormE.controls.customerId.value,this.signupFormE.controls.customerName.value),this.isEditModalE=!1}handleCancel(){this.isVisible1=!1}handleOk(){this.isConfirmLoading=!0,setTimeout(()=>{this.isVisible1=!1,this.isConfirmLoading=!1},3e3)}initializeItems(){this.dataUsuarios=this.dataUsuariosList,this.dataEjecutores=this.dataEjecutoresList,this.dataTransfer=this.dataTransferList}getItems(e){let a=e;if(!a){this.dataUsuarios=this.dataUsuariosList.slice();return}let t=a.toLowerCase();this.dataUsuarios=this.dataUsuariosList.filter(r=>Object.values(r).some(d=>String(d).toLowerCase().includes(t)))}getItemsE(e){let a=e;if(!a){this.dataEjecutores=this.dataEjecutoresList.slice();return}let t=a.toLowerCase();this.dataEjecutores=this.dataEjecutoresList.filter(r=>Object.values(r).some(d=>String(d).toLowerCase().includes(t)))}getItemsT(e){let a=e;if(!a){this.dataTransfer=this.dataTransferList.slice();return}let t=a.toLowerCase();this.dataTransfer=this.dataTransferList.filter(r=>Object.values(r).some(d=>String(d).toLowerCase().includes(t)))}validarPago(e,a){return pt(this,null,function*(){(yield this.usersService.updateTransfer(e,a,"accepted"))?(this.sendMessage("sucess","Se valido el pago. Ahora puedes generar el pase de abordar."),this.readytoGenerateBoardinPass=!0):this.readytoGenerateBoardinPass=!1})}rechazarPago(e,a){return pt(this,null,function*(){(yield this.usersService.updateTransfer(e,a,"rejected"))?(this.sendMessage("sucess","Se rechazo el pago."),this.readytoGenerateBoardinPass=!1):this.readytoGenerateBoardinPass=!0})}onAmountChange(e){e>0&&this.validateForm.controls.is_courtesy.setValue(!1)}onProductSelected(e,a){this.productSelected=[];let r=tt.default.filter(a,d=>d.id==e)[0];this.productSelected=r,this.validateForm.controls.name.setValue(r.name),this.validateForm.controls.description.setValue(r.description),this.validateForm.controls.product_description.setValue(r.description),this.validateForm.controls.amount.setValue(r.price),this.validateForm.controls.is_courtesy.setValue(!1),this.validateForm.controls.price.setValue(r.price),this.validateForm.controls.category.setValue(r.category),this.validateForm.controls.validFrom.setValue(r.validFrom.toDate()),this.validateForm.controls.validTo.setValue(r.validTo.toDate()),this.validateForm.controls.realValidTo.setValue(r.validTo.toDate().toISOString()),this.validateForm.controls.isTaskIn.setValue(r.isTaskIn),this.validateForm.controls.isTaskOut.setValue(r.isTaskOut),this.validateForm.controls.frequencies.setValue(r.frequencies)}generarPase(e,a){this.usersService.getUserInfo(e).subscribe(t=>{let r=t.payload.data();this.currentUserSelected=r,this.currentLine=a,this.isVisible1=!0})}submitForm(){var e,a=0;let t=this.validateForm.controls.validTo.value||new Date,r=this.validateForm.controls.is_courtesy.value||!1;var d=this.validateForm.controls.promiseDate.value||"",c=this.validateForm.controls.creation_date.value.toString();let x=this.validateForm.controls.typePayment.value;this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId),this.validateForm.controls.customerId.setValue(this.currentUserSelected.customerId);let F=this.validateForm.controls.amount.value,D=this.validateForm.controls.payment.value;D=="Anticipo"&&(F=this.validateForm.controls.amountPayment.value);let T=this.validateForm.controls.frequencies.value||0;T>0&&(a=Number(T)*80);let Ne=this.productSelected?.weeks||0,Be=this.fb.group({}),mt=this.productSelected?.rangeWeeks||{};for(let[xe,pe]of Object.entries(mt))Be.addControl(xe,this.fb.control(pe));D=="Mensualidad"&&(d=this.validateForm.controls.validTo.value||new Date);let Me={authorization:"portalAuth",operation_type:"in",method:this.validateForm.controls.payment.value,transaction_type:"charge",card:{type:"",brand:"",address:"",card_number:"",holder_name:"",expiration_year:"",expiration_month:"",allows_charges:"",allows_payouts:"",bank_name:"",bank_code:"",points_card:"",points_type:""},status:this.validateForm.controls.status.value,conciliated:!1,creation_date:c,operation_date:new Date().toISOString(),description:"Transfer validada  a traves de portal",error_message:"",order_id:"portalOrder",currency:"MXN",amount:this.validateForm.controls.amountPayment.value,customer:{name:this.currentUserSelected.firstName,last_name:this.currentUserSelected.lastName,email:this.currentUserSelected.email,phone_number:this.currentUserSelected.phoneNumber,address:"",creation_date:"",external_id:"",clabe:""},product:{product_id:this.validateForm.controls.product_id.value,amountTrips:a,frequencies:T,rangeWeeks:Be.value,weeks:Ne,name:this.validateForm.controls.product_description.value},customerId:this.currentUserSelected.customerId,active:!0,category:"permanente",date_created:new Date().toISOString(),product_description:"Transfer validada  a traves de portal",product_id:this.validateForm.controls.product_id.value,name:this.validateForm.controls.name.value,isTaskIn:"false",isTaskOut:"false",type:"Servicio",isOpenpay:!1,paidApp:"portal",price:this.validateForm.controls.price.value,round:this.validateForm.controls.round.value,routeId:this.validateForm.controls.routeId.value,routeName:this.validateForm.controls.routeName.value,stopDescription:"",stopId:this.stopIdValue,stopName:this.validateForm.controls.stopDescription.value,validFrom:this.validateForm.controls.validFrom.value,validTo:t,idBoardingPass:this.currentUserSelected.uid,idPurchasteRequest:"",is_courtesy:r,typePayment:D,amountTrips:a,currentTrips:0};this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,Me).then(xe=>{this.isConfirmLoading=!1,this.customersService.getLatestValidUserPurchasesAdvance(this.currentUserSelected.uid,2,d,D,c).pipe(he(1),v(pe=>pe.map(je=>{let Ht=je.payload.doc.data(),Wt=je.payload.doc.id;return C({id:Wt},Ht)}))).subscribe({next:pe=>{this.customersService.saveBoardingPassDetailToUserPurchaseCollection(this.currentUserSelected.uid,pe[0].id,Me).then(()=>{this.customersService.createPurchaseCloud(Me,this.currentUserSelected,pe[0].id)}).catch(je=>{this.sendMessage("error",je)})},error:pe=>{this.sendMessage("error",pe)}})}).catch(xe=>{this.sendMessage("error",xe)})}sendMessage(e,a){this.messageService.create(e,a)}enviarMensajeConfirmacion(e,a){let t={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"Apps And Informa",msg:"Se confirm\xF3 la informaci\xF3n y se creo el pase de abordar con \xE9xito.",requestId:"suhB7YFAh6PYXCRuJhfD",token:a,uid:e,result:""},r={timestamp:new Date,title:"Apps And Informa General",from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",requestId:"suhB7YFAh6PYXCRuJhfD",body:"Se confirm\xF3 la informaci\xF3n y se creo el pase de abordar con \xE9xito.",token:a,uid:e};this.dashboardService.setMessage(r,e),this.dashboardService.setChatMessage(t).then(()=>{})}onCustomerSelected(e){let a=this.validateForm.get("customerId").value;this.routesService.getProducts(a).pipe(w(this.stopSubscription$),v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return C({id:d},c)}))).subscribe(t=>{this.products=t}),this.routesService.getRoutes(a).pipe(w(this.stopSubscription$),v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return C({id:d},c)}))).subscribe(t=>{this.routes=t})}onRouteSelected(e,a){let r=tt.default.filter(a,c=>c.routeId==e)[0];this.validateForm.controls.routeName.setValue(r.name);let d=this.validateForm.get("customerId").value;this.accountsService.getStopsByCustomer(d,e).pipe(w(this.stopSubscription$),v(c=>c.map(x=>{let F=x.payload.doc.id,D=x.payload.doc.data();return C({id:F},D)}))).subscribe(c=>{this.stopPoints=c})}onChangeValidTo(e){let a=this.validateForm.controls.validFrom.value}onCourtesyChange(e){e&&this.validateForm.controls.amount.setValue(0)}changePayment(e){this.validateForm.controls.amountPayment.setValue(0),this.paymentSelected=e,e=="Mensualidad"?(this.isValidDescriptionPaymentType=!1,this.isAnticipo=!1,this.validateForm.controls.amountPayment.setValue(this.validateForm.controls.amount.value)):e=="Anticipo"?(this.isValidDescriptionPaymentType=!0,this.isAnticipo=!0,this.validateForm.controls.amountPayment.setValue(0)):(this.isAnticipo=!1,this.isValidDescriptionPaymentType=!0,this.validateForm.controls.amountPayment.setValue(0))}onStopPointSelected(e,a){let r=tt.default.filter(this.stopPoints,d=>d.stopPointId===e)[0];r&&(this.stopIdValue=r.id,this.validateForm.patchValue({stopName:r.name,stopDescription:r.description}))}static{this.\u0275fac=function(a){return new(a||l)(O(J),O(Y),O(X))}}static{this.\u0275cmp=U({type:l,selectors:[["app-payments"]],viewQuery:function(a,t){if(a&1&&($e(Xt,5),$e(Yt,5),$e(Qt,5)),a&2){let r;qe(r=He())&&(t.searchbar=r.first),qe(r=He())&&(t.searchbarE=r.first),qe(r=He())&&(t.searchbarC=r.first)}},decls:112,vars:21,consts:[["searchBar",""],["basicTable",""],["searchBarE",""],["basicTable11",""],["searchBarC",""],["basicTable2",""],["modalTitle",""],["modalContent",""],["modalPassFooter",""],["modalContent3",""],["modalFooterEdit1",""],["modalContent2",""],["modalFooterEdit",""],["modalContent112",""],["modalFooterEditE",""],["chatSetting","nzDropdownMenu"],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],[3,"nzSelectedIndex"],["nzTitle","Usuarios"],[1,"chat-list"],[1,"chat-user-tool"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzTheme","outline",1,"search-icon","p-r-10","font-size-20"],["placeholder","Buscar",3,"keyup"],["ngSkipHydration","",3,"nzData"],[4,"ngFor","ngForOf"],["nzTitle","Ejecutores"],["nzTitle","Comprobantes"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter"],["nzTitle","Detalle Usuario","nzWidth","600px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzFooter","nzContent"],["nzTitle","Editar Usuarios ","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzFooter","nzContent"],["nzTitle","Editar Ejecutores","nzWidth","500px",3,"nzVisibleChange","nzOnCancel","nzVisible","nzFooter","nzContent"],["nz-button","","nzType","link",2,"color","#4F6F57","border","none",3,"click","nzSize"],[3,"nzColor",4,"ngIf"],["target","_blank",3,"href"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","nzTheme","outline"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-item","",3,"click",4,"ngIf"],[3,"nzColor"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],[2,"width","100px"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Seleccione una Empresa",2,"width","320px",3,"ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["formControlName","product_id","nzAllowClear","","nzPlaceHolder","Seleccionar producto / servicio",2,"width","320px",3,"ngModelChange"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","320px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","stopId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",2,"width","320px"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","320px"],["nzValue","D\xEDa","nzLabel","D\xEDa"],["nzValue","Tarde","nzLabel","Tarde"],["nzValue","Noche","nzLabel","Noche"],["formControlName","payment","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de Pago",2,"width","320px",3,"ngModelChange"],["nzValue","Mensualidad","nzLabel","Mensualidad"],["nzValue","Anticipo","nzLabel","Anticipo"],["nzValue","Liquidacion","nzLabel","Liquidaci\xF3n"],[1,"row"],[1,"col-md-7"],["formControlName","amountPayment",3,"ngModelChange","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["class","col-md-5",4,"ngIf"],["formControlName","amount",3,"ngModelChange","disabled","nzMin","nzMax","nzStep","nzFormatter","nzParser"],[1,"col-md-5"],["formControlName","is_courtesy","nzCheckedChildren","Si","nzUnCheckedChildren","No",3,"ngModelChange"],[2,"width","120px"],["formControlName","typePayment","nzAllowClear","","nzPlaceHolder","Selecciona una Referencia",2,"width","300px"],["nzValue","Transferencia","nzLabel","Transferencia"],["nzValue","Efectivo","nzLabel","Efectivo"],["nzValue","Sistema","nzLabel","Pago por Sistema"],["nz-checkbox","","formControlName","active"],[1,"col-md-6"],["formControlName","validFrom"],["formControlName","validTo",3,"ngModelChange","nzDisabledDate"],[3,"nzValue","nzLabel"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""],[4,"ngIf"],["formControlName","promiseDate",2,"width","150px"],["nz-button","",3,"click"],["nz-button","",3,"click","nzLoading"],["nz-form","",3,"formGroup"],[3,"nzGutter"],["nzSpan","6"],["nzFor","customerName"],["nzSpan","18"],["nz-input","","id","customerName","formControlName","customerName"],["nzFor","defaultRouteName"],["nz-input","","id","defaultRouteName","formControlName","defaultRouteName"],["nzFor","name"],["nz-input","","id","name","formControlName","name"],["nzFor","defaultRound"],["nz-input","","id","defaultRound","formControlName","defaultRound"],["nzFor","phoneNumber"],["nz-input","","id","phoneNumber","formControlName","phoneNumber"],["nzFor","email"],["nz-input","","id","email","formControlName","email"],["nzFor","studentId"],["nz-input","","id","studentId","formControlName","studentId"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nzFor","status",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["formControlName","status"],["nzValue","active","nzLabel","Activo"],["nzFor","label",3,"nzSpan"],["formControlName","customerId","nzPlaceHolder","Selecciona una empresa",2,"width","250px",3,"nzMaxTagCount"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzFor","status",3,"nzSm"],["formControlName","status","nzPlaceHolder","Selecciona un status",2,"width","250px",3,"nzMaxTagCount"],["nzValue","accept","nzLabel","Aceptado"],["nzValue","reject","nzLabel","Rechazado"],[3,"nzLabel","nzValue"]],template:function(a,t){if(a&1){let r=V();n(0,"div",16)(1,"div",17)(2,"nz-page-header",18)(3,"nz-page-header-title",19),o(4,"Validaciones"),i(),n(5,"nz-page-header-subtitle"),o(6,"Listado de validaciones por aprobar "),i()()(),n(7,"div",20)(8,"nz-tabset",21)(9,"nz-tab",22)(10,"div",23)(11,"div",24)(12,"a",25),_("click",function(){return f(r),g(t.fillData())}),o(13,"Cargar Usuarios"),i(),S(14,"i",26),n(15,"input",27,0),_("keyup",function(){f(r);let c=E(16);return g(t.getItems(c.value))}),i(),n(17,"a",25),_("click",function(){return f(r),g(t.searchUser())}),o(18,"Buscar Usuario"),i()(),n(19,"div")(20,"nz-table",28,1)(22,"thead")(23,"tr")(24,"th"),o(25,"Empresa"),i(),n(26,"th"),o(27,"Nombre"),i(),n(28,"th"),o(29,"Email"),i(),n(30,"th"),o(31,"Estatus"),i(),n(32,"th"),o(33,"..."),i()()(),n(34,"tbody"),z(35,Kt,12,6,"tr",29),i()()()()(),n(36,"nz-tab",30)(37,"div",23)(38,"div",24)(39,"a",25),_("click",function(){return f(r),g(t.fillDataE())}),o(40,"Cargar Ejecutores"),i(),S(41,"i",26),n(42,"input",27,2),_("keyup",function(){f(r);let c=E(43);return g(t.getItemsE(c.value))}),i()(),n(44,"div")(45,"nz-table",28,3)(47,"thead")(48,"tr")(49,"th"),o(50,"Empresa"),i(),n(51,"th"),o(52,"Nombre"),i(),n(53,"th"),o(54,"Cliente"),i(),n(55,"th"),o(56,"Estatus"),i(),n(57,"th"),o(58,"..."),i()()(),n(59,"tbody"),z(60,Zt,12,6,"tr",29),i()()()()(),n(61,"nz-tab",31)(62,"div",23)(63,"div",24)(64,"a",25),_("click",function(){return f(r),g(t.fillDataT())}),o(65,"Cargar Comprobantes"),i(),S(66,"i",26),n(67,"input",27,4),_("keyup",function(){f(r);let c=E(68);return g(t.getItemsT(c.value))}),i()(),n(69,"div")(70,"nz-table",28,5)(72,"thead")(73,"tr")(74,"th"),o(75,"Fecha"),i(),n(76,"th"),o(77,"Empresa"),i(),n(78,"th"),o(79,"Producto"),i(),n(80,"th"),o(81,"Costo Producto"),i(),n(82,"th"),o(83,"Estatus"),i(),n(84,"th"),o(85,"Comprobante"),i(),n(86,"th"),o(87,"..."),i()()(),n(88,"tbody"),z(89,ai,30,11,"tr",29),i()()()()()()()(),n(90,"nz-modal",32),M("nzVisibleChange",function(c){return f(r),N(t.isVisible1,c)||(t.isVisible1=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.handleCancel())}),z(91,oi,1,0,"ng-template",null,6,L)(93,ui,75,18,"ng-template",null,7,L)(95,hi,4,1,"ng-template",null,8,L),i(),n(97,"nz-modal",33),M("nzVisibleChange",function(c){return f(r),N(t.isViewInfo,c)||(t.isViewInfo=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.handleCancelView())}),z(98,fi,51,8,"ng-template",null,9,L)(100,gi,2,0,"ng-template",null,10,L),i(),n(102,"nz-modal",34),M("nzVisibleChange",function(c){return f(r),N(t.isEditModal,c)||(t.isEditModal=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.handleCancelEdit())}),z(103,_i,8,5,"ng-template",null,11,L)(105,zi,4,0,"ng-template",null,12,L),i(),n(107,"nz-modal",35),M("nzVisibleChange",function(c){return f(r),N(t.isEditModalE,c)||(t.isEditModalE=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.handleCancelEditE())}),z(108,Si,13,6,"ng-template",null,13,L)(110,Ci,4,0,"ng-template",null,14,L),i()}if(a&2){let r=E(21),d=E(46),c=E(71),x=E(92),F=E(94),D=E(96),T=E(99),Ne=E(101),Be=E(104),mt=E(106),Me=E(109),xe=E(111);s(2),m("nzGhost",!1),s(6),m("nzSelectedIndex",0),s(12),m("nzData",t.dataUsuarios),s(15),m("ngForOf",r.data),s(10),m("nzData",t.dataEjecutores),s(15),m("ngForOf",d.data),s(10),m("nzData",t.dataTransfer),s(19),m("ngForOf",c.data),s(),P("nzVisible",t.isVisible1),m("nzTitle",x)("nzContent",F)("nzFooter",D),s(7),P("nzVisible",t.isViewInfo),m("nzFooter",Ne)("nzContent",T),s(5),P("nzVisible",t.isEditModal),m("nzFooter",mt)("nzContent",Be),s(5),P("nzVisible",t.isEditModalE),m("nzFooter",xe)("nzContent",Me)}},dependencies:[B,j,Ee,Ie,Je,Ye,Xe,Fe,Qe,ge,Nt,Ke,de,oe,se,ce,le,me,we,Mt,Ft,It,Vt,wt,Tt,ze,K,_e,ie,ee,te,Ze,ne,re,Ge,$,q,H,W,G,Ce,Se,Ot]})}}return l})();var Ue=ct(ft());function xi(l,p){if(l&1&&(n(0,"nz-option",30),S(1,"i",31),o(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(2),h(" ",e.name,"")}}function bi(l,p){if(l&1&&(n(0,"nz-option",30),S(1,"i",31),o(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.routeId),s(2),h(" ",e.name,"")}}function yi(l,p){if(l&1){let e=V();n(0,"th",32),M("nzSortOrderChange",function(t){let r=f(e).$implicit;return N(r.sortOrder,t)||(r.sortOrder=t),g(t)}),o(1),i()}if(l&2){let e=p.$implicit;P("nzSortOrder",e.sortOrder),m("nzSortFn",e.sortFn)("nzFilters",e.listOfFilter)("nzFilterFn",e.filterFn),s(),h(" ",e.name," ")}}function Ei(l,p){if(l&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td"),o(12),i(),n(13,"td"),o(14),i()()),l&2){let e=p.$implicit;s(2),I(e.turno),s(2),I(e.roundTrip),s(2),I(e.displayName),s(2),I(e.studentId),s(2),I(e.phoneNumber),s(2),I(e.email),s(2),I(e.status)}}function Ii(l,p){if(l&1&&(n(0,"nz-option",30),S(1,"i",31),o(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(2),h(" ",e.name,"")}}function Fi(l,p){if(l&1&&(n(0,"nz-option",30),S(1,"i",31),o(2),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.routeId),s(2),h(" ",e.name,"")}}function Vi(l,p){if(l&1){let e=V();n(0,"th",32),M("nzSortOrderChange",function(t){let r=f(e).$implicit;return N(r.sortOrder,t)||(r.sortOrder=t),g(t)}),o(1),i()}if(l&2){let e=p.$implicit;P("nzSortOrder",e.sortOrder),m("nzSortFn",e.sortFn)("nzFilters",e.listOfFilter)("nzFilterFn",e.filterFn),s(),h(" ",e.name," ")}}function wi(l,p){if(l&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td"),o(12),i(),n(13,"td"),o(14),i()()),l&2){let e=p.$implicit;s(2),I(e.turno),s(2),I(e.roundTrip),s(2),I(e.displayName),s(2),I(e.studentId),s(2),I(e.phoneNumber),s(2),I(e.email),s(2),I(e.status)}}function Ti(l,p){if(l&1&&(n(0,"nz-option",30),o(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.routeId),s(),I(e.name)}}function Di(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.lunes),"")}}function Pi(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.martes),"")}}function Ni(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.miercoles),"")}}function Mi(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.jueves),"")}}function Oi(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.viernes),"")}}function Li(l,p){if(l&1&&(n(0,"tr")(1,"td")(2,"nz-tag",44),o(3),i()(),n(4,"td")(5,"nz-tag",44),o(6),i(),z(7,Di,2,2,"nz-tag",46),i(),n(8,"td")(9,"nz-tag",44),o(10),i(),z(11,Pi,2,2,"nz-tag",46),i(),n(12,"td")(13,"nz-tag",44),o(14),i(),z(15,Ni,2,2,"nz-tag",46),i(),n(16,"td")(17,"nz-tag",44),o(18),i(),z(19,Mi,2,2,"nz-tag",46),i(),n(20,"td")(21,"nz-tag",44),o(22),i(),z(23,Oi,2,2,"nz-tag",46),i()()),l&2){let e=p.$implicit,a=u(2);s(2),m("nzColor","blue"),s(),h(" ",e.time,""),s(2),m("nzColor","blue"),s(),h(" ",e.lunes,""),s(),m("ngIf",a.calculateRemaining(e.lunes)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.martes,""),s(),m("ngIf",a.calculateRemaining(e.martes)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.miercoles,""),s(),m("ngIf",a.calculateRemaining(e.miercoles)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.jueves,""),s(),m("ngIf",a.calculateRemaining(e.jueves)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.viernes,""),s(),m("ngIf",a.calculateRemaining(e.viernes)!==0)}}function ki(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.lunes),"")}}function Ri(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.martes),"")}}function Ai(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.miercoles),"")}}function Ui(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.jueves),"")}}function Bi(l,p){if(l&1&&(n(0,"nz-tag",44),o(1),i()),l&2){let e=u().$implicit,a=u(2);m("nzColor","red"),s(),h(" ",a.calculateRemaining(e.viernes),"")}}function ji(l,p){if(l&1&&(n(0,"tr")(1,"td")(2,"nz-tag",44),o(3),i()(),n(4,"td")(5,"nz-tag",44),o(6),i(),z(7,ki,2,2,"nz-tag",46),i(),n(8,"td")(9,"nz-tag",44),o(10),i(),z(11,Ri,2,2,"nz-tag",46),i(),n(12,"td")(13,"nz-tag",44),o(14),i(),z(15,Ai,2,2,"nz-tag",46),i(),n(16,"td")(17,"nz-tag",44),o(18),i(),z(19,Ui,2,2,"nz-tag",46),i(),n(20,"td")(21,"nz-tag",44),o(22),i(),z(23,Bi,2,2,"nz-tag",46),i()()),l&2){let e=p.$implicit,a=u(2);s(2),m("nzColor","blue"),s(),h(" ",e.time,""),s(2),m("nzColor","blue"),s(),h(" ",e.lunes,""),s(),m("ngIf",a.calculateRemaining(e.lunes)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.martes,""),s(),m("ngIf",a.calculateRemaining(e.martes)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.miercoles,""),s(),m("ngIf",a.calculateRemaining(e.miercoles)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.jueves,""),s(),m("ngIf",a.calculateRemaining(e.jueves)!==0),s(2),m("nzColor","blue"),s(),h(" ",e.viernes,""),s(),m("ngIf",a.calculateRemaining(e.viernes)!==0)}}function $i(l,p){if(l&1){let e=V();n(0,"nz-tab",33)(1,"div",10)(2,"form",11),_("ngSubmit",function(){f(e);let t=u();return g(t.submitFormPaid())}),n(3,"table",12)(4,"tr")(5,"td",34)(6,"nz-form-item")(7,"nz-form-label",14),o(8,"Empresa"),i(),S(9,"input",35),i()()(),n(10,"tr")(11,"td",34)(12,"nz-form-item")(13,"nz-form-label",14),o(14,"Operaci\xF3n"),i(),n(15,"nz-select",36),_("ngModelChange",function(t){f(e);let r=u();return g(r.onRoutesSelect(t))}),z(16,Ti,2,3,"nz-option",16),i(),n(17,"label",37),_("ngModelChange",function(t){f(e);let r=u();return g(r.onCheckboxChange(t))}),M("ngModelChange",function(t){f(e);let r=u();return N(r.chkBoardingP,t)||(r.chkBoardingP=t),g(t)}),o(18,"Pases Activos"),i()()(),n(19,"td",34)(20,"nz-form-item")(21,"nz-form-label",14),o(22,"Producto"),i(),n(23,"nz-select",38),_("ngModelChange",function(t){f(e);let r=u();return g(r.onProductSelect(t))}),n(24,"nz-option",30),o(25,"Cami\xF3n"),i(),n(26,"nz-option",30),o(27,"Camioneta"),i()(),S(28,"input",39),i()()(),n(29,"button",40),_("click",function(){f(e);let t=u();return g(t.submitM())}),o(30,"Aceptar"),i()(),n(31,"nz-table",41,1)(33,"thead")(34,"tr",42)(35,"th"),o(36,"Lunes"),i(),n(37,"th"),o(38,"Martes"),i(),n(39,"th"),o(40,"Miercoles"),i(),n(41,"th"),o(42,"Jueves"),i(),n(43,"th"),o(44,"Viernes"),i()()(),n(45,"tbody")(46,"tr",42)(47,"th"),o(48),i(),n(49,"th"),o(50),i(),n(51,"th"),o(52),i(),n(53,"th"),o(54),i(),n(55,"th"),o(56),i()()()(),n(57,"nz-table",43,1)(59,"thead")(60,"tr")(61,"th"),o(62,"Horario"),i(),n(63,"th"),o(64,"Lunes"),i(),n(65,"th"),o(66,"Martes"),i(),n(67,"th"),o(68,"Miercoles"),i(),n(69,"th"),o(70,"Jueves"),i(),n(71,"th"),o(72,"Viernes"),i()()(),n(73,"tbody"),z(74,Li,24,17,"tr",26),i(),n(75,"tfoot")(76,"tr",42)(77,"td")(78,"nz-tag",44),o(79),i()(),n(80,"td")(81,"nz-tag",44),o(82),i()(),n(83,"td")(84,"nz-tag",44),o(85),i()(),n(86,"td")(87,"nz-tag",44),o(88),i()(),n(89,"td")(90,"nz-tag",44),o(91),i()(),n(92,"td")(93,"nz-tag",44),o(94),i()()()()(),n(95,"nz-table",45,2)(97,"thead")(98,"tr")(99,"th"),o(100,"Horario"),i(),n(101,"th"),o(102,"Lunes"),i(),n(103,"th"),o(104,"Martes"),i(),n(105,"th"),o(106,"Miercoles"),i(),n(107,"th"),o(108,"Jueves"),i(),n(109,"th"),o(110,"Viernes"),i()()(),n(111,"tbody"),z(112,ji,24,17,"tr",26),i(),n(113,"tfoot")(114,"tr",42)(115,"td")(116,"nz-tag",44),o(117),i()(),n(118,"td")(119,"nz-tag",44),o(120),i()(),n(121,"td")(122,"nz-tag",44),o(123),i()(),n(124,"td")(125,"nz-tag",44),o(126),i()(),n(127,"td")(128,"nz-tag",44),o(129),i()(),n(130,"td")(131,"nz-tag",44),o(132),i()()()()(),S(133,"nz-form-item"),i()()()}if(l&2){let e=u();s(2),m("formGroup",e.validateFormM),s(14),m("ngForOf",e.routesM),s(),P("ngModel",e.chkBoardingP),s(7),m("nzLabel",e.camion)("nzValue",e.camion),s(2),m("nzLabel",e.camioneta)("nzValue",e.camioneta),s(22),ye("Cr\xE9ditos: (",e.LunesFinal," / ",e.sumaTotal,") // ",e.porcentajeLunes.toFixed(2)," %"),s(2),ye("Cr\xE9ditos: (",e.MartesFinal," / ",e.sumaTotal,") // ",e.porcentajeMartes.toFixed(2)," %"),s(2),ye("Cr\xE9ditos: (",e.MiercolesFinal," / ",e.sumaTotal,") // ",e.porcentajeMiercoles.toFixed(2)," %"),s(2),ye("Cr\xE9ditos: (",e.JuevesFinal," / ",e.sumaTotal,") // ",e.porcentajeJueves.toFixed(2)," %"),s(2),ye("Cr\xE9ditos: (",e.ViernesFinal," / ",e.sumaTotal,") // ",e.porcentajeViernes.toFixed(2)," %"),s(),m("nzData",e.dataSet),s(17),m("ngForOf",e.dataSet),s(4),m("nzColor","green"),s(),h(" Total : ",e.grantotal,""),s(2),m("nzColor","green"),s(),h(" ",e.totalLunes,""),s(2),m("nzColor","green"),s(),h(" ",e.totalMartes,""),s(2),m("nzColor","green"),s(),h(" ",e.totalViernes,""),s(2),m("nzColor","green"),s(),h(" ",e.totalJueves,""),s(2),m("nzColor","green"),s(),h(" ",e.totalViernes,""),s(),m("nzData",e.dataSetEnd),s(17),m("ngForOf",e.dataSetEnd),s(4),m("nzColor","green"),s(),h(" Total : ",e.grantotalE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalLunesE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalMartesE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalViernesE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalJuevesE,""),s(2),m("nzColor","green"),s(),h(" ",e.totalViernesE,"")}}var dr=(()=>{class l{constructor(e,a,t){this.afs=e,this.messageService=a,this.fb=t,this.isMederos=!1,this.customers=[],this.customerMed=[],this.accountId$=new A,this.routeId$=new A,this.stopSubscription$=new A,this.rowDataPay=[],this.rowData=[],this.userRoute=!1,this.userRouteP=!1,this.submitPayment=!0,this.contenedores="",this.contenedoresPay="",this.rowDataPre=[],this.rowDataPush=[],this.customersService=y(Ve),this.routesService=y(ae),this.usersService=y(ve),this.authService=y(Q),this.accountsService=y(Z),this.productsService=y(et),this.infoSegment=[],this.dataSet=[{time:"",lunes:0,martes:0,miercoles:0,jueves:0,viernes:0}],this.dataSetEnd=[{time:"",lunes:0,martes:0,miercoles:0,jueves:0,viernes:0}],this.lunesP=0,this.martesP=0,this.miercolesP=0,this.juevesP=0,this.viernesP=0,this.lunesE=0,this.martesE=0,this.miercolesE=0,this.juevesE=0,this.viernesE=0,this.totalLunes=0,this.totalMartes=0,this.totalMiercoles=0,this.totalJueves=0,this.totalViernes=0,this.grantotal=0,this.LunesFinal=0,this.MartesFinal=0,this.MiercolesFinal=0,this.JuevesFinal=0,this.ViernesFinal=0,this.countE=0,this.countS=0,this.porcentajeLunes=0,this.porcentajeMartes=0,this.porcentajeMiercoles=0,this.porcentajeJueves=0,this.porcentajeViernes=0,this.sumaTotal=0,this.chkBoardingP=!1,this.totalLunesE=0,this.totalMartesE=0,this.totalMiercolesE=0,this.totalJuevesE=0,this.totalViernesE=0,this.grantotalE=0,this.carro=0,this.asientos=0,this.transportType="",this.camioneta="Camioneta",this.camion="Cami\xF3n",this.listOfColumns=[{name:"Turno",sortOrder:null,sortFn:(r,d)=>r.turno.localeCompare(d.turno),listOfFilter:[],filterFn:(r,d)=>r.some(c=>d.turno.indexOf(c)!==-1)},{name:"Tipo de Viaje",sortOrder:null,sortFn:(r,d)=>r.roundTrip.localeCompare(d.roundTrip),listOfFilter:[],filterFn:(r,d)=>r.some(c=>d.roundTrip.indexOf(c)!==-1)},{name:"Nombre",sortOrder:null,sortFn:(r,d)=>r.displayName.localeCompare(d.displayName),listOfFilter:[],filterFn:(r,d)=>r.some(c=>d.displayName.indexOf(c)!==-1)},{name:"Identificaci\xF3n",sortOrder:null,sortFn:null,listOfFilter:[],filterFn:null},{name:"Telefono",sortOrder:null,sortFn:null,listOfFilter:[],filterFn:null},{name:"Email",sortOrder:null,sortFn:null,listOfFilter:[],filterFn:null},{name:"Estatus",sortOrder:null,sortFn:null,listOfFilter:[],filterFn:null}],this.authService.user.subscribe(r=>{r&&(this.user=r,this.user!==null&&this.user!==void 0&&this.user.idSegment!==void 0&&this.accountsService.getSegmentLevel(this.user.idSegment).pipe(w(this.stopSubscription$),v(d=>{let c=d.payload.id,x=d.payload.data();return C({id:c},x)}),k(d=>(this.infoSegment=d,this.fillData(),d))).subscribe())})}ngOnInit(){this.validateForm=this.fb.group({customerId:["",[b.required]],customerName:[],routeId:["",[b.required]],routeName:["",[b.required]],round:["",[b.required]]}),this.validateFormP=this.fb.group({customerId:["",[b.required]],customerName:[],routeId:["",[b.required]],routeName:["",[b.required]],round:["",[b.required]]}),this.validateFormM=this.fb.group({customerId:["",[b.required]],customerName:[],routeId:["",[b.required]],productId:["",[b.required]],asientos:[0,b.required],chkBoardingP:[!1]})}fillData(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.cDocument=this.afs.collection("customers").doc(this.user.customerId),this.customerSubscription=this.cDocument.snapshotChanges().pipe(v(e=>{let a=e.payload.id,t=e.payload.data();return C({id:a},t)})).subscribe(e=>{this.isMederos=!0,this.customers=[e];let a=this.customers.filter(t=>t.isCarrusel);a.length>0&&(this.customerMed=a,this.getRoutesForMed(this.customerMed))})):(this.cCollection=this.afs.collection("customers",e=>e.where("active","==",!0)),this.customerSubscription=this.cCollection.snapshotChanges().pipe(v(e=>e.map(a=>{let t=a.payload.doc.id,r=a.payload.doc.data();return C({id:t},r)}))).subscribe(e=>{this.customers=e;let a=this.customers.filter(t=>t.isCarrusel);a.length>0&&(this.isMederos=!0,this.customerMed=a,this.getRoutesForMed(this.customerMed))}))}getRoutesForMed(e){this.validateFormM.controls.customerName.setValue(e[0].name),this.validateFormM.controls.customerId.setValue(e[0].id),this.routesService.getRoutes(e[0].id).pipe(w(this.stopSubscription$),v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.routesM=a}),this.productsService.getActiveProducts(e[0].id).pipe(w(this.stopSubscription$),v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.products=a})}submitM(){if(this.carro=this.validateFormM.get("asientos")?.value,this.validateFormM.valid){let e=this.validateFormM.get("customerId")?.value,a=this.validateFormM.get("routeId")?.value;this.chkBoardingP?this.routesService.getQuotesByRouteByBoardingPass(e,a,this.transportType).pipe(w(this.stopSubscription$),v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return ue(C({},c),{id:d})})),v(t=>t.filter(r=>r.quotesData&&Array.isArray(r.quotesData)&&r.quotesData.some(d=>d.transportType===this.transportType))),v(t=>t.reduce((r,d)=>{let c=d.quotesData.filter(x=>x.transportType===this.transportType);return r.concat(c)},[]))).subscribe(t=>{t.length===0?this.sendMessage("info","No existen registros con estos criterios."):this.createDataSet(t)}):this.routesService.getQuotesByRouteandProgram(e,a,this.transportType).pipe(w(this.stopSubscription$),v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return ue(C({},c),{id:d})}))).subscribe(t=>{t.length==0&&this.sendMessage("info","No existen registros con estos criterios."),this.createDataSet(t)})}else this.sendMessage("error","Datos invalidos favor de validar")}sendMessage(e,a){this.messageService.create(e,a)}onCheckboxChange(e){this.chkBoardingP=this.validateFormM.get("chkBoardingP")?.value}createDataSet(e){let a=this.selectedRoute.initialEnd,t=this.selectedRoute.initialStart,r=[],d=[];d=t.map(c=>({time:c,lunes:0,martes:0,miercoles:0,jueves:0,viernes:0})),r=a.map(c=>({time:c,lunes:0,martes:0,miercoles:0,jueves:0,viernes:0})),e.forEach(c=>{c.daysHour.forEach(x=>{let F=d.find(T=>T.time===x.startInit);if(F)switch(x.day){case 1:F.lunes+=1;break;case 2:F.martes+=1;break;case 3:F.miercoles+=1;break;case 4:F.jueves+=1;break;case 5:F.viernes+=1;break;default:break}let D=r.find(T=>T.time===x.endInit);if(D)switch(x.day){case 1:D.lunes+=1;break;case 2:D.martes+=1;break;case 3:D.miercoles+=1;break;case 4:D.jueves+=1;break;case 5:D.viernes+=1;break;default:break}})}),this.dataSet=d,this.dataSetEnd=r,this.calculateTotals()}onProductSelect(e){this.transportType=e}onRoutesSelect(e){let a=this.routesM.find(t=>t.id===e);a&&(this.selectedRoute=a)}calculateTotals(){this.totalLunes=this.dataSet.reduce((t,r)=>t+r.lunes,0),this.totalMartes=this.dataSet.reduce((t,r)=>t+r.martes,0),this.totalMiercoles=this.dataSet.reduce((t,r)=>t+r.miercoles,0),this.totalJueves=this.dataSet.reduce((t,r)=>t+r.jueves,0),this.totalViernes=this.dataSet.reduce((t,r)=>t+r.viernes,0),this.grantotal=this.totalLunes+this.totalMartes+this.totalMiercoles+this.totalJueves+this.totalViernes,this.totalLunesE=this.dataSetEnd.reduce((t,r)=>t+r.lunes,0),this.totalMartesE=this.dataSetEnd.reduce((t,r)=>t+r.martes,0),this.totalMiercolesE=this.dataSetEnd.reduce((t,r)=>t+r.miercoles,0),this.totalJuevesE=this.dataSetEnd.reduce((t,r)=>t+r.jueves,0),this.totalViernesE=this.dataSetEnd.reduce((t,r)=>t+r.viernes,0),this.grantotalE=this.totalLunesE+this.totalMartesE+this.totalMiercolesE+this.totalJuevesE+this.totalViernesE;let e=this.dataSet.length*this.carro,a=this.dataSetEnd.length*this.carro;this.sumaTotal=e+a,this.LunesFinal=this.totalLunes+this.totalLunesE,this.MartesFinal=this.totalMartes+this.totalMartesE,this.MiercolesFinal=this.totalMiercoles+this.totalMiercolesE,this.JuevesFinal=this.totalJueves+this.totalJuevesE,this.ViernesFinal=this.totalViernes+this.totalViernesE,this.porcentajeLunes=this.LunesFinal/this.sumaTotal*100,this.porcentajeMartes=this.MartesFinal/this.sumaTotal*100,this.porcentajeMiercoles=this.MiercolesFinal/this.sumaTotal*100,this.porcentajeJueves=this.JuevesFinal/this.sumaTotal*100,this.porcentajeViernes=this.ViernesFinal/this.sumaTotal*100}onCustomerSelectedC(e,a){if(e!=null&&!this.userRoute){this.userRoute=!0,this.routes=[],this.contenedores="",this.rowDataPay=[];let r=Ue.filter(a,d=>d.id==e)[0];this.validateForm.controls.customerName.setValue(r.name),this.validateForm.controls.customerId.setValue(r.id),this.fillCustomerRoute(r.id)}}onCustomerSelectedP(e,a){if(e!=null&&!this.userRouteP){this.userRouteP=!0,this.routesP=[],this.contenedoresPay="",this.rowDataPre=[],this.rowData=[];let r=Ue.filter(a,d=>d.id==e)[0];this.validateFormP.controls.customerName.setValue(r.name),this.validateFormP.controls.customerId.setValue(r.id),this.fillCustomerRouteP(r.id)}}calculateRemaining(e){return this.carro-e}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}fillCustomerRoute(e){this.routesService.getRoutes(e).pipe(w(this.stopSubscription$),v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.routes=a})}fillCustomerRouteP(e){this.routesService.getRoutes(e).pipe(w(this.stopSubscription$),v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.routesP=a})}onRouteSelected(e,a){this.routeId$.next(e);let r=Ue.filter(a,d=>d.routeId==e)[0];this.validateForm.controls.routeName.setValue(r.name)}onRouteSelectedP(e,a){this.routeId$.next(e);let r=Ue.filter(a,d=>d.routeId==e)[0];this.validateFormP.controls.routeName.setValue(r.name)}submitFormUnPaid(){this.userRoute=!1,this.rowDataPay=[];let e=this.validateForm.controls.customerId.value,a=this.validateForm.controls.routeId.value,t=this.validateForm.controls.round.value,r="";t==1?r="D\xEDa":t==2?r="Tarde":r="Nocturno",this.usersCollection=this.afs.collection("users",d=>d.where("status","==","preRegister").where("customerId","==",e).where("turno","==",t).where("defaultRoute","==",a).orderBy("displayName")),this.userSubscription=this.usersCollection.snapshotChanges().pipe(v(d=>d.map(c=>{let x=c.payload.doc.id,F=c.payload.doc.data();return C({id:x},F)}))).subscribe(d=>{this.loadUsers(d)})}loadUsers(e){this.rowDataPay=e,e.length<=14?this.contenedores=this.organigrama(e.length,13,19,40):e.length<=19?this.contenedores=this.organigrama(e.length,14,17,40):this.contenedores=this.organigrama(e.length,14,19,40)}loadUsersP(e){this.contenedoresPay="",this.rowData=e,this.rowData.length<=14?this.contenedoresPay=this.organigrama(this.rowData.length,13,19,40):this.rowData.length<=19?this.contenedoresPay=this.organigrama(this.rowData.length,14,17,40):this.contenedoresPay=this.organigrama(this.rowData.length,14,19,40)}onRoundSelected(){if(this.submitPayment){this.submitPayment=!1,this.userRouteP=!1,this.rowData=[],this.rowDataPre=[];let e=this.validateFormP.controls.customerId.value,a=this.validateFormP.controls.routeId.value,t=parseInt(this.validateFormP.controls.round.value,10),r="";t==1?r="D\xEDa":t==2?r="Tarde":r="Nocturno",this.usersCollection=this.afs.collection("users",d=>d.where("customerId","==",e).where("defaultRound","==",r).where("defaultRoute","==",a).orderBy("displayName")),this.userSubscription=this.usersCollection.snapshotChanges().pipe(v(d=>d.map(c=>{let x=c.payload.doc.id,F=c.payload.doc.data();return C({id:x},F)}))).subscribe(d=>{this.rowData=d,this.load()})}}load(){this.rowData.length>=1?(this.rowDataPush=[],this.rowData.forEach(e=>{let a=e.id;this.afs.collection(`users/${a}/boardingPasses`,t=>t.where("active","==",!0).limit(1)).get().subscribe(t=>{t.empty||this.rowDataPush.push(C({},e))})})):this.contenedoresPay="No existen coincidencias!"}submitFormPaid(){this.rowDataPre=[],this.submitPayment=!0,this.rowDataPre=this.rowDataPush,this.loadUsersP(this.rowDataPre)}organigrama(e,a,t,r){let d=0,c=0,x=0,F=0,D=!1;for(;e>0;)if(e>=r)x++,e-=r;else if(e>=t)c++,e-=t;else if(e>=a)d++,e-=a;else{F=e;break}let T="";return d>0&&(T+=`${d} camiones de 14 pasajeros, `,D=!0),c>0&&(T+=`${c} camiones de 19 pasajeros, `,D=!0),x>0&&(T+=`${x} camiones de 40 pasajeros, `,D=!0),F>0&&(T+=`y restan ${F} pasajeros sin asignacion, `),T!==""?D?T=`Se necesitan ${T} en total.`:T=`Se necesitan 0 camiones  ${T} en total.`:T="No se necesitan camiones.",T}resetFilters(){}resetFiltersPay(){}trackByName(e,a){return a.name}trackByNamePay(e,a){return a.name}sortBPay(){}sortBy(){}static{this.\u0275fac=function(a){return new(a||l)(O(X),O(Y),O(J))}}static{this.\u0275cmp=U({type:l,selectors:[["app-organigrama"]],decls:90,vars:19,consts:[["filterTable",""],["borderedTable",""],["borderedTable1",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],[3,"nzSelectedIndex"],["nzTitle","Usuarios Interesados"],[2,"margin-bottom","10px"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],[2,"width","1000px","border-collapse","collapse"],[2,"width","50%"],[2,"width","80px"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Selecciona la Empresa",2,"width","300px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","300px",3,"ngModelChange"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","300px"],["nzValue","1","nzLabel","Matutino"],["nzValue","2","nzLabel","Vespertino"],["nzValue","3","nzLabel","Nocturno"],["nz-button","",3,"click"],[1,"table-operations"],["nzTableLayout","fixed","ngSkipHydration","",3,"nzData"],[3,"nzSortOrder","nzSortFn","nzFilters","nzFilterFn","nzSortOrderChange",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf"],["nzTitle","Usuarios con Pago"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","300px",3,"ngModelChange"],["nzTitle","Unidad Mederos Pagos",4,"ngIf"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""],[3,"nzSortOrderChange","nzSortOrder","nzSortFn","nzFilters","nzFilterFn"],["nzTitle","Unidad Mederos Pagos"],[2,"width","33%"],["nz-input","","id","customerName","formControlName","customerName",2,"width","300px"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","250px",3,"ngModelChange"],["nz-checkbox","","formControlName","chkBoardingP",2,"margin-left","10px","margin-top","5px",3,"ngModelChange","ngModel"],["nzAllowClear","","nzPlaceHolder","Selecciona un Producto","formControlName","productId",2,"width","200px",3,"ngModelChange"],["nz-input","","type","number","formControlName","asientos","id","asientos","placeholder","# Asientos",2,"width","110px","height","30px"],["nz-button","","type","number",2,"margin-bottom","10px",3,"click"],["nzBordered","","nzSize","middle","nzTitle","Procentajes",1,"custom-table"],[2,"border-radius","1px"],["nzBordered","","nzSize","middle","nzTitle","Horario Entrada",3,"nzData"],[1,"m-b-0",3,"nzColor"],["nzBordered","","nzSize","middle","nzTitle","Horario Salida",3,"nzData"],["class","m-b-0",3,"nzColor",4,"ngIf"]],template:function(a,t){if(a&1){let r=V();n(0,"div",3)(1,"div",4)(2,"nz-page-header",5)(3,"nz-page-header-title",6),o(4,"Organigrama de Operaci\xF3n"),i(),n(5,"nz-page-header-subtitle"),o(6,"Reporte de usuarios "),i()()(),n(7,"div",7)(8,"nz-tabset",8)(9,"nz-tab",9)(10,"div",10)(11,"form",11),_("ngSubmit",function(){return f(r),g(t.submitFormUnPaid())}),n(12,"table",12)(13,"tbody")(14,"tr")(15,"td",13)(16,"nz-form-item")(17,"nz-form-label",14),o(18,"Empresa"),i(),n(19,"nz-select",15),_("ngModelChange",function(c){return f(r),g(t.onCustomerSelectedC(c,t.customers))}),z(20,xi,3,3,"nz-option",16),i()()()(),n(21,"tr")(22,"td",13)(23,"nz-form-item")(24,"nz-form-label",14),o(25,"Operaci\xF3n"),i(),n(26,"nz-select",17),_("ngModelChange",function(c){return f(r),g(t.onRouteSelected(c,t.routes))}),z(27,bi,3,3,"nz-option",16),i()(),n(28,"nz-form-label",14),o(29,"Turno"),i(),n(30,"nz-select",18),S(31,"nz-option",19)(32,"nz-option",20)(33,"nz-option",21),i(),n(34,"nz-form-item")(35,"nz-form-label"),o(36,"Programac\xF3n de Operaci\xF3n: "),i(),n(37,"b"),o(38),i()()()()()(),n(39,"button",22),_("click",function(){return f(r),g(t.submitFormUnPaid())}),o(40,"Aceptar"),i()()(),n(41,"div"),S(42,"div",23),n(43,"nz-table",24,0)(45,"thead")(46,"tr"),z(47,yi,2,5,"th",25),i()(),z(48,Ei,15,7,"tr",26),i()()(),n(49,"nz-tab",27)(50,"div",10)(51,"form",11),_("ngSubmit",function(){return f(r),g(t.submitFormPaid())}),n(52,"table",12)(53,"tr")(54,"td",13)(55,"nz-form-item")(56,"nz-form-label",14),o(57,"Empresa"),i(),n(58,"nz-select",15),_("ngModelChange",function(c){return f(r),g(t.onCustomerSelectedP(c,t.customers))}),z(59,Ii,3,3,"nz-option",16),i()()()(),n(60,"tr")(61,"td",13)(62,"nz-form-item")(63,"nz-form-label",14),o(64,"Operaci\xF3n"),i(),n(65,"nz-select",17),_("ngModelChange",function(c){return f(r),g(t.onRouteSelectedP(c,t.routesP))}),z(66,Fi,3,3,"nz-option",16),i()(),n(67,"nz-form-label",14),o(68,"Turno"),i(),n(69,"nz-select",28),_("ngModelChange",function(){return f(r),g(t.onRoundSelected())}),S(70,"nz-option",19)(71,"nz-option",20)(72,"nz-option",21),i(),n(73,"nz-form-item")(74,"nz-form-label"),o(75,"Programac\xF3n de Operaci\xF3n: "),i(),n(76,"b"),o(77),i()()()()(),n(78,"nz-form-item")(79,"button",22),_("click",function(){return f(r),g(t.submitFormPaid())}),o(80,"Aceptar"),i()()()(),n(81,"div"),S(82,"div",23),n(83,"nz-table",24,0)(85,"thead")(86,"tr"),z(87,Vi,2,5,"th",25),i()(),z(88,wi,15,7,"tr",26),i()()(),z(89,$i,134,50,"nz-tab",29),i()()()}if(a&2){let r=E(44);s(2),m("nzGhost",!1),s(6),m("nzSelectedIndex",0),s(3),m("formGroup",t.validateForm),s(9),m("ngForOf",t.customers),s(7),m("ngForOf",t.routes),s(11),h(" ",t.contenedores,""),s(5),m("nzData",t.rowDataPay),s(4),m("ngForOf",t.listOfColumns)("ngForTrackBy",t.trackByName),s(),m("ngForOf",r.data),s(3),m("formGroup",t.validateFormP),s(8),m("ngForOf",t.customers),s(7),m("ngForOf",t.routesP),s(11),h(" ",t.contenedoresPay,""),s(6),m("nzData",t.rowDataPre),s(4),m("ngForOf",t.listOfColumns)("ngForTrackBy",t.trackByNamePay),s(),m("ngForOf",r.data),s(),m("ngIf",t.isMederos)}},dependencies:[B,j,Ee,Ie,Je,Ye,Xe,Fe,ge,Ke,de,Dt,oe,se,ce,le,me,ze,K,_e,ie,ee,te,Ze,ne,re,Ge,$,yt,q,H,W,G,Ce,Se],styles:[".table-operations[_ngcontent-%COMP%]{margin-bottom:16px}.table-operations[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:8px}.custom-table[_ngcontent-%COMP%]{max-width:900px;margin:auto;height:160px}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:14px}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f0f0f0;text-align:center}.custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center}"]})}}return l})();var St=ct(ft());var jt=(()=>{class l{constructor(){this.audioUrl=""}static{this.\u0275fac=function(a){return new(a||l)}}static{this.\u0275cmp=U({type:l,selectors:[["app-audio-player"]],inputs:{audioUrl:"audioUrl"},decls:3,vars:1,consts:[["controls",""],["type","audio/mpeg",3,"src"]],template:function(a,t){a&1&&(n(0,"audio",0),S(1,"source",1),o(2," Your browser does not support the audio element. "),i()),a&2&&(s(),m("src",t.audioUrl,R))},encapsulation:2})}}return l})();var $t=()=>({width:"300px",borderRadius:"4px",marginLeft:"160px"}),qt=()=>({width:"300px"});function Hi(l,p){if(l&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),Le(5,"date"),i(),n(6,"td"),o(7),i(),n(8,"td")(9,"a",32),o(10,"Ver Evidencia"),i()(),n(11,"td"),S(12,"app-audio-player",33),i()()),l&2){let e=p.$implicit;s(2),h(" ",e.displayName," "),s(2),I(ke(5,5,e.dateTimeStamp.toDate(),"yyyy-MM-dd HH:mm:ss")),s(3),h(" ",e.comentario," "),s(2),be("href",e.imageUrl,R),s(3),m("audioUrl",e.audioUrl)}}function Wi(l,p){if(l&1&&(n(0,"nz-table",30,0)(2,"thead")(3,"tr")(4,"th"),o(5,"PR"),i(),n(6,"th"),o(7,"Fecha"),i(),n(8,"th"),o(9,"Comentarios "),i(),n(10,"th"),o(11,"Audio"),i(),n(12,"th"),o(13,"..."),i()()(),n(14,"tbody"),z(15,Hi,13,8,"tr",31),i()()),l&2){let e=E(1),a=u();m("nzData",a.evidenceInfo)("nzLoading",a.loadingevidenceInfo)("nzLoadingDelay",500)("nzNoResult","No hay evidencias disponibles"),s(15),m("ngForOf",e.data)}}function Gi(l,p){if(l&1&&(n(0,"nz-option",34),S(1,"i",35),o(2),S(3,"br"),o(4),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(2),h(" ",e.name," "),s(2),h(" ",e.description,"")}}function Ji(l,p){if(l&1&&S(0,"nz-option",36),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.displayName)}}function Xi(l,p){if(l&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),Le(5,"date"),i(),n(6,"td"),o(7),i(),n(8,"td")(9,"a",32),o(10,"Ver Evidencia"),i()(),n(11,"td"),S(12,"app-audio-player",33),i()()),l&2){let e=p.$implicit;s(2),h(" ",e.displayName," "),s(2),I(ke(5,5,e.dateTimeStamp.toDate(),"yyyy-MM-dd HH:mm:ss")),s(3),h(" ",e.comentario," "),s(2),be("href",e.imageUrl,R),s(3),m("audioUrl",e.audioUrl)}}function Yi(l,p){if(l&1&&(n(0,"nz-table",30,1)(2,"thead")(3,"tr")(4,"th"),o(5,"PR"),i(),n(6,"th"),o(7,"Fecha"),i(),n(8,"th"),o(9,"Comentarios "),i(),n(10,"th"),o(11,"Audio"),i(),n(12,"th"),o(13,"..."),i()()(),n(14,"tbody"),z(15,Xi,13,8,"tr",31),i()()),l&2){let e=E(1),a=u();m("nzData",a.evidenceInfoDriver)("nzLoading",a.loadingevidenceInfoDriver)("nzLoadingDelay",500)("nzNoResult","No hay evidencias disponibles"),s(15),m("ngForOf",e.data)}}function Qi(l,p){if(l&1&&S(0,"nz-option",36),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function Ki(l,p){if(l&1&&S(0,"nz-option",36),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function Zi(l,p){if(l&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),Le(5,"date"),i(),n(6,"td"),o(7),i(),n(8,"td")(9,"a",32),o(10,"Ver Evidencia"),i()(),n(11,"td"),S(12,"app-audio-player",33),i()()),l&2){let e=p.$implicit;s(2),h(" ",e.displayName," "),s(2),I(ke(5,5,e.dateTimeStamp.toDate(),"yyyy-MM-dd HH:mm:ss")),s(3),h(" ",e.comentario," "),s(2),be("href",e.imageUrl,R),s(3),m("audioUrl",e.audioUrl)}}function en(l,p){if(l&1&&(n(0,"nz-table",37,0)(2,"thead")(3,"tr")(4,"th"),o(5,"PR"),i(),n(6,"th"),o(7,"Fecha"),i(),n(8,"th"),o(9,"Comentarios "),i(),n(10,"th"),o(11,"Audio"),i(),n(12,"th"),o(13,"..."),i()()(),n(14,"tbody"),z(15,Zi,13,8,"tr",31),i()()),l&2){let e=E(1),a=u();m("nzData",a.evidenceInfoByProgram)("nzNoResult","No hay evidencias disponibles"),s(15),m("ngForOf",e.data)}}function tn(l,p){if(l&1&&S(0,"nz-option",36),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function nn(l,p){if(l&1&&S(0,"nz-option",36),l&2){let e=p.$implicit;m("nzValue",e.id)("nzLabel",e.name)}}function rn(l,p){if(l&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),Le(5,"date"),i(),n(6,"td"),o(7),i(),n(8,"td")(9,"a",32),o(10,"Ver Evidencia"),i()(),n(11,"td"),S(12,"app-audio-player",33),i()()),l&2){let e=p.$implicit;s(2),h(" ",e.displayName," "),s(2),I(ke(5,5,e.dateTimeStamp.toDate(),"yyyy-MM-dd HH:mm:ss")),s(3),h(" ",e.comentario," "),s(2),be("href",e.imageUrl,R),s(3),m("audioUrl",e.audioUrl)}}function an(l,p){if(l&1&&(n(0,"nz-table",37,2)(2,"thead")(3,"tr")(4,"th"),o(5,"PR"),i(),n(6,"th"),o(7,"Fecha"),i(),n(8,"th"),o(9,"Comentarios "),i(),n(10,"th"),o(11,"Audio"),i(),n(12,"th"),o(13,"..."),i()()(),n(14,"tbody"),z(15,rn,13,8,"tr",31),i()()),l&2){let e=E(1),a=u();m("nzData",a.evidenceInfoByRoute)("nzNoResult","No hay evidencias disponibles"),s(15),m("ngForOf",e.data)}}var Ir=(()=>{class l{constructor(e,a,t,r){this.afs=e,this.datePipe=a,this.messageService=t,this.fb=r,this.driverService=y(Lt),this.vendorsService=y(Pt),this.accountsService=y(Z),this.customersService=y(Ve),this.routesService=y(ae),this.programService=y(Pe),this.loadingevidenceInfo=!1,this.loadingevidenceInfoByProgram=!1,this.loadingevidenceInfoDriver=!1,this.stopSubscription$=new A,this.infoLoad=[],this.customerList=[],this.programList=[],this.customerListRoute=[],this.RouteList=[],this.vendorsList=[],this.rolService=y(Te),this.authService=y(Q),this.infoSegment=[],this.date=ht(),this.dateRoute=ht(),this.authService.user.subscribe(d=>{d&&(this.user=d,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(c=>{this.infoLoad=c,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(w(this.stopSubscription$),v(c=>{let x=c.payload.id,F=c.payload.data();return C({id:x},F)}),k(c=>(this.infoSegment=c,this.vendorList(),c))).subscribe()))}),this.dateFilterForm=this.fb.group({selectedDate:[null]}),this.dateFilterFormProgram=this.fb.group({selectedDate:[null],customerId:[],programId:[],name:[]}),this.dateFilterFormProgramRoute=this.fb.group({selectedDate:[null],customerId:[],routeId:[],name:[]}),this.dateFilterFormDriver=this.fb.group({selectedDate:[null],driverId:[],driver:[],vendorName:[],vendorId:[]})}vendorList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.vendorsService.getVendorByCustomer(this.user.customerId).pipe(w(this.stopSubscription$),v(e=>e.map(a=>{let t=a.payload.doc.id,r=a.payload.doc.data();return ue(C({},r),{id:t})}))).subscribe(e=>{this.vendorsList=e}):this.vendorsService.getVendors().pipe(w(this.stopSubscription$),v(e=>e.map(a=>{let t=a.payload.doc.id,r=a.payload.doc.data();return ue(C({},r),{id:t})}))).subscribe(e=>{this.vendorsList=e})}onDateChangeDriver(){this.evidenceInfoDriver=[],this.driversList=[]}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}onVendorSelected(e,a){if(e){this.evidenceInfoDriver=[],this.driversList=[];let r=St.filter(this.vendorsList,d=>d.id==e)[0];this.fillDataDriver(r.id)}}fillDataDriver(e){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.driverService.getDriversbyCustomer(e,this.user.customerId).pipe(v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.driversList=a}):this.driverService.getDrivers(e).pipe(v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.driversList=a})}ngOnInit(){}onDriverSelected(e,a){if(this.evidenceInfoDriver=[],e){let t="";this.dateFilterFormDriver&&(t=this.dateFilterFormDriver.get("selectedDate").value);let r=this.datePipe.transform(t,"dd-MM-yyyy"),c=St.filter(this.driversList,x=>x.id==e)[0];this.driverService.getEvidenceDriversperDriver(r.toString(),c.id).pipe(v(x=>x.map(F=>{let D=F.payload.doc.id,T=F.payload.doc.data();return C({id:D},T)}))).subscribe({next:x=>{this.evidenceInfoDriver=x,this.loadingevidenceInfoDriver=!1},error:x=>{this.loadingevidenceInfoDriver=!1}})}}onDateChange(){this.loadingevidenceInfo=!0;let e=this.dateFilterForm.get("selectedDate").value;if(e!==void 0){let a=new Date(e);this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.driverService.getEvidenceDriversbyCustomer(a,this.user.customerId).pipe(v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return C({id:d},c)}))).subscribe({next:t=>{this.evidenceInfo=t,this.loadingevidenceInfo=!1},error:t=>{this.sendMessage("error",t),this.loadingevidenceInfo=!1}}):this.driverService.getEvidenceDrivers(a).pipe(v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return C({id:d},c)}))).subscribe({next:t=>{this.evidenceInfo=t,this.loadingevidenceInfo=!1},error:t=>{this.sendMessage("error",t),this.loadingevidenceInfo=!1}})}}onDateChangeProgram(e){this.date=ut(new Date(e)),this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.cDocument=this.afs.collection("customers").doc(this.user.customerId),this.customerSubscription=this.cDocument.snapshotChanges().pipe(v(a=>{let t=a.payload.id,r=a.payload.data();return C({id:t},r)})).subscribe(a=>{this.customerList=[a]})):(this.cCollection=this.afs.collection("customers",a=>a.where("active","==",!0)),this.customerSubscription=this.cCollection.snapshotChanges().pipe(v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.customerList=a}))}onDateChangeProgramRoute(e){this.dateRoute=ut(new Date(e)),this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.cDocument=this.afs.collection("customers").doc(this.user.customerId),this.customerSubscription=this.cDocument.snapshotChanges().pipe(v(a=>{let t=a.payload.id,r=a.payload.data();return C({id:t},r)})).subscribe(a=>{this.customerListRoute=[a]})):(this.cCollection=this.afs.collection("customers",a=>a.where("active","==",!0)),this.customerSubscription=this.cCollection.snapshotChanges().pipe(v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.customerListRoute=a}))}onCustomerSelected(e){let a=this.dateFilterFormProgram.get("customerId").value;this.date!==void 0&&a!==void 0&&(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.programService.getProgramsByDaybyCustomer(this.date,this.user.customerId).pipe(he(1),v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return C({id:d},c)})),k(t=>{this.programList=t})).subscribe():this.programService.getProgramsByDay(this.date).pipe(he(1),v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return C({id:d},c)})),v(t=>{let r=new Set;return t.filter(d=>r.has(d.name)?!1:(r.add(d.name),!0))}),k(t=>{this.programList=t})).subscribe())}onCustomerSelectedRoute(e){let a=this.dateFilterFormProgramRoute.get("customerId").value;this.dateRoute!==void 0&&a!==void 0&&this.programService.getRoutesbyCustomer(a).pipe(he(1),v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return C({id:d},c)})),k(t=>{this.RouteList=t})).subscribe()}onProgramSelected(){this.loadingevidenceInfoByProgram=!0;let e=this.dateFilterFormProgram.get("programId").value;e!==void 0&&this.driverService.getEvidenceByProgram(e).pipe(v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.evidenceInfoByProgram=a})}onRouteSelected(){let e=this.dateFilterFormProgramRoute.get("routeId").value;e!==void 0&&this.driverService.getEvidenceByRoute(e).pipe(v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)}))).subscribe(a=>{this.evidenceInfoByRoute=a})}sendMessage(e,a){this.messageService.create(e,a)}static{this.\u0275fac=function(a){return new(a||l)(O(X),O(Re),O(Y),O(J))}}static{this.\u0275cmp=U({type:l,selectors:[["app-evidence"]],decls:72,vars:29,consts:[["basicTable",""],["basicTableDriver",""],["basicTableR",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],[3,"nzSelectedIndex"],["nzTitle","Evidencias Generales"],[2,"margin-bottom","10px",3,"formGroup"],["for","selectedDate"],["type","date","id","selectedDate","formControlName","selectedDate",3,"change"],[3,"nzData","nzLoading","nzLoadingDelay","nzNoResult",4,"ngIf"],["nzTitle","Evidencias por PR"],[2,"width","160px"],[3,"formGroup"],["formControlName","vendorId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",2,"width","450px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","driver","nzAllowClear","","nzPlaceHolder","Seleccione un PR",2,"width","450px",3,"ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzTitle","Evidencias por Programa"],["for","selectedDate",2,"width","160px"],[3,"ngStyle"],[3,"nzSelectChange","ngStyle","nzFullscreen"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Seleccione una Empresa",2,"width","450px",3,"ngModelChange"],["formControlName","programId","nzAllowClear","","nzPlaceHolder","Seleccione un Programa",2,"width","450px",3,"ngModelChange"],["ngSkipHydration","",3,"nzData","nzNoResult",4,"ngIf"],["nzTitle","Evidencias por Operaci\xF3n"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Seleccione una operaci\xF3n",2,"width","450px",3,"ngModelChange"],[3,"nzData","nzLoading","nzLoadingDelay","nzNoResult"],[4,"ngFor","ngForOf"],["target","_blank",3,"href"],[3,"audioUrl"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""],[3,"nzValue","nzLabel"],["ngSkipHydration","",3,"nzData","nzNoResult"]],template:function(a,t){a&1&&(n(0,"div",3)(1,"div",4)(2,"nz-page-header",5)(3,"nz-page-header-title",6),o(4,"Evidencias"),i(),n(5,"nz-page-header-subtitle"),o(6,"Reporte de evidencias "),i()()(),n(7,"div",7)(8,"nz-tabset",8)(9,"nz-tab",9)(10,"div",10)(11,"label",11),o(12," Selecciona una Fecha: "),i(),n(13,"input",12),_("change",function(){return t.onDateChange()}),i()(),n(14,"div"),z(15,Wi,16,5,"nz-table",13),i()(),n(16,"nz-tab",14)(17,"div",10)(18,"nz-form-label",15),o(19," Selecciona una Fecha"),i(),n(20,"input",12),_("change",function(){return t.onDateChangeDriver()}),i()(),n(21,"div",16)(22,"nz-form-control")(23,"nz-form-label",15),o(24,"Divisi\xF3n"),i(),n(25,"nz-select",17),_("ngModelChange",function(d){return t.onVendorSelected(d,"vendorName")}),z(26,Gi,5,4,"nz-option",18),i()(),n(27,"nz-form-control")(28,"nz-form-label",15),o(29,"PR"),i(),n(30,"nz-select",19),_("ngModelChange",function(d){return t.onDriverSelected(d,"vendorName")}),z(31,Ji,1,2,"nz-option",20),i()()(),n(32,"div"),z(33,Yi,16,5,"nz-table",13),i()(),n(34,"nz-tab",21)(35,"div",16)(36,"nz-form-control")(37,"nz-form-label",22),o(38," Selecciona una Fecha "),i(),n(39,"div",23)(40,"nz-calendar",24),_("nzSelectChange",function(d){return t.onDateChangeProgram(d)}),i()()(),n(41,"nz-form-control")(42,"nz-form-label",15),o(43,"Empresa"),i(),n(44,"nz-select",25),_("ngModelChange",function(d){return t.onCustomerSelected(d)}),z(45,Qi,1,2,"nz-option",20),i()(),n(46,"nz-form-control")(47,"nz-form-label",15),o(48,"Programa"),i(),n(49,"nz-select",26),_("ngModelChange",function(){return t.onProgramSelected()}),z(50,Ki,1,2,"nz-option",20),i()()(),n(51,"div"),z(52,en,16,3,"nz-table",27),i()(),n(53,"nz-tab",28)(54,"div",16)(55,"nz-form-control")(56,"nz-form-label",22),o(57," Selecciona una Fecha "),i(),n(58,"div",23)(59,"nz-calendar",24),_("nzSelectChange",function(d){return t.onDateChangeProgramRoute(d)}),i()()(),n(60,"nz-form-control")(61,"nz-form-label",15),o(62,"Empresa"),i(),n(63,"nz-select",25),_("ngModelChange",function(d){return t.onCustomerSelectedRoute(d)}),z(64,tn,1,2,"nz-option",20),i()(),n(65,"nz-form-control")(66,"nz-form-label",15),o(67,"Operaci\xF3n"),i(),n(68,"nz-select",29),_("ngModelChange",function(){return t.onRouteSelected()}),z(69,nn,1,2,"nz-option",20),i()()(),n(70,"div"),z(71,an,16,3,"nz-table",27),i()()()()()),a&2&&(s(2),m("nzGhost",!1),s(6),m("nzSelectedIndex",0),s(2),m("formGroup",t.dateFilterForm),s(5),m("ngIf",t.evidenceInfo),s(2),m("formGroup",t.dateFilterFormDriver),s(4),m("formGroup",t.dateFilterFormDriver),s(5),m("ngForOf",t.vendorsList),s(5),m("ngForOf",t.driversList),s(2),m("ngIf",t.evidenceInfoDriver),s(2),m("formGroup",t.dateFilterFormProgram),s(4),m("ngStyle",Oe(25,$t)),s(),m("ngStyle",Oe(26,qt))("nzFullscreen",!1)("nzFullscreen",!1),s(5),m("ngForOf",t.customerList),s(5),m("ngForOf",t.programList),s(2),m("ngIf",t.evidenceInfoByProgram),s(2),m("formGroup",t.dateFilterFormProgramRoute),s(4),m("ngStyle",Oe(27,$t)),s(),m("ngStyle",Oe(28,qt))("nzFullscreen",!1)("nzFullscreen",!1),s(5),m("ngForOf",t.customerListRoute),s(5),m("ngForOf",t.RouteList),s(2),m("ngIf",t.evidenceInfoByRoute))},dependencies:[B,j,bt,kt,Ee,Ie,Fe,Qe,de,oe,se,ce,le,me,K,ie,ee,te,ne,re,$,q,H,W,G,Ce,Se,jt,Re]})}}return l})();function on(l,p){if(l&1&&(n(0,"nz-option",39),o(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(),h(" ",e.name,"")}}function sn(l,p){if(l&1&&(n(0,"a",43),o(1,"Ver Referencia"),i()),l&2){let e=u().$implicit;m("href",e.refrenceURL,R)}}function ln(l,p){if(l&1){let e=V();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td")(12,"a",41),_("click",function(){let t=f(e).$implicit,r=u(2);return g(r.loadUserInfoPanel(t.uidUsuario))}),o(13,"Ver"),i()(),n(14,"td"),z(15,sn,2,1,"a",42),i(),n(16,"td")(17,"a",41),_("click",function(){let t=f(e).$implicit,r=u(2);return g(r.openSeguimientoModal(t.id,t.token,t.uidUsuario))}),o(18,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit,a=u(2);s(2),h(" ",e.status," "),s(2),I(e.currentDate),s(2),fe(" ",e.description," ",e.cancelUserComment," "),s(2),h(" ",a.getRouteNameById(e.routeId,e.customerId)," "),s(2),h(" ",e.bus," "),s(5),m("ngIf",e.refrenceURL)}}function dn(l,p){if(l&1&&(n(0,"nz-table",40,8)(2,"thead")(3,"tr")(4,"th"),o(5,"Status"),i(),n(6,"th"),o(7,"Fecha"),i(),n(8,"th"),o(9,"Descripci\xF3n"),i(),n(10,"th"),o(11,"Ruta"),i(),n(12,"th"),o(13,"Tipo"),i(),n(14,"th"),o(15,"Usuario"),i(),n(16,"th"),o(17,"Referencia"),i(),n(18,"th"),o(19,"..."),i()()(),n(20,"tbody"),z(21,ln,19,7,"tr",33),i()()),l&2){let e=E(1),a=u();m("nzData",a.mfDataM)("nzLoading",a.loadingmejorasData)("nzLoadingDelay",500),s(21),m("ngForOf",e.data)}}function mn(l,p){if(l&1&&(n(0,"a",43),o(1,"Ver Referencia"),i()),l&2){let e=u().$implicit;m("href",e.refrenceURL,R)}}function cn(l,p){if(l&1){let e=V();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td")(12,"a",41),_("click",function(){let t=f(e).$implicit,r=u(2);return g(r.loadUserInfoPanel(t.uidUsuario))}),o(13,"Ver"),i()(),n(14,"td"),z(15,mn,2,1,"a",42),i(),n(16,"td")(17,"a",41),_("click",function(){let t=f(e).$implicit,r=u(2);return g(r.openSeguimientoModal(t.id,t.token,t.uidUsuario))}),o(18,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit,a=u(2);s(2),h(" ",e.status," "),s(2),I(e.currentDate),s(2),fe(" ",e.description," ",e.cancelUserComment," "),s(2),h(" ",a.getRouteNameById(e.routeId,e.customerId)," "),s(2),h(" ",e.bus," "),s(5),m("ngIf",e.refrenceURL)}}function pn(l,p){if(l&1&&(n(0,"nz-table",44,9)(2,"thead")(3,"tr")(4,"th"),o(5,"Status"),i(),n(6,"th"),o(7,"Fecha"),i(),n(8,"th"),o(9,"Descripci\xF3n"),i(),n(10,"th"),o(11,"Ruta"),i(),n(12,"th"),o(13,"Tipo"),i(),n(14,"th"),o(15,"Usuario"),i(),n(16,"th"),o(17,"Referencia"),i(),n(18,"th"),o(19,"..."),i()()(),n(20,"tbody"),z(21,cn,19,7,"tr",33),i()()),l&2){let e=E(1),a=u();m("nzData",a.mfData)("nzLoading",a.loadingmejorasData)("nzLoadingDelay",500),s(21),m("ngForOf",e.data)}}function un(l,p){if(l&1&&(n(0,"nz-option",39),o(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(),h(" ",e.name,"")}}function hn(l,p){if(l&1&&(n(0,"a",43),o(1,"Ver Referencia"),i()),l&2){let e=u().$implicit;m("href",e.refrenceURL,R)}}function fn(l,p){if(l&1){let e=V();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td")(12,"a",41),_("click",function(){let t=f(e).$implicit,r=u();return g(r.loadUserInfoPanel(t.uidUsuario))}),o(13,"Ver"),i()(),n(14,"td"),z(15,hn,2,1,"a",42),i(),n(16,"td")(17,"a",41),_("click",function(){let t=f(e).$implicit,r=u();return g(r.openSeguimientoModal(t.id,t.token,t.uidUsuario))}),o(18,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit,a=u();s(2),h(" ",e.status," "),s(2),I(e.currentDate),s(2),fe(" ",e.description," ",e.cancelUserComment," "),s(2),h(" ",a.getRouteNameById(e.routeId,e.customerId)," "),s(2),h(" ",e.bus," "),s(5),m("ngIf",e.refrenceURL)}}function gn(l,p){if(l&1&&(n(0,"nz-option",39),o(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.id),s(),h(" ",e.name,"")}}function _n(l,p){if(l&1&&(n(0,"a",43),o(1,"Ver Referencia"),i()),l&2){let e=u().$implicit;m("href",e.refrenceURL,R)}}function zn(l,p){if(l&1){let e=V();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td")(12,"a",41),_("click",function(){let t=f(e).$implicit,r=u();return g(r.loadUserInfoPanel(t.uidUsuario))}),o(13,"Ver"),i()(),n(14,"td"),z(15,_n,2,1,"a",42),i(),n(16,"td")(17,"a",41),_("click",function(){let t=f(e).$implicit,r=u();return g(r.openSeguimientoModal(t.id,t.token,t.uidUsuario))}),o(18,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit,a=u();s(2),h(" ",e.status," "),s(2),I(e.currentDate),s(2),fe(" ",e.description," ",e.cancelUserComment," "),s(2),h(" ",a.getRouteNameById(e.routeId,e.customerId)," "),s(2),h(" ",e.bus," "),s(5),m("ngIf",e.refrenceURL)}}function vn(l,p){if(l&1&&(n(0,"div",45)(1,"div")(2,"strong"),o(3,"Cliente:"),i(),o(4),i(),n(5,"div")(6,"strong"),o(7,"Nombre:"),i(),o(8),i(),n(9,"div")(10,"strong"),o(11,"Email:"),i(),o(12),i(),n(13,"div")(14,"strong"),o(15,"Telefono:"),i(),o(16),i()()),l&2){let e=u();s(4),h(" ",e.modalDataUser.customerName,""),s(4),h(" ",e.modalDataUser.displayName,""),s(4),h(" ",e.modalDataUser.email,""),s(4),h(" ",e.modalDataUser.phoneNumber,"")}}function Sn(l,p){if(l&1){let e=V();n(0,"button",46),_("click",function(){f(e);let t=u();return g(t.closeProgramModal())}),o(1,"Aceptar"),i()}}function Cn(l,p){if(l&1&&(n(0,"div",45)(1,"div")(2,"strong"),o(3,"Cliente:"),i(),o(4),i(),n(5,"div")(6,"strong"),o(7,"Conductor:"),i(),o(8),i(),n(9,"div")(10,"strong"),o(11,"Turno:"),i(),o(12),i(),n(13,"div")(14,"strong"),o(15,"Inicio:"),i(),o(16),i(),n(17,"div")(18,"strong"),o(19,"Fin:"),i(),o(20),i(),n(21,"div")(22,"strong"),o(23,"Veh\xEDculo:"),i(),o(24),i()()),l&2){let e=u();s(4),h(" ",e.modalData.customerName,""),s(4),h(" ",e.modalData.driver,""),s(4),h(" ",e.modalData.round,""),s(4),h(" ",e.modalData.startAt,""),s(4),h(" ",e.modalData.endAt,""),s(4),h(" ",e.modalData.vehicleName,"")}}function xn(l,p){if(l&1){let e=V();n(0,"button",46),_("click",function(){f(e);let t=u();return g(t.closeProgramModal())}),o(1,"Aceptar"),i()}}function bn(l,p){if(l&1&&(n(0,"div",50),o(1),i()),l&2){let e=u(2);s(),h(" ",e.errorMessage," ")}}function yn(l,p){if(l&1){let e=V();n(0,"div",45)(1,"nz-select",47),M("ngModelChange",function(t){f(e);let r=u();return N(r.selectedStatus,t)||(r.selectedStatus=t),g(t)}),S(2,"nz-option",23)(3,"nz-option",24)(4,"nz-option",25)(5,"nz-option",26),i(),n(6,"textarea",48),M("ngModelChange",function(t){f(e);let r=u();return N(r.response,t)||(r.response=t),g(t)}),o(7," "),i(),z(8,bn,2,1,"div",49),i()}if(l&2){let e=u();s(),P("ngModel",e.selectedStatus),s(5),P("ngModel",e.response),s(2),m("ngIf",e.errorMessage)}}function En(l,p){if(l&1){let e=V();n(0,"button",46),_("click",function(){f(e);let t=u();return g(t.closeProgramModal())}),o(1,"Cerrar"),i(),n(2,"button",46),_("click",function(){f(e);let t=u();return g(t.handleOk())}),o(3,"Enviar"),i()}}var Ar=(()=>{class l{constructor(e,a,t,r){this.afs=e,this.messageService=a,this.datePipe=t,this.fb=r,this.programService=y(Pe),this.authService=y(Q),this.rolService=y(Te),this.routesService=y(ae),this.accountsService=y(Z),this.dashboardService=y(De),this.userService=y(ve),this.infoSegment=[],this.mfData=[],this.mfDataM=[],this.loadingmejorasData=!1,this.loadingincidenteData=!1,this.loadingopData=!1,this.infoLoad=[],this.stopSubscription$=new A,this.routeNames={},this.isProgramModalVisible=!1,this.isSeguimientoVisible=!1,this.isUserModalVisible=!1,this.modalData={},this.modalDataUser={},this.selectedDataUser=[],this.selectedStatus=null,this.response=null,this.errorMessage=null,this.selectedUserToken="",this.selectHelpCenterIdTicket="",this.selectedUidUser="",this.customersList=[],this.userCustomerId="",this.authService.user.subscribe(d=>{d&&(this.user=d,this.userCustomerId=this.user.customerId,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(c=>{this.infoLoad=c,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(w(this.stopSubscription$),v(c=>{let x=c.payload.id,F=c.payload.data();return C({id:x},F)}),k(c=>(this.infoSegment=c,this.getCustomersList(),c))).subscribe()))}),this.dateFilterForm=this.fb.group({selectedOption:[null],status:[]}),this.dateFilterFormI=this.fb.group({selectedOption:[null],status:[]}),this.dateFilterFormO=this.fb.group({selectedOption:[null],status:[]})}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}ngOnInit(){}onDateChange(e){if(!(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1))if(e=="1"){let a=this.dateFilterForm.get("selectedOption").value,t=this.dateFilterForm.get("status").value;a&&t?(this.programService.getHelpCenterAll("Mejora",a,t).pipe(v(r=>r.map(d=>{let c=d.payload.doc.id,x=d.payload.doc.data();return C({id:c},x)}))).subscribe(r=>{r.length>0&&(this.mfDataM=r,this.mfData.forEach(d=>{r.routeId&&this.getRouteNameById(d.routeId,d.customerId)}))}),this.programService.getHelpCenterAll("Felicitacion",a,t).pipe(v(r=>r.map(d=>{let c=d.payload.doc.id,x=d.payload.doc.data();return C({id:c},x)}))).subscribe(r=>{r.length>0&&(this.mfData=r,this.mfData.forEach(d=>{r.routeId&&this.getRouteNameById(d.routeId,d.customerId)}))})):this.sendMessage("error","Los criterios son requeridos para la busqueda")}else if(e=="2"){let a=this.dateFilterFormI.get("selectedOption").value,t=this.dateFilterFormI.get("status").value;a&&t?this.programService.getHelpCenterAll("Incidente",a,t).pipe(v(r=>r.map(d=>{let c=d.payload.doc.id,x=d.payload.doc.data();return C({id:c},x)}))).subscribe(r=>{r.length>0?(this.incidenteData=r,this.incidenteData.forEach(d=>{r.routeId&&this.getRouteNameById(d.routeId,d.customerId)})):this.sendMessage("info","No existen registros con estos criterios")}):this.sendMessage("error","Los criterios son requeridos para la busqueda")}else{let a=this.dateFilterFormO.get("selectedOption").value,t=this.dateFilterFormO.get("status").value;a&&t?this.programService.getHelpCenterAll("Objeto Perdido",a,t).pipe(v(r=>r.map(d=>{let c=d.payload.doc.id,x=d.payload.doc.data();return C({id:c},x)}))).subscribe(r=>{r.length>0?(this.opData=r,this.opData.forEach(d=>{r.routeId&&this.getRouteNameById(d.routeId,d.customerId)})):this.sendMessage("info","No existen registros con estos criterios")}):this.sendMessage("error","Los criterios son requeridos para la busqueda")}}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.afs.collection("customers").doc(this.userCustomerId).snapshotChanges().pipe(w(this.stopSubscription$),v(a=>{let t=a.payload.id,r=a.payload.data();return C({id:t},r)}),k(a=>(this.customersList=[a],a))).subscribe():this.afs.collection("customers",a=>a.orderBy("name")).snapshotChanges().pipe(w(this.stopSubscription$),v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)})),k(a=>(this.customersList=a,a))).subscribe()}getRouteNameById(e,a){return this.routeNames[e]?this.routeNames[e]:(this.routesService.getRoute(a,e).pipe(he(1),v(t=>{let r=t.payload.data(),d=r?r.name:"Pendiente..";return this.routeNames[e]=d,d})).subscribe(),"Loading...")}sendMessage(e,a){this.messageService.create(e,a)}openProgramModal(e,a){this.isProgramModalVisible=!0,this.loadProgramData(e,a)}openSeguimientoModal(e,a,t){this.isSeguimientoVisible=!0,this.selectedUserToken=a,this.selectHelpCenterIdTicket=e,this.selectedUidUser=t,this.loadUserInfo(this.selectedUidUser)}handleOk(){if(!this.selectedStatus||!this.response)this.errorMessage="Por favor, complete todos los campos antes de enviar.";else if(this.errorMessage=null,!this.selectedUserToken||!this.selectHelpCenterIdTicket||!this.selectedUidUser||!this.selectedDataUser)this.errorMessage="Falta informaci\xF3n por cargar. Validar nuevamente.";else{let e=this.selectedUserToken||"";if(this.programService.updateTicketHelpCenter(this.selectHelpCenterIdTicket,this.selectedStatus),e){let a={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"El Ticket generado tiene un status de :"+this.selectedStatus,msg:this.response,requestId:"suhB7YFAh6PYXCRuJhfD",token:e,uid:this.selectedUidUser,email:this.selectedDataUser.email,title:"Apps And Informa General",body:this.response},t={timestamp:new Date,title:"El Ticket generado tiene un status de :"+this.selectedStatus,email:this.selectedDataUser.email,body:this.response,token:e,uid:this.selectedUidUser};this.dashboardService.setChatMessage(a),this.dashboardService.setMessage(t,this.selectedUidUser),this.isSeguimientoVisible=!1,this.response=""}else this.sendMessage("error","Null token :"+this.selectedUidUser+"// "+this.modalDataUser.customerName)}}closeProgramModal(){this.isProgramModalVisible=!1,this.isSeguimientoVisible=!1,this.isUserModalVisible=!1,this.selectedUserToken="",this.selectHelpCenterIdTicket="",this.selectedUidUser=""}loadProgramData(e,a){this.programService.getProgrambyCustomer(e,a).subscribe({next:t=>{if(t.payload){let r=t.payload.data(),d=r.startAt?r.startAt.toDate():new Date,c=r.endAt?r.endAt.toDate():new Date,x=this.datePipe.transform(d,"dd-MM-yyyy HH:mm"),F=this.datePipe.transform(c,"dd-MM-yyyy HH:mm");this.modalData={customerName:r.customerName,driver:r.driver,startAt:x,round:r.round,endAt:F,vehicleName:r.vehicleName}}else this.sendMessage("error","Registro no encontrado")},error:t=>{this.sendMessage("error",t)}})}loadUserInfoPanel(e){this.isUserModalVisible=!0,this.loadUserInfo(e)}loadUserInfo(e){this.userService.getUserInfo(e).subscribe({next:a=>{if(a.payload){let t=a.payload.data();this.selectedDataUser=t,this.modalDataUser={customerName:t.customerName,displayName:t.displayName,email:t.email,phoneNumber:t.phoneNumber,token:t.token}}else this.sendMessage("error","Registro no encontrado")},error:a=>{this.sendMessage("error",a)}})}static{this.\u0275fac=function(a){return new(a||l)(O(X),O(Y),O(Re),O(J))}}static{this.\u0275cmp=U({type:l,selectors:[["app-center"]],decls:128,vars:30,consts:[["incidente",""],["basicTable3",""],["modalContent",""],["modalPassFooter",""],["modalContent2",""],["modalPassFooter2",""],["modalContent1",""],["modalPassFooter1",""],["basicTable1M",""],["basicTable1",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],[3,"nzSelectedIndex"],["nzTitle","Mejoras y Felicitaciones"],[2,"margin-bottom","10px",3,"formGroup"],["for","selectedDate",2,"width","150px"],["formControlName","selectedOption","nzPlaceHolder","Selecciona un cliente",2,"width","300px",3,"ngModelChange","ngModel"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["for","type",2,"width","150px","margin-top","10px"],["formControlName","status","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de status",2,"width","350px"],["nzValue","Abierto","nzLabel","Abierto"],["nzValue","En Proceso","nzLabel","En Proceso"],["nzValue","Cerrado","nzLabel","Cerrado"],["nzValue","Cancelado","nzLabel","Cancelado"],["nz-button","","nzType","primary",2,"margin-left","5px","margin-top","10px","margin-bottom","10px",3,"click"],["nzTitle","Mejoras","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Felicitaciones","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Incidente"],["formControlName","status","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de status",2,"width","250px"],["nzTitle","Incidentes",3,"nzData","nzLoading","nzLoadingDelay"],[4,"ngFor","ngForOf"],["nzTitle","Objetos Perdidos"],["nzTitle","Objetos Perdidos",3,"nzData","nzLoading","nzLoadingDelay"],["nzTitle","Informaci\xF3n del Usuario",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzTitle","Informaci\xF3n del Programa",3,"nzVisibleChange","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzTitle","Seguimiento a Ticket",3,"nzVisibleChange","nzOnOk","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzCustomContent","",3,"nzLabel","nzValue"],["nzTitle","Mejoras","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay"],[3,"click"],["target","_blank",3,"href",4,"ngIf"],["target","_blank",3,"href"],["nzTitle","Felicitaciones","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay"],[2,"display","flex","flex-direction","column","align-items","flex-start"],["nz-button","",3,"click"],["nzAllowClear","","nzPlaceHolder","Seleccione un estado",2,"width","100%","margin-bottom","15px",3,"ngModelChange","ngModel"],["rows","4","nz-input","","placeholder","Redactar Respuesta",2,"width","100%",3,"ngModelChange","ngModel"],["style","color: red; margin-top: 10px;",4,"ngIf"],[2,"color","red","margin-top","10px"]],template:function(a,t){if(a&1){let r=V();n(0,"div",10)(1,"div",11)(2,"nz-page-header",12)(3,"nz-page-header-title",13),o(4,"Centro de Atenci\xF3n"),i(),n(5,"nz-page-header-subtitle"),o(6," Informaci\xF3n "),i()()(),n(7,"div",14)(8,"nz-tabset",15)(9,"nz-tab",16)(10,"div",17)(11,"div")(12,"label",18),o(13," Selecciona un Cliente: "),i(),n(14,"nz-select",19),M("ngModelChange",function(c){return f(r),N(t.selectedOption,c)||(t.selectedOption=c),g(c)}),z(15,on,2,3,"nz-option",20),i()(),n(16,"div")(17,"label",21),o(18," Status: "),i(),n(19,"nz-select",22),S(20,"nz-option",23)(21,"nz-option",24)(22,"nz-option",25)(23,"nz-option",26),i()()(),n(24,"div")(25,"a",27),_("click",function(){return f(r),g(t.onDateChange("1"))}),o(26,"Cargar"),i()(),n(27,"div"),z(28,dn,22,4,"nz-table",28),i(),n(29,"div"),z(30,pn,22,4,"nz-table",29),i()(),n(31,"nz-tab",30)(32,"div",17)(33,"div")(34,"label",18),o(35," Selecciona un Cliente: "),i(),n(36,"nz-select",19),M("ngModelChange",function(c){return f(r),N(t.selectedOption,c)||(t.selectedOption=c),g(c)}),z(37,un,2,3,"nz-option",20),i()(),n(38,"div")(39,"label",21),o(40," Status: "),i(),n(41,"nz-select",31),S(42,"nz-option",23)(43,"nz-option",24)(44,"nz-option",25)(45,"nz-option",26),i()()(),n(46,"div")(47,"a",27),_("click",function(){return f(r),g(t.onDateChange("2"))}),o(48,"Cargar"),i()(),n(49,"div")(50,"nz-table",32,0)(52,"thead")(53,"tr")(54,"th"),o(55,"Status"),i(),n(56,"th"),o(57,"Fecha"),i(),n(58,"th"),o(59,"Descripci\xF3n"),i(),n(60,"th"),o(61,"Ruta"),i(),n(62,"th"),o(63,"Tipo"),i(),n(64,"th"),o(65,"Usuario"),i(),n(66,"th"),o(67,"Referencia"),i(),n(68,"th"),o(69,"..."),i()()(),n(70,"tbody"),z(71,fn,19,7,"tr",33),i()()()(),n(72,"nz-tab",34)(73,"div",17)(74,"div")(75,"label",18),o(76," Selecciona un Cliente: "),i(),n(77,"nz-select",19),M("ngModelChange",function(c){return f(r),N(t.selectedOption,c)||(t.selectedOption=c),g(c)}),z(78,gn,2,3,"nz-option",20),i()(),n(79,"div")(80,"label",21),o(81," Status: "),i(),n(82,"nz-select",31),S(83,"nz-option",23)(84,"nz-option",24)(85,"nz-option",25)(86,"nz-option",26),i()()(),n(87,"div")(88,"a",27),_("click",function(){return f(r),g(t.onDateChange("3"))}),o(89,"Cargar"),i()(),n(90,"div")(91,"nz-table",35,1)(93,"thead")(94,"tr")(95,"th"),o(96,"Status"),i(),n(97,"th"),o(98,"Fecha"),i(),n(99,"th"),o(100,"Descripci\xF3n"),i(),n(101,"th"),o(102,"Ruta"),i(),n(103,"th"),o(104,"Tipo"),i(),n(105,"th"),o(106,"Usuario"),i(),n(107,"th"),o(108,"Referencia"),i(),n(109,"th"),o(110,"..."),i()()(),n(111,"tbody"),z(112,zn,19,7,"tr",33),i()()()()()()(),n(113,"nz-modal",36),M("nzVisibleChange",function(c){return f(r),N(t.isUserModalVisible,c)||(t.isUserModalVisible=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.closeProgramModal())}),z(114,vn,17,4,"ng-template",null,2,L)(116,Sn,2,0,"ng-template",null,3,L),i(),n(118,"nz-modal",37),M("nzVisibleChange",function(c){return f(r),N(t.isProgramModalVisible,c)||(t.isProgramModalVisible=c),g(c)}),_("nzOnCancel",function(){return f(r),g(t.closeProgramModal())}),z(119,Cn,25,6,"ng-template",null,4,L)(121,xn,2,0,"ng-template",null,5,L),i(),n(123,"nz-modal",38),M("nzVisibleChange",function(c){return f(r),N(t.isSeguimientoVisible,c)||(t.isSeguimientoVisible=c),g(c)}),_("nzOnOk",function(){return f(r),g(t.handleOk())})("nzOnCancel",function(){return f(r),g(t.closeProgramModal())}),z(124,yn,9,3,"ng-template",null,6,L)(126,En,4,0,"ng-template",null,7,L),i()}if(a&2){let r=E(51),d=E(92),c=E(115),x=E(117),F=E(120),D=E(122),T=E(125),Ne=E(127);s(2),m("nzGhost",!1),s(6),m("nzSelectedIndex",0),s(2),m("formGroup",t.dateFilterForm),s(4),P("ngModel",t.selectedOption),s(),m("ngForOf",t.customersList),s(13),m("ngIf",t.mfDataM),s(2),m("ngIf",t.mfData),s(2),m("formGroup",t.dateFilterFormI),s(4),P("ngModel",t.selectedOption),s(),m("ngForOf",t.customersList),s(13),m("nzData",t.incidenteData)("nzLoading",t.loadingincidenteData)("nzLoadingDelay",500),s(21),m("ngForOf",r.data),s(2),m("formGroup",t.dateFilterFormO),s(4),P("ngModel",t.selectedOption),s(),m("ngForOf",t.customersList),s(13),m("nzData",t.opData)("nzLoading",t.loadingopData)("nzLoadingDelay",500),s(21),m("ngForOf",d.data),s(),P("nzVisible",t.isUserModalVisible),m("nzContent",c)("nzFooter",x),s(5),P("nzVisible",t.isProgramModalVisible),m("nzContent",F)("nzFooter",D),s(5),P("nzVisible",t.isSeguimientoVisible),m("nzContent",T)("nzFooter",Ne)}},dependencies:[B,j,ge,de,oe,se,ce,le,me,we,ze,K,_e,ie,ee,te,ne,re,$,q,H,W,G,We,Ce,Se]})}}return l})();function In(l,p){if(l&1&&(n(0,"nz-option",22),o(1),i()),l&2){let e=p.$implicit;m("nzLabel",e.name)("nzValue",e.name),s(),h(" ",e.name,"")}}function Fn(l,p){if(l&1&&(n(0,"a",25),o(1,"Ver Comprobante"),i()),l&2){let e=u().$implicit;m("href",e.image,R)}}function Vn(l,p){if(l&1){let e=V();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td"),z(12,Fn,2,1,"a",23),i(),n(13,"td")(14,"a",24),_("click",function(){let t=f(e).$implicit,r=u();return g(r.openSeguimientoModal(t.uid,t.userFullData.token,t.userFullData.id,t))}),o(15,"Seguimiento"),i()()()}if(l&2){let e=p.$implicit;s(2),h(" ",e.status," "),s(2),I(e.date),s(2),h(" ",e.displayName," "),s(2),h(" ",e.route.description," "),s(2),h(" ",e.typeRefund.name," "),s(2),m("ngIf",e.image)}}function wn(l,p){if(l&1&&(n(0,"div",33),o(1),i()),l&2){let e=u(2);s(),h(" ",e.errorMessage," ")}}function Tn(l,p){if(l&1){let e=V();n(0,"div",26)(1,"nz-card",27)(2,"div")(3,"strong"),o(4,"Cliente:"),i(),o(5),i(),n(6,"div")(7,"strong"),o(8,"Nombre:"),i(),o(9),i(),n(10,"div")(11,"strong"),o(12,"Email:"),i(),o(13),i(),n(14,"div")(15,"strong"),o(16,"Telefono:"),i(),o(17),i(),n(18,"div")(19,"strong"),o(20,"Telefono Alterno:"),i(),o(21),i(),n(22,"div")(23,"strong"),o(24,"Matricula:"),i(),o(25),i(),n(26,"div")(27,"strong"),o(28,"Ruta:"),i(),o(29),i(),n(30,"div")(31,"strong"),o(32,"Turno:"),i(),o(33),i()(),n(34,"nz-card",28)(35,"div")(36,"strong"),o(37,"Banco:"),i(),o(38),i(),n(39,"div")(40,"strong"),o(41,"Tarjeta o Clabe:"),i(),o(42),i(),n(43,"div")(44,"strong"),o(45,"Beneficiario:"),i(),o(46),i()(),n(47,"nz-card",29)(48,"nz-select",30),M("ngModelChange",function(t){f(e);let r=u();return N(r.selectedStatus,t)||(r.selectedStatus=t),g(t)}),S(49,"nz-option",14)(50,"nz-option",15)(51,"nz-option",16)(52,"nz-option",17),i(),n(53,"textarea",31),M("ngModelChange",function(t){f(e);let r=u();return N(r.response,t)||(r.response=t),g(t)}),o(54," "),i(),z(55,wn,2,1,"div",32),i()()}if(l&2){let e=u();s(5),h(" ",e.modalDataUser.customerName,""),s(4),h(" ",e.modalDataUser.displayName,""),s(4),h(" ",e.modalDataUser.email,""),s(4),h(" ",e.modalDataUser.phone,""),s(4),h(" ",e.modalDataUser.phoneAlternative,""),s(4),h(" ",e.modalDataUser.matricula,""),s(4),h(" ",e.modalDataUser.name,""),s(4),h(" ",e.modalDataUser.turn,""),s(5),h(" ",e.modalDataUser.bankCode,""),s(4),h(" ",e.modalDataUser.bankCode,""),s(4),h(" ",e.modalDataUser.benefit,""),s(2),P("ngModel",e.selectedStatus),s(5),P("ngModel",e.response),s(2),m("ngIf",e.errorMessage)}}function Dn(l,p){if(l&1){let e=V();n(0,"button",34),_("click",function(){f(e);let t=u();return g(t.closeProgramModal())}),o(1,"Cerrar"),i(),n(2,"button",34),_("click",function(){f(e);let t=u();return g(t.handleOk())}),o(3,"Enviar"),i()}}var Zr=(()=>{class l{constructor(e,a,t){this.afs=e,this.messageService=a,this.fb=t,this.programService=y(Pe),this.authService=y(Q),this.rolService=y(Te),this.routesService=y(ae),this.accountsService=y(Z),this.dashboardService=y(De),this.userService=y(ve),this.mfDataM=[],this.infoSegment=[],this.stopSubscription$=new A,this.infoLoad=[],this.customersList=[],this.selectedStatus=null,this.response=null,this.errorMessage=null,this.loadingData=!1,this.isSeguimientoVisible=!1,this.selectedDataUser=[],this.modalDataUser={},this.userCustomerId="",this.authService.user.subscribe(r=>{r&&(this.user=r,this.userCustomerId=this.user.customerId,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(d=>{this.infoLoad=d,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(w(this.stopSubscription$),v(d=>{let c=d.payload.id,x=d.payload.data();return C({id:c},x)}),k(d=>(this.infoSegment=d,this.getCustomersList(),d))).subscribe()))}),this.dateFilterForm=this.fb.group({selectedOption:[null],status:[]})}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}ngOnInit(){}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.afs.collection("customers").doc(this.userCustomerId).snapshotChanges().pipe(w(this.stopSubscription$),v(a=>{let t=a.payload.id,r=a.payload.data();return C({id:t},r)}),k(a=>(this.customersList=[a],a))).subscribe():this.afs.collection("customers",a=>a.orderBy("name")).snapshotChanges().pipe(w(this.stopSubscription$),v(a=>a.map(t=>{let r=t.payload.doc.id,d=t.payload.doc.data();return C({id:r},d)})),k(a=>(this.customersList=a,a))).subscribe()}sendMessage(e,a){this.messageService.create(e,a)}handleOk(){if(!this.selectedStatus||!this.response)this.errorMessage="Por favor, complete todos los campos antes de enviar.";else if(this.errorMessage=null,!this.selectedDataUser.token||!this.selectedDataUser.idDoc||!this.selectedDataUser.userUid||!this.selectedDataUser)this.errorMessage="Falta informaci\xF3n por cargar. Validar nuevamente.";else{let e=this.selectedDataUser.token||"";if(this.programService.updateTicketRefund(this.selectedDataUser.idDoc,this.selectedStatus),e){let a={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"El Ticket generado tiene un status de :"+this.selectedStatus,msg:this.response,requestId:"suhB7YFAh6PYXCRuJhfD",token:e,uid:this.selectedDataUser.userUid,email:this.selectedDataUser.email,title:"Apps And Informa General",body:this.response},t={timestamp:new Date,title:"El Ticket generado tiene un status de :"+this.selectedStatus,email:this.selectedDataUser.email,body:this.response,token:e,uid:this.selectedDataUser.userUid};this.dashboardService.setChatMessage(a),this.dashboardService.setMessage(t,this.selectedDataUser.userUid),this.isSeguimientoVisible=!1,this.response=""}else this.sendMessage("error","Token vacio :"+this.selectedDataUser.userUid+"// "+this.modalDataUser.customerName)}}openSeguimientoModal(e,a,t,r){this.isSeguimientoVisible=!0,r.userFullData.token==null&&(this.errorMessage="El usuario no cuenta con un token v\xE1lido para poder dar seguimiento."),this.modalDataUser={customerName:r.customer,displayName:r.displayName,benefit:r.benefit,bankCode:r.bankCode,phone:r.phone,matricula:r.matricula,phoneAlternative:r.phoneAlternative,email:r.email,token:r.userFullData.token,turn:r.turn,name:r.route.name,idDoc:r.idDoc,userUid:r.uid},this.selectedDataUser=this.modalDataUser}onDateChange(){if(!(this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1)){let e=this.dateFilterForm.get("selectedOption").value,a=this.dateFilterForm.get("status").value;e&&a?this.programService.getRefund(e,a).pipe(v(t=>t.map(r=>{let d=r.payload.doc.id,c=r.payload.doc.data();return C({id:d},c)}))).subscribe(t=>{t.length>0&&(this.mfDataM=t)}):this.sendMessage("error","Los criterios son requeridos para la busqueda")}}closeProgramModal(){this.isSeguimientoVisible=!1,this.modalDataUser={}}static{this.\u0275fac=function(a){return new(a||l)(O(X),O(Y),O(J))}}static{this.\u0275cmp=U({type:l,selectors:[["app-refaund"]],decls:51,vars:11,consts:[["basicTable1M",""],["modalContent1",""],["modalPassFooter1",""],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"body"],[2,"margin-bottom","10px",3,"formGroup"],["for","selectedOption",2,"width","150px"],["formControlName","selectedOption","nzPlaceHolder","Selecciona un cliente",2,"width","300px",3,"ngModelChange","ngModel"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["for","type",2,"width","150px","margin-top","10px"],["formControlName","status","nzAllowClear","","nzPlaceHolder","Selecciona un tipo de status",2,"width","350px"],["nzValue","Abierto","nzLabel","Abierto"],["nzValue","En Proceso","nzLabel","En Proceso"],["nzValue","Cerrado","nzLabel","Cerrado"],["nzValue","Cancelado","nzLabel","Cancelado"],["nz-button","","nzType","primary",2,"margin-left","5px","margin-top","10px","margin-bottom","10px",3,"click"],["nzTitle","Reembolso","ngSkipHydration","",3,"nzData","nzLoading","nzLoadingDelay"],[4,"ngFor","ngForOf"],["nzTitle","Seguimiento a Ticket",3,"nzVisibleChange","nzOnOk","nzOnCancel","nzVisible","nzContent","nzFooter"],["nzCustomContent","",3,"nzLabel","nzValue"],["target","_blank",3,"href",4,"ngIf"],[3,"click"],["target","_blank",3,"href"],[2,"background","#ECECEC","padding","30px"],["nzTitle","Datos Usuario"],["nzTitle","Datos Bancarios"],["nzTitle","Seguimiento"],["nzAllowClear","","nzPlaceHolder","Seleccione un estado",2,"width","100%","margin-bottom","15px",3,"ngModelChange","ngModel"],["rows","4","nz-input","","placeholder","Redactar Respuesta",2,"width","100%",3,"ngModelChange","ngModel"],["style","color: red; margin-top: 10px;",4,"ngIf"],[2,"color","red","margin-top","10px"],["nz-button","",3,"click"]],template:function(a,t){if(a&1){let r=V();n(0,"div",3)(1,"div",4)(2,"nz-page-header",5)(3,"nz-page-header-title",6),o(4,"Reembolso"),i(),n(5,"nz-page-header-subtitle"),o(6," Proceso "),i()()(),n(7,"div",7)(8,"div",8)(9,"div")(10,"label",9),o(11," Selecciona un Cliente: "),i(),n(12,"nz-select",10),M("ngModelChange",function(c){return f(r),N(t.selectedOption,c)||(t.selectedOption=c),g(c)}),z(13,In,2,3,"nz-option",11),i()(),n(14,"div")(15,"label",12),o(16," Status: "),i(),n(17,"nz-select",13),S(18,"nz-option",14)(19,"nz-option",15)(20,"nz-option",16)(21,"nz-option",17),i()()(),n(22,"div")(23,"a",18),_("click",function(){return f(r),g(t.onDateChange())}),o(24,"Cargar"),i()(),n(25,"div")(26,"nz-table",19,0)(28,"thead")(29,"tr")(30,"th"),o(31,"Status"),i(),n(32,"th"),o(33,"Fecha"),i(),n(34,"th"),o(35,"Usuario"),i(),n(36,"th"),o(37,"Ruta"),i(),n(38,"th"),o(39,"Tipo de Reembolso"),i(),n(40,"th"),o(41,"Referencia"),i(),n(42,"th"),o(43,"..."),i()()(),n(44,"tbody"),z(45,Vn,16,6,"tr",20),i()()()()(),n(46,"nz-modal",21),M("nzVisibleChange",function(c){return f(r),N(t.isSeguimientoVisible,c)||(t.isSeguimientoVisible=c),g(c)}),_("nzOnOk",function(){return f(r),g(t.handleOk())})("nzOnCancel",function(){return f(r),g(t.closeProgramModal())}),z(47,Tn,56,14,"ng-template",null,1,L)(49,Dn,4,0,"ng-template",null,2,L),i()}if(a&2){let r=E(27),d=E(48),c=E(50);s(2),m("nzGhost",!1),s(6),m("formGroup",t.dateFilterForm),s(4),P("ngModel",t.selectedOption),s(),m("ngForOf",t.customersList),s(13),m("nzData",t.mfDataM)("nzLoading",t.loadingData)("nzLoadingDelay",500),s(19),m("ngForOf",r.data),s(),P("nzVisible",t.isSeguimientoVisible),m("nzContent",d)("nzFooter",c)}},dependencies:[B,j,ge,de,oe,se,ce,le,me,we,ze,K,_e,Et,ie,ee,te,ne,re,$,q,H,W,G,We]})}}return l})();export{Xn as a,dr as b,Ir as c,Ar as d,Zr as e};
