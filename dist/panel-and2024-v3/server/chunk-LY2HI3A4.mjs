import './polyfills.server.mjs';
import{$ as me,$a as fi,A as qt,Aa as Ri,B as to,Ba as io,C as zm,Ca as ro,Cc as Ym,Db as Hm,Dd as Jm,E as xm,Eb as Bm,Fb as Tc,G as Di,Ga as Nm,Gb as Ec,H as Om,Ha as r4,J as Ks,Ja as Le,Jc as zc,K as yc,Ka as $,L as Im,La as bn,M as no,Ma as Cc,Na as so,O as wc,Oa as Br,Oc as Km,P as Am,Pa as Se,Pc as Qm,Q as n4,Qa as Pm,Qb as qr,R as Dm,Ra as Sc,Rb as mi,S as yn,Sa as Fr,T as hi,Tb as Fm,U as nl,Ub as qm,V as it,Va as kn,W as km,X as bc,Xa as jn,Ya as _n,Yc as Xm,Za as rl,Zc as xc,_ as Rm,_a as yt,a as lr,aa as we,ab as Nt,b as vn,ba as Ee,bc as Um,bd as Oc,c as bm,ca as D,cc as jm,d as ce,da as Ze,ea as Lm,fa as _c,g as _m,ga as ve,gd as Zm,h as gc,ha as di,hb as dr,hc as Wm,i as Cm,ia as be,j as Sm,ja as We,jb as fr,kb as mr,l as Hr,la as i4,lb as pr,m as J1,ma as Vm,mb as Ye,n as Un,nb as at,nc as Qs,nd as Ic,o as St,oa as wn,ob as It,oc as Cn,p as eo,pa as ur,pb as oo,pc as $m,pd as Sn,q as Ge,qa as hr,qb as ao,qd as Pe,r as Em,rd as ae,sa as il,sb as gr,sc as wt,sd as Tn,t as Mm,ta as ki,tc as Mc,td as Be,ua as $e,uc as Gm,ud as sl,va as Xt,vb as Wn,vd as ol,w as t4,xb as Zt,yb as s4,z as vc,zb as o4,zc as Tt}from"./chunk-BDHSFJ32.mjs";import{a as Tx,b as kc,c as ul,d as hl}from"./chunk-ZSFU6MES.mjs";import{c as Tm}from"./chunk-ARRJMVMP.mjs";import{A as Li,B as Dc,E as c4,H as rp,J as sp,K as Ur,L as cn,a as ep,d as al,e as tp,f as a4,m as cl,n as Ac,q as np,r as ip,t as ll,y as dt,z as Xs}from"./chunk-UCN5FFZS.mjs";import{a as Re,b as qn,c as He,f as k,h as el,i as tl,j as S}from"./chunk-H6KHSOBK.mjs";var Ve=k($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=$n.DEFAULT_MAX_SEND_MESSAGE_LENGTH=$n.Propagate=$n.LogVerbosity=$n.Status=void 0;var cp=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n}(cp||($n.Status=cp={})),lp=function(n){return n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.ERROR=2]="ERROR",n[n.NONE=3]="NONE",n}(lp||($n.LogVerbosity=lp={})),up=function(n){return n[n.DEADLINE=1]="DEADLINE",n[n.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",n[n.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",n[n.CANCELLATION=8]="CANCELLATION",n[n.DEFAULTS=65535]="DEFAULTS",n}(up||($n.Propagate=up={}));$n.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;$n.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var fl=k((rK,Ex)=>{Ex.exports={name:"@grpc/grpc-js",version:"1.9.15",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var bt=k(ln=>{"use strict";var ml,pl,gl,vl;Object.defineProperty(ln,"__esModule",{value:!0});ln.isTracerEnabled=ln.trace=ln.log=ln.setLoggerVerbosity=ln.setLogger=ln.getLogger=void 0;var Wr=Ve(),Mx=He("process"),zx=fl().version,xx={error:(n,...e)=>{console.error("E "+n,...e)},info:(n,...e)=>{console.error("I "+n,...e)},debug:(n,...e)=>{console.error("D "+n,...e)}},Zs=xx,co=Wr.LogVerbosity.ERROR,Ox=(pl=(ml=process.env.GRPC_NODE_VERBOSITY)!==null&&ml!==void 0?ml:process.env.GRPC_VERBOSITY)!==null&&pl!==void 0?pl:"";switch(Ox.toUpperCase()){case"DEBUG":co=Wr.LogVerbosity.DEBUG;break;case"INFO":co=Wr.LogVerbosity.INFO;break;case"ERROR":co=Wr.LogVerbosity.ERROR;break;case"NONE":co=Wr.LogVerbosity.NONE;break;default:}var Ix=()=>Zs;ln.getLogger=Ix;var Ax=n=>{Zs=n};ln.setLogger=Ax;var Dx=n=>{co=n};ln.setLoggerVerbosity=Dx;var kx=(n,...e)=>{let t;if(n>=co){switch(n){case Wr.LogVerbosity.DEBUG:t=Zs.debug;break;case Wr.LogVerbosity.INFO:t=Zs.info;break;case Wr.LogVerbosity.ERROR:t=Zs.error;break}t||(t=Zs.error),t&&t.bind(Zs)(...e)}};ln.log=kx;var Rx=(vl=(gl=process.env.GRPC_NODE_TRACE)!==null&&gl!==void 0?gl:process.env.GRPC_TRACE)!==null&&vl!==void 0?vl:"",yl=new Set,hp=new Set;for(let n of Rx.split(","))n.startsWith("-")?hp.add(n.substring(1)):yl.add(n);var Lx=yl.has("all");function Vx(n,e,t){dp(e)&&(0,ln.log)(n,new Date().toISOString()+" | v"+zx+" "+Mx.pid+" | "+e+" | "+t)}ln.trace=Vx;function dp(n){return!hp.has(n)&&(Lx||yl.has(n))}ln.isTracerEnabled=dp});var Rc=k(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});lo.getErrorCode=lo.getErrorMessage=void 0;function Nx(n){return n instanceof Error?n.message:String(n)}lo.getErrorMessage=Nx;function Px(n){return typeof n=="object"&&n!==null&&"code"in n&&typeof n.code=="number"?n.code:null}lo.getErrorCode=Px});var En=k(Vc=>{"use strict";Object.defineProperty(Vc,"__esModule",{value:!0});Vc.Metadata=void 0;var Hx=bt(),Bx=Ve(),Fx=Rc(),qx=/^[0-9a-z_.-]+$/,Ux=/^[ -~]*$/;function jx(n){return qx.test(n)}function Wx(n){return Ux.test(n)}function mp(n){return n.endsWith("-bin")}function $x(n){return!n.startsWith("grpc-")}function Lc(n){return n.toLowerCase()}function fp(n,e){if(!jx(n))throw new Error('Metadata key "'+n+'" contains illegal characters');if(e!=null)if(mp(n)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!Wx(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var wl=class n{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){e=Lc(e),fp(e,t),this.internalRepr.set(e,[t])}add(e,t){e=Lc(e),fp(e,t);let i=this.internalRepr.get(e);i===void 0?this.internalRepr.set(e,[t]):i.push(t)}remove(e){e=Lc(e),this.internalRepr.delete(e)}get(e){return e=Lc(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,i]of this.internalRepr)if(i.length>0){let r=i[0];e[t]=Buffer.isBuffer(r)?Buffer.from(r):r}return e}clone(){let e=new n(this.options),t=e.internalRepr;for(let[i,r]of this.internalRepr){let s=r.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);t.set(i,s)}return e}merge(e){for(let[t,i]of e.internalRepr){let r=(this.internalRepr.get(t)||[]).concat(i);this.internalRepr.set(t,r)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,i]of this.internalRepr)e[t]=i.map(Gx);return e}toJSON(){let e={};for(let[t,i]of this.internalRepr)e[t]=i;return e}static fromHttp2Headers(e){let t=new n;for(let i of Object.keys(e)){if(i.charAt(0)===":")continue;let r=e[i];try{mp(i)?Array.isArray(r)?r.forEach(s=>{t.add(i,Buffer.from(s,"base64"))}):r!==void 0&&($x(i)?r.split(",").forEach(s=>{t.add(i,Buffer.from(s.trim(),"base64"))}):t.add(i,Buffer.from(r,"base64"))):Array.isArray(r)?r.forEach(s=>{t.add(i,s)}):r!==void 0&&t.add(i,r)}catch(s){let o=`Failed to add metadata entry ${i}: ${r}. ${(0,Fx.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,Hx.log)(Bx.LogVerbosity.ERROR,o)}}return t}};Vc.Metadata=wl;var Gx=n=>Buffer.isBuffer(n)?n.toString("base64"):n});var Tl=k(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.CallCredentials=void 0;var Sl=En();function Yx(n){return"getRequestHeaders"in n&&typeof n.getRequestHeaders=="function"}var uo=class n{static createFromMetadataGenerator(e){return new _l(e)}static createFromGoogleCredential(e){return n.createFromMetadataGenerator((t,i)=>{let r;Yx(e)?r=e.getRequestHeaders(t.service_url):r=new Promise((s,o)=>{e.getRequestMetadata(t.service_url,(a,c)=>{if(a){o(a);return}if(!c){o(new Error("Headers not set by metadata plugin"));return}s(c)})}),r.then(s=>{let o=new Sl.Metadata;for(let a of Object.keys(s))o.add(a,s[a]);i(null,o)},s=>{i(s)})})}static createEmpty(){return new Cl}};Nc.CallCredentials=uo;var bl=class n extends uo{constructor(e){super(),this.creds=e}generateMetadata(e){return S(this,null,function*(){let t=new Sl.Metadata,i=yield Promise.all(this.creds.map(r=>r.generateMetadata(e)));for(let r of i)t.merge(r);return t})}compose(e){return new n(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof n?this.creds.every((t,i)=>t._equals(e.creds[i])):!1}},_l=class n extends uo{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,i)=>{this.metadataGenerator(e,(r,s)=>{s!==void 0?t(s):i(r)})})}compose(e){return new bl([this,e])}_equals(e){return this===e?!0:e instanceof n?this.metadataGenerator===e.metadataGenerator:!1}},Cl=class n extends uo{generateMetadata(e){return Promise.resolve(new Sl.Metadata)}compose(e){return e}_equals(e){return e instanceof n}}});var Ml=k(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.getDefaultRootsData=ho.CIPHER_SUITES=void 0;var Kx=He("fs");ho.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var pp=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,El=null;function Qx(){return pp?(El===null&&(El=Kx.readFileSync(pp)),El):null}ho.getDefaultRootsData=Qx});var Bc=k(Hc=>{"use strict";Object.defineProperty(Hc,"__esModule",{value:!0});Hc.ChannelCredentials=void 0;var Xx=He("tls"),Zx=Tl(),gp=Ml();function zl(n,e){if(n&&!(n instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var fo=class{constructor(e){this.callCredentials=e||Zx.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,i,r){var s;if(zl(e,"Root certificate"),zl(t,"Private key"),zl(i,"Certificate chain"),t&&!i)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&i)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,Xx.createSecureContext)({ca:(s=e??(0,gp.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:t??void 0,cert:i??void 0,ciphers:gp.CIPHER_SUITES});return new Pc(o,r??{})}static createFromSecureContext(e,t){return new Pc(e,t??{})}static createInsecure(){return new xl}};Hc.ChannelCredentials=fo;var xl=class n extends fo{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof n}},Pc=class n extends fo{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},t?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){let t=this.callCredentials.compose(e);return new Ol(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},Ol=class n extends fo{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new n(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var Gr=k(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.validateLoadBalancingConfig=Jt.getFirstUsableConfig=Jt.isLoadBalancerNameRegistered=Jt.createLoadBalancer=Jt.registerDefaultLoadBalancerType=Jt.registerLoadBalancerType=Jt.createChildChannelControlHelper=void 0;function Jx(n,e){var t,i,r,s,o,a,c,l,u,h;return{createSubchannel:(i=(t=e.createSubchannel)===null||t===void 0?void 0:t.bind(e))!==null&&i!==void 0?i:n.createSubchannel.bind(n),updateState:(s=(r=e.updateState)===null||r===void 0?void 0:r.bind(e))!==null&&s!==void 0?s:n.updateState.bind(n),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:n.requestReresolution.bind(n),addChannelzChild:(l=(c=e.addChannelzChild)===null||c===void 0?void 0:c.bind(e))!==null&&l!==void 0?l:n.addChannelzChild.bind(n),removeChannelzChild:(h=(u=e.removeChannelzChild)===null||u===void 0?void 0:u.bind(e))!==null&&h!==void 0?h:n.removeChannelzChild.bind(n)}}Jt.createChildChannelControlHelper=Jx;var $r={},Il=null;function eO(n,e,t){$r[n]={LoadBalancer:e,LoadBalancingConfig:t}}Jt.registerLoadBalancerType=eO;function tO(n){Il=n}Jt.registerDefaultLoadBalancerType=tO;function nO(n,e){let t=n.getLoadBalancerName();return t in $r?new $r[t].LoadBalancer(e):null}Jt.createLoadBalancer=nO;function iO(n){return n in $r}Jt.isLoadBalancerNameRegistered=iO;function rO(n,e=!1){for(let t of n)if(t.getLoadBalancerName()in $r)return t;return e&&Il?new $r[Il].LoadBalancingConfig:null}Jt.getFirstUsableConfig=rO;function sO(n){if(!(n!==null&&typeof n=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(n);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let t=e[0];if(t in $r)return $r[t].LoadBalancingConfig.createFromJson(n[t]);throw new Error(`Unrecognized load balancing config name ${t}`)}Jt.validateLoadBalancingConfig=sO});var Al=k(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.extractAndSelectServiceConfig=Yr.validateServiceConfig=Yr.validateRetryThrottling=void 0;var oO=He("os"),Fc=Ve(),aO=Gr(),qc=/^\d+(\.\d{1,9})?s$/,cO="node";function lO(n){if("service"in n&&n.service!==""){if(typeof n.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof n.service}`);if("method"in n&&n.method!==""){if(typeof n.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof n.service}`);return{service:n.service,method:n.method}}else return{service:n.service}}else{if("method"in n&&n.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function uO(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in n)||typeof n.initialBackoff!="string"||!qc.test(n.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in n)||typeof n.maxBackoff!="string"||!qc.test(n.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in n)||typeof n.backoffMultiplier!="number"||n.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in n&&Array.isArray(n.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(n.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of n.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(Fc.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(Fc.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:n.maxAttempts,initialBackoff:n.initialBackoff,maxBackoff:n.maxBackoff,backoffMultiplier:n.backoffMultiplier,retryableStatusCodes:n.retryableStatusCodes}}function hO(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in n&&(typeof n.hedgingDelay!="string"||!qc.test(n.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in n&&Array.isArray(n.nonFatalStatusCodes))for(let t of n.nonFatalStatusCodes)if(typeof t=="number"){if(!Object.values(Fc.Status).includes(t))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof t=="string"){if(!Object.values(Fc.Status).includes(t.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:n.maxAttempts};return n.hedgingDelay&&(e.hedgingDelay=n.hedgingDelay),n.nonFatalStatusCodes&&(e.nonFatalStatusCodes=n.nonFatalStatusCodes),e}function dO(n){var e;let t={name:[]};if(!("name"in n)||!Array.isArray(n.name))throw new Error("Invalid method config: invalid name array");for(let i of n.name)t.name.push(lO(i));if("waitForReady"in n){if(typeof n.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");t.waitForReady=n.waitForReady}if("timeout"in n)if(typeof n.timeout=="object"){if(!("seconds"in n.timeout)||typeof n.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in n.timeout)||typeof n.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");t.timeout=n.timeout}else if(typeof n.timeout=="string"&&qc.test(n.timeout)){let i=n.timeout.substring(0,n.timeout.length-1).split(".");t.timeout={seconds:i[0]|0,nanos:((e=i[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in n){if(typeof n.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxRequestBytes=n.maxRequestBytes}if("maxResponseBytes"in n){if(typeof n.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxResponseBytes=n.maxResponseBytes}if("retryPolicy"in n){if("hedgingPolicy"in n)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");t.retryPolicy=uO(n.retryPolicy)}else"hedgingPolicy"in n&&(t.hedgingPolicy=hO(n.hedgingPolicy));return t}function vp(n){if(!("maxTokens"in n)||typeof n.maxTokens!="number"||n.maxTokens<=0||n.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in n)||typeof n.tokenRatio!="number"||n.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+n.maxTokens.toFixed(3),tokenRatio:+n.tokenRatio.toFixed(3)}}Yr.validateRetryThrottling=vp;function yp(n){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in n)if(typeof n.loadBalancingPolicy=="string")e.loadBalancingPolicy=n.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in n)if(Array.isArray(n.loadBalancingConfig))for(let i of n.loadBalancingConfig)e.loadBalancingConfig.push((0,aO.validateLoadBalancingConfig)(i));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in n&&Array.isArray(n.methodConfig))for(let i of n.methodConfig)e.methodConfig.push(dO(i));"retryThrottling"in n&&(e.retryThrottling=vp(n.retryThrottling));let t=[];for(let i of e.methodConfig)for(let r of i.name){for(let s of t)if(r.service===s.service&&r.method===s.method)throw new Error(`Invalid service config: duplicate name ${r.service}/${r.method}`);t.push(r)}return e}Yr.validateServiceConfig=yp;function fO(n){if(!("serviceConfig"in n))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:yp(n.serviceConfig)};if("clientLanguage"in n)if(Array.isArray(n.clientLanguage)){e.clientLanguage=[];for(let i of n.clientLanguage)if(typeof i=="string")e.clientLanguage.push(i);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in n)if(Array.isArray(n.clientHostname)){e.clientHostname=[];for(let i of n.clientHostname)if(typeof i=="string")e.clientHostname.push(i);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in n)if(typeof n.percentage=="number"&&0<=n.percentage&&n.percentage<=100)e.percentage=n.percentage;else throw new Error("Invalid service config choice: invalid percentage");let t=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let i in n)if(!t.includes(i))throw new Error(`Invalid service config choice: unexpected field ${i}`);return e}function mO(n,e){if(!Array.isArray(n))throw new Error("Invalid service config list");for(let t of n){let i=fO(t);if(!(typeof i.percentage=="number"&&e>i.percentage)){if(Array.isArray(i.clientHostname)){let r=!1;for(let s of i.clientHostname)s===oO.hostname()&&(r=!0);if(!r)continue}if(Array.isArray(i.clientLanguage)){let r=!1;for(let s of i.clientLanguage)s===cO&&(r=!0);if(!r)continue}return i.serviceConfig}}throw new Error("No matching service config found")}function pO(n,e){for(let t of n)if(t.length>0&&t[0].startsWith("grpc_config=")){let i=t.join("").substring(12),r=JSON.parse(i);return mO(r,e)}return null}Yr.extractAndSelectServiceConfig=pO});var Gn=k(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});Uc.ConnectivityState=void 0;var wp=function(n){return n[n.IDLE=0]="IDLE",n[n.CONNECTING=1]="CONNECTING",n[n.READY=2]="READY",n[n.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",n[n.SHUTDOWN=4]="SHUTDOWN",n}(wp||(Uc.ConnectivityState=wp={}))});var Rn=k(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.uriToString=Kr.splitHostPort=Kr.parseUri=void 0;var gO=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function vO(n){let e=gO.exec(n);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}Kr.parseUri=vO;var bp=/^\d+$/;function yO(n){if(n.startsWith("[")){let e=n.indexOf("]");if(e===-1)return null;let t=n.substring(1,e);if(t.indexOf(":")===-1)return null;if(n.length>e+1)if(n[e+1]===":"){let i=n.substring(e+2);return bp.test(i)?{host:t,port:+i}:null}else return null;else return{host:t}}else{let e=n.split(":");return e.length===2?bp.test(e[1])?{host:e[0],port:+e[1]}:null:{host:n}}}Kr.splitHostPort=yO;function wO(n){let e="";return n.scheme!==void 0&&(e+=n.scheme+":"),n.authority!==void 0&&(e+="//"+n.authority+"/"),e+=n.path,e}Kr.uriToString=wO});var Vi=k(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.mapUriDefaultScheme=Yn.getDefaultAuthority=Yn.createResolver=Yn.registerDefaultScheme=Yn.registerResolver=void 0;var kl=Rn(),mo={},Dl=null;function bO(n,e){mo[n]=e}Yn.registerResolver=bO;function _O(n){Dl=n}Yn.registerDefaultScheme=_O;function CO(n,e,t){if(n.scheme!==void 0&&n.scheme in mo)return new mo[n.scheme](n,e,t);throw new Error(`No resolver could be created for target ${(0,kl.uriToString)(n)}`)}Yn.createResolver=CO;function SO(n){if(n.scheme!==void 0&&n.scheme in mo)return mo[n.scheme].getDefaultAuthority(n);throw new Error(`Invalid target ${(0,kl.uriToString)(n)}`)}Yn.getDefaultAuthority=SO;function TO(n){return n.scheme===void 0||!(n.scheme in mo)?Dl!==null?{scheme:Dl,authority:void 0,path:(0,kl.uriToString)(n)}:null:n}Yn.mapUriDefaultScheme=TO});var Xr=k(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.QueuePicker=Qr.UnavailablePicker=Qr.PickResultType=void 0;var EO=En(),MO=Ve(),jc=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.QUEUE=1]="QUEUE",n[n.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",n[n.DROP=3]="DROP",n}(jc||(Qr.PickResultType=jc={})),Rl=class{constructor(e){this.status=Object.assign({code:MO.Status.UNAVAILABLE,details:"No connection established",metadata:new EO.Metadata},e)}pick(e){return{pickResultType:jc.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};Qr.UnavailablePicker=Rl;var Ll=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:jc.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};Qr.QueuePicker=Ll});var l4=k(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.BackoffTimeout=void 0;var zO=1e3,xO=1.6,OO=12e4,IO=.2;function AO(n,e){return Math.random()*(e-n)+n}var Vl=class{constructor(e,t){this.callback=e,this.initialDelay=zO,this.multiplier=xO,this.maxDelay=OO,this.jitter=IO,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,i;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(i=(t=this.timerId).unref)===null||i===void 0||i.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+AO(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,(t=(e=this.timerId).ref)===null||t===void 0||t.call(e)}unref(){var e,t;this.hasRef=!1,(t=(e=this.timerId).unref)===null||t===void 0||t.call(e)}getEndTime(){return this.endTime}};Wc.BackoffTimeout=Vl});var Gc=k($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.ChildLoadBalancerHandler=void 0;var DO=Gr(),kO=Gn(),RO="child_load_balancer_helper",Nl=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,i){return this.parent.channelControlHelper.createSubchannel(t,i)}updateState(t,i){var r;if(this.calledByPendingChild()){if(t===kO.ConnectivityState.CONNECTING)return;(r=this.parent.currentChild)===null||r===void 0||r.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,i)}requestReresolution(){var t;let i=(t=this.parent.pendingChild)!==null&&t!==void 0?t:this.parent.currentChild;this.child===i&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,i){let r;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let s=new this.ChildPolicyHelper(this),o=(0,DO.createLoadBalancer)(t,s);s.setChild(o),this.currentChild===null?(this.currentChild=o,r=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,r=this.pendingChild)}else this.pendingChild===null?r=this.currentChild:r=this.pendingChild;this.latestConfig=t,r.updateAddressList(e,t,i)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return RO}};$c.ChildLoadBalancerHandler=Nl});var Cp=k(Yc=>{"use strict";Object.defineProperty(Yc,"__esModule",{value:!0});Yc.ResolvingLoadBalancer=void 0;var LO=Gr(),VO=Al(),Mn=Gn(),NO=Vi(),po=Xr(),PO=l4(),Pl=Ve(),HO=En(),BO=bt(),FO=Ve(),qO=Rn(),UO=Gc(),jO="resolving_load_balancer";function _p(n){BO.trace(FO.LogVerbosity.DEBUG,jO,n)}var WO=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function $O(n,e,t,i){for(let r of t.name)switch(i){case"EMPTY":if(!r.service&&!r.method)return!0;break;case"SERVICE":if(r.service===n&&!r.method)return!0;break;case"SERVICE_AND_METHOD":if(r.service===n&&r.method===e)return!0}return!1}function GO(n,e,t,i){for(let r of t)if($O(n,e,r,i))return r;return null}function YO(n){return function(t,i){var r,s;let o=t.split("/").filter(l=>l.length>0),a=(r=o[0])!==null&&r!==void 0?r:"",c=(s=o[1])!==null&&s!==void 0?s:"";if(n&&n.methodConfig)for(let l of WO){let u=GO(a,c,n.methodConfig,l);if(u)return{methodConfig:u,pickInformation:{},status:Pl.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:Pl.Status.OK,dynamicFilterFactories:[]}}}var Hl=class{constructor(e,t,i,r,s){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=r,this.onFailedResolution=s,this.latestChildState=Mn.ConnectivityState.IDLE,this.latestChildPicker=new po.QueuePicker(this),this.currentState=Mn.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,i["grpc.service_config"]?this.defaultServiceConfig=(0,VO.validateServiceConfig)(JSON.parse(i["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(Mn.ConnectivityState.IDLE,new po.QueuePicker(this)),this.childLoadBalancer=new UO.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(_p("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,c)=>{this.latestChildState=a,this.latestChildPicker=c,this.updateState(a,c)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,NO.createResolver)(e,{onSuccessfulResolution:(a,c,l,u,h)=>{var d;this.backoffTimeout.stop(),this.backoffTimeout.reset();let g=null;c===null?l===null?(this.previousServiceConfig=null,g=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(l):g=this.previousServiceConfig:(g=c,this.previousServiceConfig=c);let _=(d=g?.loadBalancingConfig)!==null&&d!==void 0?d:[],T=(0,LO.getFirstUsableConfig)(_,!0);if(T===null){this.handleResolutionFailure({code:Pl.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new HO.Metadata});return}this.childLoadBalancer.updateAddressList(a,T,h);let E=g??this.defaultServiceConfig;this.onSuccessfulResolution(E,u??YO(E))},onError:a=>{this.handleResolutionFailure(a)}},i);let o={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new PO.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===Mn.ConnectivityState.IDLE&&this.updateState(Mn.ConnectivityState.CONNECTING,new po.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){_p((0,qO.uriToString)(this.target)+" "+Mn.ConnectivityState[this.currentState]+" -> "+Mn.ConnectivityState[e]),e===Mn.ConnectivityState.IDLE&&(t=new po.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===Mn.ConnectivityState.IDLE&&(this.updateState(Mn.ConnectivityState.TRANSIENT_FAILURE,new po.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===Mn.ConnectivityState.IDLE||this.currentState===Mn.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=Mn.ConnectivityState.IDLE,this.latestChildPicker=new po.QueuePicker(this),this.currentState=Mn.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};Yc.ResolvingLoadBalancer=Hl});var Sp=k(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.channelOptionsEqual=go.recognizedOptions=void 0;go.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function KO(n,e){let t=Object.keys(n).sort(),i=Object.keys(e).sort();if(t.length!==i.length)return!1;for(let r=0;r<t.length;r+=1)if(t[r]!==i[r]||n[t[r]]!==e[i[r]])return!1;return!0}go.channelOptionsEqual=KO});var Pi=k(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.stringToSubchannelAddress=Ni.subchannelAddressToString=Ni.subchannelAddressEqual=Ni.isTcpSubchannelAddress=void 0;var QO=He("net");function u4(n){return"port"in n}Ni.isTcpSubchannelAddress=u4;function XO(n,e){return!n&&!e?!0:!n||!e?!1:u4(n)?u4(e)&&n.host===e.host&&n.port===e.port:!u4(e)&&n.path===e.path}Ni.subchannelAddressEqual=XO;function ZO(n){return u4(n)?n.host+":"+n.port:n.path}Ni.subchannelAddressToString=ZO;var JO=443;function eI(n,e){return(0,QO.isIP)(n)?{host:n,port:e??JO}:{path:n}}Ni.stringToSubchannelAddress=eI});var Kc=k(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.addAdminServicesToServer=vo.registerAdminService=void 0;var Tp=[];function tI(n,e){Tp.push({getServiceDefinition:n,getHandlers:e})}vo.registerAdminService=tI;function nI(n){for(let{getServiceDefinition:e,getHandlers:t}of Tp)n.addService(e(),t())}vo.addAdminServicesToServer=nI});var Ep=k(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.ClientDuplexStreamImpl=Kn.ClientWritableStreamImpl=Kn.ClientReadableStreamImpl=Kn.ClientUnaryCallImpl=Kn.callErrorFromStatus=void 0;var iI=He("events"),jl=He("stream"),h4=Ve();function rI(n,e){let t=`${n.code} ${h4.Status[n.code]}: ${n.details}`,r=`${new Error(t).stack}
for call at
${e}`;return Object.assign(new Error(t),n,{stack:r})}Kn.callErrorFromStatus=rI;var Bl=class extends iI.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(h4.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}};Kn.ClientUnaryCallImpl=Bl;var Fl=class extends jl.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(h4.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}};Kn.ClientReadableStreamImpl=Fl;var ql=class extends jl.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(h4.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,i){var r;let s={callback:i},o=Number(t);Number.isNaN(o)||(s.flags=o),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};Kn.ClientWritableStreamImpl=ql;var Ul=class extends jl.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(h4.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}_write(e,t,i){var r;let s={callback:i},o=Number(t);Number.isNaN(o)||(s.flags=o),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};Kn.ClientDuplexStreamImpl=Ul});var Mp=k(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.InterceptingListenerImpl=yo.isInterceptingListener=void 0;function sI(n){return n.onReceiveMetadata!==void 0&&n.onReceiveMetadata.length===1}yo.isInterceptingListener=sI;var Wl=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,t=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(t),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,t=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=t,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(t),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,t=>{this.processingMetadata||this.processingMessage?this.pendingStatus=t:this.nextListener.onReceiveStatus(t)})}};yo.InterceptingListenerImpl=Wl});var Zl=k(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});Qn.getInterceptingCall=Qn.InterceptingCall=Qn.RequesterBuilder=Qn.ListenerBuilder=Qn.InterceptorConfigurationError=void 0;var oI=En(),zp=Mp(),xp=Ve(),Op=Rc(),f4=class n extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,n)}};Qn.InterceptorConfigurationError=f4;var Gl=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};Qn.ListenerBuilder=Gl;var Yl=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};Qn.RequesterBuilder=Yl;var $l={onReceiveMetadata:(n,e)=>{e(n)},onReceiveMessage:(n,e)=>{e(n)},onReceiveStatus:(n,e)=>{e(n)}},d4={start:(n,e,t)=>{t(n,e)},sendMessage:(n,e)=>{e(n)},halfClose:n=>{n()},cancel:n=>{n()}},Kl=class{constructor(e,t){var i,r,s,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:(i=t.start)!==null&&i!==void 0?i:d4.start,sendMessage:(r=t.sendMessage)!==null&&r!==void 0?r:d4.sendMessage,halfClose:(s=t.halfClose)!==null&&s!==void 0?s:d4.halfClose,cancel:(o=t.cancel)!==null&&o!==void 0?o:d4.cancel}:this.requester=d4}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var i,r,s,o,a,c;let l={onReceiveMetadata:(r=(i=t?.onReceiveMetadata)===null||i===void 0?void 0:i.bind(t))!==null&&r!==void 0?r:u=>{},onReceiveMessage:(o=(s=t?.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&o!==void 0?o:u=>{},onReceiveStatus:(c=(a=t?.onReceiveStatus)===null||a===void 0?void 0:a.bind(t))!==null&&c!==void 0?c:u=>{}};this.processingMetadata=!0,this.requester.start(e,l,(u,h)=>{var d,g,_;this.processingMetadata=!1;let T;if((0,zp.isInterceptingListener)(h))T=h;else{let E={onReceiveMetadata:(d=h.onReceiveMetadata)!==null&&d!==void 0?d:$l.onReceiveMetadata,onReceiveMessage:(g=h.onReceiveMessage)!==null&&g!==void 0?g:$l.onReceiveMessage,onReceiveStatus:(_=h.onReceiveStatus)!==null&&_!==void 0?_:$l.onReceiveStatus};T=new zp.InterceptingListenerImpl(E,l)}this.nextCall.start(u,T),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,i=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,i),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};Qn.InterceptingCall=Kl;function aI(n,e,t){var i,r;let s=(i=t.deadline)!==null&&i!==void 0?i:1/0,o=t.host,a=(r=t.parent)!==null&&r!==void 0?r:null,c=t.propagate_flags,l=t.credentials,u=n.createCall(e,s,o,a,c);return l&&u.setCredentials(l),u}var Qc=class{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let i;try{i=this.methodDefinition.requestSerialize(t)}catch(r){this.call.cancelWithStatus(xp.Status.INTERNAL,`Request message serialization failure: ${(0,Op.getErrorMessage)(r)}`);return}this.call.sendMessageWithContext(e,i)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let i=null;this.call.start(e,{onReceiveMetadata:r=>{var s;(s=t?.onReceiveMetadata)===null||s===void 0||s.call(t,r)},onReceiveMessage:r=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(r)}catch(a){i={code:xp.Status.INTERNAL,details:`Response message parsing error: ${(0,Op.getErrorMessage)(a)}`,metadata:new oI.Metadata},this.call.cancelWithStatus(i.code,i.details);return}(s=t?.onReceiveMessage)===null||s===void 0||s.call(t,o)},onReceiveStatus:r=>{var s,o;i?(s=t?.onReceiveStatus)===null||s===void 0||s.call(t,i):(o=t?.onReceiveStatus)===null||o===void 0||o.call(t,r)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},Ql=class extends Qc{constructor(e,t){super(e,t)}start(e,t){var i,r;let s=!1,o={onReceiveMetadata:(r=(i=t?.onReceiveMetadata)===null||i===void 0?void 0:i.bind(t))!==null&&r!==void 0?r:a=>{},onReceiveMessage:a=>{var c;s=!0,(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,a)},onReceiveStatus:a=>{var c,l;s||(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,null),(l=t?.onReceiveStatus)===null||l===void 0||l.call(t,a)}};super.start(e,o),this.call.startRead()}},Xl=class extends Qc{};function cI(n,e,t){let i=aI(n,t.path,e);return t.responseStream?new Xl(i,t):new Ql(i,t)}function lI(n,e,t,i){if(n.clientInterceptors.length>0&&n.clientInterceptorProviders.length>0)throw new f4("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(n.callInterceptors.length>0&&n.callInterceptorProviders.length>0)throw new f4("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let r=[];n.callInterceptors.length>0||n.callInterceptorProviders.length>0?r=[].concat(n.callInterceptors,n.callInterceptorProviders.map(a=>a(e))).filter(a=>a):r=[].concat(n.clientInterceptors,n.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let s=Object.assign({},t,{method_definition:e});return r.reduceRight((a,c)=>l=>c(l,a),a=>cI(i,a,e))(s)}Qn.getInterceptingCall=lI});var tu=k(Zc=>{"use strict";Object.defineProperty(Zc,"__esModule",{value:!0});Zc.Client=void 0;var Hi=Ep(),uI=nu(),hI=Gn(),Zr=Ve(),wo=En(),Xc=Zl(),pi=Symbol(),bo=Symbol(),_o=Symbol(),vr=Symbol();function Jl(n){return typeof n=="function"}function Co(n){return n.stack.split(`
`).slice(1).join(`
`)}var eu=class{constructor(e,t,i={}){var r,s;if(i=Object.assign({},i),this[bo]=(r=i.interceptors)!==null&&r!==void 0?r:[],delete i.interceptors,this[_o]=(s=i.interceptor_providers)!==null&&s!==void 0?s:[],delete i.interceptor_providers,this[bo].length>0&&this[_o].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[vr]=i.callInvocationTransformer,delete i.callInvocationTransformer,i.channelOverride)this[pi]=i.channelOverride;else if(i.channelFactoryOverride){let o=i.channelFactoryOverride;delete i.channelFactoryOverride,this[pi]=o(e,t,i)}else this[pi]=new uI.ChannelImplementation(e,t,i)}close(){this[pi].close()}getChannel(){return this[pi]}waitForReady(e,t){let i=r=>{if(r){t(new Error("Failed to connect before the deadline"));return}let s;try{s=this[pi].getConnectivityState(!0)}catch{t(new Error("The channel has been closed"));return}if(s===hI.ConnectivityState.READY)t();else try{this[pi].watchConnectivityState(s,e,i)}catch{t(new Error("The channel has been closed"))}};setImmediate(i)}checkOptionalUnaryResponseArguments(e,t,i){if(Jl(e))return{metadata:new wo.Metadata,options:{},callback:e};if(Jl(t))return e instanceof wo.Metadata?{metadata:e,options:{},callback:t}:{metadata:new wo.Metadata,options:e,callback:t};if(!(e instanceof wo.Metadata&&t instanceof Object&&Jl(i)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:i}}makeUnaryRequest(e,t,i,r,s,o,a){var c,l;let u=this.checkOptionalUnaryResponseArguments(s,o,a),h={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:i},d={argument:r,metadata:u.metadata,call:new Hi.ClientUnaryCallImpl,channel:this[pi],methodDefinition:h,callOptions:u.options,callback:u.callback};this[vr]&&(d=this[vr](d));let g=d.call,_={clientInterceptors:this[bo],clientInterceptorProviders:this[_o],callInterceptors:(c=d.callOptions.interceptors)!==null&&c!==void 0?c:[],callInterceptorProviders:(l=d.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},T=(0,Xc.getInterceptingCall)(_,d.methodDefinition,d.callOptions,d.channel);g.call=T;let E=null,L=!1,x=new Error;return T.start(d.metadata,{onReceiveMetadata:V=>{g.emit("metadata",V)},onReceiveMessage(V){E!==null&&T.cancelWithStatus(Zr.Status.INTERNAL,"Too many responses received"),E=V},onReceiveStatus(V){if(!L){if(L=!0,V.code===Zr.Status.OK)if(E===null){let P=Co(x);d.callback((0,Hi.callErrorFromStatus)({code:Zr.Status.INTERNAL,details:"No message received",metadata:V.metadata},P))}else d.callback(null,E);else{let P=Co(x);d.callback((0,Hi.callErrorFromStatus)(V,P))}x=null,g.emit("status",V)}}}),T.sendMessage(r),T.halfClose(),g}makeClientStreamRequest(e,t,i,r,s,o){var a,c;let l=this.checkOptionalUnaryResponseArguments(r,s,o),u={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:i},h={metadata:l.metadata,call:new Hi.ClientWritableStreamImpl(t),channel:this[pi],methodDefinition:u,callOptions:l.options,callback:l.callback};this[vr]&&(h=this[vr](h));let d=h.call,g={clientInterceptors:this[bo],clientInterceptorProviders:this[_o],callInterceptors:(a=h.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=h.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},_=(0,Xc.getInterceptingCall)(g,h.methodDefinition,h.callOptions,h.channel);d.call=_;let T=null,E=!1,L=new Error;return _.start(h.metadata,{onReceiveMetadata:x=>{d.emit("metadata",x)},onReceiveMessage(x){T!==null&&_.cancelWithStatus(Zr.Status.INTERNAL,"Too many responses received"),T=x},onReceiveStatus(x){if(!E){if(E=!0,x.code===Zr.Status.OK)if(T===null){let V=Co(L);h.callback((0,Hi.callErrorFromStatus)({code:Zr.Status.INTERNAL,details:"No message received",metadata:x.metadata},V))}else h.callback(null,T);else{let V=Co(L);h.callback((0,Hi.callErrorFromStatus)(x,V))}L=null,d.emit("status",x)}}}),d}checkMetadataAndOptions(e,t){let i,r;return e instanceof wo.Metadata?(i=e,t?r=t:r={}):(e?r=e:r={},i=new wo.Metadata),{metadata:i,options:r}}makeServerStreamRequest(e,t,i,r,s,o){var a,c;let l=this.checkMetadataAndOptions(s,o),u={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:i},h={argument:r,metadata:l.metadata,call:new Hi.ClientReadableStreamImpl(i),channel:this[pi],methodDefinition:u,callOptions:l.options};this[vr]&&(h=this[vr](h));let d=h.call,g={clientInterceptors:this[bo],clientInterceptorProviders:this[_o],callInterceptors:(a=h.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=h.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},_=(0,Xc.getInterceptingCall)(g,h.methodDefinition,h.callOptions,h.channel);d.call=_;let T=!1,E=new Error;return _.start(h.metadata,{onReceiveMetadata(L){d.emit("metadata",L)},onReceiveMessage(L){d.push(L)},onReceiveStatus(L){if(!T){if(T=!0,d.push(null),L.code!==Zr.Status.OK){let x=Co(E);d.emit("error",(0,Hi.callErrorFromStatus)(L,x))}E=null,d.emit("status",L)}}}),_.sendMessage(r),_.halfClose(),d}makeBidiStreamRequest(e,t,i,r,s){var o,a;let c=this.checkMetadataAndOptions(r,s),l={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:i},u={metadata:c.metadata,call:new Hi.ClientDuplexStreamImpl(t,i),channel:this[pi],methodDefinition:l,callOptions:c.options};this[vr]&&(u=this[vr](u));let h=u.call,d={clientInterceptors:this[bo],clientInterceptorProviders:this[_o],callInterceptors:(o=u.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=u.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},g=(0,Xc.getInterceptingCall)(d,u.methodDefinition,u.callOptions,u.channel);h.call=g;let _=!1,T=new Error;return g.start(u.metadata,{onReceiveMetadata(E){h.emit("metadata",E)},onReceiveMessage(E){h.push(E)},onReceiveStatus(E){if(!_){if(_=!0,h.push(null),E.code!==Zr.Status.OK){let L=Co(T);h.emit("error",(0,Hi.callErrorFromStatus)(E,L))}T=null,h.emit("status",E)}}}),h}};Zc.Client=eu});var ru=k(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.loadPackageDefinition=So.makeClientConstructor=void 0;var m4=tu(),dI={unary:m4.Client.prototype.makeUnaryRequest,server_stream:m4.Client.prototype.makeServerStreamRequest,client_stream:m4.Client.prototype.makeClientStreamRequest,bidi:m4.Client.prototype.makeBidiStreamRequest};function iu(n){return["__proto__","prototype","constructor"].includes(n)}function Ip(n,e,t){t||(t={});class i extends m4.Client{}return Object.keys(n).forEach(r=>{if(iu(r))return;let s=n[r],o;if(typeof r=="string"&&r.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?o="bidi":o="client_stream":s.responseStream?o="server_stream":o="unary";let a=s.requestSerialize,c=s.responseDeserialize,l=fI(dI[o],s.path,a,c);i.prototype[r]=l,Object.assign(i.prototype[r],s),s.originalName&&!iu(s.originalName)&&(i.prototype[s.originalName]=i.prototype[r])}),i.service=n,i.serviceName=e,i}So.makeClientConstructor=Ip;function fI(n,e,t,i){return function(...r){return n.call(this,e,t,i,...r)}}function mI(n){return"format"in n}function pI(n){let e={};for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let i=n[t],r=t.split(".");if(r.some(a=>iu(a)))continue;let s=r[r.length-1],o=e;for(let a of r.slice(0,-1))o[a]||(o[a]={}),o=o[a];mI(i)?o[s]=i:o[s]=Ip(i,s,{})}return e}So.loadPackageDefinition=pI});var tg=k((IK,eg)=>{"use strict";var gI=1/0,vI="[object Symbol]",yI=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,wI=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,e3="\\ud800-\\udfff",Pp="\\u0300-\\u036f\\ufe20-\\ufe23",Hp="\\u20d0-\\u20f0",Bp="\\u2700-\\u27bf",Fp="a-z\\xdf-\\xf6\\xf8-\\xff",bI="\\xac\\xb1\\xd7\\xf7",_I="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",CI="\\u2000-\\u206f",SI=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",qp="A-Z\\xc0-\\xd6\\xd8-\\xde",Up="\\ufe0e\\ufe0f",jp=bI+_I+CI+SI,ou="['\u2019]",TI="["+e3+"]",Ap="["+jp+"]",Jc="["+Pp+Hp+"]",Wp="\\d+",EI="["+Bp+"]",$p="["+Fp+"]",Gp="[^"+e3+jp+Wp+Bp+Fp+qp+"]",su="\\ud83c[\\udffb-\\udfff]",MI="(?:"+Jc+"|"+su+")",Yp="[^"+e3+"]",au="(?:\\ud83c[\\udde6-\\uddff]){2}",cu="[\\ud800-\\udbff][\\udc00-\\udfff]",To="["+qp+"]",Kp="\\u200d",Dp="(?:"+$p+"|"+Gp+")",zI="(?:"+To+"|"+Gp+")",kp="(?:"+ou+"(?:d|ll|m|re|s|t|ve))?",Rp="(?:"+ou+"(?:D|LL|M|RE|S|T|VE))?",Qp=MI+"?",Xp="["+Up+"]?",xI="(?:"+Kp+"(?:"+[Yp,au,cu].join("|")+")"+Xp+Qp+")*",Zp=Xp+Qp+xI,OI="(?:"+[EI,au,cu].join("|")+")"+Zp,II="(?:"+[Yp+Jc+"?",Jc,au,cu,TI].join("|")+")",AI=RegExp(ou,"g"),DI=RegExp(Jc,"g"),kI=RegExp(su+"(?="+su+")|"+II+Zp,"g"),RI=RegExp([To+"?"+$p+"+"+kp+"(?="+[Ap,To,"$"].join("|")+")",zI+"+"+Rp+"(?="+[Ap,To+Dp,"$"].join("|")+")",To+"?"+Dp+"+"+kp,To+"+"+Rp,Wp,OI].join("|"),"g"),LI=RegExp("["+Kp+e3+Pp+Hp+Up+"]"),VI=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,NI={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},PI=typeof global=="object"&&global&&global.Object===Object&&global,HI=typeof self=="object"&&self&&self.Object===Object&&self,BI=PI||HI||Function("return this")();function FI(n,e,t,i){var r=-1,s=n?n.length:0;for(i&&s&&(t=n[++r]);++r<s;)t=e(t,n[r],r,n);return t}function qI(n){return n.split("")}function UI(n){return n.match(yI)||[]}function jI(n){return function(e){return n?.[e]}}var WI=jI(NI);function Jp(n){return LI.test(n)}function $I(n){return VI.test(n)}function GI(n){return Jp(n)?YI(n):qI(n)}function YI(n){return n.match(kI)||[]}function KI(n){return n.match(RI)||[]}var QI=Object.prototype,XI=QI.toString,Lp=BI.Symbol,Vp=Lp?Lp.prototype:void 0,Np=Vp?Vp.toString:void 0;function ZI(n,e,t){var i=-1,r=n.length;e<0&&(e=-e>r?0:r+e),t=t>r?r:t,t<0&&(t+=r),r=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=n[i+e];return s}function JI(n){if(typeof n=="string")return n;if(rA(n))return Np?Np.call(n):"";var e=n+"";return e=="0"&&1/n==-gI?"-0":e}function eA(n,e,t){var i=n.length;return t=t===void 0?i:t,!e&&t>=i?n:ZI(n,e,t)}function tA(n){return function(e){e=t3(e);var t=Jp(e)?GI(e):void 0,i=t?t[0]:e.charAt(0),r=t?eA(t,1).join(""):e.slice(1);return i[n]()+r}}function nA(n){return function(e){return FI(lA(aA(e).replace(AI,"")),n,"")}}function iA(n){return!!n&&typeof n=="object"}function rA(n){return typeof n=="symbol"||iA(n)&&XI.call(n)==vI}function t3(n){return n==null?"":JI(n)}var sA=nA(function(n,e,t){return e=e.toLowerCase(),n+(t?oA(e):e)});function oA(n){return cA(t3(n).toLowerCase())}function aA(n){return n=t3(n),n&&n.replace(wI,WI).replace(DI,"")}var cA=tA("toUpperCase");function lA(n,e,t){return n=t3(n),e=t?void 0:e,e===void 0?$I(n)?KI(n):UI(n):n.match(e)||[]}eg.exports=sA});var lu=k((AK,ng)=>{"use strict";ng.exports=uA;function uA(n,e){for(var t=new Array(arguments.length-1),i=0,r=2,s=!0;r<arguments.length;)t[i++]=arguments[r++];return new Promise(function(a,c){t[i]=function(u){if(s)if(s=!1,u)c(u);else{for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d++]=arguments[d];a.apply(null,h)}};try{n.apply(e||null,t)}catch(l){s&&(s=!1,c(l))}})}});var og=k(sg=>{"use strict";var n3=sg;n3.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&e.charAt(t)==="=";)++i;return Math.ceil(e.length*3)/4-i};var Eo=new Array(64),rg=new Array(123);for(gi=0;gi<64;)rg[Eo[gi]=gi<26?gi+65:gi<52?gi+71:gi<62?gi-4:gi-59|43]=gi++;var gi;n3.encode=function(e,t,i){for(var r=null,s=[],o=0,a=0,c;t<i;){var l=e[t++];switch(a){case 0:s[o++]=Eo[l>>2],c=(l&3)<<4,a=1;break;case 1:s[o++]=Eo[c|l>>4],c=(l&15)<<2,a=2;break;case 2:s[o++]=Eo[c|l>>6],s[o++]=Eo[l&63],a=0;break}o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Eo[c],s[o++]=61,a===1&&(s[o++]=61)),r?(o&&r.push(String.fromCharCode.apply(String,s.slice(0,o))),r.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var ig="invalid encoding";n3.decode=function(e,t,i){for(var r=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=rg[c])===void 0)throw Error(ig);switch(s){case 0:o=c,s=1;break;case 1:t[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(ig);return i-r};n3.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var cg=k((kK,ag)=>{"use strict";ag.exports=i3;function i3(){this._listeners={}}i3.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};i3.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],r=0;r<i.length;)i[r].fn===t?i.splice(r,1):++r;return this};i3.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],r=1;r<arguments.length;)i.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,i)}return this}});var pg=k((RK,mg)=>{"use strict";mg.exports=lg(lg);function lg(n){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function r(c,l,u){e[0]=c,l[u]=t[0],l[u+1]=t[1],l[u+2]=t[2],l[u+3]=t[3]}function s(c,l,u){e[0]=c,l[u]=t[3],l[u+1]=t[2],l[u+2]=t[1],l[u+3]=t[0]}n.writeFloatLE=i?r:s,n.writeFloatBE=i?s:r;function o(c,l){return t[0]=c[l],t[1]=c[l+1],t[2]=c[l+2],t[3]=c[l+3],e[0]}function a(c,l){return t[3]=c[l],t[2]=c[l+1],t[1]=c[l+2],t[0]=c[l+3],e[0]}n.readFloatLE=i?o:a,n.readFloatBE=i?a:o}():function(){function e(i,r,s,o){var a=r<0?1:0;if(a&&(r=-r),r===0)i(1/r>0?0:2147483648,s,o);else if(isNaN(r))i(2143289344,s,o);else if(r>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(r<11754943508222875e-54)i((a<<31|Math.round(r/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(r)/Math.LN2),l=Math.round(r*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|l)>>>0,s,o)}}n.writeFloatLE=e.bind(null,ug),n.writeFloatBE=e.bind(null,hg);function t(i,r,s){var o=i(r,s),a=(o>>31)*2+1,c=o>>>23&255,l=o&8388607;return c===255?l?NaN:a*(1/0):c===0?a*1401298464324817e-60*l:a*Math.pow(2,c-150)*(l+8388608)}n.readFloatLE=t.bind(null,dg),n.readFloatBE=t.bind(null,fg)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function r(c,l,u){e[0]=c,l[u]=t[0],l[u+1]=t[1],l[u+2]=t[2],l[u+3]=t[3],l[u+4]=t[4],l[u+5]=t[5],l[u+6]=t[6],l[u+7]=t[7]}function s(c,l,u){e[0]=c,l[u]=t[7],l[u+1]=t[6],l[u+2]=t[5],l[u+3]=t[4],l[u+4]=t[3],l[u+5]=t[2],l[u+6]=t[1],l[u+7]=t[0]}n.writeDoubleLE=i?r:s,n.writeDoubleBE=i?s:r;function o(c,l){return t[0]=c[l],t[1]=c[l+1],t[2]=c[l+2],t[3]=c[l+3],t[4]=c[l+4],t[5]=c[l+5],t[6]=c[l+6],t[7]=c[l+7],e[0]}function a(c,l){return t[7]=c[l],t[6]=c[l+1],t[5]=c[l+2],t[4]=c[l+3],t[3]=c[l+4],t[2]=c[l+5],t[1]=c[l+6],t[0]=c[l+7],e[0]}n.readDoubleLE=i?o:a,n.readDoubleBE=i?a:o}():function(){function e(i,r,s,o,a,c){var l=o<0?1:0;if(l&&(o=-o),o===0)i(0,a,c+r),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+r),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+r),i((l<<31|2146435072)>>>0,a,c+s);else{var u;if(o<22250738585072014e-324)u=o/5e-324,i(u>>>0,a,c+r),i((l<<31|u/4294967296)>>>0,a,c+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),u=o*Math.pow(2,-h),i(u*4503599627370496>>>0,a,c+r),i((l<<31|h+1023<<20|u*1048576&1048575)>>>0,a,c+s)}}}n.writeDoubleLE=e.bind(null,ug,0,4),n.writeDoubleBE=e.bind(null,hg,4,0);function t(i,r,s,o,a){var c=i(o,a+r),l=i(o,a+s),u=(l>>31)*2+1,h=l>>>20&2047,d=4294967296*(l&1048575)+c;return h===2047?d?NaN:u*(1/0):h===0?u*5e-324*d:u*Math.pow(2,h-1075)*(d+4503599627370496)}n.readDoubleLE=t.bind(null,dg,0,4),n.readDoubleBE=t.bind(null,fg,4,0)}(),n}function ug(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function hg(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function dg(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function fg(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}});var uu=k((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var vg=k(gg=>{"use strict";var hu=gg;hu.length=function(e){for(var t=0,i=0,r=0;r<e.length;++r)i=e.charCodeAt(r),i<128?t+=1:i<2048?t+=2:(i&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320?(++r,t+=4):t+=3;return t};hu.read=function(e,t,i){var r=i-t;if(r<1)return"";for(var s=null,o=[],a=0,c;t<i;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};hu.write=function(e,t,i){for(var r=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-r}});var wg=k((VK,yg)=>{"use strict";yg.exports=hA;function hA(n,e,t){var i=t||8192,r=i>>>1,s=null,o=i;return function(c){if(c<1||c>r)return n(c);o+c>i&&(s=n(i),o=0);var l=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),l}}});var _g=k((NK,bg)=>{"use strict";bg.exports=Ut;var p4=Bi();function Ut(n,e){this.lo=n>>>0,this.hi=e>>>0}var Js=Ut.zero=new Ut(0,0);Js.toNumber=function(){return 0};Js.zzEncode=Js.zzDecode=function(){return this};Js.length=function(){return 1};var dA=Ut.zeroHash="\0\0\0\0\0\0\0\0";Ut.fromNumber=function(e){if(e===0)return Js;var t=e<0;t&&(e=-e);var i=e>>>0,r=(e-i)/4294967296>>>0;return t&&(r=~r>>>0,i=~i>>>0,++i>4294967295&&(i=0,++r>4294967295&&(r=0))),new Ut(i,r)};Ut.from=function(e){if(typeof e=="number")return Ut.fromNumber(e);if(p4.isString(e))if(p4.Long)e=p4.Long.fromString(e);else return Ut.fromNumber(parseInt(e,10));return e.low||e.high?new Ut(e.low>>>0,e.high>>>0):Js};Ut.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+i*4294967296)}return this.lo+this.hi*4294967296};Ut.prototype.toLong=function(e){return p4.Long?new p4.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Jr=String.prototype.charCodeAt;Ut.fromHash=function(e){return e===dA?Js:new Ut((Jr.call(e,0)|Jr.call(e,1)<<8|Jr.call(e,2)<<16|Jr.call(e,3)<<24)>>>0,(Jr.call(e,4)|Jr.call(e,5)<<8|Jr.call(e,6)<<16|Jr.call(e,7)<<24)>>>0)};Ut.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Ut.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Ut.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Ut.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}});var Bi=k(du=>{"use strict";var se=du;se.asPromise=lu();se.base64=og();se.EventEmitter=cg();se.float=pg();se.inquire=uu();se.utf8=vg();se.pool=wg();se.LongBits=_g();se.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);se.global=se.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||du;se.emptyArray=Object.freeze?Object.freeze([]):[];se.emptyObject=Object.freeze?Object.freeze({}):{};se.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};se.isString=function(e){return typeof e=="string"||e instanceof String};se.isObject=function(e){return e&&typeof e=="object"};se.isset=se.isSet=function(e,t){var i=e[t];return i!=null&&e.hasOwnProperty(t)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};se.Buffer=function(){try{var n=se.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}}();se._Buffer_from=null;se._Buffer_allocUnsafe=null;se.newBuffer=function(e){return typeof e=="number"?se.Buffer?se._Buffer_allocUnsafe(e):new se.Array(e):se.Buffer?se._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};se.Array=typeof Uint8Array<"u"?Uint8Array:Array;se.Long=se.global.dcodeIO&&se.global.dcodeIO.Long||se.global.Long||se.inquire("long");se.key2Re=/^true|false|0|1$/;se.key32Re=/^-?(?:0|[1-9][0-9]*)$/;se.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;se.longToHash=function(e){return e?se.LongBits.from(e).toHash():se.LongBits.zeroHash};se.longFromHash=function(e,t){var i=se.LongBits.fromHash(e);return se.Long?se.Long.fromBits(i.lo,i.hi,t):i.toNumber(!!t)};function Cg(n,e,t){for(var i=Object.keys(e),r=0;r<i.length;++r)(n[i[r]]===void 0||!t)&&(n[i[r]]=e[i[r]]);return n}se.merge=Cg;se.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Sg(n){function e(t,i){if(!(this instanceof e))return new e(t,i);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&Cg(this,i)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}se.newError=Sg;se.ProtocolError=Sg("ProtocolError");se.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var r=Object.keys(this),s=r.length-1;s>-1;--s)if(t[r[s]]===1&&this[r[s]]!==void 0&&this[r[s]]!==null)return r[s]}};se.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}};se.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};se._configure=function(){var n=se.Buffer;if(!n){se._Buffer_from=se._Buffer_allocUnsafe=null;return}se._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,i){return new n(t,i)},se._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}}});var s3=k((HK,zg)=>{"use strict";zg.exports=Oe;var Xn=Bi(),fu,r3=Xn.LongBits,Tg=Xn.base64,Eg=Xn.utf8;function g4(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function pu(){}function fA(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function Oe(){this.len=0,this.head=new g4(pu,0,0),this.tail=this.head,this.states=null}var Mg=function(){return Xn.Buffer?function(){return(Oe.create=function(){return new fu})()}:function(){return new Oe}};Oe.create=Mg();Oe.alloc=function(e){return new Xn.Array(e)};Xn.Array!==Array&&(Oe.alloc=Xn.pool(Oe.alloc,Xn.Array.prototype.subarray));Oe.prototype._push=function(e,t,i){return this.tail=this.tail.next=new g4(e,t,i),this.len+=t,this};function gu(n,e,t){e[t]=n&255}function mA(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function vu(n,e){this.len=n,this.next=void 0,this.val=e}vu.prototype=Object.create(g4.prototype);vu.prototype.fn=mA;Oe.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new vu((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Oe.prototype.int32=function(e){return e<0?this._push(yu,10,r3.fromNumber(e)):this.uint32(e)};Oe.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function yu(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}Oe.prototype.uint64=function(e){var t=r3.from(e);return this._push(yu,t.length(),t)};Oe.prototype.int64=Oe.prototype.uint64;Oe.prototype.sint64=function(e){var t=r3.from(e).zzEncode();return this._push(yu,t.length(),t)};Oe.prototype.bool=function(e){return this._push(gu,1,e?1:0)};function mu(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}Oe.prototype.fixed32=function(e){return this._push(mu,4,e>>>0)};Oe.prototype.sfixed32=Oe.prototype.fixed32;Oe.prototype.fixed64=function(e){var t=r3.from(e);return this._push(mu,4,t.lo)._push(mu,4,t.hi)};Oe.prototype.sfixed64=Oe.prototype.fixed64;Oe.prototype.float=function(e){return this._push(Xn.float.writeFloatLE,4,e)};Oe.prototype.double=function(e){return this._push(Xn.float.writeDoubleLE,8,e)};var pA=Xn.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var r=0;r<e.length;++r)t[i+r]=e[r]};Oe.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(gu,1,0);if(Xn.isString(e)){var i=Oe.alloc(t=Tg.length(e));Tg.decode(e,i,0),e=i}return this.uint32(t)._push(pA,t,e)};Oe.prototype.string=function(e){var t=Eg.length(e);return t?this.uint32(t)._push(Eg.write,t,e):this._push(gu,1,0)};Oe.prototype.fork=function(){return this.states=new fA(this),this.head=this.tail=new g4(pu,0,0),this.len=0,this};Oe.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new g4(pu,0,0),this.len=0),this};Oe.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};Oe.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};Oe._configure=function(n){fu=n,Oe.create=Mg(),fu._configure()}});var Ig=k((BK,Og)=>{"use strict";Og.exports=Fi;var xg=s3();(Fi.prototype=Object.create(xg.prototype)).constructor=Fi;var es=Bi();function Fi(){xg.call(this)}Fi._configure=function(){Fi.alloc=es._Buffer_allocUnsafe,Fi.writeBytesBuffer=es.Buffer&&es.Buffer.prototype instanceof Uint8Array&&es.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var r=0;r<e.length;)t[i++]=e[r++]}};Fi.prototype.bytes=function(e){es.isString(e)&&(e=es._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Fi.writeBytesBuffer,t,e),this};function gA(n,e,t){n.length<40?es.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}Fi.prototype.string=function(e){var t=es.Buffer.byteLength(e);return this.uint32(t),t&&this._push(gA,t,e),this};Fi._configure()});var a3=k((FK,Lg)=>{"use strict";Lg.exports=Et;var vi=Bi(),bu,kg=vi.LongBits,vA=vi.utf8;function yi(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function Et(n){this.buf=n,this.pos=0,this.len=n.length}var Ag=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Et(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Et(e);throw Error("illegal buffer")},Rg=function(){return vi.Buffer?function(t){return(Et.create=function(r){return vi.Buffer.isBuffer(r)?new bu(r):Ag(r)})(t)}:Ag};Et.create=Rg();Et.prototype._slice=vi.Array.prototype.subarray||vi.Array.prototype.slice;Et.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,yi(this,10);return e}}();Et.prototype.int32=function(){return this.uint32()|0};Et.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function wu(){var n=new kg(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw yi(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw yi(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}Et.prototype.bool=function(){return this.uint32()!==0};function o3(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}Et.prototype.fixed32=function(){if(this.pos+4>this.len)throw yi(this,4);return o3(this.buf,this.pos+=4)};Et.prototype.sfixed32=function(){if(this.pos+4>this.len)throw yi(this,4);return o3(this.buf,this.pos+=4)|0};function Dg(){if(this.pos+8>this.len)throw yi(this,8);return new kg(o3(this.buf,this.pos+=4),o3(this.buf,this.pos+=4))}Et.prototype.float=function(){if(this.pos+4>this.len)throw yi(this,4);var e=vi.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Et.prototype.double=function(){if(this.pos+8>this.len)throw yi(this,4);var e=vi.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Et.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw yi(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,i);if(t===i){var r=vi.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,i)};Et.prototype.string=function(){var e=this.bytes();return vA.read(e,0,e.length)};Et.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw yi(this,e);this.pos+=e}else do if(this.pos>=this.len)throw yi(this);while(this.buf[this.pos++]&128);return this};Et.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};Et._configure=function(n){bu=n,Et.create=Rg(),bu._configure();var e=vi.Long?"toLong":"toNumber";vi.merge(Et.prototype,{int64:function(){return wu.call(this)[e](!1)},uint64:function(){return wu.call(this)[e](!0)},sint64:function(){return wu.call(this).zzDecode()[e](!1)},fixed64:function(){return Dg.call(this)[e](!0)},sfixed64:function(){return Dg.call(this)[e](!1)}})}});var Hg=k((qK,Pg)=>{"use strict";Pg.exports=e1;var Ng=a3();(e1.prototype=Object.create(Ng.prototype)).constructor=e1;var Vg=Bi();function e1(n){Ng.call(this,n)}e1._configure=function(){Vg.Buffer&&(e1.prototype._slice=Vg.Buffer.prototype.slice)};e1.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};e1._configure()});var Fg=k((UK,Bg)=>{"use strict";Bg.exports=v4;var _u=Bi();(v4.prototype=Object.create(_u.EventEmitter.prototype)).constructor=v4;function v4(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");_u.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!e,this.responseDelimited=!!t}v4.prototype.rpcCall=function n(e,t,i,r,s){if(!r)throw TypeError("request must be specified");var o=this;if(!s)return _u.asPromise(n,o,e,t,i,r);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(c,l){if(c)return o.emit("error",c,e),s(c);if(l===null){o.end(!0);return}if(!(l instanceof i))try{l=i[o.responseDelimited?"decodeDelimited":"decode"](l)}catch(u){return o.emit("error",u,e),s(u)}return o.emit("data",l,e),s(null,l)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};v4.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Cu=k(qg=>{"use strict";var yA=qg;yA.Service=Fg()});var Su=k((WK,Ug)=>{"use strict";Ug.exports={}});var $g=k(Wg=>{"use strict";var zn=Wg;zn.build="minimal";zn.Writer=s3();zn.BufferWriter=Ig();zn.Reader=a3();zn.BufferReader=Hg();zn.util=Bi();zn.rpc=Cu();zn.roots=Su();zn.configure=jg;function jg(){zn.util._configure(),zn.Writer._configure(zn.BufferWriter),zn.Reader._configure(zn.BufferReader)}jg()});var Yg=k((GK,Gg)=>{"use strict";Gg.exports=Tu;function Tu(n,e){typeof n=="string"&&(e=n,n=void 0);var t=[];function i(s){if(typeof s!="string"){var o=r();if(Tu.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),c=new Array(a.length+1),l=new Array(a.length),u=0;u<a.length;)c[u]=a[u],l[u]=s[a[u++]];return c[u]=o,Function.apply(null,c).apply(null,l)}return Function(o)()}for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d]=arguments[++d];if(d=0,s=s.replace(/%([%dfijs])/g,function(_,T){var E=h[d++];switch(T){case"d":case"f":return String(Number(E));case"i":return String(Math.floor(E));case"j":return JSON.stringify(E);case"s":return String(E)}return"%"}),d!==h.length)throw Error("parameter count mismatch");return t.push(s),i}function r(s){return"function "+(s||e||"")+"("+(n&&n.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return i.toString=r,i}Tu.verbose=!1});var Qg=k((YK,Kg)=>{"use strict";Kg.exports=y4;var wA=lu(),bA=uu(),Eu=bA("fs");function y4(n,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&Eu&&Eu.readFile?Eu.readFile(n,function(r,s){return r&&typeof XMLHttpRequest<"u"?y4.xhr(n,e,t):r?t(r):t(null,e.binary?s:s.toString("utf8"))}):y4.xhr(n,e,t):wA(y4,this,n,e)}y4.xhr=function(e,t,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==0&&r.status!==200)return i(Error("status "+r.status));if(t.binary){var o=r.response;if(!o){o=[];for(var a=0;a<r.responseText.length;++a)o.push(r.responseText.charCodeAt(a)&255)}return i(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return i(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}});var Jg=k(Zg=>{"use strict";var zu=Zg,Xg=zu.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},Mu=zu.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),i=Xg(e),r="";i&&(r=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):i?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return r+t.join("/")};zu.resolve=function(e,t,i){return i||(t=Mu(t)),Xg(t)?t:(i||(e=Mu(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?Mu(e+"/"+t):t)}});var t1=k(ev=>{"use strict";var w4=ev,_A=jt(),CA=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function b4(n,e){var t=0,i={};for(e|=0;t<n.length;)i[CA[t+e]]=n[t++];return i}w4.basic=b4([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);w4.defaults=b4([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",_A.emptyArray,null]);w4.long=b4([0,0,0,1,1],7);w4.mapKey=b4([0,0,0,5,5,0,0,0,1,1,0,2],2);w4.packed=b4([1,5,0,0,0,5,5,0,0,0,1,1,0])});var ts=k((XK,iv)=>{"use strict";iv.exports=Zn;var c3=n1();((Zn.prototype=Object.create(c3.prototype)).constructor=Zn).className="Field";var tv=wi(),nv=t1(),At=jt(),xu,SA=/^required|optional|repeated$/;Zn.fromJSON=function(e,t){return new Zn(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function Zn(n,e,t,i,r,s,o){if(At.isObject(i)?(o=r,s=i,i=r=void 0):At.isObject(r)&&(o=s,s=r,r=void 0),c3.call(this,n,s),!At.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!At.isString(t))throw TypeError("type must be a string");if(i!==void 0&&!SA.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(r!==void 0&&!At.isString(r))throw TypeError("extend must be a string");i==="proto3_optional"&&(i="optional"),this.rule=i&&i!=="optional"?i:void 0,this.type=t,this.id=e,this.extend=r||void 0,this.required=i==="required",this.optional=!this.required,this.repeated=i==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=At.Long?nv.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(Zn.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});Zn.prototype.setOption=function(e,t,i){return e==="packed"&&(this._packed=null),c3.prototype.setOption.call(this,e,t,i)};Zn.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return At.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Zn.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=nv.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof xu?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof tv&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof tv))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=At.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;At.base64.test(this.typeDefault)?At.base64.decode(this.typeDefault,e=At.newBuffer(At.base64.length(this.typeDefault)),0):At.utf8.write(this.typeDefault,e=At.newBuffer(At.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=At.emptyObject:this.repeated?this.defaultValue=At.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof xu&&(this.parent.ctor.prototype[this.name]=this.defaultValue),c3.prototype.resolve.call(this)};Zn.d=function(e,t,i,r){return typeof t=="function"?t=At.decorateType(t).name:t&&typeof t=="object"&&(t=At.decorateEnum(t).name),function(o,a){At.decorateType(o.constructor).add(new Zn(a,e,t,i,{default:r}))}};Zn._configure=function(e){xu=e}});var Mo=k((ZK,ov)=>{"use strict";ov.exports=Jn;var u3=n1();((Jn.prototype=Object.create(u3.prototype)).constructor=Jn).className="OneOf";var rv=ts(),l3=jt();function Jn(n,e,t,i){if(Array.isArray(e)||(t=e,e=void 0),u3.call(this,n,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=i}Jn.fromJSON=function(e,t){return new Jn(e,t.oneof,t.options,t.comment)};Jn.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return l3.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function sv(n){if(n.parent)for(var e=0;e<n.fieldsArray.length;++e)n.fieldsArray[e].parent||n.parent.add(n.fieldsArray[e])}Jn.prototype.add=function(e){if(!(e instanceof rv))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,sv(this),this};Jn.prototype.remove=function(e){if(!(e instanceof rv))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};Jn.prototype.onAdd=function(e){u3.prototype.onAdd.call(this,e);for(var t=this,i=0;i<this.oneof.length;++i){var r=e.get(this.oneof[i]);r&&!r.partOf&&(r.partOf=t,t.fieldsArray.push(r))}sv(this)};Jn.prototype.onRemove=function(e){for(var t=0,i;t<this.fieldsArray.length;++t)(i=this.fieldsArray[t]).parent&&i.parent.remove(i);u3.prototype.onRemove.call(this,e)};Jn.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(r,s){l3.decorateType(r.constructor).add(new Jn(s,e)),Object.defineProperty(r,s,{get:l3.oneOfGetter(e),set:l3.oneOfSetter(e)})}}});var Oo=k((JK,uv)=>{"use strict";uv.exports=De;var Ou=n1();((De.prototype=Object.create(Ou.prototype)).constructor=De).className="Namespace";var av=ts(),h3=jt(),TA=Mo(),zo,_4,xo;De.fromJSON=function(e,t){return new De(e,t.options).addJSON(t.nested)};function cv(n,e){if(n&&n.length){for(var t={},i=0;i<n.length;++i)t[n[i].name]=n[i].toJSON(e);return t}}De.arrayToJSON=cv;De.isReservedId=function(e,t){if(e){for(var i=0;i<e.length;++i)if(typeof e[i]!="string"&&e[i][0]<=t&&e[i][1]>t)return!0}return!1};De.isReservedName=function(e,t){if(e){for(var i=0;i<e.length;++i)if(e[i]===t)return!0}return!1};function De(n,e){Ou.call(this,n,e),this.nested=void 0,this._nestedArray=null}function lv(n){return n._nestedArray=null,n}Object.defineProperty(De.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=h3.toArray(this.nested))}});De.prototype.toJSON=function(e){return h3.toObject(["options",this.options,"nested",cv(this.nestedArray,e)])};De.prototype.addJSON=function(e){var t=this;if(e)for(var i=Object.keys(e),r=0,s;r<i.length;++r)s=e[i[r]],t.add((s.fields!==void 0?zo.fromJSON:s.values!==void 0?xo.fromJSON:s.methods!==void 0?_4.fromJSON:s.id!==void 0?av.fromJSON:De.fromJSON)(i[r],s));return this};De.prototype.get=function(e){return this.nested&&this.nested[e]||null};De.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof xo)return this.nested[e].values;throw Error("no such enum: "+e)};De.prototype.add=function(e){if(!(e instanceof av&&e.extend!==void 0||e instanceof zo||e instanceof TA||e instanceof xo||e instanceof _4||e instanceof De))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof De&&e instanceof De&&!(t instanceof zo||t instanceof _4)){for(var i=t.nestedArray,r=0;r<i.length;++r)e.add(i[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),lv(this)};De.prototype.remove=function(e){if(!(e instanceof Ou))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),lv(this)};De.prototype.define=function(e,t){if(h3.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var i=this;e.length>0;){var r=e.shift();if(i.nested&&i.nested[r]){if(i=i.nested[r],!(i instanceof De))throw Error("path conflicts with non-namespace objects")}else i.add(i=new De(r))}return t&&i.addJSON(t),i};De.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof De?e[t++].resolveAll():e[t++].resolve();return this.resolve()};De.prototype.lookup=function(e,t,i){if(typeof t=="boolean"?(i=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),h3.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(e.length===1){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof De&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof De&&(r=this._nestedArray[s].lookup(e,t,!0)))return r;return this.parent===null||i?null:this.parent.lookup(e,t)};De.prototype.lookupType=function(e){var t=this.lookup(e,[zo]);if(!t)throw Error("no such type: "+e);return t};De.prototype.lookupEnum=function(e){var t=this.lookup(e,[xo]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};De.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[zo,xo]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};De.prototype.lookupService=function(e){var t=this.lookup(e,[_4]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};De._configure=function(n,e,t){zo=n,_4=e,xo=t}});var d3=k((eQ,hv)=>{"use strict";hv.exports=yr;var Iu=ts();((yr.prototype=Object.create(Iu.prototype)).constructor=yr).className="MapField";var EA=t1(),C4=jt();function yr(n,e,t,i,r,s){if(Iu.call(this,n,e,i,void 0,void 0,r,s),!C4.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}yr.fromJSON=function(e,t){return new yr(e,t.id,t.keyType,t.type,t.options,t.comment)};yr.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return C4.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};yr.prototype.resolve=function(){if(this.resolved)return this;if(EA.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return Iu.prototype.resolve.call(this)};yr.d=function(e,t,i){return typeof i=="function"?i=C4.decorateType(i).name:i&&typeof i=="object"&&(i=C4.decorateEnum(i).name),function(s,o){C4.decorateType(s.constructor).add(new yr(o,e,t,i))}}});var f3=k((tQ,dv)=>{"use strict";dv.exports=i1;var Au=n1();((i1.prototype=Object.create(Au.prototype)).constructor=i1).className="Method";var Io=jt();function i1(n,e,t,i,r,s,o,a,c){if(Io.isObject(r)?(o=r,r=s=void 0):Io.isObject(s)&&(o=s,s=void 0),!(e===void 0||Io.isString(e)))throw TypeError("type must be a string");if(!Io.isString(t))throw TypeError("requestType must be a string");if(!Io.isString(i))throw TypeError("responseType must be a string");Au.call(this,n,o),this.type=e||"rpc",this.requestType=t,this.requestStream=r?!0:void 0,this.responseType=i,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=c}i1.fromJSON=function(e,t){return new i1(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};i1.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Io.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};i1.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),Au.prototype.resolve.call(this))}});var m3=k((nQ,mv)=>{"use strict";mv.exports=ei;var ns=Oo();((ei.prototype=Object.create(ns.prototype)).constructor=ei).className="Service";var Du=f3(),S4=jt(),MA=Cu();function ei(n,e){ns.call(this,n,e),this.methods={},this._methodsArray=null}ei.fromJSON=function(e,t){var i=new ei(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),s=0;s<r.length;++s)i.add(Du.fromJSON(r[s],t.methods[r[s]]));return t.nested&&i.addJSON(t.nested),i.comment=t.comment,i};ei.prototype.toJSON=function(e){var t=ns.prototype.toJSON.call(this,e),i=e?!!e.keepComments:!1;return S4.toObject(["options",t&&t.options||void 0,"methods",ns.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])};Object.defineProperty(ei.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=S4.toArray(this.methods))}});function fv(n){return n._methodsArray=null,n}ei.prototype.get=function(e){return this.methods[e]||ns.prototype.get.call(this,e)};ei.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return ns.prototype.resolve.call(this)};ei.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof Du?(this.methods[e.name]=e,e.parent=this,fv(this)):ns.prototype.add.call(this,e)};ei.prototype.remove=function(e){if(e instanceof Du){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,fv(this)}return ns.prototype.remove.call(this,e)};ei.prototype.create=function(e,t,i){for(var r=new MA.Service(e,t,i),s=0,o;s<this.methodsArray.length;++s){var a=S4.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");r[a]=S4.codegen(["r","c"],S4.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return r}});var p3=k((iQ,pv)=>{"use strict";pv.exports=qi;var zA=Bi();function qi(n){if(n)for(var e=Object.keys(n),t=0;t<e.length;++t)this[e[t]]=n[e[t]]}qi.create=function(e){return this.$type.create(e)};qi.encode=function(e,t){return this.$type.encode(e,t)};qi.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};qi.decode=function(e){return this.$type.decode(e)};qi.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};qi.verify=function(e){return this.$type.verify(e)};qi.fromObject=function(e){return this.$type.fromObject(e)};qi.toObject=function(e,t){return this.$type.toObject(e,t)};qi.prototype.toJSON=function(){return this.$type.toObject(this,zA.toJSONOptions)}});var ku=k((rQ,vv)=>{"use strict";vv.exports=IA;var xA=wi(),wr=t1(),gv=jt();function OA(n){return"missing required '"+n.name+"'"}function IA(n){var e=gv.codegen(["r","l"],n.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(n.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");n.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var t=0;t<n.fieldsArray.length;++t){var i=n._fieldsArray[t].resolve(),r=i.resolvedType instanceof xA?"int32":i.type,s="m"+gv.safeProp(i.name);e("case %i: {",i.id),i.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),wr.defaults[i.keyType]!==void 0?e("k=%j",wr.defaults[i.keyType]):e("k=null"),wr.defaults[r]!==void 0?e("value=%j",wr.defaults[r]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",i.keyType)("case 2:"),wr.basic[r]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",r),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),wr.long[i.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):i.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),wr.packed[r]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,r)("}else"),wr.basic[r]===void 0?e(i.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,r)):wr.basic[r]===void 0?e(i.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,r),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<n._fieldsArray.length;++t){var o=n._fieldsArray[t];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",OA(o))}return e("return m")}});var Vu=k((sQ,yv)=>{"use strict";yv.exports=kA;var AA=wi(),Ru=jt();function ti(n,e){return n.name+": "+e+(n.repeated&&e!=="array"?"[]":n.map&&e!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function Lu(n,e,t,i){if(e.resolvedType)if(e.resolvedType instanceof AA){n("switch(%s){",i)("default:")("return%j",ti(e,"enum value"));for(var r=Object.keys(e.resolvedType.values),s=0;s<r.length;++s)n("case %i:",e.resolvedType.values[r[s]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",t,i)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",i)("return%j",ti(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",ti(e,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',i)("return%j",ti(e,"number"));break;case"bool":n('if(typeof %s!=="boolean")',i)("return%j",ti(e,"boolean"));break;case"string":n("if(!util.isString(%s))",i)("return%j",ti(e,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",ti(e,"buffer"));break}return n}function DA(n,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",t)("return%j",ti(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",t)("return%j",ti(e,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",t)("return%j",ti(e,"boolean key"));break}return n}function kA(n){var e=Ru.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=n.oneofsArray,i={};t.length&&e("var p={}");for(var r=0;r<n.fieldsArray.length;++r){var s=n._fieldsArray[r].resolve(),o="m"+Ru.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",ti(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),DA(e,s,"k[i]"),Lu(e,s,r,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",ti(s,"array"))("for(var i=0;i<%s.length;++i){",o),Lu(e,s,r,o+"[i]")("}");else{if(s.partOf){var a=Ru.safeProp(s.partOf.name);i[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),i[s.partOf.name]=1,e("p%s=1",a)}Lu(e,s,r,o)}s.optional&&e("}")}return e("return null")}});var Hu=k(bv=>{"use strict";var wv=bv,T4=wi(),Ui=jt();function Nu(n,e,t,i){var r=!1;if(e.resolvedType)if(e.resolvedType instanceof T4){n("switch(d%s){",i);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!r&&(n("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',i,i,i),e.repeated||n("break"),r=!0),n("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",i,s[o[a]])("break");n("}")}else n('if(typeof d%s!=="object")',i)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,t,i);else{var c=!1;switch(e.type){case"double":case"float":n("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",i,i);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,c)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,c?"true":"");break;case"bytes":n('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length >= 0)",i)("m%s=d%s",i,i);break;case"string":n("m%s=String(d%s)",i,i);break;case"bool":n("m%s=Boolean(d%s)",i,i);break}}return n}wv.fromObject=function(e){var t=e.fieldsArray,i=Ui.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return i("return new this.ctor");i("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),o=Ui.safeProp(s.name);s.map?(i("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),Nu(i,s,r,o+"[ks[i]]")("}")("}")):s.repeated?(i("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),Nu(i,s,r,o+"[i]")("}")("}")):(s.resolvedType instanceof T4||i("if(d%s!=null){",o),Nu(i,s,r,o),s.resolvedType instanceof T4||i("}"))}return i("return m")};function Pu(n,e,t,i){if(e.resolvedType)e.resolvedType instanceof T4?n("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",i,t,i,i,t,i,i):n("d%s=types[%i].toObject(m%s,o)",i,t,i);else{var r=!1;switch(e.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":r=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,r?"true":"",i);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:n("d%s=m%s",i,i);break}}return n}wv.toObject=function(e){var t=e.fieldsArray.slice().sort(Ui.compareFieldsById);if(!t.length)return Ui.codegen()("return {}");for(var i=Ui.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],s=[],o=[],a=0;a<t.length;++a)t[a].partOf||(t[a].resolve().repeated?r:t[a].map?s:o).push(t[a]);if(r.length){for(i("if(o.arrays||o.defaults){"),a=0;a<r.length;++a)i("d%s=[]",Ui.safeProp(r[a].name));i("}")}if(s.length){for(i("if(o.objects||o.defaults){"),a=0;a<s.length;++a)i("d%s={}",Ui.safeProp(s[a].name));i("}")}if(o.length){for(i("if(o.defaults){"),a=0;a<o.length;++a){var c=o[a],l=Ui.safeProp(c.name);if(c.resolvedType instanceof T4)i("d%s=o.enums===String?%j:%j",l,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)i("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var u="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";i("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",l,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else i("d%s=%j",l,c.typeDefault)}i("}")}var h=!1;for(a=0;a<t.length;++a){var c=t[a],d=e._fieldsArray.indexOf(c),l=Ui.safeProp(c.name);c.map?(h||(h=!0,i("var ks2")),i("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),Pu(i,c,d,l+"[ks2[j]]")("}")):c.repeated?(i("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),Pu(i,c,d,l+"[j]")("}")):(i("if(m%s!=null&&m.hasOwnProperty(%j)){",l,c.name),Pu(i,c,d,l),c.partOf&&i("if(o.oneofs)")("d%s=%j",Ui.safeProp(c.partOf.name),c.name)),i("}")}return i("return d")}});var Bu=k(_v=>{"use strict";var RA=_v,LA=p3();RA[".google.protobuf.Any"]={fromObject:function(n){if(n&&n["@type"]){var e=n["@type"].substring(n["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var i=n["@type"].charAt(0)==="."?n["@type"].slice(1):n["@type"];return i.indexOf("/")===-1&&(i="/"+i),this.create({type_url:i,value:t.encode(t.fromObject(n)).finish()})}}return this.fromObject(n)},toObject:function(n,e){var t="type.googleapis.com/",i="",r="";if(e&&e.json&&n.type_url&&n.value){r=n.type_url.substring(n.type_url.lastIndexOf("/")+1),i=n.type_url.substring(0,n.type_url.lastIndexOf("/")+1);var s=this.lookup(r);s&&(n=s.decode(n.value))}if(!(n instanceof this.ctor)&&n instanceof LA){var o=n.$type.toObject(n,e),a=n.$type.fullName[0]==="."?n.$type.fullName.slice(1):n.$type.fullName;return i===""&&(i=t),r=i+a,o["@type"]=r,o}return this.toObject(n,e)}}});var y3=k((cQ,Sv)=>{"use strict";Sv.exports=Je;var bi=Oo();((Je.prototype=Object.create(bi.prototype)).constructor=Je).className="Type";var VA=wi(),Uu=Mo(),g3=ts(),NA=d3(),PA=m3(),Fu=p3(),qu=a3(),HA=s3(),en=jt(),BA=ju(),FA=ku(),qA=Vu(),Cv=Hu(),UA=Bu();function Je(n,e){bi.call(this,n,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(Je.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var n=Object.keys(this.fields),e=0;e<n.length;++e){var t=this.fields[n[e]],i=t.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=en.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=en.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=Je.generateConstructor(this)())},set:function(n){var e=n.prototype;e instanceof Fu||((n.prototype=new Fu).constructor=n,en.merge(n.prototype,e)),n.$type=n.prototype.$type=this,en.merge(n,Fu,!0),this._ctor=n;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var i={};for(t=0;t<this.oneofsArray.length;++t)i[this._oneofsArray[t].resolve().name]={get:en.oneOfGetter(this._oneofsArray[t].oneof),set:en.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(n.prototype,i)}}});Je.generateConstructor=function(e){for(var t=en.codegen(["p"],e.name),i=0,r;i<e.fieldsArray.length;++i)(r=e._fieldsArray[i]).map?t("this%s={}",en.safeProp(r.name)):r.repeated&&t("this%s=[]",en.safeProp(r.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function v3(n){return n._fieldsById=n._fieldsArray=n._oneofsArray=null,delete n.encode,delete n.decode,delete n.verify,n}Je.fromJSON=function(e,t){var i=new Je(e,t.options);i.extensions=t.extensions,i.reserved=t.reserved;for(var r=Object.keys(t.fields),s=0;s<r.length;++s)i.add((typeof t.fields[r[s]].keyType<"u"?NA.fromJSON:g3.fromJSON)(r[s],t.fields[r[s]]));if(t.oneofs)for(r=Object.keys(t.oneofs),s=0;s<r.length;++s)i.add(Uu.fromJSON(r[s],t.oneofs[r[s]]));if(t.nested)for(r=Object.keys(t.nested),s=0;s<r.length;++s){var o=t.nested[r[s]];i.add((o.id!==void 0?g3.fromJSON:o.fields!==void 0?Je.fromJSON:o.values!==void 0?VA.fromJSON:o.methods!==void 0?PA.fromJSON:bi.fromJSON)(r[s],o))}return t.extensions&&t.extensions.length&&(i.extensions=t.extensions),t.reserved&&t.reserved.length&&(i.reserved=t.reserved),t.group&&(i.group=!0),t.comment&&(i.comment=t.comment),i};Je.prototype.toJSON=function(e){var t=bi.prototype.toJSON.call(this,e),i=e?!!e.keepComments:!1;return en.toObject(["options",t&&t.options||void 0,"oneofs",bi.arrayToJSON(this.oneofsArray,e),"fields",bi.arrayToJSON(this.fieldsArray.filter(function(r){return!r.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])};Je.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var i=this.oneofsArray;for(t=0;t<i.length;)i[t++].resolve();return bi.prototype.resolveAll.call(this)};Je.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};Je.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof g3&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),v3(this)}return e instanceof Uu?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),v3(this)):bi.prototype.add.call(this,e)};Je.prototype.remove=function(e){if(e instanceof g3&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),v3(this)}if(e instanceof Uu){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),v3(this)}return bi.prototype.remove.call(this,e)};Je.prototype.isReservedId=function(e){return bi.isReservedId(this.reserved,e)};Je.prototype.isReservedName=function(e){return bi.isReservedName(this.reserved,e)};Je.prototype.create=function(e){return new this.ctor(e)};Je.prototype.setup=function(){for(var e=this.fullName,t=[],i=0;i<this.fieldsArray.length;++i)t.push(this._fieldsArray[i].resolve().resolvedType);this.encode=BA(this)({Writer:HA,types:t,util:en}),this.decode=FA(this)({Reader:qu,types:t,util:en}),this.verify=qA(this)({types:t,util:en}),this.fromObject=Cv.fromObject(this)({types:t,util:en}),this.toObject=Cv.toObject(this)({types:t,util:en});var r=UA[e];if(r){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(s),s.toObject=this.toObject,this.toObject=r.toObject.bind(s)}return this};Je.prototype.encode=function(e,t){return this.setup().encode(e,t)};Je.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};Je.prototype.decode=function(e,t){return this.setup().decode(e,t)};Je.prototype.decodeDelimited=function(e){return e instanceof qu||(e=qu.create(e)),this.decode(e,e.uint32())};Je.prototype.verify=function(e){return this.setup().verify(e)};Je.prototype.fromObject=function(e){return this.setup().fromObject(e)};Je.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};Je.d=function(e){return function(i){en.decorateType(i,e)}}});var _3=k((lQ,xv)=>{"use strict";xv.exports=Ln;var b3=Oo();((Ln.prototype=Object.create(b3.prototype)).constructor=Ln).className="Root";var $u=ts(),Ev=wi(),jA=Mo(),is=jt(),Mv,Wu,E4;function Ln(n){b3.call(this,"",n),this.deferred=[],this.files=[]}Ln.fromJSON=function(e,t){return t||(t=new Ln),e.options&&t.setOptions(e.options),t.addJSON(e.nested)};Ln.prototype.resolvePath=is.path.resolve;Ln.prototype.fetch=is.fetch;function zv(){}Ln.prototype.load=function n(e,t,i){typeof t=="function"&&(i=t,t=void 0);var r=this;if(!i)return is.asPromise(n,r,e,t);var s=i===zv;function o(g,_){if(i){if(s)throw g;var T=i;i=null,T(g,_)}}function a(g){var _=g.lastIndexOf("google/protobuf/");if(_>-1){var T=g.substring(_);if(T in E4)return T}return null}function c(g,_){try{if(is.isString(_)&&_.charAt(0)==="{"&&(_=JSON.parse(_)),!is.isString(_))r.setOptions(_.options).addJSON(_.nested);else{Wu.filename=g;var T=Wu(_,r,t),E,L=0;if(T.imports)for(;L<T.imports.length;++L)(E=a(T.imports[L])||r.resolvePath(g,T.imports[L]))&&l(E);if(T.weakImports)for(L=0;L<T.weakImports.length;++L)(E=a(T.weakImports[L])||r.resolvePath(g,T.weakImports[L]))&&l(E,!0)}}catch(x){o(x)}!s&&!u&&o(null,r)}function l(g,_){if(g=a(g)||g,!(r.files.indexOf(g)>-1)){if(r.files.push(g),g in E4){s?c(g,E4[g]):(++u,setTimeout(function(){--u,c(g,E4[g])}));return}if(s){var T;try{T=is.fs.readFileSync(g).toString("utf8")}catch(E){_||o(E);return}c(g,T)}else++u,r.fetch(g,function(E,L){if(--u,!!i){if(E){_?u||o(null,r):o(E);return}c(g,L)}})}}var u=0;is.isString(e)&&(e=[e]);for(var h=0,d;h<e.length;++h)(d=r.resolvePath("",e[h]))&&l(d);if(s)return r;u||o(null,r)};Ln.prototype.loadSync=function(e,t){if(!is.isNode)throw Error("not supported");return this.load(e,t,zv)};Ln.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return b3.prototype.resolveAll.call(this)};var w3=/^[A-Z]/;function Tv(n,e){var t=e.parent.lookup(e.extend);if(t){var i=new $u(e.fullName,e.id,e.type,e.rule,void 0,e.options);return t.get(i.name)||(i.declaringField=e,e.extensionField=i,t.add(i)),!0}return!1}Ln.prototype._handleAdd=function(e){if(e instanceof $u)e.extend!==void 0&&!e.extensionField&&(Tv(this,e)||this.deferred.push(e));else if(e instanceof Ev)w3.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof jA)){if(e instanceof Mv)for(var t=0;t<this.deferred.length;)Tv(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var i=0;i<e.nestedArray.length;++i)this._handleAdd(e._nestedArray[i]);w3.test(e.name)&&(e.parent[e.name]=e)}};Ln.prototype._handleRemove=function(e){if(e instanceof $u){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof Ev)w3.test(e.name)&&delete e.parent[e.name];else if(e instanceof b3){for(var i=0;i<e.nestedArray.length;++i)this._handleRemove(e._nestedArray[i]);w3.test(e.name)&&delete e.parent[e.name]}};Ln._configure=function(n,e,t){Mv=n,Wu=e,E4=t}});var jt=k((uQ,Iv)=>{"use strict";var Mt=Iv.exports=Bi(),Ov=Su(),Gu,Yu;Mt.codegen=Yg();Mt.fetch=Qg();Mt.path=Jg();Mt.fs=Mt.inquire("fs");Mt.toArray=function(e){if(e){for(var t=Object.keys(e),i=new Array(t.length),r=0;r<t.length;)i[r]=e[t[r++]];return i}return[]};Mt.toObject=function(e){for(var t={},i=0;i<e.length;){var r=e[i++],s=e[i++];s!==void 0&&(t[r]=s)}return t};var WA=/\\/g,$A=/"/g;Mt.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};Mt.safeProp=function(e){return!/^[$\w_]+$/.test(e)||Mt.isReserved(e)?'["'+e.replace(WA,"\\\\").replace($A,'\\"')+'"]':"."+e};Mt.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var GA=/_([a-z])/g;Mt.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(GA,function(t,i){return i.toUpperCase()})};Mt.compareFieldsById=function(e,t){return e.id-t.id};Mt.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(Mt.decorateRoot.remove(e.$type),e.$type.name=t,Mt.decorateRoot.add(e.$type)),e.$type;Gu||(Gu=y3());var i=new Gu(t||e.name);return Mt.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var YA=0;Mt.decorateEnum=function(e){if(e.$type)return e.$type;Yu||(Yu=wi());var t=new Yu("Enum"+YA++,e);return Mt.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};Mt.setProperty=function(e,t,i){function r(s,o,a){var c=o.shift();if(c==="__proto__"||c==="prototype")return s;if(o.length>0)s[c]=r(s[c]||{},o,a);else{var l=s[c];l&&(a=[].concat(l).concat(a)),s[c]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),r(e,t,i)};Object.defineProperty(Mt,"decorateRoot",{get:function(){return Ov.decorated||(Ov.decorated=new(_3()))}})});var n1=k((hQ,Av)=>{"use strict";Av.exports=Vn;Vn.className="ReflectionObject";var C3=jt(),S3;function Vn(n,e){if(!C3.isString(n))throw TypeError("name must be a string");if(e&&!C3.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=n,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(Vn.prototype,{root:{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n}},fullName:{get:function(){for(var n=[this.name],e=this.parent;e;)n.unshift(e.name),e=e.parent;return n.join(".")}}});Vn.prototype.toJSON=function(){throw Error()};Vn.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof S3&&t._handleAdd(this)};Vn.prototype.onRemove=function(e){var t=e.root;t instanceof S3&&t._handleRemove(this),this.parent=null,this.resolved=!1};Vn.prototype.resolve=function(){return this.resolved?this:(this.root instanceof S3&&(this.resolved=!0),this)};Vn.prototype.getOption=function(e){if(this.options)return this.options[e]};Vn.prototype.setOption=function(e,t,i){return(!i||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=t),this};Vn.prototype.setParsedOption=function(e,t,i){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(i){var s=r.find(function(c){return Object.prototype.hasOwnProperty.call(c,e)});if(s){var o=s[e];C3.setProperty(o,i,t)}else s={},s[e]=C3.setProperty({},i,t),r.push(s)}else{var a={};a[e]=t,r.push(a)}return this};Vn.prototype.setOptions=function(e,t){if(e)for(var i=Object.keys(e),r=0;r<i.length;++r)this.setOption(i[r],e[i[r]],t);return this};Vn.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};Vn._configure=function(n){S3=n}});var wi=k((dQ,Rv)=>{"use strict";Rv.exports=ji;var Dv=n1();((ji.prototype=Object.create(Dv.prototype)).constructor=ji).className="Enum";var kv=Oo(),T3=jt();function ji(n,e,t,i,r,s){if(Dv.call(this,n,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=r||{},this.valuesOptions=s,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}ji.fromJSON=function(e,t){var i=new ji(e,t.values,t.options,t.comment,t.comments);return i.reserved=t.reserved,i};ji.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return T3.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};ji.prototype.add=function(e,t,i,r){if(!T3.isString(e))throw TypeError("name must be a string");if(!T3.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return r&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=r||null),this.comments[e]=i||null,this};ji.prototype.remove=function(e){if(!T3.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};ji.prototype.isReservedId=function(e){return kv.isReservedId(this.reserved,e)};ji.prototype.isReservedName=function(e){return kv.isReservedName(this.reserved,e)}});var ju=k((fQ,Vv)=>{"use strict";Vv.exports=QA;var KA=wi(),Ku=t1(),Qu=jt();function Lv(n,e,t,i){return e.resolvedType.group?n("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,i,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):n("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,i,(e.id<<3|2)>>>0)}function QA(n){for(var e=Qu.codegen(["m","w"],n.name+"$encode")("if(!w)")("w=Writer.create()"),t,i,r=n.fieldsArray.slice().sort(Qu.compareFieldsById),t=0;t<r.length;++t){var s=r[t].resolve(),o=n._fieldsArray.indexOf(s),a=s.resolvedType instanceof KA?"int32":s.type,c=Ku.basic[a];i="m"+Qu.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",i,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",i)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|Ku.mapKey[s.keyType],s.keyType),c===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,i):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|c,a,i),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",i,i),s.packed&&Ku.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",i)("w.%s(%s[i])",a,i)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",i),c===void 0?Lv(e,s,o,i+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|c)>>>0,a,i)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",i,s.name),c===void 0?Lv(e,s,o,i):e("w.uint32(%i).%s(%s)",(s.id<<3|c)>>>0,a,i))}return e("return w")}});var Pv=k((mQ,Nv)=>{"use strict";var Me=Nv.exports=$g();Me.build="light";function XA(n,e,t){return typeof e=="function"?(t=e,e=new Me.Root):e||(e=new Me.Root),e.load(n,t)}Me.load=XA;function ZA(n,e){return e||(e=new Me.Root),e.loadSync(n)}Me.loadSync=ZA;Me.encoder=ju();Me.decoder=ku();Me.verifier=Vu();Me.converter=Hu();Me.ReflectionObject=n1();Me.Namespace=Oo();Me.Root=_3();Me.Enum=wi();Me.Type=y3();Me.Field=ts();Me.OneOf=Mo();Me.MapField=d3();Me.Service=m3();Me.Method=f3();Me.Message=p3();Me.wrappers=Bu();Me.types=t1();Me.util=jt();Me.ReflectionObject._configure(Me.Root);Me.Namespace._configure(Me.Type,Me.Service,Me.Enum);Me.Root._configure(Me.Type);Me.Field._configure(Me.Type)});var Zu=k((pQ,Fv)=>{"use strict";Fv.exports=Bv;var Xu=/[\s{}=;:[\],'"()<>]/g,JA=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,eD=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,tD=/^ *[*/]+ */,nD=/^\s*\*?\/*/,iD=/\n/g,rD=/\s/,sD=/\\(.?)/g,oD={0:"\0",r:"\r",n:`
`,t:"	"};function Hv(n){return n.replace(sD,function(e,t){switch(t){case"\\":case"":return t;default:return oD[t]||""}})}Bv.unescape=Hv;function Bv(n,e){n=n.toString();var t=0,i=n.length,r=1,s=0,o={},a=[],c=null;function l(P){return Error("illegal "+P+" (line "+r+")")}function u(){var P=c==="'"?eD:JA;P.lastIndex=t-1;var G=P.exec(n);if(!G)throw l("string");return t=P.lastIndex,E(c),c=null,Hv(G[1])}function h(P){return n.charAt(P)}function d(P,G,K){var w={type:n.charAt(P++),lineEmpty:!1,leading:K},v;e?v=2:v=3;var y=P-v,b;do if(--y<0||(b=n.charAt(y))===`
`){w.lineEmpty=!0;break}while(b===" "||b==="	");for(var m=n.substring(P,G).split(iD),C=0;C<m.length;++C)m[C]=m[C].replace(e?nD:tD,"").trim();w.text=m.join(`
`).trim(),o[r]=w,s=r}function g(P){var G=_(P),K=n.substring(P,G),w=/^\s*\/\//.test(K);return w}function _(P){for(var G=P;G<i&&h(G)!==`
`;)G++;return G}function T(){if(a.length>0)return a.shift();if(c)return u();var P,G,K,w,v,y=t===0;do{if(t===i)return null;for(P=!1;rD.test(K=h(t));)if(K===`
`&&(y=!0,++r),++t===i)return null;if(h(t)==="/"){if(++t===i)throw l("comment");if(h(t)==="/")if(e){if(w=t,v=!1,g(t-1)){v=!0;do if(t=_(t),t===i||(t++,!y))break;while(g(t))}else t=Math.min(i,_(t)+1);v&&(d(w,t,y),y=!0),r++,P=!0}else{for(v=h(w=t+1)==="/";h(++t)!==`
`;)if(t===i)return null;++t,v&&(d(w,t-1,y),y=!0),++r,P=!0}else if((K=h(t))==="*"){w=t+1,v=e||h(w)==="*";do{if(K===`
`&&++r,++t===i)throw l("comment");G=K,K=h(t)}while(G!=="*"||K!=="/");++t,v&&(d(w,t-2,y),y=!0),P=!0}else return"/"}}while(P);var b=t;Xu.lastIndex=0;var m=Xu.test(h(b++));if(!m)for(;b<i&&!Xu.test(h(b));)++b;var C=n.substring(t,t=b);return(C==='"'||C==="'")&&(c=C),C}function E(P){a.push(P)}function L(){if(!a.length){var P=T();if(P===null)return null;E(P)}return a[0]}function x(P,G){var K=L(),w=K===P;if(w)return T(),!0;if(!G)throw l("token '"+K+"', '"+P+"' expected");return!1}function V(P){var G=null,K;return P===void 0?(K=o[r-1],delete o[r-1],K&&(e||K.type==="*"||K.lineEmpty)&&(G=K.leading?K.text:null)):(s<P&&L(),K=o[P],delete o[P],K&&!K.lineEmpty&&(e||K.type==="/")&&(G=K.leading?null:K.text)),G}return Object.defineProperty({next:T,peek:L,push:E,skip:x,cmnt:V},"line",{get:function(){return r}})}});var Gv=k((gQ,$v)=>{"use strict";$v.exports=br;br.filename=null;br.defaults={keepCase:!1};var aD=Zu(),qv=_3(),Uv=y3(),jv=ts(),cD=d3(),Wv=Mo(),lD=wi(),uD=m3(),hD=f3(),Ju=t1(),eh=jt(),dD=/^[1-9][0-9]*$/,fD=/^-?[1-9][0-9]*$/,mD=/^0[x][0-9a-fA-F]+$/,pD=/^-?0[x][0-9a-fA-F]+$/,gD=/^0[0-7]+$/,vD=/^-?0[0-7]+$/,yD=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,Wi=/^[a-zA-Z_][a-zA-Z_0-9]*$/,$i=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,wD=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function br(n,e,t){e instanceof qv||(t=e,e=new qv),t||(t=br.defaults);var i=t.preferTrailingComment||!1,r=aD(n,t.alternateCommentMode||!1),s=r.next,o=r.push,a=r.peek,c=r.skip,l=r.cmnt,u=!0,h,d,g,_,T=!1,E=e,L=t.keepCase?function(I){return I}:eh.camelCase;function x(I,R,U){var re=br.filename;return U||(br.filename=null),Error("illegal "+(R||"token")+" '"+I+"' ("+(re?re+", ":"")+"line "+r.line+")")}function V(){var I=[],R;do{if((R=s())!=='"'&&R!=="'")throw x(R);I.push(s()),c(R),R=a()}while(R==='"'||R==="'");return I.join("")}function P(I){var R=s();switch(R){case"'":case'"':return o(R),V();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return K(R,!0)}catch{if(I&&$i.test(R))return R;throw x(R,"value")}}function G(I,R){var U,re;do R&&((U=a())==='"'||U==="'")?I.push(V()):I.push([re=w(s()),c("to",!0)?w(s()):re]);while(c(",",!0));var te={options:void 0};te.setOption=function(he,Xe){this.options===void 0&&(this.options={}),this.options[he]=Xe},C(te,function(Xe){if(Xe==="option")je(te,Xe),c(";");else throw x(Xe)},function(){vt(te)})}function K(I,R){var U=1;switch(I.charAt(0)==="-"&&(U=-1,I=I.substring(1)),I){case"inf":case"INF":case"Inf":return U*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(dD.test(I))return U*parseInt(I,10);if(mD.test(I))return U*parseInt(I,16);if(gD.test(I))return U*parseInt(I,8);if(yD.test(I))return U*parseFloat(I);throw x(I,"number",R)}function w(I,R){switch(I){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!R&&I.charAt(0)==="-")throw x(I,"id");if(fD.test(I))return parseInt(I,10);if(pD.test(I))return parseInt(I,16);if(vD.test(I))return parseInt(I,8);throw x(I,"id")}function v(){if(h!==void 0)throw x("package");if(h=s(),!$i.test(h))throw x(h,"name");E=E.define(h),c(";")}function y(){var I=a(),R;switch(I){case"weak":R=g||(g=[]),s();break;case"public":s();default:R=d||(d=[]);break}I=V(),c(";"),R.push(I)}function b(){if(c("="),_=V(),T=_==="proto3",!T&&_!=="proto2")throw x(_,"syntax");e.setOption("syntax",_),c(";")}function m(I,R){switch(R){case"option":return je(I,R),c(";"),!0;case"message":return f(I,R),!0;case"enum":return Ne(I,R),!0;case"service":return ht(I,R),!0;case"extend":return ui(I,R),!0}return!1}function C(I,R,U){var re=r.line;if(I&&(typeof I.comment!="string"&&(I.comment=l()),I.filename=br.filename),c("{",!0)){for(var te;(te=s())!=="}";)R(te);c(";",!0)}else U&&U(),c(";"),I&&(typeof I.comment!="string"||i)&&(I.comment=l(re)||I.comment)}function f(I,R){if(!Wi.test(R=s()))throw x(R,"type name");var U=new Uv(R);C(U,function(te){if(!m(U,te))switch(te){case"map":le(U,te);break;case"required":case"repeated":p(U,te);break;case"optional":T?p(U,"proto3_optional"):p(U,"optional");break;case"oneof":Ae(U,te);break;case"extensions":G(U.extensions||(U.extensions=[]));break;case"reserved":G(U.reserved||(U.reserved=[]),!0);break;default:if(!T||!$i.test(te))throw x(te);o(te),p(U,"optional");break}}),I.add(U)}function p(I,R,U){var re=s();if(re==="group"){F(I,R);return}for(;re.endsWith(".")||a().startsWith(".");)re+=s();if(!$i.test(re))throw x(re,"type");var te=s();if(!Wi.test(te))throw x(te,"name");te=L(te),c("=");var he=new jv(te,w(s()),re,R,U);if(C(he,function(Dn){if(Dn==="option")je(he,Dn),c(";");else throw x(Dn)},function(){vt(he)}),R==="proto3_optional"){var Xe=new Wv("_"+te);he.setOption("proto3_optional",!0),Xe.add(he),I.add(Xe)}else I.add(he);!T&&he.repeated&&(Ju.packed[re]!==void 0||Ju.basic[re]===void 0)&&he.setOption("packed",!1,!0)}function F(I,R){var U=s();if(!Wi.test(U))throw x(U,"name");var re=eh.lcFirst(U);U===re&&(U=eh.ucFirst(U)),c("=");var te=w(s()),he=new Uv(U);he.group=!0;var Xe=new jv(re,te,U,R);Xe.filename=br.filename,C(he,function(Dn){switch(Dn){case"option":je(he,Dn),c(";");break;case"required":case"repeated":p(he,Dn);break;case"optional":T?p(he,"proto3_optional"):p(he,"optional");break;case"message":f(he,Dn);break;case"enum":Ne(he,Dn);break;default:throw x(Dn)}}),I.add(he).add(Xe)}function le(I){c("<");var R=s();if(Ju.mapKey[R]===void 0)throw x(R,"type");c(",");var U=s();if(!$i.test(U))throw x(U,"type");c(">");var re=s();if(!Wi.test(re))throw x(re,"name");c("=");var te=new cD(L(re),w(s()),R,U);C(te,function(Xe){if(Xe==="option")je(te,Xe),c(";");else throw x(Xe)},function(){vt(te)}),I.add(te)}function Ae(I,R){if(!Wi.test(R=s()))throw x(R,"name");var U=new Wv(L(R));C(U,function(te){te==="option"?(je(U,te),c(";")):(o(te),p(U,"optional"))}),I.add(U)}function Ne(I,R){if(!Wi.test(R=s()))throw x(R,"name");var U=new lD(R);C(U,function(te){switch(te){case"option":je(U,te),c(";");break;case"reserved":G(U.reserved||(U.reserved=[]),!0);break;default:ot(U,te)}}),I.add(U)}function ot(I,R){if(!Wi.test(R))throw x(R,"name");c("=");var U=w(s(),!0),re={options:void 0};re.setOption=function(te,he){this.options===void 0&&(this.options={}),this.options[te]=he},C(re,function(he){if(he==="option")je(re,he),c(";");else throw x(he)},function(){vt(re)}),I.add(R,U,re.comment,re.options)}function je(I,R){var U=c("(",!0);if(!$i.test(R=s()))throw x(R,"name");var re=R,te=re,he;U&&(c(")"),re="("+re+")",te=re,R=a(),wD.test(R)&&(he=R.slice(1),re+=R,s())),c("=");var Xe=Vt(I,re);nt(I,te,Xe,he)}function Vt(I,R){if(c("{",!0)){for(var U={};!c("}",!0);){if(!Wi.test(Ce=s()))throw x(Ce,"name");if(Ce===null)throw x(Ce,"end of input");var re,te=Ce;if(c(":",!0),a()==="{")re=Vt(I,R+"."+Ce);else if(a()==="["){re=[];var he;if(c("[",!0)){do he=P(!0),re.push(he);while(c(",",!0));c("]"),typeof he<"u"&&Qe(I,R+"."+Ce,he)}}else re=P(!0),Qe(I,R+"."+Ce,re);var Xe=U[te];Xe&&(re=[].concat(Xe).concat(re)),U[te]=re,c(",",!0),c(";",!0)}return U}var Pr=P(!0);return Qe(I,R,Pr),Pr}function Qe(I,R,U){I.setOption&&I.setOption(R,U)}function nt(I,R,U,re){I.setParsedOption&&I.setParsedOption(R,U,re)}function vt(I){if(c("[",!0)){do je(I,"option");while(c(",",!0));c("]")}return I}function ht(I,R){if(!Wi.test(R=s()))throw x(R,"service name");var U=new uD(R);C(U,function(te){if(!m(U,te))if(te==="rpc")Ft(U,te);else throw x(te)}),I.add(U)}function Ft(I,R){var U=l(),re=R;if(!Wi.test(R=s()))throw x(R,"name");var te=R,he,Xe,Pr,Dn;if(c("("),c("stream",!0)&&(Xe=!0),!$i.test(R=s())||(he=R,c(")"),c("returns"),c("("),c("stream",!0)&&(Dn=!0),!$i.test(R=s())))throw x(R);Pr=R,c(")");var pc=new hD(te,re,he,Pr,Xe,Dn);pc.comment=U,C(pc,function(J8){if(J8==="option")je(pc,J8),c(";");else throw x(J8)}),I.add(pc)}function ui(I,R){if(!$i.test(R=s()))throw x(R,"reference");var U=R;C(null,function(te){switch(te){case"required":case"repeated":p(I,te,U);break;case"optional":T?p(I,"proto3_optional",U):p(I,"optional",U);break;default:if(!T||!$i.test(te))throw x(te);o(te),p(I,"optional",U);break}})}for(var Ce;(Ce=s())!==null;)switch(Ce){case"package":if(!u)throw x(Ce);v();break;case"import":if(!u)throw x(Ce);y();break;case"syntax":if(!u)throw x(Ce);b();break;case"option":je(E,Ce),c(";");break;default:if(m(E,Ce)){u=!1;continue}throw x(Ce)}return br.filename=null,{package:h,imports:d,weakImports:g,syntax:_,root:e}}});var Qv=k((vQ,Kv)=>{"use strict";Kv.exports=_i;var bD=/\/|\./;function _i(n,e){bD.test(n)||(n="google/protobuf/"+n+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),_i[n]=e}_i("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var Yv;_i("duration",{Duration:Yv={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});_i("timestamp",{Timestamp:Yv});_i("empty",{Empty:{fields:{}}});_i("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});_i("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});_i("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});_i.get=function(e){return _i[e]||null}});var Zv=k((yQ,Xv)=>{"use strict";var rs=Xv.exports=Pv();rs.build="full";rs.tokenize=Zu();rs.parse=Gv();rs.common=Qv();rs.Root._configure(rs.Type,rs.parse,rs.common)});var E3=k((wQ,Jv)=>{"use strict";Jv.exports=Zv()});var th=k((bQ,_D)=>{_D.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var ry=k((ye,iy)=>{"use strict";var un=E3();iy.exports=ye=un.descriptor=un.Root.fromJSON(th()).lookup(".google.protobuf");var ey=un.Namespace,M4=un.Root,_r=un.Enum,ss=un.Type,os=un.Field,CD=un.MapField,M3=un.OneOf,z4=un.Service,z3=un.Method;M4.fromDescriptor=function(e){typeof e.length=="number"&&(e=ye.FileDescriptorSet.decode(e));var t=new M4;if(e.file)for(var i,r,s=0,o;s<e.file.length;++s){if(r=t,(i=e.file[s]).package&&i.package.length&&(r=t.define(i.package)),i.name&&i.name.length&&t.files.push(r.filename=i.name),i.messageType)for(o=0;o<i.messageType.length;++o)r.add(ss.fromDescriptor(i.messageType[o],i.syntax));if(i.enumType)for(o=0;o<i.enumType.length;++o)r.add(_r.fromDescriptor(i.enumType[o]));if(i.extension)for(o=0;o<i.extension.length;++o)r.add(os.fromDescriptor(i.extension[o]));if(i.service)for(o=0;o<i.service.length;++o)r.add(z4.fromDescriptor(i.service[o]));var a=Ao(i.options,ye.FileOptions);if(a){var c=Object.keys(a);for(o=0;o<c.length;++o)r.setOption(c[o],a[c[o]])}}return t};M4.prototype.toDescriptor=function(e){var t=ye.FileDescriptorSet.create();return ty(this,t.file,e),t};function ty(n,e,t){var i=ye.FileDescriptorProto.create({name:n.filename||(n.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});t&&(i.syntax=t),n instanceof M4||(i.package=n.fullName.substring(1));for(var r=0,s;r<n.nestedArray.length;++r)(s=n._nestedArray[r])instanceof ss?i.messageType.push(s.toDescriptor(t)):s instanceof _r?i.enumType.push(s.toDescriptor()):s instanceof os?i.extension.push(s.toDescriptor(t)):s instanceof z4?i.service.push(s.toDescriptor()):s instanceof ey&&ty(s,e,t);i.options=Do(n.options,ye.FileOptions),i.messageType.length+i.enumType.length+i.extension.length+i.service.length&&e.push(i)}var SD=0;ss.fromDescriptor=function(e,t){typeof e.length=="number"&&(e=ye.DescriptorProto.decode(e));var i=new ss(e.name.length?e.name:"Type"+SD++,Ao(e.options,ye.MessageOptions)),r;if(e.oneofDecl)for(r=0;r<e.oneofDecl.length;++r)i.add(M3.fromDescriptor(e.oneofDecl[r]));if(e.field)for(r=0;r<e.field.length;++r){var s=os.fromDescriptor(e.field[r],t);i.add(s),e.field[r].hasOwnProperty("oneofIndex")&&i.oneofsArray[e.field[r].oneofIndex].add(s)}if(e.extension)for(r=0;r<e.extension.length;++r)i.add(os.fromDescriptor(e.extension[r],t));if(e.nestedType)for(r=0;r<e.nestedType.length;++r)i.add(ss.fromDescriptor(e.nestedType[r],t)),e.nestedType[r].options&&e.nestedType[r].options.mapEntry&&i.setOption("map_entry",!0);if(e.enumType)for(r=0;r<e.enumType.length;++r)i.add(_r.fromDescriptor(e.enumType[r]));if(e.extensionRange&&e.extensionRange.length)for(i.extensions=[],r=0;r<e.extensionRange.length;++r)i.extensions.push([e.extensionRange[r].start,e.extensionRange[r].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(i.reserved=[],e.reservedRange)for(r=0;r<e.reservedRange.length;++r)i.reserved.push([e.reservedRange[r].start,e.reservedRange[r].end]);if(e.reservedName)for(r=0;r<e.reservedName.length;++r)i.reserved.push(e.reservedName[r])}return i};ss.prototype.toDescriptor=function(e){var t=ye.DescriptorProto.create({name:this.name}),i;for(i=0;i<this.fieldsArray.length;++i){var r;if(t.field.push(r=this._fieldsArray[i].toDescriptor(e)),this._fieldsArray[i]instanceof CD){var s=nh(this._fieldsArray[i].keyType,this._fieldsArray[i].resolvedKeyType),o=nh(this._fieldsArray[i].type,this._fieldsArray[i].resolvedType),a=o===11||o===14?this._fieldsArray[i].resolvedType&&ny(this.parent,this._fieldsArray[i].resolvedType)||this._fieldsArray[i].type:void 0;t.nestedType.push(ye.DescriptorProto.create({name:r.typeName,field:[ye.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),ye.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:ye.MessageOptions.create({mapEntry:!0})}))}}for(i=0;i<this.oneofsArray.length;++i)t.oneofDecl.push(this._oneofsArray[i].toDescriptor());for(i=0;i<this.nestedArray.length;++i)this._nestedArray[i]instanceof os?t.field.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof ss?t.nestedType.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof _r&&t.enumType.push(this._nestedArray[i].toDescriptor());if(this.extensions)for(i=0;i<this.extensions.length;++i)t.extensionRange.push(ye.DescriptorProto.ExtensionRange.create({start:this.extensions[i][0],end:this.extensions[i][1]}));if(this.reserved)for(i=0;i<this.reserved.length;++i)typeof this.reserved[i]=="string"?t.reservedName.push(this.reserved[i]):t.reservedRange.push(ye.DescriptorProto.ReservedRange.create({start:this.reserved[i][0],end:this.reserved[i][1]}));return t.options=Do(this.options,ye.MessageOptions),t};var TD=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;os.fromDescriptor=function(e,t){if(typeof e.length=="number"&&(e=ye.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var i;e.typeName&&e.typeName.length?i=e.typeName:i=OD(e.type);var r;switch(e.label){case 1:r=void 0;break;case 2:r="required";break;case 3:r="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;e.extendee!==void 0&&(s=s.length?s:void 0);var o=new os(e.name.length?e.name:"field"+e.number,e.number,i,r,s);if(o.options=Ao(e.options,ye.FieldOptions),e.defaultValue&&e.defaultValue.length){var a=e.defaultValue;switch(a){case"true":case"TRUE":a=!0;break;case"false":case"FALSE":a=!1;break;default:var c=TD.exec(a);c&&(a=parseInt(a));break}o.setOption("default",a)}return ID(e.type)&&(t==="proto3"?e.options&&!e.options.packed&&o.setOption("packed",!1):e.options&&e.options.packed||o.setOption("packed",!1)),o};os.prototype.toDescriptor=function(e){var t=ye.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=un.util.ucFirst(this.name),t.label=3;else{switch(t.type=nh(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:t.typeName=this.resolvedType?ny(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":t.label=3;break;case"required":t.label=2;break;default:t.label=1;break}}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=Do(this.options,ye.FieldOptions),this.options.default!=null&&(t.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((t.options||(t.options=ye.FieldOptions.create())).packed=!1):this.packed&&((t.options||(t.options=ye.FieldOptions.create())).packed=!0),t};var ED=0;_r.fromDescriptor=function(e){typeof e.length=="number"&&(e=ye.EnumDescriptorProto.decode(e));var t={};if(e.value)for(var i=0;i<e.value.length;++i){var r=e.value[i].name,s=e.value[i].number||0;t[r&&r.length?r:"NAME"+s]=s}return new _r(e.name&&e.name.length?e.name:"Enum"+ED++,t,Ao(e.options,ye.EnumOptions))};_r.prototype.toDescriptor=function(){for(var e=[],t=0,i=Object.keys(this.values);t<i.length;++t)e.push(ye.EnumValueDescriptorProto.create({name:i[t],number:this.values[i[t]]}));return ye.EnumDescriptorProto.create({name:this.name,value:e,options:Do(this.options,ye.EnumOptions)})};var MD=0;M3.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ye.OneofDescriptorProto.decode(e)),new M3(e.name&&e.name.length?e.name:"oneof"+MD++)};M3.prototype.toDescriptor=function(){return ye.OneofDescriptorProto.create({name:this.name})};var zD=0;z4.fromDescriptor=function(e){typeof e.length=="number"&&(e=ye.ServiceDescriptorProto.decode(e));var t=new z4(e.name&&e.name.length?e.name:"Service"+zD++,Ao(e.options,ye.ServiceOptions));if(e.method)for(var i=0;i<e.method.length;++i)t.add(z3.fromDescriptor(e.method[i]));return t};z4.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return ye.ServiceDescriptorProto.create({name:this.name,method:e,options:Do(this.options,ye.ServiceOptions)})};var xD=0;z3.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ye.MethodDescriptorProto.decode(e)),new z3(e.name&&e.name.length?e.name:"Method"+xD++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,Ao(e.options,ye.MethodOptions))};z3.prototype.toDescriptor=function(){return ye.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:Do(this.options,ye.MethodOptions)})};function OD(n){switch(n){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+n)}function ID(n){switch(n){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function nh(n,e){switch(n){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof _r)return 14;if(e instanceof ss)return e.group?10:11;throw Error("illegal type: "+n)}function Ao(n,e){if(n){for(var t=[],i=0,r,s,o;i<e.fieldsArray.length;++i)(s=(r=e._fieldsArray[i]).name)!=="uninterpretedOption"&&n.hasOwnProperty(s)&&(o=n[s],r.resolvedType instanceof _r&&typeof o=="number"&&r.resolvedType.valuesById[o]!==void 0&&(o=r.resolvedType.valuesById[o]),t.push(AD(s),o));return t.length?un.util.toObject(t):void 0}}function Do(n,e){if(n){for(var t=[],i=0,r=Object.keys(n),s,o;i<r.length;++i)if(o=n[s=r[i]],s!=="default"){var a=e.fields[s];!a&&!(a=e.fields[s=un.util.camelCase(s)])||t.push(s,o)}return t.length?e.fromObject(un.util.toObject(t)):void 0}}function ny(n,e){var t=n.fullName.split("."),i=e.fullName.split("."),r=0,s=0,o=i.length-1;if(!(n instanceof M4)&&e instanceof ey)for(;r<t.length&&s<o&&t[r]===i[s];){var a=e.lookup(t[r++],!0);if(a!==null&&a!==e)break;++s}else for(;r<t.length&&s<o&&t[r]===i[s];++r,++s);return i.slice(s).join(".")}function AD(n){return n.substring(0,1)+n.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}});var sy=k((_Q,DD)=>{DD.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var oy=k((CQ,kD)=>{kD.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var ay=k((SQ,RD)=>{RD.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var hy=k(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.addCommonProtos=as.loadProtosWithOptionsSync=as.loadProtosWithOptions=void 0;var cy=He("fs"),ly=He("path"),ko=E3();function uy(n,e){let t=n.resolvePath;n.resolvePath=(i,r)=>{if(ly.isAbsolute(r))return r;for(let s of e){let o=ly.join(s,r);try{return cy.accessSync(o,cy.constants.R_OK),o}catch{continue}}return process.emitWarning(`${r} not found in any of the include paths ${e}`),t(i,r)}}function LD(n,e){return S(this,null,function*(){let t=new ko.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));uy(t,e.includeDirs)}let i=yield t.load(n,e);return i.resolveAll(),i})}as.loadProtosWithOptions=LD;function VD(n,e){let t=new ko.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");uy(t,e.includeDirs)}let i=t.loadSync(n,e);return i.resolveAll(),i}as.loadProtosWithOptionsSync=VD;function ND(){let n=sy(),e=th(),t=oy(),i=ay();ko.common("api",n.nested.google.nested.protobuf.nested),ko.common("descriptor",e.nested.google.nested.protobuf.nested),ko.common("source_context",t.nested.google.nested.protobuf.nested),ko.common("type",i.nested.google.nested.protobuf.nested)}as.addCommonProtos=ND});var my=k((fy,ih)=>{"use strict";var dy=function(n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(f,p,F){this.low=f|0,this.high=p|0,this.unsigned=!!F}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function i(f){return(f&&f.__isLong__)===!0}function r(f){var p=Math.clz32(f&-f);return f?31-p:p}t.isLong=i;var s={},o={};function a(f,p){var F,le,Ae;return p?(f>>>=0,(Ae=0<=f&&f<256)&&(le=o[f],le)?le:(F=l(f,0,!0),Ae&&(o[f]=F),F)):(f|=0,(Ae=-128<=f&&f<128)&&(le=s[f],le)?le:(F=l(f,f<0?-1:0,!1),Ae&&(s[f]=F),F))}t.fromInt=a;function c(f,p){if(isNaN(f))return p?P:V;if(p){if(f<0)return P;if(f>=E)return y}else{if(f<=-L)return b;if(f+1>=L)return v}return f<0?c(-f,p).neg():l(f%T|0,f/T|0,p)}t.fromNumber=c;function l(f,p,F){return new t(f,p,F)}t.fromBits=l;var u=Math.pow;function h(f,p,F){if(f.length===0)throw Error("empty string");if(typeof p=="number"?(F=p,p=!1):p=!!p,f==="NaN"||f==="Infinity"||f==="+Infinity"||f==="-Infinity")return p?P:V;if(F=F||10,F<2||36<F)throw RangeError("radix");var le;if((le=f.indexOf("-"))>0)throw Error("interior hyphen");if(le===0)return h(f.substring(1),p,F).neg();for(var Ae=c(u(F,8)),Ne=V,ot=0;ot<f.length;ot+=8){var je=Math.min(8,f.length-ot),Vt=parseInt(f.substring(ot,ot+je),F);if(je<8){var Qe=c(u(F,je));Ne=Ne.mul(Qe).add(c(Vt))}else Ne=Ne.mul(Ae),Ne=Ne.add(c(Vt))}return Ne.unsigned=p,Ne}t.fromString=h;function d(f,p){return typeof f=="number"?c(f,p):typeof f=="string"?h(f,p):l(f.low,f.high,typeof p=="boolean"?p:f.unsigned)}t.fromValue=d;var g=65536,_=1<<24,T=g*g,E=T*T,L=E/2,x=a(_),V=a(0);t.ZERO=V;var P=a(0,!0);t.UZERO=P;var G=a(1);t.ONE=G;var K=a(1,!0);t.UONE=K;var w=a(-1);t.NEG_ONE=w;var v=l(-1,2147483647,!1);t.MAX_VALUE=v;var y=l(-1,-1,!0);t.MAX_UNSIGNED_VALUE=y;var b=l(0,-2147483648,!1);t.MIN_VALUE=b;var m=t.prototype;m.toInt=function(){return this.unsigned?this.low>>>0:this.low},m.toNumber=function(){return this.unsigned?(this.high>>>0)*T+(this.low>>>0):this.high*T+(this.low>>>0)},m.toString=function(p){if(p=p||10,p<2||36<p)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(b)){var F=c(p),le=this.div(F),Ae=le.mul(F).sub(this);return le.toString(p)+Ae.toInt().toString(p)}else return"-"+this.neg().toString(p);for(var Ne=c(u(p,6),this.unsigned),ot=this,je="";;){var Vt=ot.div(Ne),Qe=ot.sub(Vt.mul(Ne)).toInt()>>>0,nt=Qe.toString(p);if(ot=Vt,ot.isZero())return nt+je;for(;nt.length<6;)nt="0"+nt;je=""+nt+je}},m.getHighBits=function(){return this.high},m.getHighBitsUnsigned=function(){return this.high>>>0},m.getLowBits=function(){return this.low},m.getLowBitsUnsigned=function(){return this.low>>>0},m.getNumBitsAbs=function(){if(this.isNegative())return this.eq(b)?64:this.neg().getNumBitsAbs();for(var p=this.high!=0?this.high:this.low,F=31;F>0&&!(p&1<<F);F--);return this.high!=0?F+33:F+1},m.isZero=function(){return this.high===0&&this.low===0},m.eqz=m.isZero,m.isNegative=function(){return!this.unsigned&&this.high<0},m.isPositive=function(){return this.unsigned||this.high>=0},m.isOdd=function(){return(this.low&1)===1},m.isEven=function(){return(this.low&1)===0},m.equals=function(p){return i(p)||(p=d(p)),this.unsigned!==p.unsigned&&this.high>>>31===1&&p.high>>>31===1?!1:this.high===p.high&&this.low===p.low},m.eq=m.equals,m.notEquals=function(p){return!this.eq(p)},m.neq=m.notEquals,m.ne=m.notEquals,m.lessThan=function(p){return this.comp(p)<0},m.lt=m.lessThan,m.lessThanOrEqual=function(p){return this.comp(p)<=0},m.lte=m.lessThanOrEqual,m.le=m.lessThanOrEqual,m.greaterThan=function(p){return this.comp(p)>0},m.gt=m.greaterThan,m.greaterThanOrEqual=function(p){return this.comp(p)>=0},m.gte=m.greaterThanOrEqual,m.ge=m.greaterThanOrEqual,m.compare=function(p){if(i(p)||(p=d(p)),this.eq(p))return 0;var F=this.isNegative(),le=p.isNegative();return F&&!le?-1:!F&&le?1:this.unsigned?p.high>>>0>this.high>>>0||p.high===this.high&&p.low>>>0>this.low>>>0?-1:1:this.sub(p).isNegative()?-1:1},m.comp=m.compare,m.negate=function(){return!this.unsigned&&this.eq(b)?b:this.not().add(G)},m.neg=m.negate,m.add=function(p){i(p)||(p=d(p));var F=this.high>>>16,le=this.high&65535,Ae=this.low>>>16,Ne=this.low&65535,ot=p.high>>>16,je=p.high&65535,Vt=p.low>>>16,Qe=p.low&65535,nt=0,vt=0,ht=0,Ft=0;return Ft+=Ne+Qe,ht+=Ft>>>16,Ft&=65535,ht+=Ae+Vt,vt+=ht>>>16,ht&=65535,vt+=le+je,nt+=vt>>>16,vt&=65535,nt+=F+ot,nt&=65535,l(ht<<16|Ft,nt<<16|vt,this.unsigned)},m.subtract=function(p){return i(p)||(p=d(p)),this.add(p.neg())},m.sub=m.subtract,m.multiply=function(p){if(this.isZero())return this;if(i(p)||(p=d(p)),e){var F=e.mul(this.low,this.high,p.low,p.high);return l(F,e.get_high(),this.unsigned)}if(p.isZero())return this.unsigned?P:V;if(this.eq(b))return p.isOdd()?b:V;if(p.eq(b))return this.isOdd()?b:V;if(this.isNegative())return p.isNegative()?this.neg().mul(p.neg()):this.neg().mul(p).neg();if(p.isNegative())return this.mul(p.neg()).neg();if(this.lt(x)&&p.lt(x))return c(this.toNumber()*p.toNumber(),this.unsigned);var le=this.high>>>16,Ae=this.high&65535,Ne=this.low>>>16,ot=this.low&65535,je=p.high>>>16,Vt=p.high&65535,Qe=p.low>>>16,nt=p.low&65535,vt=0,ht=0,Ft=0,ui=0;return ui+=ot*nt,Ft+=ui>>>16,ui&=65535,Ft+=Ne*nt,ht+=Ft>>>16,Ft&=65535,Ft+=ot*Qe,ht+=Ft>>>16,Ft&=65535,ht+=Ae*nt,vt+=ht>>>16,ht&=65535,ht+=Ne*Qe,vt+=ht>>>16,ht&=65535,ht+=ot*Vt,vt+=ht>>>16,ht&=65535,vt+=le*nt+Ae*Qe+Ne*Vt+ot*je,vt&=65535,l(Ft<<16|ui,vt<<16|ht,this.unsigned)},m.mul=m.multiply,m.divide=function(p){if(i(p)||(p=d(p)),p.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&p.low===-1&&p.high===-1)return this;var F=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,p.low,p.high);return l(F,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?P:V;var le,Ae,Ne;if(this.unsigned){if(p.unsigned||(p=p.toUnsigned()),p.gt(this))return P;if(p.gt(this.shru(1)))return K;Ne=P}else{if(this.eq(b)){if(p.eq(G)||p.eq(w))return b;if(p.eq(b))return G;var ot=this.shr(1);return le=ot.div(p).shl(1),le.eq(V)?p.isNegative()?G:w:(Ae=this.sub(p.mul(le)),Ne=le.add(Ae.div(p)),Ne)}else if(p.eq(b))return this.unsigned?P:V;if(this.isNegative())return p.isNegative()?this.neg().div(p.neg()):this.neg().div(p).neg();if(p.isNegative())return this.div(p.neg()).neg();Ne=V}for(Ae=this;Ae.gte(p);){le=Math.max(1,Math.floor(Ae.toNumber()/p.toNumber()));for(var je=Math.ceil(Math.log(le)/Math.LN2),Vt=je<=48?1:u(2,je-48),Qe=c(le),nt=Qe.mul(p);nt.isNegative()||nt.gt(Ae);)le-=Vt,Qe=c(le,this.unsigned),nt=Qe.mul(p);Qe.isZero()&&(Qe=G),Ne=Ne.add(Qe),Ae=Ae.sub(nt)}return Ne},m.div=m.divide,m.modulo=function(p){if(i(p)||(p=d(p)),e){var F=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,p.low,p.high);return l(F,e.get_high(),this.unsigned)}return this.sub(this.div(p).mul(p))},m.mod=m.modulo,m.rem=m.modulo,m.not=function(){return l(~this.low,~this.high,this.unsigned)},m.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},m.clz=m.countLeadingZeros,m.countTrailingZeros=function(){return this.low?r(this.low):r(this.high)+32},m.ctz=m.countTrailingZeros,m.and=function(p){return i(p)||(p=d(p)),l(this.low&p.low,this.high&p.high,this.unsigned)},m.or=function(p){return i(p)||(p=d(p)),l(this.low|p.low,this.high|p.high,this.unsigned)},m.xor=function(p){return i(p)||(p=d(p)),l(this.low^p.low,this.high^p.high,this.unsigned)},m.shiftLeft=function(p){return i(p)&&(p=p.toInt()),(p&=63)===0?this:p<32?l(this.low<<p,this.high<<p|this.low>>>32-p,this.unsigned):l(0,this.low<<p-32,this.unsigned)},m.shl=m.shiftLeft,m.shiftRight=function(p){return i(p)&&(p=p.toInt()),(p&=63)===0?this:p<32?l(this.low>>>p|this.high<<32-p,this.high>>p,this.unsigned):l(this.high>>p-32,this.high>=0?0:-1,this.unsigned)},m.shr=m.shiftRight,m.shiftRightUnsigned=function(p){return i(p)&&(p=p.toInt()),(p&=63)===0?this:p<32?l(this.low>>>p|this.high<<32-p,this.high>>>p,this.unsigned):p===32?l(this.high,0,this.unsigned):l(this.high>>>p-32,0,this.unsigned)},m.shru=m.shiftRightUnsigned,m.shr_u=m.shiftRightUnsigned,m.rotateLeft=function(p){var F;return i(p)&&(p=p.toInt()),(p&=63)===0?this:p===32?l(this.high,this.low,this.unsigned):p<32?(F=32-p,l(this.low<<p|this.high>>>F,this.high<<p|this.low>>>F,this.unsigned)):(p-=32,F=32-p,l(this.high<<p|this.low>>>F,this.low<<p|this.high>>>F,this.unsigned))},m.rotl=m.rotateLeft,m.rotateRight=function(p){var F;return i(p)&&(p=p.toInt()),(p&=63)===0?this:p===32?l(this.high,this.low,this.unsigned):p<32?(F=32-p,l(this.high<<F|this.low>>>p,this.low<<F|this.high>>>p,this.unsigned)):(p-=32,F=32-p,l(this.low<<F|this.high>>>p,this.high<<F|this.low>>>p,this.unsigned))},m.rotr=m.rotateRight,m.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},m.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},m.toBytes=function(p){return p?this.toBytesLE():this.toBytesBE()},m.toBytesLE=function(){var p=this.high,F=this.low;return[F&255,F>>>8&255,F>>>16&255,F>>>24,p&255,p>>>8&255,p>>>16&255,p>>>24]},m.toBytesBE=function(){var p=this.high,F=this.low;return[p>>>24,p>>>16&255,p>>>8&255,p&255,F>>>24,F>>>16&255,F>>>8&255,F&255]},t.fromBytes=function(p,F,le){return le?t.fromBytesLE(p,F):t.fromBytesBE(p,F)},t.fromBytesLE=function(p,F){return new t(p[0]|p[1]<<8|p[2]<<16|p[3]<<24,p[4]|p[5]<<8|p[6]<<16|p[7]<<24,F)},t.fromBytesBE=function(p,F){return new t(p[4]<<24|p[5]<<16|p[6]<<8|p[7],p[0]<<24|p[1]<<16|p[2]<<8|p[3],F)};var C=t;return n.default=C,"default"in n?n.default:n}({});typeof define=="function"&&define.amd?define([],function(){return dy}):typeof ih=="object"&&typeof fy=="object"&&(ih.exports=dy)});var ah=k(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.loadFileDescriptorSetFromObject=Pt.loadFileDescriptorSetFromBuffer=Pt.fromJSON=Pt.loadSync=Pt.load=Pt.IdempotencyLevel=Pt.isAnyExtension=Pt.Long=void 0;var PD=tg(),Gi=E3(),sh=ry(),oh=hy(),HD=my();Pt.Long=HD;function BD(n){return"@type"in n&&typeof n["@type"]=="string"}Pt.isAnyExtension=BD;var vy;(function(n){n.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",n.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",n.IDEMPOTENT="IDEMPOTENT"})(vy=Pt.IdempotencyLevel||(Pt.IdempotencyLevel={}));var yy={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function FD(n,e){return n===""?e:n+"."+e}function qD(n){return n instanceof Gi.Service||n instanceof Gi.Type||n instanceof Gi.Enum}function UD(n){return n instanceof Gi.Namespace||n instanceof Gi.Root}function wy(n,e){let t=FD(e,n.name);return qD(n)?[[t,n]]:UD(n)&&typeof n.nested<"u"?Object.keys(n.nested).map(i=>wy(n.nested[i],t)).reduce((i,r)=>i.concat(r),[]):[]}function py(n,e){return function(i){return n.toObject(n.decode(i),e)}}function gy(n){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${n.name} structure, got array instead`);let i=n.fromObject(t);return n.encode(i).finish()}}function jD(n){return(n||[]).reduce((e,t)=>{for(let[i,r]of Object.entries(t))switch(i){case"uninterpreted_option":e.uninterpreted_option.push(t.uninterpreted_option);break;default:e[i]=r}return e},{deprecated:!1,idempotency_level:vy.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function WD(n,e,t,i){let r=n.resolvedRequestType,s=n.resolvedResponseType;return{path:"/"+e+"/"+n.name,requestStream:!!n.requestStream,responseStream:!!n.responseStream,requestSerialize:gy(r),requestDeserialize:py(r,t),responseSerialize:gy(s),responseDeserialize:py(s,t),originalName:PD(n.name),requestType:rh(r,i),responseType:rh(s,i),options:jD(n.parsedOptions)}}function $D(n,e,t,i){let r={};for(let s of n.methodsArray)r[s.name]=WD(s,e,t,i);return r}function rh(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:t.$type.toObject(t,yy),fileDescriptorProtos:e}}function GD(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:t.$type.toObject(t,yy),fileDescriptorProtos:e}}function YD(n,e,t,i){if(n instanceof Gi.Service)return $D(n,e,t,i);if(n instanceof Gi.Type)return rh(n,i);if(n instanceof Gi.Enum)return GD(n,i);throw new Error("Type mismatch in reflection object handling")}function x3(n,e){let t={};n.resolveAll();let r=n.toDescriptor("proto3").file.map(s=>Buffer.from(sh.FileDescriptorProto.encode(s).finish()));for(let[s,o]of wy(n,""))t[s]=YD(o,s,e,r);return t}function by(n,e){e=e||{};let t=Gi.Root.fromDescriptor(n);return t.resolveAll(),x3(t,e)}function KD(n,e){return(0,oh.loadProtosWithOptions)(n,e).then(t=>x3(t,e))}Pt.load=KD;function QD(n,e){let t=(0,oh.loadProtosWithOptionsSync)(n,e);return x3(t,e)}Pt.loadSync=QD;function XD(n,e){e=e||{};let t=Gi.Root.fromJSON(n);return t.resolveAll(),x3(t,e)}Pt.fromJSON=XD;function ZD(n,e){let t=sh.FileDescriptorSet.decode(n);return by(t,e)}Pt.loadFileDescriptorSetFromBuffer=ZD;function JD(n,e){let t=sh.FileDescriptorSet.fromObject(n);return by(t,e)}Pt.loadFileDescriptorSetFromObject=JD;(0,oh.addCommonProtos)()});var r1=k(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.setup=ct.getChannelzServiceDefinition=ct.getChannelzHandlers=ct.unregisterChannelzRef=ct.registerChannelzSocket=ct.registerChannelzServer=ct.registerChannelzSubchannel=ct.registerChannelzChannel=ct.ChannelzCallTracker=ct.ChannelzChildrenTracker=ct.ChannelzTrace=void 0;var _y=He("net"),x4=Gn(),I4=Ve(),ek=Pi(),tk=Kc(),nk=ru();function ch(n){return{channel_id:n.id,name:n.name}}function dh(n){return{subchannel_id:n.id,name:n.name}}function ik(n){return{server_id:n.id}}function I3(n){return{socket_id:n.id,name:n.name}}var Cy=32,lh=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,i){let r=new Date;this.events.push({description:t,severity:e,timestamp:r,childChannel:i?.kind==="channel"?i:void 0,childSubchannel:i?.kind==="subchannel"?i:void 0}),this.events.length>=Cy*2&&(this.events=this.events.slice(Cy)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:Cr(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:Cr(e.timestamp),channel_ref:e.childChannel?ch(e.childChannel):null,subchannel_ref:e.childSubchannel?dh(e.childSubchannel):null}))}}};ct.ChannelzTrace=lh;var uh=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,i,r;switch(e.kind){case"channel":{let s=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(i=this.subchannelChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(r=this.socketChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){let e=[];for(let{ref:r}of this.channelChildren.values())e.push(r);let t=[];for(let{ref:r}of this.subchannelChildren.values())t.push(r);let i=[];for(let{ref:r}of this.socketChildren.values())i.push(r);return{channels:e,subchannels:t,sockets:i}}};ct.ChannelzChildrenTracker=uh;var hh=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};ct.ChannelzCallTracker=hh;var rk=1;function A3(){return rk++}var O4=[],fh=[],cs=[],mh=[];function sk(n,e,t){let i=A3(),r={id:i,name:n,kind:"channel"};return t&&(O4[i]={ref:r,getInfo:e}),r}ct.registerChannelzChannel=sk;function ok(n,e,t){let i=A3(),r={id:i,name:n,kind:"subchannel"};return t&&(fh[i]={ref:r,getInfo:e}),r}ct.registerChannelzSubchannel=ok;function ak(n,e){let t=A3(),i={id:t,kind:"server"};return e&&(cs[t]={ref:i,getInfo:n}),i}ct.registerChannelzServer=ak;function ck(n,e,t){let i=A3(),r={id:i,name:n,kind:"socket"};return t&&(mh[i]={ref:r,getInfo:e}),r}ct.registerChannelzSocket=ck;function lk(n){switch(n.kind){case"channel":delete O4[n.id];return;case"subchannel":delete fh[n.id];return;case"server":delete cs[n.id];return;case"socket":delete mh[n.id];return}}ct.unregisterChannelzRef=lk;function uk(n){let e=Number.parseInt(n,16);return[e/256|0,e%256]}function Sy(n){if(n==="")return[];let e=n.split(":").map(i=>uk(i));return[].concat(...e)}function hk(n){if((0,_y.isIPv4)(n))return Buffer.from(Uint8Array.from(n.split(".").map(e=>Number.parseInt(e))));if((0,_y.isIPv6)(n)){let e,t,i=n.indexOf("::");i===-1?(e=n,t=""):(e=n.substring(0,i),t=n.substring(i+2));let r=Buffer.from(Sy(e)),s=Buffer.from(Sy(t)),o=Buffer.alloc(16-r.length-s.length,0);return Buffer.concat([r,o,s])}else return null}function Ey(n){switch(n){case x4.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case x4.ConnectivityState.IDLE:return{state:"IDLE"};case x4.ConnectivityState.READY:return{state:"READY"};case x4.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case x4.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function Cr(n){if(!n)return null;let e=n.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function My(n){let e=n.getInfo();return{ref:ch(n.ref),data:{target:e.target,state:Ey(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Cr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(t=>ch(t)),subchannel_ref:e.children.subchannels.map(t=>dh(t))}}function dk(n,e){let t=Number.parseInt(n.request.channel_id),i=O4[t];if(i===void 0){e({code:I4.Status.NOT_FOUND,details:"No channel data found for id "+t});return}e(null,{channel:My(i)})}function fk(n,e){let t=Number.parseInt(n.request.max_results),i=[],r=Number.parseInt(n.request.start_channel_id);for(;r<O4.length;r++){let s=O4[r];if(s!==void 0&&(i.push(My(s)),i.length>=t))break}e(null,{channel:i,end:r>=cs.length})}function zy(n){let e=n.getInfo();return{ref:ik(n.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Cr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(t=>I3(t))}}function mk(n,e){let t=Number.parseInt(n.request.server_id),i=cs[t];if(i===void 0){e({code:I4.Status.NOT_FOUND,details:"No server data found for id "+t});return}e(null,{server:zy(i)})}function pk(n,e){let t=Number.parseInt(n.request.max_results),i=[],r=Number.parseInt(n.request.start_server_id);for(;r<cs.length;r++){let s=cs[r];if(s!==void 0&&(i.push(zy(s)),i.length>=t))break}e(null,{server:i,end:r>=cs.length})}function gk(n,e){let t=Number.parseInt(n.request.subchannel_id),i=fh[t];if(i===void 0){e({code:I4.Status.NOT_FOUND,details:"No subchannel data found for id "+t});return}let r=i.getInfo(),s={ref:dh(i.ref),data:{target:r.target,state:Ey(r.state),calls_started:r.callTracker.callsStarted,calls_succeeded:r.callTracker.callsSucceeded,calls_failed:r.callTracker.callsFailed,last_call_started_timestamp:Cr(r.callTracker.lastCallStartedTimestamp),trace:r.trace.getTraceMessage()},socket_ref:r.children.sockets.map(o=>I3(o))};e(null,{subchannel:s})}function Ty(n){var e;return(0,ek.isTcpSubchannelAddress)(n)?{address:"tcpip_address",tcpip_address:{ip_address:(e=hk(n.host))!==null&&e!==void 0?e:void 0,port:n.port}}:{address:"uds_address",uds_address:{filename:n.path}}}function vk(n,e){var t,i,r,s,o;let a=Number.parseInt(n.request.socket_id),c=mh[a];if(c===void 0){e({code:I4.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let l=c.getInfo(),u=l.security?{model:"tls",tls:{cipher_suite:l.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(t=l.security.cipherSuiteStandardName)!==null&&t!==void 0?t:void 0,other_name:(i=l.security.cipherSuiteOtherName)!==null&&i!==void 0?i:void 0,local_certificate:(r=l.security.localCertificate)!==null&&r!==void 0?r:void 0,remote_certificate:(s=l.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,h={ref:I3(c.ref),local:l.localAddress?Ty(l.localAddress):null,remote:l.remoteAddress?Ty(l.remoteAddress):null,remote_name:(o=l.remoteName)!==null&&o!==void 0?o:void 0,security:u,data:{keep_alives_sent:l.keepAlivesSent,streams_started:l.streamsStarted,streams_succeeded:l.streamsSucceeded,streams_failed:l.streamsFailed,last_local_stream_created_timestamp:Cr(l.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:Cr(l.lastRemoteStreamCreatedTimestamp),messages_received:l.messagesReceived,messages_sent:l.messagesSent,last_message_received_timestamp:Cr(l.lastMessageReceivedTimestamp),last_message_sent_timestamp:Cr(l.lastMessageSentTimestamp),local_flow_control_window:l.localFlowControlWindow?{value:l.localFlowControlWindow}:null,remote_flow_control_window:l.remoteFlowControlWindow?{value:l.remoteFlowControlWindow}:null}};e(null,{socket:h})}function yk(n,e){let t=Number.parseInt(n.request.server_id),i=cs[t];if(i===void 0){e({code:I4.Status.NOT_FOUND,details:"No server data found for id "+t});return}let r=Number.parseInt(n.request.start_socket_id),s=Number.parseInt(n.request.max_results),a=i.getInfo().sessionChildren.sockets.sort((u,h)=>u.id-h.id),c=[],l=0;for(;l<a.length&&!(a[l].id>=r&&(c.push(I3(a[l])),c.length>=s));l++);e(null,{socket_ref:c,end:l>=a.length})}function xy(){return{GetChannel:dk,GetTopChannels:fk,GetServer:mk,GetServers:pk,GetSubchannel:gk,GetSocket:vk,GetServerSockets:yk}}ct.getChannelzHandlers=xy;var O3=null;function Oy(){if(O3)return O3;let n=ah().loadSync,e=n("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return O3=(0,nk.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,O3}ct.getChannelzServiceDefinition=Oy;function wk(){(0,tk.registerAdminService)(Oy,xy)}ct.setup=wk});var Iy=k(k3=>{"use strict";Object.defineProperty(k3,"__esModule",{value:!0});k3.Subchannel=void 0;var et=Gn(),bk=l4(),ph=bt(),D3=Ve(),_k=Rn(),Ck=Pi(),Ro=r1(),Sk="subchannel",Tk=~(1<<31),gh=class{constructor(e,t,i,r,s){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=i,this.credentials=r,this.connector=s,this.connectivityState=et.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new Ro.ChannelzCallTracker,this.childrenTracker=new Ro.ChannelzChildrenTracker,this.streamTracker=new Ro.ChannelzCallTracker;let a={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new bk.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,Ck.subchannelAddressToString)(t),this.keepaliveTime=(o=i["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,i["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Ro.ChannelzTrace,this.channelzRef=(0,Ro.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(i,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){ph.trace(D3.LogVerbosity.DEBUG,Sk,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){ph.trace(D3.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([et.ConnectivityState.TRANSIENT_FAILURE],et.ConnectivityState.CONNECTING):this.transitionToState([et.ConnectivityState.TRANSIENT_FAILURE],et.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,Tk);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(t=>{this.transitionToState([et.ConnectivityState.CONNECTING],et.ConnectivityState.READY)?(this.transport=t,this.channelzEnabled&&this.childrenTracker.refChild(t.getChannelzRef()),t.addDisconnectListener(i=>{this.transitionToState([et.ConnectivityState.READY],et.ConnectivityState.IDLE),i&&this.keepaliveTime>0&&(this.keepaliveTime*=2,ph.log(D3.LogVerbosity.ERROR,`Connection to ${(0,_k.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):t.shutdown()},t=>{this.transitionToState([et.ConnectivityState.CONNECTING],et.ConnectivityState.TRANSIENT_FAILURE,`${t}`)})}transitionToState(e,t,i){var r,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(et.ConnectivityState[this.connectivityState]+" -> "+et.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+et.ConnectivityState[t]);let o=this.connectivityState;switch(this.connectivityState=t,t){case et.ConnectivityState.READY:this.stopBackoff();break;case et.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case et.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(r=this.transport)===null||r===void 0||r.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case et.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let a of this.stateListeners)a(this,o,t,this.keepaliveTime,i);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,Ro.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([et.ConnectivityState.CONNECTING,et.ConnectivityState.READY],et.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,t,i,r){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:o=>{o.code===D3.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,t,i,r,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([et.ConnectivityState.IDLE],et.ConnectivityState.CONNECTING)||this.connectivityState===et.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([et.ConnectivityState.TRANSIENT_FAILURE],et.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};k3.Subchannel=gh});var bh=k(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});hs.setup=hs.DEFAULT_PORT=void 0;var Ay=Vi(),ky=He("dns"),Ry=He("util"),Ek=Al(),vh=Ve(),yh=En(),Mk=bt(),zk=Ve(),ls=Rn(),Dy=He("net"),xk=l4(),Ok="dns_resolver";function us(n){Mk.trace(zk.LogVerbosity.DEBUG,Ok,n)}hs.DEFAULT_PORT=443;var Ik=3e4,Ak=Ry.promisify(ky.resolveTxt),Dk=Ry.promisify(ky.lookup);function kk(...n){let e=[];for(let t=0;t<Math.max.apply(null,n.map(i=>i.length));t++)for(let i of n)t<i.length&&e.push(i[t]);return e}var wh=class{constructor(e,t,i){var r,s,o;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,us("Resolver constructed for target "+(0,ls.uriToString)(e));let a=(0,ls.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,Dy.isIPv4)(a.host)||(0,Dy.isIPv6)(a.host)?(this.ipResult=[{host:a.host,port:(r=a.port)!==null&&r!==void 0?r:hs.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(s=a.port)!==null&&s!==void 0?s:hs.DEFAULT_PORT),this.percentage=Math.random()*100,i["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:vh.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,ls.uriToString)(this.target)}`,metadata:new yh.Metadata};let c={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoff=new xk.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},c),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=i["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:Ik,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(us("Returning IP address for target "+(0,ls.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)us("Failed to parse DNS address "+(0,ls.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:vh.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,ls.uriToString)(this.target)}`,metadata:new yh.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;us("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=Dk(e,{all:!0}),this.pendingLookupPromise.then(t=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let i=t.filter(o=>o.family===4),r=t.filter(o=>o.family===6);this.latestLookupResult=kk(r,i).map(o=>({host:o.address,port:+this.port}));let s="["+this.latestLookupResult.map(o=>o.host+":"+o.port).join(",")+"]";if(us("Resolved addresses for target "+(0,ls.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{this.pendingLookupPromise!==null&&(us("Resolution error for target "+(0,ls.uriToString)(this.target)+": "+t.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=Ak(e),this.pendingTxtPromise.then(t=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,Ek.extractAndSelectServiceConfig)(t,this.percentage)}catch(i){this.latestServiceConfigError={code:vh.Status.UNAVAILABLE,details:`Parsing service config failed with error ${i.message}`,metadata:new yh.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},t=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?us('resolution update delayed by "min time between resolutions" rate limit'):us("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function Rk(){(0,Ay.registerResolver)("dns",wh),(0,Ay.registerDefaultScheme)("dns")}hs.setup=Rk});var _h=k(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.getProxiedConnection=No.mapProxyName=void 0;var A4=bt(),Lo=Ve(),Lk=Vi(),Vk=He("http"),Nk=He("tls"),Pk=bt(),Ly=Pi(),Vo=Rn(),Hk=He("url"),Bk=bh(),Fk="proxy";function ds(n){Pk.trace(Lo.LogVerbosity.DEBUG,Fk,n)}function qk(){let n="",e="";if(process.env.grpc_proxy)e="grpc_proxy",n=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",n=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",n=process.env.http_proxy;else return{};let t;try{t=new Hk.URL(n)}catch{return(0,A4.log)(Lo.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(t.protocol!=="http:")return(0,A4.log)(Lo.LogVerbosity.ERROR,`"${t.protocol}" scheme not supported in proxy URI`),{};let i=null;t.username&&(t.password?((0,A4.log)(Lo.LogVerbosity.INFO,"userinfo found in proxy URI"),i=`${t.username}:${t.password}`):i=t.username);let r=t.hostname,s=t.port;s===""&&(s="80");let o={address:`${r}:${s}`};return i&&(o.creds=i),ds("Proxy server "+o.address+" set by environment variable "+e),o}function Uk(){let n=process.env.no_grpc_proxy,e="no_grpc_proxy";return n||(n=process.env.no_proxy,e="no_proxy"),n?(ds("No proxy server list set by environment variable "+e),n.split(",")):[]}function jk(n,e){var t;let i={target:n,extraOptions:{}};if(((t=e["grpc.enable_http_proxy"])!==null&&t!==void 0?t:1)===0||n.scheme==="unix")return i;let r=qk();if(!r.address)return i;let s=(0,Vo.splitHostPort)(n.path);if(!s)return i;let o=s.host;for(let c of Uk())if(c===o)return ds("Not using proxy for target in no_proxy list: "+(0,Vo.uriToString)(n)),i;let a={"grpc.http_connect_target":(0,Vo.uriToString)(n)};return r.creds&&(a["grpc.http_connect_creds"]=r.creds),{target:{scheme:"dns",path:r.address},extraOptions:a}}No.mapProxyName=jk;function Wk(n,e,t){var i;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let r=e["grpc.http_connect_target"],s=(0,Vo.parseUri)(r);if(s===null)return Promise.resolve({});let o=(0,Vo.splitHostPort)(s.path);if(o===null)return Promise.resolve({});let a=`${o.host}:${(i=o.port)!==null&&i!==void 0?i:Bk.DEFAULT_PORT}`,c={method:"CONNECT",path:a},l={Host:a};(0,Ly.isTcpSubchannelAddress)(n)?(c.host=n.host,c.port=n.port):c.socketPath=n.path,"grpc.http_connect_creds"in e&&(l["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),c.headers=l;let u=(0,Ly.subchannelAddressToString)(n);return ds("Using proxy "+u+" to connect to "+c.path),new Promise((h,d)=>{let g=Vk.request(c);g.once("connect",(_,T,E)=>{var L;if(g.removeAllListeners(),T.removeAllListeners(),_.statusCode===200)if(ds("Successfully connected to "+c.path+" through proxy "+u),"secureContext"in t){let x=(0,Lk.getDefaultAuthority)(s),V=(0,Vo.splitHostPort)(x),P=(L=V?.host)!==null&&L!==void 0?L:x,G=Nk.connect(Object.assign({host:P,servername:P,socket:T},t),()=>{ds("Successfully established a TLS connection to "+c.path+" through proxy "+u),h({socket:G,realTarget:s})});G.on("error",K=>{ds("Failed to establish a TLS connection to "+c.path+" through proxy "+u+" with error "+K.message),d()})}else ds("Successfully established a plaintext connection to "+c.path+" through proxy "+u),h({socket:T,realTarget:s});else(0,A4.log)(Lo.LogVerbosity.ERROR,"Failed to connect to "+c.path+" through proxy "+u+" with status "+_.statusCode),d()}),g.once("error",_=>{g.removeAllListeners(),(0,A4.log)(Lo.LogVerbosity.ERROR,"Failed to connect to proxy "+u+" with error "+_.message),d()}),g.end()})}No.getProxiedConnection=Wk});var Sh=k(R3=>{"use strict";Object.defineProperty(R3,"__esModule",{value:!0});R3.StreamDecoder=void 0;var Sr=function(n){return n[n.NO_DATA=0]="NO_DATA",n[n.READING_SIZE=1]="READING_SIZE",n[n.READING_MESSAGE=2]="READING_MESSAGE",n}(Sr||{}),Ch=class{constructor(e){this.maxReadMessageLength=e,this.readState=Sr.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t=0,i,r=[];for(;t<e.length;)switch(this.readState){case Sr.NO_DATA:this.readCompressFlag=e.slice(t,t+1),t+=1,this.readState=Sr.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case Sr.READING_SIZE:if(i=Math.min(e.length-t,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+i),this.readSizeRemaining-=i,t+=i,this.readSizeRemaining===0){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.maxReadMessageLength!==-1&&this.readMessageSize>this.maxReadMessageLength)throw new Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=Sr.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=Sr.NO_DATA,r.push(s)}}break;case Sr.READING_MESSAGE:if(i=Math.min(e.length-t,this.readMessageRemaining),this.readPartialMessage.push(e.slice(t,t+i)),this.readMessageRemaining-=i,t+=i,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(s,this.readMessageSize+5);this.readState=Sr.NO_DATA,r.push(o)}break;default:throw new Error("Unexpected read state")}return r}};R3.StreamDecoder=Ch});var Vy=k(L3=>{"use strict";Object.defineProperty(L3,"__esModule",{value:!0});L3.Http2SubchannelCall=void 0;var Tr=He("http2"),$k=He("os"),Fe=Ve(),fs=En(),Gk=Sh(),Yk=bt(),Kk=Ve(),Qk="subchannel_call";function Xk(n){for(let[e,t]of Object.entries($k.constants.errno))if(t===n)return e;return"Unknown system error "+n}var Th=class{constructor(e,t,i,r,s){var o;this.http2Stream=e,this.callEventTracker=t,this.listener=i,this.transport=r,this.callId=s,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=Fe.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let a=(o=r.getOptions()["grpc.max_receive_message_length"])!==null&&o!==void 0?o:Fe.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new Gk.StreamDecoder(a),e.on("response",(c,l)=>{let u="";for(let h of Object.keys(c))u+="		"+h+": "+c[h]+`
`;switch(this.trace(`Received server headers:
`+u),c[":status"]){case 400:this.mappedStatusCode=Fe.Status.INTERNAL;break;case 401:this.mappedStatusCode=Fe.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=Fe.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=Fe.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=Fe.Status.UNAVAILABLE;break;default:this.mappedStatusCode=Fe.Status.UNKNOWN}if(l&Tr.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(c);else{let h;try{h=fs.Metadata.fromHttp2Headers(c)}catch(d){this.endCall({code:Fe.Status.UNKNOWN,details:d.message,metadata:new fs.Metadata});return}this.listener.onReceiveMetadata(h)}}),e.on("trailers",c=>{this.handleTrailers(c)}),e.on("data",c=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+c.length);let l;try{l=this.decoder.write(c)}catch(u){this.cancelWithStatus(Fe.Status.RESOURCE_EXHAUSTED,u.message);return}for(let u of l)this.trace("parsed message of length "+u.length),this.callEventTracker.addMessageReceived(),this.tryPush(u)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var c;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((c=this.finalStatus)===null||c===void 0?void 0:c.code)===Fe.Status.OK)return;let l,u="";switch(e.rstCode){case Tr.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;l=Fe.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode}`;break;case Tr.constants.NGHTTP2_REFUSED_STREAM:l=Fe.Status.UNAVAILABLE,u="Stream refused by server";break;case Tr.constants.NGHTTP2_CANCEL:l=Fe.Status.CANCELLED,u="Call cancelled";break;case Tr.constants.NGHTTP2_ENHANCE_YOUR_CALM:l=Fe.Status.RESOURCE_EXHAUSTED,u="Bandwidth exhausted or memory limit exceeded";break;case Tr.constants.NGHTTP2_INADEQUATE_SECURITY:l=Fe.Status.PERMISSION_DENIED,u="Protocol not secure enough";break;case Tr.constants.NGHTTP2_INTERNAL_ERROR:l=Fe.Status.INTERNAL,this.internalError===null?u=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(l=Fe.Status.UNAVAILABLE,u=this.internalError.message):u=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:l=Fe.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:l,details:u,metadata:new fs.Metadata,rstCode:e.rstCode})})}),e.on("error",c=>{c.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+c.message+" code="+c.code+" errno="+Xk(c.errno)+" syscall="+c.syscall),this.internalError=c),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:Fe.Status.UNAVAILABLE,details:"Connection dropped",metadata:new fs.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){Yk.trace(Kk.LogVerbosity.DEBUG,Qk,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===Fe.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==Fe.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let t="";for(let c of Object.keys(e))t+="		"+c+": "+e[c]+`
`;this.trace(`Received server trailers:
`+t);let i;try{i=fs.Metadata.fromHttp2Headers(e)}catch{i=new fs.Metadata}let r=i.getMap(),s=this.mappedStatusCode;if(s===Fe.Status.UNKNOWN&&typeof r["grpc-status"]=="string"){let c=Number(r["grpc-status"]);c in Fe.Status&&(s=c,this.trace("received status code "+c+" from server")),i.remove("grpc-status")}let o="";if(typeof r["grpc-message"]=="string"){try{o=decodeURI(r["grpc-message"])}catch{o=r["grpc-message"]}i.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let a={code:s,details:o,metadata:i};this.endCall(a)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===Fe.Status.OK?t=Tr.constants.NGHTTP2_NO_ERROR:t=Tr.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new fs.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==Fe.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let i=r=>{process.nextTick(()=>{var s;let o=Fe.Status.UNAVAILABLE;r?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=Fe.Status.INTERNAL),r&&this.cancelWithStatus(o,`Write error: ${r.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,i)}catch(r){this.endCall({code:Fe.Status.UNAVAILABLE,details:`Write failed with error ${r.message}`,metadata:new fs.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};L3.Http2SubchannelCall=Th});var Eh=k(V3=>{"use strict";Object.defineProperty(V3,"__esModule",{value:!0});V3.getNextCallNumber=void 0;var Zk=0;function Jk(){return Zk++}V3.getNextCallNumber=Jk});var Hy=k(P3=>{"use strict";Object.defineProperty(P3,"__esModule",{value:!0});P3.Http2SubchannelConnector=void 0;var Ih=He("http2"),Ny=He("tls"),Mh=r1(),D4=Ve(),eR=_h(),Ho=bt(),Py=Vi(),N3=Pi(),Po=Rn(),tR=He("net"),nR=Vy(),iR=Eh(),zh="transport",rR="transport_flowctrl",sR=fl().version,{HTTP2_HEADER_AUTHORITY:oR,HTTP2_HEADER_CONTENT_TYPE:aR,HTTP2_HEADER_METHOD:cR,HTTP2_HEADER_PATH:lR,HTTP2_HEADER_TE:uR,HTTP2_HEADER_USER_AGENT:hR}=Ih.constants,dR=2e4,fR=Buffer.from("too_many_pings","ascii"),xh=class{constructor(e,t,i,r){this.session=e,this.options=i,this.remoteName=r,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=dR,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new Mh.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,N3.subchannelAddressToString)(t),i["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,Mh.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[i["grpc.primary_user_agent"],`grpc-node-js/${sR}`,i["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in i&&(this.keepaliveTimeMs=i["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in i&&(this.keepaliveTimeoutMs=i["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in i?this.keepaliveWithoutCalls=i["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,o,a)=>{let c=!1;s===Ih.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(fR)&&(c=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+a?.toString()),this.reportDisconnectToOwner(c)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),Ho.isTracerEnabled(zh)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,i;let r=this.session.socket,s=r.remoteAddress?(0,N3.stringToSubchannelAddress)(r.remoteAddress,r.remotePort):null,o=r.localAddress?(0,N3.stringToSubchannelAddress)(r.localAddress,r.localPort):null,a;if(this.session.encrypted){let l=r,u=l.getCipher(),h=l.getCertificate(),d=l.getPeerCertificate();a={cipherSuiteStandardName:(e=u.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:u.standardName?null:u.name,localCertificate:h&&"raw"in h?h.raw:null,remoteCertificate:d&&"raw"in d?d.raw:null}}else a=null;return{remoteAddress:s,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(i=this.session.state.remoteWindowSize)!==null&&i!==void 0?i:null}}trace(e){Ho.trace(D4.LogVerbosity.DEBUG,zh,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){Ho.trace(D4.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){Ho.trace(D4.LogVerbosity.DEBUG,rR,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){Ho.trace(D4.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0||t.call(e));try{this.session.ping((i,r,s)=>{i&&(this.keepaliveTrace("Ping failed with error "+i.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||t===void 0?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,i,r,s){let o=e.toHttp2Headers();o[oR]=t,o[hR]=this.userAgent,o[aR]="application/grpc",o[cR]="POST",o[lR]=i,o[uR]="trailers";let a;try{a=this.session.request(o)}catch(u){throw this.handleDisconnect(),u}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let c,l;return this.channelzEnabled?(this.streamTracker.addCallStarted(),c={addMessageSent:()=>{var u;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var h;(h=s.onCallEnd)===null||h===void 0||h.call(s,u),this.removeActiveCall(l)},onStreamEnd:u=>{var h;u?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(h=s.onStreamEnd)===null||h===void 0||h.call(s,u)}}):c={addMessageSent:()=>{var u;(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var h;(h=s.onCallEnd)===null||h===void 0||h.call(s,u),this.removeActiveCall(l)},onStreamEnd:u=>{var h;(h=s.onStreamEnd)===null||h===void 0||h.call(s,u)}},l=new nR.Http2SubchannelCall(a,c,r,this,(0,iR.getNextCallNumber)()),this.addActiveCall(l),l}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,Mh.unregisterChannelzRef)(this.channelzRef)}},Oh=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){Ho.trace(D4.LogVerbosity.DEBUG,zh,(0,Po.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,i,r){return this.isShutdown?Promise.reject():new Promise((s,o)=>{var a,c,l;let u;r.realTarget?(u=(0,Po.uriToString)(r.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,Po.uriToString)(r.realTarget))):(u=null,this.trace("creating HTTP/2 session to "+(0,N3.subchannelAddressToString)(e)));let h=(0,Py.getDefaultAuthority)((a=r.realTarget)!==null&&a!==void 0?a:this.channelTarget),d=t._getConnectionOptions()||{};d.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in i?d.maxSessionMemory=i["grpc-node.max_session_memory"]:d.maxSessionMemory=Number.MAX_SAFE_INTEGER;let g="http://";if("secureContext"in d){if(g="https://",i["grpc.ssl_target_name_override"]){let E=i["grpc.ssl_target_name_override"];d.checkServerIdentity=(L,x)=>(0,Ny.checkServerIdentity)(E,x),d.servername=E}else{let E=(l=(c=(0,Po.splitHostPort)(h))===null||c===void 0?void 0:c.host)!==null&&l!==void 0?l:"localhost";d.servername=E}r.socket&&(d.createConnection=(E,L)=>r.socket)}else d.createConnection=(E,L)=>r.socket?r.socket:tR.connect(e);d=Object.assign(Object.assign(Object.assign({},d),e),{enableTrace:i["grpc-node.tls_enable_trace"]===1});let _=Ih.connect(g+h,d);this.session=_;let T="Failed to connect";_.unref(),_.once("connect",()=>{_.removeAllListeners(),s(new xh(_,e,i,u)),this.session=null}),_.once("close",()=>{this.session=null,setImmediate(()=>{o(`${T} (${new Date().toISOString()})`)})}),_.once("error",E=>{T=E.message,this.trace("connection failed with error "+T)})})}connect(e,t,i){var r,s;if(this.isShutdown)return Promise.reject();let o=t._getConnectionOptions()||{};if("secureContext"in o){if(o.ALPNProtocols=["h2"],i["grpc.ssl_target_name_override"]){let a=i["grpc.ssl_target_name_override"];o.checkServerIdentity=(c,l)=>(0,Ny.checkServerIdentity)(a,l),o.servername=a}else if("grpc.http_connect_target"in i){let a=(0,Py.getDefaultAuthority)((r=(0,Po.parseUri)(i["grpc.http_connect_target"]))!==null&&r!==void 0?r:{path:"localhost"}),c=(0,Po.splitHostPort)(a);o.servername=(s=c?.host)!==null&&s!==void 0?s:a}i["grpc-node.tls_enable_trace"]&&(o.enableTrace=!0)}return(0,eR.getProxiedConnection)(e,i,o).then(a=>this.createSession(e,t,i,a))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};P3.Http2SubchannelConnector=Oh});var By=k(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.getSubchannelPool=Bo.SubchannelPool=void 0;var mR=Sp(),pR=Iy(),gR=Pi(),vR=Rn(),yR=Hy(),wR=1e4,k4=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let r=this.pool[t].filter(s=>!s.subchannel.unrefIfOneRef());r.length>0&&(e=!1),this.pool[t]=r}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},wR),(t=(e=this.cleanupTimer).unref)===null||t===void 0||t.call(e))}getOrCreateSubchannel(e,t,i,r){this.ensureCleanupTask();let s=(0,vR.uriToString)(e);if(s in this.pool){let a=this.pool[s];for(let c of a)if((0,gR.subchannelAddressEqual)(t,c.subchannelAddress)&&(0,mR.channelOptionsEqual)(i,c.channelArguments)&&r._equals(c.channelCredentials))return c.subchannel}let o=new pR.Subchannel(e,t,i,r,new yR.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:t,channelArguments:i,channelCredentials:r,subchannel:o}),o.ref(),o}};Bo.SubchannelPool=k4;var bR=new k4;function _R(n){return n?bR:new k4}Bo.getSubchannelPool=_R});var Dh=k(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.FilterStackFactory=Fo.FilterStack=void 0;var H3=class{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let i=0;i<this.filters.length;i++)t=this.filters[i].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let i=this.filters.length-1;i>=0;i--)t=this.filters[i].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let i=0;i<this.filters.length;i++)t=this.filters[i].sendMessage(t);return t}receiveMessage(e){let t=e;for(let i=this.filters.length-1;i>=0;i--)t=this.filters[i].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let i=this.filters.length-1;i>=0;i--)t=this.filters[i].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};Fo.FilterStack=H3;var Ah=class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new H3(this.factories.map(e=>e.createFilter()))}};Fo.FilterStackFactory=Ah});var kh=k(B3=>{"use strict";Object.defineProperty(B3,"__esModule",{value:!0});B3.CompressionAlgorithms=void 0;var Fy=function(n){return n[n.identity=0]="identity",n[n.deflate=1]="deflate",n[n.gzip=2]="gzip",n}(Fy||(B3.CompressionAlgorithms=Fy={}))});var Lh=k(F3=>{"use strict";Object.defineProperty(F3,"__esModule",{value:!0});F3.BaseFilter=void 0;var Rh=class{sendMetadata(e){return S(this,null,function*(){return e})}receiveMetadata(e){return e}sendMessage(e){return S(this,null,function*(){return e})}receiveMessage(e){return S(this,null,function*(){return e})}receiveTrailers(e){return e}};F3.BaseFilter=Rh});var jy=k(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.CompressionFilterFactory=Uo.CompressionFilter=void 0;var q3=He("zlib"),Uy=kh(),U3=Ve(),CR=Lh(),SR=bt(),TR=n=>typeof n=="number"&&typeof Uy.CompressionAlgorithms[n]=="string",qo=class{writeMessage(e,t){return S(this,null,function*(){let i=e;t&&(i=yield this.compressMessage(i));let r=Buffer.allocUnsafe(i.length+5);return r.writeUInt8(t?1:0,0),r.writeUInt32BE(i.length,1),i.copy(r,5),r})}readMessage(e){return S(this,null,function*(){let t=e.readUInt8(0)===1,i=e.slice(5);return t&&(i=yield this.decompressMessage(i)),i})}},s1=class extends qo{compressMessage(e){return S(this,null,function*(){return e})}writeMessage(e,t){return S(this,null,function*(){let i=Buffer.allocUnsafe(e.length+5);return i.writeUInt8(0,0),i.writeUInt32BE(e.length,1),e.copy(i,5),i})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},Vh=class extends qo{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,i)=>{q3.deflate(e,(r,s)=>{r?i(r):t(s)})})}decompressMessage(e){return new Promise((t,i)=>{let r=0,s=[],o=q3.createInflate();o.on("data",a=>{s.push(a),r+=a.byteLength,this.maxRecvMessageLength!==-1&&r>this.maxRecvMessageLength&&(o.destroy(),i({code:U3.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},Nh=class extends qo{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,i)=>{q3.gzip(e,(r,s)=>{r?i(r):t(s)})})}decompressMessage(e){return new Promise((t,i)=>{let r=0,s=[],o=q3.createGunzip();o.on("data",a=>{s.push(a),r+=a.byteLength,this.maxRecvMessageLength!==-1&&r>this.maxRecvMessageLength&&(o.destroy(),i({code:U3.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},Ph=class extends qo{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function qy(n,e){switch(n){case"identity":return new s1;case"deflate":return new Vh(e);case"gzip":return new Nh(e);default:return new Ph(n)}}var j3=class extends CR.BaseFilter{constructor(e,t){var i,r;super(),this.sharedFilterConfig=t,this.sendCompression=new s1,this.receiveCompression=new s1,this.currentCompressionAlgorithm="identity";let s=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=(i=e["grpc.max_receive_message_length"])!==null&&i!==void 0?i:U3.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,s!==void 0)if(TR(s)){let o=Uy.CompressionAlgorithms[s],a=(r=t.serverSupportedEncodingHeader)===null||r===void 0?void 0:r.split(",");(!a||a.includes(o))&&(this.currentCompressionAlgorithm=o,this.sendCompression=qy(this.currentCompressionAlgorithm,-1))}else SR.log(U3.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${s}`)}sendMetadata(e){return S(this,null,function*(){let t=yield e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t})}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let r=t[0];typeof r=="string"&&(this.receiveCompression=qy(r,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let i=e.get("grpc-accept-encoding")[0];return i&&(this.sharedFilterConfig.serverSupportedEncodingHeader=i,i.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new s1,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}sendMessage(e){return S(this,null,function*(){var t;let i=yield e,r;return this.sendCompression instanceof s1?r=!1:r=(((t=i.flags)!==null&&t!==void 0?t:0)&2)===0,{message:yield this.sendCompression.writeMessage(i.message,r),flags:i.flags}})}receiveMessage(e){return S(this,null,function*(){return this.receiveCompression.readMessage(yield e)})}};Uo.CompressionFilter=j3;var Hh=class{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new j3(this.options,this.sharedFilterConfig)}};Uo.CompressionFilterFactory=Hh});var W3=k(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.deadlineToString=Yi.getRelativeTimeout=Yi.getDeadlineTimeoutString=Yi.minDeadline=void 0;function ER(...n){let e=1/0;for(let t of n){let i=t instanceof Date?t.getTime():t;i<e&&(e=i)}return e}Yi.minDeadline=ER;var MR=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function zR(n){let e=new Date().getTime();n instanceof Date&&(n=n.getTime());let t=Math.max(n-e,0);for(let[i,r]of MR){let s=t/r;if(s<1e8)return String(Math.ceil(s))+i}throw new Error("Deadline is too far in the future")}Yi.getDeadlineTimeoutString=zR;var xR=2147483647;function OR(n){let e=n instanceof Date?n.getTime():n,t=new Date().getTime(),i=e-t;return i<0?0:i>xR?1/0:i}Yi.getRelativeTimeout=OR;function IR(n){if(n instanceof Date)return n.toISOString();{let e=new Date(n);return Number.isNaN(e.getTime())?""+n:e.toISOString()}}Yi.deadlineToString=IR});var G3=k($3=>{"use strict";Object.defineProperty($3,"__esModule",{value:!0});$3.restrictControlPlaneStatusCode=void 0;var Ki=Ve(),AR=[Ki.Status.OK,Ki.Status.INVALID_ARGUMENT,Ki.Status.NOT_FOUND,Ki.Status.ALREADY_EXISTS,Ki.Status.FAILED_PRECONDITION,Ki.Status.ABORTED,Ki.Status.OUT_OF_RANGE,Ki.Status.DATA_LOSS];function DR(n,e){return AR.includes(n)?{code:Ki.Status.INTERNAL,details:`Invalid status from control plane: ${n} ${Ki.Status[n]} ${e}`}:{code:n,details:e}}$3.restrictControlPlaneStatusCode=DR});var $y=k(Q3=>{"use strict";Object.defineProperty(Q3,"__esModule",{value:!0});Q3.LoadBalancingCall=void 0;var Wy=Gn(),Y3=Ve(),kR=W3(),K3=En(),R4=Xr(),RR=Rn(),LR=bt(),Bh=G3(),VR=He("http2"),NR="load_balancing_call",Fh=class{constructor(e,t,i,r,s,o,a){var c,l;this.channel=e,this.callConfig=t,this.methodName=i,this.host=r,this.credentials=s,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let u=this.methodName.split("/"),h="";u.length>=2&&(h=u[1]);let d=(l=(c=(0,RR.splitHostPort)(this.host))===null||c===void 0?void 0:c.host)!==null&&l!==void 0?l:"localhost";this.serviceUrl=`https://${d}/${h}`}trace(e){LR.trace(Y3.LogVerbosity.DEBUG,NR,"["+this.callNumber+"] "+e)}outputStatus(e,t){var i,r;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:t});(i=this.listener)===null||i===void 0||i.onReceiveStatus(s),(r=this.onCallEnded)===null||r===void 0||r.call(this,s.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let i=this.channel.doPick(this.metadata,this.callConfig.pickInformation),r=i.subchannel?"("+i.subchannel.getChannelzRef().id+") "+i.subchannel.getAddress():""+i.subchannel;switch(this.trace("Pick result: "+R4.PickResultType[i.pickResultType]+" subchannel: "+r+" status: "+((e=i.status)===null||e===void 0?void 0:e.code)+" "+((t=i.status)===null||t===void 0?void 0:t.details)),i.pickResultType){case R4.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var c,l,u;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let h=this.metadata.clone();if(h.merge(a),h.get("authorization").length>1&&this.outputStatus({code:Y3.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new K3.Metadata},"PROCESSED"),i.subchannel.getConnectivityState()!==Wy.ConnectivityState.READY){this.trace("Picked subchannel "+r+" has state "+Wy.ConnectivityState[i.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&h.set("grpc-timeout",(0,kR.getDeadlineTimeoutString)(this.deadline));try{this.child=i.subchannel.getRealSubchannel().createCall(h,this.host,this.methodName,{onReceiveMetadata:d=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(d)},onReceiveMessage:d=>{this.trace("Received message"),this.listener.onReceiveMessage(d)},onReceiveStatus:d=>{this.trace("Received status"),d.rstCode===VR.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(d,"REFUSED"):this.outputStatus(d,"PROCESSED")}})}catch(d){this.trace("Failed to start call on picked subchannel "+r+" with error "+d.message),this.outputStatus({code:Y3.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+d.message,metadata:new K3.Metadata},"NOT_STARTED");return}(l=(c=this.callConfig).onCommitted)===null||l===void 0||l.call(c),(u=i.onCallStarted)===null||u===void 0||u.call(i),this.onCallEnded=i.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:c,details:l}=(0,Bh.restrictControlPlaneStatusCode)(typeof a.code=="number"?a.code:Y3.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:c,details:l,metadata:new K3.Metadata},"PROCESSED")});break;case R4.PickResultType.DROP:let{code:s,details:o}=(0,Bh.restrictControlPlaneStatusCode)(i.status.code,i.status.details);setImmediate(()=>{this.outputStatus({code:s,details:o,metadata:i.status.metadata},"DROP")});break;case R4.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:c}=(0,Bh.restrictControlPlaneStatusCode)(i.status.code,i.status.details);setImmediate(()=>{this.outputStatus({code:a,details:c,metadata:i.status.metadata},"PROCESSED")})}break;case R4.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var i;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(i=this.child)===null||i===void 0||i.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new K3.Metadata},"PROCESSED")}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};Q3.LoadBalancingCall=Fh});var Yy=k(Z3=>{"use strict";Object.defineProperty(Z3,"__esModule",{value:!0});Z3.ResolvingCall=void 0;var jo=Ve(),X3=W3(),Gy=En(),PR=bt(),HR=G3(),BR="resolving_call",qh=class{constructor(e,t,i,r,s,o){this.channel=e,this.method=t,this.filterStackFactory=r,this.credentials=s,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=i.deadline,this.host=i.host,i.parentCall&&(i.flags&jo.Propagate.CANCELLATION&&i.parentCall.on("cancelled",()=>{this.cancelWithStatus(jo.Status.CANCELLED,"Cancelled by parent call")}),i.flags&jo.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+i.parentCall.getDeadline()),this.deadline=(0,X3.minDeadline)(this.deadline,i.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){PR.trace(jo.LogVerbosity.DEBUG,BR,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,X3.deadlineToString)(this.deadline));let e=(0,X3.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(jo.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(i=>i(t)),process.nextTick(()=>{var i;(i=this.listener)===null||i===void 0||i.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let i=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(r=>{this.writeFilterPending=!1,i.sendMessageWithContext(e,r.message),this.pendingHalfClose&&i.halfClose()},r=>{this.cancelWithStatus(r.code,r.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let t=e.config;if(t.status!==jo.Status.OK){let{code:i,details:r}=(0,HR.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:i,details:r,metadata:new Gy.Metadata});return}if(t.methodConfig.timeout){let i=new Date;i.setSeconds(i.getSeconds()+t.methodConfig.timeout.seconds),i.setMilliseconds(i.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,X3.minDeadline)(this.deadline,i),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(i=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(i,{onReceiveMetadata:r=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(r))},onReceiveMessage:r=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(r).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:r=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=r:this.outputStatus(r)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},i=>{this.outputStatus(i)})}reportResolverError(e){var t;!((t=this.metadata)===null||t===void 0)&&t.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var i;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(i=this.child)===null||i===void 0||i.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new Gy.Metadata})}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};Z3.ResolvingCall=qh});var Ky=k(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.RetryingCall=ms.MessageBufferTracker=ms.RetryThrottler=void 0;var J3=Ve(),FR=En(),qR=bt(),UR="retrying_call",jh=class{constructor(e,t,i){this.maxTokens=e,this.tokenRatio=t,i?this.tokens=i.tokens*(e/i.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};ms.RetryThrottler=jh;var Wh=class{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var i;let r=(i=this.allocatedPerCall.get(t))!==null&&i!==void 0?i:0;return this.limitPerCall-r<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(t,r+e),this.totalAllocated+=e,!0)}free(e,t){var i;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let r=(i=this.allocatedPerCall.get(t))!==null&&i!==void 0?i:0;if(r<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${r}`);this.allocatedPerCall.set(t,r-e)}freeAll(e){var t;let i=(t=this.allocatedPerCall.get(e))!==null&&t!==void 0?t:0;if(this.totalAllocated<i)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${i} > total allocated ${this.totalAllocated}`);this.totalAllocated-=i,this.allocatedPerCall.delete(e)}};ms.MessageBufferTracker=Wh;var Uh="grpc-previous-rpc-attempts",$h=class{constructor(e,t,i,r,s,o,a,c,l){if(this.channel=e,this.callConfig=t,this.methodName=i,this.host=r,this.credentials=s,this.deadline=o,this.callNumber=a,this.bufferTracker=c,this.retryThrottler=l,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let u=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(u.initialBackoff.substring(0,u.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){qR.trace(J3.LogVerbosity.DEBUG,UR,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;(t=this.listener)===null||t===void 0||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new FR.Metadata});for(let{call:i}of this.underlyingCalls)i.cancelWithStatus(e,t)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return(t=this.writeBuffer[e-this.writeBufferOffset])!==null&&t!==void 0?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let i=this.getBufferEntry(t);i.allocated&&this.bufferTracker.free(i.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&this.underlyingCalls[t].state!=="COMPLETED"&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(J3.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,t=-1;for(let[i,r]of this.underlyingCalls.entries())r.state==="ACTIVE"&&r.nextMessageToSend>e&&(e=r.nextMessageToSend,t=i);t===-1?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(i=>i===t||i.toString().toLowerCase()===J3.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let i=Math.random()*this.nextRetryBackoffSec*1e3,r=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,r),i}maybeRetryCall(e,t){if(this.state!=="RETRY"){t(!1);return}let i=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(i.maxAttempts,5)){t(!1);return}let r;if(e===null)r=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else r=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,o;if(this.state!=="RETRY"){t(!1);return}(!((o=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&o!==void 0)||o)&&(t(!0),this.attempts+=1,this.startNewAttempt())},r)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,i){var r,s,o;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((r=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&r!==void 0?r:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let a;if(i===null)a=0;else if(i<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else a=i;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(t),this.reportStatus(e))},a)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(i,a=>{a||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e));break}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(t.length===0)return null;try{return parseInt(t[0])}catch{return-1}}handleChildStatus(e,t){var i;if(this.underlyingCalls[t].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===J3.Status.OK){(i=this.retryThrottler)===null||i===void 0||i.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let r=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,r):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,r);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,i;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let r=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(r.maxAttempts,5))return;let s=(e=r.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(i=(t=this.hedgingTimer).unref)===null||i===void 0||i.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let i=this.attempts-1,r=this.initialMetadata.clone();i>0&&r.set(Uh,`${i}`);let s=!1;e.start(r,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),s=!0,i>0&&o.set(Uh,`${i}`),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&i>0&&o.metadata.set(Uh,`${i}`),this.handleChildStatus(o,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,i;let r=this.underlyingCalls[e],s=r.nextMessageToSend;(i=(t=this.getBufferEntry(s)).callback)===null||i===void 0||i.call(t),this.clearSentMessages(),r.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if(t.state!=="COMPLETED"&&this.getBufferEntry(t.nextMessageToSend)){let i=this.getBufferEntry(t.nextMessageToSend);switch(i.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:r=>{this.handleChildWriteCompleted(e)}},i.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,t){var i;this.trace("write() called with message of length "+t.length);let r={message:t,flags:e.flags},s=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:r,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(i=e.callback)===null||i===void 0||i.call(e);for(let[a,c]of this.underlyingCalls.entries())c.state==="ACTIVE"&&c.nextMessageToSend===s&&c.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(a)}},t)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===s&&a.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};ms.RetryingCall=$h});var t6=k(e6=>{"use strict";Object.defineProperty(e6,"__esModule",{value:!0});e6.BaseSubchannelWrapper=void 0;var Gh=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};e6.BaseSubchannelWrapper=Gh});var Zy=k(r6=>{"use strict";Object.defineProperty(r6,"__esModule",{value:!0});r6.InternalChannel=void 0;var jR=Bc(),WR=Cp(),$R=By(),Qy=Xr(),L4=Ve(),GR=Dh(),YR=jy(),Xy=Vi(),Yh=bt(),KR=_h(),n6=Rn(),Qi=Gn(),V4=r1(),QR=$y(),XR=W3(),ZR=Yy(),Kh=Eh(),JR=G3(),Qh=Ky(),eL=t6(),tL=2147483647,nL=1e3,iL=30*60*1e3,i6=new Map,rL=1<<24,sL=1<<20,Xh=class extends eL.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(i,r,s,o)=>{t.throttleKeepalive(o)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},Zh=class{constructor(e,t,i){var r,s,o,a,c,l,u,h;if(this.credentials=t,this.options=i,this.connectivityState=Qi.ConnectivityState.IDLE,this.currentPicker=new Qy.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new V4.ChannelzCallTracker,this.childrenTracker=new V4.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof jR.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&typeof i!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let d=(0,n6.parseUri)(e);if(d===null)throw new Error(`Could not parse target name "${e}"`);let g=(0,Xy.mapUriDefaultScheme)(d);if(g===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},tL),(s=(r=this.callRefTimer).unref)===null||s===void 0||s.call(r),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new V4.ChannelzTrace,this.channelzRef=(0,V4.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,Xy.getDefaultAuthority)(g);let _=(0,KR.mapProxyName)(g,i);this.target=_.target,this.options=Object.assign({},this.options,_.extraOptions),this.subchannelPool=(0,$R.getSubchannelPool)(((o=i["grpc.use_local_subchannel_pool"])!==null&&o!==void 0?o:0)===0),this.retryBufferTracker=new Qh.MessageBufferTracker((a=i["grpc.retry_buffer_size"])!==null&&a!==void 0?a:rL,(c=i["grpc.per_rpc_retry_buffer_size"])!==null&&c!==void 0?c:sL),this.keepaliveTime=(l=i["grpc.keepalive_time_ms"])!==null&&l!==void 0?l:-1,this.idleTimeoutMs=Math.max((u=i["grpc.client_idle_timeout_ms"])!==null&&u!==void 0?u:iL,nL);let T={createSubchannel:(L,x)=>{let V=this.subchannelPool.getOrCreateSubchannel(this.target,L,Object.assign({},this.options,x),this.credentials);V.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",V.getChannelzRef());let P=new Xh(V,this);return this.wrappedSubchannels.add(P),P},updateState:(L,x)=>{this.currentPicker=x;let V=this.pickQueue.slice();this.pickQueue=[],V.length>0&&this.callRefTimerUnref();for(let P of V)P.doPick();this.updateState(L)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:L=>{this.channelzEnabled&&this.childrenTracker.refChild(L)},removeChannelzChild:L=>{this.channelzEnabled&&this.childrenTracker.unrefChild(L)}};this.resolvingLoadBalancer=new WR.ResolvingLoadBalancer(this.target,T,i,(L,x)=>{L.retryThrottling?i6.set(this.getTarget(),new Qh.RetryThrottler(L.retryThrottling.maxTokens,L.retryThrottling.tokenRatio,i6.get(this.getTarget()))):i6.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=x,this.currentResolutionError=null,process.nextTick(()=>{let V=this.configSelectionQueue;this.configSelectionQueue=[],V.length>0&&this.callRefTimerUnref();for(let P of V)P.getConfig()})},L=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+L.code+' and details "'+L.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,JR.restrictControlPlaneStatusCode)(L.code,L.details)),{metadata:L.metadata}));let x=this.configSelectionQueue;this.configSelectionQueue=[],x.length>0&&this.callRefTimerUnref();for(let V of x)V.reportResolverError(L)}),this.filterStackFactory=new GR.FilterStackFactory([new YR.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(i,void 0,2));let E=new Error;(0,Yh.trace)(L4.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((h=E.stack)===null||h===void 0?void 0:h.substring(E.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,Yh.trace)(t??L4.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,n6.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,i,r;!((t=(e=this.callRefTimer).hasRef)===null||t===void 0)&&t.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(r=(i=this.callRefTimer).ref)===null||r===void 0||r.call(i))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(t=(e=this.callRefTimer).unref)===null||t===void 0||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(i=>i===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){(0,Yh.trace)(L4.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,n6.uriToString)(this.target)+" "+Qi.ConnectivityState[this.connectivityState]+" -> "+Qi.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Qi.ConnectivityState[e]),this.connectivityState=e;let t=this.connectivityStateWatchers.slice();for(let i of t)e!==i.currentState&&(i.timer&&clearTimeout(i.timer),this.removeConnectivityStateWatcher(i),i.callback());e!==Qi.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let t of this.wrappedSubchannels)t.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(Qi.ConnectivityState.IDLE),this.currentPicker=new Qy.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,i;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let s=new Date().valueOf()-this.lastActivityTimestamp.valueOf();s>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-s)},e),(i=(t=this.idleTimer).unref)===null||i===void 0||i.call(t)}maybeStartIdleTimer(){this.connectivityState!==Qi.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===L4.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,i,r,s){let o=(0,Kh.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+t+'"'),new QR.LoadBalancingCall(this,e,t,i,r,s,o)}createRetryingCall(e,t,i,r,s){let o=(0,Kh.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+t+'"'),new Qh.RetryingCall(this,e,t,i,r,s,o,this.retryBufferTracker,i6.get(this.getTarget()))}createInnerCall(e,t,i,r,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,t,i,r,s):this.createRetryingCall(e,t,i,r,s)}createResolvingCall(e,t,i,r,s){let o=(0,Kh.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,XR.deadlineToString)(t));let a={deadline:t,flags:s??L4.Propagate.DEFAULTS,host:i??this.defaultAuthority,parentCall:r},c=new ZR.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),o);return this.onCallStart(),c.addStatusWatcher(l=>{this.onCallEnd(l)}),c}close(){this.resolvingLoadBalancer.destroy(),this.updateState(Qi.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,V4.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,n6.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,i){if(this.connectivityState===Qi.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let r=null;if(t!==1/0){let o=t instanceof Date?t:new Date(t),a=new Date;if(t===-1/0||o<=a){process.nextTick(i,new Error("Deadline passed without connectivity state change"));return}r=setTimeout(()=>{this.removeConnectivityStateWatcher(s),i(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let s={currentState:e,callback:i,timer:r};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,i,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===Qi.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,t,i,r,s)}};r6.InternalChannel=Zh});var nu=k(s6=>{"use strict";Object.defineProperty(s6,"__esModule",{value:!0});s6.ChannelImplementation=void 0;var oL=Bc(),aL=Zy(),Jh=class{constructor(e,t,i){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof oL.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&typeof i!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new aL.InternalChannel(e,t,i)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,i){this.internalChannel.watchConnectivityState(e,t,i)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,i,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,i,r,s)}};s6.ChannelImplementation=Jh});var aw=k(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.Http2ServerCallStream=ni.ServerDuplexStreamImpl=ni.ServerWritableStreamImpl=ni.ServerReadableStreamImpl=ni.ServerUnaryCallImpl=void 0;var rw=He("events"),Wo=He("http2"),n5=He("stream"),Jy=He("zlib"),rt=Ve(),i5=En(),cL=Sh(),sw=bt(),P4=Rc(),ow="server_call";function N4(n){sw.trace(rt.LogVerbosity.DEBUG,ow,n)}var lL="grpc-accept-encoding",uL="grpc-encoding",ew="grpc-message",tw="grpc-status",nw="grpc-timeout",hL=/(\d{1,8})\s*([HMSmun])/,dL={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},fL={[lL]:"identity,deflate,gzip",[uL]:"identity"},iw={[Wo.constants.HTTP2_HEADER_STATUS]:Wo.constants.HTTP_STATUS_OK,[Wo.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},mL={waitForTrailers:!0},e5=class extends rw.EventEmitter{constructor(e,t,i){super(),this.call=e,this.metadata=t,this.request=i,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};ni.ServerUnaryCallImpl=e5;var o6=class extends n5.Readable{constructor(e,t,i,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=i,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,r)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};ni.ServerReadableStreamImpl=o6;var H4=class extends n5.Writable{constructor(e,t,i,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=i,this.request=r,this.cancelled=!1,this.trailingMetadata=new i5.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,i){try{let r=this.call.serializeMessage(e);if(!this.call.write(r)){this.call.once("drain",i);return}}catch(r){this.emit("error",{details:(0,P4.getErrorMessage)(r),code:rt.Status.INTERNAL})}i()}_final(e){this.call.sendStatus({code:rt.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};ni.ServerWritableStreamImpl=H4;var $o=class extends n5.Duplex{constructor(e,t,i,r,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=i,this.deserialize=r,this.cancelled=!1,this.trailingMetadata=new i5.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",o=>{this.call.sendError(o),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};ni.ServerDuplexStreamImpl=$o;$o.prototype._read=o6.prototype._read;$o.prototype._write=H4.prototype._write;$o.prototype._final=H4.prototype._final;var t5=class extends rw.EventEmitter{constructor(e,t,i){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=rt.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=rt.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",r=>{}),this.stream.once("close",()=>{var r;N4("Request to method "+((r=this.handler)===null||r===void 0?void 0:r.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:rt.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in i&&(this.maxSendMessageSize=i["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in i&&(this.maxReceiveMessageSize=i["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){let i=e.subarray(5);if(t==="identity")return i;if(t==="deflate"||t==="gzip"){let r;return t==="deflate"?r=Jy.createInflate():r=Jy.createGunzip(),new Promise((s,o)=>{let a=0,c=[];r.on("data",l=>{c.push(l),a+=l.byteLength,this.maxReceiveMessageSize!==-1&&a>this.maxReceiveMessageSize&&(r.destroy(),o({code:rt.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),r.on("end",()=>{s(Buffer.concat(c))}),r.write(i),r.end()})}else return Promise.reject({code:rt.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,i=Object.assign(Object.assign(Object.assign({},iw),fL),t);this.stream.respond(i,mL)}receiveMetadata(e){let t=i5.Metadata.fromHttp2Headers(e);sw.isTracerEnabled(ow)&&N4("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let i=t.get(nw);if(i.length>0){let r=i[0].toString().match(hL);if(r===null){let a=new Error("Invalid deadline");return a.code=rt.Status.OUT_OF_RANGE,this.sendError(a),t}let s=+r[1]*dL[r[2]]|0,o=new Date;this.deadline=o.setMilliseconds(o.getMilliseconds()+s),this.deadlineTimer=setTimeout(pL,s,this),t.remove(nw)}return t.remove(Wo.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(Wo.constants.HTTP2_HEADER_TE),t.remove(Wo.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,i)=>{let{stream:r}=this,s=0,o=this,a=[],c=this.maxReceiveMessageSize;this.stream.on("data",l),this.stream.on("end",u),this.stream.on("error",u);function l(h){if(s+=h.byteLength,c!==-1&&s>c){r.removeListener("data",l),r.removeListener("end",u),r.removeListener("error",u),i({code:rt.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${c})`});return}a.push(h)}function u(h){if(r.removeListener("data",l),r.removeListener("end",u),r.removeListener("error",u),h!==void 0){i({code:rt.Status.INTERNAL,details:h.message});return}if(s===0){i({code:rt.Status.INTERNAL,details:"received empty unary message"});return}o.emit("receiveMessage");let d=Buffer.concat(a,s),_=d.readUInt8(0)===1?e:"identity",T=o.getDecompressedMessage(d,_);if(Buffer.isBuffer(T)){t(o.deserializeMessageWithInternalError(T));return}T.then(E=>t(o.deserializeMessageWithInternalError(E)),E=>i(E.code?E:{code:rt.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}deserializeMessageWithInternalError(e){return S(this,null,function*(){try{return this.deserializeMessage(e)}catch(t){throw{details:(0,P4.getErrorMessage)(t),code:rt.Status.INTERNAL}}})}serializeMessage(e){let t=this.handler.serialize(e),i=t.byteLength,r=Buffer.allocUnsafe(i+5);return r.writeUInt8(0,0),r.writeUInt32BE(i,1),t.copy(r,5),r}deserializeMessage(e){return this.handler.deserialize(e)}sendUnaryMessage(e,t,i,r){return S(this,null,function*(){if(!this.checkCancelled()){if(i===void 0&&(i=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&i&&(e.metadata=i),this.sendError(e);return}try{let s=this.serializeMessage(t);this.write(s),this.sendStatus({code:rt.Status.OK,details:"OK",metadata:i})}catch(s){this.sendError({details:(0,P4.getErrorMessage)(s),code:rt.Status.INTERNAL})}}})}sendStatus(e){var t,i;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===rt.Status.OK),!this.checkCancelled())if(N4("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+rt.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var r;let s=Object.assign({[tw]:e.code,[ew]:encodeURI(e.details)},(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let r=Object.assign(Object.assign({[tw]:e.code,[ew]:encodeURI(e.details)},iw),(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());this.stream.respond(r,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:rt.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&typeof e.details=="string"&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:rt.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let i=new cL.StreamDecoder(this.maxReceiveMessageSize),r=!1,s=!1,o=!1,a=()=>S(this,null,function*(){!o&&r&&!s&&(o=!0,yield this.pushOrBufferMessage(e,null))});this.stream.on("data",c=>S(this,null,function*(){let l;try{l=i.write(c)}catch(u){this.sendError({code:rt.Status.RESOURCE_EXHAUSTED,details:u.message});return}s=!0,this.stream.pause();for(let u of l){this.emit("receiveMessage");let d=u.readUInt8(0)===1?t:"identity",g;try{g=yield this.getDecompressedMessage(u,d)}catch(_){this.sendError(_);return}if(!g)return;yield this.pushOrBufferMessage(e,g)}s=!1,this.stream.resume(),yield a()})),this.stream.once("end",()=>S(this,null,function*(){r=!0,yield a()}))}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),i=e.push(t);if(t===null||i===!1){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,t){return S(this,null,function*(){this.isPushPending?this.bufferedMessages.push(t):yield this.pushMessage(e,t)})}pushMessage(e,t){return S(this,null,function*(){if(t===null){N4("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}N4("Received message of length "+t.length),this.isPushPending=!0;try{let i=yield this.deserializeMessage(t);this.canPush?e.push(i)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(i)}catch(i){this.bufferedMessages.length=0;let r=(0,P4.getErrorCode)(i);(r===null||r<rt.Status.OK||r>rt.Status.UNAUTHENTICATED)&&(r=rt.Status.INTERNAL),e.emit("error",{details:(0,P4.getErrorMessage)(i),code:r})}this.isPushPending=!1,this.bufferedMessages.length>0&&(yield this.pushMessage(e,this.bufferedMessages.shift()))})}getPeer(){var e;let t=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return t?.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};ni.Http2ServerCallStream=t5;function pL(n){let e=new Error("Deadline exceeded");e.code=rt.Status.DEADLINE_EXCEEDED,n.sendError(e),n.cancelled=!0,n.emit("cancelled","deadline")}});var o5=k(a6=>{"use strict";Object.defineProperty(a6,"__esModule",{value:!0});a6.ServerCredentials=void 0;var cw=Ml(),B4=class{static createInsecure(){return new r5}static createSsl(e,t,i=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if(typeof i!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let r=[],s=[];for(let o=0;o<t.length;o++){let a=t[o];if(a===null||typeof a!="object")throw new TypeError(`keyCertPair[${o}] must be an object`);if(!Buffer.isBuffer(a.private_key))throw new TypeError(`keyCertPair[${o}].private_key must be a Buffer`);if(!Buffer.isBuffer(a.cert_chain))throw new TypeError(`keyCertPair[${o}].cert_chain must be a Buffer`);r.push(a.cert_chain),s.push(a.private_key)}return new s5({ca:e||(0,cw.getDefaultRootsData)()||void 0,cert:r,key:s,requestCert:i,ciphers:cw.CIPHER_SUITES})}};a6.ServerCredentials=B4;var r5=class extends B4{_isSecure(){return!1}_getSettings(){return null}},s5=class extends B4{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var hw=k(u6=>{"use strict";Object.defineProperty(u6,"__esModule",{value:!0});u6.Server=void 0;var ps=He("http2"),Er=Ve(),o1=aw(),gL=o5(),lw=Vi(),c6=bt(),Ci=Pi(),vL=Rn(),xn=r1(),l6=~(1<<31),yL=~(1<<31),wL=2e4,{HTTP2_HEADER_PATH:uw}=ps.constants,bL="server";function _L(){}function a5(n){return{code:Er.Status.UNIMPLEMENTED,details:`The server does not implement the method ${n}`}}function CL(n,e){let t=a5(e);switch(n){case"unary":return(i,r)=>{r(t,null)};case"clientStream":return(i,r)=>{r(t,null)};case"serverStream":return i=>{i.emit("error",t)};case"bidi":return i=>{i.emit("error",t)};default:throw new Error(`Invalid handlerType ${n}`)}}var c5=class{constructor(e){var t,i,r,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new xn.ChannelzTrace,this.callTracker=new xn.ChannelzCallTracker,this.listenerChildrenTracker=new xn.ChannelzChildrenTracker,this.sessionChildrenTracker=new xn.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,xn.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(t=this.options["grpc.max_connection_age_ms"])!==null&&t!==void 0?t:l6,this.maxConnectionAgeGraceMs=(i=this.options["grpc.max_connection_age_grace_ms"])!==null&&i!==void 0?i:l6,this.keepaliveTimeMs=(r=this.options["grpc.keepalive_time_ms"])!==null&&r!==void 0?r:yL,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:wL,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,i,r;let s=this.sessions.get(e),o=e.socket,a=o.remoteAddress?(0,Ci.stringToSubchannelAddress)(o.remoteAddress,o.remotePort):null,c=o.localAddress?(0,Ci.stringToSubchannelAddress)(o.localAddress,o.localPort):null,l;if(e.encrypted){let h=o,d=h.getCipher(),g=h.getCertificate(),_=h.getPeerCertificate();l={cipherSuiteStandardName:(t=d.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:d.standardName?null:d.name,localCertificate:g&&"raw"in g?g.raw:null,remoteCertificate:_&&"raw"in _?_.raw:null}}else l=null;return{remoteAddress:a,localAddress:c,security:l,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(i=e.state.localWindowSize)!==null&&i!==void 0?i:null,remoteFlowControlWindow:(r=e.state.remoteWindowSize)!==null&&r!==void 0?r:null}}}trace(e){c6.trace(Er.LogVerbosity.DEBUG,bL,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!="object"||t===null||typeof t!="object")throw new Error("addService() requires two objects as arguments");let i=Object.keys(e);if(i.length===0)throw new Error("Cannot add an empty service to a server");i.forEach(r=>{let s=e[r],o;s.requestStream?s.responseStream?o="bidi":o="clientStream":s.responseStream?o="serverStream":o="unary";let a=t[r],c;if(a===void 0&&typeof s.originalName=="string"&&(a=t[s.originalName]),a!==void 0?c=a.bind(t):c=CL(o,r),this.register(s.path,c,s.responseSerialize,s.requestDeserialize,o)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(i=>{let r=e[i];this.unregister(r.path)})}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,i){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(t===null||!(t instanceof gL.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof i!="function")throw new TypeError("callback must be a function");let r=(0,vL.parseUri)(e);if(r===null)throw new Error(`Could not parse port "${e}"`);let s=(0,lw.mapUriDefaultScheme)(r);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let o={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?o.maxSessionMemory=this.options["grpc-node.max_session_memory"]:o.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(o.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let a=(g,_)=>{process.nextTick(()=>i(g,_))},c=()=>{let g;if(t._isSecure()){let _=Object.assign(o,t._getSettings());_.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,g=ps.createSecureServer(_),g.on("secureConnection",T=>{T.on("error",E=>{this.trace("An incoming TLS connection closed with error: "+E.message)})})}else g=ps.createServer(o);return g.setTimeout(0,_L),this._setupHandlers(g),g},l=(g,_,T)=>g.length===0?Promise.resolve({port:_,count:T}):Promise.all(g.map(E=>{this.trace("Attempting to bind "+(0,Ci.subchannelAddressToString)(E));let L;(0,Ci.isTcpSubchannelAddress)(E)?L={host:E.host,port:_}:L=E;let x=c();return new Promise((V,P)=>{let G=K=>{this.trace("Failed to bind "+(0,Ci.subchannelAddressToString)(E)+" with error "+K.message),V(K)};x.once("error",G),x.listen(L,()=>{if(this.shutdown){x.close(),V(new Error("bindAsync failed because server is shutdown"));return}let K=x.address(),w;typeof K=="string"?w={path:K}:w={host:K.address,port:K.port};let v=(0,xn.registerChannelzSocket)((0,Ci.subchannelAddressToString)(w),()=>({localAddress:w,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(v),this.http2ServerList.push({server:x,channelzRef:v}),this.trace("Successfully bound "+(0,Ci.subchannelAddressToString)(w)),V("port"in w?w.port:_),x.removeListener("error",G)})})})).then(E=>{let L=0;for(let x of E)if(typeof x=="number"&&(L+=1,x!==_))throw new Error("Invalid state: multiple port numbers added from single address");return{port:_,count:L+T}}),u=g=>{if(g.length===0)return Promise.resolve({port:0,count:0});let _=g[0],T=c();return new Promise((E,L)=>{let x=V=>{this.trace("Failed to bind "+(0,Ci.subchannelAddressToString)(_)+" with error "+V.message),E(u(g.slice(1)))};T.once("error",x),T.listen(_,()=>{if(this.shutdown){T.close(),E({port:0,count:0});return}let V=T.address(),P={host:V.address,port:V.port},G=(0,xn.registerChannelzSocket)((0,Ci.subchannelAddressToString)(P),()=>({localAddress:P,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(G),this.http2ServerList.push({server:T,channelzRef:G}),this.trace("Successfully bound "+(0,Ci.subchannelAddressToString)(P)),E(l(g.slice(1),V.port,1)),T.removeListener("error",x)})})},h={onSuccessfulResolution:(g,_,T)=>{if(h.onSuccessfulResolution=()=>{},this.shutdown&&a(new Error("bindAsync failed because server is shutdown"),0),g.length===0){a(new Error(`No addresses resolved for port ${e}`),0);return}let E;(0,Ci.isTcpSubchannelAddress)(g[0])?g[0].port===0?E=u(g):E=l(g,g[0].port,0):E=l(g,1,0),E.then(L=>{if(L.count===0){let x=`No address added out of total ${g.length} resolved`;c6.log(Er.LogVerbosity.ERROR,x),a(new Error(x),0)}else L.count<g.length&&c6.log(Er.LogVerbosity.INFO,`WARNING Only ${L.count} addresses added out of total ${g.length} resolved`),a(null,L.port)},L=>{let x=`No address added out of total ${g.length} resolved`;c6.log(Er.LogVerbosity.ERROR,x),a(new Error(x),0)})},onError:g=>{a(new Error(g.details),0)}};(0,lw.createResolver)(s,h,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,xn.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(ps.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,xn.unregisterChannelzRef)(this.channelzRef)}register(e,t,i,r,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:t,serialize:i,deserialize:r,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=s=>{this.channelzEnabled&&(0,xn.unregisterChannelzRef)(this.channelzRef),e(s)},i=0;function r(){i--,i===0&&t()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:o}of this.http2ServerList)s.listening&&(i++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(o),(0,xn.unregisterChannelzRef)(o)),r()}));this.sessions.forEach((s,o)=>{o.closed||(i+=1,o.close(r))}),i===0&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let i=t[ps.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof i!="string"||!i.startsWith("application/grpc")?(e.respond({[ps.constants.HTTP2_HEADER_STATUS]:ps.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return t===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,i=null){let r=new o1.Http2ServerCallStream(t,null,this.options);e.code===void 0&&(e.code=Er.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),i?.streamTracker.addCallFailed()),r.sendError(e)}_channelzHandler(e,t){let i=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),i?.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),i?.streamTracker.addCallFailed();return}let r=t[uw],s=this._retrieveHandler(r);if(!s){this._respondWithError(a5(r),e,i);return}let o=new o1.Http2ServerCallStream(e,s,this.options);o.once("callEnd",a=>{a===Er.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),i&&(o.once("streamEnd",a=>{a?i.streamTracker.addCallSucceeded():i.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{i.messagesSent+=1,i.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{i.messagesReceived+=1,i.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,s,t)||(this.callTracker.addCallFailed(),i?.streamTracker.addCallFailed(),o.sendError({code:Er.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,t){if(this._verifyContentType(e,t)!==!0)return;let i=t[uw],r=this._retrieveHandler(i);if(!r){this._respondWithError(a5(i),e,null);return}let s=new o1.Http2ServerCallStream(e,r,this.options);this._runHandlerForCall(s,r,t)||s.sendError({code:Er.Status.INTERNAL,details:`Unknown handler type: ${r.type}`})}_runHandlerForCall(e,t,i){var r;let s=e.receiveMetadata(i),o=(r=s.get("grpc-encoding")[0])!==null&&r!==void 0?r:"identity";s.remove("grpc-encoding");let{type:a}=t;if(a==="unary")SL(e,t,s,o);else if(a==="clientStream")TL(e,t,s,o);else if(a==="serverStream")EL(e,t,s,o);else if(a==="bidi")ML(e,t,s,o);else return!1;return!0}_setupHandlers(e){if(e===null)return;let t=e.address(),i="null";t&&(typeof t=="string"?i=t:i=t.address+":"+t.port),this.serverAddressString=i;let r=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",r.bind(this)),e.on("session",s=>{var o,a,c,l,u;if(!this.started){s.destroy();return}let h=(0,xn.registerChannelzSocket)((o=s.socket.remoteAddress)!==null&&o!==void 0?o:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),d={ref:h,streamTracker:new xn.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,d);let g=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+g),this.sessionChildrenTracker.refChild(h));let _=null,T=null,E=!1;if(this.maxConnectionAgeMs!==l6){let x=this.maxConnectionAgeMs/10,V=Math.random()*x*2-x;_=(c=(a=setTimeout(()=>{var P,G;E=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+g);try{s.goaway(ps.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==l6&&(T=(G=(P=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||G===void 0?void 0:G.call(P))},this.maxConnectionAgeMs+V)).unref)===null||c===void 0?void 0:c.call(a)}let L=(u=(l=setInterval(()=>{var x,V;let P=(V=(x=setTimeout(()=>{E=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+g),s.close()},this.keepaliveTimeoutMs)).unref)===null||V===void 0?void 0:V.call(x);try{s.ping((G,K,w)=>{clearTimeout(P)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||u===void 0?void 0:u.call(l);s.on("close",()=>{this.channelzEnabled&&(E||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+g),this.sessionChildrenTracker.unrefChild(h),(0,xn.unregisterChannelzRef)(h)),_&&clearTimeout(_),T&&clearTimeout(T),L&&clearTimeout(L),this.sessions.delete(s)})})}};u6.Server=c5;function SL(n,e,t,i){return S(this,null,function*(){try{let r=yield n.receiveUnaryMessage(i);if(r===void 0||n.cancelled)return;let s=new o1.ServerUnaryCallImpl(n,t,r);e.func(s,(o,a,c,l)=>{n.sendUnaryMessage(o,a,c,l)})}catch(r){n.sendError(r)}})}function TL(n,e,t,i){let r=new o1.ServerReadableStreamImpl(n,t,e.deserialize,i);function s(o,a,c,l){r.destroy(),n.sendUnaryMessage(o,a,c,l)}n.cancelled||(r.on("error",s),e.func(r,s))}function EL(n,e,t,i){return S(this,null,function*(){try{let r=yield n.receiveUnaryMessage(i);if(r===void 0||n.cancelled)return;let s=new o1.ServerWritableStreamImpl(n,t,e.serialize,r);e.func(s)}catch(r){n.sendError(r)}})}function ML(n,e,t,i){let r=new o1.ServerDuplexStreamImpl(n,t,e.serialize,e.deserialize,i);n.cancelled||e.func(r)}});var dw=k(h6=>{"use strict";Object.defineProperty(h6,"__esModule",{value:!0});h6.StatusBuilder=void 0;var l5=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};h6.StatusBuilder=l5});var u5=k(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.isDuration=gs.durationToMs=gs.msToDuration=void 0;function zL(n){return{seconds:n/1e3|0,nanos:n%1e3*1e6|0}}gs.msToDuration=zL;function xL(n){return n.seconds*1e3+n.nanos/1e6|0}gs.durationToMs=xL;function OL(n){return typeof n.seconds=="number"&&typeof n.nanos=="number"}gs.isDuration=OL});var y5=k(vs=>{"use strict";var h5;Object.defineProperty(vs,"__esModule",{value:!0});vs.setup=vs.OutlierDetectionLoadBalancer=vs.OutlierDetectionLoadBalancingConfig=void 0;var f6=Gn(),mw=Ve(),a1=u5(),pw=w5(),gw=Gr(),IL=Gc(),AL=Xr(),fw=Pi(),DL=t6(),kL=bt(),RL="outlier_detection";function Wt(n){kL.trace(mw.LogVerbosity.DEBUG,RL,n)}var v5="outlier_detection",LL=((h5=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&h5!==void 0?h5:"true")==="true",VL={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},NL={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function Go(n,e,t,i){if(e in n&&typeof n[e]!==t){let r=i?`${i}.${e}`:e;throw new Error(`outlier detection config ${r} parse error: expected ${t}, got ${typeof n[e]}`)}}function d5(n,e,t){let i=t?`${t}.${e}`:e;if(e in n){if(!(0,a1.isDuration)(n[e]))throw new Error(`outlier detection config ${i} parse error: expected Duration, got ${typeof n[e]}`);if(!(n[e].seconds>=0&&n[e].seconds<=315576e6&&n[e].nanos>=0&&n[e].nanos<=999999999))throw new Error(`outlier detection config ${i} parse error: values out of range for non-negative Duaration`)}}function d6(n,e,t){let i=t?`${t}.${e}`:e;if(Go(n,e,"number",t),e in n&&!(n[e]>=0&&n[e]<=100))throw new Error(`outlier detection config ${i} parse error: value out of range for percentage (0-100)`)}var F4=class n{constructor(e,t,i,r,s,o,a){if(this.childPolicy=a,a.length>0&&a[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=t??3e4,this.maxEjectionTimeMs=i??3e5,this.maxEjectionPercent=r??10,this.successRateEjection=s?Object.assign(Object.assign({},VL),s):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},NL),o):null}getLoadBalancerName(){return v5}toJsonObject(){return{interval:(0,a1.msToDuration)(this.intervalMs),base_ejection_time:(0,a1.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,a1.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new n(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(d5(e,"interval"),d5(e,"base_ejection_time"),d5(e,"max_ejection_time"),d6(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");Go(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),d6(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),Go(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),Go(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");d6(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),d6(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),Go(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),Go(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new n(e.interval?(0,a1.durationToMs)(e.interval):null,e.base_ejection_time?(0,a1.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,a1.durationToMs)(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(gw.validateLoadBalancingConfig))}};vs.OutlierDetectionLoadBalancingConfig=F4;var m5=class extends DL.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((i,r,s,o)=>{if(this.childSubchannelState=s,!this.ejected)for(let a of this.stateListeners)a(this,r,s,o)})}getConnectivityState(){return this.ejected?f6.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,f6.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,f6.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function f5(){return{success:0,failure:0}}var p5=class{constructor(){this.activeBucket=f5(),this.inactiveBucket=f5()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=f5()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},g5=class{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType===AL.PickResultType.COMPLETE){let i=t.subchannel,r=i.getMapEntry();if(r){let s=t.onCallEnded;return this.countCalls&&(s=o=>{var a;o===mw.Status.OK?r.counter.addSuccess():r.counter.addFailure(),(a=t.onCallEnded)===null||a===void 0||a.call(t,o)}),Object.assign(Object.assign({},t),{subchannel:i.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},t),{subchannel:i.getWrappedSubchannel()})}else return t}},m6=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new IL.ChildLoadBalancerHandler((0,pw.createChildChannelControlHelper)(e,{createSubchannel:(t,i)=>{let r=e.createSubchannel(t,i),s=this.addressMap.get((0,fw.subchannelAddressToString)(t)),o=new m5(r,s);return s?.currentEjectionTimestamp!==null&&o.eject(),s?.subchannelWrappers.push(o),o},updateState:(t,i)=>{t===f6.ConnectivityState.READY?e.updateState(t,new g5(i,this.isCountingEnabled())):e.updateState(t,i)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())t.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;Wt("Running success rate check");let i=t.request_volume,r=0,s=[];for(let[h,d]of this.addressMap){let g=d.counter.getLastSuccesses(),_=d.counter.getLastFailures();Wt("Stats for "+h+": successes="+g+" failures="+_+" targetRequestVolume="+i),g+_>=i&&(r+=1,s.push(g/(g+_)))}if(Wt("Found "+r+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),r<t.minimum_hosts)return;let o=s.reduce((h,d)=>h+d)/s.length,a=0;for(let h of s){let d=h-o;a+=d*d}let c=a/s.length,l=Math.sqrt(c),u=o-l*(t.stdev_factor/1e3);Wt("stdev="+l+" ejectionThreshold="+u);for(let[h,d]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let g=d.counter.getLastSuccesses(),_=d.counter.getLastFailures();if(g+_<i)continue;let T=g/(g+_);if(Wt("Checking candidate "+h+" successRate="+T),T<u){let E=Math.random()*100;Wt("Candidate "+h+" randomNumber="+E+" enforcement_percentage="+t.enforcement_percentage),E<t.enforcement_percentage&&(Wt("Ejecting candidate "+h),this.eject(d,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;Wt("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let i=0;for(let r of this.addressMap.values()){let s=r.counter.getLastSuccesses(),o=r.counter.getLastFailures();s+o>=t.request_volume&&(i+=1)}if(!(i<t.minimum_hosts))for(let[r,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(Wt("Candidate successes="+o+" failures="+a),o+a<t.request_volume)continue;if(a*100/(a+o)>t.threshold){let l=Math.random()*100;Wt("Candidate "+r+" randomNumber="+l+" enforcement_percentage="+t.enforcement_percentage),l<t.enforcement_percentage&&(Wt("Ejecting candidate "+r),this.eject(s,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let i of e.subchannelWrappers)i.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,i;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(i=(t=this.ejectionTimer).unref)===null||i===void 0||i.call(t)}runChecks(){let e=new Date;if(Wt("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[t,i]of this.addressMap.entries())if(i.currentEjectionTimestamp===null)i.ejectionTimeMultiplier>0&&(i.ejectionTimeMultiplier-=1);else{let r=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(i.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(r*i.ejectionTimeMultiplier,Math.max(r,s))),o<new Date&&(Wt("Unejecting "+t),this.uneject(i))}}}updateAddressList(e,t,i){if(!(t instanceof F4))return;let r=new Set;for(let o of e)r.add((0,fw.subchannelAddressToString)(o));for(let o of r)this.addressMap.has(o)||(Wt("Adding map entry for "+o),this.addressMap.set(o,{counter:new p5,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let o of this.addressMap.keys())r.has(o)||(Wt("Removing map entry for "+o),this.addressMap.delete(o));let s=(0,gw.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,i),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){Wt("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let o=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(o)}else Wt("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{Wt("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let o of this.addressMap.values())this.uneject(o),o.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return v5}};vs.OutlierDetectionLoadBalancer=m6;function PL(){LL&&(0,pw.registerLoadBalancerType)(v5,m6,F4)}vs.setup=PL});var w5=k(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.OutlierDetectionLoadBalancingConfig=de.BaseSubchannelWrapper=de.registerAdminService=de.FilterStackFactory=de.BaseFilter=de.PickResultType=de.QueuePicker=de.UnavailablePicker=de.ChildLoadBalancerHandler=de.subchannelAddressToString=de.validateLoadBalancingConfig=de.getFirstUsableConfig=de.registerLoadBalancerType=de.createChildChannelControlHelper=de.BackoffTimeout=de.durationToMs=de.uriToString=de.createResolver=de.registerResolver=de.log=de.trace=void 0;var vw=bt();Object.defineProperty(de,"trace",{enumerable:!0,get:function(){return vw.trace}});Object.defineProperty(de,"log",{enumerable:!0,get:function(){return vw.log}});var yw=Vi();Object.defineProperty(de,"registerResolver",{enumerable:!0,get:function(){return yw.registerResolver}});Object.defineProperty(de,"createResolver",{enumerable:!0,get:function(){return yw.createResolver}});var HL=Rn();Object.defineProperty(de,"uriToString",{enumerable:!0,get:function(){return HL.uriToString}});var BL=u5();Object.defineProperty(de,"durationToMs",{enumerable:!0,get:function(){return BL.durationToMs}});var FL=l4();Object.defineProperty(de,"BackoffTimeout",{enumerable:!0,get:function(){return FL.BackoffTimeout}});var p6=Gr();Object.defineProperty(de,"createChildChannelControlHelper",{enumerable:!0,get:function(){return p6.createChildChannelControlHelper}});Object.defineProperty(de,"registerLoadBalancerType",{enumerable:!0,get:function(){return p6.registerLoadBalancerType}});Object.defineProperty(de,"getFirstUsableConfig",{enumerable:!0,get:function(){return p6.getFirstUsableConfig}});Object.defineProperty(de,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return p6.validateLoadBalancingConfig}});var qL=Pi();Object.defineProperty(de,"subchannelAddressToString",{enumerable:!0,get:function(){return qL.subchannelAddressToString}});var UL=Gc();Object.defineProperty(de,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return UL.ChildLoadBalancerHandler}});var b5=Xr();Object.defineProperty(de,"UnavailablePicker",{enumerable:!0,get:function(){return b5.UnavailablePicker}});Object.defineProperty(de,"QueuePicker",{enumerable:!0,get:function(){return b5.QueuePicker}});Object.defineProperty(de,"PickResultType",{enumerable:!0,get:function(){return b5.PickResultType}});var jL=Lh();Object.defineProperty(de,"BaseFilter",{enumerable:!0,get:function(){return jL.BaseFilter}});var WL=Dh();Object.defineProperty(de,"FilterStackFactory",{enumerable:!0,get:function(){return WL.FilterStackFactory}});var $L=Kc();Object.defineProperty(de,"registerAdminService",{enumerable:!0,get:function(){return $L.registerAdminService}});var GL=t6();Object.defineProperty(de,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return GL.BaseSubchannelWrapper}});var YL=y5();Object.defineProperty(de,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return YL.OutlierDetectionLoadBalancingConfig}})});var ww=k(g6=>{"use strict";Object.defineProperty(g6,"__esModule",{value:!0});g6.setup=void 0;var KL=Vi(),_5=class{constructor(e,t,i){this.listener=t,this.addresses=[],this.hasReturnedResult=!1;let r;e.authority===""?r="/"+e.path:r=e.path,this.addresses=[{path:r}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function QL(){(0,KL.registerResolver)("unix",_5)}g6.setup=QL});var Tw=k(w6=>{"use strict";Object.defineProperty(w6,"__esModule",{value:!0});w6.setup=void 0;var bw=He("net"),v6=Ve(),C5=En(),_w=Vi(),Cw=Rn(),XL=bt(),ZL="ip_resolver";function Sw(n){XL.trace(v6.LogVerbosity.DEBUG,ZL,n)}var S5="ipv4",T5="ipv6",JL=443,y6=class{constructor(e,t,i){var r;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,Sw("Resolver constructed for target "+(0,Cw.uriToString)(e));let s=[];if(!(e.scheme===S5||e.scheme===T5)){this.error={code:v6.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new C5.Metadata};return}let o=e.path.split(",");for(let a of o){let c=(0,Cw.splitHostPort)(a);if(c===null){this.error={code:v6.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new C5.Metadata};return}if(e.scheme===S5&&!(0,bw.isIPv4)(c.host)||e.scheme===T5&&!(0,bw.isIPv6)(c.host)){this.error={code:v6.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new C5.Metadata};return}s.push({host:c.host,port:(r=c.port)!==null&&r!==void 0?r:JL})}this.addresses=s,Sw("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function eV(){(0,_w.registerResolver)(S5,y6),(0,_w.registerResolver)(T5,y6)}w6.setup=eV});var zw=k(Xi=>{"use strict";Object.defineProperty(Xi,"__esModule",{value:!0});Xi.setup=Xi.PickFirstLoadBalancer=Xi.shuffled=Xi.PickFirstLoadBalancingConfig=void 0;var Ew=Gr(),tn=Gn(),b6=Xr(),tV=bt(),nV=Ve(),iV="pick_first";function E5(n){tV.trace(nV.LogVerbosity.DEBUG,iV,n)}var q4="pick_first",rV=250,U4=class n{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return q4}toJsonObject(){return{[q4]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new n(e.shuffleAddressList===!0)}};Xi.PickFirstLoadBalancingConfig=U4;var M5=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:b6.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function Mw(n){let e=n.slice();for(let t=e.length-1;t>1;t--){let i=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[i],e[i]=r}return e}Xi.shuffled=Mw;var _6=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=tn.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(t,i,r,s,o)=>{this.onSubchannelStateUpdate(t,i,r,o)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(tn.ConnectivityState.READY,new M5(this.currentPick)):this.children.length===0?this.updateState(tn.ConnectivityState.IDLE,new b6.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(tn.ConnectivityState.TRANSIENT_FAILURE,new b6.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(tn.ConnectivityState.CONNECTING,new b6.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,i,r){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){i!==tn.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){i===tn.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),i===tn.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,r&&(this.lastError=r),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,i]of this.children.entries())if(t>=e){let r=i.subchannel.getConnectivityState();if(r===tn.ConnectivityState.IDLE||r===tn.ConnectivityState.CONNECTING){this.startConnecting(t);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,i;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===tn.ConnectivityState.IDLE&&(E5("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var r;(r=this.children[e])===null||r===void 0||r.subchannel.startConnecting()})),this.connectionDelayTimeout=(i=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},rV)).unref)===null||i===void 0?void 0:i.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(E5("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){E5(tn.ConnectivityState[this.currentState]+" -> "+tn.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(i=>({subchannel:this.channelControlHelper.createSubchannel(i,{}),hasReportedTransientFailure:!1}));for(let{subchannel:i}of t)i.ref(),this.channelControlHelper.addChannelzChild(i.getChannelzRef());this.resetSubchannelList(),this.children=t;for(let{subchannel:i}of this.children)if(i.addConnectivityStateListener(this.subchannelStateListener),i.getConnectivityState()===tn.ConnectivityState.READY){this.pickSubchannel(i);return}for(let i of this.children)i.subchannel.getConnectivityState()===tn.ConnectivityState.TRANSIENT_FAILURE&&(i.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof U4&&(t.getShuffleAddressList()&&(e=Mw(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===tn.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return q4}};Xi.PickFirstLoadBalancer=_6;function sV(){(0,Ew.registerLoadBalancerType)(q4,_6,U4),(0,Ew.registerDefaultLoadBalancerType)(q4)}Xi.setup=sV});var Ow=k(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.setup=Yo.RoundRobinLoadBalancer=void 0;var oV=Gr(),nn=Gn(),C6=Xr(),aV=Pi(),cV=bt(),lV=Ve(),uV="round_robin";function xw(n){cV.trace(lV.LogVerbosity.DEBUG,uV,n)}var S6="round_robin",z5=class n{getLoadBalancerName(){return S6}constructor(){}toJsonObject(){return{[S6]:{}}}static createFromJson(e){return new n}},x5=class{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:C6.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},T6=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=nn.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(t,i,r,s,o)=>{this.calculateAndUpdateState(),(r===nn.ConnectivityState.TRANSIENT_FAILURE||r===nn.ConnectivityState.IDLE)&&(o&&(this.lastError=o),this.channelControlHelper.requestReresolution(),t.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(nn.ConnectivityState.READY)>0){let e=this.subchannels.filter(i=>i.getConnectivityState()===nn.ConnectivityState.READY),t=0;this.currentReadyPicker!==null&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(nn.ConnectivityState.READY,new x5(e,t))}else this.countSubchannelsWithState(nn.ConnectivityState.CONNECTING)>0?this.updateState(nn.ConnectivityState.CONNECTING,new C6.QueuePicker(this)):this.countSubchannelsWithState(nn.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(nn.ConnectivityState.TRANSIENT_FAILURE,new C6.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(nn.ConnectivityState.IDLE,new C6.QueuePicker(this))}updateState(e,t){xw(nn.ConnectivityState[this.currentState]+" -> "+nn.ConnectivityState[e]),e===nn.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),xw("Connect to address list "+e.map(i=>(0,aV.subchannelAddressToString)(i))),this.subchannels=e.map(i=>this.channelControlHelper.createSubchannel(i,{}));for(let i of this.subchannels){i.ref(),i.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(i.getChannelzRef());let r=i.getConnectivityState();(r===nn.ConnectivityState.IDLE||r===nn.ConnectivityState.TRANSIENT_FAILURE)&&i.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return S6}};Yo.RoundRobinLoadBalancer=T6;function hV(){(0,oV.registerLoadBalancerType)(S6,T6,z5)}Yo.setup=hV});var kw=k(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.experimental=Z.addAdminServicesToServer=Z.getChannelzHandlers=Z.getChannelzServiceDefinition=Z.InterceptorConfigurationError=Z.InterceptingCall=Z.RequesterBuilder=Z.ListenerBuilder=Z.StatusBuilder=Z.getClientChannel=Z.ServerCredentials=Z.Server=Z.setLogVerbosity=Z.setLogger=Z.load=Z.loadObject=Z.CallCredentials=Z.ChannelCredentials=Z.waitForClientReady=Z.closeClient=Z.Channel=Z.makeGenericClientConstructor=Z.makeClientConstructor=Z.loadPackageDefinition=Z.Client=Z.compressionAlgorithms=Z.propagate=Z.connectivityState=Z.status=Z.logVerbosity=Z.Metadata=Z.credentials=void 0;var E6=Tl();Object.defineProperty(Z,"CallCredentials",{enumerable:!0,get:function(){return E6.CallCredentials}});var dV=nu();Object.defineProperty(Z,"Channel",{enumerable:!0,get:function(){return dV.ChannelImplementation}});var fV=kh();Object.defineProperty(Z,"compressionAlgorithms",{enumerable:!0,get:function(){return fV.CompressionAlgorithms}});var mV=Gn();Object.defineProperty(Z,"connectivityState",{enumerable:!0,get:function(){return mV.ConnectivityState}});var M6=Bc();Object.defineProperty(Z,"ChannelCredentials",{enumerable:!0,get:function(){return M6.ChannelCredentials}});var Iw=tu();Object.defineProperty(Z,"Client",{enumerable:!0,get:function(){return Iw.Client}});var O5=Ve();Object.defineProperty(Z,"logVerbosity",{enumerable:!0,get:function(){return O5.LogVerbosity}});Object.defineProperty(Z,"status",{enumerable:!0,get:function(){return O5.Status}});Object.defineProperty(Z,"propagate",{enumerable:!0,get:function(){return O5.Propagate}});var Aw=bt(),I5=ru();Object.defineProperty(Z,"loadPackageDefinition",{enumerable:!0,get:function(){return I5.loadPackageDefinition}});Object.defineProperty(Z,"makeClientConstructor",{enumerable:!0,get:function(){return I5.makeClientConstructor}});Object.defineProperty(Z,"makeGenericClientConstructor",{enumerable:!0,get:function(){return I5.makeClientConstructor}});var pV=En();Object.defineProperty(Z,"Metadata",{enumerable:!0,get:function(){return pV.Metadata}});var gV=hw();Object.defineProperty(Z,"Server",{enumerable:!0,get:function(){return gV.Server}});var vV=o5();Object.defineProperty(Z,"ServerCredentials",{enumerable:!0,get:function(){return vV.ServerCredentials}});var yV=dw();Object.defineProperty(Z,"StatusBuilder",{enumerable:!0,get:function(){return yV.StatusBuilder}});Z.credentials={combineChannelCredentials:(n,...e)=>e.reduce((t,i)=>t.compose(i),n),combineCallCredentials:(n,...e)=>e.reduce((t,i)=>t.compose(i),n),createInsecure:M6.ChannelCredentials.createInsecure,createSsl:M6.ChannelCredentials.createSsl,createFromSecureContext:M6.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:E6.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:E6.CallCredentials.createFromGoogleCredential,createEmpty:E6.CallCredentials.createEmpty};var wV=n=>n.close();Z.closeClient=wV;var bV=(n,e,t)=>n.waitForReady(e,t);Z.waitForClientReady=bV;var _V=(n,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};Z.loadObject=_V;var CV=(n,e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};Z.load=CV;var SV=n=>{Aw.setLogger(n)};Z.setLogger=SV;var TV=n=>{Aw.setLoggerVerbosity(n)};Z.setLogVerbosity=TV;var EV=n=>Iw.Client.prototype.getChannel.call(n);Z.getClientChannel=EV;var z6=Zl();Object.defineProperty(Z,"ListenerBuilder",{enumerable:!0,get:function(){return z6.ListenerBuilder}});Object.defineProperty(Z,"RequesterBuilder",{enumerable:!0,get:function(){return z6.RequesterBuilder}});Object.defineProperty(Z,"InterceptingCall",{enumerable:!0,get:function(){return z6.InterceptingCall}});Object.defineProperty(Z,"InterceptorConfigurationError",{enumerable:!0,get:function(){return z6.InterceptorConfigurationError}});var Dw=r1();Object.defineProperty(Z,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return Dw.getChannelzServiceDefinition}});Object.defineProperty(Z,"getChannelzHandlers",{enumerable:!0,get:function(){return Dw.getChannelzHandlers}});var MV=Kc();Object.defineProperty(Z,"addAdminServicesToServer",{enumerable:!0,get:function(){return MV.addAdminServicesToServer}});var zV=w5();Z.experimental=zV;var xV=bh(),OV=ww(),IV=Tw(),AV=zw(),DV=Ow(),kV=y5(),RV=r1();xV.setup(),OV.setup(),IV.setup(),AV.setup(),DV.setup(),kV.setup(),RV.setup()});import{inspect as NV,TextEncoder as PV,TextDecoder as HV}from"util";import{randomBytes as BV}from"crypto";var op=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ap={};var jr,dl;(function(){var n;function e(w,v){function y(){}y.prototype=v.prototype,w.D=v.prototype,w.prototype=new y,w.prototype.constructor=w,w.C=function(b,m,C){for(var f=Array(arguments.length-2),p=2;p<arguments.length;p++)f[p-2]=arguments[p];return v.prototype[m].apply(b,f)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(w,v,y){y||(y=0);var b=Array(16);if(typeof v=="string")for(var m=0;16>m;++m)b[m]=v.charCodeAt(y++)|v.charCodeAt(y++)<<8|v.charCodeAt(y++)<<16|v.charCodeAt(y++)<<24;else for(m=0;16>m;++m)b[m]=v[y++]|v[y++]<<8|v[y++]<<16|v[y++]<<24;v=w.g[0],y=w.g[1],m=w.g[2];var C=w.g[3],f=v+(C^y&(m^C))+b[0]+3614090360&4294967295;v=y+(f<<7&4294967295|f>>>25),f=C+(m^v&(y^m))+b[1]+3905402710&4294967295,C=v+(f<<12&4294967295|f>>>20),f=m+(y^C&(v^y))+b[2]+606105819&4294967295,m=C+(f<<17&4294967295|f>>>15),f=y+(v^m&(C^v))+b[3]+3250441966&4294967295,y=m+(f<<22&4294967295|f>>>10),f=v+(C^y&(m^C))+b[4]+4118548399&4294967295,v=y+(f<<7&4294967295|f>>>25),f=C+(m^v&(y^m))+b[5]+1200080426&4294967295,C=v+(f<<12&4294967295|f>>>20),f=m+(y^C&(v^y))+b[6]+2821735955&4294967295,m=C+(f<<17&4294967295|f>>>15),f=y+(v^m&(C^v))+b[7]+4249261313&4294967295,y=m+(f<<22&4294967295|f>>>10),f=v+(C^y&(m^C))+b[8]+1770035416&4294967295,v=y+(f<<7&4294967295|f>>>25),f=C+(m^v&(y^m))+b[9]+2336552879&4294967295,C=v+(f<<12&4294967295|f>>>20),f=m+(y^C&(v^y))+b[10]+4294925233&4294967295,m=C+(f<<17&4294967295|f>>>15),f=y+(v^m&(C^v))+b[11]+2304563134&4294967295,y=m+(f<<22&4294967295|f>>>10),f=v+(C^y&(m^C))+b[12]+1804603682&4294967295,v=y+(f<<7&4294967295|f>>>25),f=C+(m^v&(y^m))+b[13]+4254626195&4294967295,C=v+(f<<12&4294967295|f>>>20),f=m+(y^C&(v^y))+b[14]+2792965006&4294967295,m=C+(f<<17&4294967295|f>>>15),f=y+(v^m&(C^v))+b[15]+1236535329&4294967295,y=m+(f<<22&4294967295|f>>>10),f=v+(m^C&(y^m))+b[1]+4129170786&4294967295,v=y+(f<<5&4294967295|f>>>27),f=C+(y^m&(v^y))+b[6]+3225465664&4294967295,C=v+(f<<9&4294967295|f>>>23),f=m+(v^y&(C^v))+b[11]+643717713&4294967295,m=C+(f<<14&4294967295|f>>>18),f=y+(C^v&(m^C))+b[0]+3921069994&4294967295,y=m+(f<<20&4294967295|f>>>12),f=v+(m^C&(y^m))+b[5]+3593408605&4294967295,v=y+(f<<5&4294967295|f>>>27),f=C+(y^m&(v^y))+b[10]+38016083&4294967295,C=v+(f<<9&4294967295|f>>>23),f=m+(v^y&(C^v))+b[15]+3634488961&4294967295,m=C+(f<<14&4294967295|f>>>18),f=y+(C^v&(m^C))+b[4]+3889429448&4294967295,y=m+(f<<20&4294967295|f>>>12),f=v+(m^C&(y^m))+b[9]+568446438&4294967295,v=y+(f<<5&4294967295|f>>>27),f=C+(y^m&(v^y))+b[14]+3275163606&4294967295,C=v+(f<<9&4294967295|f>>>23),f=m+(v^y&(C^v))+b[3]+4107603335&4294967295,m=C+(f<<14&4294967295|f>>>18),f=y+(C^v&(m^C))+b[8]+1163531501&4294967295,y=m+(f<<20&4294967295|f>>>12),f=v+(m^C&(y^m))+b[13]+2850285829&4294967295,v=y+(f<<5&4294967295|f>>>27),f=C+(y^m&(v^y))+b[2]+4243563512&4294967295,C=v+(f<<9&4294967295|f>>>23),f=m+(v^y&(C^v))+b[7]+1735328473&4294967295,m=C+(f<<14&4294967295|f>>>18),f=y+(C^v&(m^C))+b[12]+2368359562&4294967295,y=m+(f<<20&4294967295|f>>>12),f=v+(y^m^C)+b[5]+4294588738&4294967295,v=y+(f<<4&4294967295|f>>>28),f=C+(v^y^m)+b[8]+2272392833&4294967295,C=v+(f<<11&4294967295|f>>>21),f=m+(C^v^y)+b[11]+1839030562&4294967295,m=C+(f<<16&4294967295|f>>>16),f=y+(m^C^v)+b[14]+4259657740&4294967295,y=m+(f<<23&4294967295|f>>>9),f=v+(y^m^C)+b[1]+2763975236&4294967295,v=y+(f<<4&4294967295|f>>>28),f=C+(v^y^m)+b[4]+1272893353&4294967295,C=v+(f<<11&4294967295|f>>>21),f=m+(C^v^y)+b[7]+4139469664&4294967295,m=C+(f<<16&4294967295|f>>>16),f=y+(m^C^v)+b[10]+3200236656&4294967295,y=m+(f<<23&4294967295|f>>>9),f=v+(y^m^C)+b[13]+681279174&4294967295,v=y+(f<<4&4294967295|f>>>28),f=C+(v^y^m)+b[0]+3936430074&4294967295,C=v+(f<<11&4294967295|f>>>21),f=m+(C^v^y)+b[3]+3572445317&4294967295,m=C+(f<<16&4294967295|f>>>16),f=y+(m^C^v)+b[6]+76029189&4294967295,y=m+(f<<23&4294967295|f>>>9),f=v+(y^m^C)+b[9]+3654602809&4294967295,v=y+(f<<4&4294967295|f>>>28),f=C+(v^y^m)+b[12]+3873151461&4294967295,C=v+(f<<11&4294967295|f>>>21),f=m+(C^v^y)+b[15]+530742520&4294967295,m=C+(f<<16&4294967295|f>>>16),f=y+(m^C^v)+b[2]+3299628645&4294967295,y=m+(f<<23&4294967295|f>>>9),f=v+(m^(y|~C))+b[0]+4096336452&4294967295,v=y+(f<<6&4294967295|f>>>26),f=C+(y^(v|~m))+b[7]+1126891415&4294967295,C=v+(f<<10&4294967295|f>>>22),f=m+(v^(C|~y))+b[14]+2878612391&4294967295,m=C+(f<<15&4294967295|f>>>17),f=y+(C^(m|~v))+b[5]+4237533241&4294967295,y=m+(f<<21&4294967295|f>>>11),f=v+(m^(y|~C))+b[12]+1700485571&4294967295,v=y+(f<<6&4294967295|f>>>26),f=C+(y^(v|~m))+b[3]+2399980690&4294967295,C=v+(f<<10&4294967295|f>>>22),f=m+(v^(C|~y))+b[10]+4293915773&4294967295,m=C+(f<<15&4294967295|f>>>17),f=y+(C^(m|~v))+b[1]+2240044497&4294967295,y=m+(f<<21&4294967295|f>>>11),f=v+(m^(y|~C))+b[8]+1873313359&4294967295,v=y+(f<<6&4294967295|f>>>26),f=C+(y^(v|~m))+b[15]+4264355552&4294967295,C=v+(f<<10&4294967295|f>>>22),f=m+(v^(C|~y))+b[6]+2734768916&4294967295,m=C+(f<<15&4294967295|f>>>17),f=y+(C^(m|~v))+b[13]+1309151649&4294967295,y=m+(f<<21&4294967295|f>>>11),f=v+(m^(y|~C))+b[4]+4149444226&4294967295,v=y+(f<<6&4294967295|f>>>26),f=C+(y^(v|~m))+b[11]+3174756917&4294967295,C=v+(f<<10&4294967295|f>>>22),f=m+(v^(C|~y))+b[2]+718787259&4294967295,m=C+(f<<15&4294967295|f>>>17),f=y+(C^(m|~v))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+v&4294967295,w.g[1]=w.g[1]+(m+(f<<21&4294967295|f>>>11))&4294967295,w.g[2]=w.g[2]+m&4294967295,w.g[3]=w.g[3]+C&4294967295}i.prototype.u=function(w,v){v===void 0&&(v=w.length);for(var y=v-this.blockSize,b=this.B,m=this.h,C=0;C<v;){if(m==0)for(;C<=y;)r(this,w,C),C+=this.blockSize;if(typeof w=="string"){for(;C<v;)if(b[m++]=w.charCodeAt(C++),m==this.blockSize){r(this,b),m=0;break}}else for(;C<v;)if(b[m++]=w[C++],m==this.blockSize){r(this,b),m=0;break}}this.h=m,this.o+=v},i.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var v=1;v<w.length-8;++v)w[v]=0;var y=8*this.o;for(v=w.length-8;v<w.length;++v)w[v]=y&255,y/=256;for(this.u(w),w=Array(16),v=y=0;4>v;++v)for(var b=0;32>b;b+=8)w[y++]=this.g[v]>>>b&255;return w};function s(w,v){var y=a;return Object.prototype.hasOwnProperty.call(y,w)?y[w]:y[w]=v(w)}function o(w,v){this.h=v;for(var y=[],b=!0,m=w.length-1;0<=m;m--){var C=w[m]|0;b&&C==v||(y[m]=C,b=!1)}this.g=y}var a={};function c(w){return-128<=w&&128>w?s(w,function(v){return new o([v|0],0>v?-1:0)}):new o([w|0],0>w?-1:0)}function l(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return E(l(-w));for(var v=[],y=1,b=0;w>=y;b++)v[b]=w/y|0,y*=4294967296;return new o(v,0)}function u(w,v){if(w.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(w.charAt(0)=="-")return E(u(w.substring(1),v));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=l(Math.pow(v,8)),b=h,m=0;m<w.length;m+=8){var C=Math.min(8,w.length-m),f=parseInt(w.substring(m,m+C),v);8>C?(C=l(Math.pow(v,C)),b=b.j(C).add(l(f))):(b=b.j(y),b=b.add(l(f)))}return b}var h=c(0),d=c(1),g=c(16777216);n=o.prototype,n.m=function(){if(T(this))return-E(this).m();for(var w=0,v=1,y=0;y<this.g.length;y++){var b=this.i(y);w+=(0<=b?b:4294967296+b)*v,v*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(_(this))return"0";if(T(this))return"-"+E(this).toString(w);for(var v=l(Math.pow(w,6)),y=this,b="";;){var m=P(y,v).g;y=L(y,m.j(v));var C=((0<y.g.length?y.g[0]:y.h)>>>0).toString(w);if(y=m,_(y))return C+b;for(;6>C.length;)C="0"+C;b=C+b}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function _(w){if(w.h!=0)return!1;for(var v=0;v<w.g.length;v++)if(w.g[v]!=0)return!1;return!0}function T(w){return w.h==-1}n.l=function(w){return w=L(this,w),T(w)?-1:_(w)?0:1};function E(w){for(var v=w.g.length,y=[],b=0;b<v;b++)y[b]=~w.g[b];return new o(y,~w.h).add(d)}n.abs=function(){return T(this)?E(this):this},n.add=function(w){for(var v=Math.max(this.g.length,w.g.length),y=[],b=0,m=0;m<=v;m++){var C=b+(this.i(m)&65535)+(w.i(m)&65535),f=(C>>>16)+(this.i(m)>>>16)+(w.i(m)>>>16);b=f>>>16,C&=65535,f&=65535,y[m]=f<<16|C}return new o(y,y[y.length-1]&-2147483648?-1:0)};function L(w,v){return w.add(E(v))}n.j=function(w){if(_(this)||_(w))return h;if(T(this))return T(w)?E(this).j(E(w)):E(E(this).j(w));if(T(w))return E(this.j(E(w)));if(0>this.l(g)&&0>w.l(g))return l(this.m()*w.m());for(var v=this.g.length+w.g.length,y=[],b=0;b<2*v;b++)y[b]=0;for(b=0;b<this.g.length;b++)for(var m=0;m<w.g.length;m++){var C=this.i(b)>>>16,f=this.i(b)&65535,p=w.i(m)>>>16,F=w.i(m)&65535;y[2*b+2*m]+=f*F,x(y,2*b+2*m),y[2*b+2*m+1]+=C*F,x(y,2*b+2*m+1),y[2*b+2*m+1]+=f*p,x(y,2*b+2*m+1),y[2*b+2*m+2]+=C*p,x(y,2*b+2*m+2)}for(b=0;b<v;b++)y[b]=y[2*b+1]<<16|y[2*b];for(b=v;b<2*v;b++)y[b]=0;return new o(y,0)};function x(w,v){for(;(w[v]&65535)!=w[v];)w[v+1]+=w[v]>>>16,w[v]&=65535,v++}function V(w,v){this.g=w,this.h=v}function P(w,v){if(_(v))throw Error("division by zero");if(_(w))return new V(h,h);if(T(w))return v=P(E(w),v),new V(E(v.g),E(v.h));if(T(v))return v=P(w,E(v)),new V(E(v.g),v.h);if(30<w.g.length){if(T(w)||T(v))throw Error("slowDivide_ only works with positive integers.");for(var y=d,b=v;0>=b.l(w);)y=G(y),b=G(b);var m=K(y,1),C=K(b,1);for(b=K(b,2),y=K(y,2);!_(b);){var f=C.add(b);0>=f.l(w)&&(m=m.add(y),C=f),b=K(b,1),y=K(y,1)}return v=L(w,m.j(v)),new V(m,v)}for(m=h;0<=w.l(v);){for(y=Math.max(1,Math.floor(w.m()/v.m())),b=Math.ceil(Math.log(y)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),C=l(y),f=C.j(v);T(f)||0<f.l(w);)y-=b,C=l(y),f=C.j(v);_(C)&&(C=d),m=m.add(C),w=L(w,f)}return new V(m,w)}n.A=function(w){return P(this,w).h},n.and=function(w){for(var v=Math.max(this.g.length,w.g.length),y=[],b=0;b<v;b++)y[b]=this.i(b)&w.i(b);return new o(y,this.h&w.h)},n.or=function(w){for(var v=Math.max(this.g.length,w.g.length),y=[],b=0;b<v;b++)y[b]=this.i(b)|w.i(b);return new o(y,this.h|w.h)},n.xor=function(w){for(var v=Math.max(this.g.length,w.g.length),y=[],b=0;b<v;b++)y[b]=this.i(b)^w.i(b);return new o(y,this.h^w.h)};function G(w){for(var v=w.g.length+1,y=[],b=0;b<v;b++)y[b]=w.i(b)<<1|w.i(b-1)>>>31;return new o(y,w.h)}function K(w,v){var y=v>>5;v%=32;for(var b=w.g.length-y,m=[],C=0;C<b;C++)m[C]=0<v?w.i(C+y)>>>v|w.i(C+y+1)<<32-v:w.i(C+y);return new o(m,w.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,dl=ap.Md5=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=u,jr=ap.Integer=o}).apply(typeof op<"u"?op:typeof self<"u"?self:typeof window<"u"?window:{});var v1=el(kw(),1),Wb=el(ah(),1);var Rw="@firebase/firestore",Lw="4.7.3";var Lt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Lt.UNAUTHENTICATED=new Lt(null);Lt.GOOGLE_CREDENTIALS=new Lt("google-credentials-uid");Lt.FIRST_PARTY=new Lt("first-party-uid");Lt.MOCK_USER=new Lt("mock-user");var FV="10.14.0";var Oa=FV;function qV(n){Oa=n}function UV(n){return NV(n,{depth:100})}var Es=new Dc("@firebase/firestore");function na(){return Es.logLevel}function $b(n){Es.setLogLevel(n)}function B(n,...e){if(Es.logLevel<=Li.DEBUG){let t=e.map(qd);Es.debug(`Firestore (${Oa}): ${n}`,...t)}}function ft(n,...e){if(Es.logLevel<=Li.ERROR){let t=e.map(qd);Es.error(`Firestore (${Oa}): ${n}`,...t)}}function Ti(n,...e){if(Es.logLevel<=Li.WARN){let t=e.map(qd);Es.warn(`Firestore (${Oa}): ${n}`,...t)}}function qd(n){if(typeof n=="string")return n;try{return UV(n)}catch{return n}}function Y(n="Unexpected state"){let e=`FIRESTORE (${Oa}) INTERNAL ASSERTION FAILED: `+n;throw ft(e),new Error(e)}function ne(n,e){n||Y()}function Gb(n,e){n||Y()}function W(n,e){return n}var z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},N=class extends np{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var kt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var N6=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},q5=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Lt.UNAUTHENTICATED))}shutdown(){}},U5=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},j5=class{constructor(e){this.authProvider=e,this.currentUser=Lt.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){ne(this.tokenListener===void 0);let i=this.tokenCounter,r=c=>this.tokenCounter!==i?(i=this.tokenCounter,t(c)):Promise.resolve(),s=new kt;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new kt,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>S(this,null,function*(){yield c.promise,yield r(this.currentUser)}))},a=c=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),o())};this.authProvider.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.authProvider.getImmediate({optional:!0});c?a(c):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new kt)}},0),o()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.tokenCounter!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ne(typeof i.accessToken=="string"),new N6(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let e=this.auth&&this.auth.getUid();return ne(e===null||typeof e=="string"),new Lt(e)}},W5=class{constructor(e,t,i){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=i,this.type="FirstParty",this.user=Lt.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},$5=class{constructor(e,t,i){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=i}getToken(){return Promise.resolve(new W5(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(Lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},G5=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Y5=class{constructor(e){this.appCheckProvider=e,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(e,t){ne(this.tokenListener===void 0);let i=s=>{s.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?r(s):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ne(typeof t.token=="string"),this.latestAppCheckToken=t.token,new G5(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}};function jV(n){if(!n)return new q5;switch(n.type){case"firstParty":return new $5(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new N(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function WV(n){return BV(n)}var P6=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="",r=20;for(;i.length<r;){let s=WV(40);for(let o=0;o<s.length;++o)i.length<r&&s[o]<t&&(i+=e.charAt(s[o]%e.length))}return i}};function fe(n,e){return n<e?-1:n>e?1:0}function y1(n,e,t){return n.length!==e.length?!1:n.every((i,r)=>t(i,e[r]))}function Yb(n){return n+"\0"}var Vw=-62135596800,Nw=1e6,mt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new N(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new N(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Vw)throw new N(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new N(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-t*1e3)*Nw);return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return this.seconds*1e3+this.nanoseconds/Nw}_compareTo(e){return this.seconds===e.seconds?fe(this.nanoseconds,e.nanoseconds):fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-Vw,t=String(e).padStart(12,"0"),i=String(this.nanoseconds).padStart(9,"0");return t+"."+i}};var oe=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new mt(0,0))}static max(){return new n(new mt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return this.timestamp.seconds*1e6+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Pw="__name__",H6=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&Y(),i===void 0?i=e.length-t:i>e.length-t&&Y(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ze=class n extends H6{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new N(z.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},$V=/^[_a-zA-Z][_a-zA-Z0-9]*$/,xt=class n extends H6{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return $V.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Pw}static keyField(){return new n([Pw])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new N(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},o=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new N(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[r+1];if(!(c==="\\"||c==="."||c==="`"))throw new N(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else a==="`"?(o=!o,r++):a==="."&&!o?(s(),r++):(i+=a,r++)}if(s(),o)throw new N(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var j=class n{constructor(e){this.path=e}static fromPath(e){return new n(ze.fromString(e))}static fromName(e){return new n(ze.fromString(e).popFirst(5))}static empty(){return new n(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new n(new ze(e.slice()))}};var ha=-1,GV=0,K5=(()=>{class n{constructor(t,i,r,s){this.indexId=t,this.collectionGroup=i,this.fields=r,this.indexState=s}}return n.UNKNOWN_ID=-1,n})();function Ud(n){return n.fields.find(e=>e.kind===2)}function w1(n){return n.fields.filter(e=>e.kind!==2)}function YV(n){let e=w1(n);return e.length===0?0:e[e.length-1].kind}function KV(n){return`id=${n.indexId}|cg=${n.collectionGroup}|f=${n.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}var ca=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var n2=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(GV,ri.min())}};function Kb(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=oe.fromTimestamp(i===1e9?new mt(t+1,0):new mt(t,i));return new ri(r,j.empty(),e)}function Qb(n){return new ri(n.readTime,n.key,ha)}var ri=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(oe.min(),j.empty(),ha)}static max(){return new n(oe.max(),j.empty(),ha)}};function jd(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0||(t=j.comparator(n.documentKey,e.documentKey),t!==0)?t:fe(n.largestBatchId,e.largestBatchId)}var Xb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",B6=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Vs(n){return S(this,null,function*(){if(n.code===z.FAILED_PRECONDITION&&n.message===Xb)B("LocalStore","Unexpectedly lost primary lease");else throw n})}var M=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},c=>i(c))}),o=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(u=>{o[l]=u,++a,a===s&&i(o)},u=>r(u))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};var Nn="SimpleDb",QV=3,F6=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.completionDeferred=new kt,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{t.error?this.completionDeferred.reject(new g1(e,t.error)):this.completionDeferred.resolve()},this.transaction.onerror=i=>{let r=Wd(i.target.error);this.completionDeferred.reject(new g1(e,r))}}static open(e,t,i,r){try{return new n(t,e.transaction(r,i))}catch(s){throw new g1(t,s)}}get completionPromise(){return this.completionDeferred.promise}abort(e){e&&this.completionDeferred.reject(e),this.aborted||(B(Nn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let e=this.transaction;!this.aborted&&typeof e.commit=="function"&&e.commit()}store(e){let t=this.transaction.objectStore(e);return new X5(t)}},Ms=class n{constructor(e,t,i){this.name=e,this.version=t,this.schemaConverter=i,n.getIOSVersion(a4())===12.2&&ft("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return B(Nn,"Removing database:",e),l1(window.indexedDB.deleteDatabase(e)).toPromise()}static isAvailable(){if(!Ac())return!1;if(n.isMockPersistence())return!0;let e=a4(),t=n.getIOSVersion(e),i=0<t&&t<10,r=Zb(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static isMockPersistence(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.USE_MOCK_PERSISTENCE)==="YES"}static getStore(e,t){return e.store(t)}static getIOSVersion(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}ensureDb(e){return S(this,null,function*(){return this.db||(B(Nn,"Opening database:",this.name),this.db=yield new Promise((t,i)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{let o=s.target.result;t(o)},r.onblocked=()=>{i(new g1(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{let o=s.target.error;o.name==="VersionError"?i(new N(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new N(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new g1(e,o))},r.onupgradeneeded=s=>{B(Nn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.schemaConverter.createOrUpgrade(o,r.transaction,s.oldVersion,this.version).next(()=>{B(Nn,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=t=>this.versionchangelistener(t)),this.db})}setVersionChangeListener(e){this.versionchangelistener=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){return S(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.ensureDb(e);let a=F6.open(this.db,e,s?"readonly":"readwrite",i),c=r(a).next(l=>(a.maybeCommit(),l)).catch(l=>(a.abort(l),M.reject(l))).toPromise();return c.catch(()=>{}),yield a.completionPromise,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<QV;if(B(Nn,"Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function Zb(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var Q5=class{constructor(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(e){this.dbCursor=e}done(){this.shouldStop=!0}skip(e){this.nextKey=e}delete(){return l1(this.dbCursor.delete())}},g1=class extends N{constructor(e,t){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Ns(n){return n.name==="IndexedDbTransactionError"}var X5=class{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(B(Nn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(B(Nn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),l1(i)}add(e){B(Nn,"ADD",this.store.name,e,e);let t=this.store.add(e);return l1(t)}get(e){let t=this.store.get(e);return l1(t).next(i=>(i===void 0&&(i=null),B(Nn,"GET",this.store.name,e,i),i))}delete(e){B(Nn,"DELETE",this.store.name,e);let t=this.store.delete(e);return l1(t)}count(){B(Nn,"COUNT",this.store.name);let e=this.store.count();return l1(e)}loadAll(e,t){let i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){let s=r.getAll(i.range);return new M((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}else{let s=this.cursor(i),o=[];return this.iterateCursor(s,(a,c)=>{o.push(c)}).next(()=>o)}}loadFirst(e,t){let i=this.store.getAll(e,t===null?void 0:t);return new M((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}deleteAll(e,t){B(Nn,"DELETE ALL",this.store.name);let i=this.options(e,t);i.keysOnly=!1;let r=this.cursor(i);return this.iterateCursor(r,(s,o,a)=>a.delete())}iterate(e,t){let i;t?i=e:(i={},t=e);let r=this.cursor(i);return this.iterateCursor(r,t)}iterateSerial(e){let t=this.cursor({});return new M((i,r)=>{t.onerror=s=>{let o=Wd(s.target.error);r(o)},t.onsuccess=s=>{let o=s.target.result;if(!o){i();return}e(o.primaryKey,o.value).next(a=>{a?o.continue():i()})}})}iterateCursor(e,t){let i=[];return new M((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a){r();return}let c=new Q5(a),l=t(a.primaryKey,a.value,c);if(l instanceof M){let u=l.catch(h=>(c.done(),M.reject(h)));i.push(u)}c.isDone?r():c.skipToKey===null?a.continue():a.continue(c.skipToKey)}}).next(()=>M.waitFor(i))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let i=this.store.index(e.index);return e.keysOnly?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}else return this.store.openCursor(e.range,t)}};function l1(n){return new M((e,t)=>{n.onsuccess=i=>{let r=i.target.result;e(r)},n.onerror=i=>{let r=Wd(i.target.error);t(r)}})}var Hw=!1;function Wd(n){let e=Ms.getIOSVersion(a4());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let i=new N("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Hw||(Hw=!0,setTimeout(()=>{throw i},0)),i}}return n}var Q4="IndexBackfiller",XV=15*1e3,ZV=60*1e3,JV=50,Z5=class{constructor(e,t){this.asyncQueue=e,this.backfiller=t,this.task=null}start(){this.schedule(XV)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}schedule(e){B(Q4,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>S(this,null,function*(){this.task=null;try{let t=yield this.backfiller.backfill();B(Q4,`Documents written: ${t}`)}catch(t){Ns(t)?B(Q4,"Ignoring IndexedDB error during index backfill: ",t):yield Vs(t)}yield this.schedule(ZV)}))}},J5=class{constructor(e,t){this.localStore=e,this.persistence=t}backfill(){return S(this,arguments,function*(e=JV){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.writeIndexEntries(t,e))})}writeIndexEntries(e,t){let i=new Set,r=t,s=!0;return M.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o===null||i.has(o))s=!1;else return B(Q4,`Processing collection: ${o}`),this.writeEntriesForCollectionGroup(e,o,r).next(a=>{r-=a,i.add(o)})})).next(()=>t-r)}writeEntriesForCollectionGroup(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.getNewOffset(r,s)).next(a=>(B(Q4,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}getNewOffset(e,t){let i=e;return t.changes.forEach((r,s)=>{let o=Qb(s);jd(o,i)>0&&(i=o)}),new ri(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Pn=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.setPreviousValue(r),this.writeNewSequenceNumber=r=>i.writeSequenceNumber(r))}setPreviousValue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t}}n.INVALID=-1;return n})(),la="",e7="",Jb="",e_="";function dn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Bw(e)),e=eN(n.get(t),e);return Bw(e)}function eN(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let s=n.charAt(r);switch(s){case"\0":t+=la+Jb;break;case la:t+=la+e_;break;default:t+=s}}return t}function Bw(n){return n+la+e7}function Ji(n){let e=n.length;if(ne(e>=2),e===2)return ne(n.charAt(0)===la&&n.charAt(1)===e7),ze.emptyPath();let t=e-2,i=[],r="";for(let s=0;s<e;){let o=n.indexOf(la,s);switch((o<0||o>t)&&Y(),n.charAt(o+1)){case e7:let c=n.substring(s,o),l;r.length===0?l=c:(r+=c,l=r,r=""),i.push(l);break;case Jb:r+=n.substring(s,o),r+="\0";break;case e_:r+=n.substring(s,o+1);break;default:Y()}s=o+2}return new ze(i)}var u1="remoteDocuments";var M2="owner",Ko="owner",z2="mutationQueues",tN="userId",Si="mutations",t_="batchId",m1="userMutationsIndex",n_=["userId","batchId"];function nN(n){return[n]}function D6(n,e){return[n,dn(e)]}function i_(n,e,t){return[n,dn(e),t]}var iN={},Ia="documentMutations",I0="remoteDocumentsV14",rN=["prefixPath","collectionGroup","readTime","documentId"],k6="documentKeyIndex",sN=["prefixPath","collectionGroup","documentId"],r_="collectionGroupIndex",oN=["collectionGroup","readTime","prefixPath","documentId"],x2="remoteDocumentGlobal",t7="remoteDocumentGlobalKey",Aa="targets",aN="targetId",s_="queryTargetsIndex",cN=["canonicalId","targetId"],Da="targetDocuments",lN=["targetId","path"],$d="documentTargetsIndex",uN=["path","targetId"],q6="targetGlobalKey",D1="targetGlobal",i2="collectionParents",hN=["collectionId","parent"],da="clientMetadata",dN="clientId",A0="bundles",fN="bundleId",D0="namedQueries",mN="name",Gd="indexConfiguration",pN="indexId",n7="collectionGroupIndex",gN="collectionGroup",k0="indexState",vN=["indexId","uid"],o_="sequenceNumberIndex",yN=["uid","sequenceNumber"],R0="indexEntries",wN=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],a_="documentKeyIndex",bN=["indexId","uid","orderedDocumentKey"],L0="documentOverlays",_N=["userId","collectionPath","documentId"],i7="collectionPathOverlayIndex",CN=["userId","collectionPath","largestBatchId"],c_="collectionGroupOverlayIndex",SN=["userId","collectionGroup","largestBatchId"],Yd="globals",TN="name",EN=[z2,Si,Ia,u1,Aa,M2,D1,Da],MN=EN,zN=[...MN,da],xN=[...zN,x2],ON=[...xN,i2],l_=[...ON,A0,D0],IN=[...l_,L0],u_=[z2,Si,Ia,I0,Aa,M2,D1,Da,da,x2,i2,A0,D0,L0],h_=u_,Kd=[...h_,Gd,k0,R0],AN=Kd,DN=[...Kd,Yd];function kN(n){if(n===17)return DN;if(n===16)return AN;if(n===15)return Kd;if(n===14)return h_;if(n===13)return u_;if(n===12)return IN;if(n===11)return l_;Y()}var r2=class extends B6{constructor(e,t){super(),this.simpleDbTransaction=e,this.currentSequenceNumber=t}};function Ht(n,e){let t=W(n);return Ms.getStore(t.simpleDbTransaction,e)}function Fw(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function k1(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function d_(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var st=class n{constructor(e,t){this.comparator=e,this.root=t||X4.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,X4.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,X4.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oa(this.root,e,this.comparator,!1)}getReverseIterator(){return new oa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oa(this.root,e,this.comparator,!0)}},oa=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},X4=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,i,r,s,o){return new n(t??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this,o=r(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let t=this;return!t.left.isRed()&&!t.left.left.isRed()&&(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,i){let r,s=this;if(i(t,s.key)<0)!s.left.isEmpty()&&!s.left.isRed()&&!s.left.left.isRed()&&(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,i),null);else{if(s.left.isRed()&&(s=s.rotateRight()),!s.right.isEmpty()&&!s.right.isRed()&&!s.right.left.isRed()&&(s=s.moveRedRight()),i(t,s.key)===0){if(s.right.isEmpty())return n.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,i))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();let t=this.left.check();if(t!==this.right.check())throw Y();return t+(this.isRed()?0:1)}}return n.EMPTY=null,n.RED=!0,n.BLACK=!1,n})(),r7=class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(e,t,i,r,s){return this}insert(e,t,i){return new X4(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};X4.EMPTY=new r7;var Ke=class n{constructor(e){this.comparator=e,this.data=new st(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(t!==void 0?i=this.data.getIteratorFrom(t):i=this.data.getIterator();i.hasNext();){let r=i.getNext();if(!e(r.key))return}}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new U6(this.data.getIterator())}getIteratorFrom(e){return new U6(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},U6=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function RN(n,e,t,i,r){let s=n.getIterator(),o=e.getIterator(),a=Qo(s),c=Qo(o);for(;a||c;){let l=!1,u=!1;if(a&&c){let h=t(a,c);h<0?u=!0:h>0&&(l=!0)}else a!=null?u=!0:l=!0;l?(i(c),c=Qo(o)):u?(r(a),a=Qo(s)):(a=Qo(s),c=Qo(o))}}function Qo(n){return n.hasNext()?n.getNext():void 0}var Hn=class n{constructor(e){this.fields=e,e.sort(xt.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ke(xt.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return y1(this.fields,e.fields,(t,i)=>t.isEqual(i))}};function LN(n){return Buffer.from(n,"base64").toString("binary")}function VN(n){return Buffer.from(n,"binary").toString("base64")}function f_(){return!0}var Ot=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=LN(e);return new n(t)}static fromUint8Array(e){let t=NN(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return VN(this.binaryString)}toUint8Array(){return PN(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ot.EMPTY_BYTE_STRING=new Ot("");function NN(n){let e="";for(let t=0;t<n.length;++t)e+=String.fromCharCode(n[t]);return e}function PN(n){let e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}var HN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zr(n){if(ne(!!n),typeof n=="string"){let e=0,t=HN.exec(n);if(ne(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}else{let e=lt(n.seconds),t=lt(n.nanos);return{seconds:e,nanos:t}}}function lt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function zs(n){return typeof n=="string"?Ot.fromBase64String(n):Ot.fromUint8Array(n)}var m_="server_timestamp",p_="__type__",g_="__previous_value__",v_="__local_write_time__";function V0(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[p_])===null||t===void 0?void 0:t.stringValue)===m_}function BN(n,e){let t={fields:{[p_]:{stringValue:m_},[v_]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return e&&V0(e)&&(e=Qd(e)),e&&(t.fields[g_]=e),{mapValue:t}}function Qd(n){let e=n.mapValue.fields[g_];return V0(e)?Qd(e):e}function s2(n){let e=zr(n.mapValue.fields[v_].timestampValue);return new mt(e.seconds,e.nanos)}var s7=class{constructor(e,t,i,r,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},qw="(default)",xs=class n{constructor(e,t){this.projectId=e,this.database=t||qw}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===qw}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function FN(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new N(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xs(n.options.projectId,e)}var Ts=-1;function O2(n){return n==null}function o2(n){return n===0&&1/n===-1/0}function y_(n){return typeof n=="number"&&Number.isInteger(n)&&!o2(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Xd="__type__",w_="__max__",Cs={mapValue:{fields:{__type__:{stringValue:w_}}}},Zd="__vector__",fa="value",R6={nullValue:"NULL_VALUE"};function b1(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?V0(n)?4:__(n)?9007199254740991:N0(n)?10:11:Y()}function Ei(n,e){if(n===e)return!0;let t=b1(n),i=b1(e);if(t!==i)return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return s2(n).isEqual(s2(e));case 3:return qN(n,e);case 5:return n.stringValue===e.stringValue;case 6:return jN(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return UN(n,e);case 2:return WN(n,e);case 9:return y1(n.arrayValue.values||[],e.arrayValue.values||[],Ei);case 10:case 11:return $N(n,e);case 9007199254740991:return!0;default:return Y()}}function qN(n,e){if(typeof n.timestampValue=="string"&&typeof e.timestampValue=="string"&&n.timestampValue.length===e.timestampValue.length)return n.timestampValue===e.timestampValue;let t=zr(n.timestampValue),i=zr(e.timestampValue);return t.seconds===i.seconds&&t.nanos===i.nanos}function UN(n,e){return lt(n.geoPointValue.latitude)===lt(e.geoPointValue.latitude)&&lt(n.geoPointValue.longitude)===lt(e.geoPointValue.longitude)}function jN(n,e){return zs(n.bytesValue).isEqual(zs(e.bytesValue))}function WN(n,e){if("integerValue"in n&&"integerValue"in e)return lt(n.integerValue)===lt(e.integerValue);if("doubleValue"in n&&"doubleValue"in e){let t=lt(n.doubleValue),i=lt(e.doubleValue);return t===i?o2(t)===o2(i):isNaN(t)&&isNaN(i)}return!1}function $N(n,e){let t=n.mapValue.fields||{},i=e.mapValue.fields||{};if(Fw(t)!==Fw(i))return!1;for(let r in t)if(t.hasOwnProperty(r)&&(i[r]===void 0||!Ei(t[r],i[r])))return!1;return!0}function a2(n,e){return(n.values||[]).find(t=>Ei(t,e))!==void 0}function Os(n,e){if(n===e)return 0;let t=b1(n),i=b1(e);if(t!==i)return fe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return fe(n.booleanValue,e.booleanValue);case 2:return GN(n,e);case 3:return Uw(n.timestampValue,e.timestampValue);case 4:return Uw(s2(n),s2(e));case 5:return fe(n.stringValue,e.stringValue);case 6:return QN(n.bytesValue,e.bytesValue);case 7:return YN(n.referenceValue,e.referenceValue);case 8:return KN(n.geoPointValue,e.geoPointValue);case 9:return b_(n.arrayValue,e.arrayValue);case 10:return XN(n.mapValue,e.mapValue);case 11:return ZN(n.mapValue,e.mapValue);default:throw Y()}}function GN(n,e){let t=lt(n.integerValue||n.doubleValue),i=lt(e.integerValue||e.doubleValue);return t<i?-1:t>i?1:t===i?0:isNaN(t)?isNaN(i)?0:-1:1}function Uw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return fe(n,e);let t=zr(n),i=zr(e),r=fe(t.seconds,i.seconds);return r!==0?r:fe(t.nanos,i.nanos)}function YN(n,e){let t=n.split("/"),i=e.split("/");for(let r=0;r<t.length&&r<i.length;r++){let s=fe(t[r],i[r]);if(s!==0)return s}return fe(t.length,i.length)}function KN(n,e){let t=fe(lt(n.latitude),lt(e.latitude));return t!==0?t:fe(lt(n.longitude),lt(e.longitude))}function QN(n,e){let t=zs(n),i=zs(e);return t.compareTo(i)}function b_(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let s=Os(t[r],i[r]);if(s)return s}return fe(t.length,i.length)}function XN(n,e){var t,i,r,s;let o=n.fields||{},a=e.fields||{},c=(t=o[fa])===null||t===void 0?void 0:t.arrayValue,l=(i=a[fa])===null||i===void 0?void 0:i.arrayValue,u=fe(((r=c?.values)===null||r===void 0?void 0:r.length)||0,((s=l?.values)===null||s===void 0?void 0:s.length)||0);return u!==0?u:b_(c,l)}function ZN(n,e){if(n===Cs.mapValue&&e===Cs.mapValue)return 0;if(n===Cs.mapValue)return 1;if(e===Cs.mapValue)return-1;let t=n.fields||{},i=Object.keys(t),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let o=0;o<i.length&&o<s.length;++o){let a=fe(i[o],s[o]);if(a!==0)return a;let c=Os(t[i[o]],r[s[o]]);if(c!==0)return c}return fe(i.length,s.length)}function ma(n){return Jd(n)}function Jd(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?eP(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?JN(n.bytesValue):"referenceValue"in n?nP(n.referenceValue):"geoPointValue"in n?tP(n.geoPointValue):"arrayValue"in n?rP(n.arrayValue):"mapValue"in n?iP(n.mapValue):Y()}function JN(n){return zs(n).toBase64()}function eP(n){let e=zr(n);return`time(${e.seconds},${e.nanos})`}function tP(n){return`geo(${n.latitude},${n.longitude})`}function nP(n){return j.fromName(n).toString()}function iP(n){let e=Object.keys(n.fields||{}).sort(),t="{",i=!0;for(let r of e)i?i=!1:t+=",",t+=`${r}:${Jd(n.fields[r])}`;return t+"}"}function rP(n){let e="[",t=!0;for(let i of n.values||[])t?t=!1:e+=",",e+=Jd(i);return e+"]"}function _1(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function o7(n){return!!n&&"integerValue"in n}function sP(n){return!!n&&"doubleValue"in n}function oP(n){return o7(n)||sP(n)}function c2(n){return!!n&&"arrayValue"in n}function jw(n){return!!n&&"nullValue"in n}function Ww(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function L6(n){return!!n&&"mapValue"in n}function N0(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Xd])===null||t===void 0?void 0:t.stringValue)===Zd}function Z4(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return k1(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Z4(i)),e}else if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Z4(n.arrayValue.values[t]);return e}else return Object.assign({},n)}function __(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===w_}var C_={mapValue:{fields:{[Xd]:{stringValue:Zd},[fa]:{arrayValue:{}}}}};function aP(n){return"nullValue"in n?R6:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?_1(xs.empty(),j.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?N0(n)?C_:{mapValue:{}}:Y()}function cP(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?_1(xs.empty(),j.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?C_:"mapValue"in n?N0(n)?{mapValue:{}}:Cs:Y()}function $w(n,e){let t=Os(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Gw(n,e){let t=Os(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var rn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!L6(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){let i=this.getFieldsMap(e.popLast());i[e.lastSegment()]=Z4(t)}setAll(e){let t=xt.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Z4(o):r.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());L6(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ei(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];(!L6(r)||!r.mapValue.fields)&&(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){k1(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n(Z4(this.value))}};function S_(n){let e=[];return k1(n.fields,(t,i)=>{let r=new xt([t]);if(L6(i)){let o=S_(i.mapValue).fields;if(o.length===0)e.push(r);else for(let a of o)e.push(r.child(a))}else e.push(r)}),new Hn(e)}var Rt=class n{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,oe.min(),oe.min(),oe.min(),rn.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,oe.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,oe.min(),oe.min(),rn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,oe.min(),oe.min(),rn.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(oe.min())&&(this.documentType===2||this.documentType===0)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};function lP(n,e,t){let i=e.data.field(n),r=t.data.field(n);return i!==null&&r!==null?Os(i,r):Y()}var ir=class{constructor(e,t){this.position=e,this.inclusive=t}};function T_(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],o=n.position[r];if(s.field.isKeyField())i=j.comparator(j.fromName(o.referenceValue),t.key);else{let a=t.data.field(s.field);i=Os(o,a)}if(s.dir==="desc"&&(i=i*-1),i!==0)break}return i}function uP(n,e,t){let i=T_(n,e,t);return n.inclusive?i>=0:i>0}function hP(n,e,t){let i=T_(n,e,t);return n.inclusive?i<=0:i<0}function Yw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++){let i=n.position[t],r=e.position[t];if(!Ei(i,r))return!1}return!0}var C1=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function dP(n){return n.field.canonicalString()+n.dir}function fP(n){return`${n.field.canonicalString()} (${n.dir})`}function mP(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var j6=class{},_e=class n extends j6{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new l7(e,t,i):t==="array-contains"?new d7(e,i):t==="in"?new W6(e,i):t==="not-in"?new f7(e,i):t==="array-contains-any"?new m7(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new u7(e,i):new h7(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Os(t,this.value)):t!==null&&b1(this.value)===b1(t)&&this.matchesComparison(Os(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},qe=class n extends j6{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new n(e,t)}matches(e){return pa(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.memoizedFlattenedFilters!==null?this.memoizedFlattenedFilters:(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[]),this.memoizedFlattenedFilters)}getFilters(){return Object.assign([],this.filters)}};function pa(n){return n.op==="and"}function a7(n){return n.op==="or"}function ef(n){return E_(n)&&pa(n)}function E_(n){for(let e of n.filters)if(e instanceof qe)return!1;return!0}function c7(n){if(n instanceof _e)return n.field.canonicalString()+n.op.toString()+ma(n.value);if(ef(n))return n.filters.map(e=>c7(e)).join(",");{let e=n.filters.map(t=>c7(t)).join(",");return`${n.op}(${e})`}}function M_(n,e){if(n instanceof _e)return pP(n,e);if(n instanceof qe)return gP(n,e);Y()}function pP(n,e){return e instanceof _e&&n.op===e.op&&n.field.isEqual(e.field)&&Ei(n.value,e.value)}function gP(n,e){return e instanceof qe&&n.op===e.op&&n.filters.length===e.filters.length?n.filters.reduce((i,r,s)=>i&&M_(r,e.filters[s]),!0):!1}function z_(n,e){let t=n.filters.concat(e);return qe.create(t,n.op)}function x_(n){return n instanceof _e?yP(n):n instanceof qe?vP(n):"Filter"}function vP(n){return n.op.toString()+" {"+n.getFilters().map(x_).join(" ,")+"}"}function yP(n){return`${n.field.canonicalString()} ${n.op} ${ma(n.value)}`}var l7=class extends _e{constructor(e,t,i){super(e,t,i),this.key=j.fromName(i.referenceValue)}matches(e){let t=j.comparator(e.key,this.key);return this.matchesComparison(t)}},u7=class extends _e{constructor(e,t){super(e,"in",t),this.keys=O_("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},h7=class extends _e{constructor(e,t){super(e,"not-in",t),this.keys=O_("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function O_(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>j.fromName(i.referenceValue))}var d7=class extends _e{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return c2(t)&&a2(t.arrayValue,this.value)}},W6=class extends _e{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&a2(this.value.arrayValue,t)}},f7=class extends _e{constructor(e,t){super(e,"not-in",t)}matches(e){if(a2(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!a2(this.value.arrayValue,t)}},m7=class extends _e{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!c2(t)||!t.arrayValue.values?!1:t.arrayValue.values.some(i=>a2(this.value.arrayValue,i))}};var p7=class{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}};function g7(n,e=null,t=[],i=[],r=null,s=null,o=null){return new p7(n,e,t,i,r,s,o)}function S1(n){let e=W(n);if(e.memoizedCanonicalId===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>c7(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>dP(i)).join(","),O2(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>ma(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>ma(i)).join(",")),e.memoizedCanonicalId=t}return e.memoizedCanonicalId}function wP(n){let e=n.path.canonicalString();return n.collectionGroup!==null&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>x_(t)).join(", ")}]`),O2(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>fP(t)).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>ma(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>ma(t)).join(",")),`Target(${e})`}function I2(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!mP(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!M_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup!==e.collectionGroup||!n.path.isEqual(e.path)||!Yw(n.startAt,e.startAt)?!1:Yw(n.endAt,e.endAt)}function $6(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function P0(n,e){return n.filters.filter(t=>t instanceof _e&&t.field.isEqual(e))}function bP(n,e){let t=Ud(e);if(t===void 0)return null;for(let i of P0(n,t.fieldPath))switch(i.op){case"array-contains-any":return i.value.arrayValue.values||[];case"array-contains":return[i.value]}return null}function _P(n,e){let t=new Map;for(let i of w1(e))for(let r of P0(n,i.fieldPath))switch(r.op){case"==":case"in":t.set(i.fieldPath.canonicalString(),r.value);break;case"not-in":case"!=":return t.set(i.fieldPath.canonicalString(),r.value),Array.from(t.values())}return null}function CP(n,e){let t=[],i=!0;for(let r of w1(e)){let s=r.kind===0?I_(n,r.fieldPath,n.startAt):A_(n,r.fieldPath,n.startAt);t.push(s.value),i&&(i=s.inclusive)}return new ir(t,i)}function SP(n,e){let t=[],i=!0;for(let r of w1(e)){let s=r.kind===0?A_(n,r.fieldPath,n.endAt):I_(n,r.fieldPath,n.endAt);t.push(s.value),i&&(i=s.inclusive)}return new ir(t,i)}function I_(n,e,t){let i=R6,r=!0;for(let s of P0(n,e)){let o=R6,a=!0;switch(s.op){case"<":case"<=":o=aP(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=R6;break}$w({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let a=t.position[s];$w({value:i,inclusive:r},{value:a,inclusive:t.inclusive})<0&&(i=a,r=t.inclusive);break}}return{value:i,inclusive:r}}function A_(n,e,t){let i=Cs,r=!0;for(let s of P0(n,e)){let o=Cs,a=!0;switch(s.op){case">=":case">":o=cP(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Cs;break}Gw({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let a=t.position[s];Gw({value:i,inclusive:r},{value:a,inclusive:t.inclusive})>0&&(i=a,r=t.inclusive);break}}return{value:i,inclusive:r}}function TP(n){let e=new Ke(xt.comparator),t=!1;for(let i of n.filters)for(let r of i.getFlattenedFilters())r.field.isKeyField()||(r.op==="array-contains"||r.op==="array-contains-any"?t=!0:e=e.add(r.field));for(let i of n.orderBy)i.field.isKeyField()||(e=e.add(i.field));return e.size+(t?1:0)}function EP(n){return n.limit!==null}var Mi=class{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}};function D_(n,e,t,i,r,s,o,a){return new Mi(n,e,t,i,r,s,o,a)}function ka(n){return new Mi(n)}function MP(n,e){return new Mi(e,null,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Kw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function zP(n){let e=new Ke(xt.comparator);return n.filters.forEach(t=>{t.getFlattenedFilters().forEach(r=>{r.isInequality()&&(e=e.add(r.field))})}),e}function xP(n){return new Mi(ze.emptyPath(),n)}function OP(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function tf(n){return n.collectionGroup!==null}function ga(n){let e=W(n);if(e.memoizedNormalizedOrderBy===null){e.memoizedNormalizedOrderBy=[];let t=new Set;for(let s of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";zP(e).forEach(s=>{!t.has(s.canonicalString())&&!s.isKeyField()&&e.memoizedNormalizedOrderBy.push(new C1(s,i))}),t.has(xt.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new C1(xt.keyField(),i))}return e.memoizedNormalizedOrderBy}function fn(n){let e=W(n);return e.memoizedTarget||(e.memoizedTarget=IP(e,ga(n))),e.memoizedTarget}function IP(n,e){if(n.limitType==="F")return g7(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new C1(r.field,s)});let t=n.endAt?new ir(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new ir(n.startAt.position,n.startAt.inclusive):null;return g7(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function nf(n,e){let t=n.filters.concat([e]);return new Mi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function AP(n,e){let t=n.explicitOrderBy.concat([e]);return new Mi(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function G6(n,e,t){return new Mi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function DP(n,e){return new Mi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function kP(n,e){return new Mi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function A2(n,e){return I2(fn(n),fn(e))&&n.limitType===e.limitType}function k_(n){return`${S1(fn(n))}|lt:${n.limitType}`}function ia(n){return`Query(target=${wP(fn(n))}; limitType=${n.limitType})`}function D2(n,e){return e.isFoundDocument()&&RP(n,e)&&LP(n,e)&&VP(n,e)&&NP(n,e)}function RP(n,e){let t=e.key.path;return n.collectionGroup!==null?e.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(t):j.isDocumentKey(n.path)?n.path.isEqual(t):n.path.isImmediateParentOf(t)}function LP(n,e){for(let t of ga(n))if(!t.field.isKeyField()&&e.data.field(t.field)===null)return!1;return!0}function VP(n,e){for(let t of n.filters)if(!t.matches(e))return!1;return!0}function NP(n,e){return!(n.startAt&&!hP(n.startAt,ga(n),e)||n.endAt&&!uP(n.endAt,ga(n),e))}function R_(n){return n.collectionGroup||(n.path.length%2===1?n.path.lastSegment():n.path.get(n.path.length-2))}function L_(n){return(e,t)=>{let i=!1;for(let r of ga(n)){let s=PP(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function PP(n,e,t){let i=n.field.isKeyField()?j.comparator(e.key,t.key):lP(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Y()}}var rr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0){this.inner[i]=[[e,t]],this.innerSize++;return}for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e)){r[s]=[e,t];return}r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){k1(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return d_(this.inner)}size(){return this.innerSize}};var HP=new st(j.comparator);function On(){return HP}var V_=new st(j.comparator);function Y4(...n){let e=V_;for(let t of n)e=e.insert(t.key,t);return e}function BP(){return l2()}function N_(n){let e=V_;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function er(){return l2()}function P_(){return l2()}function l2(){return new rr(n=>n.toString(),(n,e)=>n.isEqual(e))}var FP=new st(j.comparator);function qP(){return FP}var UP=new Ke(j.comparator);function pe(...n){let e=UP;for(let t of n)e=e.add(t);return e}var jP=new Ke(fe);function rf(){return jP}function sf(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:o2(e)?"-0":e}}function H_(n){return{integerValue:""+n}}function B_(n,e){return y_(e)?H_(e):sf(n,e)}var va=class{constructor(){this._=void 0}};function WP(n,e,t){return n instanceof Is?BN(t,e):n instanceof xr?q_(n,e):n instanceof Or?U_(n,e):YP(n,e)}function $P(n,e,t){return n instanceof xr?q_(n,e):n instanceof Or?U_(n,e):t}function F_(n,e){return n instanceof As?oP(e)?e:{integerValue:0}:null}function GP(n,e){return n instanceof xr&&e instanceof xr||n instanceof Or&&e instanceof Or?y1(n.elements,e.elements,Ei):n instanceof As&&e instanceof As?Ei(n.operand,e.operand):n instanceof Is&&e instanceof Is}var Is=class extends va{},xr=class extends va{constructor(e){super(),this.elements=e}};function q_(n,e){let t=j_(e);for(let i of n.elements)t.some(r=>Ei(r,i))||t.push(i);return{arrayValue:{values:t}}}var Or=class extends va{constructor(e){super(),this.elements=e}};function U_(n,e){let t=j_(e);for(let i of n.elements)t=t.filter(r=>!Ei(r,i));return{arrayValue:{values:t}}}var As=class extends va{constructor(e,t){super(),this.serializer=e,this.operand=t}};function YP(n,e){let t=F_(n,e),i=Qw(t)+Qw(n.operand);return o7(t)&&o7(n.operand)?H_(i):sf(n.serializer,i)}function Qw(n){return lt(n.integerValue||n.doubleValue)}function j_(n){return c2(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var T1=class{constructor(e,t){this.field=e,this.transform=t}};function KP(n,e){return n.field.isEqual(e.field)&&GP(n.transform,e.transform)}function QP(n,e){return n===void 0&&e===void 0?!0:n&&e?y1(n,e,(t,i)=>KP(t,i)):!1}var v7=class{constructor(e,t){this.version=e,this.transformResults=t}},_t=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function H0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists!==void 0?n.exists===e.isFoundDocument():!0}var ya=class{};function W_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ks(n.key,_t.none()):new Ds(n.key,n.data,_t.none());{let t=n.data,i=rn.empty(),r=new Ke(xt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new zi(n.key,i,new Hn(r.toArray()),_t.none())}}function XP(n,e,t){n instanceof Ds?JP(n,e,t):n instanceof zi?tH(n,e,t):iH(n,e,t)}function J4(n,e,t,i){return n instanceof Ds?eH(n,e,t,i):n instanceof zi?nH(n,e,t,i):rH(n,e,t)}function ZP(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=F_(i.transform,r||null);s!=null&&(t===null&&(t=rn.empty()),t.set(i.field,s))}return t||null}function Xw(n,e){return n.type!==e.type||!n.key.isEqual(e.key)||!n.precondition.isEqual(e.precondition)||!QP(n.fieldTransforms,e.fieldTransforms)?!1:n.type===0?n.value.isEqual(e.value):n.type===1?n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask):!0}var Ds=class extends ya{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}};function JP(n,e,t){let i=n.value.clone(),r=G_(n.fieldTransforms,e,t.transformResults);i.setAll(r),e.convertToFoundDocument(t.version,i).setHasCommittedMutations()}function eH(n,e,t,i){if(!H0(n.precondition,e))return t;let r=n.value.clone(),s=Y_(n.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}var zi=class extends ya{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function tH(n,e,t){if(!H0(n.precondition,e)){e.convertToUnknownDocument(t.version);return}let i=G_(n.fieldTransforms,e,t.transformResults),r=e.data;r.setAll($_(n)),r.setAll(i),e.convertToFoundDocument(t.version,r).setHasCommittedMutations()}function nH(n,e,t,i){if(!H0(n.precondition,e))return t;let r=Y_(n.fieldTransforms,i,e),s=e.data;return s.setAll($_(n)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),t===null?null:t.unionWith(n.fieldMask.fields).unionWith(n.fieldTransforms.map(o=>o.field))}function $_(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function G_(n,e,t){let i=new Map;ne(n.length===t.length);for(let r=0;r<t.length;r++){let s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,$P(o,a,t[r]))}return i}function Y_(n,e,t){let i=new Map;for(let r of n){let s=r.transform,o=t.data.field(r.field);i.set(r.field,WP(s,o,e))}return i}var ks=class extends ya{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};function iH(n,e,t){e.convertToNoDocument(t.version).setHasCommittedMutations()}function rH(n,e,t){return H0(n.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):t}var u2=class extends ya{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var h2=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];if(s.key.isEqual(e.key)){let o=i[r];XP(s,e,o)}}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=J4(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=J4(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=P_();return this.mutations.forEach(r=>{let s=e.get(r.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;let c=W_(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(oe.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pe())}isEqual(e){return this.batchId===e.batchId&&y1(this.mutations,e.mutations,(t,i)=>Xw(t,i))&&y1(this.baseMutations,e.baseMutations,(t,i)=>Xw(t,i))}},y7=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){ne(e.mutations.length===i.length);let r=qP(),s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new n(e,t,i,r)}};var d2=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var w7=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var $t=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n}($t||{});function K_(n){switch(n){case z.OK:return Y();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return Y()}}function sH(n){return K_(n)&&n!==z.ABORTED}function V6(n){if(n===void 0)return ft("GRPC error has no .code"),z.UNKNOWN;switch(n){case $t.OK:return z.OK;case $t.CANCELLED:return z.CANCELLED;case $t.UNKNOWN:return z.UNKNOWN;case $t.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case $t.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case $t.INTERNAL:return z.INTERNAL;case $t.UNAVAILABLE:return z.UNAVAILABLE;case $t.UNAUTHENTICATED:return z.UNAUTHENTICATED;case $t.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case $t.NOT_FOUND:return z.NOT_FOUND;case $t.ALREADY_EXISTS:return z.ALREADY_EXISTS;case $t.PERMISSION_DENIED:return z.PERMISSION_DENIED;case $t.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case $t.ABORTED:return z.ABORTED;case $t.OUT_OF_RANGE:return z.OUT_OF_RANGE;case $t.UNIMPLEMENTED:return z.UNIMPLEMENTED;case $t.DATA_LOSS:return z.DATA_LOSS;default:return Y()}}var b7=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var A5=null;function Q_(){return new PV}function oH(){return new HV("utf-8")}var aH=new jr([4294967295,4294967295],0);function Zw(n){let e=Q_().encode(n),t=new dl;return t.update(e),new Uint8Array(t.digest())}function Jw(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0),o=new jr([t,i],0),a=new jr([r,s],0);return[o,a]}var _7=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new p1(`Invalid padding: ${t}`);if(i<0)throw new p1(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new p1(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new p1(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=e.length*8-t,this.bitCountInInteger=jr.fromNumber(this.bitCount)}getBitIndex(e,t,i){let r=e.add(t.multiply(jr.fromNumber(i)));return r.compare(aH)===1&&(r=new jr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){let t=this.bitmap[Math.floor(e/8)],i=e%8;return(t&1<<i)!==0}mightContain(e){if(this.bitCount===0)return!1;let t=Zw(e),[i,r]=Jw(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(i,r,s);if(!this.isBitSet(o))return!1}return!0}static create(e,t,i){let r=e%8===0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,r,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.bitCount===0)return;let t=Zw(e),[i,r]=Jw(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(i,r,s);this.setBit(o)}}setBit(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},p1=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var f2=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,m2.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(oe.min(),r,new st(fe),On(),pe())}},m2=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,pe(),pe(),pe())}};var ua=class{constructor(e,t,i,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=i,this.newDoc=r}},Y6=class{constructor(e,t){this.targetId=e,this.existenceFilter=t}},K6=class{constructor(e,t,i=Ot.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},Q6=class{constructor(){this.pendingResponses=0,this.documentChanges=tb(),this._resumeToken=Ot.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return this.pendingResponses!==0}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=pe(),t=pe(),i=pe();return this.documentChanges.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Y()}}),new m2(this._resumeToken,this._current,e,t,i)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=tb()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,ne(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}},cH="WatchChangeAggregator",C7=class{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=On(),this.pendingDocumentTargetMapping=eb(),this.pendingTargetResets=new st(fe)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let i=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&i.updateResumeToken(e.resumeToken);break;case 1:i.recordTargetResponse(),i.isPending||i.clearPendingChanges(),i.updateResumeToken(e.resumeToken);break;case 2:i.recordTargetResponse(),i.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(i.markCurrent(),i.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),i.updateResumeToken(e.resumeToken));break;default:Y()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((i,r)=>{this.isActiveTarget(r)&&t(r)})}handleExistenceFilter(e){let t=e.targetId,i=e.existenceFilter.count,r=this.targetDataForActiveTarget(t);if(r){let s=r.target;if($6(s))if(i===0){let o=new j(s.path);this.removeDocumentFromTarget(t,o,Rt.newNoDocument(o,oe.min()))}else ne(i===1);else{let o=this.getCurrentDocumentCountForTarget(t);if(o!==i){let a=this.parseBloomFilter(e),c=a?this.applyBloomFilter(a,e,o):1;if(c!==0){this.resetTarget(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,l)}A5?.notifyOnExistenceFilterMismatch(lH(o,e.existenceFilter,this.metadataProvider.getDatabaseId(),a,c))}}}}parseBloomFilter(e){let t=e.existenceFilter.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,o;try{o=zs(i).toUint8Array()}catch(c){if(c instanceof b7)return Ti("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}let a;try{a=new _7(o,r,s)}catch(c){return c instanceof p1?Ti("BloomFilter error: ",c):Ti("Applying bloom filter failed: ",c),null}return a.bitCount===0?null:a}applyBloomFilter(e,t,i){let r=t.existenceFilter.count,s=this.filterRemovedDocuments(e,t.targetId);return r===i-s?0:2}filterRemovedDocuments(e,t){let i=this.metadataProvider.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let o=this.metadataProvider.getDatabaseId(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.removeDocumentFromTarget(t,s,null),r++)}),r}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((s,o)=>{let a=this.targetDataForActiveTarget(o);if(a){if(s.current&&$6(a.target)){let c=new j(a.target.path);this.pendingDocumentUpdates.get(c)===null&&!this.targetContainsDocument(o,c)&&this.removeDocumentFromTarget(o,c,Rt.newNoDocument(c,e))}s.hasPendingChanges&&(t.set(o,s.toTargetChange()),s.clearPendingChanges())}});let i=pe();this.pendingDocumentTargetMapping.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.targetDataForActiveTarget(c);return l&&l.purpose!=="TargetPurposeLimboResolution"?(a=!1,!1):!0}),a&&(i=i.add(s))}),this.pendingDocumentUpdates.forEach((s,o)=>o.setReadTime(e));let r=new f2(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,i);return this.pendingDocumentUpdates=On(),this.pendingDocumentTargetMapping=eb(),this.pendingTargetResets=new st(fe),r}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let i=this.targetContainsDocument(e,t.key)?2:0;this.ensureTargetState(e).addDocumentChange(t.key,i),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,i){if(!this.isActiveTarget(e))return;let r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,1):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),i&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,i))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let i=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+i.addedDocuments.size-i.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new Q6,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new Ke(fe),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}isActiveTarget(e){let t=this.targetDataForActiveTarget(e)!==null;return t||B(cH,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new Q6),this.metadataProvider.getRemoteKeysForTarget(e).forEach(i=>{this.removeDocumentFromTarget(e,i,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}};function eb(){return new st(j.comparator)}function tb(){return new st(j.comparator)}function lH(n,e,t,i,r){var s,o,a,c,l,u;let h={localCacheCount:n,existenceFilterCount:e.count,databaseId:t.database,projectId:t.projectId},d=e.unchangedNames;return d&&(h.bloomFilter={applied:r===0,hashCount:(s=d?.hashCount)!==null&&s!==void 0?s:0,bitmapLength:(c=(a=(o=d?.bits)===null||o===void 0?void 0:o.bitmap)===null||a===void 0?void 0:a.length)!==null&&c!==void 0?c:0,padding:(u=(l=d?.bits)===null||l===void 0?void 0:l.padding)!==null&&u!==void 0?u:0,mightContain:g=>{var _;return(_=i?.mightContain(g))!==null&&_!==void 0?_:!1}}),h}var uH=(()=>{let n={};return n.asc="ASCENDING",n.desc="DESCENDING",n})(),hH=(()=>{let n={};return n["<"]="LESS_THAN",n["<="]="LESS_THAN_OR_EQUAL",n[">"]="GREATER_THAN",n[">="]="GREATER_THAN_OR_EQUAL",n["=="]="EQUAL",n["!="]="NOT_EQUAL",n["array-contains"]="ARRAY_CONTAINS",n.in="IN",n["not-in"]="NOT_IN",n["array-contains-any"]="ARRAY_CONTAINS_ANY",n})(),dH=(()=>{let n={};return n.and="AND",n.or="OR",n})();var S7=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function fH(n){let e=n.code===void 0?z.UNKNOWN:V6(n.code);return new N(e,n.message||"")}function T7(n,e){return n.useProto3Json||O2(e)?e:{value:e}}function mH(n){let e;return typeof n=="object"?e=n.value:e=n,O2(e)?null:e}function wa(n,e){if(n.useProto3Json){let i=new Date(e.seconds*1e3).toISOString().replace(/\.\d*/,"").replace("Z",""),r=("000000000"+e.nanoseconds).slice(-9);return`${i}.${r}Z`}else return{seconds:""+e.seconds,nanos:e.nanoseconds}}function pH(n){let e=zr(n);return new mt(e.seconds,e.nanos)}function X_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function gH(n,e){return n.useProto3Json?(ne(e===void 0||typeof e=="string"),Ot.fromBase64String(e||"")):(ne(e===void 0||e instanceof Buffer||e instanceof Uint8Array),Ot.fromUint8Array(e||new Uint8Array))}function vH(n,e){return wa(n,e.toTimestamp())}function zt(n){return ne(!!n),oe.fromTimestamp(pH(n))}function of(n,e){return E7(n,e).canonicalString()}function E7(n,e){let t=yH(n).child("documents");return e===void 0?t:t.child(e)}function Z_(n){let e=ze.fromString(n);return ne(cC(e)),e}function p2(n,e){return of(n.databaseId,e.path)}function tr(n,e){let t=Z_(e);if(t.get(1)!==n.databaseId.projectId)throw new N(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new N(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new j(tC(t))}function J_(n,e){return of(n.databaseId,e)}function eC(n){let e=Z_(n);return e.length===4?ze.emptyPath():tC(e)}function M7(n){return new ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yH(n){return new ze(["projects",n.projectId,"databases",n.database])}function tC(n){return ne(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function nb(n,e,t){return{name:p2(n,e),fields:t.value.mapValue.fields}}function wH(n,e){return{name:p2(n,e.key),fields:e.data.value.mapValue.fields,updateTime:wa(n,e.version.toTimestamp()),createTime:wa(n,e.createTime.toTimestamp())}}function nC(n,e,t){let i=tr(n,e.name),r=zt(e.updateTime),s=e.createTime?zt(e.createTime):oe.min(),o=new rn({mapValue:{fields:e.fields}}),a=Rt.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function bH(n,e){ne(!!e.found),e.found.name,e.found.updateTime;let t=tr(n,e.found.name),i=zt(e.found.updateTime),r=e.found.createTime?zt(e.found.createTime):oe.min(),s=new rn({mapValue:{fields:e.found.fields}});return Rt.newFoundDocument(t,i,r,s)}function _H(n,e){ne(!!e.missing),ne(!!e.readTime);let t=tr(n,e.missing),i=zt(e.readTime);return Rt.newNoDocument(t,i)}function CH(n,e){return"found"in e?bH(n,e):"missing"in e?_H(n,e):Y()}function SH(n,e){let t;if("targetChange"in e){e.targetChange;let i=TH(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=gH(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&fH(o);t=new K6(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=tr(n,i.document.name),s=zt(i.document.updateTime),o=i.document.createTime?zt(i.document.createTime):oe.min(),a=new rn({mapValue:{fields:i.document.fields}}),c=Rt.newFoundDocument(r,s,o,a),l=i.targetIds||[],u=i.removedTargetIds||[];t=new ua(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=tr(n,i.document),s=i.readTime?zt(i.readTime):oe.min(),o=Rt.newNoDocument(r,s),a=i.removedTargetIds||[];t=new ua([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=tr(n,i.document),s=i.removedTargetIds||[];t=new ua([],s,r,null)}else if("filter"in e){e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,o=new w7(r,s),a=i.targetId;t=new Y6(a,o)}else return Y();return t}function TH(n){return n==="NO_CHANGE"?0:n==="ADD"?1:n==="REMOVE"?2:n==="CURRENT"?3:n==="RESET"?4:Y()}function EH(n){if(!("targetChange"in n))return oe.min();let e=n.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?oe.min():zt(e.readTime)}function g2(n,e){let t;if(e instanceof Ds)t={update:nb(n,e.key,e.value)};else if(e instanceof ks)t={delete:p2(n,e.key)};else if(e instanceof zi)t={update:nb(n,e.key,e.data),updateMask:rB(e.fieldMask)};else if(e instanceof u2)t={verify:p2(n,e.key)};else return Y();return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>IH(n,i))),e.precondition.isNone||(t.currentDocument=MH(n,e.precondition)),t}function z7(n,e){let t=e.currentDocument?zH(e.currentDocument):_t.none(),i=e.updateTransforms?e.updateTransforms.map(r=>AH(n,r)):[];if(e.update){e.update.name;let r=tr(n,e.update.name),s=new rn({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=sB(e.updateMask);return new zi(r,s,o,t,i)}else return new Ds(r,s,t,i)}else if(e.delete){let r=tr(n,e.delete);return new ks(r,t)}else if(e.verify){let r=tr(n,e.verify);return new u2(r,t)}else return Y()}function MH(n,e){return e.updateTime!==void 0?{updateTime:vH(n,e.updateTime)}:e.exists!==void 0?{exists:e.exists}:Y()}function zH(n){return n.updateTime!==void 0?_t.updateTime(zt(n.updateTime)):n.exists!==void 0?_t.exists(n.exists):_t.none()}function xH(n,e){let t=n.updateTime?zt(n.updateTime):zt(e);return t.isEqual(oe.min())&&(t=zt(e)),new v7(t,n.transformResults||[])}function OH(n,e){return n&&n.length>0?(ne(e!==void 0),n.map(t=>xH(t,e))):[]}function IH(n,e){let t=e.transform;if(t instanceof Is)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof xr)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof Or)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof As)return{fieldPath:e.field.canonicalString(),increment:t.operand};throw Y()}function AH(n,e){let t=null;if("setToServerValue"in e)ne(e.setToServerValue==="REQUEST_TIME"),t=new Is;else if("appendMissingElements"in e){let r=e.appendMissingElements.values||[];t=new xr(r)}else if("removeAllFromArray"in e){let r=e.removeAllFromArray.values||[];t=new Or(r)}else"increment"in e?t=new As(n,e.increment):Y();let i=xt.fromServerFormat(e.fieldPath);return new T1(i,t)}function iC(n,e){return{documents:[J_(n,e.path)]}}function DH(n){let e=n.documents.length;ne(e===1);let t=n.documents[0];return fn(ka(eC(t)))}function rC(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=J_(n,r);let s=NH(e.filters);s&&(t.structuredQuery.where=s);let o=HH(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=T7(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=FH(e.startAt)),e.endAt&&(t.structuredQuery.endAt=qH(e.endAt)),{queryTarget:t,parent:r}}function sC(n){let e=eC(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){ne(i===1);let u=t.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=PH(t.where));let o=[];t.orderBy&&(o=BH(t.orderBy));let a=null;t.limit&&(a=mH(t.limit));let c=null;t.startAt&&(c=UH(t.startAt));let l=null;return t.endAt&&(l=jH(t.endAt)),D_(e,r,o,s,a,"F",c,l)}function kH(n){return fn(sC(n))}function RH(n,e){let t=LH(e.purpose);return t==null?null:{"goog-listen-tags":t}}function LH(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y()}}function VH(n,e){let t,i=e.target;if($6(i)?t={documents:iC(n,i)}:t={query:rC(n,i).queryTarget},t.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){t.resumeToken=X_(n,e.resumeToken);let r=T7(n,e.expectedCount);r!==null&&(t.expectedCount=r)}else if(e.snapshotVersion.compareTo(oe.min())>0){t.readTime=wa(n,e.snapshotVersion.toTimestamp());let r=T7(n,e.expectedCount);r!==null&&(t.expectedCount=r)}return t}function NH(n){if(n.length!==0)return aC(qe.create(n,"and"))}function PH(n){let e=oC(n);return e instanceof qe&&ef(e)?e.getFilters():[e]}function oC(n){return n.unaryFilter!==void 0?tB(n):n.fieldFilter!==void 0?nB(n):n.compositeFilter!==void 0?iB(n):Y()}function HH(n){if(n.length!==0)return n.map(e=>XH(e))}function BH(n){return n.map(e=>ZH(e))}function FH(n){return{before:n.inclusive,values:n.position}}function qH(n){return{before:!n.inclusive,values:n.position}}function UH(n){let e=!!n.before,t=n.values||[];return new ir(t,e)}function jH(n){let e=!n.before,t=n.values||[];return new ir(t,e)}function WH(n){return uH[n]}function $H(n){switch(n){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function GH(n){return hH[n]}function YH(n){return dH[n]}function KH(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Y();default:return Y()}}function QH(n){switch(n){case"AND":return"and";case"OR":return"or";default:return Y()}}function ra(n){return{fieldPath:n.canonicalString()}}function aa(n){return xt.fromServerFormat(n.fieldPath)}function XH(n){return{field:ra(n.field),direction:WH(n.dir)}}function ZH(n){return new C1(aa(n.field),$H(n.direction))}function aC(n){return n instanceof _e?eB(n):n instanceof qe?JH(n):Y()}function JH(n){let e=n.getFilters().map(t=>aC(t));return e.length===1?e[0]:{compositeFilter:{op:YH(n.op),filters:e}}}function eB(n){if(n.op==="=="){if(Ww(n.value))return{unaryFilter:{field:ra(n.field),op:"IS_NAN"}};if(jw(n.value))return{unaryFilter:{field:ra(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ww(n.value))return{unaryFilter:{field:ra(n.field),op:"IS_NOT_NAN"}};if(jw(n.value))return{unaryFilter:{field:ra(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ra(n.field),op:GH(n.op),value:n.value}}}function tB(n){switch(n.unaryFilter.op){case"IS_NAN":let e=aa(n.unaryFilter.field);return _e.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=aa(n.unaryFilter.field);return _e.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let i=aa(n.unaryFilter.field);return _e.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let r=aa(n.unaryFilter.field);return _e.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Y();default:return Y()}}function nB(n){return _e.create(aa(n.fieldFilter.field),KH(n.fieldFilter.op),n.fieldFilter.value)}function iB(n){return qe.create(n.compositeFilter.filters.map(e=>oC(e)),QH(n.compositeFilter.op))}function rB(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function sB(n){let e=n.fieldPaths||[];return new Hn(e.map(t=>xt.fromServerFormat(t)))}function cC(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ba=class n{constructor(e,t,i,r,s=oe.min(),o=oe.min(),a=Ot.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var X6=class{constructor(e){this.remoteSerializer=e}};function oB(n,e){let t;if(e.document)t=nC(n.remoteSerializer,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let i=j.fromSegments(e.noDocument.path),r=M1(e.noDocument.readTime);t=Rt.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else if(e.unknownDocument){let i=j.fromSegments(e.unknownDocument.path),r=M1(e.unknownDocument.version);t=Rt.newUnknownDocument(i,r)}else return Y();return e.readTime&&t.setReadTime(aB(e.readTime)),t}function ib(n,e){let t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:B0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=wH(n.remoteSerializer,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:E1(e.version)};else if(e.isUnknownDocument())i.unknownDocument={path:t.path.toArray(),version:E1(e.version)};else return Y();return i}function B0(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function aB(n){let e=new mt(n[0],n[1]);return oe.fromTimestamp(e)}function E1(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function M1(n){let e=new mt(n.seconds,n.nanoseconds);return oe.fromTimestamp(e)}function cB(n,e,t){let i=t.baseMutations.map(s=>g2(n.remoteSerializer,s)),r=t.mutations.map(s=>g2(n.remoteSerializer,s));return{userId:e,batchId:t.batchId,localWriteTimeMs:t.localWriteTime.toMillis(),baseMutations:i,mutations:r}}function h1(n,e){let t=(e.baseMutations||[]).map(s=>z7(n.remoteSerializer,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let c=e.mutations[s+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let i=e.mutations.map(s=>z7(n.remoteSerializer,s)),r=mt.fromMillis(e.localWriteTimeMs);return new h2(e.batchId,r,t,i)}function K4(n){let e=M1(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?M1(n.lastLimboFreeSnapshotVersion):oe.min(),i;return lB(n.query)?i=DH(n.query):i=kH(n.query),new ba(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ot.fromBase64String(n.resumeToken))}function lC(n,e){let t=E1(e.snapshotVersion),i=E1(e.lastLimboFreeSnapshotVersion),r;$6(e.target)?r=iC(n.remoteSerializer,e.target):r=rC(n.remoteSerializer,e.target).queryTarget;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:S1(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function lB(n){return n.documents!==void 0}function uB(n){return{id:n.bundleId,createTime:M1(n.createTime),version:n.version}}function hB(n){return{bundleId:n.id,createTime:E1(zt(n.createTime)),version:n.version}}function dB(n){return{name:n.name,query:af(n.bundledQuery),readTime:M1(n.readTime)}}function fB(n){return{name:n.name,readTime:E1(zt(n.readTime)),bundledQuery:n.bundledQuery}}function af(n){let e=sC({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?G6(e,e.limit,"L"):e}function mB(n){return{name:n.name,query:af(n.bundledQuery),readTime:zt(n.readTime)}}function pB(n){return{id:n.id,version:n.version,createTime:zt(n.createTime)}}function D5(n,e){return new d2(e.largestBatchId,z7(n.remoteSerializer,e.overlayMutation))}function gB(n,e,t){let[i,r,s]=uC(e,t.mutation.key);return{userId:e,collectionPath:r,documentId:s,collectionGroup:t.mutation.key.getCollectionGroup(),largestBatchId:t.largestBatchId,overlayMutation:g2(n.remoteSerializer,t.mutation)}}function uC(n,e){let t=e.path.lastSegment(),i=dn(e.path.popLast());return[n,i,t]}function vB(n){return{indexId:n.indexId,collectionGroup:n.collectionGroup,fields:n.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}function yB(n,e){let t=e?new n2(e.sequenceNumber,new ri(M1(e.readTime),new j(Ji(e.documentKey)),e.largestBatchId)):n2.empty(),i=n.fields.map(([r,s])=>new ca(xt.fromServerFormat(r),s));return new K5(n.indexId,n.collectionGroup,i,t)}function rb(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:E1(i.readTime),documentKey:dn(i.documentKey.path),largestBatchId:i.largestBatchId}}var x7=class{getBundleMetadata(e,t){return sb(e).get(t).next(i=>{if(i)return uB(i)})}saveBundleMetadata(e,t){return sb(e).put(hB(t))}getNamedQuery(e,t){return ob(e).get(t).next(i=>{if(i)return dB(i)})}saveNamedQuery(e,t){return ob(e).put(fB(t))}};function sb(n){return Ht(n,A0)}function ob(n){return Ht(n,D0)}var Z6=class n{constructor(e,t){this.serializer=e,this.userId=t}static forUser(e,t){let i=t.uid||"";return new n(e,i)}getOverlay(e,t){return j4(e).get(uC(this.userId,t)).next(i=>i?D5(this.serializer,i):null)}getOverlays(e,t){let i=er();return M.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){let r=[];return i.forEach((s,o)=>{let a=new d2(t,o);r.push(this.saveOverlay(e,a))}),M.waitFor(r)}removeOverlaysForBatchId(e,t,i){let r=new Set;t.forEach(o=>r.add(dn(o.getCollectionPath())));let s=[];return r.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(j4(e).deleteAll(i7,a))}),M.waitFor(s)}getOverlaysForCollection(e,t,i){let r=er(),s=dn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return j4(e).loadAll(i7,o).next(a=>{for(let c of a){let l=D5(this.serializer,c);r.set(l.getKey(),l)}return r})}getOverlaysForCollectionGroup(e,t,i,r){let s=er(),o,a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return j4(e).iterate({index:c_,range:a},(c,l,u)=>{let h=D5(this.serializer,l);s.size()<r||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>s)}saveOverlay(e,t){return j4(e).put(gB(this.serializer,this.userId,t))}};function j4(n){return Ht(n,L0)}var O7=class{globalsStore(e){return Ht(e,Yd)}getSessionToken(e){return this.globalsStore(e).get("sessionToken").next(i=>{let r=i?.value;return r?Ot.fromUint8Array(r):Ot.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.globalsStore(e).put({name:"sessionToken",value:t.toUint8Array()})}};var wB=5,bB=10,_B=13,k5=15,CB=20,SB=25,TB=30,EB=37,MB=45,zB=50,xB=53,OB=55,IB=60,AB=2,Mr=class{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,wB);else if("booleanValue"in e)this.writeValueTypeLabel(t,bB),t.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(t,k5),t.writeNumber(lt(e.integerValue));else if("doubleValue"in e){let i=lt(e.doubleValue);isNaN(i)?this.writeValueTypeLabel(t,_B):(this.writeValueTypeLabel(t,k5),o2(i)?t.writeNumber(0):t.writeNumber(i))}else if("timestampValue"in e){let i=e.timestampValue;this.writeValueTypeLabel(t,CB),typeof i=="string"&&(i=zr(i)),t.writeString(`${i.seconds||""}`),t.writeNumber(i.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,TB),t.writeBytes(zs(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.writeValueTypeLabel(t,MB),t.writeNumber(i.latitude||0),t.writeNumber(i.longitude||0)}else"mapValue"in e?__(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):N0(e)?this.writeIndexVector(e.mapValue,t):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):Y()}writeIndexString(e,t){this.writeValueTypeLabel(t,SB),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let i=e.fields||{};this.writeValueTypeLabel(t,OB);for(let r of Object.keys(i))this.writeIndexString(r,t),this.writeIndexValueAux(i[r],t)}writeIndexVector(e,t){var i,r;let s=e.fields||{};this.writeValueTypeLabel(t,xB);let o=fa,a=((r=(i=s[o].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.writeValueTypeLabel(t,k5),t.writeNumber(lt(a)),this.writeIndexString(o,t),this.writeIndexValueAux(s[o],t)}writeIndexArray(e,t){let i=e.values||[];this.writeValueTypeLabel(t,zB);for(let r of i)this.writeIndexValueAux(r,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,EB),j.fromName(e).path.forEach(r=>{this.writeValueTypeLabel(t,IB),this.writeUnlabeledIndexString(r,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(AB)}};Mr.INSTANCE=new Mr;var ab="\uD800",cb="\uDBFF",Xo=0,lb=255,ub=1,Zo=255,hb=255,db=0,DB=64,kB=8,RB=1024;function LB(n){let e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,!1),new Uint8Array(e.buffer)}function VB(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n=n<<4),n>>6||(e+=2,n=n<<2),n>>7||(e+=1),e}function NB(n){let e=0;for(let t=0;t<8;++t){let i=VB(n[t]&255);if(e+=i,i!==8)break}return e}function fb(n){let e=DB-NB(n);return Math.ceil(e/kB)}var I7=class{constructor(){this.buffer=new Uint8Array(RB),this.position=0}writeBytesAscending(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.writeByteAscending(i.value),i=t.next();this.writeSeparatorAscending()}writeBytesDescending(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.writeByteDescending(i.value),i=t.next();this.writeSeparatorDescending()}writeUtf8Ascending(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.writeByteAscending(i);else if(i<2048)this.writeByteAscending(960|i>>>6),this.writeByteAscending(128|63&i);else if(t<ab||cb<t)this.writeByteAscending(480|i>>>12),this.writeByteAscending(128|63&i>>>6),this.writeByteAscending(128|63&i);else{let r=t.codePointAt(0);this.writeByteAscending(240|r>>>18),this.writeByteAscending(128|63&r>>>12),this.writeByteAscending(128|63&r>>>6),this.writeByteAscending(128|63&r)}}this.writeSeparatorAscending()}writeUtf8Descending(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.writeByteDescending(i);else if(i<2048)this.writeByteDescending(960|i>>>6),this.writeByteDescending(128|63&i);else if(t<ab||cb<t)this.writeByteDescending(480|i>>>12),this.writeByteDescending(128|63&i>>>6),this.writeByteDescending(128|63&i);else{let r=t.codePointAt(0);this.writeByteDescending(240|r>>>18),this.writeByteDescending(128|63&r>>>12),this.writeByteDescending(128|63&r>>>6),this.writeByteDescending(128|63&r)}}this.writeSeparatorDescending()}writeNumberAscending(e){let t=this.toOrderedBits(e),i=fb(t);this.ensureAvailable(1+i),this.buffer[this.position++]=i&255;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=t[r]&255}writeNumberDescending(e){let t=this.toOrderedBits(e),i=fb(t);this.ensureAvailable(1+i),this.buffer[this.position++]=~(i&255);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(t[r]&255)}writeInfinityAscending(){this.writeEscapedByteAscending(Zo),this.writeEscapedByteAscending(hb)}writeInfinityDescending(){this.writeEscapedByteDescending(Zo),this.writeEscapedByteDescending(hb)}reset(){this.position=0}seed(e){this.ensureAvailable(e.length),this.buffer.set(e,this.position),this.position+=e.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(e){let t=LB(e),i=(t[0]&128)!==0;t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}writeByteAscending(e){let t=e&255;t===Xo?(this.writeEscapedByteAscending(Xo),this.writeEscapedByteAscending(lb)):t===Zo?(this.writeEscapedByteAscending(Zo),this.writeEscapedByteAscending(db)):this.writeEscapedByteAscending(t)}writeByteDescending(e){let t=e&255;t===Xo?(this.writeEscapedByteDescending(Xo),this.writeEscapedByteDescending(lb)):t===Zo?(this.writeEscapedByteDescending(Zo),this.writeEscapedByteDescending(db)):this.writeEscapedByteDescending(e)}writeSeparatorAscending(){this.writeEscapedByteAscending(Xo),this.writeEscapedByteAscending(ub)}writeSeparatorDescending(){this.writeEscapedByteDescending(Xo),this.writeEscapedByteDescending(ub)}writeEscapedByteAscending(e){this.ensureAvailable(1),this.buffer[this.position++]=e}writeEscapedByteDescending(e){this.ensureAvailable(1),this.buffer[this.position++]=~e}ensureAvailable(e){let t=e+this.position;if(t<=this.buffer.length)return;let i=this.buffer.length*2;i<t&&(i=t);let r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}},A7=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesAscending(e)}writeString(e){this.orderedCode.writeUtf8Ascending(e)}writeNumber(e){this.orderedCode.writeNumberAscending(e)}writeInfinity(){this.orderedCode.writeInfinityAscending()}},D7=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesDescending(e)}writeString(e){this.orderedCode.writeUtf8Descending(e)}writeNumber(e){this.orderedCode.writeNumberDescending(e)}writeInfinity(){this.orderedCode.writeInfinityDescending()}},d1=class{constructor(){this.orderedCode=new I7,this.ascending=new A7(this.orderedCode),this.descending=new D7(this.orderedCode)}seed(e){this.orderedCode.seed(e)}forKind(e){return e===0?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}};var f1=class n{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}successor(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new n(this.indexId,this.documentKey,this.arrayValue,i)}};function ys(n,e){let t=n.indexId-e.indexId;return t!==0||(t=mb(n.arrayValue,e.arrayValue),t!==0)||(t=mb(n.directionalValue,e.directionalValue),t!==0)?t:j.comparator(n.documentKey,e.documentKey)}function mb(n,e){for(let t=0;t<n.length&&t<e.length;++t){let i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}var J6=class{constructor(e){this.inequalityFilters=new Ke((t,i)=>xt.comparator(t.field,i.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.orderBys=e.orderBy,this.equalityFilters=[];for(let t of e.filters){let i=t;i.isInequality()?this.inequalityFilters=this.inequalityFilters.add(i):this.equalityFilters.push(i)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(e){if(ne(e.collectionGroup===this.collectionId),this.hasMultipleInequality)return!1;let t=Ud(e);if(t!==void 0&&!this.hasMatchingEqualityFilter(t))return!1;let i=w1(e),r=new Set,s=0,o=0;for(;s<i.length&&this.hasMatchingEqualityFilter(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.inequalityFilters.size>0){let a=this.inequalityFilters.getIterator().getNext();if(!r.has(a.field.canonicalString())){let c=i[s];if(!this.matchesFilter(a,c)||!this.matchesOrderBy(this.orderBys[o++],c))return!1}++s}for(;s<i.length;++s){let a=i[s];if(o>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[o++],a))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let e=new Ke(xt.comparator),t=[];for(let i of this.equalityFilters){if(i.field.isKeyField())continue;if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new ca(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new ca(i.field,0))}}for(let i of this.orderBys)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new ca(i.field,i.dir==="asc"?0:1)));return new K5(K5.UNKNOWN_ID,this.collectionId,t,n2.empty())}hasMatchingEqualityFilter(e){for(let t of this.equalityFilters)if(this.matchesFilter(t,e))return!0;return!1}matchesFilter(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}matchesOrderBy(e,t){return e.field.isEqual(t.fieldPath)?t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc":!1}};function hC(n){var e,t;if(ne(n instanceof _e||n instanceof qe),n instanceof _e)if(n instanceof W6){let r=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>_e.create(n.field,"==",s)))||[];return qe.create(r,"or")}else return n;let i=n.filters.map(r=>hC(r));return qe.create(i,n.op)}function PB(n){if(n.getFilters().length===0)return[];let e=k7(hC(n));return ne(dC(e)),cf(e)||lf(e)?[e]:e.getFilters()}function cf(n){return n instanceof _e}function lf(n){return n instanceof qe&&ef(n)}function dC(n){return cf(n)||lf(n)||HB(n)}function HB(n){if(n instanceof qe&&a7(n)){for(let e of n.getFilters())if(!cf(e)&&!lf(e))return!1;return!0}return!1}function k7(n){if(ne(n instanceof _e||n instanceof qe),n instanceof _e)return n;if(n.filters.length===1)return k7(n.filters[0]);let e=n.filters.map(i=>k7(i)),t=qe.create(e,n.op);return t=e0(t),dC(t)?t:(ne(t instanceof qe),ne(pa(t)),ne(t.filters.length>1),t.filters.reduce((i,r)=>uf(i,r)))}function uf(n,e){ne(n instanceof _e||n instanceof qe),ne(e instanceof _e||e instanceof qe);let t;return n instanceof _e?e instanceof _e?t=BB(n,e):t=pb(n,e):e instanceof _e?t=pb(e,n):t=FB(n,e),e0(t)}function BB(n,e){return qe.create([n,e],"and")}function FB(n,e){if(ne(n.filters.length>0&&e.filters.length>0),pa(n)&&pa(e))return z_(n,e.getFilters());let t=a7(n)?n:e,i=a7(n)?e:n,r=t.filters.map(s=>uf(s,i));return qe.create(r,"or")}function pb(n,e){if(pa(e))return z_(e,n.getFilters());{let t=e.filters.map(i=>uf(n,i));return qe.create(t,"or")}}function e0(n){if(ne(n instanceof _e||n instanceof qe),n instanceof _e)return n;let e=n.getFilters();if(e.length===1)return e0(e[0]);if(E_(n))return n;let t=e.map(r=>e0(r)),i=[];return t.forEach(r=>{r instanceof _e?i.push(r):r instanceof qe&&(r.op===n.op?i.push(...r.filters):i.push(r))}),i.length===1?i[0]:qe.create(i,n.op)}var R7=class{constructor(){this.collectionParentIndex=new v2}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),M.resolve()}getCollectionParents(e,t){return M.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return M.resolve()}deleteFieldIndex(e,t){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,t){return M.resolve()}getDocumentsMatchingTarget(e,t){return M.resolve(null)}getIndexType(e,t){return M.resolve(0)}getFieldIndexes(e,t){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,t){return M.resolve(ri.min())}getMinOffsetFromCollectionGroup(e,t){return M.resolve(ri.min())}updateCollectionGroup(e,t,i){return M.resolve()}updateIndexEntries(e,t){return M.resolve()}},v2=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Ke(ze.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Ke(ze.comparator)).toArray()}};var gb="IndexedDbIndexManager",x6=new Uint8Array(0),L7=class{constructor(e,t){this.databaseId=t,this.collectionParentsCache=new v2,this.targetToDnfSubTargets=new rr(i=>S1(i),(i,r)=>I2(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.collectionParentsCache.has(t)){let i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.collectionParentsCache.add(t)});let s={collectionId:i,parent:dn(r)};return vb(e).put(s)}return M.resolve()}getCollectionParents(e,t){let i=[],r=IDBKeyRange.bound([t,""],[Yb(t),""],!1,!0);return vb(e).loadAll(r).next(s=>{for(let o of s){if(o.collectionId!==t)break;i.push(Ji(o.parent))}return i})}addFieldIndex(e,t){let i=W4(e),r=vB(t);delete r.indexId;let s=i.add(r);if(t.indexState){let o=ea(e);return s.next(a=>{o.put(rb(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}else return s.next()}deleteFieldIndex(e,t){let i=W4(e),r=ea(e),s=Jo(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=W4(e),i=Jo(e),r=ea(e);return t.deleteAll().next(()=>i.deleteAll()).next(()=>r.deleteAll())}createTargetIndexes(e,t){return M.forEach(this.getSubTargets(t),i=>this.getIndexType(e,i).next(r=>{if(r===0||r===1){let o=new J6(i).buildTargetIndex();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let i=Jo(e),r=!0,s=new Map;return M.forEach(this.getSubTargets(t),o=>this.getFieldIndex(e,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=pe(),a=[];return M.forEach(s,(c,l)=>{B(gb,`Using index ${KV(c)} to execute ${S1(t)}`);let u=bP(l,c),h=_P(l,c),d=CP(l,c),g=SP(l,c),_=this.encodeBound(c,l,d),T=this.encodeBound(c,l,g),E=this.encodeValues(c,l,h),L=this.generateIndexRanges(c.indexId,u,_,d.inclusive,T,g.inclusive,E);return M.forEach(L,x=>i.loadFirst(x,t.limit).next(V=>{V.forEach(P=>{let G=j.fromSegments(P.documentKey);o.has(G)||(o=o.add(G),a.push(G))})}))}).next(()=>a)}else return M.resolve(null)})}getSubTargets(e){let t=this.targetToDnfSubTargets.get(e);return t||(e.filters.length===0?t=[e]:t=PB(qe.create(e.filters,"and")).map(r=>g7(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.targetToDnfSubTargets.set(e,t),t)}generateIndexRanges(e,t,i,r,s,o,a){let c=(t!=null?t.length:1)*Math.max(i.length,s.length),l=c/(t!=null?t.length:1),u=[];for(let h=0;h<c;++h){let d=t?this.encodeSingleElement(t[h/l]):x6,g=this.generateLowerBound(e,d,i[h%l],r),_=this.generateUpperBound(e,d,s[h%l],o),T=a.map(E=>this.generateLowerBound(e,d,E,!0));u.push(...this.createRange(g,_,T))}return u}generateLowerBound(e,t,i,r){let s=new f1(e,j.empty(),t,i);return r?s:s.successor()}generateUpperBound(e,t,i,r){let s=new f1(e,j.empty(),t,i);return r?s.successor():s}getFieldIndex(e,t){let i=new J6(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(let a of s)i.servedByIndex(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let i=2,r=this.getSubTargets(t);return M.forEach(r,s=>this.getFieldIndex(e,s).next(o=>{o?i!==0&&o.fields.length<TP(s)&&(i=1):i=0})).next(()=>EP(t)&&r.length>1&&i===2?1:i)}encodeDirectionalElements(e,t){let i=new d1;for(let r of w1(e)){let s=t.data.field(r.fieldPath);if(s==null)return null;let o=i.forKind(r.kind);Mr.INSTANCE.writeIndexValue(s,o)}return i.encodedBytes()}encodeSingleElement(e){let t=new d1;return Mr.INSTANCE.writeIndexValue(e,t.forKind(0)),t.encodedBytes()}encodeDirectionalKey(e,t){let i=new d1;return Mr.INSTANCE.writeIndexValue(_1(this.databaseId,t),i.forKind(YV(e))),i.encodedBytes()}encodeValues(e,t,i){if(i===null)return[];let r=[];r.push(new d1);let s=0;for(let o of w1(e)){let a=i[s++];for(let c of r)if(this.isInFilter(t,o.fieldPath)&&c2(a))r=this.expandIndexValues(r,o,a);else{let l=c.forKind(o.kind);Mr.INSTANCE.writeIndexValue(a,l)}}return this.getEncodedBytes(r)}encodeBound(e,t,i){return this.encodeValues(e,t,i.position)}getEncodedBytes(e){let t=[];for(let i=0;i<e.length;++i)t[i]=e[i].encodedBytes();return t}expandIndexValues(e,t,i){let r=[...e],s=[];for(let o of i.arrayValue.values||[])for(let a of r){let c=new d1;c.seed(a.encodedBytes()),Mr.INSTANCE.writeIndexValue(o,c.forKind(t.kind)),s.push(c)}return s}isInFilter(e,t){return!!e.filters.find(i=>i instanceof _e&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(e,t){let i=W4(e),r=ea(e);return(t?i.loadAll(n7,IDBKeyRange.bound(t,t)):i.loadAll()).next(s=>{let o=[];return M.forEach(s,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(yB(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((i,r)=>{let s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:fe(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){let r=W4(e),s=ea(e);return this.getNextSequenceNumber(e).next(o=>r.loadAll(n7,IDBKeyRange.bound(t,t)).next(a=>M.forEach(a,c=>s.put(rb(c.indexId,this.uid,o,i)))))}updateIndexEntries(e,t){let i=new Map;return M.forEach(t,(r,s)=>{let o=i.get(r.collectionGroup);return(o?M.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(c=>(i.set(r.collectionGroup,c),M.forEach(c,l=>this.getExistingIndexEntries(e,r,l).next(u=>{let h=this.computeIndexEntries(s,l);return u.isEqual(h)?M.resolve():this.updateEntries(e,s,l,u,h)}))))})}addIndexEntry(e,t,i,r){return Jo(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(i,t.key),documentKey:t.key.path.toArray()})}deleteIndexEntry(e,t,i,r){return Jo(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.encodeDirectionalKey(i,t.key),t.key.path.toArray()])}getExistingIndexEntries(e,t,i){let r=Jo(e),s=new Ke(ys);return r.iterate({index:a_,range:IDBKeyRange.only([i.indexId,this.uid,this.encodeDirectionalKey(i,t)])},(o,a)=>{s=s.add(new f1(i.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}computeIndexEntries(e,t){let i=new Ke(ys),r=this.encodeDirectionalElements(t,e);if(r==null)return i;let s=Ud(t);if(s!=null){let o=e.data.field(s.fieldPath);if(c2(o))for(let a of o.arrayValue.values||[])i=i.add(new f1(t.indexId,e.key,this.encodeSingleElement(a),r))}else i=i.add(new f1(t.indexId,e.key,x6,r));return i}updateEntries(e,t,i,r,s){B(gb,"Updating index entries for document '%s'",t.key);let o=[];return RN(r,s,ys,a=>{o.push(this.addIndexEntry(e,t,i,a))},a=>{o.push(this.deleteIndexEntry(e,t,i,a))}),M.waitFor(o)}getNextSequenceNumber(e){let t=1;return ea(e).iterate({index:o_,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,o)=>{o.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((o,a)=>ys(o,a)).filter((o,a,c)=>!a||ys(o,c[a-1])!==0);let r=[];r.push(e);for(let o of i){let a=ys(o,e),c=ys(o,t);if(a===0)r[0]=e.successor();else if(a>0&&c<0)r.push(o),r.push(o.successor());else if(c>0)break}r.push(t);let s=[];for(let o=0;o<r.length;o+=2){if(this.isRangeMatchable(r[o],r[o+1]))return[];let a=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,x6,[]],c=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,x6,[]];s.push(IDBKeyRange.bound(a,c))}return s}isRangeMatchable(e,t){return ys(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(yb)}getMinOffset(e,t){return M.mapArray(this.getSubTargets(t),i=>this.getFieldIndex(e,i).next(r=>r||Y())).next(yb)}};function vb(n){return Ht(n,i2)}function Jo(n){return Ht(n,R0)}function W4(n){return Ht(n,Gd)}function ea(n){return Ht(n,k0)}function yb(n){ne(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){let r=n[i].indexState.offset;jd(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new ri(e.readTime,e.documentKey,t)}function fC(n,e,t){let i=n.store(Si),r=n.store(Ia),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=i.iterate({range:o},(u,h,d)=>(a++,d.delete()));s.push(c.next(()=>{ne(a===1)}));let l=[];for(let u of t.mutations){let h=i_(e,u.key.path,t.batchId);s.push(r.delete(h)),l.push(u.key)}return M.waitFor(s).next(()=>l)}function t0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else if(n.noDocument)e=n.noDocument;else throw Y();return JSON.stringify(e).length}var n0=class n{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.documentKeysByBatchId={}}static forUser(e,t,i,r){ne(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,i,r)}checkEmpty(e){let t=!0,i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ws(e).iterate({index:m1,range:i},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,i,r){let s=sa(e),o=ws(e);return o.add({}).next(a=>{ne(typeof a=="number");let c=new h2(a,t,i,r),l=cB(this.serializer,this.userId,c),u=[],h=new Ke((d,g)=>fe(d.canonicalString(),g.canonicalString()));for(let d of r){let g=i_(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(s.put(g,iN))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.documentKeysByBatchId[a]=c.keys()}),M.waitFor(u).next(()=>c)})}lookupMutationBatch(e,t){return ws(e).get(t).next(i=>i?(ne(i.userId===this.userId),h1(this.serializer,i)):null)}lookupMutationKeys(e,t){return this.documentKeysByBatchId[t]?M.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){let r=i.keys();return this.documentKeysByBatchId[t]=r,r}else return null})}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]),s=null;return ws(e).iterate({index:m1,range:r},(o,a,c)=>{a.userId===this.userId&&(ne(a.batchId>=i),s=h1(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),i=Ts;return ws(e).iterate({index:m1,range:t,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,Ts],[this.userId,Number.POSITIVE_INFINITY]);return ws(e).loadAll(m1,t).next(i=>i.map(r=>h1(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){let i=D6(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return sa(e).iterate({range:r},(o,a,c)=>{let[l,u,h]=o,d=Ji(u);if(l!==this.userId||!t.path.isEqual(d)){c.done();return}return ws(e).get(h).next(g=>{if(!g)throw Y();ne(g.userId===this.userId),s.push(h1(this.serializer,g))})}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ke(fe),r=[];return t.forEach(s=>{let o=D6(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=sa(e).iterate({range:a},(l,u,h)=>{let[d,g,_]=l,T=Ji(g);if(d!==this.userId||!s.path.isEqual(T)){h.done();return}i=i.add(_)});r.push(c)}),M.waitFor(r).next(()=>this.lookupMutationBatches(e,i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=D6(this.userId,i),o=IDBKeyRange.lowerBound(s),a=new Ke(fe);return sa(e).iterate({range:o},(c,l,u)=>{let[h,d,g]=c,_=Ji(d);if(h!==this.userId||!i.isPrefixOf(_)){u.done();return}_.length===r&&(a=a.add(g))}).next(()=>this.lookupMutationBatches(e,a))}lookupMutationBatches(e,t){let i=[],r=[];return t.forEach(s=>{r.push(ws(e).get(s).next(o=>{if(o===null)throw Y();ne(o.userId===this.userId),i.push(h1(this.serializer,o))}))}),M.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return fC(e.simpleDbTransaction,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.removeCachedMutationKeys(t.batchId)}),M.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}removeCachedMutationKeys(e){delete this.documentKeysByBatchId[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return M.resolve();let i=IDBKeyRange.lowerBound(nN(this.userId)),r=[];return sa(e).iterate({range:i},(s,o,a)=>{if(s[0]!==this.userId){a.done();return}else{let l=Ji(s[1]);r.push(l)}}).next(()=>{ne(r.length===0)})})}containsKey(e,t){return mC(e,this.userId,t)}getMutationQueueMetadata(e){return pC(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ts,lastStreamToken:""})}};function mC(n,e,t){let i=D6(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i),o=!1;return sa(n).iterate({range:s,keysOnly:!0},(a,c,l)=>{let[u,h,d]=a;u===e&&h===r&&(o=!0),l.done()}).next(()=>o)}function qB(n,e){let t=!1;return pC(n).iterateSerial(i=>mC(n,i,e).next(r=>(r&&(t=!0),M.resolve(!r)))).next(()=>t)}function ws(n){return Ht(n,Si)}function sa(n){return Ht(n,Ia)}function pC(n){return Ht(n,z2)}var R5=2,_a=class n{constructor(e){this.lastId=e}next(){return this.lastId+=R5,this.lastId}static forTargetCache(){return new n(2-R5)}static forSyncEngine(){return new n(1-R5)}};var V7=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.retrieveMetadata(e).next(t=>{let i=new _a(t.highestTargetId);return t.highestTargetId=i.next(),this.saveMetadata(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.retrieveMetadata(e).next(t=>oe.fromTimestamp(new mt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.retrieveMetadata(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.retrieveMetadata(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.saveMetadata(e,r)))}addTargetData(e,t){return this.saveTargetData(e,t).next(()=>this.retrieveMetadata(e).next(i=>(i.targetCount+=1,this.updateMetadataFromTargetData(t,i),this.saveMetadata(e,i))))}updateTargetData(e,t){return this.saveTargetData(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ta(e).delete(t.targetId)).next(()=>this.retrieveMetadata(e)).next(i=>(ne(i.targetCount>0),i.targetCount-=1,this.saveMetadata(e,i)))}removeTargets(e,t,i){let r=0,s=[];return ta(e).iterate((o,a)=>{let c=K4(a);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(e,c)))}).next(()=>M.waitFor(s)).next(()=>r)}forEachTarget(e,t){return ta(e).iterate((i,r)=>{let s=K4(r);t(s)})}retrieveMetadata(e){return wb(e).get(q6).next(t=>(ne(t!==null),t))}saveMetadata(e,t){return wb(e).put(q6,t)}saveTargetData(e,t){return ta(e).put(lC(this.serializer,t))}updateMetadataFromTargetData(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.retrieveMetadata(e).next(t=>t.targetCount)}getTargetData(e,t){let i=S1(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]),s=null;return ta(e).iterate({range:r,index:s_},(o,a,c)=>{let l=K4(a);I2(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,i){let r=[],s=_s(e);return t.forEach(o=>{let a=dn(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))}),M.waitFor(r)}removeMatchingKeys(e,t,i){let r=_s(e);return M.forEach(t,s=>{let o=dn(s.path);return M.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){let i=_s(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){let i=IDBKeyRange.bound([t],[t+1],!1,!0),r=_s(e),s=pe();return r.iterate({range:i,keysOnly:!0},(o,a,c)=>{let l=Ji(o[1]),u=new j(l);s=s.add(u)}).next(()=>s)}containsKey(e,t){let i=dn(t.path),r=IDBKeyRange.bound([i],[Yb(i)],!1,!0),s=0;return _s(e).iterate({index:$d,keysOnly:!0,range:r},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}getTargetDataForTarget(e,t){return ta(e).get(t).next(i=>i?K4(i):null)}};function ta(n){return Ht(n,Aa)}function wb(n){return Ht(n,D1)}function _s(n){return Ht(n,Da)}var bb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},k2=-1,gC=40*1024*1024,ii=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};ii.DEFAULT_COLLECTION_PERCENTILE=10;ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;ii.DEFAULT=new ii(gC,ii.DEFAULT_COLLECTION_PERCENTILE,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);ii.DISABLED=new ii(k2,0,0);var _b="LruGarbageCollector",Cb=1*1024*1024,UB=1*60*1e3,jB=5*60*1e3;function Sb([n,e],[t,i]){let r=fe(n,t);return r===0?fe(e,i):r}var N7=class{constructor(e){this.maxElements=e,this.buffer=new Ke(Sb),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();Sb(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},P7=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==k2&&this.scheduleGC(UB)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return this.gcTask!==null}scheduleGC(e){B(_b,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>S(this,null,function*(){this.gcTask=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ns(t)?B(_b,"Ignoring IndexedDB error during garbage collection: ",t):yield Vs(t)}yield this.scheduleGC(jB)}))}},H7=class{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return M.resolve(Pn.INVALID);let i=new N7(t);return this.delegate.forEachTarget(e,r=>i.addElement(r.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,r=>i.addElement(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.delegate.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===k2?(B("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(bb)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bb):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let i,r,s,o,a,c,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>{if(l=Date.now(),na()<=Li.DEBUG){let d=`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in ${a-o}ms
	Removed ${s} targets in ${c-a}ms
	Removed ${h} documents in ${l-c}ms
Total Duration: ${l-u}ms`;B("LruGarbageCollector",d)}return M.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:h})})}};function WB(n,e){return new H7(n,e)}var B7=class{constructor(e,t){this.db=e,this.garbageCollector=WB(this,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}forEachOrphanedDocumentSequenceNumber(e,t){return this.forEachOrphanedDocument(e,(i,r)=>t(r))}addReference(e,t,i){return O6(e,i)}removeReference(e,t,i){return O6(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return O6(e,t)}isPinned(e,t){return qB(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[],o=0;return this.forEachOrphanedDocument(e,(c,l)=>{if(l<=t){let u=this.isPinned(e,c).next(h=>{if(!h)return o++,r.getEntry(e,c).next(()=>(r.removeEntry(c,oe.min()),_s(e).delete($B(c))))});s.push(u)}}).next(()=>M.waitFor(s)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return O6(e,t)}forEachOrphanedDocument(e,t){let i=_s(e),r=Pn.INVALID,s;return i.iterate({index:$d},([o,a],{path:c,sequenceNumber:l})=>{o===0?(r!==Pn.INVALID&&t(new j(Ji(s)),r),r=l,s=c):r=Pn.INVALID}).next(()=>{r!==Pn.INVALID&&t(new j(Ji(s)),r)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function $B(n){return[0,dn(n.path)]}function GB(n,e){return{targetId:0,path:dn(n.path),sequenceNumber:e}}function O6(n,e){return _s(n).put(GB(e,n.currentSequenceNumber))}var i0=class{constructor(){this.changes=new rr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Rt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?M.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var F7=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return c1(e).put(i)}removeEntry(e,t,i){return c1(e).delete(YB(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.setMetadata(e,i)))}getEntry(e,t){let i=Rt.newInvalidDocument(t);return c1(e).iterate({index:k6,range:IDBKeyRange.only($4(t))},(r,s)=>{i=this.maybeDecodeDocument(t,s)}).next(()=>i)}getSizedEntry(e,t){let i={size:0,document:Rt.newInvalidDocument(t)};return c1(e).iterate({index:k6,range:IDBKeyRange.only($4(t))},(r,s)=>{i={document:this.maybeDecodeDocument(t,s),size:t0(s)}}).next(()=>i)}getEntries(e,t){let i=On();return this.forEachDbEntry(e,t,(r,s)=>{let o=this.maybeDecodeDocument(r,s);i=i.insert(r,o)}).next(()=>i)}getSizedEntries(e,t){let i=On(),r=new st(j.comparator);return this.forEachDbEntry(e,t,(s,o)=>{let a=this.maybeDecodeDocument(s,o);i=i.insert(s,a),r=r.insert(s,t0(o))}).next(()=>({documents:i,sizeMap:r}))}forEachDbEntry(e,t,i){if(t.isEmpty())return M.resolve();let r=new Ke(Mb);t.forEach(c=>r=r.add(c));let s=IDBKeyRange.bound($4(r.first()),$4(r.last())),o=r.getIterator(),a=o.getNext();return c1(e).iterate({index:k6,range:s},(c,l,u)=>{let h=j.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&Mb(a,h)<0;)i(a,null),a=o.getNext();a&&a.isEqual(h)&&(i(a,l),a=o.hasNext()?o.getNext():null),a?u.skip($4(a)):u.done()}).next(()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,i,r,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),B0(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return c1(e).loadAll(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let u=On();for(let h of l){let d=this.maybeDecodeDocument(j.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);d.isFoundDocument()&&(D2(t,d)||r.has(d.key))&&(u=u.insert(d.key,d))}return u})}getAllFromCollectionGroup(e,t,i,r){let s=On(),o=Eb(t,i),a=Eb(t,ri.max());return c1(e).iterate({index:r_,range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{let h=this.maybeDecodeDocument(j.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===r&&u.done()}).next(()=>s)}newChangeBuffer(e){return new q7(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Tb(e).get(t7).next(t=>(ne(!!t),t))}setMetadata(e,t){return Tb(e).put(t7,t)}maybeDecodeDocument(e,t){if(t){let i=oB(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(oe.min())))return i}return Rt.newInvalidDocument(e)}};function vC(n){return new F7(n)}var q7=class extends i0{constructor(e,t){super(),this.documentCache=e,this.trackRemovals=t,this.documentStates=new rr(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){let t=[],i=0,r=new Ke((s,o)=>fe(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.documentStates.get(s);if(t.push(this.documentCache.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=ib(this.documentCache.serializer,o);r=r.add(s.path.popLast());let l=t0(c);i+=l-a.size,t.push(this.documentCache.addEntry(e,s,c))}else if(i-=a.size,this.trackRemovals){let c=ib(this.documentCache.serializer,o.convertToNoDocument(oe.min()));t.push(this.documentCache.addEntry(e,s,c))}}),r.forEach(s=>{t.push(this.documentCache.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.documentCache.updateMetadata(e,i)),M.waitFor(t)}getFromCache(e,t){return this.documentCache.getSizedEntry(e,t).next(i=>(this.documentStates.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.documentCache.getSizedEntries(e,t).next(({documents:i,sizeMap:r})=>(r.forEach((s,o)=>{this.documentStates.set(s,{size:o,readTime:i.get(s).readTime})}),i))}};function Tb(n){return Ht(n,x2)}function c1(n){return Ht(n,I0)}function $4(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function YB(n,e){let t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],B0(e),t[t.length-1]]}function Eb(n,e){let t=e.documentKey.path.toArray();return[n,B0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Mb(n,e){let t=n.path.toArray(),i=e.path.toArray(),r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=fe(t[s],i[s]),r)return r;return r=fe(t.length,i.length),r||(r=fe(t[t.length-2],i[i.length-2]),r)?r:fe(t[t.length-1],i[i.length-1])}var KB=17;var U7=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var r0=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&J4(i.mutation,r,Hn.empty(),mt.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,pe()).next(()=>i))}getLocalViewOfDocuments(e,t,i=pe()){let r=er();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=Y4();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let i=er();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,pe()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=On(),o=l2(),a=BP();return t.forEach((c,l)=>{let u=i.get(l.key);r.has(l.key)&&(u===void 0||u.mutation instanceof zi)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),J4(u.mutation,l,u.mutation.getFieldMask(),mt.now())):o.set(l.key,Hn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),t.forEach((l,u)=>{var h;return a.set(l,new U7(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let i=l2(),r=new st((o,a)=>o-a),s=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let u=i.get(c)||Hn.empty();u=a.applyToLocalView(l,u),i.set(c,u);let h=(r.get(a.batchId)||pe()).add(c);r=r.insert(a.batchId,h)})}).next(()=>{let o=[],a=r.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,u=c.value,h=P_();u.forEach(d=>{if(!s.has(d)){let g=W_(t.get(d),i.get(d));g!==null&&h.set(d,g),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return M.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return OP(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):tf(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):M.resolve(er()),a=ha,c=s;return o.next(l=>M.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?M.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,pe())).next(u=>({batchId:a,changes:N_(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(i=>{let r=Y4();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,o=Y4();return this.indexManager.getCollectionParents(e,s).next(a=>M.forEach(a,c=>{let l=MP(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,i,r).next(u=>{u.forEach((h,d)=>{o=o.insert(h,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((c,l)=>{let u=l.getKey();o.get(u)===null&&(o=o.insert(u,Rt.newInvalidDocument(u)))});let a=Y4();return o.forEach((c,l)=>{let u=s.get(c);u!==void 0&&J4(u.mutation,l,Hn.empty(),mt.now()),D2(t,l)&&(a=a.insert(c,l))}),a})}};var j7=class{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return M.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,pB(t)),M.resolve()}getNamedQuery(e,t){return M.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,mB(t)),M.resolve()}};var W7=class{constructor(){this.overlays=new st(j.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return M.resolve(this.overlays.get(t))}getOverlays(e,t){let i=er();return M.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.saveOverlay(e,t,s)}),M.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.overlayByBatchId.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.overlayByBatchId.delete(i)),M.resolve()}getOverlaysForCollection(e,t,i){let r=er(),s=t.length+1,o=new j(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return M.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new st((l,u)=>l-u),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let d=s.get(u.largestBatchId);d===null&&(d=er(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=er(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,d)=>a.set(h,d)),!(a.size()>=r)););return M.resolve(a)}saveOverlay(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let o=this.overlayByBatchId.get(r.largestBatchId).delete(i.key);this.overlayByBatchId.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new d2(t,i));let s=this.overlayByBatchId.get(t);s===void 0&&(s=pe(),this.overlayByBatchId.set(t,s)),this.overlayByBatchId.set(t,s.add(i.key))}};var $7=class{constructor(){this.sessionToken=Ot.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,M.resolve()}};var y2=class{constructor(){this.refsByKey=new Ke(Dt.compareByKey),this.refsByTarget=new Ke(Dt.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let i=new Dt(e,t);this.refsByKey=this.refsByKey.add(i),this.refsByTarget=this.refsByTarget.add(i)}addReferences(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.removeRef(new Dt(e,t))}removeReferences(e,t){e.forEach(i=>this.removeReference(i,t))}removeReferencesForId(e){let t=new j(new ze([])),i=new Dt(t,e),r=new Dt(t,e+1),s=[];return this.refsByTarget.forEachInRange([i,r],o=>{this.removeRef(o),s.push(o.key)}),s}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new j(new ze([])),i=new Dt(t,e),r=new Dt(t,e+1),s=pe();return this.refsByTarget.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Dt(e,0),i=this.refsByKey.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},Dt=class{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return j.comparator(e.key,t.key)||fe(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return fe(e.targetOrBatchId,t.targetOrBatchId)||j.comparator(e.key,t.key)}};var G7=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new Ke(Dt.compareByKey)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new h2(s,t,i,r);this.mutationQueue.push(o);for(let a of r)this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Dt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,t){return M.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.indexOfBatchId(i),s=r<0?0:r;return M.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?Ts:this.nextBatchId-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new Dt(t,0),r=new Dt(t,Number.POSITIVE_INFINITY),s=[];return this.batchesByDocumentKey.forEachInRange([i,r],o=>{let a=this.findMutationBatch(o.targetOrBatchId);s.push(a)}),M.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ke(fe);return t.forEach(r=>{let s=new Dt(r,0),o=new Dt(r,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([s,o],a=>{i=i.add(a.targetOrBatchId)})}),M.resolve(this.findMutationBatches(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;j.isDocumentKey(s)||(s=s.child(""));let o=new Dt(new j(s),0),a=new Ke(fe);return this.batchesByDocumentKey.forEachWhile(c=>{let l=c.key.path;return i.isPrefixOf(l)?(l.length===r&&(a=a.add(c.targetOrBatchId)),!0):!1},o),M.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(i=>{let r=this.findMutationBatch(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){let i=this.indexOfExistingBatchId(t.batchId,"removed");ne(i===0),this.mutationQueue.shift();let r=this.batchesByDocumentKey;return M.forEach(t.mutations,s=>{let o=new Dt(s.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.batchesByDocumentKey=r})}removeCachedMutationKeys(e){}containsKey(e,t){let i=new Dt(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(i);return M.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){if(this.mutationQueue.length===0)return 0;let t=this.mutationQueue[0].batchId;return e-t}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};function QB(){return new st(j.comparator)}var Y7=class{constructor(e){this.sizer=e,this.docs=QB(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.sizer(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return M.resolve(i?i.document.mutableCopy():Rt.newInvalidDocument(t))}getEntries(e,t){let i=On();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Rt.newInvalidDocument(r))}),M.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=On(),o=t.path,a=new j(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||jd(Qb(u),i)<=0||!r.has(u.key)&&!D2(t,u)||(s=s.insert(u.key,u.mutableCopy()))}return M.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Y()}forEachDocumentKey(e,t){return M.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new K7(this)}getSize(e){return M.resolve(this.size)}};function XB(n){return new Y7(n)}var K7=class extends i0{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.documentCache.addEntry(e,r)):this.documentCache.removeEntry(i)}),M.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}};var Q7=class{constructor(e){this.persistence=e,this.targets=new rr(t=>S1(t),I2),this.lastRemoteSnapshotVersion=oe.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new y2,this.targetCount=0,this.targetIdGenerator=_a.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((i,r)=>t(r)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),M.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new _a(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,M.resolve()}updateTargetData(e,t){return this.saveTargetData(t),M.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.targets.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.targets.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),M.waitFor(s).next(()=>r)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,t){let i=this.targets.get(t)||null;return M.resolve(i)}addMatchingKeys(e,t,i){return this.references.addReferences(t,i),M.resolve()}removeMatchingKeys(e,t,i){this.references.removeReferences(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),M.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),M.resolve()}getMatchingKeysForTargetId(e,t){let i=this.references.referencesForId(t);return M.resolve(i)}containsKey(e,t){return M.resolve(this.references.containsKey(t))}};var ZB="MemoryPersistence",s0=class{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new Pn(0),this._started=!1,this._started=!0,this.globalsCache=new $7,this.referenceDelegate=e(this),this.targetCache=new Q7(this);let i=r=>this.referenceDelegate.documentSize(r);this.indexManager=new R7,this.remoteDocumentCache=XB(i),this.serializer=new X6(t),this.bundleCache=new j7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new W7,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.mutationQueues[e.toKey()];return i||(i=new G7(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=i),i}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,i){B(ZB,"Starting transaction:",e);let r=new X7(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),i(r).next(s=>this.referenceDelegate.onTransactionCommitted(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}mutationQueuesContainKey(e,t){return M.or(Object.values(this.mutationQueues).map(i=>()=>i.containsKey(e,t)))}},X7=class extends B6{constructor(e){super(),this.currentSequenceNumber=e}},o0=class n{constructor(e){this.persistence=e,this.localViewReferences=new y2,this._orphanedDocuments=null}static factory(e){return new n(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw Y()}addReference(e,t,i){return this.localViewReferences.addReference(i,t),this.orphanedDocuments.delete(i.toString()),M.resolve()}removeReference(e,t,i){return this.localViewReferences.removeReference(i,t),this.orphanedDocuments.add(i.toString()),M.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),M.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(s=>this.orphanedDocuments.add(s.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.orphanedDocuments.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.orphanedDocuments,r=>{let s=j.fromPath(r);return this.isReferenced(e,s).next(o=>{o||i.removeEntry(s,oe.min())})}).next(()=>(this._orphanedDocuments=null,i.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(i=>{i?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return M.or([()=>M.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}};var Z7=class{constructor(e){this.serializer=e}createOrUpgrade(e,t,i,r){let s=new F6("createOrUpgrade",t);i<1&&r>=1&&(eF(e),tF(e),zb(e),iF(e));let o=M.resolve();return i<3&&r>=3&&(i!==0&&(oF(e),zb(e)),o=o.next(()=>cF(s))),i<4&&r>=4&&(i!==0&&(o=o.next(()=>nF(e,s))),o=o.next(()=>{lF(e)})),i<5&&r>=5&&(o=o.next(()=>this.removeAcknowledgedMutations(s))),i<6&&r>=6&&(o=o.next(()=>(sF(e),this.addDocumentGlobal(s)))),i<7&&r>=7&&(o=o.next(()=>this.ensureSequenceNumbers(s))),i<8&&r>=8&&(o=o.next(()=>this.createCollectionParentIndex(e,s))),i<9&&r>=9&&(o=o.next(()=>{aF(e)})),i<10&&r>=10&&(o=o.next(()=>this.rewriteCanonicalIds(s))),i<11&&r>=11&&(o=o.next(()=>{uF(e),hF(e)})),i<12&&r>=12&&(o=o.next(()=>{fF(e)})),i<13&&r>=13&&(o=o.next(()=>rF(e)).next(()=>this.rewriteRemoteDocumentCache(e,s)).next(()=>e.deleteObjectStore(u1))),i<14&&r>=14&&(o=o.next(()=>this.runOverlayMigration(e,s))),i<15&&r>=15&&(o=o.next(()=>dF(e))),i<16&&r>=16&&(o=o.next(()=>{t.objectStore(k0).clear()}).next(()=>{t.objectStore(R0).clear()})),i<17&&r>=17&&(o=o.next(()=>{mF(e)})),o}addDocumentGlobal(e){let t=0;return e.store(u1).iterate((i,r)=>{t+=t0(r)}).next(()=>{let i={byteSize:t};return e.store(x2).put(t7,i)})}removeAcknowledgedMutations(e){let t=e.store(z2),i=e.store(Si);return t.loadAll().next(r=>M.forEach(r,s=>{let o=IDBKeyRange.bound([s.userId,Ts],[s.userId,s.lastAcknowledgedBatchId]);return i.loadAll(m1,o).next(a=>M.forEach(a,c=>{ne(c.userId===s.userId);let l=h1(this.serializer,c);return fC(e,s.userId,l).next(()=>{})}))}))}ensureSequenceNumbers(e){let t=e.store(Da),i=e.store(u1);return e.store(D1).get(q6).next(s=>{let o=c=>t.put({targetId:0,path:dn(c),sequenceNumber:s.highestListenSequenceNumber}),a=[];return i.iterate((c,l)=>{let u=new ze(c),h=JB(u);a.push(t.get(h).next(d=>d?M.resolve():o(u)))}).next(()=>M.waitFor(a))})}createCollectionParentIndex(e,t){e.createObjectStore(i2,{keyPath:hN});let i=t.store(i2),r=new v2,s=o=>{if(r.add(o)){let a=o.lastSegment(),c=o.popLast();return i.put({collectionId:a,parent:dn(c)})}};return t.store(u1).iterate({keysOnly:!0},(o,a)=>{let c=new ze(o);return s(c.popLast())}).next(()=>t.store(Ia).iterate({keysOnly:!0},([o,a,c],l)=>{let u=Ji(a);return s(u.popLast())}))}rewriteCanonicalIds(e){let t=e.store(Aa);return t.iterate((i,r)=>{let s=K4(r),o=lC(this.serializer,s);return t.put(o)})}rewriteRemoteDocumentCache(e,t){let i=t.store(u1),r=[];return i.iterate((s,o)=>{let a=t.store(I0),c=pF(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(l))}).next(()=>M.waitFor(r))}runOverlayMigration(e,t){let i=t.store(Si),r=vC(this.serializer),s=new s0(o0.factory,this.serializer.remoteSerializer);return i.loadAll().next(o=>{let a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:pe();h1(this.serializer,c).keys().forEach(d=>u=u.add(d)),a.set(c.userId,u)}),M.forEach(a,(c,l)=>{let u=new Lt(l),h=Z6.forUser(this.serializer,u),d=s.getIndexManager(u),g=n0.forUser(u,this.serializer,d,s.referenceDelegate);return new r0(r,g,h,d).recalculateAndSaveOverlaysForDocumentKeys(new r2(t,Pn.INVALID),c).next()})})}};function JB(n){return[0,dn(n)]}function eF(n){n.createObjectStore(M2)}function tF(n){n.createObjectStore(z2,{keyPath:tN}),n.createObjectStore(Si,{keyPath:t_,autoIncrement:!0}).createIndex(m1,n_,{unique:!0}),n.createObjectStore(Ia)}function nF(n,e){return e.store(Si).loadAll().next(i=>{n.deleteObjectStore(Si),n.createObjectStore(Si,{keyPath:t_,autoIncrement:!0}).createIndex(m1,n_,{unique:!0});let s=e.store(Si),o=i.map(a=>s.put(a));return M.waitFor(o)})}function iF(n){n.createObjectStore(u1)}function rF(n){let e=n.createObjectStore(I0,{keyPath:rN});e.createIndex(k6,sN),e.createIndex(r_,oN)}function sF(n){n.createObjectStore(x2)}function zb(n){n.createObjectStore(Da,{keyPath:lN}).createIndex($d,uN,{unique:!0}),n.createObjectStore(Aa,{keyPath:aN}).createIndex(s_,cN,{unique:!0}),n.createObjectStore(D1)}function oF(n){n.deleteObjectStore(Da),n.deleteObjectStore(Aa),n.deleteObjectStore(D1)}function aF(n){n.objectStoreNames.contains("remoteDocumentChanges")&&n.deleteObjectStore("remoteDocumentChanges")}function cF(n){let e=n.store(D1),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:oe.min().toTimestamp(),targetCount:0};return e.put(q6,t)}function lF(n){n.createObjectStore(da,{keyPath:dN})}function uF(n){n.createObjectStore(A0,{keyPath:fN})}function hF(n){n.createObjectStore(D0,{keyPath:mN})}function dF(n){n.createObjectStore(Gd,{keyPath:pN,autoIncrement:!0}).createIndex(n7,gN,{unique:!1}),n.createObjectStore(k0,{keyPath:vN}).createIndex(o_,yN,{unique:!1}),n.createObjectStore(R0,{keyPath:wN}).createIndex(a_,bN,{unique:!1})}function fF(n){let e=n.createObjectStore(L0,{keyPath:_N});e.createIndex(i7,CN,{unique:!1}),e.createIndex(c_,SN,{unique:!1})}function mF(n){n.createObjectStore(Yd,{keyPath:TN})}function pF(n){return n.document?new j(ze.fromString(n.document.name).popFirst(5)):n.noDocument?j.fromSegments(n.noDocument.path):n.unknownDocument?j.fromSegments(n.unknownDocument.path):Y()}var bs="IndexedDbPersistence",L5=30*60*1e3,V5=5e3,gF=4e3,N5="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",vF="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",yF="firestore_zombie",yC="main",J7=class n{constructor(e,t,i,r,s,o,a,c,l,u,h=KB){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.queue=s,this.window=o,this.document=a,this.sequenceNumberSyncer=l,this.forceOwningTab=u,this.schemaVersion=h,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=d=>Promise.resolve(),!n.isAvailable())throw new N(z.UNIMPLEMENTED,vF);this.referenceDelegate=new B7(this,r),this.dbName=t+yC,this.serializer=new X6(c),this.simpleDb=new Ms(this.dbName,this.schemaVersion,new Z7(this.serializer)),this.globalsCache=new O7,this.targetCache=new V7(this.referenceDelegate,this.serializer),this.remoteDocumentCache=vC(this.serializer),this.bundleCache=new x7,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,u===!1&&ft(bs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new N(z.FAILED_PRECONDITION,N5);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.targetCache.getHighestSequenceNumber(e))}).then(e=>{this.listenSequence=new Pn(e,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(e=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(e)))}setPrimaryStateListener(e){return this.primaryStateListener=t=>S(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.simpleDb.setVersionChangeListener(t=>S(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(()=>S(this,null,function*(){this.started&&(yield this.updateClientMetadataAndTryBecomePrimary())})))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>I6(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(e).next(i=>{i||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(e)).next(i=>this.isPrimary&&!i?this.releasePrimaryLeaseIfHeld(e).next(()=>!1):i?this.acquireOrExtendPrimaryLease(e).next(()=>!0):!1)).catch(e=>{if(Ns(e))return B(bs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return B(bs,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.queue.enqueueRetryable(()=>this.primaryStateListener(e)),this.isPrimary=e})}verifyPrimaryLease(e){return G4(e).get(Ko).next(i=>M.resolve(this.isLocalClient(i)))}removeClientMetadata(e){return I6(e).delete(this.clientId)}maybeGarbageCollectMultiClientState(){return S(this,null,function*(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,L5)){this.lastGarbageCollectionTime=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let i=Ht(t,da);return i.loadAll().next(r=>{let s=this.filterActiveClients(r,L5),o=r.filter(a=>s.indexOf(a)===-1);return M.forEach(o,a=>i.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.webStorage)for(let t of e)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(t.clientId))}})}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",gF,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(e){return e?e.ownerId===this.clientId:!1}canActAsPrimary(e){return this.forceOwningTab?M.resolve(!0):G4(e).get(Ko).next(i=>{if(i!==null&&this.isWithinAge(i.leaseTimestampMs,V5)&&!this.isClientZombied(i.ownerId)){if(this.isLocalClient(i)&&this.networkEnabled)return!0;if(!this.isLocalClient(i)){if(!i.allowTabSynchronization)throw new N(z.FAILED_PRECONDITION,N5);return!1}}return this.networkEnabled&&this.inForeground?!0:I6(e).loadAll().next(s=>this.filterActiveClients(s,V5).find(a=>{if(this.clientId!==a.clientId){let c=!this.networkEnabled&&a.networkEnabled,l=!this.inForeground&&a.inForeground,u=this.networkEnabled===a.networkEnabled;if(c||l&&u)return!0}return!1})===void 0)}).next(i=>(this.isPrimary!==i&&B(bs,`Client ${i?"is":"is not"} eligible for a primary lease.`),i))}shutdown(){return S(this,null,function*(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),yield this.simpleDb.runTransaction("shutdown","readwrite",[M2,da],e=>{let t=new r2(e,Pn.INVALID);return this.releasePrimaryLeaseIfHeld(t).next(()=>this.removeClientMetadata(t))}),this.simpleDb.close(),this.removeClientZombiedEntry()})}filterActiveClients(e,t){return e.filter(i=>this.isWithinAge(i.updateTimeMs,t)&&!this.isClientZombied(i.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",e=>I6(e).loadAll().next(t=>this.filterActiveClients(t,L5).map(i=>i.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(e,t){return n0.forUser(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new L7(e,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(e){return Z6.forUser(this.serializer,e)}getBundleCache(){return this.bundleCache}runTransaction(e,t,i){B(bs,"Starting transaction:",e);let r=t==="readonly"?"readonly":"readwrite",s=kN(this.schemaVersion),o;return this.simpleDb.runTransaction(e,r,s,a=>(o=new r2(a,this.listenSequence?this.listenSequence.next():Pn.INVALID),t==="readwrite-primary"?this.verifyPrimaryLease(o).next(c=>c?!0:this.canActAsPrimary(o)).next(c=>{if(!c)throw ft(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new N(z.FAILED_PRECONDITION,Xb);return i(o)}).next(c=>this.acquireOrExtendPrimaryLease(o).next(()=>c)):this.verifyAllowTabSynchronization(o).next(()=>i(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}verifyAllowTabSynchronization(e){return G4(e).get(Ko).next(i=>{if(i!==null&&this.isWithinAge(i.leaseTimestampMs,V5)&&!this.isClientZombied(i.ownerId)&&!this.isLocalClient(i)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!i.allowTabSynchronization))throw new N(z.FAILED_PRECONDITION,N5)})}acquireOrExtendPrimaryLease(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return G4(e).put(Ko,t)}static isAvailable(){return Ms.isAvailable()}releasePrimaryLeaseIfHeld(e){let t=G4(e);return t.get(Ko).next(i=>this.isLocalClient(i)?(B(bs,"Releasing primary lease."),t.delete(Ko)):M.resolve())}isWithinAge(e,t){let i=Date.now(),r=i-t,s=i;return e<r?!1:e>s?(ft(`Detected an update time that is in the future: ${e} > ${s}`),!1):!0}attachVisibilityHandler(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground=this.document.visibilityState==="visible")}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.windowUnloadHandler=()=>{this.markClientZombied();let t=/(?:Version|Mobile)\/1[456]/;cl()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(e){var t;try{let i=((t=this.webStorage)===null||t===void 0?void 0:t.getItem(this.zombiedClientLocalStorageKey(e)))!==null;return B(bs,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return ft(bs,"Failed to get zombied client id.",i),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){ft("Failed to set zombie client id.",e)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch{}}zombiedClientLocalStorageKey(e){return`${yF}_${this.persistenceKey}_${e}`}};function G4(n){return Ht(n,M2)}function I6(n){return Ht(n,da)}function hf(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}function wF(n){return S(this,null,function*(){if(!Ms.isAvailable())return Promise.resolve();let e=n+yC;yield Ms.delete(e)})}function bF(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}var df="LocalStore",_F=5*60*1e6,w2=class{constructor(e,t,i,r){this.persistence=e,this.queryEngine=t,this.serializer=r,this.targetDataByTarget=new st(fe),this.targetIdByTarget=new rr(s=>S1(s),I2),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(i)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new r0(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}};function wC(n,e,t,i){return new w2(n,e,t,i)}function bC(n,e){return S(this,null,function*(){let t=W(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,t.initializeUserComponents(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],c=[],l=pe();for(let u of s){a.push(u.batchId);for(let h of u.mutations)l=l.add(h.key)}for(let u of o){c.push(u.batchId);for(let h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next(u=>({affectedDocuments:u,removedBatchIds:a,addedBatchIds:c}))})})})}function CF(n,e){let t=W(n),i=mt.now(),r=e.reduce((a,c)=>a.add(c.key),pe()),s,o;return t.persistence.runTransaction("Locally write mutations","readwrite",a=>{let c=On(),l=pe();return t.remoteDocuments.getEntries(a,r).next(u=>{c=u,c.forEach((h,d)=>{d.isValidDocument()||(l=l.add(h))})}).next(()=>t.localDocuments.getOverlayedDocuments(a,c)).next(u=>{s=u;let h=[];for(let d of e){let g=ZP(d,s.get(d.key).overlayedDocument);g!=null&&h.push(new zi(d.key,g,S_(g.value.mapValue),_t.exists(!0)))}return t.mutationQueue.addMutationBatch(a,i,h,e)}).next(u=>{o=u;let h=u.applyToLocalDocumentSet(s,l);return t.documentOverlayCache.saveOverlays(a,u.batchId,h)})}).then(()=>({batchId:o.batchId,changes:N_(s)}))}function SF(n,e){let t=W(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return kF(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,TF(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function TF(n){let e=pe();for(let t=0;t<n.mutationResults.length;++t)n.mutationResults[t].transformResults.length>0&&(e=e.add(n.batch.mutations[t].key));return e}function EF(n,e){let t=W(n);return t.persistence.runTransaction("Reject batch","readwrite-primary",i=>{let r;return t.mutationQueue.lookupMutationBatch(i,e).next(s=>(ne(s!==null),r=s.keys(),t.mutationQueue.removeMutationBatch(i,s))).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,r)).next(()=>t.localDocuments.getDocuments(i,r))})}function MF(n){let e=W(n);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",t=>e.mutationQueue.getHighestUnacknowledgedBatchId(t))}function _C(n){let e=W(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.targetCache.getLastRemoteSnapshotVersion(t))}function zF(n,e){let t=W(n),i=e.snapshotVersion,r=t.targetDataByTarget;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});r=t.targetDataByTarget;let a=[];e.targetChanges.forEach((u,h)=>{let d=r.get(h);if(!d)return;a.push(t.targetCache.removeMatchingKeys(s,u.removedDocuments,h).next(()=>t.targetCache.addMatchingKeys(s,u.addedDocuments,h)));let g=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Ot.EMPTY_BYTE_STRING,oe.min()).withLastLimboFreeSnapshotVersion(oe.min()):u.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(u.resumeToken,i)),r=r.insert(h,g),xF(d,g,u)&&a.push(t.targetCache.updateTargetData(s,g))});let c=On(),l=pe();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(CC(s,o,e.documentUpdates).next(u=>{c=u.changedDocuments,l=u.existenceChangedKeys})),!i.isEqual(oe.min())){let u=t.targetCache.getLastRemoteSnapshotVersion(s).next(h=>t.targetCache.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(u)}return M.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.targetDataByTarget=r,s))}function CC(n,e,t){let i=pe(),r=pe();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=On();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(oe.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):B(df,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{changedDocuments:o,existenceChangedKeys:r}})}function xF(n,e,t){return n.resumeToken.approximateByteSize()===0||e.snapshotVersion.toMicroseconds()-n.snapshotVersion.toMicroseconds()>=_F?!0:t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size>0}function OF(n,e){return S(this,null,function*(){let t=W(n);try{yield t.persistence.runTransaction("notifyLocalViewChanges","readwrite",i=>M.forEach(e,r=>M.forEach(r.addedKeys,s=>t.persistence.referenceDelegate.addReference(i,r.targetId,s)).next(()=>M.forEach(r.removedKeys,s=>t.persistence.referenceDelegate.removeReference(i,r.targetId,s)))))}catch(i){if(Ns(i))B(df,"Failed to update sequence numbers: "+i);else throw i}for(let i of e){let r=i.targetId;if(!i.fromCache){let s=t.targetDataByTarget.get(r),o=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(o);t.targetDataByTarget=t.targetDataByTarget.insert(r,a)}}})}function IF(n,e){let t=W(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=Ts),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function AF(n,e){let t=W(n);return t.persistence.runTransaction("read document","readonly",i=>t.localDocuments.getDocument(i,e))}function Ca(n,e){let t=W(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.targetCache.getTargetData(i,e).next(s=>s?(r=s,M.resolve(r)):t.targetCache.allocateTargetId(i).next(o=>(r=new ba(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.targetCache.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.targetDataByTarget.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.targetDataByTarget=t.targetDataByTarget.insert(i.targetId,i),t.targetIdByTarget.set(e,i.targetId)),i})}function DF(n,e,t){let i=W(n),r=i.targetIdByTarget.get(t);return r!==void 0?M.resolve(i.targetDataByTarget.get(r)):i.targetCache.getTargetData(e,t)}function Sa(n,e,t){return S(this,null,function*(){let i=W(n),r=i.targetDataByTarget.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(Ns(o))B(df,`Failed to update sequence numbers for target ${e}: ${o}`);else throw o}i.targetDataByTarget=i.targetDataByTarget.remove(e),i.targetIdByTarget.delete(r.target)})}function F0(n,e,t){let i=W(n),r=oe.min(),s=pe();return i.persistence.runTransaction("Execute query","readwrite",o=>DF(i,o,fn(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.targetCache.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>i.queryEngine.getDocumentsMatchingQuery(o,e,t?r:oe.min(),t?s:pe())).next(a=>(EC(i,R_(e),a),{documents:a,remoteKeys:s})))}function kF(n,e,t,i){let r=t.batch,s=r.keys(),o=M.resolve();return s.forEach(a=>{o=o.next(()=>i.getEntry(e,a)).next(c=>{let l=t.docVersions.get(a);ne(l!==null),c.version.compareTo(l)<0&&(r.applyToRemoteDocument(c,t),c.isValidDocument()&&(c.setReadTime(t.commitVersion),i.addEntry(c)))})}),o.next(()=>n.mutationQueue.removeMutationBatch(e,r))}function RF(n,e){let t=W(n),i=W(t.mutationQueue);return t.persistence.runTransaction("Lookup mutation documents","readonly",r=>i.lookupMutationKeys(r,e).next(s=>s?t.localDocuments.getDocuments(r,s):M.resolve(null)))}function LF(n,e){W(W(n,w2).mutationQueue).removeCachedMutationKeys(e)}function VF(n){return W(W(n,w2).persistence).getActiveClients()}function SC(n,e){let t=W(n),i=W(t.targetCache),r=t.targetDataByTarget.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.getTargetDataForTarget(s,e).next(o=>o?o.target:null))}function TC(n,e){let t=W(n),i=t.collectionGroupReadTime.get(e)||oe.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.remoteDocuments.getAllFromCollectionGroup(r,e,Kb(i,ha),Number.MAX_SAFE_INTEGER)).then(r=>(EC(t,e,r),r))}function EC(n,e,t){let i=n.collectionGroupReadTime.get(e)||oe.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.collectionGroupReadTime.set(e,i)}function NF(n){return fn(ka(ze.fromString(`__bundle__/docs/${n}`)))}function PF(n,e,t,i){return S(this,null,function*(){let r=W(n),s=pe(),o=On();for(let l of t){let u=e.toDocumentKey(l.metadata.name);l.document&&(s=s.add(u));let h=e.toMutableDocument(l);h.setReadTime(e.toSnapshotVersion(l.metadata.readTime)),o=o.insert(u,h)}let a=r.remoteDocuments.newChangeBuffer({trackRemovals:!0}),c=yield Ca(r,NF(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",l=>CC(l,a,o).next(u=>(a.apply(l),u)).next(u=>r.targetCache.removeMatchingKeysForTargetId(l,c.targetId).next(()=>r.targetCache.addMatchingKeys(l,s,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(l,u.changedDocuments,u.existenceChangedKeys)).next(()=>u.changedDocuments)))})}function HF(n,e){let t=W(n),i=zt(e.createTime);return t.persistence.runTransaction("hasNewerBundle","readonly",r=>t.bundleCache.getBundleMetadata(r,e.id)).then(r=>!!r&&r.createTime.compareTo(i)>=0)}function BF(n,e){let t=W(n);return t.persistence.runTransaction("Save bundle","readwrite",i=>t.bundleCache.saveBundleMetadata(i,e))}function FF(n,e){let t=W(n);return t.persistence.runTransaction("Get named query","readonly",i=>t.bundleCache.getNamedQuery(i,e))}function qF(i,r){return S(this,arguments,function*(n,e,t=pe()){let s=yield Ca(n,fn(af(e.bundledQuery))),o=W(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=zt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.bundleCache.saveNamedQuery(a,e);let l=s.withResumeToken(Ot.EMPTY_BYTE_STRING,c);return o.targetDataByTarget=o.targetDataByTarget.insert(l.targetId,l),o.targetCache.updateTargetData(a,l).next(()=>o.targetCache.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.targetCache.addMatchingKeys(a,t,s.targetId)).next(()=>o.bundleCache.saveNamedQuery(a,e))})})}var ed=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var UF=100;function jF(){return cl()?8:Zb(a4())>0?6:4}var a0=class{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=UF,this.relativeIndexReadCostPerDocument=jF()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.performQueryUsingIndex(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.performQueryUsingRemoteKeys(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new ed;return this.executeFullCollectionScan(e,t,o).next(a=>{if(s.result=a,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,o,a.size)})}).next(()=>s.result)}createCacheIndexes(e,t,i,r){return i.documentReadCount<this.indexAutoCreationMinCollectionSize?(na()<=Li.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",ia(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),M.resolve()):(na()<=Li.DEBUG&&B("QueryEngine","Query:",ia(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.relativeIndexReadCostPerDocument*r?(na()<=Li.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",ia(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,fn(t))):M.resolve())}performQueryUsingIndex(e,t){if(Kw(t))return M.resolve(null);let i=fn(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=G6(t,null,"F"),i=fn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let o=pe(...s);return this.localDocumentsView.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(c=>{let l=this.applyQuery(t,a);return this.needsRefill(t,l,o,c.readTime)?this.performQueryUsingIndex(e,G6(t,null,"F")):this.appendRemainingResults(e,l,t,c)}))})))}performQueryUsingRemoteKeys(e,t,i,r){return Kw(t)||r.isEqual(oe.min())?M.resolve(null):this.localDocumentsView.getDocuments(e,i).next(s=>{let o=this.applyQuery(t,s);return this.needsRefill(t,o,i,r)?M.resolve(null):(na()<=Li.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ia(t)),this.appendRemainingResults(e,o,t,Kb(r,ha)).next(a=>a))})}applyQuery(e,t){let i=new Ke(L_(e));return t.forEach((r,s)=>{D2(e,s)&&(i=i.add(s))}),i}needsRefill(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return s?s.hasPendingWrites||s.version.compareTo(r)>0:!1}executeFullCollectionScan(e,t,i){return na()<=Li.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",ia(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,ri.min(),i)}appendRemainingResults(e,t,i,r){return this.localDocumentsView.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var MC="firestore_clients";function xb(n,e){return`${MC}_${n}_${e}`}var zC="firestore_mutations";function Ob(n,e,t){let i=`${zC}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}var xC="firestore_targets";function P5(n,e){return`${xC}_${n}_${e}`}var WF="firestore_online_state";function $F(n){return`${WF}_${n}`}var GF="firestore_bundle_loaded_v2";function YF(n){return`${GF}_${n}`}var KF="firestore_sequence_number";function QF(n){return`${KF}_${n}`}var Zi="SharedClientState",c0=class n{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static fromWebStorageEntry(e,t,i){let r=JSON.parse(i),s=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object"),o;return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(o=new N(r.error.code,r.error.message))),s?new n(e,t,r.state,o):(ft(Zi,`Failed to parse mutation state for ID '${t}': ${i}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},e2=class n{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static fromWebStorageEntry(e,t){let i=JSON.parse(t),r=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object"),s;return r&&i.error&&(r=typeof i.error.message=="string"&&typeof i.error.code=="string",r&&(s=new N(i.error.code,i.error.message))),r?new n(e,i.state,s):(ft(Zi,`Failed to parse target state for ID '${e}': ${t}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},l0=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static fromWebStorageEntry(e,t){let i=JSON.parse(t),r=typeof i=="object"&&i.activeTargetIds instanceof Array,s=rf();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=y_(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new n(e,s):(ft(Zi,`Failed to parse client data for instance '${e}': ${t}`),null)}},td=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static fromWebStorageEntry(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ft(Zi,`Failed to parse online state: ${e}`),null)}},b2=class{constructor(){this.activeTargetIds=rf()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},t2=class{constructor(e,t,i,r,s){this.window=e,this.queue=t,this.persistenceKey=i,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new st(fe),this.started=!1,this.earlyEvents=[];let o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.localClientStorageKey=xb(this.persistenceKey,this.localClientId),this.sequenceNumberKey=QF(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new b2),this.clientStateKeyRe=new RegExp(`^${MC}_${o}_([^_]*)$`),this.mutationBatchKeyRe=new RegExp(`^${zC}_${o}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=new RegExp(`^${xC}_${o}_(\\d+)$`),this.onlineStateKey=$F(this.persistenceKey),this.bundleLoadedKey=YF(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(e){return!!(e&&e.localStorage)}start(){return S(this,null,function*(){let e=yield this.syncEngine.getActiveClients();for(let i of e){if(i===this.localClientId)continue;let r=this.getItem(xb(this.persistenceKey,i));if(r){let s=l0.fromWebStorageEntry(i,r);s&&(this.activeClients=this.activeClients.insert(s.clientId,s))}}this.persistClientState();let t=this.storage.getItem(this.onlineStateKey);if(t){let i=this.fromWebStorageOnlineState(t);i&&this.handleOnlineStateEvent(i)}for(let i of this.earlyEvents)this.handleWebStorageEvent(i);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(e){let t=!1;return this.activeClients.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.persistMutationState(e,"pending")}updateMutationState(e,t,i){this.persistMutationState(e,t,i),this.removeMutationState(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(P5(this.persistenceKey,e));if(r){let s=e2.fromWebStorageEntry(e,r);s&&(i=s.state)}}return t&&this.localClientState.addQueryTarget(e),this.persistClientState(),i}removeLocalQueryTarget(e){this.localClientState.removeQueryTarget(e),this.persistClientState()}isLocalQueryTarget(e){return this.localClientState.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(P5(this.persistenceKey,e))}updateQueryState(e,t,i){this.persistQueryTargetState(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.removeMutationState(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.persistOnlineState(e)}notifyBundleLoaded(e){this.persistBundleLoadedState(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return B(Zi,"READ",e,t),t}setItem(e,t){B(Zi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){B(Zi,"REMOVE",e),this.storage.removeItem(e)}handleWebStorageEvent(e){let t=e;if(t.storageArea===this.storage){if(B(Zi,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey){ft("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(()=>S(this,null,function*(){if(!this.started){this.earlyEvents.push(t);return}if(t.key!==null){if(this.clientStateKeyRe.test(t.key))if(t.newValue!=null){let i=this.fromWebStorageClientState(t.key,t.newValue);if(i)return this.handleClientStateEvent(i.clientId,i)}else{let i=this.fromWebStorageClientStateKey(t.key);return this.handleClientStateEvent(i,null)}else if(this.mutationBatchKeyRe.test(t.key)){if(t.newValue!==null){let i=this.fromWebStorageMutationMetadata(t.key,t.newValue);if(i)return this.handleMutationBatchEvent(i)}}else if(this.queryTargetKeyRe.test(t.key)){if(t.newValue!==null){let i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue);if(i)return this.handleQueryTargetEvent(i)}}else if(t.key===this.onlineStateKey){if(t.newValue!==null){let i=this.fromWebStorageOnlineState(t.newValue);if(i)return this.handleOnlineStateEvent(i)}}else if(t.key===this.sequenceNumberKey){let i=XF(t.newValue);i!==Pn.INVALID&&this.sequenceNumberHandler(i)}else if(t.key===this.bundleLoadedKey){let i=this.fromWebStoreBundleLoadedState(t.newValue);yield Promise.all(i.map(r=>this.syncEngine.synchronizeWithChangedDocuments(r)))}}}))}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(e,t,i){let r=new c0(this.currentUser,e,t,i),s=Ob(this.persistenceKey,this.currentUser,e);this.setItem(s,r.toWebStorageJSON())}removeMutationState(e){let t=Ob(this.persistenceKey,this.currentUser,e);this.removeItem(t)}persistOnlineState(e){let t={clientId:this.localClientId,onlineState:e};this.storage.setItem(this.onlineStateKey,JSON.stringify(t))}persistQueryTargetState(e,t,i){let r=P5(this.persistenceKey,e),s=new e2(e,t,i);this.setItem(r,s.toWebStorageJSON())}persistBundleLoadedState(e){let t=JSON.stringify(Array.from(e));this.setItem(this.bundleLoadedKey,t)}fromWebStorageClientStateKey(e){let t=this.clientStateKeyRe.exec(e);return t?t[1]:null}fromWebStorageClientState(e,t){let i=this.fromWebStorageClientStateKey(e);return l0.fromWebStorageEntry(i,t)}fromWebStorageMutationMetadata(e,t){let i=this.mutationBatchKeyRe.exec(e),r=Number(i[1]),s=i[2]!==void 0?i[2]:null;return c0.fromWebStorageEntry(new Lt(s),r,t)}fromWebStorageQueryTargetMetadata(e,t){let i=this.queryTargetKeyRe.exec(e),r=Number(i[1]);return e2.fromWebStorageEntry(r,t)}fromWebStorageOnlineState(e){return td.fromWebStorageEntry(e)}fromWebStoreBundleLoadedState(e){return JSON.parse(e)}handleMutationBatchEvent(e){return S(this,null,function*(){if(e.user.uid!==this.currentUser.uid){B(Zi,`Ignoring mutation for non-active user ${e.user.uid}`);return}return this.syncEngine.applyBatchState(e.batchId,e.state,e.error)})}handleQueryTargetEvent(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)}handleClientStateEvent(e,t){let i=t?this.activeClients.insert(e,t):this.activeClients.remove(e),r=this.extractActiveQueryTargets(this.activeClients),s=this.extractActiveQueryTargets(i),o=[],a=[];return s.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.applyActiveTargetsChange(o,a).then(()=>{this.activeClients=i})}handleOnlineStateEvent(e){this.activeClients.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}extractActiveQueryTargets(e){let t=rf();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}};function XF(n){let e=Pn.INVALID;if(n!=null)try{let t=JSON.parse(n);ne(typeof t=="number"),e=t}catch(t){ft(Zi,"Failed to read sequence number from WebStorage",t)}return e}var u0=class{constructor(){this.localState=new b2,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,i){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new b2,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var nd=class{addCallback(e){}shutdown(){}};var id=class{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onConnected(e){this.wrappedOnConnected=e}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}};var A6=null;function ZF(){return 268435456+Math.round(2147483648*Math.random())}function H5(){return A6===null?A6=ZF():A6++,"0x"+A6.toString(16)}function JF(n){return new Promise((e,t)=>{n((i,r)=>{i?t(i):e(r)})})}var eq="1.9.1",hn="GrpcConnection",tq=`gl-node/${process.versions.node} fire/${Oa} grpc/${eq}`;function B5(n,e,t,i){ne(e===null||e.type==="OAuth");let r=new v1.Metadata;return e&&e.headers.forEach((s,o)=>r.set(o,s)),t&&t.headers.forEach((s,o)=>r.set(o,s)),i&&r.set("X-Firebase-GMPID",i),r.set("X-Goog-Api-Client",tq),r.set("Google-Cloud-Resource-Prefix",n),r.set("x-goog-request-params",n),r}var rd=class{constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}get shouldResourcePathBeIncludedInRequest(){return!0}ensureActiveStub(){if(!this.cachedStub){B(hn,"Creating Firestore stub.");let e=this.databaseInfo.ssl?v1.credentials.createSsl():v1.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,i,r,s){let o=H5(),a=this.ensureActiveStub(),c=B5(this.databasePath,r,s,this.databaseInfo.appId),l=Object.assign({database:this.databasePath},i);return JF(u=>(B(hn,`RPC '${e}' ${o} invoked with request:`,i),a[e](l,c,(h,d)=>{h?(B(hn,`RPC '${e}' ${o} failed with error:`,h),u(new N(V6(h.code),h.message))):(B(hn,`RPC '${e}' ${o} completed with response:`,d),u(void 0,d))})))}invokeStreamingRPC(e,t,i,r,s,o){let a=H5(),c=[],l=new kt;B(hn,`RPC '${e}' ${a} invoked (streaming) with request:`,i);let u=this.ensureActiveStub(),h=B5(this.databasePath,r,s,this.databaseInfo.appId),d=Object.assign(Object.assign({},i),{database:this.databasePath}),g=u[e](d,h),_=!1;return g.on("data",T=>{B(hn,`RPC ${e} ${a} received result:`,T),c.push(T),o!==void 0&&c.length===o&&(_=!0,l.resolve(c))}),g.on("end",()=>{B(hn,`RPC '${e}' ${a} completed.`),_||(_=!0,l.resolve(c))}),g.on("error",T=>{B(hn,`RPC '${e}' ${a} failed with error:`,T);let E=V6(T.code);l.reject(new N(E,T.message))}),l.promise}openStream(e,t,i){let r=H5(),s=this.ensureActiveStub(),o=B5(this.databasePath,t,i,this.databaseInfo.appId),a=s[e](o),c=!1,l=d=>{c||(c=!0,u.callOnClose(d),a.end())},u=new id({sendFn:d=>{if(c)B(hn,`RPC '${e}' stream ${r} not sending because gRPC stream is closed:`,d);else{B(hn,`RPC '${e}' stream ${r} sending:`,d);try{a.write(d)}catch(g){throw ft("Failure sending:",d),ft("Error:",g),g}}},closeFn:()=>{B(hn,`RPC '${e}' stream ${r} closed locally via close().`),l()}}),h=!1;return a.on("data",d=>{c||(B(hn,`RPC '${e}' stream ${r} received:`,d),h||(u.callOnConnected(),h=!0),u.callOnMessage(d))}),a.on("end",()=>{B(hn,`RPC '${e}' stream ${r} ended.`),l()}),a.on("error",d=>{if(!c){Ti(hn,`RPC '${e}' stream ${r} error. Code:`,d.code,"Message:",d.message);let g=V6(d.code);l(new N(g,d.message))}}),B(hn,`Opening RPC '${e}' stream ${r} to ${this.databaseInfo.host}`),setTimeout(()=>{u.callOnOpen()},0),u}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}},OC={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}},nq={nested:OC},iq=Object.freeze({__proto__:null,nested:OC,default:nq});var rq={longs:String,enums:String,defaults:!0,oneofs:!1};function sq(){let n=Wb.fromJSON(iq,rq);return v1.loadPackageDefinition(n)}function oq(n){let e=sq();return new rd(e,n)}function aq(){return new nd}function IC(){return process.env.USE_MOCK_PERSISTENCE==="YES"?window:null}function cq(){return null}function R2(n){return new S7(n,!1)}var lq="ExponentialBackoff",uq=1e3,hq=1.5,dq=60*1e3,_2=class{constructor(e,t,i=uq,r=hq,s=dq){this.queue=e,this.timerId=t,this.initialDelayMs=i,this.backoffFactor=r,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),i=Math.max(0,Date.now()-this.lastAttemptTime),r=Math.max(0,t-i);r>0&&B(lq,`Backing off for ${r} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,r,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var Ib="PersistentStream",fq=60*1e3,mq=10*1e3,h0=class{constructor(e,t,i,r,s,o,a,c){this.queue=e,this.idleTimerId=i,this.healthTimerId=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new _2(e,t)}isStarted(){return this.state===1||this.state===5||this.isOpen()}isOpen(){return this.state===2||this.state===3}start(){if(this.responseCount=0,this.state===4){this.performBackoff();return}this.auth()}stop(){return S(this,null,function*(){this.isStarted()&&(yield this.close(0))})}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&this.idleTimer===null&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,fq,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}handleIdleCloseTimer(){return S(this,null,function*(){if(this.isOpen())return this.close(0)})}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}close(e,t){return S(this,null,function*(){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,e!==4?this.backoff.reset():t&&t.code===z.RESOURCE_EXHAUSTED?(ft(t.toString()),ft("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.onClose(t)})}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.closeCount===t&&this.startStream(i,r)},i=>{e(()=>{let r=new N(z.UNKNOWN,"Fetching auth token failed: "+i.message);return this.handleStreamClose(r)})})}startStream(e,t){let i=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onConnected(()=>{i(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{i(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,mq,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(r=>{i(()=>this.handleStreamClose(r))}),this.stream.onMessage(r=>{i(()=>++this.responseCount===1?this.onFirst(r):this.onNext(r))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(()=>S(this,null,function*(){this.state=0,this.start()}))}handleStreamClose(e){return B(Ib,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(B(Ib,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},sd=class extends h0{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onFirst(e){return this.onNext(e)}onNext(e){this.backoff.reset();let t=SH(this.serializer,e),i=EH(e);return this.listener.onWatchChange(t,i)}watch(e){let t={};t.database=M7(this.serializer),t.addTarget=VH(this.serializer,e);let i=RH(this.serializer,e);i&&(t.labels=i),this.sendRequest(t)}unwatch(e){let t={};t.database=M7(this.serializer),t.removeTarget=e,this.sendRequest(t)}},od=class extends h0{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onFirst(e){return ne(!!e.streamToken),this.lastStreamToken=e.streamToken,ne(!e.writeResults||e.writeResults.length===0),this.listener.onHandshakeComplete()}onNext(e){ne(!!e.streamToken),this.lastStreamToken=e.streamToken,this.backoff.reset();let t=OH(e.writeResults,e.commitTime),i=zt(e.commitTime);return this.listener.onMutationResult(i,t)}writeHandshake(){let e={};e.database=M7(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>g2(this.serializer,i))};this.sendRequest(t)}};var ad=class{},cd=class extends ad{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new N(z.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,i,r){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.invokeRPC(e,E7(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new N(z.UNKNOWN,s.toString())})}invokeStreamingRPC(e,t,i,r,s){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.invokeStreamingRPC(e,E7(t,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new N(z.UNKNOWN,o.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}};function pq(n,e,t,i){return new cd(n,e,t,i)}function gq(n,e){return S(this,null,function*(){let t=W(n),i={writes:e.map(r=>g2(t.serializer,r))};yield t.invokeRPC("Commit",t.serializer.databaseId,ze.emptyPath(),i)})}function vq(n,e){return S(this,null,function*(){let t=W(n),i={documents:e.map(a=>p2(t.serializer,a))},r=yield t.invokeStreamingRPC("BatchGetDocuments",t.serializer.databaseId,ze.emptyPath(),i,e.length),s=new Map;r.forEach(a=>{let c=CH(t.serializer,a);s.set(c.key.toString(),c)});let o=[];return e.forEach(a=>{let c=s.get(a.toString());ne(!!c),o.push(c)}),o})}function yq(n,e,t){let i=W(n);return i.verifyInitialized(),new od(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,t)}function wq(n,e,t){let i=W(n);return i.verifyInitialized(),new sd(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,t)}var bq="OnlineStateTracker",Ab=1,Db=10*1e3,ld=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){this.watchStreamFailures===0&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",Db,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${Db/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){this.state==="Online"?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=Ab&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${Ab} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e==="Online"&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(ft(t),this.shouldWarnClientIsOffline=!1):B(bq,t)}clearOnlineStateTimer(){this.onlineStateTimer!==null&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}};var z1="RemoteStore",_q=10,ud=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=s,this.connectivityMonitor.addCallback(o=>{i.enqueueAndForget(()=>S(this,null,function*(){Ps(this)&&(B(z1,"Restarting streams for network reachability change."),yield Hq(this))}))}),this.onlineStateTracker=new ld(i,r)}};function Cq(n,e,t,i,r){return new ud(n,e,t,i,r)}function Sq(n){let e=W(n);return e.offlineCauses.delete(0),L2(e)}function L2(n){return S(this,null,function*(){if(Ps(n))for(let e of n.onNetworkStatusChange)yield e(!0)})}function Tq(n){return S(this,null,function*(){let e=W(n);e.offlineCauses.add(0),yield Ra(e),e.onlineStateTracker.set("Offline")})}function Ra(n){return S(this,null,function*(){for(let e of n.onNetworkStatusChange)yield e(!1)})}function Eq(n){return S(this,null,function*(){let e=W(n);B(z1,"RemoteStore shutting down."),e.offlineCauses.add(5),yield Ra(e),e.connectivityMonitor.shutdown(),e.onlineStateTracker.set("Unknown")})}function q0(n,e){let t=W(n);t.listenTargets.has(e.targetId)||(t.listenTargets.set(e.targetId,e),pf(t)?mf(t):Na(t).isOpen()&&ff(t,e))}function La(n,e){let t=W(n),i=Na(t);t.listenTargets.delete(e),i.isOpen()&&AC(t,e),t.listenTargets.size===0&&(i.isOpen()?i.markIdle():Ps(t)&&t.onlineStateTracker.set("Unknown"))}function ff(n,e){if(n.watchChangeAggregator.recordPendingTargetRequest(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(oe.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Na(n).watch(e)}function AC(n,e){n.watchChangeAggregator.recordPendingTargetRequest(e),Na(n).unwatch(e)}function mf(n){n.watchChangeAggregator=new C7({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),getTargetDataForTarget:e=>n.listenTargets.get(e)||null,getDatabaseId:()=>n.datastore.serializer.databaseId}),Na(n).start(),n.onlineStateTracker.handleWatchStreamStart()}function pf(n){return Ps(n)&&!Na(n).isStarted()&&n.listenTargets.size>0}function Ps(n){return W(n).offlineCauses.size===0}function DC(n){n.watchChangeAggregator=void 0}function Mq(n){return S(this,null,function*(){n.onlineStateTracker.set("Online")})}function zq(n){return S(this,null,function*(){n.listenTargets.forEach((e,t)=>{ff(n,e)})})}function xq(n,e){return S(this,null,function*(){DC(n),pf(n)?(n.onlineStateTracker.handleWatchStreamFailure(e),mf(n)):n.onlineStateTracker.set("Unknown")})}function Oq(n,e,t){return S(this,null,function*(){if(n.onlineStateTracker.set("Online"),e instanceof K6&&e.state===2&&e.cause){try{yield Aq(n,e)}catch(i){B(z1,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield d0(n,i)}return}if(e instanceof ua?n.watchChangeAggregator.handleDocumentChange(e):e instanceof Y6?n.watchChangeAggregator.handleExistenceFilter(e):n.watchChangeAggregator.handleTargetChange(e),!t.isEqual(oe.min()))try{let i=yield _C(n.localStore);t.compareTo(i)>=0&&(yield Iq(n,t))}catch(i){B(z1,"Failed to raise snapshot:",i),yield d0(n,i)}})}function d0(n,e,t){return S(this,null,function*(){if(Ns(e))n.offlineCauses.add(1),yield Ra(n),n.onlineStateTracker.set("Offline"),t||(t=()=>_C(n.localStore)),n.asyncQueue.enqueueRetryable(()=>S(this,null,function*(){B(z1,"Retrying IndexedDB access"),yield t(),n.offlineCauses.delete(1),yield L2(n)}));else throw e})}function kC(n,e){return e().catch(t=>d0(n,t,e))}function Iq(n,e){let t=n.watchChangeAggregator.createRemoteEvent(e);return t.targetChanges.forEach((i,r)=>{if(i.resumeToken.approximateByteSize()>0){let s=n.listenTargets.get(r);s&&n.listenTargets.set(r,s.withResumeToken(i.resumeToken,e))}}),t.targetMismatches.forEach((i,r)=>{let s=n.listenTargets.get(i);if(!s)return;n.listenTargets.set(i,s.withResumeToken(Ot.EMPTY_BYTE_STRING,s.snapshotVersion)),AC(n,i);let o=new ba(s.target,i,r,s.sequenceNumber);ff(n,o)}),n.remoteSyncer.applyRemoteEvent(t)}function Aq(n,e){return S(this,null,function*(){let t=e.cause;for(let i of e.targetIds)n.listenTargets.has(i)&&(yield n.remoteSyncer.rejectListen(i,t),n.listenTargets.delete(i),n.watchChangeAggregator.removeTarget(i))})}function Va(n){return S(this,null,function*(){let e=W(n),t=Hs(e),i=e.writePipeline.length>0?e.writePipeline[e.writePipeline.length-1].batchId:Ts;for(;Dq(e);)try{let r=yield IF(e.localStore,i);if(r===null){e.writePipeline.length===0&&t.markIdle();break}else i=r.batchId,kq(e,r)}catch(r){yield d0(e,r)}RC(e)&&LC(e)})}function Dq(n){return Ps(n)&&n.writePipeline.length<_q}function kq(n,e){n.writePipeline.push(e);let t=Hs(n);t.isOpen()&&t.handshakeComplete&&t.writeMutations(e.mutations)}function RC(n){return Ps(n)&&!Hs(n).isStarted()&&n.writePipeline.length>0}function LC(n){Hs(n).start()}function Rq(n){return S(this,null,function*(){Hs(n).writeHandshake()})}function Lq(n){return S(this,null,function*(){let e=Hs(n);for(let t of n.writePipeline)e.writeMutations(t.mutations)})}function Vq(n,e,t){return S(this,null,function*(){let i=n.writePipeline.shift(),r=y7.from(i,e,t);yield kC(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield Va(n)})}function Nq(n,e){return S(this,null,function*(){e&&Hs(n).handshakeComplete&&(yield Pq(n,e)),RC(n)&&LC(n)})}function Pq(n,e){return S(this,null,function*(){if(sH(e.code)){let t=n.writePipeline.shift();Hs(n).inhibitBackoff(),yield kC(n,()=>n.remoteSyncer.rejectFailedWrite(t.batchId,e)),yield Va(n)}})}function Hq(n){return S(this,null,function*(){let e=W(n);e.offlineCauses.add(4),yield Ra(e),e.onlineStateTracker.set("Unknown"),e.offlineCauses.delete(4),yield L2(e)})}function kb(n,e){return S(this,null,function*(){let t=W(n);t.asyncQueue.verifyOperationInProgress(),B(z1,"RemoteStore received new credentials");let i=Ps(t);t.offlineCauses.add(3),yield Ra(t),i&&t.onlineStateTracker.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.offlineCauses.delete(3),yield L2(t)})}function hd(n,e){return S(this,null,function*(){let t=W(n);e?(t.offlineCauses.delete(2),yield L2(t)):e||(t.offlineCauses.add(2),yield Ra(t),t.onlineStateTracker.set("Unknown"))})}function Na(n){return n.watchStream||(n.watchStream=wq(n.datastore,n.asyncQueue,{onConnected:Mq.bind(null,n),onOpen:zq.bind(null,n),onClose:xq.bind(null,n),onWatchChange:Oq.bind(null,n)}),n.onNetworkStatusChange.push(e=>S(this,null,function*(){e?(n.watchStream.inhibitBackoff(),pf(n)?mf(n):n.onlineStateTracker.set("Unknown")):(yield n.watchStream.stop(),DC(n))}))),n.watchStream}function Hs(n){return n.writeStream||(n.writeStream=yq(n.datastore,n.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:Rq.bind(null,n),onClose:Nq.bind(null,n),onHandshakeComplete:Lq.bind(null,n),onMutationResult:Vq.bind(null,n)}),n.onNetworkStatusChange.push(e=>S(this,null,function*(){e?(n.writeStream.inhibitBackoff(),yield Va(n)):(yield n.writeStream.stop(),n.writePipeline.length>0&&(B(z1,`Stopping write stream with ${n.writePipeline.length} pending writes`),n.writePipeline=[]))}))),n.writeStream}var Bq="AsyncQueue",dd=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new kt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let o=Date.now()+i,a=new n(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new N(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Pa(n,e){if(ft(Bq,`${e}: ${n}`),Ns(n))return new N(z.UNAVAILABLE,`${e}: ${n}`);throw n}var f0=class n{constructor(e){e?this.comparator=(t,i)=>e(t,i)||j.comparator(t.key,i.key):this.comparator=(t,i)=>j.comparator(t.key,i.key),this.keyedMap=Y4(),this.sortedSet=new st(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var m0=class{constructor(){this.changeMap=new st(j.comparator)}track(e){let t=e.doc.key,i=this.changeMap.get(t);if(!i){this.changeMap=this.changeMap.insert(t,e);return}e.type!==0&&i.type===3?this.changeMap=this.changeMap.insert(t,e):e.type===3&&i.type!==1?this.changeMap=this.changeMap.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.changeMap=this.changeMap.remove(t):e.type===1&&i.type===2?this.changeMap=this.changeMap.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):Y()}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,i)=>{e.push(i)}),e}},Ta=class n{constructor(e,t,i,r,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,i,r,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,f0.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!A2(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var fd=class{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}};function Fq(){return new md}var md=class{constructor(){this.queries=VC(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){Gq(this,new N(z.ABORTED,"Firestore shutting down"))}};function VC(){return new rr(n=>k_(n),A2)}function gf(n,e){return S(this,null,function*(){let t=W(n),i=3,r=e.query,s=t.queries.get(r);s?!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(i=2):(s=new fd,i=e.listensToRemoteStore()?0:1);try{switch(i){case 0:s.viewSnap=yield t.onListen(r,!0);break;case 1:s.viewSnap=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r);break;default:break}}catch(o){let a=Pa(o,`Initialization of query '${ia(e.query)}' failed`);e.onError(a);return}t.queries.set(r,s),s.listeners.push(e),e.applyOnlineStateChange(t.onlineState),s.viewSnap&&e.onViewSnapshot(s.viewSnap)&&yf(t)})}function vf(n,e){return S(this,null,function*(){let t=W(n),i=e.query,r=3,s=t.queries.get(i);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),s.listeners.length===0?r=e.listensToRemoteStore()?0:1:!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function qq(n,e){let t=W(n),i=!1;for(let r of e){let s=r.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.onViewSnapshot(r)&&(i=!0);o.viewSnap=r}}i&&yf(t)}function Uq(n,e,t){let i=W(n),r=i.queries.get(e);if(r)for(let s of r.listeners)s.onError(t);i.queries.delete(e)}function jq(n,e){let t=W(n);t.onlineState=e;let i=!1;t.queries.forEach((r,s)=>{for(let o of s.listeners)o.applyOnlineStateChange(e)&&(i=!0)}),i&&yf(t)}function Wq(n,e){W(n).snapshotsInSyncListeners.add(e),e.next()}function $q(n,e){W(n).snapshotsInSyncListeners.delete(e)}function Gq(n,e){let t=W(n),i=t.queries;t.queries=VC(),i.forEach((r,s)=>{for(let o of s.listeners)o.onError(e)})}function yf(n){n.snapshotsInSyncListeners.forEach(e=>{e.next()})}var NC=function(n){return n.Default="default",n.Cache="cache",n}(NC||{}),C2=class{constructor(e,t,i){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=i||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Ta(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache||!this.listensToRemoteStore())return!0;let i=t!=="Offline";return this.options.waitForSyncWhenOnline&&i?!1:!e.docs.isEmpty()||e.hasCachedResults||t==="Offline"}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return e.syncStateChanged||t?this.options.includeMetadataChanges===!0:!1}raiseInitialEvent(e){e=Ta.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==NC.Cache}};var pd=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.addedKeys=i,this.removedKeys=r}static fromSnapshot(e,t){let i=pe(),r=pe();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key);break}return new n(e,t.fromCache,i,r)}};var p0=class{constructor(e){this.serializer=e}toDocumentKey(e){return tr(this.serializer,e)}toMutableDocument(e){return e.metadata.exists?nC(this.serializer,e.document,!1):Rt.newNoDocument(this.toDocumentKey(e.metadata.name),this.toSnapshotVersion(e.metadata.readTime))}toSnapshotVersion(e){return zt(e)}},gd=class{constructor(e,t,i){this.bundleMetadata=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=PC(e)}addSizedElement(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;let i=ze.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}getQueryDocumentMapping(e){let t=new Map,i=new p0(this.serializer);for(let r of e)if(r.metadata.queries){let s=i.toDocumentKey(r.metadata.name);for(let o of r.metadata.queries){let a=(t.get(o)||pe()).add(s);t.set(o,a)}}return t}complete(){return S(this,null,function*(){let e=yield PF(this.localStore,new p0(this.serializer),this.documents,this.bundleMetadata.id),t=this.getQueryDocumentMapping(this.documents);for(let i of this.queries)yield qF(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:e}})}};function PC(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}function Yq(n){return{taskState:"Success",documentsLoaded:n.totalDocuments,bytesLoaded:n.totalBytes,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var g0=class{constructor(e){this.key=e}},v0=class{constructor(e){this.key=e}},y0=class{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=pe(),this.mutatedKeys=pe(),this.docComparator=L_(e),this.documentSet=new f0(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let i=t?t.changeSet:new m0,r=t?t.documentSet:this.documentSet,s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1,c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{let d=r.get(u),g=D2(this.query,h)?h:null,_=d?this.mutatedKeys.has(d.key):!1,T=g?g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations:!1,E=!1;d&&g?d.data.isEqual(g.data)?_!==T&&(i.track({type:3,doc:g}),E=!0):this.shouldWaitForSyncedDocument(d,g)||(i.track({type:2,doc:g}),E=!0,(c&&this.docComparator(g,c)>0||l&&this.docComparator(g,l)<0)&&(a=!0)):!d&&g?(i.track({type:0,doc:g}),E=!0):d&&!g&&(i.track({type:1,doc:d}),E=!0,(c||l)&&(a=!0)),E&&(g?(o=o.add(g),T?s=s.add(u):s=s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{documentSet:o,changeSet:i,needsRefill:a,mutatedKeys:s}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let o=e.changeSet.getChanges();o.sort((h,d)=>Kq(h.type,d.type)||this.docComparator(h.doc,d.doc)),this.applyTargetChange(i),r=r??!1;let a=t&&!r?this.updateLimboDocuments():[],l=this.limboDocuments.size===0&&this.current&&!r?1:0,u=l!==this.syncState;return this.syncState=l,o.length===0&&!u?{limboChanges:a}:{snapshot:new Ta(this.query,e.documentSet,s,o,e.mutatedKeys,l===0,u,!1,i?i.resumeToken.approximateByteSize()>0:!1),limboChanges:a}}applyOnlineStateChange(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new m0,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!(this._syncedDocuments.has(e)||!this.documentSet.has(e)||this.documentSet.get(e).hasLocalMutations)}applyTargetChange(e){e&&(e.addedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.delete(t)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=pe(),this.documentSet.forEach(i=>{this.shouldBeInLimbo(i.key)&&(this.limboDocuments=this.limboDocuments.add(i.key))});let t=[];return e.forEach(i=>{this.limboDocuments.has(i)||t.push(new v0(i))}),this.limboDocuments.forEach(i=>{e.has(i)||t.push(new g0(i))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=pe();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return Ta.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===0,this.hasCachedResults)}};function Kq(n,e){let t=i=>{switch(i){case 0:return 1;case 2:return 2;case 3:return 2;case 1:return 0;default:return Y()}};return t(n)-t(e)}var Bs="SyncEngine",vd=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},yd=class{constructor(e){this.key=e,this.receivedDocument=!1}},wd=class{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.syncEngineListener={},this.queryViewsByQuery=new rr(a=>k_(a),A2),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new st(j.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new y2,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=_a.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return this._isPrimaryClient===!0}};function Qq(n,e,t,i,r,s,o){let a=new wd(n,e,t,i,r,s);return o&&(a._isPrimaryClient=!0),a}function Xq(n,e,t=!0){return S(this,null,function*(){let i=U0(n),r,s=i.queryViewsByQuery.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.computeInitialSnapshot()):r=yield HC(i,e,t,!0),r})}function Zq(n,e){return S(this,null,function*(){let t=U0(n);yield HC(t,e,!0,!1)})}function HC(n,e,t,i){return S(this,null,function*(){let r=yield Ca(n.localStore,fn(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return i&&(a=yield wf(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&q0(n.remoteStore,r),a})}function wf(n,e,t,i,r){return S(this,null,function*(){n.applyDocChanges=(h,d,g)=>lU(n,h,d,g);let s=yield F0(n.localStore,e,!0),o=new y0(e,s.remoteKeys),a=o.computeDocChanges(s.documents),c=m2.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),l=o.applyChanges(a,n.isPrimaryClient,c);Cf(n,t,l.limboChanges);let u=new vd(e,t,o);return n.queryViewsByQuery.set(e,u),n.queriesByTarget.has(t)?n.queriesByTarget.get(t).push(e):n.queriesByTarget.set(t,[e]),l.snapshot})}function Jq(n,e,t){return S(this,null,function*(){let i=W(n),r=i.queryViewsByQuery.get(e),s=i.queriesByTarget.get(r.targetId);if(s.length>1){i.queriesByTarget.set(r.targetId,s.filter(o=>!A2(o,e))),i.queryViewsByQuery.delete(e);return}i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Sa(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&La(i.remoteStore,r.targetId),Ea(i,r.targetId)}).catch(Vs))):(Ea(i,r.targetId),yield Sa(i.localStore,r.targetId,!0))})}function eU(n,e){return S(this,null,function*(){let t=W(n),i=t.queryViewsByQuery.get(e),r=t.queriesByTarget.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),La(t.remoteStore,i.targetId))})}function tU(n,e,t){return S(this,null,function*(){let i=Tf(n);try{let r=yield CF(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),aU(i,r.batchId,t),yield kr(i,r.changes),yield Va(i.remoteStore)}catch(r){let s=Pa(r,"Failed to persist write");t.reject(s)}})}function BC(n,e){return S(this,null,function*(){let t=W(n);try{let i=yield zF(t.localStore,e);e.targetChanges.forEach((r,s)=>{let o=t.activeLimboResolutionsByTarget.get(s);o&&(ne(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.receivedDocument=!0:r.modifiedDocuments.size>0?ne(o.receivedDocument):r.removedDocuments.size>0&&(ne(o.receivedDocument),o.receivedDocument=!1))}),yield kr(t,i,e)}catch(i){yield Vs(i)}})}function Rb(n,e,t){let i=W(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.queryViewsByQuery.forEach((s,o)=>{let a=o.view.applyOnlineStateChange(e);a.snapshot&&r.push(a.snapshot)}),jq(i.eventManager,e),r.length&&i.syncEngineListener.onWatchChange(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function nU(n,e,t){return S(this,null,function*(){let i=W(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.activeLimboResolutionsByTarget.get(e),s=r&&r.key;if(s){let o=new st(j.comparator);o=o.insert(s,Rt.newNoDocument(s,oe.min()));let a=pe().add(s),c=new f2(oe.min(),new Map,new st(fe),o,a);yield BC(i,c),i.activeLimboTargetsByKey=i.activeLimboTargetsByKey.remove(s),i.activeLimboResolutionsByTarget.delete(e),Sf(i)}else yield Sa(i.localStore,e,!1).then(()=>Ea(i,e,t)).catch(Vs)})}function iU(n,e){return S(this,null,function*(){let t=W(n),i=e.batch.batchId;try{let r=yield SF(t.localStore,e);_f(t,i,null),bf(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield kr(t,r)}catch(r){yield Vs(r)}})}function rU(n,e,t){return S(this,null,function*(){let i=W(n);try{let r=yield EF(i.localStore,e);_f(i,e,t),bf(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield kr(i,r)}catch(r){yield Vs(r)}})}function sU(n,e){return S(this,null,function*(){let t=W(n);Ps(t.remoteStore)||B(Bs,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let i=yield MF(t.localStore);if(i===Ts){e.resolve();return}let r=t.pendingWritesCallbacks.get(i)||[];r.push(e),t.pendingWritesCallbacks.set(i,r)}catch(i){let r=Pa(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}})}function bf(n,e){(n.pendingWritesCallbacks.get(e)||[]).forEach(t=>{t.resolve()}),n.pendingWritesCallbacks.delete(e)}function oU(n,e){n.pendingWritesCallbacks.forEach(t=>{t.forEach(i=>{i.reject(new N(z.CANCELLED,e))})}),n.pendingWritesCallbacks.clear()}function aU(n,e,t){let i=n.mutationUserCallbacks[n.currentUser.toKey()];i||(i=new st(fe)),i=i.insert(e,t),n.mutationUserCallbacks[n.currentUser.toKey()]=i}function _f(n,e,t){let i=W(n),r=i.mutationUserCallbacks[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.mutationUserCallbacks[i.currentUser.toKey()]=r}}function Ea(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.queriesByTarget.get(e))n.queryViewsByQuery.delete(i),t&&n.syncEngineListener.onWatchError(i,t);n.queriesByTarget.delete(e),n.isPrimaryClient&&n.limboDocumentRefs.removeReferencesForId(e).forEach(r=>{n.limboDocumentRefs.containsKey(r)||FC(n,r)})}function FC(n,e){n.enqueuedLimboResolutions.delete(e.path.canonicalString());let t=n.activeLimboTargetsByKey.get(e);t!==null&&(La(n.remoteStore,t),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(e),n.activeLimboResolutionsByTarget.delete(t),Sf(n))}function Cf(n,e,t){for(let i of t)i instanceof g0?(n.limboDocumentRefs.addReference(i.key,e),cU(n,i)):i instanceof v0?(B(Bs,"Document no longer in limbo: "+i.key),n.limboDocumentRefs.removeReference(i.key,e),n.limboDocumentRefs.containsKey(i.key)||FC(n,i.key)):Y()}function cU(n,e){let t=e.key,i=t.path.canonicalString();!n.activeLimboTargetsByKey.get(t)&&!n.enqueuedLimboResolutions.has(i)&&(B(Bs,"New document in limbo: "+t),n.enqueuedLimboResolutions.add(i),Sf(n))}function Sf(n){for(;n.enqueuedLimboResolutions.size>0&&n.activeLimboTargetsByKey.size<n.maxConcurrentLimboResolutions;){let e=n.enqueuedLimboResolutions.values().next().value;n.enqueuedLimboResolutions.delete(e);let t=new j(ze.fromString(e)),i=n.limboTargetIdGenerator.next();n.activeLimboResolutionsByTarget.set(i,new yd(t)),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.insert(t,i),q0(n.remoteStore,new ba(fn(ka(t.path)),i,"TargetPurposeLimboResolution",Pn.INVALID))}}function kr(n,e,t){return S(this,null,function*(){let i=W(n),r=[],s=[],o=[];i.queryViewsByQuery.isEmpty()||(i.queryViewsByQuery.forEach((a,c)=>{o.push(i.applyDocChanges(c,e,t).then(l=>{var u;if((l||t)&&i.isPrimaryClient){let h=l?!l.fromCache:(u=t?.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;i.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){r.push(l);let h=pd.fromSnapshot(c.targetId,l);s.push(h)}}))}),yield Promise.all(o),i.syncEngineListener.onWatchChange(r),yield OF(i.localStore,s))})}function lU(n,e,t,i){return S(this,null,function*(){let r=e.view.computeDocChanges(t);r.needsRefill&&(r=yield F0(n.localStore,e.query,!1).then(({documents:c})=>e.view.computeDocChanges(c,r)));let s=i&&i.targetChanges.get(e.targetId),o=i&&i.targetMismatches.get(e.targetId)!=null,a=e.view.applyChanges(r,n.isPrimaryClient,s,o);return Cf(n,e.targetId,a.limboChanges),a.snapshot})}function uU(n,e){return S(this,null,function*(){let t=W(n);if(!t.currentUser.isEqual(e)){B(Bs,"User change. New user:",e.toKey());let r=yield bC(t.localStore,e);t.currentUser=e,oU(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield kr(t,r.affectedDocuments)}})}function hU(n,e){let t=W(n),i=t.activeLimboResolutionsByTarget.get(e);if(i&&i.receivedDocument)return pe().add(i.key);{let r=pe(),s=t.queriesByTarget.get(e);if(!s)return r;for(let o of s){let a=t.queryViewsByQuery.get(o);r=r.unionWith(a.view.syncedDocuments)}return r}}function dU(n,e){return S(this,null,function*(){let t=W(n),i=yield F0(t.localStore,e.query,!0),r=e.view.synchronizeWithPersistedState(i);return t.isPrimaryClient&&Cf(t,e.targetId,r.limboChanges),r})}function fU(n,e){return S(this,null,function*(){let t=W(n);return TC(t.localStore,e).then(i=>kr(t,i))})}function mU(n,e,t,i){return S(this,null,function*(){let r=W(n),s=yield RF(r.localStore,e);if(s===null){B(Bs,"Cannot apply mutation batch with id: "+e);return}t==="pending"?yield Va(r.remoteStore):t==="acknowledged"||t==="rejected"?(_f(r,e,i||null),bf(r,e),LF(r.localStore,e)):Y(),yield kr(r,s)})}function pU(n,e){return S(this,null,function*(){let t=W(n);if(U0(t),Tf(t),e===!0&&t._isPrimaryClient!==!0){let i=t.sharedClientState.getAllActiveQueryTargets(),r=yield Lb(t,i.toArray());t._isPrimaryClient=!0,yield hd(t.remoteStore,!0);for(let s of r)q0(t.remoteStore,s)}else if(e===!1&&t._isPrimaryClient!==!1){let i=[],r=Promise.resolve();t.queriesByTarget.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?i.push(o):r=r.then(()=>(Ea(t,o),Sa(t.localStore,o,!0))),La(t.remoteStore,o)}),yield r,yield Lb(t,i),gU(t),t._isPrimaryClient=!1,yield hd(t.remoteStore,!1)}})}function gU(n){let e=W(n);e.activeLimboResolutionsByTarget.forEach((t,i)=>{La(e.remoteStore,i)}),e.limboDocumentRefs.removeAllReferences(),e.activeLimboResolutionsByTarget=new Map,e.activeLimboTargetsByKey=new st(j.comparator)}function Lb(n,e,t){return S(this,null,function*(){let i=W(n),r=[],s=[];for(let o of e){let a,c=i.queriesByTarget.get(o);if(c&&c.length!==0){a=yield Ca(i.localStore,fn(c[0]));for(let l of c){let u=i.queryViewsByQuery.get(l),h=yield dU(i,u);h.snapshot&&s.push(h.snapshot)}}else{let l=yield SC(i.localStore,o);a=yield Ca(i.localStore,l),yield wf(i,qC(l),o,!1,a.resumeToken)}r.push(a)}return i.syncEngineListener.onWatchChange(s),r})}function qC(n){return D_(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function vU(n){let e=W(n);return VF(e.localStore)}function yU(n,e,t,i){return S(this,null,function*(){let r=W(n);if(r._isPrimaryClient){B(Bs,"Ignoring unexpected query state notification.");return}let s=r.queriesByTarget.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield TC(r.localStore,R_(s[0])),a=f2.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ot.EMPTY_BYTE_STRING);yield kr(r,o,a);break}case"rejected":{yield Sa(r.localStore,e,!0),Ea(r,e,i);break}default:Y()}})}function wU(n,e,t){return S(this,null,function*(){let i=U0(n);if(i._isPrimaryClient){for(let r of e){if(i.queriesByTarget.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){B(Bs,"Adding an already active target "+r);continue}let o=yield SC(i.localStore,r),a=yield Ca(i.localStore,o);yield wf(i,qC(o),a.targetId,!1,a.resumeToken),q0(i.remoteStore,a)}for(let r of t)i.queriesByTarget.has(r)&&(yield Sa(i.localStore,r,!1).then(()=>{La(i.remoteStore,r),Ea(i,r)}).catch(Vs))}})}function U0(n){let e=W(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=BC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nU.bind(null,e),e.syncEngineListener.onWatchChange=qq.bind(null,e.eventManager),e.syncEngineListener.onWatchError=Uq.bind(null,e.eventManager),e}function Tf(n){let e=W(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=iU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rU.bind(null,e),e}function bU(n,e,t){let i=W(n);_U(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}function _U(n,e,t){return S(this,null,function*(){try{let i=yield e.getMetadata();if(yield HF(n.localStore,i))return yield e.close(),t._completeWith(Yq(i)),Promise.resolve(new Set);t._updateProgress(PC(i));let s=new gd(i,n.localStore,e.serializer),o=yield e.nextElement();for(;o;){let c=yield s.addSizedElement(o);c&&t._updateProgress(c),o=yield e.nextElement()}let a=yield s.complete();return yield kr(n,a.changedDocs,void 0),yield BF(n.localStore,i),t._completeWith(a.progress),Promise.resolve(a.changedCollectionGroups)}catch(i){return Ti(Bs,`Loading bundle failed with ${i}`),t._failWith(i),Promise.resolve(new Set)}})}var bd=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return S(this,null,function*(){this.serializer=R2(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),yield this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)})}createGarbageCollectionScheduler(t,i){return null}createIndexBackfillerScheduler(t,i){return null}createLocalStore(t){return wC(this.persistence,new a0,t.initialUser,this.serializer)}createPersistence(t){return new s0(o0.factory,this.serializer)}createSharedClientState(t){return new u0}terminate(){return S(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var w0=class n extends bd{constructor(e,t,i){super(),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return S(this,null,function*(){yield tl(n.prototype,this,"initialize").call(this,e),yield this.onlineComponentProvider.initialize(this,e),yield Tf(this.onlineComponentProvider.syncEngine),yield Va(this.onlineComponentProvider.remoteStore),yield this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return wC(this.persistence,new a0,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let i=this.persistence.referenceDelegate.garbageCollector;return new P7(i,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let i=new J5(t,this.persistence);return new Z5(e.asyncQueue,i)}createPersistence(e){let t=hf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?ii.withCacheSize(this.cacheSizeBytes):ii.DEFAULT;return new J7(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,IC(),cq(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new u0}},_d=class n extends w0{constructor(e,t){super(e,t,!1),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return S(this,null,function*(){yield tl(n.prototype,this,"initialize").call(this,e);let t=this.onlineComponentProvider.syncEngine;this.sharedClientState instanceof t2&&(this.sharedClientState.syncEngine={applyBatchState:mU.bind(null,t),applyTargetState:yU.bind(null,t),applyActiveTargetsChange:wU.bind(null,t),getActiveClients:vU.bind(null,t),synchronizeWithChangedDocuments:fU.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.setPrimaryStateListener(i=>S(this,null,function*(){yield pU(this.onlineComponentProvider.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=IC();if(!t2.isAvailable(t))throw new N(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let i=hf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new t2(t,e.asyncQueue,i,e.clientId,e.initialUser)}},Ef=(()=>{class n{initialize(t,i){return S(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Rb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=uU.bind(null,this.syncEngine),yield hd(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return Fq()}createDatastore(t){let i=R2(t.databaseInfo.databaseId),r=oq(t.databaseInfo);return pq(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return Cq(this.localStore,this.datastore,t.asyncQueue,i=>Rb(this.syncEngine,i,0),aq())}createSyncEngine(t,i){return Qq(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return S(this,null,function*(){var t,i;yield Eq(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}n.provider={build:()=>new n};return n})(),CU=10240;function SU(n,e=CU){let t=0;return{read(){return S(this,null,function*(){if(t<n.byteLength){let s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}})},cancel(){return S(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}function Mf(n,e,t){if(!t)throw new N(z.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function zf(n,e,t,i){if(e===!0&&i===!0)throw new N(z.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Vb(n){if(!j.isDocumentKey(n))throw new N(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Nb(n){if(j.isDocumentKey(n))throw new N(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function TU(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function V2(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=EU(n);return e?`a custom ${e} object`:"an object"}}else return typeof n=="function"?"a function":Y()}function EU(n){return n.constructor?n.constructor.name:null}function Ie(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new N(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=V2(n);throw new N(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function UC(n,e){if(e<=0)throw new N(z.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function MU(n,e){if(!(n instanceof Uint8Array))throw new N(z.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${V2(n)}`);return SU(n,e)}var Ma=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,e):ft("Uncaught Error in snapshot listener:",e.toString()))}mute(){this.muted=!0}scheduleEvent(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Cd=class{constructor(e,t){this.payload=e,this.byteLength=t}isBundleMetadata(){return"metadata"in this.payload}};var Sd=class{constructor(e,t){this.reader=e,this.serializer=t,this.metadata=new kt,this.buffer=new Uint8Array,this.textDecoder=oH(),this.nextElementImpl().then(i=>{i&&i.isBundleMetadata()?this.metadata.resolve(i.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i?.payload)}`))},i=>this.metadata.reject(i))}close(){return this.reader.cancel()}getMetadata(){return S(this,null,function*(){return this.metadata.promise})}nextElement(){return S(this,null,function*(){return yield this.getMetadata(),this.nextElementImpl()})}nextElementImpl(){return S(this,null,function*(){let e=yield this.readLength();if(e===null)return null;let t=this.textDecoder.decode(e),i=Number(t);isNaN(i)&&this.raiseError(`length string (${t}) is not valid number`);let r=yield this.readJsonString(i);return new Cd(JSON.parse(r),e.length+i)})}indexOfOpenBracket(){return this.buffer.findIndex(e=>e===123)}readLength(){return S(this,null,function*(){for(;this.indexOfOpenBracket()<0&&!(yield this.pullMoreDataToBuffer()););if(this.buffer.length===0)return null;let e=this.indexOfOpenBracket();e<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}readJsonString(e){return S(this,null,function*(){for(;this.buffer.length<e;)(yield this.pullMoreDataToBuffer())&&this.raiseError("Reached the end of bundle when more is expected.");let t=this.textDecoder.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}raiseError(e){throw this.reader.cancel(),new Error(`Invalid bundle format: ${e}`)}pullMoreDataToBuffer(){return S(this,null,function*(){let e=yield this.reader.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};function zU(n,e){return new Sd(n,e)}var Td=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return S(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new N(z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield vq(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new ks(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return S(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{let r=j.fromPath(i);this.mutations.push(new u2(r,this.precondition(r)))}),yield gq(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else if(e.isNoDocument())t=oe.min();else throw Y();let i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new N(z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(oe.min())?_t.exists(!1):_t.updateTime(t):_t.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(oe.min()))throw new N(z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _t.updateTime(t)}else return _t.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Ed=class{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.attemptsRemaining=i.maxAttempts,this.backoff=new _2(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(()=>S(this,null,function*(){let e=new Td(this.datastore),t=this.tryRunUpdateFunction(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.handleTransactionError(r)}))}).catch(i=>{this.handleTransactionError(i)})}))}tryRunUpdateFunction(e){try{let t=this.updateFunction(e);return O2(t)||!t.catch||!t.then?(this.deferred.reject(Error("Transaction callback must return a Promise")),null):t}catch(t){return this.deferred.reject(t),null}}handleTransactionError(e){this.attemptsRemaining>0&&this.isRetryableTransactionError(e)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(e)}isRetryableTransactionError(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!K_(t)}return!1}};var Rs="FirestoreClient",xU=100,OU=11,IU=20,AU=22,Md=class{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Lt.UNAUTHENTICATED,this.clientId=P6.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,o=>S(this,null,function*(){B(Rs,"Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,o=>(B(Rs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:xU}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new kt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>S(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=Pa(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function F5(n,e){return S(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),B(Rs,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>S(this,null,function*(){i.isEqual(r)||(yield bC(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Pb(n,e){return S(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield xf(n);B(Rs,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>kb(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>kb(e.remoteStore,r)),n._onlineComponents=e})}function DU(n){return n.name==="FirebaseError"?n.code===z.FAILED_PRECONDITION||n.code===z.UNIMPLEMENTED:typeof DOMException<"u"&&n instanceof DOMException?n.code===AU||n.code===IU||n.code===OU:!0}function xf(n){return S(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){B(Rs,"Using user provided OfflineComponentProvider");try{yield F5(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!DU(t))throw t;Ti("Error using user provided cache. Falling back to memory cache: "+t),yield F5(n,new bd)}}else B(Rs,"Using default OfflineComponentProvider"),yield F5(n,new bd);return n._offlineComponents})}function j0(n){return S(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(B(Rs,"Using user provided OnlineComponentProvider"),yield Pb(n,n._uninitializedComponentsProvider._online)):(B(Rs,"Using default OnlineComponentProvider"),yield Pb(n,new Ef))),n._onlineComponents})}function jC(n){return xf(n).then(e=>e.persistence)}function Of(n){return xf(n).then(e=>e.localStore)}function WC(n){return j0(n).then(e=>e.remoteStore)}function If(n){return j0(n).then(e=>e.syncEngine)}function kU(n){return j0(n).then(e=>e.datastore)}function za(n){return S(this,null,function*(){let e=yield j0(n),t=e.eventManager;return t.onListen=Xq.bind(null,e.syncEngine),t.onUnlisten=Jq.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Zq.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=eU.bind(null,e.syncEngine),t})}function RU(n){return n.asyncQueue.enqueue(()=>S(this,null,function*(){let e=yield jC(n),t=yield WC(n);return e.setNetworkEnabled(!0),Sq(t)}))}function LU(n){return n.asyncQueue.enqueue(()=>S(this,null,function*(){let e=yield jC(n),t=yield WC(n);return e.setNetworkEnabled(!1),Tq(t)}))}function VU(n){let e=new kt;return n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let t=yield If(n);return sU(t,e)})),e.promise}function NU(n,e,t,i){let r=new Ma(i),s=new C2(e,r,t);return n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let o=yield za(n);return gf(o,s)})),()=>{r.mute(),n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let o=yield za(n);return vf(o,s)}))}}function PU(n,e){let t=new kt;return n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let i=yield Of(n);return UU(i,e,t)})),t.promise}function $C(n,e,t={}){let i=new kt;return n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let r=yield za(n);return jU(r,n.asyncQueue,e,t,i)})),i.promise}function HU(n,e){let t=new kt;return n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let i=yield Of(n);return WU(i,e,t)})),t.promise}function GC(n,e,t={}){let i=new kt;return n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let r=yield za(n);return $U(r,n.asyncQueue,e,t,i)})),i.promise}function BU(n,e){let t=new kt;return n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let i=yield If(n);return tU(i,e,t)})),t.promise}function FU(n,e){let t=new Ma(e);return n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let i=yield za(n);return Wq(i,t)})),()=>{t.mute(),n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let i=yield za(n);return $q(i,t)}))}}function qU(n,e,t){let i=new kt;return n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){let r=yield kU(n);new Ed(n.asyncQueue,r,t,e,i).run()})),i.promise}function UU(n,e,t){return S(this,null,function*(){try{let i=yield AF(n,e);i.isFoundDocument()?t.resolve(i):i.isNoDocument()?t.resolve(null):t.reject(new N(z.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(i){let r=Pa(i,`Failed to get document '${e} from cache`);t.reject(r)}})}function jU(n,e,t,i,r){let s=new Ma({next:a=>{s.mute(),e.enqueueAndForget(()=>vf(n,o));let c=a.docs.has(t);!c&&a.fromCache?r.reject(new N(z.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&i&&i.source==="server"?r.reject(new N(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(a)},error:a=>r.reject(a)}),o=new C2(ka(t.path),s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return gf(n,o)}function WU(n,e,t){return S(this,null,function*(){try{let i=yield F0(n,e,!0),r=new y0(e,i.remoteKeys),s=r.computeDocChanges(i.documents),o=r.applyChanges(s,!1);t.resolve(o.snapshot)}catch(i){let r=Pa(i,`Failed to execute query '${e} against cache`);t.reject(r)}})}function $U(n,e,t,i,r){let s=new Ma({next:a=>{s.mute(),e.enqueueAndForget(()=>vf(n,o)),a.fromCache&&i.source==="server"?r.reject(new N(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(a)},error:a=>r.reject(a)}),o=new C2(t,s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return gf(n,o)}function GU(n,e,t,i){let r=KU(t,R2(e));n.asyncQueue.enqueueAndForget(()=>S(this,null,function*(){bU(yield If(n),r,i)}))}function YU(n,e){return n.asyncQueue.enqueue(()=>S(this,null,function*(){return FF(yield Of(n),e)}))}function KU(n,e){let t;return typeof n=="string"?t=Q_().encode(n):t=n,zU(MU(t),e)}function QU(n,e){return n.timeoutSeconds===e.timeoutSeconds}function YC(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var XU="ComponentProvider",Hb=new Map;function ZU(n){let e=Hb.get(n);e&&(B(XU,"Removing Datastore"),Hb.delete(n),e.terminate())}function JU(n,e,t,i){return new s7(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,YC(i.experimentalLongPollingOptions),i.useFetchStreams)}var KC="firestore.googleapis.com",Bb=!0,Fb=5,qb=30,ej=!0,b0=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new N(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=KC,this.ssl=Bb}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Bb;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=gC;else{if(e.cacheSizeBytes!==k2&&e.cacheSizeBytes<Cb)throw new N(z.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${Cb}`);this.cacheSizeBytes=e.cacheSizeBytes}zf("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=ej:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=YC((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),tj(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&QU(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function tj(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new N(z.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<Fb)throw new N(z.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is ${Fb})`);if(n.timeoutSeconds>qb)throw new N(z.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is ${qb})`)}}var x1=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new b0({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new N(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new N(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new b0(e),e.credentials!==void 0&&(this._authCredentials=jV(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return S(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return ZU(this),Promise.resolve()}};function QC(n,e,t,i={}){var r;n=Ie(n,x1);let s=n._getSettings(),o=`${e}:${t}`;if(s.host!==KC&&s.host!==o&&Ti("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,c;if(typeof i.mockUserToken=="string")a=i.mockUserToken,c=Lt.MOCK_USER;else{a=tp(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let l=i.mockUserToken.sub||i.mockUserToken.user_id;if(!l)throw new N(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Lt(l)}n._authCredentials=new U5(new N6(a,c))}}var Yt=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},tt=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new nr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},nr=class n extends Yt{constructor(e,t,i){super(e,t,ka(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new tt(this.firestore,null,new j(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Af(n,e,...t){if(n=dt(n),Mf("collection","path",e),n instanceof x1){let i=ze.fromString(e,...t);return Nb(i),new nr(n,null,i)}else{if(!(n instanceof tt)&&!(n instanceof nr))throw new N(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(ze.fromString(e,...t));return Nb(i),new nr(n.firestore,null,i)}}function XC(n,e){if(n=Ie(n,x1),Mf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new N(z.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Yt(n,null,xP(e))}function N2(n,e,...t){if(n=dt(n),arguments.length===1&&(e=P6.newId()),Mf("doc","path",e),n instanceof x1){let i=ze.fromString(e,...t);return Vb(i),new tt(n,null,new j(i))}else{if(!(n instanceof tt)&&!(n instanceof nr))throw new N(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(ze.fromString(e,...t));return Vb(i),new tt(n.firestore,n instanceof nr?n.converter:null,new j(i))}}function Df(n,e){return n=dt(n),e=dt(e),(n instanceof tt||n instanceof nr)&&(e instanceof tt||e instanceof nr)?n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter:!1}function kf(n,e){return n=dt(n),e=dt(e),n instanceof Yt&&e instanceof Yt?n.firestore===e.firestore&&A2(n._query,e._query)&&n.converter===e.converter:!1}var nj="AsyncQueue",_0=class{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new _2(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new kt;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}retryNextOp(){return S(this,null,function*(){if(this.retryableOps.length!==0){try{yield this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(Ns(e))B(nj,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}})}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(i=>{this.failure=i,this.operationInProgress=!1;let r=ij(i);throw ft("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.operationInProgress=!1,i))));return this.tail=t,t}enqueueAfterDelay(e,t,i){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let r=dd.createAndSchedule(this,e,t,i,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(r),r}verifyNotFailed(){this.failure&&Y()}verifyOperationInProgress(){}drain(){return S(this,null,function*(){let e;do e=this.tail,yield e;while(e!==this.tail)})}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.delayedOperations)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}};function ij(n){let e=n.message||"";return n.stack&&(n.stack.includes(n.message)?e=n.stack:e=n.message+`
`+n.stack),e}var zd=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new kt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var ZC=k2,pt=class extends x1{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new _0,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return S(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new _0(e),this._firestoreClient=void 0,yield e}})}};function Kt(n){if(n._terminated)throw new N(z.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||JC(n),n._firestoreClient}function JC(n){var e,t,i;let r=n._freezeSettings(),s=JU(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new Md(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&rj(n._componentsProvider))}function rj(n){let e=n?._online.build();return{_offline:n?._offline.build(e),_online:e}}function eS(n,e){Ti("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return nS(n,Ef.provider,{build:i=>new w0(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function tS(n){return S(this,null,function*(){Ti("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();nS(n,Ef.provider,{build:t=>new _d(t,e.cacheSizeBytes)})})}function nS(n,e,t){if(n=Ie(n,pt),n._firestoreClient||n._terminated)throw new N(z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new N(z.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},JC(n)}function iS(n){if(n._initialized&&!n._terminated)throw new N(z.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new kt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>S(this,null,function*(){try{yield wF(hf(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function rS(n){n=Ie(n,pt);let e=Kt(n);return VU(e)}function sS(n){n=Ie(n,pt);let e=Kt(n);return RU(e)}function oS(n){n=Ie(n,pt);let e=Kt(n);return LU(e)}function aS(n,e){n=Ie(n,pt);let t=Kt(n),i=new zd;return GU(t,n._databaseId,e,i),i}function cS(n,e){n=Ie(n,pt);let t=Kt(n);return YU(t,e).then(i=>i?new Yt(n,null,i.query):null)}function sj(n,e=!0){qV(rp),c4(new Xs("firestore",(t,{instanceIdentifier:i,options:r})=>{let s=t.getProvider("app").getImmediate(),o=new pt(new j5(t.getProvider("auth-internal")),new Y5(t.getProvider("app-check-internal")),FN(s,i),s);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),Ur(Rw,Lw,n),Ur(Rw,Lw,"esm2017")}var sr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ot.fromBase64String(e))}catch(t){throw new N(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ot.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var xi=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new N(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ir=class{constructor(e){this._methodName=e}};var O1=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new N(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new N(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return fe(this._lat,e._lat)||fe(this._long,e._long)}};var S2=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return bF(this._values,e._values)}};var oj=/^__.*__$/,xd=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new zi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ds(e,this.data,t,this.fieldTransforms)}},C0=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new zi(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function lS(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}var S0=class n{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.contextWith({path:i,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.contextWith({path:i,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return T0(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(lS(this.dataSource)&&oj.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},Od=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||R2(e)}createContext(e,t,i,r=!1){return new S0({dataSource:e,methodName:t,targetDoc:i,path:xt.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function R1(n){let e=n._freezeSettings(),t=R2(n._databaseId);return new Od(n._databaseId,!!e.ignoreUndefinedProperties,t)}function W0(n,e,t,i,r,s={}){let o=n.createContext(s.merge||s.mergeFields?2:0,e,t,r);Vf("Data must be an object, but it was:",o,i);let a=dS(i,o),c,l;if(s.merge)c=new Hn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let h of s.mergeFields){let d=Rd(e,h,t);if(!o.contains(d))throw new N(z.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);mS(u,d)||u.push(d)}c=new Hn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new xd(new rn(a),c,l)}var T2=class n extends Ir{_toFieldTransform(e){if(e.dataSource===2)e.fieldMask.push(e.path);else throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(e){return e instanceof n}};function uS(n,e,t){return new S0({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Id=class n extends Ir{_toFieldTransform(e){return new T1(e.path,new Is)}isEqual(e){return e instanceof n}},Ad=class n extends Ir{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=uS(this,e,!0),i=this._elements.map(s=>L1(s,t)),r=new xr(i);return new T1(e.path,r)}isEqual(e){return e instanceof n&&ll(this._elements,e._elements)}},Dd=class n extends Ir{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=uS(this,e,!0),i=this._elements.map(s=>L1(s,t)),r=new Or(i);return new T1(e.path,r)}isEqual(e){return e instanceof n&&ll(this._elements,e._elements)}},kd=class n extends Ir{constructor(e,t){super(e),this._operand=t}_toFieldTransform(e){let t=new As(e.serializer,B_(e.serializer,this._operand));return new T1(e.path,t)}isEqual(e){return e instanceof n&&this._operand===e._operand}};function Rf(n,e,t,i){let r=n.createContext(1,e,t);Vf("Data must be an object, but it was:",r,i);let s=[],o=rn.empty();k1(i,(c,l)=>{let u=Nf(e,c,t);l=dt(l);let h=r.childContextForFieldPath(u);if(l instanceof T2)s.push(u);else{let d=L1(l,h);d!=null&&(s.push(u),o.set(u,d))}});let a=new Hn(s);return new C0(o,a,r.fieldTransforms)}function Lf(n,e,t,i,r,s){let o=n.createContext(1,e,t),a=[Rd(e,i,t)],c=[r];if(s.length%2!==0)throw new N(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Rd(e,s[d])),c.push(s[d+1]);let l=[],u=rn.empty();for(let d=a.length-1;d>=0;--d)if(!mS(l,a[d])){let g=a[d],_=c[d];_=dt(_);let T=o.childContextForFieldPath(g);if(_ instanceof T2)l.push(g);else{let E=L1(_,T);E!=null&&(l.push(g),u.set(g,E))}}let h=new Hn(l);return new C0(u,h,o.fieldTransforms)}function hS(n,e,t,i=!1){let r=n.createContext(i?4:3,e);return L1(t,r)}function L1(n,e){if(n=dt(n),fS(n))return Vf("Unsupported field value:",e,n),dS(n,e);if(n instanceof Ir)return cj(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return aj(n,e)}else return lj(n,e)}function dS(n,e){let t={};return d_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):k1(n,(i,r)=>{let s=L1(r,e.childContextForField(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function aj(n,e){let t=[],i=0;for(let r of n){let s=L1(r,e.childContextForArray(i));s==null&&(s={nullValue:"NULL_VALUE"}),t.push(s),i++}return{arrayValue:{values:t}}}function cj(n,e){if(!lS(e.dataSource))throw e.createError(`${n._methodName}() can only be used with update() and set()`);if(!e.path)throw e.createError(`${n._methodName}() is not currently supported inside arrays`);let t=n._toFieldTransform(e);t&&e.fieldTransforms.push(t)}function lj(n,e){if(n=dt(n),n===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return B_(e.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let t=mt.fromDate(n);return{timestampValue:wa(e.serializer,t)}}else if(n instanceof mt){let t=new mt(n.seconds,Math.floor(n.nanoseconds/1e3)*1e3);return{timestampValue:wa(e.serializer,t)}}else{if(n instanceof O1)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof sr)return{bytesValue:X_(e.serializer,n._byteString)};if(n instanceof tt){let t=e.databaseId,i=n.firestore._databaseId;if(!i.isEqual(t))throw e.createError(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${t.projectId}/${t.database}`);return{referenceValue:of(n.firestore._databaseId||e.databaseId,n._key.path)}}else{if(n instanceof S2)return uj(n,e);throw e.createError(`Unsupported field value: ${V2(n)}`)}}}function uj(n,e){return{mapValue:{fields:{[Xd]:{stringValue:Zd},[fa]:{arrayValue:{values:n.toArray().map(i=>{if(typeof i!="number")throw e.createError("VectorValues must only contain numeric values.");return sf(e.serializer,i)})}}}}}}function fS(n){return typeof n=="object"&&n!==null&&!(n instanceof Array)&&!(n instanceof Date)&&!(n instanceof mt)&&!(n instanceof O1)&&!(n instanceof sr)&&!(n instanceof tt)&&!(n instanceof Ir)&&!(n instanceof S2)}function Vf(n,e,t){if(!fS(t)||!TU(t)){let i=V2(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Rd(n,e,t){if(e=dt(e),e instanceof xi)return e._internalPath;if(typeof e=="string")return Nf(n,e);throw T0("Field path arguments must be of type string or ",n,!1,void 0,t)}var hj=new RegExp("[~\\*/\\[\\]]");function Nf(n,e,t){if(e.search(hj)>=0)throw T0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xi(...e.split("."))._internalPath}catch{throw T0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function T0(n,e,t,i,r){let s=i&&!i.isEmpty(),o=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new N(z.INVALID_ARGUMENT,a+n+c)}function mS(n,e){return n.some(t=>t.isEqual(e))}var I1=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new tt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document)if(this._converter){let e=new Ld(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}else return this._userDataWriter.convertValue(this._document.data.value);else return}get(e){if(this._document){let t=this._document.data.field($0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ld=class extends I1{data(){return super.data()}};function $0(n,e){return typeof e=="string"?Nf(n,e):e instanceof xi?e._internalPath:e._delegate._internalPath}function pS(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new N(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var E2=class{},A1=class extends E2{};function Rr(n,e,...t){let i=[];e instanceof E2&&i.push(e),i=i.concat(t),wj(i);for(let r of i)n=r._apply(n);return n}var E0=class n extends A1{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return ES(e._query,t),new Yt(e.firestore,e.converter,nf(e._query,t))}_parse(e){let t=R1(e.firestore);return dj(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function gS(n,e,t){let i=e,r=$0("where",n);return E0._create(r,i,t)}var Vd=class n extends E2{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:qe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(vj(e._query,t),new Yt(e.firestore,e.converter,nf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Nd=class n extends A1{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=fj(e._query,this._field,this._direction);return new Yt(e.firestore,e.converter,AP(e._query,t))}};function vS(n,e="asc"){let t=e,i=$0("orderBy",n);return Nd._create(i,t)}var M0=class n extends A1{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new Yt(e.firestore,e.converter,G6(e._query,this._limit,this._limitType))}};function yS(n){return UC("limit",n),M0._create("limit",n,"F")}function wS(n){return UC("limitToLast",n),M0._create("limitToLast",n,"L")}var z0=class n extends A1{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=TS(e,this.type,this._docOrFields,this._inclusive);return new Yt(e.firestore,e.converter,DP(e._query,t))}};function bS(...n){return z0._create("startAt",n,!0)}function _S(...n){return z0._create("startAfter",n,!1)}var x0=class n extends A1{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=TS(e,this.type,this._docOrFields,this._inclusive);return new Yt(e.firestore,e.converter,kP(e._query,t))}};function CS(...n){return x0._create("endBefore",n,!1)}function SS(...n){return x0._create("endAt",n,!0)}function TS(n,e,t,i){if(t[0]=dt(t[0]),t[0]instanceof I1)return mj(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=R1(n.firestore);return pj(n._query,n.firestore._databaseId,r,e,t,i)}}function dj(n,e,t,i,r,s,o){let a;if(r.isKeyField()){if(s==="array-contains"||s==="array-contains-any")throw new N(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if(s==="in"||s==="not-in"){jb(o,s);let l=[];for(let u of o)l.push(Ub(i,n,u));a={arrayValue:{values:l}}}else a=Ub(i,n,o)}else(s==="in"||s==="not-in"||s==="array-contains-any")&&jb(o,s),a=hS(t,e,o,s==="in"||s==="not-in");return _e.create(r,s,a)}function fj(n,e,t){if(n.startAt!==null)throw new N(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(n.endAt!==null)throw new N(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new C1(e,t)}function mj(n,e,t,i,r){if(!i)throw new N(z.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${t}().`);let s=[];for(let o of ga(n))if(o.field.isKeyField())s.push(_1(e,i.key));else{let a=i.data.field(o.field);if(V0(a))throw new N(z.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(a!==null)s.push(a);else{let c=o.field.canonicalString();throw new N(z.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${c}' (used as the orderBy) does not exist.`)}}return new ir(s,r)}function pj(n,e,t,i,r,s){let o=n.explicitOrderBy;if(r.length>o.length)throw new N(z.INVALID_ARGUMENT,`Too many arguments provided to ${i}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let a=[];for(let c=0;c<r.length;c++){let l=r[c];if(o[c].field.isKeyField()){if(typeof l!="string")throw new N(z.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${i}(), but got a ${typeof l}`);if(!tf(n)&&l.indexOf("/")!==-1)throw new N(z.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${i}() must be a plain document ID, but '${l}' contains a slash.`);let h=n.path.child(ze.fromString(l));if(!j.isDocumentKey(h))throw new N(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${i}() must result in a valid document path, but '${h}' is not because it contains an odd number of segments.`);let d=new j(h);a.push(_1(e,d))}else{let h=hS(t,i,l);a.push(h)}}return new ir(a,s)}function Ub(n,e,t){if(t=dt(t),typeof t=="string"){if(t==="")throw new N(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tf(e)&&t.indexOf("/")!==-1)throw new N(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(ze.fromString(t));if(!j.isDocumentKey(i))throw new N(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return _1(n,new j(i))}else{if(t instanceof tt)return _1(n,t._key);throw new N(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${V2(t)}.`)}}function jb(n,e){if(!Array.isArray(n)||n.length===0)throw new N(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function gj(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function ES(n,e){let t=yj(n.filters,gj(e.op));if(t!==null)throw t===e.op?new N(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new N(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function vj(n,e){let t=n,i=e.getFlattenedFilters();for(let r of i)ES(t,r),t=nf(t,r)}function yj(n,e){for(let t of n)for(let i of t.getFlattenedFilters())if(e.indexOf(i.op)>=0)return i.op;return null}function wj(n){let e=n.filter(i=>i instanceof Vd).length,t=n.filter(i=>i instanceof E0).length;if(e>1||e>0&&t>0)throw new N(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}var xa=class{convertValue(e,t="none"){switch(b1(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return k1(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,r;let s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t[fa].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>lt(o.doubleValue));return new S2(s)}convertGeoPoint(e){return new O1(lt(e.latitude),lt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Qd(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(s2(e));default:return null}}convertTimestamp(e){let t=zr(e);return new mt(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=ze.fromString(e);ne(cC(i));let r=new xs(i.get(1),i.get(3)),s=new j(i.popFirst(5));return r.isEqual(t)||ft(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function G0(n,e,t){let i;return n?t&&(t.merge||t.mergeFields)?i=n.toFirestore(e,t):i=n.toFirestore(e):i=e,i}var Pd=class extends xa{constructor(e){super(),this.firestore=e}convertBytes(e){return new sr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new tt(this.firestore,null,t)}};function Hd(n){return bj(n,["next","error","complete"])}function bj(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}var Ar=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},si=class extends I1{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document)if(this._converter){let t=new Ls(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}else return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);else return}get(e,t={}){if(this._document){let i=this._document.data.field($0("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},Ls=class extends si{data(e={}){return super.data(e)}},Oi=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ar(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Ls(this._firestore,this._userDataWriter,i.key,i,new Ar(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new N(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return(!this._cachedChanges||this._cachedChangesIncludeMetadataChanges!==t)&&(this._cachedChanges=_j(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function _j(n,e){if(n._snapshot.oldDocs.isEmpty()){let t=0;return n._snapshot.docChanges.map(i=>{let r=new Ls(n._firestore,n._userDataWriter,i.doc.key,i.doc,new Ar(n._snapshot.mutatedKeys.has(i.doc.key),n._snapshot.fromCache),n.query.converter);return i.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}else{let t=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(i=>e||i.type!==3).map(i=>{let r=new Ls(n._firestore,n._userDataWriter,i.doc.key,i.doc,new Ar(n._snapshot.mutatedKeys.has(i.doc.key),n._snapshot.fromCache),n.query.converter),s=-1,o=-1;return i.type!==0&&(s=t.indexOf(i.doc.key),t=t.delete(i.doc.key)),i.type!==1&&(t=t.add(i.doc),o=t.indexOf(i.doc.key)),{type:Cj(i.type),doc:r,oldIndex:s,newIndex:o}})}}function Cj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function Pf(n,e){return n instanceof si&&e instanceof si?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Oi&&e instanceof Oi?n._firestore===e._firestore&&kf(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot):!1}function MS(n){n=Ie(n,tt);let e=Ie(n.firestore,pt),t=Kt(e);return $C(t,n._key).then(i=>qf(e,n,i))}var Dr=class extends xa{constructor(e){super(),this.firestore=e}convertBytes(e){return new sr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new tt(this.firestore,null,t)}};function zS(n){n=Ie(n,tt);let e=Ie(n.firestore,pt),t=Kt(e),i=new Dr(e);return PU(t,n._key).then(r=>new si(e,i,n._key,r,new Ar(r!==null&&r.hasLocalMutations,!0),n.converter))}function xS(n){n=Ie(n,tt);let e=Ie(n.firestore,pt),t=Kt(e);return $C(t,n._key,{source:"server"}).then(i=>qf(e,n,i))}function OS(n){n=Ie(n,Yt);let e=Ie(n.firestore,pt),t=Kt(e),i=new Dr(e);return pS(n._query),GC(t,n._query).then(r=>new Oi(e,i,n,r))}function IS(n){n=Ie(n,Yt);let e=Ie(n.firestore,pt),t=Kt(e),i=new Dr(e);return HU(t,n._query).then(r=>new Oi(e,i,n,r))}function AS(n){n=Ie(n,Yt);let e=Ie(n.firestore,pt),t=Kt(e),i=new Dr(e);return GC(t,n._query,{source:"server"}).then(r=>new Oi(e,i,n,r))}function Hf(n,e,t){n=Ie(n,tt);let i=Ie(n.firestore,pt),r=G0(n.converter,e,t),s=R1(i),a=W0(s,"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,_t.none());return Ha(i,[a])}function Bf(n,e,t,...i){n=Ie(n,tt);let r=Ie(n.firestore,pt),s=R1(r);e=dt(e);let o;typeof e=="string"||e instanceof xi?o=Lf(s,"updateDoc",n._key,e,t,i):o=Rf(s,"updateDoc",n._key,e);let a=o.toMutation(n._key,_t.exists(!0));return Ha(r,[a])}function DS(n){let e=Ie(n.firestore,pt),t=[new ks(n._key,_t.none())];return Ha(e,t)}function kS(n,e){let t=Ie(n.firestore,pt),i=N2(n),r=G0(n.converter,e),s=R1(n.firestore),a=W0(s,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,_t.exists(!1));return Ha(t,[a]).then(()=>i)}function Ff(n,...e){var t,i,r;n=dt(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]=="object"&&!Hd(e[o])&&(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Hd(e[o])){let d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(i=d.error)===null||i===void 0?void 0:i.bind(d),e[o+2]=(r=d.complete)===null||r===void 0?void 0:r.bind(d)}let c,l,u;if(n instanceof tt)l=Ie(n.firestore,pt),u=ka(n._key.path),c={next:d=>{e[o]&&e[o](qf(l,n,d))},error:e[o+1],complete:e[o+2]};else{let d=Ie(n,Yt);l=Ie(d.firestore,pt),u=d._query;let g=new Dr(l);c={next:_=>{e[o]&&e[o](new Oi(l,g,d,_))},error:e[o+1],complete:e[o+2]},pS(n._query)}let h=Kt(l);return NU(h,u,a,c)}function RS(n,e){n=Ie(n,pt);let t=Kt(n),i=Hd(e)?e:{next:e};return FU(t,i)}function Ha(n,e){let t=Kt(n);return BU(t,e)}function qf(n,e,t){let i=t.docs.get(e._key),r=new Dr(n);return new si(n,r,e._key,i,new Ar(t.hasPendingWrites,t.fromCache),e.converter)}var Sj={maxAttempts:5};function Tj(n){if(n.maxAttempts<1)throw new N(z.INVALID_ARGUMENT,"Max attempts must be at least 1")}var O0=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=R1(e)}set(e,t,i){this._verifyNotCommitted();let r=Ss(e,this._firestore),s=G0(r.converter,t,i),o=W0(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,i);return this._mutations.push(o.toMutation(r._key,_t.none())),this}update(e,t,i,...r){this._verifyNotCommitted();let s=Ss(e,this._firestore);t=dt(t);let o;return typeof t=="string"||t instanceof xi?o=Lf(this._dataReader,"WriteBatch.update",s._key,t,i,r):o=Rf(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,_t.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Ss(e,this._firestore);return this._mutations=this._mutations.concat(new ks(t._key,_t.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new N(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Ss(n,e){if(n=dt(n),n.firestore!==e)throw new N(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var Bd=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=R1(e)}get(e){let t=Ss(e,this._firestore),i=new Pd(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||r.length!==1)return Y();let s=r[0];if(s.isFoundDocument())return new I1(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new I1(this._firestore,i,t._key,null,t.converter);throw Y()})}set(e,t,i){let r=Ss(e,this._firestore),s=G0(r.converter,t,i),o=W0(this._dataReader,"Transaction.set",r._key,s,r.converter!==null,i);return this._transaction.set(r._key,o),this}update(e,t,i,...r){let s=Ss(e,this._firestore);t=dt(t);let o;return typeof t=="string"||t instanceof xi?o=Lf(this._dataReader,"Transaction.update",s._key,t,i,r):o=Rf(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){let t=Ss(e,this._firestore);return this._transaction.delete(t._key),this}};var Fd=class extends Bd{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Ss(e,this._firestore),i=new Dr(this._firestore);return super.get(e).then(r=>new si(this._firestore,i,t._key,r._document,new Ar(!1,!1),t.converter))}};function LS(n,e,t){n=Ie(n,pt);let i=Object.assign(Object.assign({},Sj),t);Tj(i);let r=Kt(n);return qU(r,s=>e(new Fd(n,s)),i)}function VS(){return new T2("deleteField")}function NS(){return new Id("serverTimestamp")}function PS(...n){return new Ad("arrayUnion",n)}function HS(...n){return new Dd("arrayRemove",n)}function BS(n){return new kd("increment",n)}sj("node");var Ej="@firebase/firestore-compat",Mj="0.3.38";function Yf(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new N("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function FS(){if(typeof Uint8Array>"u")throw new N("unimplemented","Uint8Arrays are not available in this environment.")}function qS(){if(!f_())throw new N("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Y0=class n{constructor(e){this._delegate=e}static fromBase64String(e){return qS(),new n(sr.fromBase64String(e))}static fromUint8Array(e){return FS(),new n(sr.fromUint8Array(e))}toBase64(){return qS(),this._delegate.toBase64()}toUint8Array(){return FS(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Uf(n){return zj(n,["next","error","complete"])}function zj(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}var jf=class{enableIndexedDbPersistence(e,t){return eS(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return tS(e._delegate)}clearIndexedDbPersistence(e){return iS(e._delegate)}},K0=class{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof xs||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ti("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){QC(this._delegate,e,t,i)}enableNetwork(){return sS(this._delegate)}disableNetwork(){return oS(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,zf("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return rS(this._delegate)}onSnapshotsInSync(e){return RS(this._delegate,e)}get app(){if(!this._appCompat)throw new N("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new qa(this,Af(this._delegate,e))}catch(t){throw mn(t,"collection()","Firestore.collection()")}}doc(e){try{return new or(this,N2(this._delegate,e))}catch(t){throw mn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new H1(this,XC(this._delegate,e))}catch(t){throw mn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return LS(this._delegate,t=>e(new Q0(this,t)))}batch(){return Kt(this._delegate),new X0(new O0(this._delegate,e=>Ha(this._delegate,e)))}loadBundle(e){return aS(this._delegate,e)}namedQuery(e){return cS(this._delegate,e).then(t=>t?new H1(this,t):null)}},Ba=class extends xa{constructor(e){super(),this.firestore=e}convertBytes(e){return new Y0(new sr(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return or.forKey(t,this.firestore,null)}};function xj(n){$b(n)}var Q0=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ba(e)}get(e){let t=V1(e);return this._delegate.get(t).then(i=>new N1(this._firestore,new si(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){let r=V1(e);return i?(Yf("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let s=V1(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){let t=V1(e);return this._delegate.delete(t),this}},X0=class{constructor(e){this._delegate=e}set(e,t,i){let r=V1(e);return i?(Yf("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let s=V1(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){let t=V1(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Fa=class n{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){let i=new Ls(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new P1(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let i=n.INSTANCES,r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new n(e,new Ba(e),t),r.set(t,s)),s}};Fa.INSTANCES=new WeakMap;var or=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ba(e)}static forPath(e,t,i){if(e.length%2!==0)throw new N("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new tt(t._delegate,i,new j(e)))}static forKey(e,t,i){return new n(t,new tt(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new qa(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new qa(this.firestore,Af(this._delegate,e))}catch(t){throw mn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=dt(e),e instanceof tt?Df(this._delegate,e):!1}set(e,t){t=Yf("DocumentReference.set",t);try{return t?Hf(this._delegate,e,t):Hf(this._delegate,e)}catch(i){throw mn(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?Bf(this._delegate,e):Bf(this._delegate,e,t,...i)}catch(r){throw mn(r,"updateDoc()","DocumentReference.update()")}}delete(){return DS(this._delegate)}onSnapshot(...e){let t=US(e),i=jS(e,r=>new N1(this.firestore,new si(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return Ff(this._delegate,t,i)}get(e){let t;return e?.source==="cache"?t=zS(this._delegate):e?.source==="server"?t=xS(this._delegate):t=MS(this._delegate),t.then(i=>new N1(this.firestore,new si(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Fa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function mn(n,e,t){return n.message=n.message.replace(e,t),n}function US(n){for(let e of n)if(typeof e=="object"&&!Uf(e))return e;return{}}function jS(n,e){var t,i;let r;return Uf(n[0])?r=n[0]:Uf(n[1])?r=n[1]:typeof n[0]=="function"?r={next:n[0],error:n[1],complete:n[2]}:r={next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:(t=r.error)===null||t===void 0?void 0:t.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}var N1=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new or(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Pf(this._delegate,e._delegate)}},P1=class extends N1{data(e){let t=this._delegate.data(e);return this._delegate._converter||Gb(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},H1=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ba(e)}where(e,t,i){try{return new n(this.firestore,Rr(this._delegate,gS(e,t,i)))}catch(r){throw mn(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Rr(this._delegate,vS(e,t)))}catch(i){throw mn(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Rr(this._delegate,yS(e)))}catch(t){throw mn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Rr(this._delegate,wS(e)))}catch(t){throw mn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Rr(this._delegate,bS(...e)))}catch(t){throw mn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Rr(this._delegate,_S(...e)))}catch(t){throw mn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Rr(this._delegate,CS(...e)))}catch(t){throw mn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Rr(this._delegate,SS(...e)))}catch(t){throw mn(t,"endAt()","Query.endAt()")}}isEqual(e){return kf(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=IS(this._delegate):e?.source==="server"?t=AS(this._delegate):t=OS(this._delegate),t.then(i=>new P2(this.firestore,new Oi(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){let t=US(e),i=jS(e,r=>new P2(this.firestore,new Oi(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return Ff(this._delegate,t,i)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Fa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Wf=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new P1(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},P2=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new H1(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new P1(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Wf(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new P1(this._firestore,i))})}isEqual(e){return Pf(this._delegate,e._delegate)}},qa=class n extends H1{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new or(this.firestore,e):null}doc(e){try{return e===void 0?new or(this.firestore,N2(this._delegate)):new or(this.firestore,N2(this._delegate,e))}catch(t){throw mn(t,"doc()","CollectionReference.doc()")}}add(e){return kS(this._delegate,e).then(t=>new or(this.firestore,t))}isEqual(e){return Df(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Fa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function V1(n){return Ie(n,tt)}var $f=class n{constructor(...e){this._delegate=new xi(...e)}static documentId(){return new n(xt.keyField().canonicalString())}isEqual(e){return e=dt(e),e instanceof xi?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Gf=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=NS();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=VS();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=PS(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=HS(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=BS(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var Oj={Firestore:K0,GeoPoint:O1,Timestamp:mt,Blob:Y0,Transaction:Q0,WriteBatch:X0,DocumentReference:or,DocumentSnapshot:N1,Query:H1,QueryDocumentSnapshot:P1,QuerySnapshot:P2,CollectionReference:qa,FieldPath:$f,FieldValue:Gf,setLogLevel:xj,CACHE_SIZE_UNLIMITED:ZC};function Ij(n,e){n.INTERNAL.registerComponent(new Xs("firestore-compat",t=>{let i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},Oj)))}function Aj(n){Ij(n,(e,t)=>new K0(e,t,new jf)),n.registerVersion(Ej,Mj,"node")}Aj(cn);var Dj="firebase",kj="10.14.1";Ur(Dj,kj,"app");var F1=new Um("ANGULARFIRE2_VERSION");var Rj=(n,e)=>{let t=e?[e]:sp(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},B1=class{constructor(){return Rj(Lj)}},Lj="app-check";function Kf(){}var Z0=class{zone;delegate;constructor(e,t=Cm){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,i)}},Qf=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Kf,{},Kf,Kf)),t.pipe(bc({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},J0=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Z0(Zone.current)),this.insideAngular=t.run(()=>new Z0(Zone.current,gc)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(D(Se))};static \u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function WS(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function LX(n){return n.pipe(Hr(WS().outsideAngular))}function In(n){return Vj(WS())(n)}function Vj(n){return function(t){return t=t.lift(new Qf(n.ngZone)),t.pipe(J1(n.outsideAngular),Hr(n.insideAngular))}}var Nj=new Map,Pj={activated:!1,tokenObservers:[]},Hj={initialized:!1,enabled:!1};function Ii(n){return Nj.get(n)||Object.assign({},Pj)}function XS(){return Hj}var Bj="https://content-firebaseappcheck.googleapis.com/v1";var Fj="exchangeDebugToken",GS={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},jX=24*60*60*1e3;var Zf=class{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return S(this,null,function*(){this.stop();try{this.pending=new al,this.pending.promise.catch(t=>{}),yield qj(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new al,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function qj(n){return new Promise(e=>{setTimeout(e,n)})}var Uj={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Fs=new ip("appCheck","AppCheck",Uj);function ZS(n){if(!Ii(n).activated)throw Fs.create("use-before-activation",{appName:n.name})}function JS(i,r){return S(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let g=yield o.getHeartbeatsHeader();g&&(s["X-Firebase-Client"]=g)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(n,a)}catch(g){throw Fs.create("fetch-network-error",{originalErrorMessage:g?.message})}if(c.status!==200)throw Fs.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(g){throw Fs.create("fetch-parse-error",{originalErrorMessage:g?.message})}let u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw Fs.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let h=Number(u[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}})}function eT(n,e){let{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${Bj}/projects/${t}/apps/${i}:${Fj}?key=${r}`,body:{debug_token:e}}}var jj="firebase-app-check-database",Wj=1,Jf="firebase-app-check-store";var e8=null;function $j(){return e8||(e8=new Promise((n,e)=>{try{let t=indexedDB.open(jj,Wj);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(Fs.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=i=>{let r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore(Jf,{keyPath:"compositeKey"})}}}catch(t){e(Fs.create("storage-open",{originalErrorMessage:t?.message}))}}),e8)}function Gj(n,e){return Yj(Kj(n),e)}function Yj(n,e){return S(this,null,function*(){let i=(yield $j()).transaction(Jf,"readwrite"),s=i.objectStore(Jf).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},i.onerror=c=>{var l;a(Fs.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function Kj(n){return`${n.options.appId}-${n.name}`}var e9=new Dc("@firebase/app-check");function Xf(n,e){return Ac()?Gj(n,e).catch(t=>{e9.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function tT(){return XS().enabled}function nT(){return S(this,null,function*(){let n=XS();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Qj={error:"UNKNOWN_ERROR"};function Xj(n){return ep.encodeString(JSON.stringify(n),!1)}function t9(n,e=!1){return S(this,null,function*(){let t=n.app;ZS(t);let i=Ii(t),r=i.token,s;if(r&&!H2(r)&&(i.token=void 0,r=void 0),!r){let c=yield i.cachedTokenPromise;c&&(H2(c)?r=c:yield Xf(t,void 0))}if(!e&&r&&H2(r))return{token:r.token};let o=!1;if(tT()){i.exchangeTokenPromise||(i.exchangeTokenPromise=JS(eT(t,yield nT()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),o=!0);let c=yield i.exchangeTokenPromise;return yield Xf(t,c),i.token=c,{token:c.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),o=!0),r=yield Ii(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?e9.warn(c.message):e9.error(c),s=c}let a;return r?s?H2(r)?a={token:r.token,internalError:s}:a=KS(s):(a={token:r.token},i.token=r,yield Xf(t,r)):a=KS(s),o&&tW(t,a),a})}function Zj(n){return S(this,null,function*(){let e=n.app;ZS(e);let{provider:t}=Ii(e);if(tT()){let i=yield nT(),{token:r}=yield JS(eT(e,i),n.heartbeatServiceProvider);return{token:r}}else{let{token:i}=yield t.getToken();return{token:i}}})}function Jj(n,e,t,i){let{app:r}=n,s=Ii(r),o={next:t,error:i,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&H2(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),YS(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>YS(n))}function iT(n,e){let t=Ii(n),i=t.tokenObservers.filter(r=>r.next!==e);i.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function YS(n){let{app:e}=n,t=Ii(e),i=t.tokenRefresher;i||(i=eW(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function eW(n){let{app:e}=n;return new Zf(()=>S(this,null,function*(){let t=Ii(e),i;if(t.token?i=yield t9(n,!0):i=yield t9(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let t=Ii(e);if(t.token){let i=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,r=t.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now())}else return 0},GS.RETRIAL_MIN_WAIT,GS.RETRIAL_MAX_WAIT)}function tW(n,e){let t=Ii(n).tokenObservers;for(let i of t)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function H2(n){return n.expireTimeMillis-Date.now()>0}function KS(n){return{token:Xj(Qj),error:n}}var n9=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Ii(this.app);for(let t of e)iT(this.app,t.next);return Promise.resolve()}};function nW(n,e){return new n9(n,e)}function iW(n){return{getToken:e=>t9(n,e),getLimitedUseToken:()=>Zj(n),addTokenListener:e=>Jj(n,"INTERNAL",e),removeTokenListener:e=>iT(n.app,e)}}var rW="@firebase/app-check",sW="0.8.8";var oW="app-check",QS="app-check-internal";function aW(){c4(new Xs(oW,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return nW(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(QS).initialize()})),c4(new Xs(QS,n=>{let e=n.getProvider("app-check").getImmediate();return iW(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ur(rW,sW)}aW();var cW=["localhost","0.0.0.0","127.0.0.1"],nZ=typeof window<"u"&&cW.includes(window.location.hostname);var lW="firebase",uW="10.14.1";cn.registerVersion(lW,uW,"app-compat");var hW=["ngOnDestroy"],oT=(n,e,t,i={})=>new Proxy(n,{get:(r,s)=>t.runOutsideAngular(()=>{if(n[s])return i?.spy?.get&&i.spy.get(s,n[s]),n[s];if(hW.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,l)=>o.then(u=>{let h=u?.(...l);return i?.spy?.apply&&i.spy.apply(s,l,h),h})})})});var t8=class{constructor(e){return e}},Ua=new Ee("angularfire2.app.options"),ja=new Ee("angularfire2.app.name");function B2(n,e,t){let i=typeof t=="string"&&t||"[DEFAULT]",r=typeof t=="object"&&t||{};r.name=r.name||i;let o=cn.apps.filter(a=>a&&a.name===r.name)[0]||e.runOutsideAngular(()=>cn.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;dW("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new t8(o)}var dW=(n,...e)=>{Qs()&&typeof console<"u"&&console[n](...e)},fW={provide:t8,useFactory:B2,deps:[Ua,Se,[new _c,ja]]},fZ=(()=>{class n{static initializeApp(t,i){return{ngModule:n,providers:[{provide:Ua,useValue:t},{provide:ja,useValue:i}]}}constructor(t){cn.registerVersion("angularfire",F1.full,"core"),cn.registerVersion("angularfire",F1.full,"app-compat"),cn.registerVersion("angular",jm.full,t.toString())}static \u0275fac=function(i){return new(i||n)(D(Ri))};static \u0275mod=be({type:n});static \u0275inj=we({providers:[fW]})}return n})();function n8(n,e,t,i,r){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return mW(r,o)||(sT("error",`${e} was already initialized on the ${t} Firebase App with different settings.${pW?" You may need to reload as Firebase is not HMR aware.":""}`),sT("warn",{is:r,was:o})),s;{let a=i();return globalThis.\u0275AngularfireInstanceCache.push([n,a,r]),a}}function mW(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var pW=typeof module<"u"&&!!module.hot,sT=(n,...e)=>{Qs()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var i9=new Ee("angularfire2.auth.use-emulator"),r9=new Ee("angularfire2.auth.settings"),s9=new Ee("angularfire2.auth.tenant-id"),o9=new Ee("angularfire2.auth.langugage-code"),a9=new Ee("angularfire2.auth.use-device-language"),c9=new Ee("angularfire.auth.persistence"),l9=(n,e,t,i,r,s,o,a)=>n8(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),i&&(c.tenantId=i),c.languageCode=r,s&&c.useDeviceLanguage(),o)for(let[l,u]of Object.entries(o))c.settings[l]=u;return a&&c.setPersistence(a),c},[t,i,r,s,o,a]),F2=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,i,r,s,o,a,c,l,u,h,d,g){let _=new ce,T=St(void 0).pipe(Hr(o.outsideAngular),hi(()=>s.runOutsideAngular(()=>import("./chunk-RG2JCFV4.mjs"))),Ge(()=>B2(t,s,i)),Ge(E=>l9(E,s,a,l,u,h,c,d)),n4({bufferSize:1,refCount:!1}));if(xc(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=St(null);else{T.pipe(Im()).subscribe();let E=T.pipe(hi(V=>V.getRedirectResult().then(P=>P,()=>null)),In,n4({bufferSize:1,refCount:!1})),L=T.pipe(hi(V=>new vn(P=>({unsubscribe:s.runOutsideAngular(()=>V.onAuthStateChanged(G=>P.next(G),G=>P.error(G),()=>P.complete()))})))),x=T.pipe(hi(V=>new vn(P=>({unsubscribe:s.runOutsideAngular(()=>V.onIdTokenChanged(G=>P.next(G),G=>P.error(G),()=>P.complete()))}))));this.authState=E.pipe(nl(L),J1(o.outsideAngular),Hr(o.insideAngular)),this.user=E.pipe(nl(x),J1(o.outsideAngular),Hr(o.insideAngular)),this.idToken=this.user.pipe(hi(V=>V?Un(V.getIdToken()):St(null))),this.idTokenResult=this.user.pipe(hi(V=>V?Un(V.getIdTokenResult()):St(null))),this.credential=vc(E,_,this.authState.pipe(qt(V=>!V))).pipe(Ge(V=>V?.user?V:null),J1(o.outsideAngular),Hr(o.insideAngular))}return oT(this,T,s,{spy:{apply:(E,L,x)=>{(E.startsWith("signIn")||E.startsWith("createUser"))&&x.then(V=>_.next(V))}}})}static \u0275fac=function(i){return new(i||n)(D(Ua),D(ja,8),D(Ri),D(Se),D(J0),D(i9,8),D(r9,8),D(s9,8),D(o9,8),D(a9,8),D(c9,8),D(B1,8))};static \u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),xZ=(()=>{class n{constructor(){cn.registerVersion("angularfire",F1.full,"auth-compat")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=be({type:n});static \u0275inj=we({providers:[F2]})}return n})();function gW(n,e=gc){return new vn(t=>{let i;return e!=null?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}function cT(n,e){return gW(n,e)}function vW(n,e){return cT(n,e).pipe(yn(void 0),no(),Ge(t=>{let[i,r]=t;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}function d9(n,e){return cT(n,e).pipe(Ge(t=>({payload:t,type:"query"})))}var i8=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let i=this.ref.collection(e),{ref:r,query:s}=fT(i,t);return new s8(r,s,this.afs)}snapshotChanges(){return vW(this.ref,this.afs.schedulers.outsideAngular).pipe(In)}valueChanges(e={}){return this.snapshotChanges().pipe(Ge(({payload:t})=>e.idField?qn(Re({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Un(this.ref.get(e)).pipe(In)}};function r8(n,e){return d9(n,e).pipe(yn(void 0),no(),Ge(t=>{let[i,r]=t,s=r.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((a,c)=>{let l=s.find(h=>h.doc.ref.isEqual(a.ref)),u=i?.payload.docs.find(h=>h.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&u&&JSON.stringify(u.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function lT(n,e,t){return r8(n,t).pipe(wc((i,r)=>yW(i,r.map(s=>s.payload),e),[]),Ks(),Ge(i=>i.map(r=>({type:r.type,payload:r}))))}function yW(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=wW(n,i))}),n}function u9(n,e,t,...i){let r=n.slice();return r.splice(e,t,...i),r}function wW(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return u9(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return u9(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return u9(n,e.oldIndex,1);break}return n}function uT(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var s8=class{ref;query;afs;constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=r8(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Ge(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(yn(void 0),no(),qt(([i,r])=>r.length>0||!i),Ge(([,i])=>i),In)}auditTrail(e){return this.stateChanges(e).pipe(wc((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=uT(e);return lT(this.query,t,this.afs.schedulers.outsideAngular).pipe(In)}valueChanges(e={}){return d9(this.query,this.afs.schedulers.outsideAngular).pipe(Ge(t=>t.payload.docs.map(i=>e.idField?qn(Re({},i.data()),{[e.idField]:i.id}):i.data())),In)}get(e){return Un(this.query.get(e)).pipe(In)}add(e){return this.ref.add(e)}doc(e){return new i8(this.ref.doc(e),this.afs)}},h9=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?r8(this.query,this.afs.schedulers.outsideAngular).pipe(In):r8(this.query,this.afs.schedulers.outsideAngular).pipe(Ge(t=>t.filter(i=>e.indexOf(i.type)>-1)),qt(t=>t.length>0),In)}auditTrail(e){return this.stateChanges(e).pipe(wc((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=uT(e);return lT(this.query,t,this.afs.schedulers.outsideAngular).pipe(In)}valueChanges(e={}){return d9(this.query,this.afs.schedulers.outsideAngular).pipe(Ge(i=>i.payload.docs.map(r=>e.idField?Re({[e.idField]:r.id},r.data()):r.data())),In)}get(e){return Un(this.query.get(e)).pipe(In)}},hT=new Ee("angularfire2.enableFirestorePersistence"),dT=new Ee("angularfire2.firestore.persistenceSettings"),bW=new Ee("angularfire2.firestore.settings"),_W=new Ee("angularfire2.firestore.use-emulator");function fT(n,e=t=>t){return{query:e(n),ref:n}}var f9=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,i,r,s,o,a,c,l,u,h,d,g,_,T,E,L,x){this.schedulers=c;let V=B2(t,a,i),P=u;h&&l9(V,a,d,_,T,E,g,L),[this.firestore,this.persistenceEnabled$]=n8(`${V.name}.firestore`,"AngularFirestore",V.name,()=>{let G=a.runOutsideAngular(()=>V.firestore());if(s&&G.settings(s),P&&G.useEmulator(...P),r&&!xc(o)){let K=()=>{try{return Un(G.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(w){return typeof console<"u"&&console.warn(w),St(!1)}};return[G,a.runOutsideAngular(K)]}else return[G,St(!1)]},[s,P,r])}collection(t,i){let r;typeof t=="string"?r=this.firestore.collection(t):r=t;let{ref:s,query:o}=fT(r,i),a=this.schedulers.ngZone.run(()=>s);return new s8(a,o,this)}collectionGroup(t,i){let r=i||(o=>o),s=this.firestore.collectionGroup(t);return new h9(r(s),this)}doc(t){let i;typeof t=="string"?i=this.firestore.doc(t):i=t;let r=this.schedulers.ngZone.run(()=>i);return new i8(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(i){return new(i||n)(D(Ua),D(ja,8),D(hT,8),D(bW,8),D(Ri),D(Se),D(J0),D(dT,8),D(_W,8),D(F2,8),D(i9,8),D(r9,8),D(s9,8),D(o9,8),D(a9,8),D(c9,8),D(B1,8))};static \u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),UZ=(()=>{class n{constructor(){cn.registerVersion("angularfire",F1.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:hT,useValue:!0},{provide:dT,useValue:t}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=be({type:n});static \u0275inj=we({providers:[f9]})}return n})();function pn(n){"@babel/helpers - typeof";return pn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pn(n)}function mT(n,e){if(pn(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(pn(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function o8(n){var e=mT(n,"string");return pn(e)=="symbol"?e:e+""}function A(n,e,t){return(e=o8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var Gt=Math.round;function m9(n,e){let t=n.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],i=t.map(r=>parseFloat(r));for(let r=0;r<3;r+=1)i[r]=e(i[r]||0,t[r]||"",r);return t[3]?i[3]=t[3].includes("%")?i[3]/100:i[3]:i[3]=1,i}var pT=(n,e,t)=>t===0?n:n/100;function q2(n,e){let t=e||255;return n>t?t:n<0?0:n}var q1=class n{constructor(e){A(this,"isValid",!0),A(this,"r",0),A(this,"g",0),A(this,"b",0),A(this,"a",1),A(this,"_h",void 0),A(this,"_s",void 0),A(this,"_l",void 0),A(this,"_v",void 0),A(this,"_max",void 0),A(this,"_min",void 0),A(this,"_brightness",void 0);function t(r){return r[0]in e&&r[1]in e&&r[2]in e}if(e)if(typeof e=="string"){let s=function(o){return r.startsWith(o)};var i=s;let r=e.trim();/^#?[A-F\d]{3,8}$/i.test(r)?this.fromHexString(r):s("rgb")?this.fromRgbString(r):s("hsl")?this.fromHslString(r):(s("hsv")||s("hsb"))&&this.fromHsvString(r)}else if(e instanceof n)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(t("rgb"))this.r=q2(e.r),this.g=q2(e.g),this.b=q2(e.b),this.a=typeof e.a=="number"?q2(e.a,1):1;else if(t("hsl"))this.fromHsl(e);else if(t("hsv"))this.fromHsv(e);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e))}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){let t=this.toHsv();return t.h=e,this._c(t)}getLuminance(){function e(s){let o=s/255;return o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4)}let t=e(this.r),i=e(this.g),r=e(this.b);return .2126*t+.7152*i+.0722*r}getHue(){if(typeof this._h>"u"){let e=this.getMax()-this.getMin();e===0?this._h=0:this._h=Gt(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(typeof this._s>"u"){let e=this.getMax()-this.getMin();e===0?this._s=0:this._s=e/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(e=10){let t=this.getHue(),i=this.getSaturation(),r=this.getLightness()-e/100;return r<0&&(r=0),this._c({h:t,s:i,l:r,a:this.a})}lighten(e=10){let t=this.getHue(),i=this.getSaturation(),r=this.getLightness()+e/100;return r>1&&(r=1),this._c({h:t,s:i,l:r,a:this.a})}mix(e,t=50){let i=this._c(e),r=t/100,s=a=>(i[a]-this[a])*r+this[a],o={r:Gt(s("r")),g:Gt(s("g")),b:Gt(s("b")),a:Gt(s("a")*100)/100};return this._c(o)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){let t=this._c(e),i=this.a+t.a*(1-this.a),r=s=>Gt((this[s]*this.a+t[s]*t.a*(1-this.a))/i);return this._c({r:r("r"),g:r("g"),b:r("b"),a:i})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#",t=(this.r||0).toString(16);e+=t.length===2?t:"0"+t;let i=(this.g||0).toString(16);e+=i.length===2?i:"0"+i;let r=(this.b||0).toString(16);if(e+=r.length===2?r:"0"+r,typeof this.a=="number"&&this.a>=0&&this.a<1){let s=Gt(this.a*255).toString(16);e+=s.length===2?s:"0"+s}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){let e=this.getHue(),t=Gt(this.getSaturation()*100),i=Gt(this.getLightness()*100);return this.a!==1?`hsla(${e},${t}%,${i}%,${this.a})`:`hsl(${e},${t}%,${i}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,t,i){let r=this.clone();return r[e]=q2(t,i),r}_c(e){return new this.constructor(e)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){let t=e.replace("#","");function i(r,s){return parseInt(t[r]+t[s||r],16)}t.length<6?(this.r=i(0),this.g=i(1),this.b=i(2),this.a=t[3]?i(3)/255:1):(this.r=i(0,1),this.g=i(2,3),this.b=i(4,5),this.a=t[6]?i(6,7)/255:1)}fromHsl({h:e,s:t,l:i,a:r}){if(this._h=e%360,this._s=t,this._l=i,this.a=typeof r=="number"?r:1,t<=0){let d=Gt(i*255);this.r=d,this.g=d,this.b=d}let s=0,o=0,a=0,c=e/60,l=(1-Math.abs(2*i-1))*t,u=l*(1-Math.abs(c%2-1));c>=0&&c<1?(s=l,o=u):c>=1&&c<2?(s=u,o=l):c>=2&&c<3?(o=l,a=u):c>=3&&c<4?(o=u,a=l):c>=4&&c<5?(s=u,a=l):c>=5&&c<6&&(s=l,a=u);let h=i-l/2;this.r=Gt((s+h)*255),this.g=Gt((o+h)*255),this.b=Gt((a+h)*255)}fromHsv({h:e,s:t,v:i,a:r}){this._h=e%360,this._s=t,this._v=i,this.a=typeof r=="number"?r:1;let s=Gt(i*255);if(this.r=s,this.g=s,this.b=s,t<=0)return;let o=e/60,a=Math.floor(o),c=o-a,l=Gt(i*(1-t)*255),u=Gt(i*(1-t*c)*255),h=Gt(i*(1-t*(1-c))*255);switch(a){case 0:this.g=h,this.b=l;break;case 1:this.r=u,this.b=l;break;case 2:this.r=l,this.b=h;break;case 3:this.r=l,this.g=u;break;case 4:this.r=h,this.g=l;break;case 5:default:this.g=l,this.b=u;break}}fromHsvString(e){let t=m9(e,pT);this.fromHsv({h:t[0],s:t[1],v:t[2],a:t[3]})}fromHslString(e){let t=m9(e,pT);this.fromHsl({h:t[0],s:t[1],l:t[2],a:t[3]})}fromRgbString(e){let t=m9(e,(i,r)=>r.includes("%")?Gt(i/100*255):i);this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}};var a8=2,gT=.16,SW=.05,TW=.05,EW=.15,bT=5,_T=4,MW=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function vT(n,e,t){var i;return Math.round(n.h)>=60&&Math.round(n.h)<=240?i=t?Math.round(n.h)-a8*e:Math.round(n.h)+a8*e:i=t?Math.round(n.h)+a8*e:Math.round(n.h)-a8*e,i<0?i+=360:i>=360&&(i-=360),i}function yT(n,e,t){if(n.h===0&&n.s===0)return n.s;var i;return t?i=n.s-gT*e:e===_T?i=n.s+gT:i=n.s+SW*e,i>1&&(i=1),t&&e===bT&&i>.1&&(i=.1),i<.06&&(i=.06),Math.round(i*100)/100}function wT(n,e,t){var i;return t?i=n.v+TW*e:i=n.v-EW*e,i=Math.max(0,Math.min(1,i)),Math.round(i*100)/100}function c8(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],i=new q1(n),r=i.toHsv(),s=bT;s>0;s-=1){var o=new q1({h:vT(r,s,!0),s:yT(r,s,!0),v:wT(r,s,!0)});t.push(o)}t.push(i);for(var a=1;a<=_T;a+=1){var c=new q1({h:vT(r,a),s:yT(r,a),v:wT(r,a)});t.push(c)}return e.theme==="dark"?MW.map(function(l){var u=l.index,h=l.amount;return new q1(e.backgroundColor||"#141414").mix(t[u],h).toHexString()}):t.map(function(l){return l.toHexString()})}var CT=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];CT.primary=CT[5];var ST=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];ST.primary=ST[5];var TT=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];TT.primary=TT[5];var ET=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];ET.primary=ET[5];var MT=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];MT.primary=MT[5];var zT=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];zT.primary=zT[5];var xT=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];xT.primary=xT[5];var OT=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];OT.primary=OT[5];var IT=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];IT.primary=IT[5];var AT=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];AT.primary=AT[5];var DT=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];DT.primary=DT[5];var kT=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];kT.primary=kT[5];var RT=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];RT.primary=RT[5];var LT=["#2a1215","#431418","#58181c","#791a1f","#a61d24","#d32029","#e84749","#f37370","#f89f9a","#fac8c3"];LT.primary=LT[5];var VT=["#2b1611","#441d12","#592716","#7c3118","#aa3e19","#d84a1b","#e87040","#f3956a","#f8b692","#fad4bc"];VT.primary=VT[5];var NT=["#2b1d11","#442a11","#593815","#7c4a15","#aa6215","#d87a16","#e89a3c","#f3b765","#f8cf8d","#fae3b7"];NT.primary=NT[5];var PT=["#2b2111","#443111","#594214","#7c5914","#aa7714","#d89614","#e8b339","#f3cc62","#f8df8b","#faedb5"];PT.primary=PT[5];var HT=["#2b2611","#443b11","#595014","#7c6e14","#aa9514","#d8bd14","#e8d639","#f3ea62","#f8f48b","#fafab5"];HT.primary=HT[5];var BT=["#1f2611","#2e3c10","#3e4f13","#536d13","#6f9412","#8bbb11","#a9d134","#c9e75d","#e4f88b","#f0fab5"];BT.primary=BT[5];var FT=["#162312","#1d3712","#274916","#306317","#3c8618","#49aa19","#6abe39","#8fd460","#b2e58b","#d5f2bb"];FT.primary=FT[5];var qT=["#112123","#113536","#144848","#146262","#138585","#13a8a8","#33bcb7","#58d1c9","#84e2d8","#b2f1e8"];qT.primary=qT[5];var UT=["#111a2c","#112545","#15325b","#15417e","#1554ad","#1668dc","#3c89e8","#65a9f3","#8dc5f8","#b7dcfa"];UT.primary=UT[5];var jT=["#131629","#161d40","#1c2755","#203175","#263ea0","#2b4acb","#5273e0","#7f9ef3","#a8c1f8","#d2e0fa"];jT.primary=jT[5];var WT=["#1a1325","#24163a","#301c4d","#3e2069","#51258f","#642ab5","#854eca","#ab7ae0","#cda8f0","#ebd7fa"];WT.primary=WT[5];var $T=["#291321","#40162f","#551c3b","#75204f","#a02669","#cb2b83","#e0529c","#f37fb7","#f8a8cc","#fad2e3"];$T.primary=$T[5];var GT=["#151515","#1f1f1f","#2d2d2d","#393939","#494949","#5a5a5a","#6a6a6a","#7b7b7b","#888888","#969696"];GT.primary=GT[5];var Lr="[@ant-design/icons-angular]:";function xW(n){console.error(`${Lr} ${n}.`)}function QT(n){Qs()&&console.warn(`${Lr} ${n}.`)}function YT(n){return c8(n)[0]}function l8(n,e){switch(e){case"fill":return`${n}-fill`;case"outline":return`${n}-o`;case"twotone":return`${n}-twotone`;case void 0:return n;default:throw new Error(`${Lr}Theme "${e}" is not a recognized theme!`)}}function OW(n,e,t,i){return`${l8(n,e)}-${t}-${i}`}function IW(n){return n==="o"?"outline":n}function AW(n){return n.endsWith("-fill")||n.endsWith("-o")||n.endsWith("-twotone")}function XT(n){return typeof n=="object"&&typeof n.name=="string"&&(typeof n.theme=="string"||n.theme===void 0)&&typeof n.icon=="string"}function DW(n){let e=n.split("-"),t=IW(e.splice(e.length-1,1)[0]);return{name:e.join("-"),theme:t,icon:""}}function kW(n){return n.cloneNode(!0)}function RW(n){return n.replace(/['"]#333['"]/g,'"primaryColor"').replace(/['"]#E6E6E6['"]/g,'"secondaryColor"').replace(/['"]#D9D9D9['"]/g,'"secondaryColor"').replace(/['"]#D8D8D8['"]/g,'"secondaryColor"')}function u8(n){let e=n.split(":");switch(e.length){case 1:return[n,""];case 2:return[e[1],e[0]];default:throw new Error(`${Lr}The icon type ${n} is not valid!`)}}function LW(n){return u8(n)[1]!==""}function VW(){return new Error(`${Lr}Type should have a namespace. Try "namespace:${name}".`)}function KT(n){return new Error(`${Lr}the icon ${n} does not exist or is not registered.`)}function NW(){return xW('you need to import "HttpClientModule" to use dynamic importing.'),null}function PW(n){return new Error(`${Lr}The url "${n}" is unsafe.`)}function HW(){return new Error(`${Lr}<svg> tag not found.`)}function BW(){return new Error(`${Lr}Importing timeout error.`)}var FW="__ant_icon_load",qW=new Ee("ant_icons"),p9=(()=>{class n{set twoToneColor({primaryColor:t,secondaryColor:i}){this._twoToneColorPalette.primaryColor=t,this._twoToneColorPalette.secondaryColor=i||YT(t)}get twoToneColor(){return Re({},this._twoToneColorPalette)}get _disableDynamicLoading(){return!1}constructor(t,i,r,s,o){this._rendererFactory=t,this._handler=i,this._document=r,this.sanitizer=s,this._antIcons=o,this.defaultTheme="outline",this._svgDefinitions=new Map,this._svgRenderedDefinitions=new Map,this._inProgressFetches=new Map,this._assetsUrlRoot="",this._twoToneColorPalette={primaryColor:"#333333",secondaryColor:"#E6E6E6"},this._enableJsonpLoading=!1,this._jsonpIconLoad$=new ce,this._renderer=this._rendererFactory.createRenderer(null,null),this._handler&&(this._http=new Zm(this._handler)),this._antIcons&&this.addIcon(...this._antIcons)}useJsonpLoading(){this._enableJsonpLoading?QT("You are already using jsonp loading."):(this._enableJsonpLoading=!0,window[FW]=t=>{this._jsonpIconLoad$.next(t)})}changeAssetsSource(t){this._assetsUrlRoot=t.endsWith("/")?t:t+"/"}addIcon(...t){t.forEach(i=>{this._svgDefinitions.set(l8(i.name,i.theme),i)})}addIconLiteral(t,i){let[r,s]=u8(t);if(!s)throw VW();this.addIcon({name:t,icon:i})}clear(){this._svgDefinitions.clear(),this._svgRenderedDefinitions.clear()}getRenderedContent(t,i){let r=XT(t)?t:this._svgDefinitions.get(t)||null;if(!r&&this._disableDynamicLoading)throw KT(t);return(r?St(r):this._loadIconDynamically(t)).pipe(Ge(o=>{if(!o)throw KT(t);return this._loadSVGFromCacheOrCreateNew(o,i)}))}getCachedIcons(){return this._svgDefinitions}_loadIconDynamically(t){if(!this._http&&!this._enableJsonpLoading)return St(NW());let i=this._inProgressFetches.get(t);if(!i){let[r,s]=u8(t),o=s?{name:t,icon:""}:DW(r),a=this._enableJsonpLoading?".js":".svg",c=(s?`${this._assetsUrlRoot}assets/${s}/${r}`:`${this._assetsUrlRoot}assets/${o.theme}/${o.name}`)+a,l=this.sanitizer.sanitize(Nm.URL,c);if(!l)throw PW(c);i=(this._enableJsonpLoading?this._loadIconDynamicallyWithJsonp(o,l):this._http.get(l,{responseType:"text"}).pipe(Ge(h=>qn(Re({},o),{icon:h})))).pipe(bc(h=>this.addIcon(h)),yc(()=>this._inProgressFetches.delete(t)),zm(()=>St(null)),Am()),this._inProgressFetches.set(t,i)}return i}_loadIconDynamicallyWithJsonp(t,i){return new vn(r=>{let s=this._document.createElement("script"),o=setTimeout(()=>{a(),r.error(BW())},6e3);s.src=i;function a(){s.parentNode.removeChild(s),clearTimeout(o)}this._document.body.appendChild(s),this._jsonpIconLoad$.pipe(qt(c=>c.name===t.name&&c.theme===t.theme),Di(1)).subscribe(c=>{r.next(c),a()})})}_loadSVGFromCacheOrCreateNew(t,i){let r,s=i||this._twoToneColorPalette.primaryColor,o=YT(s)||this._twoToneColorPalette.secondaryColor,a=t.theme==="twotone"?OW(t.name,t.theme,s,o):t.theme===void 0?t.name:l8(t.name,t.theme),c=this._svgRenderedDefinitions.get(a);return c?r=c.icon:(r=this._setSVGAttribute(this._colorizeSVGIcon(this._createSVGElementFromString(LW(t.name)?t.icon:RW(t.icon)),t.theme==="twotone",s,o)),this._svgRenderedDefinitions.set(a,qn(Re({},t),{icon:r}))),kW(r)}_createSVGElementFromString(t){let i=this._document.createElement("div");i.innerHTML=t;let r=i.querySelector("svg");if(!r)throw HW;return r}_setSVGAttribute(t){return this._renderer.setAttribute(t,"width","1em"),this._renderer.setAttribute(t,"height","1em"),t}_colorizeSVGIcon(t,i,r,s){if(i){let o=t.childNodes,a=o.length;for(let c=0;c<a;c++){let l=o[c];l.getAttribute("fill")==="secondaryColor"?this._renderer.setAttribute(l,"fill",s):this._renderer.setAttribute(l,"fill",r)}}return this._renderer.setAttribute(t,"fill","currentColor"),t}static{this.\u0275fac=function(i){return new(i||n)(D(so),D(Oc,8),D(Tt,8),D(Ic),D(qW,8))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac})}}return n})();function UW(n,e){return n.type===e.type&&n.theme===e.theme&&n.twoToneColor===e.twoToneColor}var ZT=(()=>{class n{constructor(t,i,r){this._iconService=t,this._elementRef=i,this._renderer=r}ngOnChanges(t){(t.type||t.theme||t.twoToneColor)&&this._changeIcon()}_changeIcon(){return new Promise(t=>{if(!this.type){this._clearSVGElement(),t(null);return}let i=this._getSelfRenderMeta();this._iconService.getRenderedContent(this._parseIconType(this.type,this.theme),this.twoToneColor).subscribe(r=>{let s=this._getSelfRenderMeta();UW(i,s)?(this._setSVGElement(r),t(r)):t(null)})})}_getSelfRenderMeta(){return{type:this.type,theme:this.theme,twoToneColor:this.twoToneColor}}_parseIconType(t,i){if(XT(t))return t;{let[r,s]=u8(t);return s?t:AW(r)?(i&&QT(`'type' ${r} already gets a theme inside so 'theme' ${i} would be ignored`),r):l8(r,i||this._iconService.defaultTheme)}}_setSVGElement(t){this._clearSVGElement(),this._renderer.appendChild(this._elementRef.nativeElement,t)}_clearSVGElement(){let t=this._elementRef.nativeElement,i=t.childNodes,r=i.length;for(let s=r-1;s>=0;s--){let o=i[s];o.tagName?.toLowerCase()==="svg"&&this._renderer.removeChild(t,o)}}static{this.\u0275fac=function(i){return new(i||n)($(p9),$($e),$(Br))}}static{this.\u0275dir=We({type:n,selectors:[["","antIcon",""]],inputs:{type:"type",theme:"theme",twoToneColor:"twoToneColor"},features:[wn]})}}return n})();var h8={isTestMode:!1};var JT={},jW="[NG-ZORRO]:";function WW(...n){let e=n.reduce((t,i)=>t+i.toString(),"");return JT[e]?!1:(JT[e]=!0,!0)}function $W(n,...e){(h8.isTestMode||Qs()&&WW(...e))&&n(...e)}var U2=(...n)=>$W((...e)=>console.warn(jW,...e),...n);var eE={name:"bars",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'};var tE={name:"calendar",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z" /></svg>'};var nE={name:"caret-down",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'},iE={name:"caret-down",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'};var rE={name:"caret-up",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'},sE={name:"caret-up",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'};var oE={name:"check-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z" /></svg>'},aE={name:"check-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z" /><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /></svg>'};var cE={name:"close-circle",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z" /></svg>'};var lE={name:"close",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z" /></svg>'};var uE={name:"check",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z" /></svg>'},hE={name:"clock-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z" /></svg>'};var dE={name:"copy",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z" /></svg>'};var fE={name:"delete",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z" /></svg>'};var mE={name:"double-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z" /></svg>'},pE={name:"double-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 00188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 00492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z" /></svg>'};var gE={name:"down",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z" /></svg>'};var vE={name:"close-circle",theme:"fill",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z" /></svg>'};var yE={name:"ellipsis",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'};var wE={name:"edit",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z" /></svg>'};var bE={name:"exclamation-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'};var _E={name:"eye",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z" /></svg>'};var CE={name:"file",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.7c6 6 9.4 14.1 9.4 22.6V928c0 17.7-14.3 32-32 32H192c-17.7 0-32-14.3-32-32V96c0-17.7 14.3-32 32-32h424.7c8.5 0 16.7 3.4 22.7 9.4l215.2 215.3zM790.2 326L602 137.8V326h188.2z" /></svg>'};var SE={name:"file",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z" /></svg>'};var TE={name:"filter",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M349 838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V642H349v196zm531.1-684H143.9c-24.5 0-39.8 26.7-27.5 48l221.3 376h348.8l221.3-376c12.1-21.3-3.2-48-27.7-48z" /></svg>'};var EE={name:"info-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'};var ME={name:"exclamation-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z" /></svg>'};var zE={name:"info-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z" /></svg>'};var xE={name:"left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z" /></svg>'};var OE={name:"loading",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z" /></svg>'};var IE={name:"paper-clip",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z" /></svg>'};var AE={name:"question-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z" /></svg>'};var DE={name:"rotate-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-.4-12.6 6.1l-.2 64c-118.6.5-235.8 53.4-314.6 154.2A399.75 399.75 0 00123.5 631h74.9c-.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8z" /><path d="M880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H396V494h440v326z" /></svg>'};var kE={name:"right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z" /></svg>'};var RE={name:"search",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z" /></svg>'};var g9={name:"star",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z" /></svg>'};var LE={name:"swap",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z" /></svg>'},VE={name:"swap-right",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M873.1 596.2l-164-208A32 32 0 00684 376h-64.8c-6.7 0-10.4 7.7-6.3 13l144.3 183H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h695.9c26.8 0 41.7-30.8 25.2-51.8z" /></svg>'};var NE={name:"up",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z" /></svg>'};var PE={name:"rotate-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H188V494h440v326z" /><path d="M819.3 328.5c-78.8-100.7-196-153.6-314.6-154.2l-.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7.4 12.6-6.1v-63.9c12.9.1 25.9.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8a325.95 325.95 0 016.5 140.9h74.9c14.8-103.6-11.3-213-81-302.3z" /></svg>'};var HE={name:"vertical-align-top",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z" /></svg>'};var BE={name:"zoom-in",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'};var FE={name:"zoom-out",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'},qE={name:"upload",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z" /></svg>'};function Bt(n,e){GW(n)&&(n="100%");let t=YW(n);return n=e===360?n:Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(String(n*e),10)/100),Math.abs(n-e)<1e-6?1:(e===360?n=(n<0?n%e+e:n%e)/parseFloat(String(e)):n=n%e/parseFloat(String(e)),n)}function j2(n){return Math.min(1,Math.max(0,n))}function GW(n){return typeof n=="string"&&n.indexOf(".")!==-1&&parseFloat(n)===1}function YW(n){return typeof n=="string"&&n.indexOf("%")!==-1}function d8(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function W2(n){return Number(n)<=1?`${Number(n)*100}%`:n}function qs(n){return n.length===1?"0"+n:String(n)}function UE(n,e,t){return{r:Bt(n,255)*255,g:Bt(e,255)*255,b:Bt(t,255)*255}}function y9(n,e,t){n=Bt(n,255),e=Bt(e,255),t=Bt(t,255);let i=Math.max(n,e,t),r=Math.min(n,e,t),s=0,o=0,a=(i+r)/2;if(i===r)o=0,s=0;else{let c=i-r;switch(o=a>.5?c/(2-i-r):c/(i+r),i){case n:s=(e-t)/c+(e<t?6:0);break;case e:s=(t-n)/c+2;break;case t:s=(n-e)/c+4;break;default:break}s/=6}return{h:s,s:o,l:a}}function v9(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*(6*t):t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function jE(n,e,t){let i,r,s;if(n=Bt(n,360),e=Bt(e,100),t=Bt(t,100),e===0)r=t,s=t,i=t;else{let o=t<.5?t*(1+e):t+e-t*e,a=2*t-o;i=v9(a,o,n+1/3),r=v9(a,o,n),s=v9(a,o,n-1/3)}return{r:i*255,g:r*255,b:s*255}}function $2(n,e,t){n=Bt(n,255),e=Bt(e,255),t=Bt(t,255);let i=Math.max(n,e,t),r=Math.min(n,e,t),s=0,o=i,a=i-r,c=i===0?0:a/i;if(i===r)s=0;else{switch(i){case n:s=(e-t)/a+(e<t?6:0);break;case e:s=(t-n)/a+2;break;case t:s=(n-e)/a+4;break;default:break}s/=6}return{h:s,s:c,v:o}}function WE(n,e,t){n=Bt(n,360)*6,e=Bt(e,100),t=Bt(t,100);let i=Math.floor(n),r=n-i,s=t*(1-e),o=t*(1-r*e),a=t*(1-(1-r)*e),c=i%6,l=[t,o,s,s,a,t][c],u=[a,t,t,o,s,s][c],h=[s,s,a,t,t,o][c];return{r:l*255,g:u*255,b:h*255}}function G2(n,e,t,i){let r=[qs(Math.round(n).toString(16)),qs(Math.round(e).toString(16)),qs(Math.round(t).toString(16))];return i&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function $E(n,e,t,i,r){let s=[qs(Math.round(n).toString(16)),qs(Math.round(e).toString(16)),qs(Math.round(t).toString(16)),qs(KW(i))];return r&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function GE(n,e,t,i){let r=n/100,s=e/100,o=t/100,a=i/100,c=255*(1-r)*(1-a),l=255*(1-s)*(1-a),u=255*(1-o)*(1-a);return{r:c,g:l,b:u}}function w9(n,e,t){let i=1-n/255,r=1-e/255,s=1-t/255,o=Math.min(i,r,s);return o===1?(i=0,r=0,s=0):(i=(i-o)/(1-o)*100,r=(r-o)/(1-o)*100,s=(s-o)/(1-o)*100),o*=100,{c:Math.round(i),m:Math.round(r),y:Math.round(s),k:Math.round(o)}}function KW(n){return Math.round(parseFloat(n)*255).toString(16)}function b9(n){return An(n)/255}function An(n){return parseInt(n,16)}function YE(n){return{r:n>>16,g:(n&65280)>>8,b:n&255}}var Y2={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function js(n){let e={r:0,g:0,b:0},t=1,i=null,r=null,s=null,o=!1,a=!1;return typeof n=="string"&&(n=ZW(n)),typeof n=="object"&&(Bn(n.r)&&Bn(n.g)&&Bn(n.b)?(e=UE(n.r,n.g,n.b),o=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):Bn(n.h)&&Bn(n.s)&&Bn(n.v)?(i=W2(n.s),r=W2(n.v),e=WE(n.h,i,r),o=!0,a="hsv"):Bn(n.h)&&Bn(n.s)&&Bn(n.l)?(i=W2(n.s),s=W2(n.l),e=jE(n.h,i,s),o=!0,a="hsl"):Bn(n.c)&&Bn(n.m)&&Bn(n.y)&&Bn(n.k)&&(e=GE(n.c,n.m,n.y,n.k),o=!0,a="cmyk"),Object.prototype.hasOwnProperty.call(n,"a")&&(t=n.a)),t=d8(t),{ok:o,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}var QW="[-\\+]?\\d+%?",XW="[-\\+]?\\d*\\.\\d+%?",Us="(?:"+XW+")|(?:"+QW+")",_9="[\\s|\\(]+("+Us+")[,|\\s]+("+Us+")[,|\\s]+("+Us+")\\s*\\)?",f8="[\\s|\\(]+("+Us+")[,|\\s]+("+Us+")[,|\\s]+("+Us+")[,|\\s]+("+Us+")\\s*\\)?",oi={CSS_UNIT:new RegExp(Us),rgb:new RegExp("rgb"+_9),rgba:new RegExp("rgba"+f8),hsl:new RegExp("hsl"+_9),hsla:new RegExp("hsla"+f8),hsv:new RegExp("hsv"+_9),hsva:new RegExp("hsva"+f8),cmyk:new RegExp("cmyk"+f8),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function ZW(n){if(n=n.trim().toLowerCase(),n.length===0)return!1;let e=!1;if(Y2[n])n=Y2[n],e=!0;else if(n==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};let t=oi.rgb.exec(n);return t?{r:t[1],g:t[2],b:t[3]}:(t=oi.rgba.exec(n),t?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=oi.hsl.exec(n),t?{h:t[1],s:t[2],l:t[3]}:(t=oi.hsla.exec(n),t?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=oi.hsv.exec(n),t?{h:t[1],s:t[2],v:t[3]}:(t=oi.hsva.exec(n),t?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=oi.cmyk.exec(n),t?{c:t[1],m:t[2],y:t[3],k:t[4]}:(t=oi.hex8.exec(n),t?{r:An(t[1]),g:An(t[2]),b:An(t[3]),a:b9(t[4]),format:e?"name":"hex8"}:(t=oi.hex6.exec(n),t?{r:An(t[1]),g:An(t[2]),b:An(t[3]),format:e?"name":"hex"}:(t=oi.hex4.exec(n),t?{r:An(t[1]+t[1]),g:An(t[2]+t[2]),b:An(t[3]+t[3]),a:b9(t[4]+t[4]),format:e?"name":"hex8"}:(t=oi.hex3.exec(n),t?{r:An(t[1]+t[1]),g:An(t[2]+t[2]),b:An(t[3]+t[3]),format:e?"name":"hex"}:!1))))))))))}function Bn(n){return typeof n=="number"?!Number.isNaN(n):oi.CSS_UNIT.test(n)}var Wa=class n{constructor(e="",t={}){if(e instanceof n)return e;typeof e=="number"&&(e=YE(e)),this.originalInput=e;let i=js(e);this.originalInput=e,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=t.format??i.format,this.gradientType=t.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}getBrightness(){let e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3}getLuminance(){let e=this.toRgb(),t,i,r,s=e.r/255,o=e.g/255,a=e.b/255;return s<=.03928?t=s/12.92:t=Math.pow((s+.055)/1.055,2.4),o<=.03928?i=o/12.92:i=Math.pow((o+.055)/1.055,2.4),a<=.03928?r=a/12.92:r=Math.pow((a+.055)/1.055,2.4),.2126*t+.7152*i+.0722*r}getAlpha(){return this.a}setAlpha(e){return this.a=d8(e),this.roundA=Math.round(100*this.a)/100,this}isMonochrome(){let{s:e}=this.toHsl();return e===0}toHsv(){let e=$2(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}}toHsvString(){let e=$2(this.r,this.g,this.b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this.a===1?`hsv(${t}, ${i}%, ${r}%)`:`hsva(${t}, ${i}%, ${r}%, ${this.roundA})`}toHsl(){let e=y9(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}}toHslString(){let e=y9(this.r,this.g,this.b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this.a===1?`hsl(${t}, ${i}%, ${r}%)`:`hsla(${t}, ${i}%, ${r}%, ${this.roundA})`}toHex(e=!1){return G2(this.r,this.g,this.b,e)}toHexString(e=!1){return"#"+this.toHex(e)}toHex8(e=!1){return $E(this.r,this.g,this.b,this.a,e)}toHex8String(e=!1){return"#"+this.toHex8(e)}toHexShortString(e=!1){return this.a===1?this.toHexString(e):this.toHex8String(e)}toRgb(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}toRgbString(){let e=Math.round(this.r),t=Math.round(this.g),i=Math.round(this.b);return this.a===1?`rgb(${e}, ${t}, ${i})`:`rgba(${e}, ${t}, ${i}, ${this.roundA})`}toPercentageRgb(){let e=t=>`${Math.round(Bt(t,255)*100)}%`;return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}}toPercentageRgbString(){let e=t=>Math.round(Bt(t,255)*100);return this.a===1?`rgb(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%)`:`rgba(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%, ${this.roundA})`}toCmyk(){return Re({},w9(this.r,this.g,this.b))}toCmykString(){let{c:e,m:t,y:i,k:r}=w9(this.r,this.g,this.b);return`cmyk(${e}, ${t}, ${i}, ${r})`}toName(){if(this.a===0)return"transparent";if(this.a<1)return!1;let e="#"+G2(this.r,this.g,this.b,!1);for(let[t,i]of Object.entries(Y2))if(e===i)return t;return!1}toString(e){let t=!!e;e=e??this.format;let i=!1,r=this.a<1&&this.a>=0;return!t&&r&&(e.startsWith("hex")||e==="name")?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),e==="cmyk"&&(i=this.toCmykString()),i||this.toHexString())}toNumber(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)}clone(){return new n(this.toString())}lighten(e=10){let t=this.toHsl();return t.l+=e/100,t.l=j2(t.l),new n(t)}brighten(e=10){let t=this.toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),new n(t)}darken(e=10){let t=this.toHsl();return t.l-=e/100,t.l=j2(t.l),new n(t)}tint(e=10){return this.mix("white",e)}shade(e=10){return this.mix("black",e)}desaturate(e=10){let t=this.toHsl();return t.s-=e/100,t.s=j2(t.s),new n(t)}saturate(e=10){let t=this.toHsl();return t.s+=e/100,t.s=j2(t.s),new n(t)}greyscale(){return this.desaturate(100)}spin(e){let t=this.toHsl(),i=(t.h+e)%360;return t.h=i<0?360+i:i,new n(t)}mix(e,t=50){let i=this.toRgb(),r=new n(e).toRgb(),s=t/100,o={r:(r.r-i.r)*s+i.r,g:(r.g-i.g)*s+i.g,b:(r.b-i.b)*s+i.b,a:(r.a-i.a)*s+i.a};return new n(o)}analogous(e=6,t=30){let i=this.toHsl(),r=360/t,s=[this];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,s.push(new n(i));return s}complement(){let e=this.toHsl();return e.h=(e.h+180)%360,new n(e)}monochromatic(e=6){let t=this.toHsv(),{h:i}=t,{s:r}=t,{v:s}=t,o=[],a=1/e;for(;e--;)o.push(new n({h:i,s:r,v:s})),s=(s+a)%1;return o}splitcomplement(){let e=this.toHsl(),{h:t}=e;return[this,new n({h:(t+72)%360,s:e.s,l:e.l}),new n({h:(t+216)%360,s:e.s,l:e.l})]}onBackground(e){let t=this.toRgb(),i=new n(e).toRgb(),r=t.a+i.a*(1-t.a);return new n({r:(t.r*t.a+i.r*i.a*(1-t.a))/r,g:(t.g*t.a+i.g*i.a*(1-t.a))/r,b:(t.b*t.a+i.b*i.a*(1-t.a))/r,a:r})}triad(){return this.polyad(3)}tetrad(){return this.polyad(4)}polyad(e){let t=this.toHsl(),{h:i}=t,r=[this],s=360/e;for(let o=1;o<e;o++)r.push(new n({h:(i+o*s)%360,s:t.s,l:t.l}));return r}equals(e){let t=new n(e);return this.format==="cmyk"||t.format==="cmyk"?this.toCmykString()===t.toCmykString():this.toRgbString()===t.toRgbString()}};var JW=["success","processing","error","default","warning"],e$=["pink","red","yellow","orange","cyan","green","blue","purple","geekblue","magenta","volcano","gold","lime"];function $J(n){return e$.indexOf(n)!==-1}function GJ(n){return JW.indexOf(n)!==-1}var m8=2,KE=.16,t$=.05,n$=.05,i$=.15,eM=5,tM=4,r$=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function QE({r:n,g:e,b:t}){let i=$2(n,e,t);return{h:i.h*360,s:i.s,v:i.v}}function p8({r:n,g:e,b:t}){return`#${G2(n,e,t,!1)}`}function s$(n,e,t){let i=t/100;return{r:(e.r-n.r)*i+n.r,g:(e.g-n.g)*i+n.g,b:(e.b-n.b)*i+n.b}}function XE(n,e,t){let i;return Math.round(n.h)>=60&&Math.round(n.h)<=240?i=t?Math.round(n.h)-m8*e:Math.round(n.h)+m8*e:i=t?Math.round(n.h)+m8*e:Math.round(n.h)-m8*e,i<0?i+=360:i>=360&&(i-=360),i}function ZE(n,e,t){if(n.h===0&&n.s===0)return n.s;let i;return t?i=n.s-KE*e:e===tM?i=n.s+KE:i=n.s+t$*e,i>1&&(i=1),t&&e===eM&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function JE(n,e,t){let i;return t?i=n.v+n$*e:i=n.v-i$*e,i>1&&(i=1),Number(i.toFixed(2))}function C9(n,e={}){let t=[],i=js(n);for(let r=eM;r>0;r-=1){let s=QE(i),o=p8(js({h:XE(s,r,!0),s:ZE(s,r,!0),v:JE(s,r,!0)}));t.push(o)}t.push(p8(i));for(let r=1;r<=tM;r+=1){let s=QE(i),o=p8(js({h:XE(s,r),s:ZE(s,r),v:JE(s,r)}));t.push(o)}return e.theme==="dark"?r$.map(({index:r,opacity:s})=>p8(s$(js(e.backgroundColor||"#141414"),js(t[r]),s*100))):t}function nM(n){return n!=null&&`${n}`!="false"}function U1(n,e=0){return o$(n)?Number(n):arguments.length===2?e:0}function o$(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function $a(n){return Array.isArray(n)?n:[n]}function gt(n){return n==null?"":typeof n=="string"?n:`${n}px`}function iM(n){return n instanceof $e?n.nativeElement:n}function tee(n){let e;return n==null?e=[]:Array.isArray(n)?e=n:e=[n],e}function nee(n,e){if(!n||!e||n.length!==e.length)return!1;let t=n.length;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function iee(n){return typeof n<"u"&&n!==null}function ree(n){return typeof n>"u"||n===null}function see(n){return typeof n=="string"&&n!==""}function oee(n){return n instanceof bn}function aee(n){return nM(n)}function cee(n){return Mc(n,0)}function lee(n,e=0){return U1(n,e)}function K2(n){return gt(n)}function uee(n,...e){return typeof n=="function"?n(...e):n}function hee(n){if(!n.getClientRects().length)return{top:0,left:0};let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView;return{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}}function dee(n,e,t){if(n.length>e)return n;let i=`${a$(e,t)}${n}`;return i.slice(i.length-e,i.length)}function a$(n,e){return Array(n).fill(e).join("")}function c$(n){return!!n&&typeof n.then=="function"&&typeof n.catch=="function"}function fee(n){return typeof n=="number"&&isFinite(n)}function mee(n,e){return Math.round(n*Math.pow(10,e))/Math.pow(10,e)}var l$=typeof window<"u",pee=l$&&window.mozInnerScreenX!=null;var S9,T9,rM={position:"absolute",top:"-9999px",width:"50px",height:"50px"};function gee(n="vertical",e="ant"){if(typeof document>"u"||typeof window>"u")return 0;let t=n==="vertical";if(t&&S9)return S9;if(!t&&T9)return T9;let i=document.createElement("div");Object.keys(rM).forEach(s=>{i.style[s]=rM[s]}),i.className=`${e}-hide-scrollbar scroll-div-append-to-body`,t?i.style.overflowY="scroll":i.style.overflowX="scroll",document.body.appendChild(i);let r=0;return t?(r=i.offsetWidth-i.clientWidth,S9=r):(r=i.offsetHeight-i.clientHeight,T9=r),document.body.removeChild(i),r}function vee(){let n=new ce;return Promise.resolve().then(()=>n.next()),n.pipe(Di(1))}function yee(n){return eo(n)?n:c$(n)?Un(Promise.resolve(n)):St(n)}function M9(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var u$="rc-util-key";function oM({mark:n}={}){return n?n.startsWith("data-")?n:`data-${n}`:u$}function z9(n){return n.attachTo?n.attachTo:document.querySelector("head")||document.body}function sM(n,e={}){if(!M9())return null;let t=document.createElement("style");e.cspNonce&&(t.nonce=e.cspNonce),t.innerHTML=n;let i=z9(e),{firstChild:r}=i;return e.prepend&&i.prepend?i.prepend(t):e.prepend&&r?i.insertBefore(t,r):i.appendChild(t),t}var E9=new Map;function h$(n,e={}){let t=z9(e);return Array.from(E9.get(t)?.children||[]).find(i=>i.tagName==="STYLE"&&i.getAttribute(oM(e))===n)}function aM(n,e,t={}){let i=z9(t);if(!E9.has(i)){let o=sM("",t),{parentNode:a}=o;E9.set(i,a),a.removeChild(o)}let r=h$(e,t);if(r)return t.cspNonce&&r.nonce!==t.cspNonce&&(r.nonce=t.cspNonce),r.innerHTML!==n&&(r.innerHTML=n),r;let s=sM(n,t);return s?.setAttribute(oM(t),e),s}function wee(n,e,t){return{[`${n}-status-success`]:e==="success",[`${n}-status-warning`]:e==="warning",[`${n}-status-error`]:e==="error",[`${n}-status-validating`]:e==="validating",[`${n}-has-feedback`]:t}}var d$=new Ee("nz-config");var f$=`-ant-${Date.now()}-${Math.random()}`;function m$(n,e){let t={},i=(o,a)=>{let c=o.clone();return c=a?.(c)||c,c.toRgbString()},r=(o,a)=>{let c=new Wa(o),l=C9(c.toRgbString());t[`${a}-color`]=i(c),t[`${a}-color-disabled`]=l[1],t[`${a}-color-hover`]=l[4],t[`${a}-color-active`]=l[7],t[`${a}-color-outline`]=c.clone().setAlpha(.2).toRgbString(),t[`${a}-color-deprecated-bg`]=l[1],t[`${a}-color-deprecated-border`]=l[3]};if(e.primaryColor){r(e.primaryColor,"primary");let o=new Wa(e.primaryColor),a=C9(o.toRgbString());a.forEach((l,u)=>{t[`primary-${u+1}`]=l}),t["primary-color-deprecated-l-35"]=i(o,l=>l.lighten(35)),t["primary-color-deprecated-l-20"]=i(o,l=>l.lighten(20)),t["primary-color-deprecated-t-20"]=i(o,l=>l.tint(20)),t["primary-color-deprecated-t-50"]=i(o,l=>l.tint(50)),t["primary-color-deprecated-f-12"]=i(o,l=>l.setAlpha(l.getAlpha()*.12));let c=new Wa(a[0]);t["primary-color-active-deprecated-f-30"]=i(c,l=>l.setAlpha(l.getAlpha()*.3)),t["primary-color-active-deprecated-d-02"]=i(c,l=>l.darken(2))}return e.successColor&&r(e.successColor,"success"),e.warningColor&&r(e.warningColor,"warning"),e.errorColor&&r(e.errorColor,"error"),e.infoColor&&r(e.infoColor,"info"),`
  :root {
    ${Object.keys(t).map(o=>`--${n}-${o}: ${t[o]};`).join(`
`)}
  }
  `.trim()}function cM(n,e,t){let i=m$(n,e);M9()?aM(i,`${f$}-dynamic-theme`,{cspNonce:t}):U2("NzConfigService: SSR do not support dynamic theme with css variables.")}var lM=function(n){return n!==void 0},uM="ant",Vr=(()=>{class n{constructor(){this.configUpdated$=new ce,this.config=Ze(d$,{optional:!0})||{},this.cspNonce=Ze(ro,{optional:!0}),this.config.theme&&cM(this.getConfig().prefixCls?.prefixCls||uM,this.config.theme,this.cspNonce)}getConfig(){return this.config}getConfigForComponent(t){return this.config[t]}getConfigChangeEventForComponent(t){return this.configUpdated$.pipe(qt(i=>i===t),Om(void 0))}set(t,i){this.config[t]=Re(Re({},this.config[t]),i),t==="theme"&&this.config.theme&&cM(this.getConfig().prefixCls?.prefixCls||uM,this.config.theme,this.cspNonce),this.configUpdated$.next(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function hM(){return function(e,t,i){let r=`$$__zorroConfigDecorator__${t}`;return Object.defineProperty(e,r,{configurable:!0,writable:!0,enumerable:!1}),{get(){let s=i?.get?i.get.bind(this)():this[r],o=(this.propertyAssignCounter?.[t]||0)>1,a=this.nzConfigService.getConfigForComponent(this._nzModuleName)?.[t];return o&&lM(s)?s:lM(a)?a:s},set(s){this.propertyAssignCounter=this.propertyAssignCounter||{},this.propertyAssignCounter[t]=(this.propertyAssignCounter[t]||0)+1,i?.set?i.set.bind(this)(s):this[r]=s},configurable:!0,enumerable:!0}}}var O9;try{O9=typeof Intl<"u"&&Intl.v8BreakIterator}catch{O9=!1}var gn=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Xm(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||O9)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(i){return new(i||n)(D(Ri))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Lee=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({})}}return n})();var Q2;function p$(){if(Q2==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Q2=!0}))}finally{Q2=Q2||!1}return Q2}function Vee(n){return p$()?n:!!n.capture}var Ai=function(n){return n[n.NORMAL=0]="NORMAL",n[n.NEGATED=1]="NEGATED",n[n.INVERTED=2]="INVERTED",n}(Ai||{}),v8,j1;function y8(){if(j1==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return j1=!1,j1;if("scrollBehavior"in document.documentElement.style)j1=!0;else{let n=Element.prototype.scrollTo;n?j1=!/\{\s*\[native code\]\s*\}/.test(n.toString()):j1=!1}}return j1}function Ga(){if(typeof document!="object"||!document)return Ai.NORMAL;if(v8==null){let n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";let t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),v8=Ai.NORMAL,n.scrollLeft===0&&(n.scrollLeft=1,v8=n.scrollLeft===0?Ai.NEGATED:Ai.INVERTED),n.remove()}return v8}var x9;function g$(){if(x9==null){let n=typeof document<"u"?document.head:null;x9=!!(n&&(n.createShadowRoot||n.attachShadow))}return x9}function Nee(n){if(g$()){let e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function Pee(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){let e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function w8(n){return n.composedPath?n.composedPath()[0]:n.target}function I9(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var v$=[eE,tE,rE,sE,nE,iE,oE,aE,uE,hE,cE,vE,lE,dE,fE,mE,pE,gE,wE,yE,bE,ME,_E,CE,SE,TE,EE,zE,xE,OE,IE,AE,kE,DE,PE,g9,RE,g9,qE,HE,NE,LE,VE,BE,FE],fM=new Ee("nz_icons"),Xee=new Ee("nz_icon_default_twotone_color"),dM="#1890ff",mM=(()=>{class n extends p9{get _disableDynamicLoading(){return!this.platform.isBrowser}ngOnDestroy(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}normalizeSvgElement(t){t.getAttribute("viewBox")||this._renderer.setAttribute(t,"viewBox","0 0 1024 1024"),(!t.getAttribute("width")||!t.getAttribute("height"))&&(this._renderer.setAttribute(t,"width","1em"),this._renderer.setAttribute(t,"height","1em")),t.getAttribute("fill")||this._renderer.setAttribute(t,"fill","currentColor")}fetchFromIconfont(t){let{scriptUrl:i}=t;if(this._document&&!this.iconfontCache.has(i)){let r=this._renderer.createElement("script");this._renderer.setAttribute(r,"src",i),this._renderer.setAttribute(r,"data-namespace",i.replace(/^(https?|http):/g,"")),this._renderer.appendChild(this._document.body,r),this.iconfontCache.add(i)}}createIconfontIcon(t){return this._createSVGElementFromString(`<svg><use xlink:href="${t}"></svg>`)}constructor(t,i,r,s){super(t,Ze(Oc,{optional:!0}),Ze(Tt),i,[...v$,...Ze(fM,{optional:!0})||[]]),this.nzConfigService=r,this.platform=s,this.configUpdated$=new ce,this.iconfontCache=new Set,this.subscription=null,this.onConfigChange(),this.configDefaultTwotoneColor(),this.configDefaultTheme()}onConfigChange(){this.subscription=this.nzConfigService.getConfigChangeEventForComponent("icon").subscribe(()=>{this.configDefaultTwotoneColor(),this.configDefaultTheme(),this.configUpdated$.next()})}configDefaultTheme(){let t=this.getConfig();this.defaultTheme=t.nzTheme||"outline"}configDefaultTwotoneColor(){let i=this.getConfig().nzTwotoneColor||dM,r=dM;i&&(i.startsWith("#")?r=i:U2("Twotone color must be a hex color!")),this.twoToneColor={primaryColor:r}}getConfig(){return this.nzConfigService.getConfigForComponent("icon")||{}}static{this.\u0275fac=function(i){return new(i||n)(D(so),D(Ic),D(Vr),D(gn))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),pM=new Ee("nz_icons_patch"),gM=(()=>{class n{constructor(t){this.rootIconService=t,this.patched=!1,this.extraIcons=Ze(pM,{self:!0})}doPatch(){this.patched||(this.extraIcons.forEach(t=>this.rootIconService.addIcon(t)),this.patched=!0)}static{this.\u0275fac=function(i){return new(i||n)(D(mM))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac})}}return n})(),Ws=(()=>{class n extends ZT{set nzSpin(t){this.spin=t}set nzType(t){this.type=t}set nzTheme(t){this.theme=t}set nzTwotoneColor(t){this.twoToneColor=t}set nzIconfont(t){this.iconfont=t}constructor(t,i,r,s,o){super(s,r,o),this.ngZone=t,this.changeDetectorRef=i,this.iconService=s,this.renderer=o,this.cacheClassName=null,this.nzRotate=0,this.spin=!1,this.destroy$=new ce;let a=Ze(gM,{optional:!0});a&&a.doPatch(),this.el=r.nativeElement}ngOnChanges(t){let{nzType:i,nzTwotoneColor:r,nzSpin:s,nzTheme:o,nzRotate:a}=t;i||r||s||o?this.changeIcon2():a?this.handleRotate(this.el.firstChild):this._setSVGElement(this.iconService.createIconfontIcon(`#${this.iconfont}`))}ngOnInit(){this.renderer.setAttribute(this.el,"class",`anticon ${this.el.className}`.trim())}ngAfterContentChecked(){if(!this.type){let t=this.el.children,i=t.length;if(!this.type&&t.length)for(;i--;){let r=t[i];r.tagName.toLowerCase()==="svg"&&this.iconService.normalizeSvgElement(r)}}}ngOnDestroy(){this.destroy$.next()}changeIcon2(){this.setClassName(),this.ngZone.runOutsideAngular(()=>{Un(this._changeIcon()).pipe(it(this.destroy$)).subscribe({next:t=>{this.ngZone.run(()=>{this.changeDetectorRef.detectChanges(),t&&(this.setSVGData(t),this.handleSpin(t),this.handleRotate(t))})},error:U2})})}handleSpin(t){this.spin||this.type==="loading"?this.renderer.addClass(t,"anticon-spin"):this.renderer.removeClass(t,"anticon-spin")}handleRotate(t){this.nzRotate?this.renderer.setAttribute(t,"style",`transform: rotate(${this.nzRotate}deg)`):this.renderer.removeAttribute(t,"style")}setClassName(){this.cacheClassName&&this.renderer.removeClass(this.el,this.cacheClassName),this.cacheClassName=`anticon-${this.type}`,this.renderer.addClass(this.el,this.cacheClassName)}setSVGData(t){this.renderer.setAttribute(t,"data-icon",this.type),this.renderer.setAttribute(t,"aria-hidden","true")}static{this.\u0275fac=function(i){return new(i||n)($(Se),$(Cn),$($e),$(mM),$(Br))}}static{this.\u0275dir=We({type:n,selectors:[["","nz-icon",""]],hostVars:2,hostBindings:function(i,r){i&2&&Nt("anticon",!0)},inputs:{nzSpin:[ve.HasDecoratorInputTransform,"nzSpin","nzSpin",wt],nzRotate:[ve.HasDecoratorInputTransform,"nzRotate","nzRotate",Mc],nzType:"nzType",nzTheme:"nzTheme",nzTwotoneColor:"nzTwotoneColor",nzIconfont:"nzIconfont"},exportAs:["nzIcon"],standalone:!0,features:[jn,kn,wn]})}}return n})(),y$=n=>i4([{provide:fM,useValue:n}]),w$=n=>[gM,{provide:pM,useValue:n}],Ya=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[y$(t)]}}static forChild(t){return{ngModule:n,providers:[w$(t)]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({})}}return n})();var X2=class{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;e!=null&&(this._attachedHost=null,e.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},Z2=class extends X2{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}},J2=class extends X2{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}},D9=class extends X2{constructor(e){super(),this.element=e instanceof $e?e.nativeElement:e}},_8=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){if(e instanceof Z2)return this._attachedPortal=e,this.attachComponentPortal(e);if(e instanceof J2)return this._attachedPortal=e,this.attachTemplatePortal(e);if(this.attachDomPortal&&e instanceof D9)return this._attachedPortal=e,this.attachDomPortal(e)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var C8=class extends _8{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{this._document;let a=o.element;a.parentNode;let c=this._document.createComment("dom-portal");a.parentNode.insertBefore(c,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=s}attachComponentPortal(e){let i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||ki.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);r!==-1&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}};var ste=(()=>{class n extends _8{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new Xt,this.attachDomPortal=s=>{this._document;let o=s.element;o.parentNode;let a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);let i=t.viewContainerRef!=null?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=i.createComponent(s,i.length,t.injector||i.injector,t.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);let i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){let t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static{this.\u0275fac=function(i){return new(i||n)($(Cc),$(Fr),$(Tt))}}static{this.\u0275dir=We({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[ve.None,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[kn]})}}return n})();var vM=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({})}}return n})();var Qt=(()=>{class n{static{this.SLOW="0.3s"}static{this.BASE="0.2s"}static{this.FAST="0.1s"}}return n})(),sn=(()=>{class n{static{this.EASE_BASE_OUT="cubic-bezier(0.7, 0.3, 0.1, 1)"}static{this.EASE_BASE_IN="cubic-bezier(0.9, 0, 0.3, 0.7)"}static{this.EASE_OUT="cubic-bezier(0.215, 0.61, 0.355, 1)"}static{this.EASE_IN="cubic-bezier(0.55, 0.055, 0.675, 0.19)"}static{this.EASE_IN_OUT="cubic-bezier(0.645, 0.045, 0.355, 1)"}static{this.EASE_OUT_BACK="cubic-bezier(0.12, 0.4, 0.29, 1.46)"}static{this.EASE_IN_BACK="cubic-bezier(0.71, -0.46, 0.88, 0.6)"}static{this.EASE_IN_OUT_BACK="cubic-bezier(0.71, -0.46, 0.29, 1.46)"}static{this.EASE_OUT_CIRC="cubic-bezier(0.08, 0.82, 0.17, 1)"}static{this.EASE_IN_CIRC="cubic-bezier(0.6, 0.04, 0.98, 0.34)"}static{this.EASE_IN_OUT_CIRC="cubic-bezier(0.78, 0.14, 0.15, 0.86)"}static{this.EASE_OUT_QUINT="cubic-bezier(0.23, 1, 0.32, 1)"}static{this.EASE_IN_QUINT="cubic-bezier(0.755, 0.05, 0.855, 0.06)"}static{this.EASE_IN_OUT_QUINT="cubic-bezier(0.86, 0, 0.07, 1)"}}return n})(),cte=Sn("collapseMotion",[Tn("expanded",ae({height:"*"})),Tn("collapsed",ae({height:0,overflow:"hidden"})),Tn("hidden",ae({height:0,overflow:"hidden",borderTopWidth:"0"})),Be("expanded => collapsed",Pe(`150ms ${sn.EASE_IN_OUT}`)),Be("expanded => hidden",Pe(`150ms ${sn.EASE_IN_OUT}`)),Be("collapsed => expanded",Pe(`150ms ${sn.EASE_IN_OUT}`)),Be("hidden => expanded",Pe(`150ms ${sn.EASE_IN_OUT}`))]),lte=Sn("treeCollapseMotion",[Be("* => *",[sl("nz-tree-node:leave,nz-tree-builtin-node:leave",[ae({overflow:"hidden"}),ol(0,[Pe(`150ms ${sn.EASE_IN_OUT}`,ae({height:0,opacity:0,"padding-bottom":0}))])],{optional:!0}),sl("nz-tree-node:enter,nz-tree-builtin-node:enter",[ae({overflow:"hidden",height:0,opacity:0,"padding-bottom":0}),ol(0,[Pe(`150ms ${sn.EASE_IN_OUT}`,ae({overflow:"hidden",height:"*",opacity:"*","padding-bottom":"*"}))])],{optional:!0})])]),ute=Sn("drawerMaskMotion",[Be(":enter",[ae({opacity:0}),Pe(`${Qt.SLOW}`,ae({opacity:1}))]),Be(":leave",[ae({opacity:1}),Pe(`${Qt.SLOW}`,ae({opacity:0}))])]),hte=Sn("fadeMotion",[Be("* => enter",[ae({opacity:0}),Pe(`${Qt.BASE}`,ae({opacity:1}))]),Be("* => leave, :leave",[ae({opacity:1}),Pe(`${Qt.BASE}`,ae({opacity:0}))])]),dte=Sn("helpMotion",[Be(":enter",[ae({opacity:0,transform:"translateY(-5px)"}),Pe(`${Qt.SLOW} ${sn.EASE_IN_OUT}`,ae({opacity:1,transform:"translateY(0)"}))]),Be(":leave",[ae({opacity:1,transform:"translateY(0)"}),Pe(`${Qt.SLOW} ${sn.EASE_IN_OUT}`,ae({opacity:0,transform:"translateY(-5px)"}))])]),yM=Sn("moveUpMotion",[Be("* => enter",[ae({transformOrigin:"0 0",transform:"translateY(-100%)",opacity:0}),Pe(`${Qt.BASE}`,ae({transformOrigin:"0 0",transform:"translateY(0%)",opacity:1}))]),Be("* => leave",[ae({transformOrigin:"0 0",transform:"translateY(0%)",opacity:1}),Pe(`${Qt.BASE}`,ae({transformOrigin:"0 0",transform:"translateY(-100%)",opacity:0}))])]),wM=Sn("notificationMotion",[Tn("enterRight",ae({opacity:1,transform:"translateX(0)"})),Be("* => enterRight",[ae({opacity:0,transform:"translateX(5%)"}),Pe("100ms linear")]),Tn("enterLeft",ae({opacity:1,transform:"translateX(0)"})),Be("* => enterLeft",[ae({opacity:0,transform:"translateX(-5%)"}),Pe("100ms linear")]),Tn("enterTop",ae({opacity:1,transform:"translateY(0)"})),Be("* => enterTop",[ae({opacity:0,transform:"translateY(-5%)"}),Pe("100ms linear")]),Tn("enterBottom",ae({opacity:1,transform:"translateY(0)"})),Be("* => enterBottom",[ae({opacity:0,transform:"translateY(5%)"}),Pe("100ms linear")]),Tn("leave",ae({opacity:0,transform:"scaleY(0.8)",transformOrigin:"0% 0%"})),Be("* => leave",[ae({opacity:1,transform:"scaleY(1)",transformOrigin:"0% 0%"}),Pe("100ms linear")])]),b$=`${Qt.BASE} ${sn.EASE_OUT_QUINT}`,_$=`${Qt.BASE} ${sn.EASE_IN_QUINT}`,fte=Sn("slideMotion",[Tn("void",ae({opacity:0,transform:"scaleY(0.8)"})),Tn("enter",ae({opacity:1,transform:"scaleY(1)"})),Be("void => *",[Pe(b$)]),Be("* => void",[Pe(_$)])]),mte=Sn("slideAlertMotion",[Be(":leave",[ae({opacity:1,transform:"scaleY(1)",transformOrigin:"0% 0%"}),Pe(`${Qt.SLOW} ${sn.EASE_IN_OUT_CIRC}`,ae({opacity:0,transform:"scaleY(0)",transformOrigin:"0% 0%"}))])]),pte=Sn("tabSwitchMotion",[Tn("leave",ae({display:"none"})),Be("* => enter",[ae({display:"block",opacity:0}),Pe(Qt.SLOW)]),Be("* => leave, :leave",[ae({position:"absolute",top:0,left:0,width:"100%"}),Pe(Qt.SLOW,ae({opacity:0})),ae({display:"none"})])]),gte=Sn("thumbMotion",[Tn("from",ae({transform:"translateX({{ transform }}px)",width:"{{ width }}px"}),{params:{transform:0,width:0}}),Tn("to",ae({transform:"translateX({{ transform }}px)",width:"{{ width }}px"}),{params:{transform:100,width:0}}),Be("from => to",Pe(`300ms ${sn.EASE_IN_OUT}`))]),vte=Sn("zoomBigMotion",[Be("void => active",[ae({opacity:0,transform:"scale(0.8)"}),Pe(`${Qt.BASE} ${sn.EASE_OUT_CIRC}`,ae({opacity:1,transform:"scale(1)"}))]),Be("active => void",[ae({opacity:1,transform:"scale(1)"}),Pe(`${Qt.BASE} ${sn.EASE_IN_OUT_CIRC}`,ae({opacity:0,transform:"scale(0.8)"}))])]),yte=Sn("zoomBadgeMotion",[Be(":enter",[ae({opacity:0,transform:"scale(0) translate(50%, -50%)"}),Pe(`${Qt.SLOW} ${sn.EASE_OUT_BACK}`,ae({opacity:1,transform:"scale(1) translate(50%, -50%)"}))]),Be(":leave",[ae({opacity:1,transform:"scale(1) translate(50%, -50%)"}),Pe(`${Qt.SLOW} ${sn.EASE_IN_BACK}`,ae({opacity:0,transform:"scale(0) translate(50%, -50%)"}))])]);var S8=(()=>{class n{static ngTemplateContextGuard(t,i){return!0}recreateView(){this.viewContainer.clear();let t=this.nzStringTemplateOutlet instanceof bn,i=t?this.nzStringTemplateOutlet:this.templateRef;this.embeddedViewRef=this.viewContainer.createEmbeddedView(i,t?this.nzStringTemplateOutletContext:this.context)}updateContext(){let i=this.nzStringTemplateOutlet instanceof bn?this.nzStringTemplateOutletContext:this.context,r=this.embeddedViewRef.context;if(i)for(let s of Object.keys(i))r[s]=i[s]}constructor(t,i){this.viewContainer=t,this.templateRef=i,this.embeddedViewRef=null,this.context=new k9,this.nzStringTemplateOutletContext=null,this.nzStringTemplateOutlet=null}ngOnChanges(t){let{nzStringTemplateOutletContext:i,nzStringTemplateOutlet:r}=t,s=()=>{let a=!1;if(r)if(r.firstChange)a=!0;else{let u=r.previousValue instanceof bn,h=r.currentValue instanceof bn;a=u||h}return i&&(u=>{let h=Object.keys(u.previousValue||{}),d=Object.keys(u.currentValue||{});if(h.length===d.length){for(let g of d)if(h.indexOf(g)===-1)return!0;return!1}else return!0})(i)||a};r&&(this.context.$implicit=r.currentValue),s()?this.recreateView():this.updateContext()}static{this.\u0275fac=function(i){return new(i||n)($(Fr),$(bn))}}static{this.\u0275dir=We({type:n,selectors:[["","nzStringTemplateOutlet",""]],inputs:{nzStringTemplateOutletContext:"nzStringTemplateOutletContext",nzStringTemplateOutlet:"nzStringTemplateOutlet"},exportAs:["nzStringTemplateOutlet"],standalone:!0,features:[wn]})}}return n})(),k9=class{},T8=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({})}}return n})();var _M=["moz","ms","webkit"];function C$(){let n=0;return function(e){let t=new Date().getTime(),i=Math.max(0,16-(t-n)),r=window.setTimeout(()=>{e(t+i)},i);return n=t+i,r}}function S$(){if(typeof window>"u")return()=>0;if(window.requestAnimationFrame)return window.requestAnimationFrame.bind(window);let n=_M.filter(e=>`${e}RequestAnimationFrame`in window)[0];return n?window[`${n}RequestAnimationFrame`]:C$()}function Tte(n){if(typeof window>"u")return null;if(window.cancelAnimationFrame)return window.cancelAnimationFrame(n);let e=_M.filter(t=>`${t}CancelAnimationFrame`in window||`${t}CancelRequestAnimationFrame`in window)[0];return e?(window[`${e}CancelAnimationFrame`]||window[`${e}CancelRequestAnimationFrame`]).call(this,n):clearTimeout(n)}var R9=S$();var CM=new Set,W1,L9=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):E$}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&T$(t,this._nonce),this._matchMedia(t)}static{this.\u0275fac=function(i){return new(i||n)(D(gn),D(ro,8))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function T$(n,e){if(!CM.has(n))try{W1||(W1=document.createElement("style"),e&&W1.setAttribute("nonce",e),W1.setAttribute("type","text/css"),document.head.appendChild(W1)),W1.sheet&&(W1.sheet.insertRule(`@media ${n} {body{ }}`,0),CM.add(n))}catch(t){console.error(t)}}function E$(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var Rte=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new ce}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return SM($a(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=SM($a(t)).map(o=>this._registerQuery(o).observable),s=Em(r);return s=Mm(s.pipe(Di(1)),s.pipe(Dm(1),xm(0))),s.pipe(Ge(o=>{let a={matches:!1,breakpoints:{}};return o.forEach(({matches:c,query:l})=>{a.matches=a.matches||c,a.breakpoints[l]=c}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),s={observable:new vn(o=>{let a=c=>this._zone.run(()=>o.next(c));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(yn(i),Ge(({matches:o})=>({query:t,matches:o})),it(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static{this.\u0275fac=function(i){return new(i||n)(D(L9),D(Se))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function SM(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var V9=()=>{},z$=(()=>{class n{constructor(t,i){this.ngZone=t,this.rendererFactory2=i,this.resizeSource$=new ce,this.listeners=0,this.disposeHandle=V9,this.handler=()=>{this.ngZone.run(()=>{this.resizeSource$.next()})},this.renderer=this.rendererFactory2.createRenderer(null,null)}ngOnDestroy(){this.handler=V9}subscribe(){return this.registerListener(),this.resizeSource$.pipe(to(16),yc(()=>this.unregisterListener()))}unsubscribe(){this.unregisterListener()}registerListener(){this.listeners===0&&this.ngZone.runOutsideAngular(()=>{this.disposeHandle=this.renderer.listen("window","resize",this.handler)}),this.listeners+=1}unregisterListener(){this.listeners-=1,this.listeners===0&&(this.disposeHandle(),this.disposeHandle=V9)}static{this.\u0275fac=function(i){return new(i||n)(D(Se),D(so))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),x$=new Map,E8=(()=>{class n{constructor(){this._singletonRegistry=new Map}get singletonRegistry(){return h8.isTestMode?x$:this._singletonRegistry}registerSingletonWithKey(t,i){let r=this.singletonRegistry.has(t),s=r?this.singletonRegistry.get(t):this.withNewTarget(i);r||this.singletonRegistry.set(t,s)}unregisterSingletonWithKey(t){this.singletonRegistry.has(t)&&this.singletonRegistry.delete(t)}getSingletonWithKey(t){return this.singletonRegistry.has(t)?this.singletonRegistry.get(t).target:null}withNewTarget(t){return{target:t}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function O$(n,e,t,i){let r=t-e,s=n/(i/2);return s<1?r/2*s*s*s+e:r/2*((s-=2)*s*s+2)+e}var qte=(()=>{class n{constructor(t){this.ngZone=t,this.doc=Ze(Tt)}setScrollTop(t,i=0){t===window?(this.doc.body.scrollTop=i,this.doc.documentElement.scrollTop=i):t.scrollTop=i}getOffset(t){let i={top:0,left:0};if(!t||!t.getClientRects().length)return i;let r=t.getBoundingClientRect();if(r.width||r.height){let s=t.ownerDocument.documentElement;i.top=r.top-s.clientTop,i.left=r.left-s.clientLeft}else i.top=r.top,i.left=r.left;return i}getScroll(t,i=!0){if(typeof window>"u")return 0;let r=i?"scrollTop":"scrollLeft",s=0;return this.isWindow(t)?s=t[i?"pageYOffset":"pageXOffset"]:t instanceof Document?s=t.documentElement[r]:t&&(s=t[r]),t&&!this.isWindow(t)&&typeof s!="number"&&(s=(t.ownerDocument||t).documentElement[r]),s}isWindow(t){return t!=null&&t===t.window}scrollTo(t,i=0,r={}){let s=t||window,o=this.getScroll(s),a=Date.now(),{easing:c,callback:l,duration:u=450}=r,h=()=>{let g=Date.now()-a,_=(c||O$)(g>u?u:g,o,i,u);this.isWindow(s)?s.scrollTo(window.pageXOffset,_):s instanceof HTMLDocument||s.constructor.name==="HTMLDocument"?s.documentElement.scrollTop=_:s.scrollTop=_,g<u?R9(h):typeof l=="function"&&this.ngZone.run(l)};this.ngZone.runOutsideAngular(()=>R9(h))}static{this.\u0275fac=function(i){return new(i||n)(D(Se))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),TM=function(n){return n.xxl="xxl",n.xl="xl",n.lg="lg",n.md="md",n.sm="sm",n.xs="xs",n}(TM||{}),I$={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)"},Ute={xs:"(max-width: 479.98px)",sm:"(max-width: 575.98px)",md:"(max-width: 767.98px)",lg:"(max-width: 991.98px)",xl:"(max-width: 1199.98px)",xxl:"(max-width: 1599.98px)"},jte=(()=>{class n{constructor(t,i){this.resizeService=t,this.mediaMatcher=i,this.destroy$=new ce,this.resizeService.subscribe().pipe(it(this.destroy$)).subscribe(()=>{})}ngOnDestroy(){this.destroy$.next()}subscribe(t,i){if(i){let r=()=>this.matchMedia(t,!0);return this.resizeService.subscribe().pipe(Ge(r),yn(r()),Ks((s,o)=>s[0]===o[0]),Ge(s=>s[1]))}else{let r=()=>this.matchMedia(t);return this.resizeService.subscribe().pipe(Ge(r),yn(r()),Ks())}}matchMedia(t,i){let r=TM.md,s={};return Object.keys(t).map(o=>{let a=o,c=this.mediaMatcher.matchMedia(I$[a]).matches;s[o]=c,c&&(r=a)}),i?[r,s]:r}static{this.\u0275fac=function(i){return new(i||n)(D(z$),D(L9))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),M8=(()=>{class n extends ce{ngOnDestroy(){this.next(),this.complete()}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=il(n)))(r||n)}})()}static{this.\u0275prov=me({token:n,factory:n.\u0275fac})}}return n})();var A$=new Ee("cdk-dir-doc",{providedIn:"root",factory:D$});function D$(){return Ze(Tt)}var k$=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function R$(n){let e=n?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?k$.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var ar=(()=>{class n{constructor(t){if(this.value="ltr",this.change=new Xt,t){let i=t.body?t.body.dir:null,r=t.documentElement?t.documentElement.dir:null;this.value=R$(i||r||"ltr")}}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(i){return new(i||n)(D(A$,8))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ec=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({})}}return n})();var H9=class{};function EM(n){return n&&typeof n.connect=="function"&&!(n instanceof bm)}var z8=class extends H9{constructor(e){super(),this._data=e}connect(){return eo(this._data)?this._data:St(this._data)}disconnect(){}},tc=function(n){return n[n.REPLACED=0]="REPLACED",n[n.INSERTED=1]="INSERTED",n[n.MOVED=2]="MOVED",n[n.REMOVED=3]="REMOVED",n}(tc||{}),B9=new Ee("_ViewRepeater");var x8=class{constructor(){this.viewCacheSize=20,this._viewCache=[]}applyChanges(e,t,i,r,s){e.forEachOperation((o,a,c)=>{let l,u;if(o.previousIndex==null){let h=()=>i(o,a,c);l=this._insertView(h,c,t,r(o)),u=l?tc.INSERTED:tc.REPLACED}else c==null?(this._detachAndCacheView(a,t),u=tc.REMOVED):(l=this._moveView(a,c,t,r(o)),u=tc.MOVED);s&&s({context:l?.context,operation:u,record:o})})}detach(){for(let e of this._viewCache)e.destroy();this._viewCache=[]}_insertView(e,t,i,r){let s=this._insertViewFromCache(t,i);if(s){s.context.$implicit=r;return}let o=e();return i.createEmbeddedView(o.templateRef,o.context,o.index)}_detachAndCacheView(e,t){let i=t.detach(e);this._maybeCacheView(i,t)}_moveView(e,t,i,r){let s=i.get(e);return i.move(s,t),s.context.$implicit=r,s}_maybeCacheView(e,t){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(e);else{let i=t.indexOf(e);i===-1?e.destroy():t.remove(i)}}_insertViewFromCache(e,t){let i=this._viewCache.pop();return i&&t.insert(i,e),i||null}};var L$=["contentWrapper"],V$=["*"],OM=new Ee("VIRTUAL_SCROLL_STRATEGY"),F9=class{constructor(e,t,i){this._scrolledIndexChange=new ce,this.scrolledIndexChange=this._scrolledIndexChange.pipe(Ks()),this._viewport=null,this._itemSize=e,this._minBufferPx=t,this._maxBufferPx=i}attach(e){this._viewport=e,this._updateTotalContentSize(),this._updateRenderedRange()}detach(){this._scrolledIndexChange.complete(),this._viewport=null}updateItemAndBufferSize(e,t,i){i<t,this._itemSize=e,this._minBufferPx=t,this._maxBufferPx=i,this._updateTotalContentSize(),this._updateRenderedRange()}onContentScrolled(){this._updateRenderedRange()}onDataLengthChanged(){this._updateTotalContentSize(),this._updateRenderedRange()}onContentRendered(){}onRenderedOffsetChanged(){}scrollToIndex(e,t){this._viewport&&this._viewport.scrollToOffset(e*this._itemSize,t)}_updateTotalContentSize(){this._viewport&&this._viewport.setTotalContentSize(this._viewport.getDataLength()*this._itemSize)}_updateRenderedRange(){if(!this._viewport)return;let e=this._viewport.getRenderedRange(),t={start:e.start,end:e.end},i=this._viewport.getViewportSize(),r=this._viewport.getDataLength(),s=this._viewport.measureScrollOffset(),o=this._itemSize>0?s/this._itemSize:0;if(t.end>r){let c=Math.ceil(i/this._itemSize),l=Math.max(0,Math.min(o,r-c));o!=l&&(o=l,s=l*this._itemSize,t.start=Math.floor(o)),t.end=Math.max(0,Math.min(r,t.start+c))}let a=s-t.start*this._itemSize;if(a<this._minBufferPx&&t.start!=0){let c=Math.ceil((this._maxBufferPx-a)/this._itemSize);t.start=Math.max(0,t.start-c),t.end=Math.min(r,Math.ceil(o+(i+this._minBufferPx)/this._itemSize))}else{let c=t.end*this._itemSize-(s+i);if(c<this._minBufferPx&&t.end!=r){let l=Math.ceil((this._maxBufferPx-c)/this._itemSize);l>0&&(t.end=Math.min(r,t.end+l),t.start=Math.max(0,Math.floor(o-this._minBufferPx/this._itemSize)))}}this._viewport.setRenderedRange(t),this._viewport.setRenderedContentOffset(this._itemSize*t.start),this._scrolledIndexChange.next(Math.floor(o))}};function N$(n){return n._scrollStrategy}var Cne=(()=>{class n{constructor(){this._itemSize=20,this._minBufferPx=100,this._maxBufferPx=200,this._scrollStrategy=new F9(this.itemSize,this.minBufferPx,this.maxBufferPx)}get itemSize(){return this._itemSize}set itemSize(t){this._itemSize=U1(t)}get minBufferPx(){return this._minBufferPx}set minBufferPx(t){this._minBufferPx=U1(t)}get maxBufferPx(){return this._maxBufferPx}set maxBufferPx(t){this._maxBufferPx=U1(t)}ngOnChanges(){this._scrollStrategy.updateItemAndBufferSize(this.itemSize,this.minBufferPx,this.maxBufferPx)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=We({type:n,selectors:[["cdk-virtual-scroll-viewport","itemSize",""]],inputs:{itemSize:"itemSize",minBufferPx:"minBufferPx",maxBufferPx:"maxBufferPx"},standalone:!0,features:[qr([{provide:OM,useFactory:N$,deps:[Rm(()=>n)]}]),wn]})}}return n})(),P$=20,Ka=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new ce,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){let i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=P$){return this._platform.isBrowser?new vn(i=>{this._globalSubscription||this._addGlobalListener();let r=t>0?this._scrolled.pipe(to(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):St()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){let r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(qt(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){let i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=iM(i),s=t.getElementRef().nativeElement;do if(r==s)return!0;while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let t=this._getWindow();return t4(t.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(i){return new(i||n)(D(Se),D(gn),D(Tt,8))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),q9=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new ce,this._elementScrolled=new vn(o=>this.ngZone.runOutsideAngular(()=>t4(this.elementRef.nativeElement,"scroll").pipe(it(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){let i=this.elementRef.nativeElement,r=this.dir&&this.dir.value=="rtl";t.left==null&&(t.left=r?t.end:t.start),t.right==null&&(t.right=r?t.start:t.end),t.bottom!=null&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&Ga()!=Ai.NORMAL?(t.left!=null&&(t.right=i.scrollWidth-i.clientWidth-t.left),Ga()==Ai.INVERTED?t.left=t.right:Ga()==Ai.NEGATED&&(t.left=t.right?-t.right:t.right)):t.right!=null&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){let i=this.elementRef.nativeElement;y8()?i.scrollTo(t):(t.top!=null&&(i.scrollTop=t.top),t.left!=null&&(i.scrollLeft=t.left))}measureScrollOffset(t){let i="left",r="right",s=this.elementRef.nativeElement;if(t=="top")return s.scrollTop;if(t=="bottom")return s.scrollHeight-s.clientHeight-s.scrollTop;let o=this.dir&&this.dir.value=="rtl";return t=="start"?t=o?r:i:t=="end"&&(t=o?i:r),o&&Ga()==Ai.INVERTED?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&Ga()==Ai.NEGATED?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}static{this.\u0275fac=function(i){return new(i||n)($($e),$(Ka),$(Se),$(ar,8))}}static{this.\u0275dir=We({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}}return n})(),H$=20,nc=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new ce,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){let s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){let t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect(),o=-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,a=-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0;return{top:o,left:a}}change(t=H$){return t>0?this._change.pipe(to(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(i){return new(i||n)(D(gn),D(Se),D(Tt,8))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),MM=new Ee("VIRTUAL_SCROLLABLE"),B$=(()=>{class n extends q9{constructor(t,i,r,s){super(t,i,r,s)}measureViewportSize(t){let i=this.elementRef.nativeElement;return t==="horizontal"?i.clientWidth:i.clientHeight}static{this.\u0275fac=function(i){return new(i||n)($($e),$(Ka),$(Se),$(ar,8))}}static{this.\u0275dir=We({type:n,features:[kn]})}}return n})();function F$(n,e){return n.start==e.start&&n.end==e.end}var q$=typeof requestAnimationFrame<"u"?Sm:_m,U$=(()=>{class n extends B${get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}constructor(t,i,r,s,o,a,c,l){super(t,a,r,o),this.elementRef=t,this._changeDetectorRef=i,this._scrollStrategy=s,this.scrollable=l,this._platform=Ze(gn),this._detachedSubject=new ce,this._renderedRangeSubject=new ce,this._orientation="vertical",this.appendOnly=!1,this.scrolledIndexChange=new vn(u=>this._scrollStrategy.scrolledIndexChange.subscribe(h=>Promise.resolve().then(()=>this.ngZone.run(()=>u.next(h))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=lr.EMPTY,this._injector=Ze(ki),this._isDestroyed=!1,this._viewportChanges=c.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(yn(null),to(0,q$),it(this._destroyed)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),this._isDestroyed=!0,super.ngOnDestroy()}attach(t){this._forOf,this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe(it(this._detachedSubject)).subscribe(i=>{let r=i.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){F$(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,i="to-start"){t=this.appendOnly&&i==="to-start"?0:t;let r=this.dir&&this.dir.value=="rtl",s=this.orientation=="horizontal",o=s?"X":"Y",c=`translate${o}(${Number((s&&r?-1:1)*t)}px)`;this._renderedContentOffset=t,i==="to-end"&&(c+=` translate${o}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=c&&(this._renderedContentTransform=c,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,i="auto"){let r={behavior:i};this.orientation==="horizontal"?r.start=t:r.top=t,this.scrollable.scrollTo(r)}scrollToIndex(t,i="auto"){this._scrollStrategy.scrollToIndex(t,i)}measureScrollOffset(t){let i;return this.scrollable==this?i=r=>super.measureScrollOffset(r):i=r=>this.scrollable.measureScrollOffset(r),Math.max(0,i(t??(this.orientation==="horizontal"?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let i,r="left",s="right",o=this.dir?.value=="rtl";t=="start"?i=o?s:r:t=="end"?i=o?r:s:t?i=t:i=this.orientation==="horizontal"?"left":"top";let a=this.scrollable.measureBoundingClientRectWithScrollOffset(i);return this.elementRef.nativeElement.getBoundingClientRect()[i]-a}measureRenderedContentSize(){let t=this._contentWrapper.nativeElement;return this.orientation==="horizontal"?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isDestroyed||this.ngZone.run(()=>{this._changeDetectorRef.markForCheck(),this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,Sc(()=>{this._isChangeDetectionPending=!1;let t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(let i of t)i()},{injector:this._injector})})}_calculateSpacerSize(){this._totalContentHeight=this.orientation==="horizontal"?"":`${this._totalContentSize}px`,this._totalContentWidth=this.orientation==="horizontal"?`${this._totalContentSize}px`:""}static{this.\u0275fac=function(i){return new(i||n)($($e),$(Cn),$(Se),$(OM,8),$(ar,8),$(Ka),$(nc),$(MM,8))}}static{this.\u0275cmp=di({type:n,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(i,r){if(i&1&&Bm(L$,7),i&2){let s;Tc(s=Ec())&&(r._contentWrapper=s.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(i,r){i&2&&Nt("cdk-virtual-scroll-orientation-horizontal",r.orientation==="horizontal")("cdk-virtual-scroll-orientation-vertical",r.orientation!=="horizontal")},inputs:{orientation:"orientation",appendOnly:[ve.HasDecoratorInputTransform,"appendOnly","appendOnly",wt]},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[qr([{provide:q9,useFactory:(t,i)=>t||i,deps:[[new _c,new Lm(MM)],n]}]),jn,kn,mi],ngContentSelectors:V$,decls:4,vars:4,consts:[["contentWrapper",""],[1,"cdk-virtual-scroll-content-wrapper"],[1,"cdk-virtual-scroll-spacer"]],template:function(i,r){i&1&&(s4(),Ye(0,"div",1,0),o4(2),at(),It(3,"div",2)),i&2&&(Le(3),fi("width",r._totalContentWidth)("height",r._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0})}}return n})();function zM(n,e,t){let i=t;if(!i.getBoundingClientRect)return 0;let r=i.getBoundingClientRect();return n==="horizontal"?e==="start"?r.left:r.right:e==="start"?r.top:r.bottom}var Sne=(()=>{class n{get cdkVirtualForOf(){return this._cdkVirtualForOf}set cdkVirtualForOf(t){this._cdkVirtualForOf=t,EM(t)?this._dataSourceChanges.next(t):this._dataSourceChanges.next(new z8(eo(t)?t:Array.from(t||[])))}get cdkVirtualForTrackBy(){return this._cdkVirtualForTrackBy}set cdkVirtualForTrackBy(t){this._needsUpdate=!0,this._cdkVirtualForTrackBy=t?(i,r)=>t(i+(this._renderedRange?this._renderedRange.start:0),r):void 0}set cdkVirtualForTemplate(t){t&&(this._needsUpdate=!0,this._template=t)}get cdkVirtualForTemplateCacheSize(){return this._viewRepeater.viewCacheSize}set cdkVirtualForTemplateCacheSize(t){this._viewRepeater.viewCacheSize=U1(t)}constructor(t,i,r,s,o,a){this._viewContainerRef=t,this._template=i,this._differs=r,this._viewRepeater=s,this._viewport=o,this.viewChange=new ce,this._dataSourceChanges=new ce,this.dataStream=this._dataSourceChanges.pipe(yn(null),no(),hi(([c,l])=>this._changeDataSource(c,l)),n4(1)),this._differ=null,this._needsUpdate=!1,this._destroyed=new ce,this.dataStream.subscribe(c=>{this._data=c,this._onRenderedDataChange()}),this._viewport.renderedRangeStream.pipe(it(this._destroyed)).subscribe(c=>{this._renderedRange=c,this.viewChange.observers.length&&a.run(()=>this.viewChange.next(this._renderedRange)),this._onRenderedDataChange()}),this._viewport.attach(this)}measureRangeSize(t,i){if(t.start>=t.end)return 0;t.start<this._renderedRange.start||t.end>this._renderedRange.end;let r=t.start-this._renderedRange.start,s=t.end-t.start,o,a;for(let c=0;c<s;c++){let l=this._viewContainerRef.get(c+r);if(l&&l.rootNodes.length){o=a=l.rootNodes[0];break}}for(let c=s-1;c>-1;c--){let l=this._viewContainerRef.get(c+r);if(l&&l.rootNodes.length){a=l.rootNodes[l.rootNodes.length-1];break}}return o&&a?zM(i,"end",a)-zM(i,"start",o):0}ngDoCheck(){if(this._differ&&this._needsUpdate){let t=this._differ.diff(this._renderedItems);t?this._applyChanges(t):this._updateContext(),this._needsUpdate=!1}}ngOnDestroy(){this._viewport.detach(),this._dataSourceChanges.next(void 0),this._dataSourceChanges.complete(),this.viewChange.complete(),this._destroyed.next(),this._destroyed.complete(),this._viewRepeater.detach()}_onRenderedDataChange(){this._renderedRange&&(this._renderedItems=this._data.slice(this._renderedRange.start,this._renderedRange.end),this._differ||(this._differ=this._differs.find(this._renderedItems).create((t,i)=>this.cdkVirtualForTrackBy?this.cdkVirtualForTrackBy(t,i):i)),this._needsUpdate=!0)}_changeDataSource(t,i){return t&&t.disconnect(this),this._needsUpdate=!0,i?i.connect(this):St()}_updateContext(){let t=this._data.length,i=this._viewContainerRef.length;for(;i--;){let r=this._viewContainerRef.get(i);r.context.index=this._renderedRange.start+i,r.context.count=t,this._updateComputedContextProperties(r.context),r.detectChanges()}}_applyChanges(t){this._viewRepeater.applyChanges(t,this._viewContainerRef,(s,o,a)=>this._getEmbeddedViewArgs(s,a),s=>s.item),t.forEachIdentityChange(s=>{let o=this._viewContainerRef.get(s.currentIndex);o.context.$implicit=s.item});let i=this._data.length,r=this._viewContainerRef.length;for(;r--;){let s=this._viewContainerRef.get(r);s.context.index=this._renderedRange.start+r,s.context.count=i,this._updateComputedContextProperties(s.context)}}_updateComputedContextProperties(t){t.first=t.index===0,t.last=t.index===t.count-1,t.even=t.index%2===0,t.odd=!t.even}_getEmbeddedViewArgs(t,i){return{templateRef:this._template,context:{$implicit:t.item,cdkVirtualForOf:this._cdkVirtualForOf,index:-1,count:-1,first:!1,last:!1,odd:!1,even:!1},index:i}}static{this.\u0275fac=function(i){return new(i||n)($(Fr),$(bn),$($m),$(B9),$(U$,4),$(Se))}}static{this.\u0275dir=We({type:n,selectors:[["","cdkVirtualFor","","cdkVirtualForOf",""]],inputs:{cdkVirtualForOf:"cdkVirtualForOf",cdkVirtualForTrackBy:"cdkVirtualForTrackBy",cdkVirtualForTemplate:"cdkVirtualForTemplate",cdkVirtualForTemplateCacheSize:"cdkVirtualForTemplateCacheSize"},standalone:!0,features:[qr([{provide:B9,useClass:x8}])]})}}return n})();var xM=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({})}}return n})(),U9=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({imports:[ec,xM,ec,xM]})}}return n})();function IM(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}var AM=y8(),j9=class{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){let e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=gt(-this._previousScrollPosition.left),e.style.top=gt(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let e=this._document.documentElement,t=this._document.body,i=e.style,r=t.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),AM&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),AM&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}};var W9=class{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(this._scrollSubscription)return;let e=this._scrollDispatcher.scrolled(0).pipe(qt(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{let t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},O8=class{enable(){}disable(){}attach(){}};function $9(n,e){return e.some(t=>{let i=n.bottom<t.top,r=n.top>t.bottom,s=n.right<t.left,o=n.left>t.right;return i||r||s||o})}function DM(n,e){return e.some(t=>{let i=n.top<t.top,r=n.bottom>t.bottom,s=n.left<t.left,o=n.right>t.right;return i||r||s||o})}var G9=class{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(!this._scrollSubscription){let e=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(e).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();$9(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},$$=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new O8,this.close=o=>new W9(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new j9(this._viewportRuler,this._document),this.reposition=o=>new G9(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}static{this.\u0275fac=function(i){return new(i||n)(D(Ka),D(nc),D(Se),D(Tt))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),I8=class{constructor(e){if(this.scrollStrategy=new O8,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){let t=Object.keys(e);for(let i of t)e[i]!==void 0&&(this[i]=e[i])}}},ut=class{constructor(e,t,i,r,s){this.offsetX=i,this.offsetY=r,this.panelClass=s,this.originX=e.originX,this.originY=e.originY,this.overlayX=t.overlayX,this.overlayY=t.overlayY}};var Y9=class{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}};var PM=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){let i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),this._attachedOverlays.length===0&&this.detach()}static{this.\u0275fac=function(i){return new(i||n)(D(Tt))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),G$=(()=>{class n extends PM{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{let s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){let a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static{this.\u0275fac=function(i){return new(i||n)(D(Tt),D(Se,8))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Y$=(()=>{class n extends PM{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=w8(s)},this._clickListener=s=>{let o=w8(s),a=s.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;let c=this._attachedOverlays.slice();for(let l=c.length-1;l>-1;l--){let u=c[l];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(kM(u.overlayElement,o)||kM(u.overlayElement,a))break;let h=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>h.next(s)):h.next(s)}}}add(t){if(super.add(t),!this._isAttached){let i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static{this.\u0275fac=function(i){return new(i||n)(D(Tt),D(gn),D(Se,8))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function kM(n,e){let t=typeof ShadowRoot<"u"&&ShadowRoot,i=e;for(;i;){if(i===n)return!0;i=t&&i instanceof ShadowRoot?i.host:i.parentNode}return!1}var HM=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let t="cdk-overlay-container";if(this._platform.isBrowser||I9()){let r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}let i=this._document.createElement("div");i.classList.add(t),I9()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static{this.\u0275fac=function(i){return new(i||n)(D(Tt),D(gn))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),K9=class{constructor(e,t,i,r,s,o,a,c,l,u=!1,h){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=c,this._outsideClickDispatcher=l,this._animationsDisabled=u,this._injector=h,this._backdropElement=null,this._backdropClick=new ce,this._attachments=new ce,this._detachments=new ce,this._locationChanges=lr.EMPTY,this._backdropClickHandler=d=>this._backdropClick.next(d),this._backdropTransitionendHandler=d=>{this._disposeBackdrop(d.target)},this._keydownEvents=new ce,this._outsidePointerEvents=new ce,this._renders=new ce,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy,this._afterRenderRef=Gm(()=>Pm(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=Sc(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof t?.onDestroy=="function"&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){let e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=Re(Re({},this._config),e),this._updateElementSize()}setDirection(e){this._config=qn(Re({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){let e=this._config.direction;return e?typeof e=="string"?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let e=this._pane.style;e.width=gt(this._config.width),e.height=gt(this._config.height),e.minWidth=gt(this._config.minWidth),e.minHeight=gt(this._config.minHeight),e.maxWidth=gt(this._config.maxWidth),e.maxHeight=gt(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){let e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(e){if(this._animationsDisabled){this._disposeBackdrop(e);return}e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){let r=$a(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let e=this._renders.pipe(it(vc(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){let e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},RM="cdk-overlay-connected-position-bounding-box",K$=/([A-Za-z%]+)$/,Q9=class{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new ce,this._resizeSubscription=lr.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._overlayRef&&this._overlayRef,this._validatePositions(),e.hostElement.classList.add(RM),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[],o;for(let a of this._preferredPositions){let c=this._getOriginPoint(e,r,a),l=this._getOverlayPoint(c,t,a),u=this._getOverlayFit(l,t,i,a);if(u.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(a,c);return}if(this._canFitWithFlexibleDimensions(u,l,i)){s.push({position:a,origin:c,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(c,a)});continue}(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:l,originPoint:c,position:a,overlayRect:t})}if(s.length){let a=null,c=-1;for(let l of s){let u=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);u>c&&(c=u,a=l)}this._isPushed=!1,this._applyPosition(a.position,a.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(o.position,o.originPoint);return}this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&$1(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(RM),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,e.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r;if(i.originX=="center")r=e.left+e.width/2;else{let o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r=i.originX=="start"?o:a}t.left<0&&(r-=t.left);let s;return i.originY=="center"?s=e.top+e.height/2:s=i.originY=="top"?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r;i.overlayX=="center"?r=-t.width/2:i.overlayX==="start"?r=this._isRtl()?-t.width:0:r=this._isRtl()?0:-t.width;let s;return i.overlayY=="center"?s=-t.height/2:s=i.overlayY=="top"?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){let s=VM(t),{x:o,y:a}=e,c=this._getOffset(r,"x"),l=this._getOffset(r,"y");c&&(o+=c),l&&(a+=l);let u=0-o,h=o+s.width-i.width,d=0-a,g=a+s.height-i.height,_=this._subtractOverflows(s.width,u,h),T=this._subtractOverflows(s.height,d,g),E=_*T;return{visibleArea:E,isCompletelyWithinViewport:s.width*s.height===E,fitsInViewportVertically:T===s.height,fitsInViewportHorizontally:_==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){let r=i.bottom-t.y,s=i.right-t.x,o=LM(this._overlayRef.getConfig().minHeight),a=LM(this._overlayRef.getConfig().minWidth),c=e.fitsInViewportVertically||o!=null&&o<=r,l=e.fitsInViewportHorizontally||a!=null&&a<=s;return c&&l}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};let r=VM(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),c=Math.max(s.top-i.top-e.y,0),l=Math.max(s.left-i.left-e.x,0),u=0,h=0;return r.width<=s.width?u=l||-o:u=e.x<this._viewportMargin?s.left-i.left-e.x:0,r.height<=s.height?h=c||-a:h=e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:h},{x:e.x+u,y:e.y+h}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){let i=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!Q$(this._lastScrollVisibility,i)){let r=new Y9(e,i);this._positionChanges.next(r)}this._lastScrollVisibility=i}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;let t=this._boundingBox.querySelectorAll(this._transformOriginSelector),i,r=e.overlayY;e.overlayX==="center"?i="center":this._isRtl()?i=e.overlayX==="start"?"right":"left":i=e.overlayX==="start"?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){let i=this._viewportRect,r=this._isRtl(),s,o,a;if(t.overlayY==="top")o=e.y,s=i.height-o+this._viewportMargin;else if(t.overlayY==="bottom")a=i.height-e.y+this._viewportMargin*2,s=i.height-a+this._viewportMargin;else{let g=Math.min(i.bottom-e.y+i.top,e.y),_=this._lastBoundingBoxSize.height;s=g*2,o=e.y-g,s>_&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-_/2)}let c=t.overlayX==="start"&&!r||t.overlayX==="end"&&r,l=t.overlayX==="end"&&!r||t.overlayX==="start"&&r,u,h,d;if(l)d=i.width-e.x+this._viewportMargin*2,u=e.x-this._viewportMargin;else if(c)h=e.x,u=i.right-e.x;else{let g=Math.min(i.right-e.x+i.left,e.x),_=this._lastBoundingBoxSize.width;u=g*2,h=e.x-g,u>_&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.x-_/2)}return{top:o,left:h,bottom:a,right:d,width:u,height:s}}_setBoundingBoxStyles(e,t){let i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));let r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{let s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=gt(i.height),r.top=gt(i.top),r.bottom=gt(i.bottom),r.width=gt(i.width),r.left=gt(i.left),r.right=gt(i.right),t.overlayX==="center"?r.alignItems="center":r.alignItems=t.overlayX==="end"?"flex-end":"flex-start",t.overlayY==="center"?r.justifyContent="center":r.justifyContent=t.overlayY==="bottom"?"flex-end":"flex-start",s&&(r.maxHeight=gt(s)),o&&(r.maxWidth=gt(o))}this._lastBoundingBoxSize=i,$1(this._boundingBox.style,r)}_resetBoundingBoxStyles(){$1(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){$1(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){let i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){let u=this._viewportRuler.getViewportScrollPosition();$1(i,this._getExactOverlayY(t,e,u)),$1(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",c=this._getOffset(t,"x"),l=this._getOffset(t,"y");c&&(a+=`translateX(${c}px) `),l&&(a+=`translateY(${l}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=gt(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=gt(o.maxWidth):s&&(i.maxWidth="")),$1(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);if(this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),e.overlayY==="bottom"){let o=this._document.documentElement.clientHeight;r.bottom=`${o-(s.y+this._overlayRect.height)}px`}else r.top=gt(s.y);return r}_getExactOverlayX(e,t,i){let r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i));let o;if(this._isRtl()?o=e.overlayX==="end"?"left":"right":o=e.overlayX==="end"?"right":"left",o==="right"){let a=this._document.documentElement.clientWidth;r.right=`${a-(s.x+this._overlayRect.width)}px`}else r.left=gt(s.x);return r}_getScrollVisibility(){let e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:DM(e,i),isOriginOutsideView:$9(e,i),isOverlayClipped:DM(t,i),isOverlayOutsideView:$9(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){let e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return t==="x"?e.offsetX==null?this._offsetX:e.offsetX:e.offsetY==null?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&$a(e).forEach(t=>{t!==""&&this._appliedPanelClasses.indexOf(t)===-1&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){let e=this._origin;if(e instanceof $e)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();let t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}};function $1(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function LM(n){if(typeof n!="number"&&n!=null){let[e,t]=n.split(K$);return!t||t==="px"?parseFloat(e):null}return n||null}function VM(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}function Q$(n,e){return n===e?!0:n.isOriginClipped===e.isOriginClipped&&n.isOriginOutsideView===e.isOriginOutsideView&&n.isOverlayClipped===e.isOverlayClipped&&n.isOverlayOutsideView===e.isOverlayOutsideView}var NM="cdk-global-overlay-wrapper",X9=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){let t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(NM),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,c=(r==="100%"||r==="100vw")&&(!o||o==="100%"||o==="100vw"),l=(s==="100%"||s==="100vh")&&(!a||a==="100%"||a==="100vh"),u=this._xPosition,h=this._xOffset,d=this._overlayRef.getConfig().direction==="rtl",g="",_="",T="";c?T="flex-start":u==="center"?(T="center",d?_=h:g=h):d?u==="left"||u==="end"?(T="flex-end",g=h):(u==="right"||u==="start")&&(T="flex-start",_=h):u==="left"||u==="start"?(T="flex-start",g=h):(u==="right"||u==="end")&&(T="flex-end",_=h),e.position=this._cssPosition,e.marginLeft=c?"0":g,e.marginTop=l?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=c?"0":_,t.justifyContent=T,t.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(NM),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}},X$=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new X9}flexibleConnectedTo(t){return new Q9(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static{this.\u0275fac=function(i){return new(i||n)(D(nc),D(Tt),D(gn),D(HM))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Z$=0,$s=(()=>{class n{constructor(t,i,r,s,o,a,c,l,u,h,d,g){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=c,this._document=l,this._directionality=u,this._location=h,this._outsideClickDispatcher=d,this._animationsModuleType=g}create(t){let i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new I8(t);return o.direction=o.direction||this._directionality.value,new K9(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(Vm))}position(){return this._positionBuilder}_createPaneElement(t){let i=this._document.createElement("div");return i.id=`cdk-overlay-${Z$++}`,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){let t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(Wm)),new C8(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static{this.\u0275fac=function(i){return new(i||n)(D($$),D(HM),D(Cc),D(X$),D(G$),D(ki),D(Se),D(Tt),D(ar),D(Ym),D(Y$),D(io,8))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),J$=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],BM=new Ee("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let n=Ze($s);return()=>n.scrollStrategies.reposition()}}),A8=(()=>{class n{constructor(t){this.elementRef=t}static{this.\u0275fac=function(i){return new(i||n)($($e))}}static{this.\u0275dir=We({type:n,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0})}}return n})(),FM=(()=>{class n{get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(t){this._disposeOnNavigation=t}constructor(t,i,r,s,o){this._overlay=t,this._dir=o,this._backdropSubscription=lr.EMPTY,this._attachSubscription=lr.EMPTY,this._detachSubscription=lr.EMPTY,this._positionSubscription=lr.EMPTY,this._disposeOnNavigation=!1,this._ngZone=Ze(Se),this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.hasBackdrop=!1,this.lockPosition=!1,this.flexibleDimensions=!1,this.growAfterOpen=!1,this.push=!1,this.backdropClick=new Xt,this.positionChange=new Xt,this.attach=new Xt,this.detach=new Xt,this.overlayKeydown=new Xt,this.overlayOutsideClick=new Xt,this._templatePortal=new J2(i,r),this._scrollStrategyFactory=s,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=J$);let t=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=t.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=t.detachments().subscribe(()=>this.detach.emit()),t.keydownEvents().subscribe(i=>{this.overlayKeydown.next(i),i.keyCode===27&&!this.disableClose&&!IM(i)&&(i.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(i=>{let r=this._getOriginElement(),s=w8(i);(!r||r!==s&&!r.contains(s))&&this.overlayOutsideClick.next(i)})}_buildConfig(){let t=this._position=this.positionStrategy||this._createPositionStrategy(),i=new I8({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(i.width=this.width),(this.height||this.height===0)&&(i.height=this.height),(this.minWidth||this.minWidth===0)&&(i.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(i.minHeight=this.minHeight),this.backdropClass&&(i.backdropClass=this.backdropClass),this.panelClass&&(i.panelClass=this.panelClass),i}_updatePositionStrategy(t){let i=this.positions.map(r=>({originX:r.originX,originY:r.originY,overlayX:r.overlayX,overlayY:r.overlayY,offsetX:r.offsetX||this.offsetX,offsetY:r.offsetY||this.offsetY,panelClass:r.panelClass||void 0}));return t.setOrigin(this._getOrigin()).withPositions(i).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let t=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(t),t}_getOrigin(){return this.origin instanceof A8?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof A8?this.origin.elementRef.nativeElement:this.origin instanceof $e?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(km(()=>this.positionChange.observers.length>0)).subscribe(t=>{this._ngZone.run(()=>this.positionChange.emit(t)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||n)($($s),$(bn),$(Fr),$(BM),$(ar,8))}}static{this.\u0275dir=We({type:n,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[ve.None,"cdkConnectedOverlayOrigin","origin"],positions:[ve.None,"cdkConnectedOverlayPositions","positions"],positionStrategy:[ve.None,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[ve.None,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[ve.None,"cdkConnectedOverlayOffsetY","offsetY"],width:[ve.None,"cdkConnectedOverlayWidth","width"],height:[ve.None,"cdkConnectedOverlayHeight","height"],minWidth:[ve.None,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[ve.None,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[ve.None,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[ve.None,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[ve.None,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[ve.None,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[ve.None,"cdkConnectedOverlayOpen","open"],disableClose:[ve.None,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[ve.None,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[ve.HasDecoratorInputTransform,"cdkConnectedOverlayHasBackdrop","hasBackdrop",wt],lockPosition:[ve.HasDecoratorInputTransform,"cdkConnectedOverlayLockPosition","lockPosition",wt],flexibleDimensions:[ve.HasDecoratorInputTransform,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",wt],growAfterOpen:[ve.HasDecoratorInputTransform,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",wt],push:[ve.HasDecoratorInputTransform,"cdkConnectedOverlayPush","push",wt],disposeOnNavigation:[ve.HasDecoratorInputTransform,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",wt]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[jn,wn]})}}return n})();function eG(n){return()=>n.scrollStrategies.reposition()}var tG={provide:BM,deps:[$s],useFactory:eG},Une=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({providers:[$s,tG],imports:[ec,vM,U9,U9]})}}return n})();function nG(n,e){n&1&&It(0,"span",4)}function iG(n,e){n&1&&It(0,"span",5)}function rG(n,e){n&1&&It(0,"span",6)}function sG(n,e){n&1&&It(0,"span",7)}function oG(n,e){n&1&&It(0,"span",8)}function aG(n,e){if(n&1&&(oo(0),It(1,"span",9),ao()),n&2){let t=Zt();Le(),yt("innerHTML",t.instance.content,r4)}}function cG(n,e){if(n&1){let t=gr();Ye(0,"nz-message",2),Wn("destroyed",function(r){ur(t);let s=Zt();return hr(s.remove(r.id,r.userAction))}),at()}if(n&2){let t=e.$implicit;yt("instance",t)}}var lG=0,ic=class{constructor(e,t,i){this.nzSingletonService=e,this.overlay=t,this.injector=i}remove(e){this.container&&(e?this.container.remove(e):this.container.removeAll())}getInstanceId(){return`${this.componentPrefix}-${lG++}`}withContainer(e){let t=this.nzSingletonService.getSingletonWithKey(this.componentPrefix);if(t)return t;let i=this.overlay.create({hasBackdrop:!1,scrollStrategy:this.overlay.scrollStrategies.noop(),positionStrategy:this.overlay.position().global()}),r=new Z2(e,null,this.injector),s=i.attach(r),o=i.hostElement;return o.style.zIndex="1010",t||(this.container=t=s.instance,this.nzSingletonService.registerSingletonWithKey(this.componentPrefix,t),this.container.afterAllInstancesRemoved.subscribe(()=>{this.container=void 0,this.nzSingletonService.unregisterSingletonWithKey(this.componentPrefix),i.dispose()})),t}},J9=(()=>{class n{constructor(t,i){this.cdr=t,this.nzConfigService=i,this.instances=[],this._afterAllInstancesRemoved=new ce,this.afterAllInstancesRemoved=this._afterAllInstancesRemoved.asObservable(),this.destroy$=new ce,this.updateConfig()}ngOnInit(){this.subscribeConfigChange()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}create(t){let i=this.onCreate(t);return this.instances.length>=this.config.nzMaxStack&&(this.instances=this.instances.slice(1)),this.instances=[...this.instances,i],this.readyInstances(),i}remove(t,i=!1){this.instances.map((r,s)=>({index:s,instance:r})).filter(({instance:r})=>r.messageId===t).forEach(({index:r,instance:s})=>{this.instances.splice(r,1),this.instances=[...this.instances],this.onRemove(s,i),this.readyInstances()}),this.instances.length||this.onAllInstancesRemoved()}removeAll(){this.instances.forEach(t=>this.onRemove(t,!1)),this.instances=[],this.readyInstances(),this.onAllInstancesRemoved()}onCreate(t){return t.options=this.mergeOptions(t.options),t.onClose=new ce,t}onRemove(t,i){t.onClose.next(i),t.onClose.complete()}onAllInstancesRemoved(){this._afterAllInstancesRemoved.next(),this._afterAllInstancesRemoved.complete()}readyInstances(){this.cdr.detectChanges()}mergeOptions(t){let{nzDuration:i,nzAnimate:r,nzPauseOnHover:s}=this.config;return Re({nzDuration:i,nzAnimate:r,nzPauseOnHover:s},t)}static{this.\u0275fac=function(i){return new(i||n)($(Cn),$(Vr))}}static{this.\u0275dir=We({type:n})}}return n})(),em=(()=>{class n{constructor(t){this.cdr=t,this.destroyed=new Xt,this.animationStateChanged=new ce,this.userAction=!1}ngOnInit(){this.options=this.instance.options,this.options.nzAnimate&&(this.instance.state="enter",this.animationStateChanged.pipe(qt(t=>t.phaseName==="done"&&t.toState==="leave"),Di(1)).subscribe(()=>{clearTimeout(this.closeTimer),this.destroyed.next({id:this.instance.messageId,userAction:this.userAction})})),this.autoClose=this.options.nzDuration>0,this.autoClose&&(this.initErase(),this.startEraseTimeout())}ngOnDestroy(){this.autoClose&&this.clearEraseTimeout(),this.animationStateChanged.complete()}onEnter(){this.autoClose&&this.options.nzPauseOnHover&&(this.clearEraseTimeout(),this.updateTTL())}onLeave(){this.autoClose&&this.options.nzPauseOnHover&&this.startEraseTimeout()}destroy(t=!1){this.userAction=t,this.options.nzAnimate?(this.instance.state="leave",this.cdr.detectChanges(),this.closeTimer=setTimeout(()=>{this.closeTimer=void 0,this.destroyed.next({id:this.instance.messageId,userAction:t})},200)):this.destroyed.next({id:this.instance.messageId,userAction:t})}initErase(){this.eraseTTL=this.options.nzDuration,this.eraseTimingStart=Date.now()}updateTTL(){this.autoClose&&(this.eraseTTL-=Date.now()-this.eraseTimingStart)}startEraseTimeout(){this.eraseTTL>0?(this.clearEraseTimeout(),this.eraseTimer=setTimeout(()=>this.destroy(),this.eraseTTL),this.eraseTimingStart=Date.now()):this.destroy()}clearEraseTimeout(){this.eraseTimer!==null&&(clearTimeout(this.eraseTimer),this.eraseTimer=void 0)}static{this.\u0275fac=function(i){return new(i||n)($(Cn))}}static{this.\u0275dir=We({type:n})}}return n})(),qM=(()=>{class n extends em{constructor(t){super(t),this.destroyed=new Xt}static{this.\u0275fac=function(i){return new(i||n)($(Cn))}}static{this.\u0275cmp=di({type:n,selectors:[["nz-message"]],inputs:{instance:"instance"},outputs:{destroyed:"destroyed"},exportAs:["nzMessage"],standalone:!0,features:[kn,mi],decls:9,vars:4,consts:[[1,"ant-message-notice",3,"mouseenter","mouseleave"],[1,"ant-message-notice-content"],[1,"ant-message-custom-content",3,"ngClass"],[4,"nzStringTemplateOutlet"],["nz-icon","","nzType","check-circle"],["nz-icon","","nzType","info-circle"],["nz-icon","","nzType","exclamation-circle"],["nz-icon","","nzType","close-circle"],["nz-icon","","nzType","loading"],[3,"innerHTML"]],template:function(i,r){if(i&1&&(Ye(0,"div",0),Wn("@moveUpMotion.done",function(o){return r.animationStateChanged.next(o)})("mouseenter",function(){return r.onEnter()})("mouseleave",function(){return r.onLeave()}),Ye(1,"div",1)(2,"div",2),_n(3,nG,1,0)(4,iG,1,0)(5,rG,1,0)(6,sG,1,0)(7,oG,1,0)(8,aG,2,1,"ng-container",3),at()()()),i&2){let s;yt("@moveUpMotion",r.instance.state),Le(2),yt("ngClass","ant-message-"+r.instance.type),Le(),dr(3,(s=r.instance.type)==="success"?3:s==="info"?4:s==="warning"?5:s==="error"?6:s==="loading"?7:-1),Le(5),yt("nzStringTemplateOutlet",r.instance.content)}},dependencies:[zc,Ya,Ws,T8,S8],encapsulation:2,data:{animation:[yM]},changeDetection:0})}}return n})(),D8="message",uG={nzAnimate:!0,nzDuration:3e3,nzMaxStack:7,nzPauseOnHover:!0,nzTop:24,nzDirection:"ltr"},UM=(()=>{class n extends J9{constructor(t,i){super(t,i),this.dir="ltr";let r=this.nzConfigService.getConfigForComponent(D8);this.dir=r?.nzDirection||"ltr"}subscribeConfigChange(){this.nzConfigService.getConfigChangeEventForComponent(D8).pipe(it(this.destroy$)).subscribe(()=>{this.updateConfig();let t=this.nzConfigService.getConfigForComponent(D8);if(t){let{nzDirection:i}=t;this.dir=i||this.dir}})}updateConfig(){this.config=Re(Re(Re({},uG),this.config),this.nzConfigService.getConfigForComponent(D8)),this.top=K2(this.config.nzTop),this.cdr.markForCheck()}static{this.\u0275fac=function(i){return new(i||n)($(Cn),$(Vr))}}static{this.\u0275cmp=di({type:n,selectors:[["nz-message-container"]],exportAs:["nzMessageContainer"],standalone:!0,features:[kn,mi],decls:3,vars:4,consts:[[1,"ant-message"],[3,"instance"],[3,"destroyed","instance"]],template:function(i,r){i&1&&(Ye(0,"div",0),mr(1,cG,1,1,"nz-message",1,fr),at()),i&2&&(fi("top",r.top),Nt("ant-message-rtl",r.dir==="rtl"),Le(),pr(r.instances))},dependencies:[qM],encapsulation:2,changeDetection:0})}}return n})(),lie=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({imports:[UM,qM]})}}return n})(),uie=(()=>{class n extends ic{constructor(t,i,r){super(t,i,r),this.componentPrefix="message-"}success(t,i){return this.createInstance({type:"success",content:t},i)}error(t,i){return this.createInstance({type:"error",content:t},i)}info(t,i){return this.createInstance({type:"info",content:t},i)}warning(t,i){return this.createInstance({type:"warning",content:t},i)}loading(t,i){return this.createInstance({type:"loading",content:t},i)}create(t,i,r){return this.createInstance({type:t,content:i},r)}createInstance(t,i){return this.container=this.withContainer(UM),this.container.create(qn(Re({},t),{createdAt:new Date,messageId:this.getInstanceId(),options:i}))}static{this.\u0275fac=function(i){return new(i||n)(D(E8),D($s),D(ki))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var hG=(n,e)=>({$implicit:n,data:e}),dG=n=>({$implicit:n});function fG(n,e){}function mG(n,e){if(n&1&&_n(0,fG,0,0,"ng-template",1),n&2){let t=Zt();yt("ngTemplateOutlet",t.instance.template)("ngTemplateOutletContext",qm(2,hG,t,t.instance.options==null?null:t.instance.options.nzData))}}function pG(n,e){n&1&&It(0,"span",9)}function gG(n,e){n&1&&It(0,"span",10)}function vG(n,e){n&1&&It(0,"span",11)}function yG(n,e){n&1&&It(0,"span",12)}function wG(n,e){if(n&1&&(oo(0),It(1,"div",13),ao()),n&2){let t=Zt(2);Le(),yt("innerHTML",t.instance.title,r4)}}function bG(n,e){if(n&1&&(oo(0),It(1,"div",13),ao()),n&2){let t=Zt(2);Le(),yt("innerHTML",t.instance.content,r4)}}function _G(n,e){}function CG(n,e){if(n&1&&(Ye(0,"span",8),_n(1,_G,0,0,"ng-template",1),at()),n&2){let t=Zt(2);Le(),yt("ngTemplateOutlet",e)("ngTemplateOutletContext",Fm(2,dG,t))}}function SG(n,e){if(n&1&&(Ye(0,"div",4)(1,"div",4)(2,"div"),_n(3,pG,1,0)(4,gG,1,0)(5,vG,1,0)(6,yG,1,0),Ye(7,"div",5),_n(8,wG,2,1,"ng-container",6),at(),Ye(9,"div",7),_n(10,bG,2,1,"ng-container",6),at(),_n(11,CG,2,4,"span",8),at()()()),n&2){let t,i,r=Zt();Le(2),Nt("ant-notification-notice-with-icon",r.instance.type!=="blank"),Le(),dr(3,(t=r.instance.type)==="success"?3:t==="info"?4:t==="warning"?5:t==="error"?6:-1),Le(5),yt("nzStringTemplateOutlet",r.instance.title),Le(2),yt("nzStringTemplateOutlet",r.instance.content),Le(),dr(11,(i=r.instance.options==null?null:r.instance.options.nzButton)?11:-1,i)}}function TG(n,e){if(n&1&&(oo(0),It(1,"span",14),ao()),n&2){let t=e.$implicit;Le(),yt("nzType",t)}}function EG(n,e){if(n&1&&_n(0,TG,2,1,"ng-container",6),n&2){let t=Zt();yt("nzStringTemplateOutlet",t.instance.options==null?null:t.instance.options.nzCloseIcon)}}function MG(n,e){n&1&&It(0,"span",15)}function zG(n,e){if(n&1){let t=gr();Ye(0,"nz-notification",7),Wn("destroyed",function(r){ur(t);let s=Zt();return hr(s.remove(r.id,r.userAction))}),at()}if(n&2){let t=e.$implicit;yt("instance",t)("placement","topLeft")}}function xG(n,e){if(n&1){let t=gr();Ye(0,"nz-notification",7),Wn("destroyed",function(r){ur(t);let s=Zt();return hr(s.remove(r.id,r.userAction))}),at()}if(n&2){let t=e.$implicit;yt("instance",t)("placement","topRight")}}function OG(n,e){if(n&1){let t=gr();Ye(0,"nz-notification",7),Wn("destroyed",function(r){ur(t);let s=Zt();return hr(s.remove(r.id,r.userAction))}),at()}if(n&2){let t=e.$implicit;yt("instance",t)("placement","bottomLeft")}}function IG(n,e){if(n&1){let t=gr();Ye(0,"nz-notification",7),Wn("destroyed",function(r){ur(t);let s=Zt();return hr(s.remove(r.id,r.userAction))}),at()}if(n&2){let t=e.$implicit;yt("instance",t)("placement","bottomRight")}}function AG(n,e){if(n&1){let t=gr();Ye(0,"nz-notification",7),Wn("destroyed",function(r){ur(t);let s=Zt();return hr(s.remove(r.id,r.userAction))}),at()}if(n&2){let t=e.$implicit;yt("instance",t)("placement","top")}}function DG(n,e){if(n&1){let t=gr();Ye(0,"nz-notification",7),Wn("destroyed",function(r){ur(t);let s=Zt();return hr(s.remove(r.id,r.userAction))}),at()}if(n&2){let t=e.$implicit;yt("instance",t)("placement","bottom")}}var jM=(()=>{class n extends em{constructor(t){super(t),this.destroyed=new Xt}ngOnDestroy(){super.ngOnDestroy(),this.instance.onClick.complete()}onClick(t){this.instance.onClick.next(t)}close(){this.destroy(!0)}get state(){if(this.instance.state==="enter")switch(this.placement){case"topLeft":case"bottomLeft":return"enterLeft";case"topRight":case"bottomRight":return"enterRight";case"top":return"enterTop";case"bottom":return"enterBottom";default:return"enterRight"}else return this.instance.state}static{this.\u0275fac=function(i){return new(i||n)($(Cn))}}static{this.\u0275cmp=di({type:n,selectors:[["nz-notification"]],inputs:{instance:"instance",index:"index",placement:"placement"},outputs:{destroyed:"destroyed"},exportAs:["nzNotification"],standalone:!0,features:[kn,mi],decls:7,vars:5,consts:[[1,"ant-notification-notice","ant-notification-notice-closable",3,"click","mouseenter","mouseleave","ngStyle","ngClass"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["tabindex","0",1,"ant-notification-notice-close",3,"click"],[1,"ant-notification-notice-close-x"],[1,"ant-notification-notice-content"],[1,"ant-notification-notice-message"],[4,"nzStringTemplateOutlet"],[1,"ant-notification-notice-description"],[1,"ant-notification-notice-btn"],["nz-icon","","nzType","check-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-success"],["nz-icon","","nzType","info-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-info"],["nz-icon","","nzType","exclamation-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-warning"],["nz-icon","","nzType","close-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-error"],[3,"innerHTML"],["nz-icon","",3,"nzType"],["nz-icon","","nzType","close",1,"ant-notification-close-icon"]],template:function(i,r){i&1&&(Ye(0,"div",0),Wn("@notificationMotion.done",function(o){return r.animationStateChanged.next(o)})("click",function(o){return r.onClick(o)})("mouseenter",function(){return r.onEnter()})("mouseleave",function(){return r.onLeave()}),_n(1,mG,1,5,null,1)(2,SG,12,6),Ye(3,"a",2),Wn("click",function(){return r.close()}),Ye(4,"span",3),_n(5,EG,1,1,"ng-container")(6,MG,1,0),at()()()),i&2&&(yt("ngStyle",(r.instance.options==null?null:r.instance.options.nzStyle)||null)("ngClass",(r.instance.options==null?null:r.instance.options.nzClass)||"")("@notificationMotion",r.state),Le(),dr(1,r.instance.template?1:2),Le(4),dr(5,r.instance.options!=null&&r.instance.options.nzCloseIcon?5:6))},dependencies:[Km,zc,Ya,Ws,T8,S8,Qm],encapsulation:2,data:{animation:[wM]}})}}return n})(),k8="notification",kG={nzTop:"24px",nzBottom:"24px",nzPlacement:"topRight",nzDuration:4500,nzMaxStack:8,nzPauseOnHover:!0,nzAnimate:!0,nzDirection:"ltr"},WM=(()=>{class n extends J9{constructor(t,i){super(t,i),this.dir="ltr",this.instances=[],this.topLeftInstances=[],this.topRightInstances=[],this.bottomLeftInstances=[],this.bottomRightInstances=[],this.topInstances=[],this.bottomInstances=[];let r=this.nzConfigService.getConfigForComponent(k8);this.dir=r?.nzDirection||"ltr"}create(t){let i=this.onCreate(t),r=i.options.nzKey,s=this.instances.find(o=>o.options.nzKey===t.options.nzKey);return r&&s?this.replaceNotification(s,i):(this.instances.length>=this.config.nzMaxStack&&(this.instances=this.instances.slice(1)),this.instances=[...this.instances,i]),this.readyInstances(),i}onCreate(t){return t.options=this.mergeOptions(t.options),t.onClose=new ce,t.onClick=new ce,t}subscribeConfigChange(){this.nzConfigService.getConfigChangeEventForComponent(k8).pipe(it(this.destroy$)).subscribe(()=>{this.updateConfig();let t=this.nzConfigService.getConfigForComponent(k8);if(t){let{nzDirection:i}=t;this.dir=i||this.dir}})}updateConfig(){this.config=Re(Re(Re({},kG),this.config),this.nzConfigService.getConfigForComponent(k8)),this.top=K2(this.config.nzTop),this.bottom=K2(this.config.nzBottom),this.cdr.markForCheck()}replaceNotification(t,i){t.title=i.title,t.content=i.content,t.template=i.template,t.type=i.type,t.options=i.options}readyInstances(){let t={topLeft:[],topRight:[],bottomLeft:[],bottomRight:[],top:[],bottom:[]};this.instances.forEach(i=>{switch(i.options.nzPlacement){case"topLeft":t.topLeft.unshift(i);break;case"topRight":t.topRight.unshift(i);break;case"bottomLeft":t.bottomLeft.unshift(i);break;case"bottomRight":t.bottomRight.unshift(i);break;case"top":t.top.unshift(i);break;case"bottom":t.bottom.unshift(i);break;default:t.topRight.unshift(i)}}),this.topLeftInstances=t.topLeft,this.topRightInstances=t.topRight,this.bottomLeftInstances=t.bottomLeft,this.bottomRightInstances=t.bottomRight,this.topInstances=t.top,this.bottomInstances=t.bottom,this.cdr.detectChanges()}mergeOptions(t){let{nzDuration:i,nzAnimate:r,nzPauseOnHover:s,nzPlacement:o}=this.config;return Re({nzDuration:i,nzAnimate:r,nzPauseOnHover:s,nzPlacement:o},t)}static{this.\u0275fac=function(i){return new(i||n)($(Cn),$(Vr))}}static{this.\u0275cmp=di({type:n,selectors:[["nz-notification-container"]],exportAs:["nzNotificationContainer"],standalone:!0,features:[kn,mi],decls:18,vars:40,consts:[[1,"ant-notification","ant-notification-topLeft"],[3,"instance","placement"],[1,"ant-notification","ant-notification-topRight"],[1,"ant-notification","ant-notification-bottomLeft"],[1,"ant-notification","ant-notification-bottomRight"],[1,"ant-notification","ant-notification-top"],[1,"ant-notification","ant-notification-bottom"],[3,"destroyed","instance","placement"]],template:function(i,r){i&1&&(Ye(0,"div",0),mr(1,zG,1,2,"nz-notification",1,fr),at(),Ye(3,"div",2),mr(4,xG,1,2,"nz-notification",1,fr),at(),Ye(6,"div",3),mr(7,OG,1,2,"nz-notification",1,fr),at(),Ye(9,"div",4),mr(10,IG,1,2,"nz-notification",1,fr),at(),Ye(12,"div",5),mr(13,AG,1,2,"nz-notification",1,fr),at(),Ye(15,"div",6),mr(16,DG,1,2,"nz-notification",1,fr),at()),i&2&&(fi("top",r.top)("left","0px"),Nt("ant-notification-rtl",r.dir==="rtl"),Le(),pr(r.topLeftInstances),Le(2),fi("top",r.top)("right","0px"),Nt("ant-notification-rtl",r.dir==="rtl"),Le(),pr(r.topRightInstances),Le(2),fi("bottom",r.bottom)("left","0px"),Nt("ant-notification-rtl",r.dir==="rtl"),Le(),pr(r.bottomLeftInstances),Le(2),fi("bottom",r.bottom)("right","0px"),Nt("ant-notification-rtl",r.dir==="rtl"),Le(),pr(r.bottomRightInstances),Le(2),fi("top",r.top)("left","50%")("transform","translateX(-50%)"),Nt("ant-notification-rtl",r.dir==="rtl"),Le(),pr(r.topInstances),Le(2),fi("bottom",r.bottom)("left","50%")("transform","translateX(-50%)"),Nt("ant-notification-rtl",r.dir==="rtl"),Le(),pr(r.bottomInstances))},dependencies:[jM],encapsulation:2,changeDetection:0})}}return n})(),Oie=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({imports:[jM,WM]})}}return n})(),RG=0,$M=(()=>{class n extends ic{constructor(t,i,r){super(t,i,r),this.componentPrefix="notification-"}success(t,i,r){return this.create("success",t,i,r)}error(t,i,r){return this.create("error",t,i,r)}info(t,i,r){return this.create("info",t,i,r)}warning(t,i,r){return this.create("warning",t,i,r)}blank(t,i,r){return this.create("blank",t,i,r)}create(t,i,r,s){return this.createInstance({type:t,title:i,content:r},s)}template(t,i){return this.createInstance({template:t},i)}generateMessageId(){return`${this.componentPrefix}-${RG++}`}createInstance(t,i){return this.container=this.withContainer(WM),this.container.create(qn(Re({},t),{createdAt:new Date,messageId:i?.nzKey||this.generateMessageId(),options:i}))}static{this.\u0275fac=function(i){return new(i||n)(D(E8),D($s),D(ki))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var tm=function(n){return n.user="user",n.student="student",n.manager="manager",n.admin="admin",n}(tm||{}),nm=function(n){return n.canRead="canRead",n.canList="canList",n.canUpdate="canUpdate",n.canWrite="canWrite",n.canCreate="canCreate",n.canDelete="canDelete",n}(nm||{});var cse=el(Tx(),1);var bse=(()=>{class n{constructor(t,i,r,s,o){this.afAuth=t,this.afs=i,this.router=r,this.ngZone=s,this.notification=o,this.user=this.afAuth.authState.pipe(hi(a=>a?(localStorage.setItem("user",JSON.stringify(a)),this.afs.doc(`users/${a.uid}`).valueChanges()):(typeof localStorage<"u"&&localStorage.removeItem("user"),St(null))))}getUser(){return this.user}signIn(t,i){return this.afAuth.signInWithEmailAndPassword(t,i).then(r=>{this.ngZone.run(()=>{r.user.emailVerified?this.getAccessLevel(r.user.uid):this.notification.create("warning","\xA1Oops!, su cuenta no ha sido verificada","Para continuar es necesario verificar su cuenta de correo electr\xF3nico.")})}).catch(r=>{this.notification.create("error","Error..",r.message)})}getAccessLevel(t){return S(this,null,function*(){(yield this.afs.collection("users").doc(t)).snapshotChanges().pipe(Di(1),Ge(r=>{let s=r.payload.id,o=r.payload.data();return Re({id:s},o)})).subscribe(r=>{let s=["admin","student","user"],o=["admin","user"],a=r.roles.some(c=>s.includes(c));Array.isArray(r)&&(r.some(l=>l.hasOwnProperty("idSegment"))||this.afs.collection("users").doc(t).update({idSegment:"JvgynF0jaP7n1S1oC7pX"})),a?this.router.navigate(["/dashboard/admin"]):(this.notification.create("warning","\xA1Oops!, su cuenta no tiene acceso a este sistema","Si esto es un error, por favor contacte al administrador del sitio."),this.signOut())})})}signUp(t){let i=t.email,r=t.password;return this.afAuth.createUserWithEmailAndPassword(i,r).then(s=>{this.setUserData(s.user,t),this.sendVerificationMail()}).catch(s=>{this.notification.create("error","Error de creaci\xF3n de Usuario",s)})}sendVerificationMail(){return S(this,null,function*(){try{let t=yield this.afAuth.currentUser;t?(yield t.sendEmailVerification(),this.router.navigate(["authentication/verify-email"]),this.notification.create("info","\xA1Perfecto!","El correo ha sido enviado")):this.notification.create("error","Error de verificaci\xF3n de correo","No hay usuario registrado")}catch(t){this.notification.create("error","Error de verificaci\xF3n de correo",t.message)}})}forgotPassword(t){return this.afAuth.sendPasswordResetEmail(t).then(()=>{this.notification.create("info","\xA1Listo!","Se ha enviado un correo electr\xF3nico a su cuenta con la informaci\xF3n necesaria para recuperar su contrase\xF1a.")}).catch(i=>{this.notification.create("error","\xA1Oops!, algo sali\xF3 mal ...",i)})}get isLoggedIn(){return!!this.user}googleAuth(){return this.AuthLogin(new kc)}AuthLogin(t){return this.afAuth.signInWithPopup(t).then(i=>{this.ngZone.run(()=>{this.router.navigate(["dashboard"])}),this.setUserData(i.user)}).catch(i=>{this.notification.create("error","\xA1Oops!, algo sali\xF3 mal ...",i)})}setUserData(t,i){let r=this.afs.doc(`users/${t.uid}`),s={uid:t.uid,email:t.email,phoneNumber:i&&i.phoneNumber?i.phoneNumber:null,displayName:i.firstName+" "+i.lastName,studentId:i&&i.studentId?i.studentId:null,photoURL:t.photoURL,roles:[tm.admin],permissions:[nm.canRead],emailVerified:t.emailVerified,name:i.firstName,firstName:i.firstName,lastName:i.lastName,customerName:i.customerName,customerId:i.customerId,round:i.round,status:i&&i.status!==void 0?i.status:"active",rolId:i&&i.rolId!==void 0?i.rolId:"54YNS3xlSLPc6UzNq2HJ",roundTrip:i.roundTrip,turno:i.turno,idSegment:"JvgynF0jaP7n1S1oC7pX",defaultRouteName:i.defaultRouteName,defaultRoute:i.defaultRoute,defaultRound:i.defaultRound};return r.set(s,{merge:!0}).then(o=>{this.updateUserProfile(i)}).catch(o=>this.notification.create("error","Error..",o))}getUserFromDatabase(t){this.afs.doc(`users/${t.uid}`).snapshotChanges().subscribe(r=>r.payload.data())}updateUserData(t){let i=this.afs.doc(`users/${t.uid}`),r={emailVerified:t.emailVerified};return i.set(r,{merge:!0}).then(s=>this.notification.create("sucess","Resultado..",s)).catch(s=>this.notification.create("error","Error..",s))}updateUserProfile(t){let r=hl().currentUser;r?ul(r,{displayName:t&&t.fullName?t.fullName:null,photoURL:"https://example.com/jane-q-user/profile.jpg"}).then(()=>{this.notification.create("sucess","Info ..","Actualizacion correcta")}).catch(s=>{this.notification.create("error","Error ..",s)}):this.notification.create("error","Error ..","No Existe un usuario loggeado en la aplicaci\xF3n")}googleLogin(){let t=new kc;return this.oAuthLogin(t)}oAuthLogin(t){return this.afAuth.signInWithPopup(t).then(i=>{this.updateUserData(i.user)})}signOut(){this.afAuth.signOut().then(()=>{this.router.navigate(["/authentication/login"])})}static{this.\u0275fac=function(i){return new(i||n)(D(F2),D(f9),D(Jm),D(Se),D($M))}}static{this.\u0275prov=me({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function O(n,e){if(e.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+e.length+" present")}function q(n){O(1,arguments);var e=Object.prototype.toString.call(n);return n instanceof Date||pn(n)==="object"&&e==="[object Date]"?new Date(n.getTime()):typeof n=="number"||e==="[object Number]"?new Date(n):((typeof n=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function cr(n){O(1,arguments);var e=q(n);return e.setHours(0,0,0,0),e}function rc(n){O(1,arguments);var e=q(n);return e.setHours(23,59,59,999),e}function GM(){return rc(Date.now())}function im(n){return O(1,arguments),n instanceof Date||pn(n)==="object"&&Object.prototype.toString.call(n)==="[object Date]"}function R8(n){if(O(1,arguments),!im(n)&&typeof n!="number")return!1;var e=q(n);return!isNaN(Number(e))}function ue(n){if(n===null||n===!0||n===!1)return NaN;var e=Number(n);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function sc(n,e){O(2,arguments);var t=q(n).getTime(),i=ue(e);return new Date(t+i)}function oc(n,e){O(2,arguments);var t=ue(e);return sc(n,-t)}var VG=864e5;function rm(n){O(1,arguments);var e=q(n),t=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var i=e.getTime(),r=t-i;return Math.floor(r/VG)+1}function ai(n){O(1,arguments);var e=1,t=q(n),i=t.getUTCDay(),r=(i<e?7:0)+i-e;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function ac(n){O(1,arguments);var e=q(n),t=e.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(t+1,0,4),i.setUTCHours(0,0,0,0);var r=ai(i),s=new Date(0);s.setUTCFullYear(t,0,4),s.setUTCHours(0,0,0,0);var o=ai(s);return e.getTime()>=r.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function sm(n){O(1,arguments);var e=ac(n),t=new Date(0);t.setUTCFullYear(e,0,4),t.setUTCHours(0,0,0,0);var i=ai(t);return i}var NG=6048e5;function cc(n){O(1,arguments);var e=q(n),t=ai(e).getTime()-sm(e).getTime();return Math.round(t/NG)+1}var PG={};function on(){return PG}function Fn(n,e){var t,i,r,s,o,a,c,l;O(1,arguments);var u=on(),h=ue((t=(i=(r=(s=e?.weekStartsOn)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&r!==void 0?r:u.weekStartsOn)!==null&&i!==void 0?i:(c=u.locale)===null||c===void 0||(l=c.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&t!==void 0?t:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=q(n),g=d.getUTCDay(),_=(g<h?7:0)+g-h;return d.setUTCDate(d.getUTCDate()-_),d.setUTCHours(0,0,0,0),d}function G1(n,e){var t,i,r,s,o,a,c,l;O(1,arguments);var u=q(n),h=u.getUTCFullYear(),d=on(),g=ue((t=(i=(r=(s=e?.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&r!==void 0?r:d.firstWeekContainsDate)!==null&&i!==void 0?i:(c=d.locale)===null||c===void 0||(l=c.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&t!==void 0?t:1);if(!(g>=1&&g<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var _=new Date(0);_.setUTCFullYear(h+1,0,g),_.setUTCHours(0,0,0,0);var T=Fn(_,e),E=new Date(0);E.setUTCFullYear(h,0,g),E.setUTCHours(0,0,0,0);var L=Fn(E,e);return u.getTime()>=T.getTime()?h+1:u.getTime()>=L.getTime()?h:h-1}function om(n,e){var t,i,r,s,o,a,c,l;O(1,arguments);var u=on(),h=ue((t=(i=(r=(s=e?.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&r!==void 0?r:u.firstWeekContainsDate)!==null&&i!==void 0?i:(c=u.locale)===null||c===void 0||(l=c.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&t!==void 0?t:1),d=G1(n,e),g=new Date(0);g.setUTCFullYear(d,0,h),g.setUTCHours(0,0,0,0);var _=Fn(g,e);return _}var HG=6048e5;function lc(n,e){O(1,arguments);var t=q(n),i=Fn(t,e).getTime()-om(t,e).getTime();return Math.round(i/HG)+1}function ke(n,e){for(var t=n<0?"-":"",i=Math.abs(n).toString();i.length<e;)i="0"+i;return t+i}var BG={y:function(e,t){var i=e.getUTCFullYear(),r=i>0?i:1-i;return ke(t==="yy"?r%100:r,t.length)},M:function(e,t){var i=e.getUTCMonth();return t==="M"?String(i+1):ke(i+1,2)},d:function(e,t){return ke(e.getUTCDate(),t.length)},a:function(e,t){var i=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];case"aaaa":default:return i==="am"?"a.m.":"p.m."}},h:function(e,t){return ke(e.getUTCHours()%12||12,t.length)},H:function(e,t){return ke(e.getUTCHours(),t.length)},m:function(e,t){return ke(e.getUTCMinutes(),t.length)},s:function(e,t){return ke(e.getUTCSeconds(),t.length)},S:function(e,t){var i=t.length,r=e.getUTCMilliseconds(),s=Math.floor(r*Math.pow(10,i-3));return ke(s,t.length)}},Nr=BG;var Qa={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},FG={G:function(e,t,i){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"});case"GGGGG":return i.era(r,{width:"narrow"});case"GGGG":default:return i.era(r,{width:"wide"})}},y:function(e,t,i){if(t==="yo"){var r=e.getUTCFullYear(),s=r>0?r:1-r;return i.ordinalNumber(s,{unit:"year"})}return Nr.y(e,t)},Y:function(e,t,i,r){var s=G1(e,r),o=s>0?s:1-s;if(t==="YY"){var a=o%100;return ke(a,2)}return t==="Yo"?i.ordinalNumber(o,{unit:"year"}):ke(o,t.length)},R:function(e,t){var i=ac(e);return ke(i,t.length)},u:function(e,t){var i=e.getUTCFullYear();return ke(i,t.length)},Q:function(e,t,i){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return ke(r,2);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,i){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return ke(r,2);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,i){var r=e.getUTCMonth();switch(t){case"M":case"MM":return Nr.M(e,t);case"Mo":return i.ordinalNumber(r+1,{unit:"month"});case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,i){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return ke(r+1,2);case"Lo":return i.ordinalNumber(r+1,{unit:"month"});case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,i,r){var s=lc(e,r);return t==="wo"?i.ordinalNumber(s,{unit:"week"}):ke(s,t.length)},I:function(e,t,i){var r=cc(e);return t==="Io"?i.ordinalNumber(r,{unit:"week"}):ke(r,t.length)},d:function(e,t,i){return t==="do"?i.ordinalNumber(e.getUTCDate(),{unit:"date"}):Nr.d(e,t)},D:function(e,t,i){var r=rm(e);return t==="Do"?i.ordinalNumber(r,{unit:"dayOfYear"}):ke(r,t.length)},E:function(e,t,i){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"});case"EEEE":default:return i.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,i,r){var s=e.getUTCDay(),o=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return ke(o,2);case"eo":return i.ordinalNumber(o,{unit:"day"});case"eee":return i.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(s,{width:"short",context:"formatting"});case"eeee":default:return i.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,i,r){var s=e.getUTCDay(),o=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return ke(o,t.length);case"co":return i.ordinalNumber(o,{unit:"day"});case"ccc":return i.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(s,{width:"narrow",context:"standalone"});case"cccccc":return i.day(s,{width:"short",context:"standalone"});case"cccc":default:return i.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,i){var r=e.getUTCDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return ke(s,t.length);case"io":return i.ordinalNumber(s,{unit:"day"});case"iii":return i.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(r,{width:"short",context:"formatting"});case"iiii":default:return i.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,i){var r=e.getUTCHours(),s=r/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,i){var r=e.getUTCHours(),s;switch(r===12?s=Qa.noon:r===0?s=Qa.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,i){var r=e.getUTCHours(),s;switch(r>=17?s=Qa.evening:r>=12?s=Qa.afternoon:r>=4?s=Qa.morning:s=Qa.night,t){case"B":case"BB":case"BBB":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,i){if(t==="ho"){var r=e.getUTCHours()%12;return r===0&&(r=12),i.ordinalNumber(r,{unit:"hour"})}return Nr.h(e,t)},H:function(e,t,i){return t==="Ho"?i.ordinalNumber(e.getUTCHours(),{unit:"hour"}):Nr.H(e,t)},K:function(e,t,i){var r=e.getUTCHours()%12;return t==="Ko"?i.ordinalNumber(r,{unit:"hour"}):ke(r,t.length)},k:function(e,t,i){var r=e.getUTCHours();return r===0&&(r=24),t==="ko"?i.ordinalNumber(r,{unit:"hour"}):ke(r,t.length)},m:function(e,t,i){return t==="mo"?i.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):Nr.m(e,t)},s:function(e,t,i){return t==="so"?i.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):Nr.s(e,t)},S:function(e,t){return Nr.S(e,t)},X:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();if(o===0)return"Z";switch(t){case"X":return KM(o);case"XXXX":case"XX":return Y1(o);case"XXXXX":case"XXX":default:return Y1(o,":")}},x:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();switch(t){case"x":return KM(o);case"xxxx":case"xx":return Y1(o);case"xxxxx":case"xxx":default:return Y1(o,":")}},O:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+YM(o,":");case"OOOO":default:return"GMT"+Y1(o,":")}},z:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+YM(o,":");case"zzzz":default:return"GMT"+Y1(o,":")}},t:function(e,t,i,r){var s=r._originalDate||e,o=Math.floor(s.getTime()/1e3);return ke(o,t.length)},T:function(e,t,i,r){var s=r._originalDate||e,o=s.getTime();return ke(o,t.length)}};function YM(n,e){var t=n>0?"-":"+",i=Math.abs(n),r=Math.floor(i/60),s=i%60;if(s===0)return t+String(r);var o=e||"";return t+String(r)+o+ke(s,2)}function KM(n,e){if(n%60===0){var t=n>0?"-":"+";return t+ke(Math.abs(n)/60,2)}return Y1(n,e)}function Y1(n,e){var t=e||"",i=n>0?"-":"+",r=Math.abs(n),s=ke(Math.floor(r/60),2),o=ke(r%60,2);return i+s+t+o}var QM=FG;var XM=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ZM=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},qG=function(e,t){var i=e.match(/(P+)(p+)?/)||[],r=i[1],s=i[2];if(!s)return XM(e,t);var o;switch(r){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",XM(r,t)).replace("{{time}}",ZM(s,t))},UG={p:ZM,P:qG},uc=UG;function Gs(n){var e=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return e.setUTCFullYear(n.getFullYear()),n.getTime()-e.getTime()}var jG=["D","DD"],WG=["YY","YYYY"];function L8(n){return jG.indexOf(n)!==-1}function V8(n){return WG.indexOf(n)!==-1}function Xa(n,e,t){if(n==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var $G={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},GG=function(e,t,i){var r,s=$G[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"in "+r:r+" ago":r},JM=GG;function hc(n){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.width?String(e.width):n.defaultWidth,i=n.formats[t]||n.formats[n.defaultWidth];return i}}var YG={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},KG={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},QG={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},XG={date:hc({formats:YG,defaultWidth:"full"}),time:hc({formats:KG,defaultWidth:"full"}),dateTime:hc({formats:QG,defaultWidth:"full"})},ez=XG;var ZG={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},JG=function(e,t,i,r){return ZG[e]},tz=JG;function K1(n){return function(e,t){var i=t!=null&&t.context?String(t.context):"standalone",r;if(i==="formatting"&&n.formattingValues){var s=n.defaultFormattingWidth||n.defaultWidth,o=t!=null&&t.width?String(t.width):s;r=n.formattingValues[o]||n.formattingValues[s]}else{var a=n.defaultWidth,c=t!=null&&t.width?String(t.width):n.defaultWidth;r=n.values[c]||n.values[a]}var l=n.argumentCallback?n.argumentCallback(e):e;return r[l]}}var eY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},tY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},nY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},iY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},rY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},sY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},oY=function(e,t){var i=Number(e),r=i%100;if(r>20||r<10)switch(r%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},aY={ordinalNumber:oY,era:K1({values:eY,defaultWidth:"wide"}),quarter:K1({values:tY,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:K1({values:nY,defaultWidth:"wide"}),day:K1({values:iY,defaultWidth:"wide"}),dayPeriod:K1({values:rY,defaultWidth:"wide",formattingValues:sY,defaultFormattingWidth:"wide"})},nz=aY;function Q1(n){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.width,r=i&&n.matchPatterns[i]||n.matchPatterns[n.defaultMatchWidth],s=e.match(r);if(!s)return null;var o=s[0],a=i&&n.parsePatterns[i]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(a)?lY(a,function(h){return h.test(o)}):cY(a,function(h){return h.test(o)}),l;l=n.valueCallback?n.valueCallback(c):c,l=t.valueCallback?t.valueCallback(l):l;var u=e.slice(o.length);return{value:l,rest:u}}}function cY(n,e){for(var t in n)if(n.hasOwnProperty(t)&&e(n[t]))return t}function lY(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return t}function am(n){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.match(n.matchPattern);if(!i)return null;var r=i[0],s=e.match(n.parsePattern);if(!s)return null;var o=n.valueCallback?n.valueCallback(s[0]):s[0];o=t.valueCallback?t.valueCallback(o):o;var a=e.slice(r.length);return{value:o,rest:a}}}var uY=/^(\d+)(th|st|nd|rd)?/i,hY=/\d+/i,dY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},fY={any:[/^b/i,/^(a|c)/i]},mY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},pY={any:[/1/i,/2/i,/3/i,/4/i]},gY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},vY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},yY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},wY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},bY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},_Y={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},CY={ordinalNumber:am({matchPattern:uY,parsePattern:hY,valueCallback:function(e){return parseInt(e,10)}}),era:Q1({matchPatterns:dY,defaultMatchWidth:"wide",parsePatterns:fY,defaultParseWidth:"any"}),quarter:Q1({matchPatterns:mY,defaultMatchWidth:"wide",parsePatterns:pY,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Q1({matchPatterns:gY,defaultMatchWidth:"wide",parsePatterns:vY,defaultParseWidth:"any"}),day:Q1({matchPatterns:yY,defaultMatchWidth:"wide",parsePatterns:wY,defaultParseWidth:"any"}),dayPeriod:Q1({matchPatterns:bY,defaultMatchWidth:"any",parsePatterns:_Y,defaultParseWidth:"any"})},iz=CY;var SY={code:"en-US",formatDistance:JM,formatLong:ez,formatRelative:tz,localize:nz,match:iz,options:{weekStartsOn:0,firstWeekContainsDate:1}},rz=SY;var N8=rz;var TY=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,EY=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,MY=/^'([^]*?)'?$/,zY=/''/g,xY=/[a-zA-Z]/;function sz(n,e,t){var i,r,s,o,a,c,l,u,h,d,g,_,T,E,L,x,V,P;O(2,arguments);var G=String(e),K=on(),w=(i=(r=t?.locale)!==null&&r!==void 0?r:K.locale)!==null&&i!==void 0?i:N8,v=ue((s=(o=(a=(c=t?.firstWeekContainsDate)!==null&&c!==void 0?c:t==null||(l=t.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&a!==void 0?a:K.firstWeekContainsDate)!==null&&o!==void 0?o:(h=K.locale)===null||h===void 0||(d=h.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(v>=1&&v<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var y=ue((g=(_=(T=(E=t?.weekStartsOn)!==null&&E!==void 0?E:t==null||(L=t.locale)===null||L===void 0||(x=L.options)===null||x===void 0?void 0:x.weekStartsOn)!==null&&T!==void 0?T:K.weekStartsOn)!==null&&_!==void 0?_:(V=K.locale)===null||V===void 0||(P=V.options)===null||P===void 0?void 0:P.weekStartsOn)!==null&&g!==void 0?g:0);if(!(y>=0&&y<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!w.localize)throw new RangeError("locale must contain localize property");if(!w.formatLong)throw new RangeError("locale must contain formatLong property");var b=q(n);if(!R8(b))throw new RangeError("Invalid time value");var m=Gs(b),C=oc(b,m),f={firstWeekContainsDate:v,weekStartsOn:y,locale:w,_originalDate:b},p=G.match(EY).map(function(F){var le=F[0];if(le==="p"||le==="P"){var Ae=uc[le];return Ae(F,w.formatLong)}return F}).join("").match(TY).map(function(F){if(F==="''")return"'";var le=F[0];if(le==="'")return OY(F);var Ae=QM[le];if(Ae)return!(t!=null&&t.useAdditionalWeekYearTokens)&&V8(F)&&Xa(F,e,String(n)),!(t!=null&&t.useAdditionalDayOfYearTokens)&&L8(F)&&Xa(F,e,String(n)),Ae(C,F,w.localize,f);if(le.match(xY))throw new RangeError("Format string contains an unescaped latin alphabet character `"+le+"`");return F}).join("");return p}function OY(n){var e=n.match(MY);return e?e[1].replace(zY,"'"):n}function oz(n){O(1,arguments);var e=ue(n);return q(e*1e3)}function az(){return cr(Date.now())}function P8(n,e){O(2,arguments);var t=q(n),i=ue(e);return isNaN(i)?new Date(NaN):(i&&t.setDate(t.getDate()+i),t)}function H8(n,e){O(2,arguments);var t=q(n),i=ue(e);if(isNaN(i))return new Date(NaN);if(!i)return t;var r=t.getDate(),s=new Date(t.getTime());s.setMonth(t.getMonth()+i+1,0);var o=s.getDate();return r>=o?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}function B8(n,e){var t,i,r,s,o,a,c,l;O(1,arguments);var u=on(),h=ue((t=(i=(r=(s=e?.weekStartsOn)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&r!==void 0?r:u.weekStartsOn)!==null&&i!==void 0?i:(c=u.locale)===null||c===void 0||(l=c.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&t!==void 0?t:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=q(n),g=d.getDay(),_=(g<h?7:0)+g-h;return d.setDate(d.getDate()-_),d.setHours(0,0,0,0),d}function Ys(n){return O(1,arguments),B8(n,{weekStartsOn:1})}function cm(n){O(1,arguments);var e=q(n),t=e.getFullYear(),i=new Date(0);i.setFullYear(t+1,0,4),i.setHours(0,0,0,0);var r=Ys(i),s=new Date(0);s.setFullYear(t,0,4),s.setHours(0,0,0,0);var o=Ys(s);return e.getTime()>=r.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function lm(n){O(1,arguments);var e=cm(n),t=new Date(0);t.setFullYear(e,0,4),t.setHours(0,0,0,0);var i=Ys(t);return i}var IY=864e5;function cz(n,e){O(2,arguments);var t=cr(n),i=cr(e),r=t.getTime()-Gs(t),s=i.getTime()-Gs(i);return Math.round((r-s)/IY)}var AY=6e4;function lz(n,e){O(2,arguments);var t=ue(e);return sc(n,t*AY)}function uz(n,e){O(2,arguments);var t=ue(e);return H8(n,t*12)}var DY=365.2425,kY=Math.pow(10,8)*24*60*60*1e3,F8=6e4,q8=36e5,hz=1e3,bae=-kY;var RY=3600;var dz=RY*24,_ae=dz*7,LY=dz*DY,VY=LY/12,Cae=VY*3;function U8(n,e){O(2,arguments);var t=cr(n),i=cr(e);return t.getTime()===i.getTime()}function fz(n,e){O(2,arguments);var t=q(n),i=q(e),r=t.getFullYear()-i.getFullYear(),s=t.getMonth()-i.getMonth();return r*12+s}function dc(n){O(1,arguments);var e=q(n),t=Math.floor(e.getMonth()/3)+1;return t}function mz(n,e){O(2,arguments);var t=q(n),i=q(e),r=t.getFullYear()-i.getFullYear(),s=dc(t)-dc(i);return r*4+s}function pz(n,e){O(2,arguments);var t=q(n),i=q(e);return t.getFullYear()-i.getFullYear()}function X1(n,e){return O(2,arguments),q(n).getTime()-q(e).getTime()}var gz={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},NY="trunc";function Za(n){return n?gz[n]:gz[NY]}function vz(n,e,t){O(2,arguments);var i=X1(n,e)/q8;return Za(t?.roundingMethod)(i)}function yz(n,e,t){O(2,arguments);var i=X1(n,e)/F8;return Za(t?.roundingMethod)(i)}function um(n){O(1,arguments);var e=q(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function wz(n){O(1,arguments);var e=q(n);return rc(e).getTime()===um(e).getTime()}function bz(n,e,t){O(2,arguments);var i=X1(n,e)/1e3;return Za(t?.roundingMethod)(i)}function j8(n){O(1,arguments);var e=q(n);return e.setSeconds(0,0),e}function fc(n){O(1,arguments);var e=q(n),t=e.getMonth(),i=t-t%3;return e.setMonth(i,1),e.setHours(0,0,0,0),e}function _z(n){O(1,arguments);var e=q(n);return e.setDate(1),e.setHours(0,0,0,0),e}function hm(n,e){if(n==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n}function dm(n){O(1,arguments);var e=q(n),t=e.getFullYear(),i=e.getMonth(),r=new Date(0);return r.setFullYear(t,i+1,0),r.setHours(0,0,0,0),r.getDate()}var PY=6048e5;function Cz(n){O(1,arguments);var e=q(n),t=Ys(e).getTime()-lm(e).getTime();return Math.round(t/PY)+1}function Sz(n){return O(1,arguments),q(n).getDate()===1}function fm(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function Tz(n,e){if(n){if(typeof n=="string")return fm(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?fm(n,e):void 0}}function mm(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Tz(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var i=0,r=function(){};return{s:r,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){t=t.call(n)},n:function(){var l=t.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||t.return==null||t.return()}finally{if(a)throw s}}}}function H(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function W8(n,e){return W8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},W8(n,e)}function J(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&W8(n,e)}function mc(n){return mc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mc(n)}function pm(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pm=function(){return!!n})()}function Ez(n,e){if(e&&(pn(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H(n)}function ee(n){var e=pm();return function(){var t,i=mc(n);if(e){var r=mc(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return Ez(this,t)}}function Q(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Mz(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,o8(i.key),i)}}function X(n,e,t){return e&&Mz(n.prototype,e),t&&Mz(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}var HY=10,zz=function(){function n(){Q(this,n),A(this,"priority",void 0),A(this,"subPriority",0)}return X(n,[{key:"validate",value:function(t,i){return!0}}]),n}(),xz=function(n){J(t,n);var e=ee(t);function t(i,r,s,o,a){var c;return Q(this,t),c=e.call(this),c.value=i,c.validateValue=r,c.setValue=s,c.priority=o,a&&(c.subPriority=a),c}return X(t,[{key:"validate",value:function(r,s){return this.validateValue(r,this.value,s)}},{key:"set",value:function(r,s,o){return this.setValue(r,s,this.value,o)}}]),t}(zz),Oz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",HY),A(H(i),"subPriority",-1),i}return X(t,[{key:"set",value:function(r,s){if(s.timestampIsSet)return r;var o=new Date(0);return o.setFullYear(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()),o.setHours(r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()),o}}]),t}(zz);var ie=function(){function n(){Q(this,n),A(this,"incompatibleTokens",void 0),A(this,"priority",void 0),A(this,"subPriority",void 0)}return X(n,[{key:"run",value:function(t,i,r,s){var o=this.parse(t,i,r,s);return o?{setter:new xz(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(t,i,r){return!0}}]),n}();var Iz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",140),A(H(i),"incompatibleTokens",["R","u","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"G":case"GG":case"GGG":return o.era(r,{width:"abbreviated"})||o.era(r,{width:"narrow"});case"GGGGG":return o.era(r,{width:"narrow"});case"GGGG":default:return o.era(r,{width:"wide"})||o.era(r,{width:"abbreviated"})||o.era(r,{width:"narrow"})}}},{key:"set",value:function(r,s,o){return s.era=o,r.setUTCFullYear(o,0,1),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var xe={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},ci={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Ue(n,e){return n&&{value:e(n.value),rest:n.rest}}function Te(n,e){var t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function li(n,e){var t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};var i=t[1]==="+"?1:-1,r=t[2]?parseInt(t[2],10):0,s=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:i*(r*q8+s*F8+o*hz),rest:e.slice(t[0].length)}}function $8(n){return Te(xe.anyDigitsSigned,n)}function ge(n,e){switch(n){case 1:return Te(xe.singleDigit,e);case 2:return Te(xe.twoDigits,e);case 3:return Te(xe.threeDigits,e);case 4:return Te(xe.fourDigits,e);default:return Te(new RegExp("^\\d{1,"+n+"}"),e)}}function Ja(n,e){switch(n){case 1:return Te(xe.singleDigitSigned,e);case 2:return Te(xe.twoDigitsSigned,e);case 3:return Te(xe.threeDigitsSigned,e);case 4:return Te(xe.fourDigitsSigned,e);default:return Te(new RegExp("^-?\\d{1,"+n+"}"),e)}}function e4(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function G8(n,e){var t=e>0,i=t?e:1-e,r;if(i<=50)r=n||100;else{var s=i+50,o=Math.floor(s/100)*100,a=n>=s%100;r=n+o-(a?100:0)}return t?r:1-r}function Y8(n){return n%400===0||n%4===0&&n%100!==0}var Az=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",130),A(H(i),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){var a=function(l){return{year:l,isTwoDigitYear:s==="yy"}};switch(s){case"y":return Ue(ge(4,r),a);case"yo":return Ue(o.ordinalNumber(r,{unit:"year"}),a);default:return Ue(ge(s.length,r),a)}}},{key:"validate",value:function(r,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(r,s,o){var a=r.getUTCFullYear();if(o.isTwoDigitYear){var c=G8(o.year,a);return r.setUTCFullYear(c,0,1),r.setUTCHours(0,0,0,0),r}var l=!("era"in s)||s.era===1?o.year:1-o.year;return r.setUTCFullYear(l,0,1),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var Dz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",130),A(H(i),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){var a=function(l){return{year:l,isTwoDigitYear:s==="YY"}};switch(s){case"Y":return Ue(ge(4,r),a);case"Yo":return Ue(o.ordinalNumber(r,{unit:"year"}),a);default:return Ue(ge(s.length,r),a)}}},{key:"validate",value:function(r,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(r,s,o,a){var c=G1(r,a);if(o.isTwoDigitYear){var l=G8(o.year,c);return r.setUTCFullYear(l,0,a.firstWeekContainsDate),r.setUTCHours(0,0,0,0),Fn(r,a)}var u=!("era"in s)||s.era===1?o.year:1-o.year;return r.setUTCFullYear(u,0,a.firstWeekContainsDate),r.setUTCHours(0,0,0,0),Fn(r,a)}}]),t}(ie);var kz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",130),A(H(i),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s){return s==="R"?Ja(4,r):Ja(s.length,r)}},{key:"set",value:function(r,s,o){var a=new Date(0);return a.setUTCFullYear(o,0,4),a.setUTCHours(0,0,0,0),ai(a)}}]),t}(ie);var Rz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",130),A(H(i),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s){return s==="u"?Ja(4,r):Ja(s.length,r)}},{key:"set",value:function(r,s,o){return r.setUTCFullYear(o,0,1),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var Lz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",120),A(H(i),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"Q":case"QQ":return ge(s.length,r);case"Qo":return o.ordinalNumber(r,{unit:"quarter"});case"QQQ":return o.quarter(r,{width:"abbreviated",context:"formatting"})||o.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(r,{width:"wide",context:"formatting"})||o.quarter(r,{width:"abbreviated",context:"formatting"})||o.quarter(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=1&&s<=4}},{key:"set",value:function(r,s,o){return r.setUTCMonth((o-1)*3,1),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var Vz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",120),A(H(i),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"q":case"qq":return ge(s.length,r);case"qo":return o.ordinalNumber(r,{unit:"quarter"});case"qqq":return o.quarter(r,{width:"abbreviated",context:"standalone"})||o.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(r,{width:"wide",context:"standalone"})||o.quarter(r,{width:"abbreviated",context:"standalone"})||o.quarter(r,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(r,s){return s>=1&&s<=4}},{key:"set",value:function(r,s,o){return r.setUTCMonth((o-1)*3,1),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var Nz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),A(H(i),"priority",110),i}return X(t,[{key:"parse",value:function(r,s,o){var a=function(l){return l-1};switch(s){case"M":return Ue(Te(xe.month,r),a);case"MM":return Ue(ge(2,r),a);case"Mo":return Ue(o.ordinalNumber(r,{unit:"month"}),a);case"MMM":return o.month(r,{width:"abbreviated",context:"formatting"})||o.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return o.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(r,{width:"wide",context:"formatting"})||o.month(r,{width:"abbreviated",context:"formatting"})||o.month(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=11}},{key:"set",value:function(r,s,o){return r.setUTCMonth(o,1),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var Pz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",110),A(H(i),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){var a=function(l){return l-1};switch(s){case"L":return Ue(Te(xe.month,r),a);case"LL":return Ue(ge(2,r),a);case"Lo":return Ue(o.ordinalNumber(r,{unit:"month"}),a);case"LLL":return o.month(r,{width:"abbreviated",context:"standalone"})||o.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return o.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(r,{width:"wide",context:"standalone"})||o.month(r,{width:"abbreviated",context:"standalone"})||o.month(r,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=11}},{key:"set",value:function(r,s,o){return r.setUTCMonth(o,1),r.setUTCHours(0,0,0,0),r}}]),t}(ie);function gm(n,e,t){O(2,arguments);var i=q(n),r=ue(e),s=lc(i,t)-r;return i.setUTCDate(i.getUTCDate()-s*7),i}var Hz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",100),A(H(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"w":return Te(xe.week,r);case"wo":return o.ordinalNumber(r,{unit:"week"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=53}},{key:"set",value:function(r,s,o,a){return Fn(gm(r,o,a),a)}}]),t}(ie);function vm(n,e){O(2,arguments);var t=q(n),i=ue(e),r=cc(t)-i;return t.setUTCDate(t.getUTCDate()-r*7),t}var Bz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",100),A(H(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"I":return Te(xe.week,r);case"Io":return o.ordinalNumber(r,{unit:"week"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=53}},{key:"set",value:function(r,s,o){return ai(vm(r,o))}}]),t}(ie);var BY=[31,28,31,30,31,30,31,31,30,31,30,31],FY=[31,29,31,30,31,30,31,31,30,31,30,31],Fz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",90),A(H(i),"subPriority",1),A(H(i),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"d":return Te(xe.date,r);case"do":return o.ordinalNumber(r,{unit:"date"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){var o=r.getUTCFullYear(),a=Y8(o),c=r.getUTCMonth();return a?s>=1&&s<=FY[c]:s>=1&&s<=BY[c]}},{key:"set",value:function(r,s,o){return r.setUTCDate(o),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var qz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",90),A(H(i),"subpriority",1),A(H(i),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"D":case"DD":return Te(xe.dayOfYear,r);case"Do":return o.ordinalNumber(r,{unit:"date"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){var o=r.getUTCFullYear(),a=Y8(o);return a?s>=1&&s<=366:s>=1&&s<=365}},{key:"set",value:function(r,s,o){return r.setUTCMonth(0,o),r.setUTCHours(0,0,0,0),r}}]),t}(ie);function Z1(n,e,t){var i,r,s,o,a,c,l,u;O(2,arguments);var h=on(),d=ue((i=(r=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(a=t.locale)===null||a===void 0||(c=a.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&s!==void 0?s:h.weekStartsOn)!==null&&r!==void 0?r:(l=h.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&i!==void 0?i:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=q(n),_=ue(e),T=g.getUTCDay(),E=_%7,L=(E+7)%7,x=(L<d?7:0)+_-T;return g.setUTCDate(g.getUTCDate()+x),g}var Uz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",90),A(H(i),"incompatibleTokens",["D","i","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"E":case"EE":case"EEE":return o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(r,{width:"wide",context:"formatting"})||o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=6}},{key:"set",value:function(r,s,o,a){return r=Z1(r,o,a),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var jz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",90),A(H(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o,a){var c=function(u){var h=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+h};switch(s){case"e":case"ee":return Ue(ge(s.length,r),c);case"eo":return Ue(o.ordinalNumber(r,{unit:"day"}),c);case"eee":return o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"eeeee":return o.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return o.day(r,{width:"wide",context:"formatting"})||o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=6}},{key:"set",value:function(r,s,o,a){return r=Z1(r,o,a),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var Wz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",90),A(H(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o,a){var c=function(u){var h=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+h};switch(s){case"c":case"cc":return Ue(ge(s.length,r),c);case"co":return Ue(o.ordinalNumber(r,{unit:"day"}),c);case"ccc":return o.day(r,{width:"abbreviated",context:"standalone"})||o.day(r,{width:"short",context:"standalone"})||o.day(r,{width:"narrow",context:"standalone"});case"ccccc":return o.day(r,{width:"narrow",context:"standalone"});case"cccccc":return o.day(r,{width:"short",context:"standalone"})||o.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return o.day(r,{width:"wide",context:"standalone"})||o.day(r,{width:"abbreviated",context:"standalone"})||o.day(r,{width:"short",context:"standalone"})||o.day(r,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=6}},{key:"set",value:function(r,s,o,a){return r=Z1(r,o,a),r.setUTCHours(0,0,0,0),r}}]),t}(ie);function ym(n,e){O(2,arguments);var t=ue(e);t%7===0&&(t=t-7);var i=1,r=q(n),s=r.getUTCDay(),o=t%7,a=(o+7)%7,c=(a<i?7:0)+t-s;return r.setUTCDate(r.getUTCDate()+c),r}var $z=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",90),A(H(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){var a=function(l){return l===0?7:l};switch(s){case"i":case"ii":return ge(s.length,r);case"io":return o.ordinalNumber(r,{unit:"day"});case"iii":return Ue(o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"}),a);case"iiiii":return Ue(o.day(r,{width:"narrow",context:"formatting"}),a);case"iiiiii":return Ue(o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"}),a);case"iiii":default:return Ue(o.day(r,{width:"wide",context:"formatting"})||o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"}),a)}}},{key:"validate",value:function(r,s){return s>=1&&s<=7}},{key:"set",value:function(r,s,o){return r=ym(r,o),r.setUTCHours(0,0,0,0),r}}]),t}(ie);var Gz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",80),A(H(i),"incompatibleTokens",["b","B","H","k","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"a":case"aa":case"aaa":return o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(r,{width:"wide",context:"formatting"})||o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(r,s,o){return r.setUTCHours(e4(o),0,0,0),r}}]),t}(ie);var Yz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",80),A(H(i),"incompatibleTokens",["a","B","H","k","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"b":case"bb":case"bbb":return o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(r,{width:"wide",context:"formatting"})||o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(r,s,o){return r.setUTCHours(e4(o),0,0,0),r}}]),t}(ie);var Kz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",80),A(H(i),"incompatibleTokens",["a","b","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"B":case"BB":case"BBB":return o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(r,{width:"wide",context:"formatting"})||o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(r,s,o){return r.setUTCHours(e4(o),0,0,0),r}}]),t}(ie);var Qz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",70),A(H(i),"incompatibleTokens",["H","K","k","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"h":return Te(xe.hour12h,r);case"ho":return o.ordinalNumber(r,{unit:"hour"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=12}},{key:"set",value:function(r,s,o){var a=r.getUTCHours()>=12;return a&&o<12?r.setUTCHours(o+12,0,0,0):!a&&o===12?r.setUTCHours(0,0,0,0):r.setUTCHours(o,0,0,0),r}}]),t}(ie);var Xz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",70),A(H(i),"incompatibleTokens",["a","b","h","K","k","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"H":return Te(xe.hour23h,r);case"Ho":return o.ordinalNumber(r,{unit:"hour"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=23}},{key:"set",value:function(r,s,o){return r.setUTCHours(o,0,0,0),r}}]),t}(ie);var Zz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",70),A(H(i),"incompatibleTokens",["h","H","k","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"K":return Te(xe.hour11h,r);case"Ko":return o.ordinalNumber(r,{unit:"hour"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=11}},{key:"set",value:function(r,s,o){var a=r.getUTCHours()>=12;return a&&o<12?r.setUTCHours(o+12,0,0,0):r.setUTCHours(o,0,0,0),r}}]),t}(ie);var Jz=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",70),A(H(i),"incompatibleTokens",["a","b","h","H","K","t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"k":return Te(xe.hour24h,r);case"ko":return o.ordinalNumber(r,{unit:"hour"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=24}},{key:"set",value:function(r,s,o){var a=o<=24?o%24:o;return r.setUTCHours(a,0,0,0),r}}]),t}(ie);var ex=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",60),A(H(i),"incompatibleTokens",["t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"m":return Te(xe.minute,r);case"mo":return o.ordinalNumber(r,{unit:"minute"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=59}},{key:"set",value:function(r,s,o){return r.setUTCMinutes(o,0,0),r}}]),t}(ie);var tx=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",50),A(H(i),"incompatibleTokens",["t","T"]),i}return X(t,[{key:"parse",value:function(r,s,o){switch(s){case"s":return Te(xe.second,r);case"so":return o.ordinalNumber(r,{unit:"second"});default:return ge(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=59}},{key:"set",value:function(r,s,o){return r.setUTCSeconds(o,0),r}}]),t}(ie);var nx=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",30),A(H(i),"incompatibleTokens",["t","T"]),i}return X(t,[{key:"parse",value:function(r,s){var o=function(c){return Math.floor(c*Math.pow(10,-s.length+3))};return Ue(ge(s.length,r),o)}},{key:"set",value:function(r,s,o){return r.setUTCMilliseconds(o),r}}]),t}(ie);var ix=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",10),A(H(i),"incompatibleTokens",["t","T","x"]),i}return X(t,[{key:"parse",value:function(r,s){switch(s){case"X":return li(ci.basicOptionalMinutes,r);case"XX":return li(ci.basic,r);case"XXXX":return li(ci.basicOptionalSeconds,r);case"XXXXX":return li(ci.extendedOptionalSeconds,r);case"XXX":default:return li(ci.extended,r)}}},{key:"set",value:function(r,s,o){return s.timestampIsSet?r:new Date(r.getTime()-o)}}]),t}(ie);var rx=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",10),A(H(i),"incompatibleTokens",["t","T","X"]),i}return X(t,[{key:"parse",value:function(r,s){switch(s){case"x":return li(ci.basicOptionalMinutes,r);case"xx":return li(ci.basic,r);case"xxxx":return li(ci.basicOptionalSeconds,r);case"xxxxx":return li(ci.extendedOptionalSeconds,r);case"xxx":default:return li(ci.extended,r)}}},{key:"set",value:function(r,s,o){return s.timestampIsSet?r:new Date(r.getTime()-o)}}]),t}(ie);var sx=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",40),A(H(i),"incompatibleTokens","*"),i}return X(t,[{key:"parse",value:function(r){return $8(r)}},{key:"set",value:function(r,s,o){return[new Date(o*1e3),{timestampIsSet:!0}]}}]),t}(ie);var ox=function(n){J(t,n);var e=ee(t);function t(){var i;Q(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),A(H(i),"priority",20),A(H(i),"incompatibleTokens","*"),i}return X(t,[{key:"parse",value:function(r){return $8(r)}},{key:"set",value:function(r,s,o){return[new Date(o),{timestampIsSet:!0}]}}]),t}(ie);var ax={G:new Iz,y:new Az,Y:new Dz,R:new kz,u:new Rz,Q:new Lz,q:new Vz,M:new Nz,L:new Pz,w:new Hz,I:new Bz,d:new Fz,D:new qz,E:new Uz,e:new jz,c:new Wz,i:new $z,a:new Gz,b:new Yz,B:new Kz,h:new Qz,H:new Xz,K:new Zz,k:new Jz,m:new ex,s:new tx,S:new nx,X:new ix,x:new rx,t:new sx,T:new ox};var qY=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,UY=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,jY=/^'([^]*?)'?$/,WY=/''/g,$Y=/\S/,GY=/[a-zA-Z]/;function cx(n,e,t,i){var r,s,o,a,c,l,u,h,d,g,_,T,E,L,x,V,P,G;O(3,arguments);var K=String(n),w=String(e),v=on(),y=(r=(s=i?.locale)!==null&&s!==void 0?s:v.locale)!==null&&r!==void 0?r:N8;if(!y.match)throw new RangeError("locale must contain match property");var b=ue((o=(a=(c=(l=i?.firstWeekContainsDate)!==null&&l!==void 0?l:i==null||(u=i.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&c!==void 0?c:v.firstWeekContainsDate)!==null&&a!==void 0?a:(d=v.locale)===null||d===void 0||(g=d.options)===null||g===void 0?void 0:g.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(b>=1&&b<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var m=ue((_=(T=(E=(L=i?.weekStartsOn)!==null&&L!==void 0?L:i==null||(x=i.locale)===null||x===void 0||(V=x.options)===null||V===void 0?void 0:V.weekStartsOn)!==null&&E!==void 0?E:v.weekStartsOn)!==null&&T!==void 0?T:(P=v.locale)===null||P===void 0||(G=P.options)===null||G===void 0?void 0:G.weekStartsOn)!==null&&_!==void 0?_:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(w==="")return K===""?q(t):new Date(NaN);var C={firstWeekContainsDate:b,weekStartsOn:m,locale:y},f=[new Oz],p=w.match(UY).map(function(Ce){var I=Ce[0];if(I in uc){var R=uc[I];return R(Ce,y.formatLong)}return Ce}).join("").match(qY),F=[],le=mm(p),Ae;try{var Ne=function(){var I=Ae.value;!(i!=null&&i.useAdditionalWeekYearTokens)&&V8(I)&&Xa(I,w,n),!(i!=null&&i.useAdditionalDayOfYearTokens)&&L8(I)&&Xa(I,w,n);var R=I[0],U=ax[R];if(U){var re=U.incompatibleTokens;if(Array.isArray(re)){var te=F.find(function(Xe){return re.includes(Xe.token)||Xe.token===R});if(te)throw new RangeError("The format string mustn't contain `".concat(te.fullToken,"` and `").concat(I,"` at the same time"))}else if(U.incompatibleTokens==="*"&&F.length>0)throw new RangeError("The format string mustn't contain `".concat(I,"` and any other token at the same time"));F.push({token:R,fullToken:I});var he=U.run(K,I,y.match,C);if(!he)return{v:new Date(NaN)};f.push(he.setter),K=he.rest}else{if(R.match(GY))throw new RangeError("Format string contains an unescaped latin alphabet character `"+R+"`");if(I==="''"?I="'":R==="'"&&(I=YY(I)),K.indexOf(I)===0)K=K.slice(I.length);else return{v:new Date(NaN)}}};for(le.s();!(Ae=le.n()).done;){var ot=Ne();if(pn(ot)==="object")return ot.v}}catch(Ce){le.e(Ce)}finally{le.f()}if(K.length>0&&$Y.test(K))return new Date(NaN);var je=f.map(function(Ce){return Ce.priority}).sort(function(Ce,I){return I-Ce}).filter(function(Ce,I,R){return R.indexOf(Ce)===I}).map(function(Ce){return f.filter(function(I){return I.priority===Ce}).sort(function(I,R){return R.subPriority-I.subPriority})}).map(function(Ce){return Ce[0]}),Vt=q(t);if(isNaN(Vt.getTime()))return new Date(NaN);var Qe=oc(Vt,Gs(Vt)),nt={},vt=mm(je),ht;try{for(vt.s();!(ht=vt.n()).done;){var Ft=ht.value;if(!Ft.validate(Qe,C))return new Date(NaN);var ui=Ft.set(Qe,nt,C);Array.isArray(ui)?(Qe=ui[0],hm(nt,ui[1])):Qe=ui}}catch(Ce){vt.e(Ce)}finally{vt.f()}return Qe}function YY(n){return n.match(jY)[1].replace(WY,"'")}function K8(n){O(1,arguments);var e=q(n);return e.setMinutes(0,0,0),e}function lx(n,e){O(2,arguments);var t=K8(n),i=K8(e);return t.getTime()===i.getTime()}function ux(n,e){O(2,arguments);var t=j8(n),i=j8(e);return t.getTime()===i.getTime()}function hx(n,e){O(2,arguments);var t=q(n),i=q(e);return t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()}function dx(n,e){O(2,arguments);var t=fc(n),i=fc(e);return t.getTime()===i.getTime()}function Q8(n){O(1,arguments);var e=q(n);return e.setMilliseconds(0),e}function fx(n,e){O(2,arguments);var t=Q8(n),i=Q8(e);return t.getTime()===i.getTime()}function mx(n,e){O(2,arguments);var t=q(n),i=q(e);return t.getFullYear()===i.getFullYear()}function px(n){return O(1,arguments),U8(n,Date.now())}function X8(n,e){O(2,arguments);var t=q(n),i=ue(e),r=t.getFullYear(),s=t.getDate(),o=new Date(0);o.setFullYear(r,i,15),o.setHours(0,0,0,0);var a=dm(o);return t.setMonth(i,Math.min(s,a)),t}function gx(n,e,t){var i,r,s,o,a,c,l,u;O(2,arguments);var h=on(),d=ue((i=(r=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(a=t.locale)===null||a===void 0||(c=a.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&s!==void 0?s:h.weekStartsOn)!==null&&r!==void 0?r:(l=h.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&i!==void 0?i:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=q(n),_=ue(e),T=g.getDay(),E=_%7,L=(E+7)%7,x=7-d,V=_<0||_>6?_-(T+x)%7:(L+x)%7-(T+x)%7;return P8(g,V)}function vx(n,e){O(2,arguments);var t=q(n),i=ue(e),r=Math.floor(t.getMonth()/3)+1,s=i-r;return X8(t,t.getMonth()+s*3)}function yx(n,e){O(2,arguments);var t=q(n),i=ue(e);return isNaN(t.getTime())?new Date(NaN):(t.setFullYear(i),t)}var Phe=(()=>{class n{setHiddenAttribute(){this.hidden?typeof this.hidden=="string"?this.renderer.setAttribute(this.elementRef.nativeElement,"hidden",this.hidden):this.renderer.setAttribute(this.elementRef.nativeElement,"hidden",""):this.renderer.removeAttribute(this.elementRef.nativeElement,"hidden")}constructor(t,i){this.elementRef=t,this.renderer=i,this.hidden=null,this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","")}ngOnChanges(){this.setHiddenAttribute()}ngAfterViewInit(){this.setHiddenAttribute()}static{this.\u0275fac=function(i){return new(i||n)($($e),$(Br))}}static{this.\u0275dir=We({type:n,selectors:[["","nz-button",""],["nz-button-group"],["","nz-icon",""],["","nz-menu-item",""],["","nz-submenu",""],["nz-select-top-control"],["nz-select-placeholder"],["nz-input-group"]],inputs:{hidden:"hidden"},standalone:!0,features:[wn]})}}return n})(),wx=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({})}}return n})();var wm=class{get waveAttributeName(){return this.insertExtraNode?"ant-click-animating":"ant-click-animating-without-extra-node"}constructor(e,t,i,r,s){this.triggerElement=e,this.ngZone=t,this.insertExtraNode=i,this.platformId=r,this.cspNonce=s,this.waveTransitionDuration=400,this.styleForPseudo=null,this.extraNode=null,this.lastTime=0,this.onClick=o=>{!this.triggerElement||!this.triggerElement.getAttribute||this.triggerElement.getAttribute("disabled")||o.target.tagName==="INPUT"||this.triggerElement.className.indexOf("disabled")>=0||this.fadeOutWave()},this.platform=new gn(this.platformId),this.clickHandler=this.onClick.bind(this),this.bindTriggerEvent()}bindTriggerEvent(){this.platform.isBrowser&&this.ngZone.runOutsideAngular(()=>{this.removeTriggerEvent(),this.triggerElement&&this.triggerElement.addEventListener("click",this.clickHandler,!0)})}removeTriggerEvent(){this.triggerElement&&this.triggerElement.removeEventListener("click",this.clickHandler,!0)}removeStyleAndExtraNode(){this.styleForPseudo&&document.body.contains(this.styleForPseudo)&&(document.body.removeChild(this.styleForPseudo),this.styleForPseudo=null),this.insertExtraNode&&this.triggerElement.contains(this.extraNode)&&this.triggerElement.removeChild(this.extraNode)}destroy(){this.removeTriggerEvent(),this.removeStyleAndExtraNode()}fadeOutWave(){let e=this.triggerElement,t=this.getWaveColor(e);e.setAttribute(this.waveAttributeName,"true"),!(Date.now()<this.lastTime+this.waveTransitionDuration)&&(this.isValidColor(t)&&(this.styleForPseudo||(this.styleForPseudo=document.createElement("style"),this.cspNonce&&(this.styleForPseudo.nonce=this.cspNonce)),this.styleForPseudo.innerHTML=`
      [ant-click-animating-without-extra-node='true']::after, .ant-click-animating-node {
        --antd-wave-shadow-color: ${t};
      }`,document.body.appendChild(this.styleForPseudo)),this.insertExtraNode&&(this.extraNode||(this.extraNode=document.createElement("div")),this.extraNode.className="ant-click-animating-node",e.appendChild(this.extraNode)),this.lastTime=Date.now(),this.runTimeoutOutsideZone(()=>{e.removeAttribute(this.waveAttributeName),this.removeStyleAndExtraNode()},this.waveTransitionDuration))}isValidColor(e){return!!e&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&this.isNotGrey(e)&&!/rgba\(\d*, \d*, \d*, 0\)/.test(e)&&e!=="transparent"}isNotGrey(e){let t=e.match(/rgba?\((\d*), (\d*), (\d*)(, [\.\d]*)?\)/);return t&&t[1]&&t[2]&&t[3]?!(t[1]===t[2]&&t[2]===t[3]):!0}getWaveColor(e){let t=getComputedStyle(e);return t.getPropertyValue("border-top-color")||t.getPropertyValue("border-color")||t.getPropertyValue("background-color")}runTimeoutOutsideZone(e,t){this.ngZone.runOutsideAngular(()=>setTimeout(e,t))}},KY={disabled:!1},bx=new Ee("nz-wave-global-options");function QY(n){return i4([{provide:bx,useValue:n}])}var $he=(()=>{class n{get disabled(){return this.waveDisabled}get rendererRef(){return this.waveRenderer}constructor(t,i){this.ngZone=t,this.elementRef=i,this.nzWaveExtraNode=!1,this.waveDisabled=!1,this.cspNonce=Ze(ro,{optional:!0}),this.platformId=Ze(Ri),this.config=Ze(bx,{optional:!0}),this.animationType=Ze(io,{optional:!0}),this.waveDisabled=this.isConfigDisabled()}isConfigDisabled(){let t=!1;return this.config&&typeof this.config.disabled=="boolean"&&(t=this.config.disabled),this.animationType==="NoopAnimations"&&(t=!0),t}ngOnDestroy(){this.waveRenderer&&this.waveRenderer.destroy()}ngOnInit(){this.renderWaveIfEnabled()}renderWaveIfEnabled(){!this.waveDisabled&&this.elementRef.nativeElement&&(this.waveRenderer=new wm(this.elementRef.nativeElement,this.ngZone,this.nzWaveExtraNode,this.platformId,this.cspNonce))}disable(){this.waveDisabled=!0,this.waveRenderer&&(this.waveRenderer.removeTriggerEvent(),this.waveRenderer.removeStyleAndExtraNode())}enable(){this.waveDisabled=this.isConfigDisabled()||!1,this.waveRenderer&&this.waveRenderer.bindTriggerEvent()}static{this.\u0275fac=function(i){return new(i||n)($(Se),$($e))}}static{this.\u0275dir=We({type:n,selectors:[["","nz-wave",""],["button","nz-button","",3,"nzType","link",3,"nzType","text"]],inputs:{nzWaveExtraNode:"nzWaveExtraNode"},exportAs:["nzWave"],standalone:!0})}}return n})(),_x=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({providers:[QY(KY)]})}}return n})();var XY=["nz-button",""],Sx=["*"];function ZY(n,e){n&1&&It(0,"span",0)}var Cx="button",JY=(()=>{class n{insertSpan(t,i){t.forEach(r=>{if(r.nodeName==="#text"){let s=i.createElement("span"),o=i.parentNode(r);i.insertBefore(o,s,r),i.appendChild(s,r)}})}get iconOnly(){let t=Array.from(this.elementRef?.nativeElement?.childNodes||[]),i=t.every(s=>s.nodeName!=="#text"),r=t.filter(s=>!(s.nodeName==="#comment"||s?.attributes?.getNamedItem("nz-icon"))).length==0;return!!this.nzIconDirectiveElement&&r&&i}constructor(t,i,r,s,o,a){this.ngZone=t,this.elementRef=i,this.cdr=r,this.renderer=s,this.nzConfigService=o,this.directionality=a,this._nzModuleName=Cx,this.nzBlock=!1,this.nzGhost=!1,this.nzSearch=!1,this.nzLoading=!1,this.nzDanger=!1,this.disabled=!1,this.tabIndex=null,this.nzType=null,this.nzShape=null,this.nzSize="default",this.dir="ltr",this.destroy$=new ce,this.loading$=new ce,this.nzConfigService.getConfigChangeEventForComponent(Cx).pipe(it(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe(it(this.destroy$)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value,this.ngZone.runOutsideAngular(()=>{t4(this.elementRef.nativeElement,"click",{capture:!0}).pipe(it(this.destroy$)).subscribe(t=>{(this.disabled&&t.target?.tagName==="A"||this.nzLoading)&&(t.preventDefault(),t.stopImmediatePropagation())})})}ngOnChanges(t){let{nzLoading:i}=t;i&&this.loading$.next(this.nzLoading)}ngAfterViewInit(){this.insertSpan(this.elementRef.nativeElement.childNodes,this.renderer)}ngAfterContentInit(){this.loading$.pipe(yn(this.nzLoading),qt(()=>!!this.nzIconDirectiveElement),it(this.destroy$)).subscribe(t=>{let i=this.nzIconDirectiveElement.nativeElement;t?this.renderer.setStyle(i,"display","none"):this.renderer.removeStyle(i,"display")})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(i){return new(i||n)($(Se),$($e),$(Cn),$(Br),$(Vr),$(ar))}}static{this.\u0275cmp=di({type:n,selectors:[["button","nz-button",""],["a","nz-button",""]],contentQueries:function(i,r,s){if(i&1&&Hm(s,Ws,5,$e),i&2){let o;Tc(o=Ec())&&(r.nzIconDirectiveElement=o.first)}},hostAttrs:[1,"ant-btn"],hostVars:34,hostBindings:function(i,r){i&2&&(rl("tabindex",r.disabled?-1:r.tabIndex===null?null:r.tabIndex)("disabled",r.disabled||null),Nt("ant-btn-default",r.nzType==="default")("ant-btn-primary",r.nzType==="primary")("ant-btn-dashed",r.nzType==="dashed")("ant-btn-link",r.nzType==="link")("ant-btn-text",r.nzType==="text")("ant-btn-circle",r.nzShape==="circle")("ant-btn-round",r.nzShape==="round")("ant-btn-lg",r.nzSize==="large")("ant-btn-sm",r.nzSize==="small")("ant-btn-dangerous",r.nzDanger)("ant-btn-loading",r.nzLoading)("ant-btn-background-ghost",r.nzGhost)("ant-btn-block",r.nzBlock)("ant-input-search-button",r.nzSearch)("ant-btn-rtl",r.dir==="rtl")("ant-btn-icon-only",r.iconOnly))},inputs:{nzBlock:[ve.HasDecoratorInputTransform,"nzBlock","nzBlock",wt],nzGhost:[ve.HasDecoratorInputTransform,"nzGhost","nzGhost",wt],nzSearch:[ve.HasDecoratorInputTransform,"nzSearch","nzSearch",wt],nzLoading:[ve.HasDecoratorInputTransform,"nzLoading","nzLoading",wt],nzDanger:[ve.HasDecoratorInputTransform,"nzDanger","nzDanger",wt],disabled:[ve.HasDecoratorInputTransform,"disabled","disabled",wt],tabIndex:"tabIndex",nzType:"nzType",nzShape:"nzShape",nzSize:"nzSize"},exportAs:["nzButton"],standalone:!0,features:[jn,wn,mi],attrs:XY,ngContentSelectors:Sx,decls:2,vars:1,consts:[["nz-icon","","nzType","loading"]],template:function(i,r){i&1&&(s4(),_n(0,ZY,1,0,"span",0),o4(1)),i&2&&dr(0,r.nzLoading?0:-1)},dependencies:[Ya,Ws],encapsulation:2,changeDetection:0})}}return Tm([hM()],n.prototype,"nzSize",void 0),n})(),c5e=(()=>{class n{constructor(t){this.directionality=t,this.nzSize="default",this.dir="ltr",this.destroy$=new ce}ngOnInit(){this.dir=this.directionality.value,this.directionality.change?.pipe(it(this.destroy$)).subscribe(t=>{this.dir=t})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(i){return new(i||n)($(ar))}}static{this.\u0275cmp=di({type:n,selectors:[["nz-button-group"]],hostAttrs:[1,"ant-btn-group"],hostVars:6,hostBindings:function(i,r){i&2&&Nt("ant-btn-group-lg",r.nzSize==="large")("ant-btn-group-sm",r.nzSize==="small")("ant-btn-group-rtl",r.dir==="rtl")},inputs:{nzSize:"nzSize"},exportAs:["nzButtonGroup"],standalone:!0,features:[mi],ngContentSelectors:Sx,decls:1,vars:0,template:function(i,r){i&1&&(s4(),o4(0))},encapsulation:2,changeDetection:0})}}return n})(),l5e=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({imports:[JY,wx,_x]})}}return n})();var y5e=(()=>{class n{constructor(){this.animationType=Ze(io,{optional:!0}),this.nzNoAnimation=!1}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=We({type:n,selectors:[["","nzNoAnimation",""]],hostVars:2,hostBindings:function(i,r){i&2&&Nt("nz-animate-disabled",r.nzNoAnimation||r.animationType==="NoopAnimations")},inputs:{nzNoAnimation:[ve.HasDecoratorInputTransform,"nzNoAnimation","nzNoAnimation",wt]},exportAs:["nzNoAnimation"],standalone:!0,features:[jn]})}}return n})();var an={top:new ut({originX:"center",originY:"top"},{overlayX:"center",overlayY:"bottom"}),topCenter:new ut({originX:"center",originY:"top"},{overlayX:"center",overlayY:"bottom"}),topLeft:new ut({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"}),topRight:new ut({originX:"end",originY:"top"},{overlayX:"end",overlayY:"bottom"}),right:new ut({originX:"end",originY:"center"},{overlayX:"start",overlayY:"center"}),rightTop:new ut({originX:"end",originY:"top"},{overlayX:"start",overlayY:"top"}),rightBottom:new ut({originX:"end",originY:"bottom"},{overlayX:"start",overlayY:"bottom"}),bottom:new ut({originX:"center",originY:"bottom"},{overlayX:"center",overlayY:"top"}),bottomCenter:new ut({originX:"center",originY:"bottom"},{overlayX:"center",overlayY:"top"}),bottomLeft:new ut({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"}),bottomRight:new ut({originX:"end",originY:"bottom"},{overlayX:"end",overlayY:"top"}),left:new ut({originX:"start",originY:"center"},{overlayX:"end",overlayY:"center"}),leftTop:new ut({originX:"start",originY:"top"},{overlayX:"end",overlayY:"top"}),leftBottom:new ut({originX:"start",originY:"bottom"},{overlayX:"end",overlayY:"bottom"})},z5e=[an.top,an.right,an.bottom,an.left],x5e=[an.bottomLeft,an.bottomRight,an.topLeft,an.topRight,an.topCenter,an.bottomCenter],O5e=[new ut({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"bottom"}),new ut({originX:"start",originY:"bottom"},{overlayX:"end",overlayY:"bottom"})],I5e=[an.bottomLeft,new ut({originX:"start",originY:"bottom"},{overlayX:"end",overlayY:"top"})];function eK(n){for(let e in an)if(n.connectionPair.originX===an[e].originX&&n.connectionPair.originY===an[e].originY&&n.connectionPair.overlayX===an[e].overlayX&&n.connectionPair.overlayY===an[e].overlayY)return e}var Z8={bottomLeft:new ut({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"},void 0,2),topLeft:new ut({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"},void 0,-2),bottomRight:new ut({originX:"end",originY:"bottom"},{overlayX:"end",overlayY:"top"},void 0,2),topRight:new ut({originX:"end",originY:"top"},{overlayX:"end",overlayY:"bottom"},void 0,-2)},A5e=[Z8.bottomLeft,Z8.topLeft,Z8.bottomRight,Z8.topRight],D5e=(()=>{class n{constructor(t,i){this.cdkConnectedOverlay=t,this.nzDestroyService=i,this.nzArrowPointAtCenter=!1,this.cdkConnectedOverlay.backdropClass="nz-overlay-transparent-backdrop",this.cdkConnectedOverlay.positionChange.pipe(it(this.nzDestroyService)).subscribe(r=>{this.nzArrowPointAtCenter&&this.updateArrowPosition(r)})}updateArrowPosition(t){let i=this.getOriginRect(),r=eK(t),s=0,o=0;r==="topLeft"||r==="bottomLeft"?s=i.width/2-14:r==="topRight"||r==="bottomRight"?s=-(i.width/2-14):r==="leftTop"||r==="rightTop"?o=i.height/2-10:(r==="leftBottom"||r==="rightBottom")&&(o=-(i.height/2-10)),(this.cdkConnectedOverlay.offsetX!==s||this.cdkConnectedOverlay.offsetY!==o)&&(this.cdkConnectedOverlay.offsetY=o,this.cdkConnectedOverlay.offsetX=s,this.cdkConnectedOverlay.overlayRef.updatePosition())}getFlexibleConnectedPositionStrategyOrigin(){return this.cdkConnectedOverlay.origin instanceof A8?this.cdkConnectedOverlay.origin.elementRef:this.cdkConnectedOverlay.origin}getOriginRect(){let t=this.getFlexibleConnectedPositionStrategyOrigin();if(t instanceof $e)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();let i=t.width||0,r=t.height||0;return{top:t.y,bottom:t.y+r,left:t.x,right:t.x+i,height:r,width:i}}static{this.\u0275fac=function(i){return new(i||n)($(FM),$(M8))}}static{this.\u0275dir=We({type:n,selectors:[["","cdkConnectedOverlay","","nzConnectedOverlay",""]],inputs:{nzArrowPointAtCenter:[ve.HasDecoratorInputTransform,"nzArrowPointAtCenter","nzArrowPointAtCenter",wt]},exportAs:["nzConnectedOverlay"],features:[qr([M8]),jn]})}}return n})(),k5e=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=be({type:n})}static{this.\u0275inj=we({})}}return n})();function R5e(n,e){e&&(n._host.style.zIndex=`${e}`)}export{F1 as a,B1 as b,J0 as c,LX as d,In as e,oT as f,Ua as g,ja as h,B2 as i,fZ as j,n8 as k,xZ as l,mt as m,O1 as n,NS as o,f9 as p,UZ as q,cte as r,lte as s,ute as t,hte as u,dte as v,fte as w,pte as x,vte as y,yte as z,S8 as A,T8 as B,jW as C,U2 as D,JW as E,e$ as F,$J as G,GJ as H,U1 as I,iM as J,tee as K,nee as L,iee as M,ree as N,see as O,oee as P,aee as Q,cee as R,lee as S,K2 as T,uee as U,hee as V,dee as W,c$ as X,fee as Y,mee as Z,gee as _,vee as $,yee as aa,wee as ba,Vr as ca,hM as da,gn as ea,Lee as fa,Vee as ga,Nee as ha,Pee as ia,w8 as ja,fM as ka,Ws as la,Ya as ma,Z2 as na,J2 as oa,_8 as pa,ste as qa,vM as ra,Tte as sa,R9 as ta,L9 as ua,Rte as va,z$ as wa,qte as xa,TM as ya,I$ as za,Ute as Aa,jte as Ba,M8 as Ca,ar as Da,ec as Ea,Cne as Fa,q9 as Ga,nc as Ha,U$ as Ia,Sne as Ja,U9 as Ka,IM as La,I8 as Ma,ut as Na,G$ as Oa,K9 as Pa,$s as Qa,A8 as Ra,FM as Sa,Une as Ta,lie as Ua,uie as Va,Oie as Wa,$M as Xa,bse as Ya,P8 as Za,H8 as _a,B8 as $a,cr as ab,cz as bb,lz as cb,uz as db,U8 as eb,R8 as fb,fz as gb,dc as hb,mz as ib,pz as jb,vz as kb,yz as lb,wz as mb,bz as nb,fc as ob,_z as pb,GM as qb,hc as rb,K1 as sb,Q1 as tb,am as ub,sz as vb,oz as wb,Cz as xb,Sz as yb,cx as zb,lx as Ab,ux as Bb,hx as Cb,dx as Db,fx as Eb,mx as Fb,px as Gb,X8 as Hb,gx as Ib,vx as Jb,yx as Kb,az as Lb,y5e as Mb,an as Nb,z5e as Ob,eK as Pb,Z8 as Qb,A5e as Rb,D5e as Sb,k5e as Tb,R5e as Ub,Phe as Vb,$he as Wb,_x as Xb,JY as Yb,c5e as Zb,l5e as _b};
