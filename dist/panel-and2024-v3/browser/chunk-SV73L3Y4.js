import{a as Yt}from"./chunk-IZGY4ZCY.js";import{a as Kt}from"./chunk-YT3IMIGE.js";import{a as si,b as li,d as pi}from"./chunk-OLSGPGU5.js";import{a as ai}from"./chunk-WS43CO36.js";import{a as ci,c as di,d as mi}from"./chunk-FE7MXYZB.js";import{a as oi}from"./chunk-IYKMBDMP.js";import{b as Gt,d as _t}from"./chunk-GBPR5CMI.js";import{a as ti,c as ii}from"./chunk-4BB6GSDP.js";import{a as ae}from"./chunk-7YOXNFTV.js";import{a as ni,b as ri}from"./chunk-BB4HN66A.js";import{a as Re,c as Zt,h as ei}from"./chunk-E7L436O2.js";import{A as Jt,B as Le,C as Oe,D as Ue,E as Ae,G as ht,a as Ee,c as mt,d as pt,g as ut,k as De,n as Pe,o as ke,w as Me,x as Xt,z as Ne}from"./chunk-MAOACS2T.js";import{$ as qt,M as at,P as ie,Q as ne,R as re,S as oe,_ as be,aa as $t,b as xe,c as C,d as G,da as lt,e as Q,ea as ct,fa as jt,h as Rt,ha as dt,i as X,ja as we,k as J,ka as Wt,m as Y,pa as pe,q as K,qa as ue,sa as Fe,t as ee,ta as Qt,u as te}from"./chunk-C5HFAHLX.js";import{d as st}from"./chunk-5Y7557TF.js";import{a as ce,c as de,d as ye,f as Te,g as Ve,h as Ie,i as Ht,j as me}from"./chunk-VGTRV4YY.js";import{$b as H,Ab as xt,Ae as Z,Bf as le,C as et,Db as L,Ea as g,Eb as Lt,Fb as O,Ga as c,Hb as y,Ka as U,Lc as Bt,M as je,O as I,Oc as ot,Pd as $,Q as W,U as tt,Ua as t,Va as r,Wa as p,X as Ft,Xa as fe,Y as T,Ya as ge,Zb as it,_ as R,_a as v,_b as q,bb as f,c as A,d as $e,db as d,dc as nt,fc as Ot,ga as u,ha as _,kb as We,lb as He,m as E,mb as Ge,mc as Ut,nb as b,ob as s,pb as x,qb as S,ra as vt,rb as N,sa as a,sb as Mt,ta as D,tb as P,tc as At,ub as k,vb as F,wc as rt,xe as Se,yb as Nt,yf as j,zb as B,zf as se}from"./chunk-KGCXXMN3.js";import{a as w,b as ve,f as Ke,h as Ze}from"./chunk-SIAVTO45.js";var ze=Ke(ct()),xi=Ke(ct());var ki=["download"],Fi=["searchBar"],Mi=i=>({open:i}),Ni=()=>[];function Li(i,m){if(i&1){let e=v();t(0,"li",49),f("click",function(){let n=u(e).$implicit,l=d();return _(l.onBulkBoardingPassSelected(n.id))}),s(1),r()}if(i&2){let e=m.$implicit;c("hidden",!e.active),a(),x(e.name)}}function Oi(i,m){if(i&1){let e=v();t(0,"li",49),f("click",function(){let n=u(e).$implicit,l=d();return _(l.onBulkCredentialsSelected(n.id))}),s(1),r()}if(i&2){let e=m.$implicit;c("hidden",!e.active),a(),x(e.name)}}function Ui(i,m){i&1&&p(0,"i",58)}function Ai(i,m){if(i&1){let e=v();t(0,"tr",50),f("click",function(){let n=u(e).$implicit,l=d();return _(l.userSelected(n))}),t(1,"td")(2,"div",51)(3,"div"),p(4,"nz-avatar",52),r(),t(5,"div",53)(6,"h6",54),g(7,Ui,1,0,"i",55),s(8),r(),fe(9),t(10,"p",56),s(11),p(12,"nz-badge",57),s(13),p(14,"br"),s(15),r(),ge(),r()()()()}if(i&2){let e=m.$implicit;a(4),c("nzSrc",e.photoURL),a(3),c("ngIf",e.disabled),a(),S(" ",e.displayName,""),a(3),S(" ",e.studentId," "),a(),c("nzStatus",e.emailVerified?"success":"error"),a(),S(" ",e.email," "),a(2),S(" ",e.customerName," ")}}function Ri(i,m){i&1&&p(0,"i",58)}function Bi(i,m){if(i&1){let e=v();t(0,"li",67),f("click",function(){u(e);let n=d(2);return _(n.setUserDisabled(!0))}),s(1,"Suspender Usuario "),r()}}function qi(i,m){if(i&1){let e=v();t(0,"li",67),f("click",function(){u(e);let n=d(2);return _(n.setUserDisabled(!1))}),s(1,"Reactivar Usuario "),r()}}function $i(i,m){if(i&1&&(t(0,"div",59),fe(1),t(2,"div",51)(3,"a",60),p(4,"i",61),r(),t(5,"div"),p(6,"nz-avatar",62),r(),t(7,"div",53)(8,"h6",54),g(9,Ri,1,0,"i",55),s(10),r(),t(11,"p",63),p(12,"nz-badge",57),t(13,"span"),s(14),r()()()(),ge(),t(15,"div")(16,"a",64),p(17,"i",65),r(),t(18,"nz-dropdown-menu",null,17)(20,"ul",29),g(21,Bi,2,0,"li",66)(22,qi,2,0,"li",66),r()()()()),i&2){let e=b(19),o=d();a(3),c("routerLink",Nt(10,Ni)),a(3),c("nzSrc",o.currentUserSelected.photoURL),a(3),c("ngIf",o.currentUserSelected.disabled),a(),S(" ",o.currentUserSelected.displayName," "),a(2),c("nzStatus",o.currentUserSelected.emailVerified?"success":"error"),a(2),S(" ",o.currentUserSelected.email," "),a(2),c("nzDropdownMenu",e)("nzTrigger","click"),a(5),c("ngIf",!o.currentUserSelected.disabled),a(),c("ngIf",o.currentUserSelected.disabled)}}function ji(i,m){i&1&&(t(0,"nz-tag",78),s(1,"Cortes\xEDa "),r()),i&2&&c("nzColor","yellow")}function Wi(i,m){i&1&&(t(0,"nz-tag",78),s(1,"Pagado "),r()),i&2&&c("nzColor","cyan")}function Hi(i,m){i&1&&(t(0,"nz-tag",78),s(1,"Pagado Parcial"),r()),i&2&&c("nzColor","red")}function Gi(i,m){i&1&&(t(0,"nz-tag",78),s(1,"Activo"),r()),i&2&&c("nzColor","cyan")}function Qi(i,m){i&1&&(t(0,"nz-tag",78),s(1,"Suspendido"),r()),i&2&&c("nzColor","red")}function Xi(i,m){if(i&1){let e=v();t(0,"tr",50),f("click",function(){let n=u(e).$implicit,l=d(3);return _(l.boardingPassSelected(n))}),t(1,"td")(2,"nz-tag",78),s(3),r(),t(4,"span",79),s(5),L(6,"date"),r()(),t(7,"td"),s(8),r(),t(9,"td"),g(10,ji,2,1,"nz-tag",80)(11,Wi,2,1,"nz-tag",80)(12,Hi,2,1,"nz-tag",80)(13,Gi,2,1,"nz-tag",80)(14,Qi,2,1,"nz-tag",80),r(),t(15,"td"),s(16),L(17,"currency"),r(),t(18,"td")(19,"a",81),p(20,"i",82),r(),t(21,"nz-dropdown-menu",null,17)(23,"ul",29)(24,"li",67),f("click",function(){let n=u(e).$implicit,l=d(3);return _(l.deletePurchase(n.id))}),s(25,"Eliminar Boleto"),r(),t(26,"li",67),f("click",function(){let n=u(e).$implicit,l=d(3);return _(l.activatePurchase(n.id,!1))}),s(27,"Suspender Boleto"),r(),t(28,"li",67),f("click",function(){let n=u(e).$implicit,l=d(3);return _(l.activatePurchase(n.id,!0))}),s(29,"Activar Boleto"),r()()()()()}if(i&2){let e=m.$implicit,o=b(22);a(2),c("nzColor","blue"),a(),x(e.name),a(2),S(" ",O(6,13,e.creation_date,"medium")," "),a(3),Mt("",e.routeName," / ",e.stopName," / ",e.round,""),a(2),c("ngIf",e.status==="completed"&&!!e.is_courtesy),a(),c("ngIf",e.status==="completed"&&!e.is_courtesy),a(),c("ngIf",e.status!=="completed"),a(),c("ngIf",e.active),a(),c("ngIf",!e.active),a(2),S(" ",Lt(17,16,e.price)," "),a(3),c("nzDropdownMenu",o)}}function Ji(i,m){if(i&1&&(t(0,"nz-table",77,3)(2,"tbody"),g(3,Xi,30,18,"tr",38),r()()),i&2){let e=b(1);d();let o=b(4),n=d();c("nzData",n.latestPurchases)("nzPageSize",3)("nzFooter",o)("nzLoading",n.loadingLatestPurchases)("nzLoadingDelay",500),a(3),c("ngForOf",e.data)}}function Yi(i,m){if(i&1){let e=v();t(0,"button",83),f("click",function(){u(e);let n=d(2);return _(n.showModal())}),p(1,"i",84),s(2,"Nuevo Pase1"),r(),t(3,"button",85),f("click",function(){u(e);let n=d(2);return _(n.showModalProduct())}),p(4,"i",84),s(5,"Productos"),r()}}function Ki(i,m){i&1&&(t(0,"nz-tag",78),s(1,"Activa"),r()),i&2&&c("nzColor","cyan")}function Zi(i,m){i&1&&(t(0,"nz-tag",78),s(1,"Inactiva"),r()),i&2&&c("nzColor","yellow")}function en(i,m){if(i&1&&(t(0,"span",79),s(1),L(2,"date"),r()),i&2){let e=d().$implicit;a(),S(" ",O(2,1,e.passValidation.lastUsed.toDate(),"medium")," ")}}function tn(i,m){if(i&1){let e=v();t(0,"tr",50),f("click",function(){let n=u(e).$implicit,l=d(3);return _(l.boardingPassSelected(n))}),t(1,"td"),s(2),L(3,"date"),r(),t(4,"td"),s(5),L(6,"date"),r(),t(7,"td"),g(8,Ki,2,1,"nz-tag",80)(9,Zi,2,1,"nz-tag",80),r(),t(10,"td"),g(11,en,3,4,"span",86),r(),t(12,"td")(13,"a",81),p(14,"i",82),r(),t(15,"nz-dropdown-menu",null,22)(17,"ul",29)(18,"li",67),f("click",function(){let n=u(e).$implicit,l=d(3);return _(l.deleteCredential(n.id))}),s(19,"Eliminar Credencial"),r(),t(20,"li",67),f("click",function(){let n=u(e).$implicit,l=d(3);return _(l.activateCredential(n.id,!1))}),s(21,"Suspender Credencial"),r(),t(22,"li",67),f("click",function(){let n=u(e).$implicit,l=d(3);return _(l.activateCredential(n.id,!0))}),s(23,"Activar Credencial"),r()()()()()}if(i&2){let e=m.$implicit,o=b(16);a(2),x(O(3,6,e.validFrom.toDate(),"mediumDate")),a(3),x(O(6,9,e.validTo.toDate(),"mediumDate")),a(3),c("ngIf",e.active),a(),c("ngIf",!e.active),a(2),c("ngIf",!!e.passValidation&&e.passValidation.lastUsed),a(2),c("nzDropdownMenu",o)}}function nn(i,m){if(i&1&&(t(0,"nz-table",77,3)(2,"thead")(3,"tr")(4,"th",75),s(5,"V\xE1lida desde"),r(),t(6,"th",75),s(7,"V\xE1lida hasta"),r(),t(8,"th",75),s(9,"Estado"),r(),t(10,"th",75),s(11,"Ultima Actividad"),r()()(),t(12,"tbody"),g(13,tn,24,12,"tr",38),r()()),i&2){let e=b(1);d();let o=b(8),n=d();c("nzData",n.userCredentials)("nzPageSize",3)("nzFooter",o)("nzLoading",n.loadingUserCredentials)("nzLoadingDelay",500),a(13),c("ngForOf",e.data)}}function rn(i,m){if(i&1){let e=v();t(0,"button",83),f("click",function(){u(e);let n=d(2);return _(n.showModalCredential())}),p(1,"i",84),s(2,"Nueva credencial"),r()}}function on(i,m){if(i&1&&(t(0,"tr")(1,"td"),s(2),L(3,"date"),r(),t(4,"td"),s(5),r()()),i&2){let e=m.$implicit;a(2),x(O(3,2,e.createdAt.toDate(),"dd/MM/yyyy")),a(3),x(e.msg)}}function an(i,m){if(i&1){let e=v();t(0,"div"),p(1,"nz-divider",87),t(2,"textarea",88),F("ngModelChange",function(n){u(e);let l=d(2);return k(l.newMessage,n)||(l.newMessage=n),_(n)}),r()(),t(3,"button",83),f("click",function(){u(e);let n=d(2);return _(n.showModalMessageCenter())}),p(4,"i",84),s(5,"Enviar Mensaje"),r()}if(i&2){let e=d(2);a(2),P("ngModel",e.newMessage)}}function sn(i,m){if(i&1&&(t(0,"nz-tabset",68)(1,"nz-tab",69),g(2,Ji,4,6,"nz-table",70)(3,Yi,6,0,"ng-template",null,18,y),r(),t(5,"nz-tab",71),g(6,nn,14,6,"nz-table",70)(7,rn,3,0,"ng-template",null,19,y),r(),t(9,"nz-tab",72),s(10," Otras compras "),r(),t(11,"nz-tab",73)(12,"nz-table",74,20)(14,"thead")(15,"tr")(16,"th",75),s(17,"Fecha"),r(),t(18,"th",75),s(19,"Mensaje"),r()()(),t(20,"tbody"),g(21,on,6,5,"tr",76),r()(),g(22,an,6,1,"ng-template",null,21,y),r()()),i&2){let e=b(13),o=b(23),n=d();a(2),c("ngIf",n.latestPurchases),a(4),c("ngIf",n.userCredentials),a(6),c("nzData",n.userChatMessageData)("nzPageSize",3)("nzFooter",o)("nzLoadingDelay",500),a(9),c("ngForOf",e.data)}}function ln(i,m){i&1&&s(0," Nuevo pase ")}function cn(i,m){if(i&1&&(t(0,"div")(1,"nz-option",105),p(2,"i",84),s(3),r()()),i&2){let e=m.$implicit;a(),c("nzLabel",e.name)("nzValue",e.productId),a(2),N(" ",e.name," $",e.price," ")}}function dn(i,m){if(i&1&&(t(0,"nz-option",105),p(1,"i",84),s(2),r()),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.routeId),a(2),S(" ",e.name,"")}}function mn(i,m){if(i&1&&(t(0,"nz-option",105),p(1,"i",84),s(2),p(3,"br"),s(4),r()),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.stopPointId),a(2),S(" ",e.name," "),a(2),S(" ",e.description," ")}}function pn(i,m){if(i&1){let e=v();t(0,"form",89),f("ngSubmit",function(){u(e);let n=d();return _(n.submitForm())}),t(1,"nz-form-item")(2,"nz-form-label"),s(3,"Servicio "),r(),t(4,"nz-select",90),f("ngModelChange",function(n){u(e);let l=d();return _(l.onProductSelected(n,l.products))}),g(5,cn,4,4,"div",76),r()(),t(6,"nz-form-item")(7,"nz-form-label"),s(8,"Operaci\xF3n"),r(),t(9,"nz-select",91),f("ngModelChange",function(n){u(e);let l=d();return _(l.onRouteSelected(n,l.routes))}),g(10,dn,3,3,"nz-option",92),r()(),t(11,"nz-form-item")(12,"nz-form-label"),s(13,"Estaci\xF3n"),r(),t(14,"nz-select",93),f("ngModelChange",function(n){u(e);let l=d();return _(l.onStopPointSelected(n,l.stopPoints))}),g(15,mn,5,4,"nz-option",92),r()(),t(16,"nz-form-item")(17,"nz-form-label"),s(18,"Turno"),r(),t(19,"nz-select",94),p(20,"nz-option",95)(21,"nz-option",96)(22,"nz-option",97),r()(),t(23,"div",98)(24,"div",99)(25,"nz-form-item")(26,"nz-form-label"),s(27,"Cantidad a pagar"),r(),t(28,"nz-input-number",100),f("ngModelChange",function(n){u(e);let l=d();return _(l.onAmountChange(n))}),r()()(),t(29,"div",99)(30,"nz-form-item")(31,"nz-form-label"),s(32,"\xBFEs cortes\xEDa?"),r(),t(33,"nz-switch",101),f("ngModelChange",function(n){u(e);let l=d();return _(l.onCourtesyChange(n))}),r()()()(),t(34,"nz-form-item")(35,"nz-form-control")(36,"label",102),s(37,"Activar pase"),r()()(),t(38,"div",98)(39,"div",99)(40,"nz-form-item")(41,"nz-form-label"),s(42,"V\xE1lido desde"),r(),p(43,"nz-date-picker",103),r()(),t(44,"div",99)(45,"nz-form-item")(46,"nz-form-label"),s(47,"V\xE1lido hasta"),r(),p(48,"nz-date-picker",104),r()()()()}if(i&2){let e=d();c("formGroup",e.validateForm),a(5),c("ngForOf",e.products),a(5),c("ngForOf",e.routes),a(5),c("ngForOf",e.stopPoints),a(13),c("nzMin",50)("nzMax",1299)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function un(i,m){if(i&1){let e=v();t(0,"button",85),f("click",function(){u(e);let n=d();return _(n.handleCancel())}),s(1,"Cancelar"),r(),t(2,"button",106),f("click",function(){u(e);let n=d();return _(n.submitForm())}),s(3,"Guardar"),r()}if(i&2){let e=d();a(2),c("nzLoading",e.isConfirmLoading)}}function _n(i,m){i&1&&s(0," Productos ")}function hn(i,m){if(i&1&&(t(0,"nz-option",105),p(1,"i",84),s(2),r()),i&2){let e=d().$implicit;c("nzLabel",e.name)("nzValue",e.productId),a(2),N(" ",e.name," $",e.price,"")}}function fn(i,m){if(i&1&&(t(0,"div"),g(1,hn,3,4,"nz-option",108),r()),i&2){let e=m.$implicit;a(),c("ngIf",e.type=="Producto")}}function gn(i,m){if(i&1){let e=v();t(0,"form",107),f("ngSubmit",function(){u(e);let n=d();return _(n.submitForm())}),t(1,"nz-form-item")(2,"nz-form-label"),s(3,"Producto"),r(),t(4,"nz-select",90),f("ngModelChange",function(n){u(e);let l=d();return _(l.onProductSelected(n,l.products))}),g(5,fn,2,1,"div",76),r()(),t(6,"div",98)(7,"div",99)(8,"nz-form-item")(9,"nz-form-label"),s(10,"Cantidad a pagar"),r(),t(11,"nz-input-number",100),f("ngModelChange",function(n){u(e);let l=d();return _(l.onAmountChange(n))}),r()()(),t(12,"div",99)(13,"nz-form-item")(14,"nz-form-label"),s(15,"\xBFEs cortes\xEDa?"),r(),t(16,"nz-switch",101),f("ngModelChange",function(n){u(e);let l=d();return _(l.onCourtesyChange(n))}),r()()()(),t(17,"nz-form-item")(18,"nz-form-control")(19,"label",102),s(20,"Activar pase"),r()()(),t(21,"div",98)(22,"div",99)(23,"nz-form-item")(24,"nz-form-label"),s(25,"V\xE1lido desde"),r(),p(26,"nz-date-picker",103),r()(),t(27,"div",99)(28,"nz-form-item")(29,"nz-form-label"),s(30,"V\xE1lido hasta"),r(),p(31,"nz-date-picker",104),r()()()()}if(i&2){let e=d();c("formGroup",e.validateForm),a(5),c("ngForOf",e.products),a(6),c("nzMin",50)("nzMax",1299)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function zn(i,m){if(i&1){let e=v();t(0,"button",85),f("click",function(){u(e);let n=d();return _(n.handleCancelProduct())}),s(1,"Cancelar"),r(),t(2,"button",106),f("click",function(){u(e);let n=d();return _(n.submitFormProduct())}),s(3,"Guardar"),r()}if(i&2){let e=d();a(2),c("nzLoading",e.isConfirmLoading)}}function Cn(i,m){i&1&&p(0,"nz-badge",144)}function vn(i,m){i&1&&p(0,"nz-badge",145)}function xn(i,m){i&1&&p(0,"nz-badge",146)}function Sn(i,m){i&1&&p(0,"nz-badge",147)}function bn(i,m){i&1&&p(0,"nz-badge",146)}function yn(i,m){if(i&1&&(t(0,"nz-descriptions-item",148),s(1),p(2,"br"),s(3),r()),i&2){let e=d(2);a(),N(" Tarjeta ",e.lastPurchase.card.bank_name," / ",e.lastPurchase.card.brand," "),a(2),S(" ",e.lastPurchase.card.card_number," ")}}function wn(i,m){i&1&&(t(0,"nz-descriptions-item",148),s(1," Tienda "),r())}function En(i,m){i&1&&(t(0,"nz-descriptions-item",148),s(1," Efectivo "),r())}function Tn(i,m){if(i&1){let e=v();t(0,"nz-date-picker",149),F("ngModelChange",function(n){u(e);let l=d(2);return k(l.lastPurchase.due_date,n)||(l.lastPurchase.due_date=n),_(n)}),f("ngModelChange",function(n){u(e);let l=d(2);return _(l.onValidToUpdated(n))}),r()}if(i&2){let e=d(2);P("ngModel",e.lastPurchase.due_date)}}function Vn(i,m){if(i&1){let e=v();t(0,"a",150),f("nzOnConfirm",function(){u(e);let n=d(2);return _(n.onCanUpdateValidTo())})("nzOnCancel",function(){u(e);let n=d(2);return _(n.handleCancel())}),t(1,"small"),s(2,"Editar"),r()()}}function In(i,m){if(i&1){let e=v();t(0,"a",151),f("nzOnConfirm",function(){u(e);let n=d(2);return _(n.onCanUpdatePayment())})("nzOnCancel",function(){u(e);let n=d(2);return _(n.handleCancel())}),t(1,"small"),s(2,"Editar"),r()()}}function Dn(i,m){if(i&1){let e=v();t(0,"nz-input-number",152),F("ngModelChange",function(n){u(e);let l=d(2);return k(l.lastPurchase.amount,n)||(l.lastPurchase.amount=n),_(n)}),f("ngModelChange",function(n){u(e);let l=d(2);return _(l.onPaymentUpdated(n))}),r()}if(i&2){let e=d(2);P("ngModel",e.lastPurchase.amount),c("nzMin",1)("nzMax",12e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function Pn(i,m){if(i&1){let e=v();t(0,"div",109)(1,"nz-tabset",110)(2,"nz-tab",111)(3,"div")(4,"nz-descriptions",112)(5,"nz-descriptions-item",113),s(6),r(),t(7,"nz-descriptions-item",114),g(8,Cn,1,0,"nz-badge",115)(9,vn,1,0,"nz-badge",116)(10,xn,1,0,"nz-badge",117),r(),t(11,"nz-descriptions-item",118),g(12,Sn,1,0,"nz-badge",119)(13,bn,1,0,"nz-badge",117),r(),t(14,"nz-descriptions-item",120),s(15),L(16,"date"),r(),g(17,yn,4,3,"nz-descriptions-item",121)(18,wn,2,0,"nz-descriptions-item",121)(19,En,2,0,"nz-descriptions-item",121),t(20,"nz-descriptions-item",122),s(21),r(),t(22,"nz-descriptions-item",123),s(23),L(24,"date"),r(),t(25,"nz-descriptions-item",124),s(26),L(27,"date"),g(28,Tn,1,1,"nz-date-picker",125)(29,Vn,3,0,"a",126),r(),t(30,"nz-descriptions-item",127),p(31,"i",128)(32,"i",129),r(),t(33,"nz-descriptions-item",130),s(34),r(),t(35,"nz-descriptions-item",114),s(36),g(37,In,3,0,"a",131)(38,Dn,1,6,"nz-input-number",132),r(),t(39,"nz-descriptions-item",133),s(40),r(),t(41,"nz-descriptions-item",134),s(42),r(),t(43,"nz-descriptions-item",135),s(44),r(),t(45,"nz-descriptions-item",136),s(46),r(),t(47,"nz-descriptions-item",137),s(48),r()(),p(49,"br"),r()(),t(50,"nz-tab",138),p(51,"app-shared-usage-history",139),r(),t(52,"nz-tab",140),p(53,"nz-qrcode",141)(54,"a",null,23),s(56),t(57,"button",142),f("click",function(){u(e);let n=d();return _(n.downloadImg())}),s(58,"Descargar"),r()(),t(59,"nz-tab",143),s(60," Content of Tab Pane 3 "),r()()()}if(i&2){let e,o=d();a(),c("nzSelectedIndex",0),a(5),x(o.lastPurchase.name),a(2),c("ngIf",o.lastPurchase.status=="completed"),a(),c("ngIf",o.lastPurchase.status=="partial"),a(),c("ngIf",o.lastPurchase.status=="in_progress"),a(2),c("ngIf",o.lastPurchase.active),a(),c("ngIf",!o.lastPurchase.active),a(2),S(" ",O(16,32,o.lastPurchase.operation_date,"medium")," "),a(2),c("ngIf",!!o.lastPurchase&&o.lastPurchase.card),a(),c("ngIf",!!o.lastPurchase&&o.lastPurchase.method=="store"),a(),c("ngIf",!!o.lastPurchase&&o.lastPurchase.method=="cash"),a(2),S("",o.lastPurchase.is_courtesy?"Si":"No"," "),a(2),S(" ",O(24,35,o.lastPurchase.validFrom.toDate(),"mediumDate"),""),a(3),S(" ",o.canUpdateValidTo?null:O(27,38,o.lastPurchase.validTo.toDate(),"mediumDate")," "),a(2),c("ngIf",o.canUpdateValidTo),a(),c("ngIf",!o.canUpdateValidTo&&o.lastPurchase.status!="completed"),a(5),N("",o.lastPurchase.currency," ",o.lastPurchase.price," "),a(2),N(" ",o.canUpdatePayment?null:o.lastPurchase.currency," ",o.canUpdatePayment?null:o.lastPurchase.amount," "),a(),c("ngIf",!o.canUpdatePayment&&o.lastPurchase.status!="completed"),a(),c("ngIf",o.canUpdatePayment),a(2),x(o.lastPurchase.authorization),a(2),S("",o.lastPurchase.routeName," "),a(2),N("",o.lastPurchase.stopName," ",o.lastPurchase.stopDescription,""),a(2),x(o.lastPurchase.round),a(2),S(" ",o.lastPurchase.description," "),a(3),c("userId",o.currentUserSelected.uid)("boardingPassId",(e=o.lastPurchase==null?null:o.lastPurchase.id)!==null&&e!==void 0?e:""),a(5),N(" ",o.currentUserSelected.uid,"-",o.lastPurchase.id," ")}}function kn(i,m){i&1&&s(0," Nuevo pase ")}function Fn(i,m){if(i&1&&(t(0,"div")(1,"nz-option",105),p(2,"i",84),s(3),r()()),i&2){let e=m.$implicit;a(),c("nzLabel",e.name)("nzValue",e.productId),a(2),N(" ",e.name," $",e.price,"")}}function Mn(i,m){if(i&1&&(t(0,"nz-option",105),p(1,"i",84),s(2),r()),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.routeId),a(2),S(" ",e.name,"")}}function Nn(i,m){if(i&1&&(t(0,"nz-option",105),p(1,"i",84),s(2),p(3,"br"),s(4),r()),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.stopPointId),a(2),S(" ",e.name," "),a(2),S(" ",e.description,"")}}function Ln(i,m){if(i&1){let e=v();t(0,"div")(1,"form",107),f("ngSubmit",function(){u(e);let n=d(2);return _(n.submitForm())}),t(2,"nz-form-item")(3,"nz-form-label"),s(4,"Servicio "),r(),t(5,"nz-select",90),f("ngModelChange",function(n){u(e);let l=d(2);return _(l.onProductSelected(n,l.products))}),g(6,Fn,4,4,"div",76),r()(),t(7,"nz-form-item")(8,"nz-form-label"),s(9,"Operaci\xF3n"),r(),t(10,"nz-select",91),f("ngModelChange",function(n){u(e);let l=d(2);return _(l.onRouteSelected(n,l.routes))}),g(11,Mn,3,3,"nz-option",92),r()(),t(12,"nz-form-item")(13,"nz-form-label"),s(14,"Estaci\xF3n"),r(),t(15,"nz-select",93),f("ngModelChange",function(n){u(e);let l=d(2);return _(l.onStopPointSelected(n,l.stopPoints))}),g(16,Nn,5,4,"nz-option",92),r()(),t(17,"nz-form-item")(18,"nz-form-label"),s(19,"Turno"),r(),t(20,"nz-select",94),p(21,"nz-option",95)(22,"nz-option",96)(23,"nz-option",97),r()(),t(24,"div",98)(25,"div",99)(26,"nz-form-item")(27,"nz-form-label"),s(28,"Cantidad a pagar"),r(),t(29,"nz-input-number",100),f("ngModelChange",function(n){u(e);let l=d(2);return _(l.onAmountChange(n))}),r()()(),t(30,"div",99)(31,"nz-form-item")(32,"nz-form-label"),s(33,"\xBFEs cortes\xEDa?"),r(),t(34,"nz-switch",101),f("ngModelChange",function(n){u(e);let l=d(2);return _(l.onCourtesyChange(n))}),r()()()(),t(35,"nz-form-item")(36,"nz-form-control")(37,"label",102),s(38,"Activar pase"),r()()(),t(39,"div",98)(40,"div",99)(41,"nz-form-item")(42,"nz-form-label"),s(43,"V\xE1lido desde"),r(),p(44,"nz-date-picker",103),r()(),t(45,"div",99)(46,"nz-form-item")(47,"nz-form-label"),s(48,"V\xE1lido hasta"),r(),p(49,"nz-date-picker",104),r()()()()()}if(i&2){let e=d(2);a(),c("formGroup",e.validateForm),a(5),c("ngForOf",e.products),a(5),c("ngForOf",e.routes),a(5),c("ngForOf",e.stopPoints),a(13),c("nzMin",50)("nzMax",1299)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function On(i,m){if(i&1){let e=v();t(0,"tr")(1,"td",161),F("nzCheckedChange",function(n){let l=u(e).$implicit,h=d(3);return k(h.mapOfCheckedId[l.id],n)||(h.mapOfCheckedId[l.id]=n),_(n)}),f("nzCheckedChange",function(){u(e);let n=d(3);return _(n.refreshStatus())}),r(),t(2,"td"),s(3),r(),t(4,"td"),s(5),r(),t(6,"td"),s(7),r()()}if(i&2){let e=m.$implicit,o=d(3);a(),P("nzChecked",o.mapOfCheckedId[e.id]),a(2),x(e.studentId),a(2),x(e.displayName),a(2),x(e.email)}}function Un(i,m){if(i&1){let e=v();t(0,"div")(1,"nz-table",159,24),f("nzCurrentPageDataChange",function(n){u(e);let l=d(2);return _(l.currentPageDataChange(n))}),t(3,"thead")(4,"tr")(5,"th",160),F("nzCheckedChange",function(n){u(e);let l=d(2);return k(l.isAllDisplayDataChecked,n)||(l.isAllDisplayDataChecked=n),_(n)}),f("nzCheckedChange",function(n){u(e);let l=d(2);return _(l.checkAllData(n))}),r(),t(6,"th",75),s(7,"Id"),r(),t(8,"th",75),s(9,"Nombre"),r(),t(10,"th",75),s(11,"Email / Tel\xE9fono"),r()()(),t(12,"tbody"),g(13,On,8,4,"tr",76),r()()()}if(i&2){let e=b(2),o=d(2);a(),c("nzData",o.devicesList)("nzSize","middle"),a(4),c("nzSelections",o.listOfSelection),P("nzChecked",o.isAllDisplayDataChecked),c("nzIndeterminate",o.isIndeterminate),a(8),c("ngForOf",e.data)}}function An(i,m){if(i&1){let e=v();t(0,"nz-date-picker",149),F("ngModelChange",function(n){u(e);let l=d(3);return k(l.lastPurchase.due_date,n)||(l.lastPurchase.due_date=n),_(n)}),f("ngModelChange",function(n){u(e);let l=d(3);return _(l.onValidToUpdated(n))}),r()}if(i&2){let e=d(3);P("ngModel",e.lastPurchase.due_date)}}function Rn(i,m){if(i&1){let e=v();t(0,"a",150),f("nzOnConfirm",function(){u(e);let n=d(3);return _(n.onCanUpdateValidTo())})("nzOnCancel",function(){u(e);let n=d(3);return _(n.handleCancel())}),t(1,"small"),s(2,"Editar"),r()()}}function Bn(i,m){if(i&1){let e=v();t(0,"a",151),f("nzOnConfirm",function(){u(e);let n=d(3);return _(n.onCanUpdatePayment())})("nzOnCancel",function(){u(e);let n=d(3);return _(n.handleCancel())}),t(1,"small"),s(2,"Editar"),r()()}}function qn(i,m){if(i&1){let e=v();t(0,"nz-input-number",152),F("ngModelChange",function(n){u(e);let l=d(3);return k(l.lastPurchase.amount,n)||(l.lastPurchase.amount=n),_(n)}),f("ngModelChange",function(n){u(e);let l=d(3);return _(l.onPaymentUpdated(n))}),r()}if(i&2){let e=d(3);P("ngModel",e.lastPurchase.amount),c("nzMin",1)("nzMax",12e3)("nzStep",1)("nzFormatter",e.formatterDollar)("nzParser",e.parserDollar)}}function $n(i,m){if(i&1&&(t(0,"div")(1,"div")(2,"nz-descriptions",112)(3,"nz-descriptions-item",113),s(4),r(),t(5,"nz-descriptions-item",122),s(6),r(),t(7,"nz-descriptions-item",123),s(8),L(9,"date"),r(),t(10,"nz-descriptions-item",124),s(11),L(12,"date"),g(13,An,1,1,"nz-date-picker",125)(14,Rn,3,0,"a",126),r(),t(15,"nz-descriptions-item",127),p(16,"i",128)(17,"i",129),r(),t(18,"nz-descriptions-item",130),s(19),r(),t(20,"nz-descriptions-item",114),s(21),g(22,Bn,3,0,"a",131)(23,qn,1,6,"nz-input-number",132),r(),t(24,"nz-descriptions-item",133),s(25),r(),t(26,"nz-descriptions-item",134),s(27),r(),t(28,"nz-descriptions-item",135),s(29),r(),t(30,"nz-descriptions-item",136),s(31),r(),t(32,"nz-descriptions-item",137),s(33),r()(),p(34,"br"),r(),s(35),r()),i&2){let e=d(2);a(4),x(e.validateForm.controls.product_description.value),a(2),S("",e.validateForm.controls.is_courtesy.value?"Si":"No"," "),a(2),S(" ",O(9,19,e.lastPurchase.validFrom.toDate(),"mediumDate"),""),a(3),S(" ",e.canUpdateValidTo?null:O(12,22,e.lastPurchase.validTo.toDate(),"mediumDate")," "),a(2),c("ngIf",e.canUpdateValidTo),a(),c("ngIf",!e.canUpdateValidTo&&e.lastPurchase.status!="completed"),a(5),N("",e.lastPurchase.currency," ",e.lastPurchase.price," "),a(2),N(" ",e.canUpdatePayment?null:e.lastPurchase.currency," ",e.canUpdatePayment?null:e.lastPurchase.amount," "),a(),c("ngIf",!e.canUpdatePayment&&e.lastPurchase.status!="completed"),a(),c("ngIf",e.canUpdatePayment),a(2),x(e.lastPurchase.authorization),a(2),S("",e.lastPurchase.routeName," "),a(2),N("",e.lastPurchase.stopName," ",e.lastPurchase.stopDescription,""),a(2),x(e.lastPurchase.round),a(2),S(" ",e.lastPurchase.description," "),a(2),S(" ",e.actualSelectedRows," ")}}function jn(i,m){if(i&1&&(t(0,"nz-steps",153),p(1,"nz-step",154)(2,"nz-step",155)(3,"nz-step",156),r(),p(4,"br"),t(5,"div",157),g(6,Ln,50,9,"div",158)(7,Un,14,6,"div",158)(8,$n,36,25,"div",158),r()),i&2){let e=d();c("nzCurrent",e.current),a(6),c("ngIf",e.current==0),a(),c("ngIf",e.current==1),a(),c("ngIf",e.current==2)}}function Wn(i,m){if(i&1){let e=v();t(0,"button",166),f("click",function(){u(e);let n=d(2);return _(n.pre())}),t(1,"span"),s(2,"Anterior"),r()()}if(i&2){let e=d(2);c("disabled",e.isCreatingBoardingPasses)}}function Hn(i,m){if(i&1){let e=v();t(0,"button",166),f("click",function(){u(e);let n=d(2);return _(n.next())}),t(1,"span"),s(2,"Siguiente"),r()()}if(i&2){let e=d(2);c("disabled",e.isCreatingBoardingPasses)}}function Gn(i,m){if(i&1){let e=v();t(0,"button",106),f("click",function(){u(e);let n=d(2);return _(n.createMultipleBoardingPasses())}),t(1,"span"),s(2,"Crear Pases"),r()()}if(i&2){let e=d(2);c("nzLoading",e.isCreatingBoardingPasses)}}function Qn(i,m){if(i&1){let e=v();t(0,"button",85),f("click",function(){u(e);let n=d(2);return _(n.done())}),t(1,"span"),s(2,"Terminar"),r()()}}function Xn(i,m){if(i&1&&(t(0,"div",162),g(1,Wn,3,1,"button",163)(2,Hn,3,1,"button",163)(3,Gn,3,1,"button",164)(4,Qn,3,0,"button",165),r()),i&2){let e=d();a(),c("ngIf",e.current>0&&!e.isDone),a(),c("ngIf",e.current<2),a(),c("ngIf",e.current===2&&!e.isDone),a(),c("ngIf",e.current===2&&e.isDone)}}function Jn(i,m){i&1&&s(0," Nuevas credenciales ")}function Yn(i,m){if(i&1){let e=v();t(0,"div")(1,"form",107),f("ngSubmit",function(){u(e);let n=d(2);return _(n.createMultipleCredentials())}),t(2,"div",98)(3,"div",99)(4,"nz-form-item")(5,"nz-form-label"),s(6,"V\xE1lido desde"),r(),p(7,"nz-date-picker",103),r()(),t(8,"div",99)(9,"nz-form-item")(10,"nz-form-label"),s(11,"V\xE1lido hasta"),r(),p(12,"nz-date-picker",104),r()(),t(13,"div",99)(14,"nz-form-item")(15,"nz-form-control")(16,"label",102),s(17,"Activar credencial"),r()()()()()()()}if(i&2){let e=d(2);a(),c("formGroup",e.credentialForm)}}function Kn(i,m){if(i&1){let e=v();t(0,"tr")(1,"td",161),F("nzCheckedChange",function(n){let l=u(e).$implicit,h=d(3);return k(h.mapOfCredentialsCheckedId[l.uid],n)||(h.mapOfCredentialsCheckedId[l.uid]=n),_(n)}),f("nzCheckedChange",function(){u(e);let n=d(3);return _(n.refreshCredentialsStatus())}),r(),t(2,"td"),s(3),r(),t(4,"td"),s(5),r(),t(6,"td"),s(7),r(),t(8,"td"),s(9),r()()}if(i&2){let e=m.$implicit,o=d(3);a(),P("nzChecked",o.mapOfCredentialsCheckedId[e.uid]),a(2),x(e.customerName),a(2),x(e.studentId),a(2),x(e.displayName),a(2),x(e.email)}}function Zn(i,m){if(i&1){let e=v();t(0,"div")(1,"nz-table",159,24),f("nzCurrentPageDataChange",function(n){u(e);let l=d(2);return _(l.currentCredentialsPageDataChange(n))}),t(3,"thead")(4,"tr")(5,"th",160),F("nzCheckedChange",function(n){u(e);let l=d(2);return k(l.isCredentialsAllDisplayDataChecked,n)||(l.isCredentialsAllDisplayDataChecked=n),_(n)}),f("nzCheckedChange",function(n){u(e);let l=d(2);return _(l.checkCredentialsAllData(n))}),r(),t(6,"th",75),s(7,"Empresa"),r(),t(8,"th",75),s(9,"Id"),r(),t(10,"th",75),s(11,"Nombre"),r(),t(12,"th",75),s(13,"Email / Tel\xE9fono"),r()()(),t(14,"tbody"),g(15,Kn,10,5,"tr",76),r()()()}if(i&2){let e=b(2),o=d(2);a(),c("nzData",o.usersByAccount)("nzSize","middle"),a(4),c("nzSelections",o.listOfCredentialsSelection),P("nzChecked",o.isCredentialsAllDisplayDataChecked),c("nzIndeterminate",o.isCredentialsIndeterminate),a(10),c("ngForOf",e.data)}}function er(i,m){if(i&1&&(t(0,"div"),s(1),r()),i&2){let e=d(3);a(),S(" Se crear\xE1n ",e.actualSelectedRows," credenciales para los usuarios seleccionados. ")}}function tr(i,m){i&1&&(t(0,"div"),s(1," No has seleccionado ning\xFAn usuario para crear una credencial. "),r())}function ir(i,m){if(i&1&&(t(0,"div"),g(1,er,2,1,"div",158)(2,tr,2,0,"div",158),r()),i&2){let e=d(2);a(),c("ngIf",e.actualSelectedRows>0),a(),c("ngIf",e.actualSelectedRows===0)}}function nr(i,m){if(i&1&&(t(0,"div")(1,"div"),s(2),r()()),i&2){let e=d(2);a(2),S(" Se crearon ",e.actualSelectedRows,". ")}}function rr(i,m){if(i&1&&(t(0,"nz-steps",153),p(1,"nz-step",167)(2,"nz-step",168)(3,"nz-step",156),r(),p(4,"br"),t(5,"div",157),g(6,Yn,18,1,"div",158)(7,Zn,16,6,"div",158)(8,ir,3,2,"div",158)(9,nr,3,1,"div",158),r()),i&2){let e=d();c("nzCurrent",e.current),a(6),c("ngIf",e.current==0),a(),c("ngIf",e.current==1),a(),c("ngIf",e.current==2),a(),c("ngIf",e.current==3)}}function or(i,m){if(i&1){let e=v();t(0,"button",85),f("click",function(){u(e);let n=d(2);return _(n.pre())}),t(1,"span"),s(2,"Anterior"),r()()}}function ar(i,m){if(i&1){let e=v();t(0,"button",166),f("click",function(){u(e);let n=d(2);return _(n.next())}),t(1,"span"),s(2,"Siguiente"),r()()}if(i&2){let e=d(2);c("disabled",e.credentialForm.invalid)}}function sr(i,m){if(i&1){let e=v();t(0,"button",170),f("click",function(){u(e);let n=d(2);return _(n.createMultipleCredentials())}),t(1,"span"),s(2,"Crear Credenciales"),r()()}if(i&2){let e=d(2);c("disabled",e.actualSelectedRows===0)("nzLoading",e.isCreatingCredentials)}}function lr(i,m){if(i&1){let e=v();t(0,"button",85),f("click",function(){u(e);let n=d(2);return _(n.done())}),t(1,"span"),s(2,"Terminar"),r()()}}function cr(i,m){if(i&1&&(t(0,"div",162),g(1,or,3,0,"button",165)(2,ar,3,1,"button",163)(3,sr,3,2,"button",169)(4,lr,3,0,"button",165),r()),i&2){let e=d();a(),c("ngIf",e.current>0&&!e.isDone),a(),c("ngIf",e.current<2),a(),c("ngIf",e.current===2&&!e.isDone),a(),c("ngIf",e.current===3&&e.isDone)}}function dr(i,m){i&1&&s(0," Nueva credencial ")}function mr(i,m){if(i&1){let e=v();t(0,"div",157)(1,"form",107),f("ngSubmit",function(){u(e);let n=d();return _(n.createCredential())}),t(2,"div",98)(3,"div",99)(4,"nz-form-item")(5,"nz-form-label"),s(6,"V\xE1lido desde"),r(),p(7,"nz-date-picker",103),r()(),t(8,"div",99)(9,"nz-form-item")(10,"nz-form-label"),s(11,"V\xE1lido hasta"),r(),p(12,"nz-date-picker",104),r()(),t(13,"div",99)(14,"nz-form-item")(15,"nz-form-control")(16,"label",102),s(17,"Activar credencial"),r()()()()()()()}if(i&2){let e=d();a(),c("formGroup",e.credentialForm)}}function pr(i,m){if(i&1){let e=v();t(0,"button",170),f("click",function(){u(e);let n=d();return _(n.createCredential())}),t(1,"span"),s(2,"Crear Credencial"),r()()}if(i&2){let e=d();c("disabled",e.credentialForm.invalid)("nzLoading",e.isCreatingCredentials)}}var ta=(()=>{class i{constructor(e,o,n,l){this.afs=e,this.modalService=o,this.messageService=n,this.fb=l,this.authService=T(Z),this.productsService=T(ni),this.customersService=T(lt),this.dashboardService=T(oi),this.rolService=T(Ee),this.hasBeenFiltered=!1,this.loadedDevicesList=[],this.newMessage="",this.loadingChatMessages=!1,this.current=0,this.isDone=!1,this.isCreatingBoardingPasses=!1,this.isCreatingCredentials=!1,this.listOfSelection=[{text:"Seleccionar todas las p\xE1ginas",onSelect:()=>{this.checkAllData(!0)}},{text:"Deseleccionar todas las p\xE1ginas",onSelect:()=>{this.checkAllData(!1),this.refreshStatus()}}],this.listOfCredentialsSelection=[{text:"Seleccionar todas las p\xE1ginas",onSelect:()=>{this.checkCredentialsAllData(!0)}},{text:"Deseleccionar todas las p\xE1ginas",onSelect:()=>{this.checkCredentialsAllData(!1),this.refreshCredentialsStatus()}}],this.isAllDisplayDataChecked=!1,this.isIndeterminate=!1,this.listOfDisplayData=[],this.listOfAllData=[],this.mapOfCheckedId={},this.isCredentialsAllDisplayDataChecked=!1,this.isCredentialsIndeterminate=!1,this.listOfCredentialsDisplayData=[],this.listOfCredentialsAllData=[],this.mapOfCredentialsCheckedId={},this.isContentOpen=!1,this.isUserSelected=!1,this.isLoadingUsers=!1,this.loadingLastPurchase=!1,this.isBoardingPassSelected=!1,this.isCredentialSelected=!1,this.isLoadingPayments=!1,this.hasBeenLoaded=!1,this.loadingUserCredentials=!1,this.loadingLatestPurchases=!1,this.isVisible=!1,this.isProductVisible=!1,this.isModalCredentialVisible=!1,this.isConfirmLoading=!1,this.checked=!1,this.routes=[],this.products=[],this.stopPoints=[],this.usersByAccount=[],this.accountId$=new A,this.routeId$=new A,this.canUpdatePayment=!1,this.canUpdateValidTo=!1,this.elementType="url",this.customersList=[],this.stopSubscription$=new A,this.isVisibleBulk=!1,this.isLoadingBulk=!1,this.isConfirmLoadingBulk=!1,this.isVisibleBulkCredentials=!1,this.isLoadingBulkCredentials=!1,this.isConfirmLoadingBulkCredentials=!1,this.formatterPercent=h=>`${h} %`,this.parserPercent=h=>h.replace(" %",""),this.formatterDollar=h=>`$ ${h}`,this.parserDollar=h=>h.replace("$ ",""),this.selectedUsersForCredentials=[],this.infoLoad=[],this.infoSegment=[],this.accountsService=T(Te),this.authService.user.subscribe(h=>{h&&(this.user=h,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(z=>{this.infoLoad=z,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(I(this.stopSubscription$),E(z=>{let V=z.payload.id,Ce=z.payload.data();return w({id:V},Ce)}),W(z=>(this.infoSegment=z,z))).subscribe()))})}ngOnInit(){this.accountId$.pipe(je(h=>this.afs.collection("customers").doc(h).collection("routes",z=>z.where("active","==",!0)).valueChanges({idField:"routeId"}))).subscribe(h=>{this.routes=h});let o=this.accountId$.pipe(je(h=>this.afs.collection("customers").doc(h).collection("products",z=>z.where("active","==",!0)).valueChanges({idField:"productId"}))),n=this.accountId$.pipe(je(h=>this.afs.collection("users",z=>z.where("customerId","==",h).orderBy("studentId")).valueChanges({idField:"uid"}))),l=this.routeId$.pipe(je(h=>this.afs.collection("customers").doc(this.currentSelectedCustomerId).collection("routes").doc(h).collection("stops",z=>z.orderBy("order","asc").where("active","==",!0)).valueChanges({idField:"stopPointId"})));o.subscribe(h=>{this.products=h}),l.subscribe(h=>{this.stopPoints=h}),n.subscribe(h=>{this.usersByAccount=h}),this.getUsersList(),this.getCustomersList(),this.credentialForm=this.fb.group({active:[!0,[C.required]],validFrom:[new Date,[C.required]],validTo:[new Date,[C.required]]}),this.validateForm=this.fb.group({active:[!0,[C.required]],amount:[0,[C.required]],authorization:[""],category:["",[C.required]],conciliated:[!1,[C.required]],creation_date:[new Date().toISOString(),[C.required]],currency:["MXN",[C.required]],customer_id:["",[C.required]],date_created:[new Date,[C.required]],due_date:[new Date,[C.required]],description:["",[C.required]],error_message:[""],fee:this.fb.group({amount:[0],currency:["MXN"],tax:[0]}),is_courtesy:[!1],method:["cash",[C.required]],name:["",[C.required]],operation_date:[new Date().toISOString(),[C.required]],operation_type:["in",[C.required]],order_id:[""],payment_method:this.fb.group({barcode_url:[""],reference:[""],type:["cash"]}),price:[0,[C.required]],product_description:["",[C.required]],product_id:["",[C.required]],round:["",[C.required]],routeId:["",[C.required]],routeName:["",[C.required]],status:["completed",[C.required]],stopDescription:["",[C.required]],stopId:["",[C.required]],stopName:["",[C.required]],transaction_type:["charge",[C.required]],validFrom:[new Date,[C.required]],validTo:[new Date,[C.required]],isTaskIn:[!1,[C.required]],isTaskOut:[!1,[C.required]],isOpenpay:[!1,[C.required]],paidApp:["web",[C.required]],baja:[!1],realValidTo:[]})}ngOnDestroy(){this.hasBeenLoaded=!1,this.loadedDevicesList=[],this.users&&this.users.unsubscribe(),this.routesSubscription&&this.routesSubscription.unsubscribe(),this.productsSubscription&&this.productsSubscription.unsubscribe(),this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}showModal(){this.isVisible=!0}showModalCredential(){this.isModalCredentialVisible=!0}showModalProduct(){this.isProductVisible=!0}showModalMessageCenter(){return Ze(this,null,function*(){if(this.currentUserSelected&&this.currentUserSelected.uid){let e=this.currentUserSelected.uid,o={createdAt:new Date,from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",fromName:"Apps And Informa",msg:this.newMessage,requestId:"suhB7YFAh6PYXCRuJhfD",token:this.currentUserSelected.token,uid:this.currentUserSelected.uid,result:""},n={timestamp:new Date,title:"Apps And Informa General",from:"FyXKSXsUbYNtAbWL7zZ66o2f1M92",requestId:"suhB7YFAh6PYXCRuJhfD",body:this.newMessage,token:this.currentUserSelected.token,uid:this.currentUserSelected.uid};this.dashboardService.setMessage(n,this.currentUserSelected.uid),this.dashboardService.setChatMessage(o).then(()=>{this.newMessage=""})}else this.sendMessage("error","Usuario seleccionado o uid vac\xEDo")})}onBulkBoardingPassSelected(e){this.accountId$.next(e),this.currentSelectedCustomerId=e,this.isVisibleBulk=!0}onBulkCredentialsSelected(e){this.accountId$.next(e),this.currentSelectedCustomerId=e,this.isVisibleBulkCredentials=!0}onProductSelected(e,o){let l=ze.filter(o,h=>h.productId==e)[0];this.validateForm.controls.name.setValue(l.name),this.validateForm.controls.description.setValue(l.description),this.validateForm.controls.product_description.setValue(l.description),this.validateForm.controls.amount.setValue(l.price),this.validateForm.controls.is_courtesy.setValue(!1),this.validateForm.controls.price.setValue(l.price),this.validateForm.controls.category.setValue(l.category),this.validateForm.controls.validFrom.setValue(l.validFrom.toDate()),this.validateForm.controls.validTo.setValue(l.validTo.toDate()),this.validateForm.controls.realValidTo.setValue(l.validTo.toDate().toISOString()),this.validateForm.controls.isTaskIn.setValue(l.isTaskIn),this.validateForm.controls.isTaskOut.setValue(l.isTaskOut)}onRouteSelected(e,o){this.routeId$.next(e);let l=ze.filter(o,h=>h.routeId==e)[0];this.validateForm.controls.routeName.setValue(l.name)}onStopPointSelected(e,o){let l=ze.filter(o,h=>h.stopPointId==e)[0];this.validateForm.controls.stopName.setValue(l.name),this.validateForm.controls.stopDescription.setValue(l.description)}onCourtesyChange(e){e&&this.validateForm.controls.amount.setValue(0)}onAmountChange(e){e>0&&this.validateForm.controls.is_courtesy.setValue(!1)}onCanUpdatePayment(){this.canUpdatePayment=!0}sendMessage(e,o){this.messageService.create(e,o)}onPaymentUpdated(e){this.currentUserSelected&&this.currentUserSelected.uid?(this.lastPurchase!==null&&this.lastPurchase!==void 0?+this.lastPurchase.price===e?this.lastPurchase&&this.lastPurchase.realValidTo?(this.lastPurchase.status="completed",this.lastPurchase.amount=e,this.lastPurchase.active=!0,this.lastPurchase.validTo=Bt.fromDate(new Date(this.lastPurchase.realValidTo))):this.sendMessage("error","Pago o fecha es nulo"):this.lastPurchase.amount=e:this.sendMessage("error","No se encontro ningun pago"),this.userlevelAccess!="3"?this.customersService.updateBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.lastPurchase).then(o=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(o=>{this.isConfirmLoading=!1}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador."),this.canUpdatePayment=!1):this.sendMessage("error","Usuario no encontrado")}onCanUpdateValidTo(){this.canUpdateValidTo=!0}onValidToUpdated(e){this.canUpdateValidTo=!1}createCredential(){if(this.credentialForm.valid)if(this.currentUserSelected&&this.currentUserSelected.uid){let e=this.currentUserSelected.uid,o=this.credentialForm.controls.validFrom.value||new Date,n=this.credentialForm.controls.validTo.value||new Date,l=this.credentialForm.controls.active.value||!1;this.isCreatingCredentials=!0,this.userlevelAccess!="3"?this.customersService.createCredential(this.currentUserSelected.uid,this.currentUserSelected.studentId,o,n,l).then(h=>{this.isModalCredentialVisible=!1}):this.sendMessage("error","El usuario no tiene permisos para crear datos, favor de contactar al administrador."),this.isCreatingCredentials=!1,this.isDone=!0}else this.sendMessage("error","Usuario no encontrado")}submitForm(){if(this.currentUserSelected&&this.currentUserSelected.uid){let e=this.currentUserSelected.uid;this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId);let o=this.validateForm.controls.amount.value,n=this.validateForm.controls.price.value,l=this.validateForm.controls.validTo.value,h=this.validateForm.controls.is_courtesy.value||!1;this.validateForm.controls.due_date.setValue(l.toISOString()),o!=n&&!h&&this.validateForm.controls.status.setValue("partial");for(let z in this.validateForm.controls)this.validateForm.controls[z].markAsDirty(),this.validateForm.controls[z].updateValueAndValidity();this.validateForm.valid&&(this.isConfirmLoading=!0,this.userlevelAccess!="3"?this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.validateForm.value).then(z=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(z=>{this.isConfirmLoading=!1}):this.sendMessage("error","El usuario no tiene permisos para crear datos, favor de contactar al administrador."))}else this.sendMessage("error","Usuario no encontrado")}submitFormProduct(){if(this.currentUserSelected&&this.currentUserSelected.uid){let e=this.currentUserSelected.uid;this.validateForm.controls.customer_id.setValue(this.currentUserSelected.customerId);let o=this.validateForm.controls.amount.value,n=this.validateForm.controls.price.value,l=this.validateForm.controls.validTo.value,h=this.validateForm.controls.is_courtesy.value||!1;this.validateForm.controls.due_date.setValue(l.toISOString()),o!=n&&!h&&this.validateForm.controls.status.setValue("partial");for(let z in this.validateForm.controls)this.validateForm.controls[z].markAsDirty(),this.validateForm.controls[z].updateValueAndValidity();this.validateForm.valid&&(this.isConfirmLoading=!0,this.userlevelAccess!="3"?this.customersService.saveBoardingPassToUserPurchaseCollection(this.currentUserSelected.uid,this.validateForm.value).then(z=>{this.isVisible=!1,this.isConfirmLoading=!1}).catch(z=>{this.isConfirmLoading=!1}):this.sendMessage("error","El usuario no tiene permisos para crear datos, favor de contactar al administrador."))}else this.sendMessage("error","Usuario no encontrado")}handleOk(){this.isConfirmLoading=!0,setTimeout(()=>{this.isVisible=!1,this.isConfirmLoading=!1},3e3)}handleCancel(){this.isVisible=!1,this.isVisibleBulk=!1,this.isVisibleBulkCredentials=!1,this.isModalCredentialVisible=!1}handleCancelProduct(){this.isProductVisible=!1}getUsersList(){this.isLoadingUsers=!0,this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.usersCollection=this.afs.collection("users",e=>e.where("customerId","==",this.user.customerId).orderBy("displayName")),this.users=this.usersCollection.snapshotChanges().pipe(E(e=>e.map(o=>{let n=o.payload.doc.id,l=o.payload.doc.data();return w({id:n},l)}))).subscribe(e=>{this.loadUsers(e)})):(this.usersCollection=this.afs.collection("users",e=>e.orderBy("displayName")),this.users=this.usersCollection.snapshotChanges().pipe(E(e=>e.map(o=>{let n=o.payload.doc.id,l=o.payload.doc.data();return w({id:n},l)}))).subscribe(e=>{this.loadUsers(e)}))}getCustomersList(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.afs.collection("customers").doc(this.user.customerId).snapshotChanges().pipe(I(this.stopSubscription$),E(o=>{let n=o.payload.id,l=o.payload.data();return w({id:n},l)}),W(o=>(this.customersList=[o],o))).subscribe():this.afs.collection("customers",o=>o.orderBy("name")).snapshotChanges().pipe(I(this.stopSubscription$),E(o=>o.map(n=>{let l=n.payload.doc.id,h=n.payload.doc.data();return w({id:l},h)})),W(o=>(this.customersList=o,o))).subscribe()}reassingBoardingPass(e,o){if(this.currentUserSelected&&this.currentUserSelected.uid)if(this.lastPurchase!==null&&this.lastPurchase!==void 0){let n=this.lastPurchase.id;this.afs.collection("users").doc(this.currentUserSelected.id).collection("boardingPasses").doc(this.lastPurchase.id).set(this.lastPurchase).then(h=>{this.afs.collection("users").doc(this.currentUserSelected.uid).collection("boardingPasses").doc(n).delete()})}else this.sendMessage("error","Usuario no encontrado");else this.sendMessage("error","Usuario no encontrado")}refreshList(){this.hasBeenLoaded=!1,this.getUsersList()}loadUsers(e){this.loadedDevicesList.length<=1&&(this.displayData=e,this.devicesList=e.slice().sort((o,n)=>o.displayName.localeCompare(n.displayName)),this.loadedDevicesList=this.devicesList)}getItems(e){this.initializeItems();let o=e;if(!o)return;let n=ze.toLower(o);this.devicesList=ze.filter(this.devicesList,function(l){return Object.values(l).some(function(h){return(0,xi.toLower)(h).includes(n)})})}initializeItems(){this.devicesList=this.loadedDevicesList}userSelected(e){if(this.currentUserSelected&&this.currentUserSelected.uid){let o=this.currentUserSelected.uid;this.lastPurchase!==null&&this.lastPurchase!==void 0?(this.currentUserSelected=e,this.currentSelectedCustomerId=this.currentUserSelected.customerId,this.accountId$.next(this.currentUserSelected.customerId),this.isUserSelected=!0,this.isBoardingPassSelected=!1,this.getLatestPurchases(e.uid),this.getUserCredentials(e.uid),this.getUserChatMessages(e.uid),this.lastPurchase=null):this.sendMessage("error","Usuario no encontrado")}else this.sendMessage("error","Usuario no encontrado")}boardingPassSelected(e){this.currentUserSelected&&(this.isBoardingPassSelected=!0,this.lastPurchase=e)}copyDataToUserCollection(){if(this.userlevelAccess!="3")if(this.currentUserSelected&&this.currentUserSelected.uid){let e=this.currentUserSelected.uid;this.customersService.saveOldBoardingPassToUserCollection(this.currentUserSelected.paymentId)}else this.sendMessage("error","Usuario no encontrado");else this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}showDeleteConfirm(){if(this.currentUserSelected&&this.currentUserSelected.uid){let e=this.currentUserSelected.uid;this.modalService.confirm({nzTitle:"\xBFEst\xE1 seguro de eliminar esta cuenta?",nzContent:'<b style="color: red;">Toda la informaci\xF3n relacionada a esta cuenta ser\xE1 eliminada permanentemente.</b>',nzOkText:"Eliminar",nzOnOk:()=>{this.userlevelAccess=="1"?this.customersService.deleteUser(this.currentUserSelected.uid):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador."),this.currentUserSelected={token:null,uid:"",studentId:"",customerId:"",id:"",paymentId:"",disabled:!1,photoURL:"",displayName:"",emailVerified:!1,email:""},this.isUserSelected=!1},nzCancelText:"No"})}else this.sendMessage("error","Usuario no encontrado")}getLastPurchase(e){this.loadingLastPurchase=!0,this.lastPurchase=null,this.customersService.getLastPurchase(e).valueChanges().subscribe(o=>{this.lastPurchase=o,this.loadingLastPurchase=!1},o=>{this.loadingLastPurchase=!1,this.lastPurchase=null})}activatePurchase(e,o){if(this.userlevelAccess!="3")if(this.currentUserSelected&&this.currentUserSelected.uid){let n=this.currentUserSelected.uid;this.customersService.activatePurchase(this.currentUserSelected.uid,e,o),this.currentUserSelected.paymentId=e}else this.sendMessage("error","Usuario no encontrado");else this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}deletePurchase(e){this.userlevelAccess=="1"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.deletePurchase(this.currentUserSelected.uid,e),this.isBoardingPassSelected=!1):this.sendMessage("error","Usuario no encontrado"):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}activateCredential(e,o){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.activateCredential(this.currentUserSelected.uid,e,o),this.currentUserSelected.paymentId=e):this.sendMessage("error","Usuario no encontrado"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}deleteCredential(e){this.userlevelAccess=="1"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.deleteCredential(this.currentUserSelected.uid,e),this.isBoardingPassSelected=!1):this.sendMessage("error","Usuario no encontrado"):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}setUserDisabled(e){this.userlevelAccess!="3"?this.currentUserSelected&&this.currentUserSelected.uid?(this.customersService.setUserDisabled(this.currentUserSelected.uid,e),this.currentUserSelected.disabled=e):this.sendMessage("error","Usuario no encontrado"):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}getLatestPurchases(e){this.loadingLatestPurchases=!0,this.customersService.getLatestUserPurchases(e,10).pipe(E(o=>o.map(n=>{let l=n.payload.doc.id,h=n.payload.doc.data();return w({id:l},h)}))).subscribe({next:o=>{this.latestPurchases=o,this.loadingLatestPurchases=!1},error:o=>{this.latestPurchases=null,this.loadingLatestPurchases=!1,this.sendMessage("error",o)}})}getUserCredentials(e){this.loadingUserCredentials=!0,this.customersService.getUserCredentials(e).subscribe({next:o=>{this.userCredentials=o},error:o=>{this.userCredentials=null},complete:()=>{this.loadingUserCredentials=!1}})}getUserChatMessages(e){this.loadingChatMessages=!0,this.dashboardService.getUserChatMessages(e,10).subscribe(o=>{this.userChatMessageData=o})}pre(){this.current-=1}next(){if(this.current+=1,this.current===2){let e=[];this.usersByAccount.forEach(o=>{this.mapOfCredentialsCheckedId[o.uid]===!0&&e.push(o)}),this.actualSelectedRows=e.length,this.selectedUsersForCredentials=e}}done(){this.isVisibleBulk=!1,this.isVisibleBulkCredentials=!1,setTimeout(()=>{this.current=0,this.isDone=!0},500)}createMultipleBoardingPasses(){this.isCreatingBoardingPasses=!0,setTimeout(()=>{this.isCreatingBoardingPasses=!1,this.isDone=!0},2e3)}currentPageDataChange(e){this.listOfDisplayData=e,this.refreshStatus()}refreshStatus(){this.isAllDisplayDataChecked=this.devicesList.every(e=>this.mapOfCheckedId[e.id]),this.isIndeterminate=this.devicesList.some(e=>this.mapOfCheckedId[e.id])&&!this.devicesList}checkAllData(e){this.devicesList.forEach(o=>this.mapOfCheckedId[o.id]=e)}currentCredentialsPageDataChange(e){this.listOfCredentialsDisplayData=e,this.refreshCredentialsStatus()}refreshCredentialsStatus(){this.isCredentialsAllDisplayDataChecked=this.usersByAccount.every(e=>this.mapOfCredentialsCheckedId[e.uid]),this.isCredentialsIndeterminate=this.usersByAccount.some(e=>this.mapOfCredentialsCheckedId[e.uid])&&!this.usersByAccount}checkCredentialsAllData(e){this.usersByAccount.forEach(o=>this.mapOfCredentialsCheckedId[o.uid]=e)}checkCredentialsValidBoardingPass(e){this.usersByAccount.forEach(o=>{this.customersService.getLatestValidUserPurchases(o.uid).pipe(et(1),E(n=>n.map(l=>{let h=l.payload.doc.id,z=l.payload.doc.data();return w({id:h},z)})),W(n=>{this.mapOfCredentialsCheckedId[o.uid]=n.length>0})).subscribe()})}downloadImg(){let e=document.getElementById("download")?.querySelector("canvas");if(e){this.download.nativeElement.href=e.toDataURL("image/png"),this.download.nativeElement.download="ng-zorro-antd";let o=new MouseEvent("click");this.download.nativeElement.dispatchEvent(o)}}createMultipleCredentials(){this.current++;let e=this.credentialForm.controls.validFrom.value||new Date,o=this.credentialForm.controls.validTo.value||new Date,n=this.credentialForm.controls.active.value||!1;this.userlevelAccess!="3"?(this.isCreatingCredentials=!0,this.selectedUsersForCredentials.forEach(l=>{this.customersService.createCredential(l.uid,l.studentId,e,o,n).then(h=>{})}),this.isCreatingCredentials=!1,this.isDone=!0):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}static{this.\u0275fac=function(o){return new(o||i)(D(ot),D(dt),D(Se),D(K))}}static{this.\u0275cmp=R({type:i,selectors:[["app-dashboard"]],viewQuery:function(o,n){if(o&1&&(We(ki,5),We(Fi,5)),o&2){let l;He(l=Ge())&&(n.download=l.first),He(l=Ge())&&(n.searchbar=l.first)}},decls:73,vars:37,consts:[["menu","nzDropdownMenu"],["menuCredentials","nzDropdownMenu"],["searchBar",""],["basicTable",""],["modalTitle",""],["modalContent",""],["modalFooter",""],["modalTitleProduct",""],["modalContentProduct",""],["modalContentBulk",""],["modalFooterBulk",""],["modalTitleBulkCredentials",""],["modalContentBulkCredentials",""],["modalFooterBulkCredentials",""],["modalTitleUserCredential",""],["modalContentCredential",""],["modalFooterCredential",""],["chatSetting","nzDropdownMenu"],["footerTemplate",""],["credentialFooterTemplate",""],["basicChatData",""],["messageCenterFooterTemplate",""],["credentials","nzDropdownMenu"],["download",""],["rowSelectionTable",""],[2,"margin","buttom 15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],["nz-button","","nzNoAnimation","","nz-dropdown","",2,"background-color","#4F6F57","color","#f6f3ea",3,"nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"hidden","click",4,"ngFor","ngForOf"],[1,"container-fluid","p-h-0"],[1,"chat-list"],[1,"chat-user-tool"],["nz-icon","","nzTheme","outline",1,"search-icon","p-r-10","font-size-20"],["placeholder","Buscar",3,"keyup"],[1,"chat-user-list"],[3,"nzData","nzShowPagination","nzPageSize"],[3,"click",4,"ngFor","ngForOf"],[1,"chat-content",3,"ngClass"],[1,"conversation"],[1,"conversation-wrapper"],["class","conversation-header justify-content-between",4,"ngIf"],[1,"conversation-body"],["style","width: 100% !important; overflow-y: scroll !important;",4,"ngIf"],[2,"background-color","white","color","#4F6F57",3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzContent","nzFooter"],["class","conversation-footer",4,"ngIf"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzWidth","nzTitle","nzContent","nzFooter"],["nz-menu-item","",3,"click","hidden"],[3,"click"],[1,"media","align-items-center"],["nzShape","square","nzSize","default","nzIcon","user",1,"shadow",2,"background-color","white","color","#4F6F57",3,"nzSrc"],[1,"p-l-15"],[1,"m-b-0"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436",4,"ngIf"],[1,"msg-overflow","m-b-0","text-muted","font-size-13"],[3,"nzStatus"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436"],[1,"conversation-header","justify-content-between"],[1,"m-r-20","d-md-none","d-block","text-dark","font-size-18","m-t-5",3,"routerLink"],["nz-icon","","type","left-circle","theme","outline"],["nzShape","square","nzIcon","user",1,"shadow",2,"background-color","white","color","#4F6F57",3,"nzSrc"],[1,"m-b-0","text-muted","font-size-13"],["nz-dropdown","","nzPlacement","bottomRight",1,"text-dark","font-size-18",3,"nzDropdownMenu","nzTrigger"],["nz-icon","","theme","outline"],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item","",3,"click"],[2,"width","100% !important","overflow-y","scroll !important"],["nzTitle","Pases"],[3,"nzData","nzPageSize","nzFooter","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Credenciales"],["nzTitle","Otras compras"],["nzTitle","Mensajes"],[3,"nzData","nzPageSize","nzFooter","nzLoadingDelay"],[2,"color","#4F6F57"],[4,"ngFor","ngForOf"],[3,"nzData","nzPageSize","nzFooter","nzLoading","nzLoadingDelay"],[3,"nzColor"],["nz-text","","nzType","secondary"],[3,"nzColor",4,"ngIf"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzTheme","outline"],["nz-button","",1,"m-r-10",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nz-icon",""],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nz-text","","nzType","secondary",4,"ngIf"],["nzPlain","","nzText","Mensaje"],["rows","4","nz-input","","placeholder","Mensaje",3,"ngModelChange","ngModel"],["nz-form","","nzLayout","horizontal",2,"background-color","white","color","#4F6F57",3,"ngSubmit","formGroup"],["formControlName","product_id","nzAllowClear","","nzPlaceHolder","Seleccionar producto / servicio",2,"width","320px",3,"ngModelChange"],["formControlName","routeId","nzAllowClear","","nzPlaceHolder","Selecciona la Operaci\xF3n",2,"width","320px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","stopId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",2,"width","320px",3,"ngModelChange"],["formControlName","round","nzAllowClear","","nzPlaceHolder","Selecciona Turno",2,"width","200px"],["nzValue","D\xEDa","nzLabel","D\xEDa"],["nzValue","Tarde","nzLabel","Tarde"],["nzValue","Noche","nzLabel","Noche"],[1,"row"],[1,"col-md-6"],["formControlName","amount",3,"ngModelChange","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["formControlName","is_courtesy","nzCheckedChildren","Si","nzUnCheckedChildren","No",3,"ngModelChange"],["nz-checkbox","","formControlName","active"],["formControlName","validFrom"],["formControlName","validTo"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","nzLoading"],["nz-form","","nzLayout","horizontal",3,"ngSubmit","formGroup"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngIf"],[1,"conversation-footer"],[2,"width","100% !important","overflow-y","scroll !important",3,"nzSelectedIndex"],["nzTitle","Detalles"],["nzBordered","","nzSize","small"],["nzTitle","Producto"],["nzTitle","Pagado"],["nzStatus","success","nzText","Si",4,"ngIf"],["nzStatus","processing","nzText","Parcial",4,"ngIf"],["nzStatus","warning","nzText","No",4,"ngIf"],["nzTitle","Activo"],["nzStatus","processing","nzText","Si",4,"ngIf"],["nzTitle","Fecha de compra"],["nzTitle","M\xE9todo de pago",4,"ngIf"],["nzTitle","Pase Cortes\xEDa"],["nzTitle","Valido desde"],["nzTitle","Valido hasta"],[3,"ngModel","ngModelChange",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEst\xE1s seguro de modificar la vigencia?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],["nzTitle","Servicio"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","lastPurchase!.isTaskIn ? '#52c41a' : '#595959'"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","lastPurchase!.isTaskOut ? '#52c41a' : '#595959'"],["nzTitle","Precio"],["nz-popconfirm","","nzPopconfirmTitle","\xBFVas a recibir dinero?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],[3,"ngModel","nzMin","nzMax","nzStep","nzFormatter","nzParser","ngModelChange",4,"ngIf"],["nzTitle","Autorizaci\xF3n"],["nzTitle","Operaci\xF3n"],["nzTitle","Estaci\xF3n"],["nzTitle","Turno"],["nzTitle","Informaci\xF3n de la compra"],["nzTitle","Historial de Uso"],[3,"userId","boardingPassId"],["nzTitle","C\xF3digo QR"],["nzValue","currentUserSelected.uid-lastPurchase!.idBoardingPass"],["nz-button","","nzType","primary",3,"click"],["nzTitle","Soporte"],["nzStatus","success","nzText","Si"],["nzStatus","processing","nzText","Parcial"],["nzStatus","warning","nzText","No"],["nzStatus","processing","nzText","Si"],["nzTitle","M\xE9todo de pago"],[3,"ngModelChange","ngModel"],["nz-popconfirm","","nzPopconfirmTitle","\xBFEst\xE1s seguro de modificar la vigencia?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel"],["nz-popconfirm","","nzPopconfirmTitle","\xBFVas a recibir dinero?","nzCancelText","Cancelar","nzOkText","Si","nzPopconfirmPlacement","bottom","nzIcon","edit",3,"nzOnConfirm","nzOnCancel"],[3,"ngModelChange","ngModel","nzMin","nzMax","nzStep","nzFormatter","nzParser"],["nzSize","small",3,"nzCurrent"],["nzTitle","Pase","nzDescription","Crear el pase."],["nzTitle","Empresas","nzDescription","Seleccionar las Empresas."],["nzTitle","Confirmar","nzDescription","Validar la creaci\xF3n."],[1,"steps-content","overflow-auto"],[4,"ngIf"],["nzShowSizeChanger","",3,"nzCurrentPageDataChange","nzData","nzSize"],["nzShowCheckbox","","nzShowRowSelection","",3,"nzCheckedChange","nzSelections","nzChecked","nzIndeterminate"],["nzShowCheckbox","",3,"nzCheckedChange","nzChecked"],[1,"steps-action"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"disabled","click",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"nzLoading","click",4,"ngIf"],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"click",4,"ngIf"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","disabled"],["nzTitle","Credencial","nzDescription","Crear la credencial."],["nzTitle","Usuarios","nzDescription","Seleccionar los usuarios."],["nz-button","","style"," background-color: #4F6F57; color: #f6f3ea;",3,"disabled","nzLoading","click",4,"ngIf"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click","disabled","nzLoading"]],template:function(o,n){if(o&1){let l=v();t(0,"div",25)(1,"div",26)(2,"nz-page-header",27)(3,"nz-page-header-title"),s(4,"Empresas"),r(),t(5,"nz-page-header-subtitle"),s(6,"Listado general"),r(),t(7,"nz-page-header-extra")(8,"button",28),s(9," M\xFAltiples pases "),r(),t(10,"nz-dropdown-menu",null,0)(12,"ul",29),g(13,Li,2,2,"li",30),r()(),t(14,"button",28),s(15," M\xFAltiples credenciales "),r(),t(16,"nz-dropdown-menu",null,1)(18,"ul",29),g(19,Oi,2,2,"li",30),r()()()()(),t(20,"div",31)(21,"div",32)(22,"div",33),p(23,"i",34),t(24,"input",35,2),f("keyup",function(){u(l);let z=b(25);return _(n.getItems(z.value))}),r()(),t(26,"div",36)(27,"nz-table",37,3)(29,"tbody"),g(30,Ai,16,7,"tr",38),r()()()(),t(31,"div",39)(32,"div",40)(33,"div",41),g(34,$i,23,11,"div",42),t(35,"div",43),g(36,sn,24,7,"nz-tabset",44),t(37,"nz-modal",45),F("nzVisibleChange",function(z){return u(l),k(n.isVisible,z)||(n.isVisible=z),_(z)}),f("nzOnCancel",function(){return u(l),_(n.handleCancel())}),g(38,ln,1,0,"ng-template",null,4,y)(40,pn,49,9,"ng-template",null,5,y)(42,un,4,1,"ng-template",null,6,y),r(),t(44,"nz-modal",46),F("nzVisibleChange",function(z){return u(l),k(n.isProductVisible,z)||(n.isProductVisible=z),_(z)}),f("nzOnCancel",function(){return u(l),_(n.handleCancelProduct())}),g(45,_n,1,0,"ng-template",null,7,y)(47,gn,32,7,"ng-template",null,8,y)(49,zn,4,1,"ng-template",null,6,y),r()(),g(51,Pn,61,41,"div",47),r()()()()(),t(52,"nz-modal",46),F("nzVisibleChange",function(z){return u(l),k(n.isVisibleBulk,z)||(n.isVisibleBulk=z),_(z)}),f("nzOnCancel",function(){return u(l),_(n.handleCancel())}),g(53,kn,1,0,"ng-template",null,4,y)(55,jn,9,4,"ng-template",null,9,y)(57,Xn,5,4,"ng-template",null,10,y),r(),t(59,"nz-modal",48),F("nzVisibleChange",function(z){return u(l),k(n.isVisibleBulkCredentials,z)||(n.isVisibleBulkCredentials=z),_(z)}),f("nzOnCancel",function(){return u(l),_(n.handleCancel())}),g(60,Jn,1,0,"ng-template",null,11,y)(62,rr,10,5,"ng-template",null,12,y)(64,cr,5,4,"ng-template",null,13,y),r(),t(66,"nz-modal",48),F("nzVisibleChange",function(z){return u(l),k(n.isModalCredentialVisible,z)||(n.isModalCredentialVisible=z),_(z)}),f("nzOnCancel",function(){return u(l),_(n.handleCancel())}),g(67,dr,1,0,"ng-template",null,14,y)(69,mr,18,1,"ng-template",null,15,y)(71,pr,3,2,"ng-template",null,16,y),r()}if(o&2){let l=b(11),h=b(17),z=b(28),V=b(39),Ce=b(41),M=b(43),_e=b(46),he=b(48),Qe=b(56),Xe=b(58),Ct=b(63),qe=b(65),Je=b(70),Ye=b(72);a(2),c("nzGhost",!1),a(6),c("nzDropdownMenu",l),a(5),c("ngForOf",n.customersList),a(),c("nzDropdownMenu",h),a(5),c("ngForOf",n.customersList),a(8),c("nzData",n.devicesList)("nzShowPagination",!1)("nzPageSize",10),a(3),c("ngForOf",z.data),a(),c("ngClass",B(35,Mi,n.isContentOpen)),a(3),c("ngIf",n.isUserSelected),a(2),c("ngIf",n.isUserSelected),a(),P("nzVisible",n.isVisible),c("nzTitle",V)("nzContent",Ce)("nzFooter",M),a(7),P("nzVisible",n.isProductVisible),c("nzTitle",_e)("nzContent",he)("nzFooter",M),a(7),c("ngIf",n.isBoardingPassSelected),a(),P("nzVisible",n.isVisibleBulk),c("nzTitle","Emitir m\xFAltiples pases")("nzContent",Qe)("nzFooter",Xe),a(7),P("nzVisible",n.isVisibleBulkCredentials),c("nzWidth",800)("nzTitle","Emitir m\xFAltiples credenciales")("nzContent",Ct)("nzFooter",qe),a(7),P("nzVisible",n.isModalCredentialVisible),c("nzWidth",800)("nzTitle","Emitir credencial")("nzContent",Je)("nzFooter",Ye)}},dependencies:[it,q,H,Gt,$,te,ee,ne,ie,oe,re,be,ei,Qt,Oe,Me,Ne,Xt,Ae,Le,Ue,Jt,we,ae,ai,li,si,ci,ht,mi,di,de,ce,Ve,Ie,me,Ht,le,j,se,De,mt,pt,ut,Re,pe,ue,rt,X,xe,G,Q,J,Y,Rt,ke,Pe,ri,_t,pi,Ot,nt],styles:[".conversation-footer[_ngcontent-%COMP%]{height:450px!important}[_nghost-%COMP%]{background-color:#fff;color:#4f6f57}.ant-modal-content[_ngcontent-%COMP%]{background-color:#fff;color:#4f6f57}.ant-modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#4f6f57;color:#f6f3ea}"]})}}return i})();var Si=(()=>{class i{constructor(){this.isMenuFolded=!1,this.isSideNavDark=!1,this.headerColor="default",this.colorConfig={colors:{magenta:"#eb2f96",magentaLight:"rgba(235, 47, 150, 0.05)",red:"#de4436",redLight:"rgba(222, 68, 54, 0.05)",volcano:"#fa541c",volcanoLight:"rgba(250, 84, 28, 0.05)",orange:"#fa8c16",orangeLight:"rgba(250, 140, 22, 0.1)",gold:"#ffc107",goldLight:"rgba(255, 193, 7, 0.1)",lime:"#a0d911",limeLight:"rgba(160, 217, 17, 0.1)",green:"#52c41a",greenLight:"rgba(82, 196, 26, 0.1)",cyan:"#05c9a7",cyanLight:"rgba(0, 201, 167, 0.1)",blue:"#3f87f5",blueLight:"rgba(63, 135, 245, 0.15)",geekBlue:"#2f54eb",geekBlueLight:"rgba(47, 84, 235, 0.1)",purple:"#886cff",purpleLight:"rgba(136, 108, 255, 0.1)",gray:"#53535f",grayLight:"#77838f",grayLighter:"#ededed",grayLightest:"#f1f2f3",border:"#edf2f9",white:"#ffffff",dark:"#2a2a2a",transparent:"rgba(255, 255, 255, 0)"}},this.isMenuFoldedActived=new $e(this.isMenuFolded),this.isMenuFoldedChanges=this.isMenuFoldedActived.asObservable(),this.isSideNavDarkActived=new $e(this.isSideNavDark),this.isSideNavDarkChanges=this.isSideNavDarkActived.asObservable(),this.isExpandActived=new $e(!1),this.isExpandChanges=this.isExpandActived.asObservable(),this.currentHeaderColor=new $e(this.headerColor),this.selectedHeaderColor=this.currentHeaderColor.asObservable()}get(){return this.colorConfig}toggleFold(e){this.isMenuFoldedActived.next(e)}toogleSideNavDark(e){this.isSideNavDarkActived.next(e)}toggleExpand(e){this.isExpandActived.next(e)}changeHeaderColor(e){this.currentHeaderColor.next(e)}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275prov=tt({token:i,factory:i.\u0275fac})}}return i})();var bi=(()=>{class i{constructor(e){this.http=e}getFileManagerJson(){return!0}static{this.\u0275fac=function(o){return new(o||i)(Ft(Ut))}}static{this.\u0275prov=tt({token:i,factory:i.\u0275fac})}}return i})();var fr=["dropdown"],gr=i=>({"nav-open":i}),yi=i=>({"list-view":i}),zr=i=>({"details-open":i}),wi=i=>({active:i}),Cr=i=>({"border-bottom":i});function vr(i,m){if(i&1){let e=v();t(0,"i",53),f("click",function(){u(e);let n=d();return _(n.navToggler())}),r()}}function xr(i,m){if(i&1){let e=v();t(0,"i",54),f("click",function(){u(e);let n=d();return _(n.navToggler())}),r()}}function Sr(i,m){if(i&1){let e=v();t(0,"a",55),f("click",function(){u(e);let n=d();return _(n.changeView())}),p(1,"i",56),r()}}function br(i,m){if(i&1){let e=v();t(0,"a",57),f("click",function(){u(e);let n=d();return _(n.changeView())}),p(1,"i",58),r()}}function yr(i,m){if(i&1){let e=v();t(0,"div",60),f("click",function(){u(e);let n=d().$implicit,l=d();return _(l.selectFile(l.selected=n.name))})("contextmenu",function(n){u(e);let l=d().$implicit,h=d(),z=b(64);return _(h.contextMenu(n,z,h.selected=l.name))}),t(1,"div",61)(2,"div",62),p(3,"i",63),r(),t(4,"div")(5,"h6",64),s(6),r(),t(7,"span",65),s(8),r()()()()}if(i&2){let e=d().$implicit,o=d();c("ngClass",B(4,wi,o.selectedFile==e.name)),a(3),c("twoToneColor",o.colorGold),a(3),x(e.name),a(2),x(e.size)}}function wr(i,m){if(i&1&&(fe(0),g(1,yr,9,6,"div",59),ge()),i&2){let e=m.$implicit;a(),c("ngIf",e.type=="folder")}}function Er(i,m){if(i&1&&p(0,"i",76),i&2){let e=d(3);c("twoToneColor",e.colorRed)}}function Tr(i,m){if(i&1&&p(0,"i",77),i&2){let e=d(3);c("twoToneColor",e.colorBlue)}}function Vr(i,m){if(i&1&&p(0,"i",78),i&2){let e=d(3);c("twoToneColor",e.colorCyan)}}function Ir(i,m){if(i&1&&p(0,"i",79),i&2){let e=d(3);c("twoToneColor",e.colorVolcano)}}function Dr(i,m){if(i&1&&p(0,"i",80),i&2){let e=d(3);c("twoToneColor",e.colorPurple)}}function Pr(i,m){if(i&1&&p(0,"img",81),i&2){let e=d(2).$implicit;c("src",e.url,vt)}}function kr(i,m){if(i&1){let e=v();t(0,"div",67),f("click",function(){u(e);let n=d().$implicit,l=d();return _(l.selectFile(l.selected=n.name))})("contextmenu",function(n){u(e);let l=d().$implicit,h=d(),z=b(64);return _(h.contextMenu(n,z,h.selected=l.name))}),t(1,"div",68),g(2,Er,1,1,"i",69)(3,Tr,1,1,"i",70)(4,Vr,1,1,"i",71)(5,Ir,1,1,"i",72)(6,Dr,1,1,"i",73)(7,Pr,1,1,"img",74),r(),t(8,"div",75)(9,"h6",64),s(10),r(),t(11,"span",65),s(12),r()()()}if(i&2){let e=d().$implicit,o=d();c("ngClass",B(9,wi,o.selectedFile==e.name)),a(2),c("ngIf",e.type=="pdf"),a(),c("ngIf",e.type=="doc"),a(),c("ngIf",e.type=="xls"),a(),c("ngIf",e.type=="ppt"),a(),c("ngIf",e.type=="txt"),a(),c("ngIf",e.type=="image"),a(3),x(e.name),a(2),x(e.size)}}function Fr(i,m){if(i&1&&(fe(0),g(1,kr,13,11,"div",66),ge()),i&2){let e=m.$implicit;a(),c("ngIf",e.type!=="folder")}}function Mr(i,m){if(i&1&&p(0,"i",63),i&2){let e=d(4);c("twoToneColor",e.colorGold)}}function Nr(i,m){if(i&1&&p(0,"i",76),i&2){let e=d(4);c("twoToneColor",e.colorRed)}}function Lr(i,m){if(i&1&&p(0,"i",77),i&2){let e=d(4);c("twoToneColor",e.colorBlue)}}function Or(i,m){if(i&1&&p(0,"i",78),i&2){let e=d(4);c("twoToneColor",e.colorCyan)}}function Ur(i,m){if(i&1&&p(0,"i",79),i&2){let e=d(4);c("twoToneColor",e.colorVolcano)}}function Ar(i,m){if(i&1&&p(0,"i",80),i&2){let e=d(4);c("twoToneColor",e.colorPurple)}}function Rr(i,m){if(i&1&&(t(0,"div",102),g(1,Mr,1,1,"i",103)(2,Nr,1,1,"i",69)(3,Lr,1,1,"i",70)(4,Or,1,1,"i",71)(5,Ur,1,1,"i",72)(6,Ar,1,1,"i",73),r()),i&2){let e=d(2).$implicit;a(),c("ngIf",e.type=="folder"),a(),c("ngIf",e.type=="pdf"),a(),c("ngIf",e.type=="doc"),a(),c("ngIf",e.type=="xls"),a(),c("ngIf",e.type=="ppt"),a(),c("ngIf",e.type=="txt")}}function Br(i,m){if(i&1&&p(0,"img",104),i&2){let e=d(2).$implicit;c("src",e.url,vt)}}function qr(i,m){i&1&&p(0,"nz-avatar",119)}function $r(i,m){i&1&&p(0,"nz-avatar",120)}function jr(i,m){i&1&&p(0,"nz-avatar",121)}function Wr(i,m){i&1&&p(0,"nz-avatar",122)}function Hr(i,m){i&1&&p(0,"nz-avatar",123)}function Gr(i,m){if(i&1&&(t(0,"li",113),g(1,qr,1,0,"nz-avatar",114)(2,$r,1,0,"nz-avatar",115)(3,jr,1,0,"nz-avatar",116)(4,Wr,1,0,"nz-avatar",117)(5,Hr,1,0,"nz-avatar",118),t(6,"span",14),s(7),r()()),i&2){let e=m.$implicit;a(),c("ngIf",e.substr(e.length-3)=="pdf"),a(),c("ngIf",e.substr(e.length-3)=="doc"),a(),c("ngIf",e.substr(e.length-3)=="xls"),a(),c("ngIf",e.substr(e.length-3)=="ppt"),a(),c("ngIf",e.substr(e.length-3)=="jpg"||e.substr(e.length-3)=="png"),a(2),x(e)}}function Qr(i,m){if(i&1&&(t(0,"div",105)(1,"div",106)(2,"div",107),p(3,"nz-avatar",108),t(4,"div",14)(5,"span",109),s(6),r(),t(7,"span"),s(8),r(),t(9,"span"),s(10),r(),t(11,"div",110),s(12),r()()(),t(13,"ul",111),g(14,Gr,8,6,"li",112),r()()()),i&2){let e=m.$implicit,o=m.last;a(),c("ngClass",B(8,Cr,!o)),a(2),c("nzSrc",e.avatar),a(3),S("",e.name," "),a(2),S("",e.action," "),a(2),N("",e.files.length," ",e.text,""),a(2),S(" ",e.time," "),a(2),c("ngForOf",e.files)}}function Xr(i,m){if(i&1){let e=v();t(0,"div")(1,"div",83)(2,"h5",84),s(3),r(),t(4,"div",85)(5,"a",86),f("click",function(){u(e);let n=d(2);return _(n.closeContentDetails())}),p(6,"i",87),r()()(),t(7,"div",88),g(8,Rr,7,6,"div",89)(9,Br,1,1,"img",90),r(),t(10,"nz-tabset")(11,"nz-tab",91)(12,"div",92)(13,"dl",93)(14,"dt",94),s(15,"Type:"),r(),t(16,"dd",95),s(17),r()(),t(18,"dl",93)(19,"dt",94),s(20,"Size:"),r(),t(21,"dd",95),s(22),r()(),t(23,"dl",93)(24,"dt",94),s(25,"Modified:"),r(),t(26,"dd",95),s(27),r()(),t(28,"dl",93)(29,"dt",94),s(30,"Created:"),r(),t(31,"dd",95),s(32),r()(),t(33,"dl",93)(34,"dt",94),s(35,"Author:"),r(),t(36,"dd",95),s(37),r()()(),t(38,"div",96)(39,"span",97),s(40,"Add Description"),r(),t(41,"button",98),p(42,"i",45),r()()(),t(43,"nz-tab",99)(44,"div",100),g(45,Qr,15,10,"div",101),r()()()()}if(i&2){let e=d().$implicit;a(3),x(e.name),a(5),c("ngIf",e.type!=="image"),a(),c("ngIf",e.type=="image"),a(8),x(e.type),a(5),x(e.size),a(5),x(e.modifiedDate),a(5),x(e.date),a(5),x(e.author),a(8),c("ngForOf",e.activity)}}function Jr(i,m){if(i&1&&(fe(0),g(1,Xr,46,9,"div",82),ge()),i&2){let e=m.$implicit,o=d();a(),c("ngIf",o.selectedFile==e.name)}}function Yr(i,m){i&1&&(t(0,"div",124)(1,"div",125),p(2,"img",126),t(3,"p",127),s(4,"Select folder or file to view details"),r()()())}var la=(()=>{class i{constructor(e,o){this.colorConfig=e,this.fileManagerSvc=o,this.selected=null,this.themeColors=this.colorConfig.get().colors,this.selectedFile="",this.listView=!1,this.isDetailsOpen=!1,this.isNavOpen=!1,this.colorRed=this.themeColors.red,this.colorBlue=this.themeColors.blue,this.colorCyan=this.themeColors.cyan,this.colorGold=this.themeColors.gold,this.colorVolcano=this.themeColors.volcano,this.colorPurple=this.themeColors.purple}ngOnInit(){}changeView(){this.listView=!this.listView}contextMenu(e,o,n){e.preventDefault(),this.selectedFile=o,this.isDetailsOpen=!0,this.dropdown.nzVisible=!0}selectFile(e){this.selectedFile=e,this.isDetailsOpen=!0}unselectFile(){this.selectedFile=""}close(){}closeContentDetails(){this.isDetailsOpen=!1}navToggler(){this.isNavOpen=!this.isNavOpen}static{this.\u0275fac=function(o){return new(o||i)(D(Si),D(bi))}}static{this.\u0275cmp=R({type:i,selectors:[["app-payments"]],viewQuery:function(o,n){if(o&1&&We(fr,5),o&2){let l;He(l=Ge())&&(n.dropdown=l.first)}},decls:95,vars:22,consts:[["contextDropdownTpl","nzDropdownMenu"],[1,"file-manager-wrapper"],[1,"file-manager-nav",3,"ngClass"],[1,"d-flex","flex-column","justify-content-between","h-100"],[1,"p-t-20"],["nz-menu","",3,"nzMode"],["nz-menu-item",""],["nz-icon","","type","folder-open","theme","outline",1,"text-primary"],["nz-icon","","type","clock-circle","theme","outline",1,"text-primary"],["nz-icon","","type","share-alt","theme","outline",1,"text-primary"],["nz-icon","","type","star","theme","outline",1,"text-primary"],["nz-icon","","type","delete","theme","outline",1,"text-primary"],[1,"m-b-30","m-h-25"],[1,"d-flex","justify-content-between"],[1,"text-gray"],["nzSize","small",3,"nzPercent"],[1,"m-t-15"],["nz-button","","nzBlock","",2,"background-color","#4F6F57","color","#f6f3ea"],["nz-icon","","type","upload","theme","outline"],[1,"m-l-5"],[1,"file-manager-content"],[1,"file-manager-content-header"],[1,"file-manager-search"],["nz-icon","","type","menu-fold","theme","outline","class","toggle-icon",3,"click",4,"ngIf"],["nz-icon","","type","menu-unfold","theme","outline","class","toggle-icon",3,"click",4,"ngIf"],["nz-icon","","type","search","theme","outline",1,"search-icon"],["placeholder","Search..."],[1,"file-manager-tools"],[1,"list-inline","m-b-0"],[1,"list-inline-item"],["zAction","/api/posts/"],["nz-tooltip","","nzPlacement","bottom","nzTitle","Add Files",1,"text-dark"],["nz-icon","","type","file-add","theme","outline"],["class","text-dark","nz-tooltip","","nzPlacement","bottom","nzTitle","List View",3,"click",4,"ngIf"],["class","text-dark","nz-tooltip","","nzPlacement","bottom","nzTitle","Column View",3,"click",4,"ngIf"],["nz-tooltip","","nzPlacement","bottom","nzTitle","Setting",1,"text-dark"],["nz-icon","","type","setting","theme","outline"],[1,"file-manager-content-body"],[1,"file-manager-content-files"],[1,"unselect-bg",3,"click"],[1,"relative"],[1,"file-wrapper","m-t-20",3,"ngClass"],[4,"ngFor","ngForOf"],["nz-menu","","nzInDropDown","",3,"nzClick"],["nz-icon","","type","user-add","theme","outline"],["nz-icon","","type","edit","theme","outline"],["nz-icon","","type","star","theme","outline"],["nz-menu-divider",""],["nz-icon","","type","download","theme","outline"],["nz-icon","","type","delete","theme","outline"],[1,"m-t-60","relative"],[1,"file-manager-content-details",3,"ngClass"],["class","content-details-no-data",4,"ngIf"],["nz-icon","","type","menu-fold","theme","outline",1,"toggle-icon",3,"click"],["nz-icon","","type","menu-unfold","theme","outline",1,"toggle-icon",3,"click"],["nz-tooltip","","nzPlacement","bottom","nzTitle","List View",1,"text-dark",3,"click"],["nz-icon","","type","bars","theme","outline"],["nz-tooltip","","nzPlacement","bottom","nzTitle","Column View",1,"text-dark",3,"click"],["nz-icon","","type","appstore","theme","outline"],["class","file",3,"ngClass","click","contextmenu",4,"ngIf"],[1,"file",3,"click","contextmenu","ngClass"],[1,"media","align-items-center"],[1,"m-r-15","font-size-30"],["nz-icon","","type","folder-open","theme","twotone",3,"twoToneColor"],[1,"mb-0"],[1,"font-size-13","text-muted"],["class","file vertical",3,"ngClass","click","contextmenu",4,"ngIf"],[1,"file","vertical",3,"click","contextmenu","ngClass"],[1,"font-size-40"],["nz-icon","","type","file-pdf","theme","twotone",3,"twoToneColor",4,"ngIf"],["nz-icon","","type","file-word","theme","twotone",3,"twoToneColor",4,"ngIf"],["nz-icon","","type","file-excel","theme","twotone",3,"twoToneColor",4,"ngIf"],["nz-icon","","type","file-ppt","theme","twotone",3,"twoToneColor",4,"ngIf"],["nz-icon","","type","file-text","theme","twotone",3,"twoToneColor",4,"ngIf"],["alt","",3,"src",4,"ngIf"],[1,"m-t-10"],["nz-icon","","type","file-pdf","theme","twotone",3,"twoToneColor"],["nz-icon","","type","file-word","theme","twotone",3,"twoToneColor"],["nz-icon","","type","file-excel","theme","twotone",3,"twoToneColor"],["nz-icon","","type","file-ppt","theme","twotone",3,"twoToneColor"],["nz-icon","","type","file-text","theme","twotone",3,"twoToneColor"],["alt","",3,"src"],[4,"ngIf"],[1,"p-h-25","p-v-15","d-flex","justify-content-between","align-items-center","border-bottom"],[1,"m-b-0"],[1,"content-details-close"],[1,"text-dark",3,"click"],["nz-icon","","type","right-circle","theme","outline"],[1,"m-b-10"],["class","d-flex justify-content-around display-3 align-items-center content-details-file",4,"ngIf"],["class","img-fluid","alt","",3,"src",4,"ngIf"],["nzTitle","Details"],[1,"p-h-25","p-v-15"],[1,"row","m-b-10"],[1,"col-5","text-dark"],[1,"col-7"],[1,"border-top","border-bottom","p-h-25","p-v-10","d-flex","align-items-center"],[1,"text-dark","font-weight-semibold","m-r-10"],["nz-button","","nzShape","circle","nzGhost","",2,"background-color","#4F6F57","color","#f6f3ea"],["nzTitle","Activity"],[1,"p-h-20","p-v-15"],["class","m-b-25",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-around","display-3","align-items-center","content-details-file"],["nz-icon","","type","folder-open","theme","twotone",3,"twoToneColor",4,"ngIf"],["alt","",1,"img-fluid",3,"src"],[1,"m-b-25"],[1,"p-b-10",3,"ngClass"],[1,"d-flex","align-items-center"],["nzIcon","user",1,"m-r-10",3,"nzSrc"],[1,"text-dark","font-weight-semibold"],[1,"text-muted","font-size-13"],[1,"list-unstyled","m-l-50","m-t-15"],["class","m-b-15",4,"ngFor","ngForOf"],[1,"m-b-15"],["nzIcon","file-pdf","nzSize","small","class","ant-avatar-red m-r-10",4,"ngIf"],["nzIcon","file-word","nzSize","small","class","ant-avatar-blue m-r-10",4,"ngIf"],["nzIcon","file-excel","nzSize","small","class","ant-avatar-cyan m-r-10",4,"ngIf"],["nzIcon","file-ppt","nzSize","small","class","ant-avatar-volcano m-r-10",4,"ngIf"],["nzIcon","picture","nzSize","small","class","ant-avatar-purple m-r-10",4,"ngIf"],["nzIcon","file-pdf","nzSize","small",1,"ant-avatar-red","m-r-10"],["nzIcon","file-word","nzSize","small",1,"ant-avatar-blue","m-r-10"],["nzIcon","file-excel","nzSize","small",1,"ant-avatar-cyan","m-r-10"],["nzIcon","file-ppt","nzSize","small",1,"ant-avatar-volcano","m-r-10"],["nzIcon","picture","nzSize","small",1,"ant-avatar-purple","m-r-10"],[1,"content-details-no-data"],[1,"text-center"],["src","assets/images/others/file-manager.png","alt","",1,"img-fluid","opacity-04"],[1,"text-muted","m-t-20"]],template:function(o,n){if(o&1){let l=v();t(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"ul",5)(5,"li",6),p(6,"i",7),t(7,"span"),s(8,"My Files"),r()(),t(9,"li",6),p(10,"i",8),t(11,"span"),s(12,"Recent"),r()(),t(13,"li",6),p(14,"i",9),t(15,"span"),s(16,"Shared with me"),r()(),t(17,"li",6),p(18,"i",10),t(19,"span"),s(20,"Favorite"),r()(),t(21,"li",6),p(22,"i",11),t(23,"span"),s(24,"Trash"),r()()()(),t(25,"div",12)(26,"div",13)(27,"span",14),s(28,"Free Space"),r(),t(29,"span",14),s(30,"30%"),r()(),p(31,"nz-progress",15),t(32,"div",16)(33,"button",17),p(34,"i",18),t(35,"span",19),s(36,"Upgrade"),r()()()()()(),t(37,"div",20)(38,"div",21)(39,"div",22),g(40,vr,1,0,"i",23)(41,xr,1,0,"i",24),p(42,"i",25)(43,"input",26),r(),t(44,"div",27)(45,"ul",28)(46,"li",29)(47,"nz-upload",30)(48,"a",31),p(49,"i",32),r()()(),t(50,"li",29),g(51,Sr,2,0,"a",33)(52,br,2,0,"a",34),r(),t(53,"li",29)(54,"a",35),p(55,"i",36),r()()()()(),t(56,"div",37)(57,"div",38)(58,"div",39),f("click",function(){return u(l),_(n.unselectFile())}),r(),t(59,"h5",40),s(60,"Folders"),r(),t(61,"div",41),g(62,wr,2,1,"ng-container",42),t(63,"nz-dropdown-menu",null,0)(65,"ul",43),f("nzClick",function(){return u(l),_(n.close())}),t(66,"li",6),p(67,"i",44),t(68,"span",19),s(69,"Share"),r()(),t(70,"li",6),p(71,"i",45),t(72,"span",19),s(73,"Rename"),r()(),t(74,"li",6),p(75,"i",46),t(76,"span",19),s(77,"Mark as favorite"),r()(),p(78,"li",47),t(79,"li",6),p(80,"i",48),t(81,"span",19),s(82,"Download"),r()(),p(83,"li",47),t(84,"li",6),p(85,"i",49),t(86,"span",19),s(87,"Remove"),r()()()()(),t(88,"h5",50),s(89,"Files"),r(),t(90,"div",41),g(91,Fr,2,1,"ng-container",42),r()(),t(92,"div",51),g(93,Jr,2,1,"ng-container",42)(94,Yr,5,0,"div",52),r()()()()}o&2&&(a(),c("ngClass",B(14,gr,n.isNavOpen)),a(3),c("nzMode","inline"),a(27),c("nzPercent",70),a(9),c("ngIf",n.isNavOpen),a(),c("ngIf",!n.isNavOpen),a(10),c("ngIf",!n.listView),a(),c("ngIf",n.listView),a(9),c("ngClass",B(16,yi,n.listView)),a(),c("ngForOf",n.files),a(28),c("ngClass",B(18,yi,n.listView)),a(),c("ngForOf",n.files),a(),c("ngClass",B(20,zr,n.isDetailsOpen)),a(),c("ngForOf",n.files),a(),c("ngIf",n.selectedFile==""))},dependencies:[it,q,H,$,ae,ii,de,ce,ye,me,at,le,j,se,ke,Pe,ti]})}}return i})();var Pt=Ke(ct());var Ei=(i,m)=>["/customers/routes/edit/",i,m];function Zr(i,m){i&1&&p(0,"span",23)}function eo(i,m){if(i&1&&p(0,"nz-option",34),i&2){let e=m.$implicit;c("nzValue",e)("nzLabel",e)}}function to(i,m){if(i&1&&p(0,"nz-option",34),i&2){let e=m.$implicit;c("nzValue",e)("nzLabel",e)}}function io(i,m){if(i&1&&p(0,"nz-option",35),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.id)}}function no(i,m){if(i&1){let e=v();t(0,"form",24)(1,"nz-form-item")(2,"nz-form-label"),s(3,"Nombre de la Operaci\xF3n"),r(),t(4,"nz-form-control"),p(5,"input",25),r()(),t(6,"nz-form-item")(7,"nz-form-label"),s(8,"Descripci\xF3n"),r(),t(9,"nz-form-control"),p(10,"textarea",26),r()(),t(11,"nz-form-item")(12,"nz-form-label"),s(13,"Horarios Entradas (Opcional)"),r(),t(14,"nz-form-control")(15,"nz-select",27),g(16,eo,1,2,"nz-option",28),r()()(),t(17,"nz-form-item")(18,"nz-form-label"),s(19,"Horarios Salidas (Opcional)"),r(),t(20,"nz-form-control")(21,"nz-select",29),g(22,to,1,2,"nz-option",28),r()()(),t(23,"div",30)(24,"div",31)(25,"nz-form-item")(26,"nz-form-label"),s(27,"Empresa"),r(),t(28,"nz-form-control")(29,"nz-form-control")(30,"nz-select",32),f("ngModelChange",function(n){u(e);let l=d();return _(l.setCustomerName(n))}),g(31,io,1,2,"nz-option",33),r()()()()()()()}if(i&2){let e=d();c("formGroup",e.objectForm),a(16),c("ngForOf",e.timeOptions),a(6),c("ngForOf",e.timeOptions),a(9),c("ngForOf",e.accountsList)}}function ro(i,m){if(i&1){let e=v();t(0,"li",51),f("click",function(){u(e);let n=d().$implicit,l=d(2);return _(l.toggleActive(n))}),p(1,"i",59),t(2,"span",41),s(3,"Activar"),r()()}}function oo(i,m){if(i&1){let e=v();t(0,"li",51),f("click",function(){u(e);let n=d().$implicit,l=d(2);return _(l.toggleActive(n))}),p(1,"i",59),t(2,"span",41),s(3,"Desactivar"),r()()}}function ao(i,m){i&1&&(t(0,"nz-tag",60),s(1,"Activa"),r()),i&2&&c("nzColor","blue")}function so(i,m){i&1&&(t(0,"nz-tag",60),s(1,"Inactiva"),r()),i&2&&c("nzColor","cyan")}function lo(i,m){if(i&1){let e=v();t(0,"div",37)(1,"nz-card")(2,"div",38)(3,"div",39),p(4,"nz-avatar",40),t(5,"div",41)(6,"h5",42),s(7),r(),t(8,"span",43),s(9),r()()(),t(10,"div")(11,"a",44),p(12,"i",45),r(),t(13,"nz-dropdown-menu",null,4)(15,"ul",46),g(16,ro,4,0,"li",47)(17,oo,4,0,"li",47),t(18,"li",48)(19,"a",49),p(20,"i",50),t(21,"span",41),s(22,"Editar"),r()()(),t(23,"li",51),f("click",function(){let n=u(e).$implicit,l=d(2);return _(l.duplicate(n))}),p(24,"i",52),t(25,"span",41),s(26,"Duplicar"),r()(),p(27,"li",53),t(28,"li",51),f("click",function(){let n=u(e).$implicit,l=d(2);return _(l.deleteRoute(n))}),p(29,"i",54),t(30,"span",41),s(31,"Eliminar"),r()()()()()(),t(32,"p",55),s(33),r(),t(34,"div",56)(35,"div",57)(36,"div"),g(37,ao,2,1,"nz-tag",58)(38,so,2,1,"nz-tag",58),r()()()()()}if(i&2){let e=m.$implicit,o=b(14);a(4),c("nzSize",40)("nzSrc",e.imageUrl),a(3),x(e.name),a(2),x(e.customerName),a(2),c("nzDropdownMenu",o),a(5),c("ngIf",!e.active),a(),c("ngIf",e.active),a(2),c("routerLink",xt(11,Ei,e.customerId,e.routeId)),a(14),x(e.desc),a(4),c("ngIf",e.active),a(),c("ngIf",!e.active)}}function co(i,m){if(i&1&&(t(0,"div",30),g(1,lo,39,14,"div",36),r()),i&2){let e=d();a(),c("ngForOf",e.routesList)}}function mo(i,m){if(i&1&&(t(0,"span"),s(1),r()),i&2){let e=d().$implicit;a(),S("",e.initialStart," /")}}function po(i,m){if(i&1&&(t(0,"span"),s(1),r()),i&2){let e=d().$implicit;a(),x(e.initialEnd)}}function uo(i,m){}function _o(i,m){i&1&&(t(0,"nz-tag",60),s(1,"Activa"),r()),i&2&&c("nzColor","blue")}function ho(i,m){i&1&&(t(0,"nz-tag",60),s(1,"Inactiva"),r()),i&2&&c("nzColor","cyan")}function fo(i,m){if(i&1){let e=v();t(0,"li",51),f("click",function(){u(e);let n=d().$implicit,l=d(2);return _(l.toggleActive(n))}),p(1,"i",59),t(2,"span",41),s(3,"Activar"),r()()}}function go(i,m){if(i&1){let e=v();t(0,"li",51),f("click",function(){u(e);let n=d().$implicit,l=d(2);return _(l.toggleActive(n))}),p(1,"i",59),t(2,"span",41),s(3,"Desactivar"),r()()}}function zo(i,m){if(i&1){let e=v();t(0,"tr")(1,"td"),s(2),r(),t(3,"td"),s(4),r(),t(5,"td"),g(6,mo,2,1,"span",63)(7,po,2,1,"span",63)(8,uo,0,0,"ng-template",null,6,y),r(),t(10,"td"),s(11),g(12,_o,2,1,"nz-tag",58)(13,ho,2,1,"nz-tag",58),r(),t(14,"td",64)(15,"div")(16,"a",44),p(17,"i",45),r(),t(18,"nz-dropdown-menu",null,7)(20,"ul",46),g(21,fo,4,0,"li",47)(22,go,4,0,"li",47),t(23,"li",51),f("click",function(){let n=u(e).$implicit,l=d(2);return _(l.duplicate(n))}),p(24,"i",52),t(25,"span",41),s(26,"Duplicar"),r()(),t(27,"li",48)(28,"a",49),p(29,"i",50),t(30,"span",41),s(31,"Editar"),r()()(),p(32,"li",53),t(33,"li",51),f("click",function(){let n=u(e).$implicit,l=d(2);return _(l.deleteRoute(n))}),p(34,"i",54),t(35,"span",41),s(36,"Eliminar"),r()()()()()()()}if(i&2){let e=m.$implicit,o=b(9),n=b(19);a(2),x(e.customerName),a(2),x(e.name),a(2),c("ngIf",e.initialStart==null?null:e.initialStart.length)("ngIfElse",o),a(),c("ngIf",e.initialEnd==null?null:e.initialEnd.length)("ngIfElse",o),a(4),S("",e.description," "),a(),c("ngIf",e.active),a(),c("ngIf",!e.active),a(3),c("nzDropdownMenu",n),a(5),c("ngIf",!e.active),a(),c("ngIf",e.active),a(6),c("routerLink",xt(13,Ei,e.customerId,e.routeId))}}function Co(i,m){if(i&1&&(t(0,"nz-card")(1,"nz-table",61,5)(3,"thead")(4,"tr")(5,"th"),s(6,"Empresa"),r(),t(7,"th"),s(8,"Nombre"),r(),t(9,"th"),s(10,"Horario Entradas / Salidas"),r(),t(11,"th"),s(12,"Descripci\xF3n"),r(),t(13,"th"),s(14,"..."),r()()(),t(15,"tbody"),g(16,zo,37,16,"tr",62),r()()()),i&2){let e=b(2),o=d();a(),c("nzData",o.routesList),a(15),c("ngForOf",e.data)}}function vo(i,m){if(i&1&&(t(0,"nz-option",71),p(1,"i",72),s(2),p(3,"br"),s(4),r()),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.id),a(2),S(" ",e.name," "),a(2),S(" ",e.description,"")}}function xo(i,m){if(i&1&&p(0,"nz-option",34),i&2){let e=m.$implicit;c("nzValue",e)("nzLabel",e)}}function So(i,m){if(i&1){let e=v();t(0,"div",30)(1,"div",65)(2,"form",66)(3,"nz-form-item")(4,"nz-form-label",67),s(5,"Empresa"),r(),t(6,"nz-select",68),f("ngModelChange",function(n){u(e);let l=d();return _(l.onCustomerChange(n))}),g(7,vo,5,4,"nz-option",69),r()(),t(8,"nz-form-item")(9,"nz-form-label"),s(10,"Nombre de la Operaci\xF3n"),r(),t(11,"nz-form-control"),p(12,"input",25),r()(),t(13,"nz-form-item")(14,"nz-form-label"),s(15,"Descripci\xF3n"),r(),t(16,"nz-form-control"),p(17,"textarea",26),r()(),t(18,"nz-form-item")(19,"nz-form-label"),s(20,"Horario Preliminar (Opcional)"),r(),t(21,"nz-form-control")(22,"nz-select",70),g(23,xo,1,2,"nz-option",28),r()()()()()()}if(i&2){let e=d();a(2),c("formGroup",e.objectFormDuplicate),a(5),c("ngForOf",e.accountsList),a(16),c("ngForOf",e.timeOptions)}}var va=(()=>{class i{constructor(e,o,n,l,h){this.afs=e,this.modalService=o,this.messageService=n,this.fb=l,this.modal=h,this.routesService=T(Fe),this.authService=T(Z),this.accountsService=T(Te),this.rolService=T(Ee),this.view="listView",this.isVisible=!1,this.isOkLoading=!1,this.stopSubscription$=new A,this.routesList=[],this.routesListLoaded=[],this.accountsList=[],this.duplicateVisible=!1,this.duplicateCustomerId="",this.isDuplicateLoading=!1,this.selectedData={},this.infoLoad=[],this.infoSegment=[],this.customersService=T(lt),this.timeOptions=[],this.routesListSingle=[],this.authService.user.subscribe(z=>{z?(this.user=z,this.user.idSegment&&this.accountsService.getSegmentLevel(this.user.idSegment).pipe(I(this.stopSubscription$),E(V=>{let Ce=V.payload.id,M=V.payload.data();return w({id:Ce},M)}),W(V=>{this.infoSegment=V,this.getSubscriptions()})).subscribe(),this.user.rolId&&this.rolService.getRol(this.user.rolId).valueChanges().subscribe(V=>{this.infoLoad=V,this.userlevelAccess=this.infoLoad.optionAccessLavel})):console.warn("Usuario no autenticado o datos a\xFAn no disponibles.")})}ngOnInit(){this.objectForm=this.fb.group({active:[!1,[C.required]],description:["",[C.required]],imageUrl:[""],kmzUrl:[""],name:["",[C.minLength(5),C.maxLength(20),C.required]],routeId:[""],customerId:["",[C.required]],customerName:["",[C.required]],initialStart:[],initialEnd:[]}),this.objectFormDuplicate=this.fb.group({active:[!1,[C.required]],description:["",[C.required]],imageUrl:[""],kmzUrl:[""],name:["",[C.minLength(5),C.maxLength(20),C.required]],routeId:[""],customerId:["",[C.required]],customerName:[""],initialStart:[],initialEnd:[],duplicateCustomerId:[],newCustomerId:[],newCustomerName:[]}),this.generateTimeOptions()}generateTimeOptions(){for(let n=7;n<=21;n++){let l=n%12||12,h=n<12?"AM":"PM",z=`${l.toString().padStart(2,"0")}:${n%60===30?"30":"00"} ${h}`;this.timeOptions.push(z)}}ngOnDestroy(){this.stopSubscription$.next(!1),this.stopSubscription$.complete(),this.routesSubscription&&this.routesSubscription.unsubscribe()}sendMessage(e,o){this.messageService.create(e,o)}getSubscriptions(){this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?(this.routesService.getAllCustomersRoutesbyCustomer(this.user.customerId).pipe(I(this.stopSubscription$),E(e=>e.map(o=>{let n=o.payload.doc.id,l=o.payload.doc.data();return w({id:n},l)}))).subscribe(e=>{this.routesList=e,this.routesListLoaded=e}),this.accountsService.getAccountsByCustomer(this.user.customerId).pipe(I(this.stopSubscription$),E(e=>{let o=e.payload.id,n=e.payload.data();return w({id:o},n)})).subscribe(e=>{this.accountsList=[e]})):(this.routesService.getAllCustomersRoutes().pipe(I(this.stopSubscription$)).subscribe(e=>{this.routesList=e,this.routesListLoaded=e}),this.accountsService.getAccounts().pipe(I(this.stopSubscription$),E(e=>e.map(o=>{let n=o.payload.doc.id,l=o.payload.doc.data();return w({id:n},l)}))).subscribe(e=>{this.accountsList=e}))}setCustomerName(e){let n=Pt.filter(this.accountsList,l=>l.id==e)[0];this.objectForm.controls.customerName.setValue(n.name)}toggleActive(e){e.active===!1&&(this.routesSubscription=this.routesService.getCustomersPolyLineCustomer(e.customerId,e.routeId).pipe(et(1),E(o=>o.length>0?o.map(n=>({id:n.payload.doc.id})):[{id:"-"}])).subscribe({next:o=>{this.routesService.getCustomersRoutesbyCustomer(e.customerId,e.routeId).pipe(E(n=>n.map(l=>{let h=l.payload.doc.id,z=l.payload.doc.data();return w({id:h},z)}))).subscribe({next:n=>{let l=n.map(h=>({latitude:parseFloat(h.latitude),longitude:parseFloat(h.longitude)}));this.routesService.getDirectionsWithStops(l).subscribe({next:h=>Ze(this,null,function*(){this.routesService.setPolyline(h,e.customerId,e.routeId,o[0].id).then(()=>{}).catch(z=>{this.sendMessage("error",z)})}),error:h=>{console.error(h)}})},error:n=>{this.sendMessage("error",n)}})},error:o=>{this.sendMessage("error",o)}})),this.routesService.toggleActiveRoute(e.customerId,e.routeId,e).then(()=>{this.routesService.toggleActiveRouteVendor(e.customerId,e.routeId,e).then(()=>{this.sendMessage("sucess","La ruta se modific\xF3 con \xE9xito.")})}).catch(o=>this.sendMessage("error",o))}deleteRoute(e){this.userlevelAccess=="1"?this.routesService.deleteRoute(e.customerId,e.routeId).then(()=>{}).catch(o=>this.sendMessage("error",o)):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}duplicate(e){this.duplicateVisible=!0,this.objectFormDuplicate.patchValue(w({},e)),this.selectedData=e,this.isDuplicateLoading=!1}onCustomerChange(e){if(e){let n=Pt.filter(this.accountsList,l=>l.id==e)[0];this.selectedData.newCustomerName=n.name,this.newCustomerName=n.name,this.objectFormDuplicate.controls.newCustomerName.setValue(n.name)}}createDuplicated(){this.selectedData.newCustomerId=this.duplicateCustomerId,this.isDuplicateLoading=!0,this.userlevelAccess!="3"?this.routesService.duplicateRouteWithStops(this.objectFormDuplicate.value).then(()=>{this.isDuplicateLoading=!1,this.duplicateVisible=!1}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}handleCancel(){this.duplicateVisible=!1,this.isDuplicateLoading=!1}addNewRoute(e){var o;let n=this.modalService.create({nzTitle:"Nueva Operaci\xF3n",nzContent:e,nzFooter:[{label:"Crear Operaci\xF3n",type:"primary",onClick:()=>this.modalService.confirm({nzTitle:"Est\xE1 la informaci\xF3n completa?",nzOnOk:()=>{if(this.objectForm.valid){let l=this.objectForm.value,h=l.initialStart.map(V=>({value:V})),z=l.initialEnd.map(V=>({value:V}));if(this.userlevelAccess!="3"){let V=this.afs.createId(),Ce=this.routesService.setRoute2(V,this.objectForm.controls.customerId.value,this.objectForm.value).then(()=>{}).catch(M=>this.sendMessage("error",M));this.routesService.getInternalCustomer(this.objectForm.controls.customerId.value).pipe(I(this.stopSubscription$),E(M=>M.map(_e=>{let he=_e.payload.doc.id,Qe=_e.payload.doc.data();return ve(w({},Qe),{id:he})}))).subscribe(M=>{let _e=this.objectForm.controls.name.value,he=new Date,Xe=new Date(he.getFullYear()+3,he.getMonth(),he.getDate()).toISOString();var Ct="";let qe={authorization:"portalAuth",operation_type:"in",method:"Liquidacion",transaction_type:"charge",card:{type:"",brand:"",address:"",card_number:"",holder_name:"",expiration_year:"",expiration_month:"",allows_charges:"",allows_payouts:"",bank_name:"",bank_code:"",points_card:"",points_type:""},status:"completed",conciliated:!1,creation_date:new Date().toISOString(),operation_date:new Date().toISOString(),description:"Pago a traves de portal",error_message:"",order_id:"portalOrder",currency:"MXN",amount:0,customer:{name:"",last_name:"",email:"",phone_number:"",address:"",creation_date:"",external_id:"",clabe:""},customerId:this.objectForm.controls.customerId.value,active:!0,category:"permanente",date_created:new Date().toISOString(),product_description:"Pago a traves de portal proceso interno al crear una ruta",product_id:"",name:"Internal",isTaskIn:"false",isTaskOut:"false",type:"Servicio",isOpenpay:!1,paidApp:"portal",price:0,round:"",routeId:V,routeName:_e,stopDescription:"",stopId:"",stopName:"Internal",validFrom:new Date().toISOString(),validTo:Xe,idBoardingPass:M[0].id,idPurchasteRequest:"",is_courtesy:!1,typePayment:"Liquidacion"};o={active:!0,amountPayment:0,payment:"Liquidacion",status:"completed",customer_id:this.objectForm.controls.customerId.value,customerId:this.objectForm.controls.customerId.value,creation_date:new Date().toISOString(),name:"internal",price:0,operation_date:new Date().toISOString(),routeId:V,routeName:_e,round:"",stopName:"internal",stopId:"",typePayment:"Liquidacion",validFrom:new Date().toISOString(),validTo:Xe,idBoardingPass:M[0].uid,idPurchaseRequest:"",baja:!1,type:"Servicio",fileURL:Ct},this.customersService.saveBoardingPassToUserPurchaseCollection(M[0].id,qe).then(Je=>{this.customersService.saveBoardingPassDetailToUserPurchaseCollection(M[0].id,V,qe).then(Ye=>{let Vi=M[0];this.customersService.createPurchaseCloud(qe,Vi,M[0].id)}).catch(Ye=>{this.sendMessage("error",Ye)})}).catch(Je=>{this.sendMessage("error",Je)}),this.modalService.closeAll()})}else this.sendMessage("error","El usuario no tiene permisos para agregar datos, favor de contactar al administrador.")}}})}],nzWidth:500})}getItems(e){let o=e;if(!o){this.routesList=this.routesListLoaded.slice();return}let n=o.toLowerCase();this.routesList=this.routesListLoaded.filter(l=>Object.values(l).some(h=>String(h).toLowerCase().includes(n)))}static{this.\u0275fac=function(o){return new(o||i)(D(ot),D(dt),D(Se),D(K),D(Wt))}}static{this.\u0275cmp=R({type:i,selectors:[["app-routes"]],decls:27,vars:6,consts:[["searchInput",""],["suffixIconSearch",""],["newProjectContent",""],["modalContent",""],["projectListSetting","nzDropdownMenu"],["listViewTable",""],["empty",""],["projectListSetting2","nzDropdownMenu"],[2,"margin","buttom 15px","margin-right","15px","margin-left","15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"page-header"],[1,"row","align-items-md-center"],[1,"col-md-6"],[2,"margin-left","10px","width","280px"],[3,"nzSuffix"],["type","text","nz-input","","placeholder","Selecciona una Operaci\xF3n",3,"keyup"],[1,"text-md-right","m-v-10"],[1,"container-fluid"],["class","row",4,"ngIf"],[4,"ngIf"],["nzTitle","Duplicar la operaci\xF3n para la empresa",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzContent"],["nz-icon","","nzType","search"],["nz-form","","nzLayout","vertical",3,"formGroup"],["type","text","formControlName","name","nz-input","","placeholder","Escriba el nombre de la Operaci\xF3n"],["formControlName","description","nz-input",""],["formControlName","initialStart","nzMode","multiple"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["formControlName","initialEnd","nzMode","multiple"],[1,"row"],[1,"col-md-12"],["formControlName","customerId","nzPlaceHolder","Selecciona la empresa",1,"w-100",3,"ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],[3,"nzLabel","nzValue"],["class","col-md-3",4,"ngFor","ngForOf"],[1,"col-md-3"],[1,"d-flex","justify-content-between"],[1,"media"],["nzShape","square",2,"background-color","white","color","#4F6F57",3,"nzSize","nzSrc"],[1,"m-l-10"],[1,"m-b-0"],[1,"text-muted","font-size-13"],["nz-dropdown","","nzPlacement","bottomRight","nzTrigger","click",1,"text-gray","font-size-18",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","theme","outline"],["nz-menu","","nzSelectable",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item",""],[3,"routerLink"],["nz-icon","","nzType","edit","theme","outline"],["nz-menu-item","",3,"click"],["nz-icon","","nzType","copy","theme","outline"],["nz-menu-divider",""],["nz-icon","","nzType","delete","theme","outline"],[1,"m-t-25"],[1,"m-t-30"],[1,"d-flex","justify-content-between","align-items-center"],["class","m-b-0",3,"nzColor",4,"ngIf"],["nz-icon","","nzType","eye","theme","outline"],[1,"m-b-0",3,"nzColor"],["ngSkipHydration","",3,"nzData"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[1,"text-right"],[1,"col-sm-12"],["nz-form","","nz-form","","nzLayout","vertical",3,"formGroup"],["nzFor","customerId"],["formControlName","duplicateCustomerId","name","duplicateCustomerId","nzAllowClear","","nzPlaceHolder","Selecciona la empresa",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","initialStart"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""]],template:function(o,n){if(o&1){let l=v();t(0,"div",8)(1,"div",9)(2,"nz-page-header",10)(3,"nz-page-header-title",11),s(4,"Operaci\xF3n"),r(),t(5,"nz-page-header-subtitle"),s(6,"Operaciones del Sistema "),r()()(),t(7,"div",12)(8,"div",13)(9,"div",14)(10,"div",15)(11,"nz-form-control")(12,"nz-input-group",16)(13,"input",17,0),f("keyup",function(){u(l);let z=b(14);return _(n.getItems(z.value))}),r()(),g(15,Zr,1,0,"ng-template",null,1,y),r()()(),t(17,"div",14)(18,"div",18),g(19,no,32,4,"ng-template",null,2,y),r()()()(),t(21,"div",19),g(22,co,2,1,"div",20)(23,Co,17,2,"nz-card",21),r(),t(24,"nz-modal",22),F("nzVisibleChange",function(z){return u(l),k(n.duplicateVisible,z)||(n.duplicateVisible=z),_(z)}),f("nzOnCancel",function(){return u(l),_(n.handleCancel())})("nzOnOk",function(){return u(l),_(n.createDuplicated())}),r(),g(25,So,24,3,"ng-template",null,3,y),r()}if(o&2){let l=b(16),h=b(26);a(2),c("nzGhost",!1),a(10),c("nzSuffix",l),a(10),c("ngIf",n.view=="cardView"),a(),c("ngIf",n.view=="listView"),a(),P("nzVisible",n.duplicateVisible),c("nzContent",h)}},dependencies:[q,H,$,te,ee,ne,ie,oe,re,be,$t,qt,Oe,Me,Ne,Ae,Le,Ue,we,ae,de,ce,ye,Ve,Ie,me,j,st,De,mt,pt,Re,pe,ue,rt,X,xe,G,Q,J,Y]})}}return i})();var kt=Ke(ct());function bo(i,m){if(i&1){let e=v();t(0,"li",15),f("click",function(){u(e);let n=d().$implicit,l=d();return _(l.toggleActive(n))}),p(1,"i",16),s(2," Activar "),r()}}function yo(i,m){if(i&1){let e=v();t(0,"li",15),f("click",function(){u(e);let n=d().$implicit,l=d();return _(l.toggleActive(n))}),p(1,"i",16),s(2," Desactivar "),r()}}function wo(i,m){if(i&1){let e=v();t(0,"tr")(1,"td"),s(2),r(),t(3,"td"),s(4),r(),t(5,"td")(6,"nz-tag",10),s(7,"Dom"),r(),t(8,"nz-tag",10),s(9,"Lun"),r(),t(10,"nz-tag",10),s(11,"Mar"),r(),t(12,"nz-tag",10),s(13,"Mi\xE9"),r(),t(14,"nz-tag",10),s(15,"Jue"),r(),t(16,"nz-tag",10),s(17,"Vie"),r(),t(18,"nz-tag",10),s(19,"S\xE1b"),r()(),t(20,"td"),s(21),r(),t(22,"td"),s(23),L(24,"date"),r(),t(25,"td"),s(26),r(),t(27,"td"),s(28),r(),t(29,"td"),s(30),r(),t(31,"td"),s(32),r(),t(33,"td")(34,"a",11),p(35,"i",12),r(),t(36,"nz-dropdown-menu",null,2)(38,"ul",13),g(39,bo,3,0,"li",14)(40,yo,3,0,"li",14),t(41,"li",15),f("click",function(){let n=u(e).$implicit,l=d();return _(l.showModalEdit(n))}),p(42,"i",16),s(43," Editar "),r(),p(44,"li",17),t(45,"li",18),f("nzOnConfirm",function(){let n=u(e).$implicit,l=d();return _(l.showModalDelete(n))})("nzOnCancel",function(){u(e);let n=d();return _(n.handleCancel())}),p(46,"i",19),s(47," Eliminar "),r()()()()()}if(i&2){let e=m.$implicit,o=b(37);a(),U(e.active?"text-dark":"text-muted font-italic"),a(),x(e.vendorName),a(),U(e.active?"text-dark":"text-muted font-italic"),a(),x(e.program=="M"?"Mete":"Saca"),a(),U(e.active?"text-dark":"text-muted font-italic"),a(),c("nzColor",e.isSunday?"blue":""),a(2),c("nzColor",e.isMonday?"blue":""),a(2),c("nzColor",e.isTuesday?"blue":""),a(2),c("nzColor",e.isWednesday?"blue":""),a(2),c("nzColor",e.isThursday?"blue":""),a(2),c("nzColor",e.isFriday?"blue":""),a(2),c("nzColor",e.isSaturday?"blue":""),a(2),U(e.active?"text-dark":"text-muted font-italic"),a(),x(e.round),a(),U(e.active?"text-dark":"text-muted font-italic"),a(),x(O(24,38,e.time.toDate(),"shortTime")),a(2),U(e.active?"text-dark":"text-muted font-italic"),a(),x(e.acRequired?"Si":"No"),a(),U(e.active?"text-dark":"text-muted font-italic"),a(),x(e.stopBeginName),a(),U(e.active?"text-dark":"text-muted font-italic"),a(),x(e.stopEndName),a(),U(e.active?"text-dark":"text-muted font-italic"),a(),x(e.type),a(),U(e.active?"text-dark":"text-muted font-italic"),a(),c("nzDropdownMenu",o),a(5),c("ngIf",!e.active),a(),c("ngIf",e.active)}}function Eo(i,m){if(i&1&&(t(0,"nz-option",42),p(1,"i",16),s(2),p(3,"br"),s(4),r()),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.id),a(2),S(" ",e.name," "),a(2),S(" ",e.description,"")}}function To(i,m){if(i&1&&(t(0,"nz-option",42),p(1,"i",16),s(2),p(3,"br"),s(4),r()),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.id),a(2),S(" ",e.name," "),a(2),S(" ",e.description,"")}}function Vo(i,m){if(i&1&&(t(0,"nz-option",42),p(1,"i",16),s(2),p(3,"br"),s(4),r()),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.id),a(2),S(" ",e.name," "),a(2),S(" ",e.description,"")}}function Io(i,m){if(i&1){let e=v();t(0,"form",20),f("ngSubmit",function(){u(e);let n=d();return _(n.createProgram())}),t(1,"div",21)(2,"div",22)(3,"nz-form-item")(4,"nz-form-label"),s(5,"Tipo de asignaci\xF3n"),r(),t(6,"nz-form-control")(7,"nz-select",23),p(8,"nz-option",24)(9,"nz-option",25)(10,"nz-option",26),r()()()(),t(11,"div",22)(12,"nz-form-item")(13,"nz-form-label"),s(14,"Divisi\xF3n"),r(),t(15,"nz-form-control")(16,"nz-select",27),f("ngModelChange",function(n){u(e);let l=d();return _(l.onVendorSelected(n,"vendorName"))}),g(17,Eo,5,4,"nz-option",28),r()()()()(),t(18,"div",21)(19,"div",22)(20,"nz-form-item")(21,"nz-form-label"),s(22,"Turno"),r(),t(23,"nz-form-control")(24,"nz-select",29),p(25,"nz-option",30)(26,"nz-option",31)(27,"nz-option",32),r()()()(),t(28,"div",22)(29,"nz-form-item")(30,"nz-form-label"),s(31,"Tarea"),r(),t(32,"nz-form-control")(33,"nz-select",33),p(34,"nz-option",34)(35,"nz-option",35),r()()()()(),t(36,"div",21)(37,"div",36)(38,"nz-form-item")(39,"nz-form-label"),s(40,"Hora Compromiso"),r(),t(41,"nz-form-control"),p(42,"nz-time-picker",37),r()()()(),t(43,"nz-form-item")(44,"nz-form-label",38),s(45,"D\xEDas"),r(),t(46,"nz-form-control")(47,"nz-tag",39),f("nzCheckedChange",function(n){u(e);let l=d();return _(l.checkChange("isSunday",n))}),s(48,"Dom"),r(),t(49,"nz-tag",39),f("nzCheckedChange",function(n){u(e);let l=d();return _(l.checkChange("isMonday",n))}),s(50,"Lun"),r(),t(51,"nz-tag",39),f("nzCheckedChange",function(n){u(e);let l=d();return _(l.checkChange("isTuesday",n))}),s(52,"Mar"),r(),t(53,"nz-tag",39),f("nzCheckedChange",function(n){u(e);let l=d();return _(l.checkChange("isWednesday",n))}),s(54,"Mi\xE9"),r(),t(55,"nz-tag",39),f("nzCheckedChange",function(n){u(e);let l=d();return _(l.checkChange("isThursday",n))}),s(56,"Jue"),r(),t(57,"nz-tag",39),f("nzCheckedChange",function(n){u(e);let l=d();return _(l.checkChange("isFriday",n))}),s(58,"Vie"),r(),t(59,"nz-tag",39),f("nzCheckedChange",function(n){u(e);let l=d();return _(l.checkChange("isSaturday",n))}),s(60,"S\xE1b"),r()()(),t(61,"div",21)(62,"div",22)(63,"nz-form-item")(64,"nz-form-label"),s(65,"Inicia en"),r(),t(66,"nz-form-control")(67,"nz-select",40),f("ngModelChange",function(n){u(e);let l=d();return _(l.onStopPointSelected(n,"stopBeginName","stopBeginHour"))}),g(68,To,5,4,"nz-option",28),r()()()(),t(69,"div",22)(70,"nz-form-item")(71,"nz-form-label"),s(72,"Termina en"),r(),t(73,"nz-form-control")(74,"nz-select",41),f("ngModelChange",function(n){u(e);let l=d();return _(l.onStopPointSelected(n,"stopEndName","stopEndHour"))}),g(75,Vo,5,4,"nz-option",28),r()()()()()()}if(i&2){let e=d();c("formGroup",e.programForm),a(17),c("ngForOf",e.vendorsList),a(30),c("nzChecked",e.programForm.controls.isSunday.value),a(2),c("nzChecked",e.programForm.controls.isMonday.value),a(2),c("nzChecked",e.programForm.controls.isTuesday.value),a(2),c("nzChecked",e.programForm.controls.isWednesday.value),a(2),c("nzChecked",e.programForm.controls.isThursday.value),a(2),c("nzChecked",e.programForm.controls.isFriday.value),a(2),c("nzChecked",e.programForm.controls.isSaturday.value),a(9),c("ngForOf",e.stopPointsList),a(7),c("ngForOf",e.stopPointsList)}}var Ti=(()=>{class i{constructor(e,o){this.messageService=e,this.fb=o,this.loading=!0,this.routesService=T(Fe),this.vendorsService=T(Kt),this.rolService=T(Ee),this.authService=T(Z),this.userService=T(jt),this.stopSubscription$=new A,this.programsList=[],this.stopPointsList=[],this.vendorsList=[],this.isCreateVisible=!1,this.isEditMode=!1,this.infoLoad=[],this.authService.user.subscribe(n=>{n&&(this.user=n,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&this.rolService.getRol(this.user.rolId).valueChanges().subscribe(l=>{this.infoLoad=l,this.userlevelAccess=this.infoLoad.optionAccessLavel}))}),this.createForm()}sendMessage(e,o){this.messageService.create(e,o)}ngOnInit(){this.getSubscriptions()}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}getSubscriptions(){this.routesService.getRouteAssignments(this.accountId,this.routeId).pipe(I(this.stopSubscription$),E(e=>e.map(o=>{let n=o.payload.doc.id,l=o.payload.doc.data();return ve(w({},l),{id:n})}))).subscribe(e=>{this.programsList=e,this.loading=!1}),this.routesService.getRouteStopPoints(this.accountId,this.routeId).pipe(I(this.stopSubscription$),E(e=>e.map(o=>{let n=o.payload.doc.id,l=o.payload.doc.data();return ve(w({},l),{id:n})}))).subscribe(e=>{this.stopPointsList=e,this.loading=!1}),this.vendorsService.getVendors().pipe(I(this.stopSubscription$),E(e=>e.map(o=>{let n=o.payload.doc.id,l=o.payload.doc.data();return ve(w({},l),{id:n})}))).subscribe(e=>{this.vendorsList=e,this.loading=!1})}createForm(){this.programForm=this.fb.group({active:[!1,[C.required]],acRequired:[!1,[C.required]],isSunday:[!1,[C.required]],isMonday:[!0,[C.required]],isTuesday:[!0,[C.required]],isWednesday:[!0,[C.required]],isThursday:[!0,[C.required]],isFriday:[!0,[C.required]],isSaturday:[!1,[C.required]],program:["",[C.required]],round:["",[C.required]],stopBeginId:["",[C.required]],stopBeginName:["",[C.required]],stopBeginHour:["",[C.required]],stopEndId:["",[C.required]],stopEndName:["",[C.required]],stopEndHour:["",[C.required]],time:[new Date,[C.required]],type:[this.assigmentType,[C.required]],customerName:["",[C.required]],customerId:[this.accountId,[C.required]],vendorName:["",[C.required]],vendorId:["",[C.required]],routeId:[this.routeId,[C.required]]})}patchForm(e){this.programForm.patchValue({active:e.active,acRequired:e.acRequired,isSunday:e.isSunday,isMonday:e.isMonday,isTuesday:e.isTuesday,isWednesday:e.isWednesday,isThursday:e.isThursday,isFriday:e.isFriday,isSaturday:e.isSaturday,program:e.program,round:e.round,stopBeginId:e.stopBeginId,stopBeginName:e.stopBeginName,stopBeginHour:e.stopBeginHour,stopEndId:e.stopEndId,stopEndName:e.stopEndName,stopEndHour:e.stopEndHour,time:e.time.toDate(),type:e.type,customerName:e.customerName,customerId:this.accountId,vendorName:e.vendorName,vendorId:e.vendorId,routeId:this.routeId})}toggleActive(e){this.routesService.toggleRouteAssignment(this.accountId,this.routeId,e.id,e).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1}).catch(o=>this.sendMessage("error",o))}showCreateModal(){this.isCreateVisible=!0,this.currentSelectedId=""}showModalDelete(e){this.userlevelAccess=="1"?this.routesService.deleteRouteAssignments(this.accountId,this.routeId,e.id).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1}).catch(o=>this.sendMessage("error",o)):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}showModalEdit(e){this.patchForm(e),this.currentSelectedId=e.id,this.isCreateVisible=!0,this.isEditMode=!0}handleCancel(){this.isCreateVisible=!1,this.isEditMode=!1,this.currentSelectedId=""}createProgram(){this.programForm.get("customerId").setValue(this.accountId),this.programForm.get("routeId").setValue(this.routeId),this.userlevelAccess!="3"?this.isEditMode?this.routesService.updateRouteAssignment(this.accountId,this.routeId,this.currentSelectedId,this.programForm.value).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1,this.currentSelectedId=""}).catch(e=>this.sendMessage("error",e)):this.routesService.setRouteAssignments(this.accountId,this.routeId,this.programForm.value).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1}).catch(e=>this.sendMessage("error",e)):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}checkChange(e,o){this.programForm.controls[e].setValue(o)}onStopPointSelected(e,o,n){if(e){let h=kt.filter(this.stopPointsList,V=>V.id==e)[0],z=this.programForm.controls.round.value;switch(this.programForm.controls[o].setValue(h.name),z){case"D\xEDa":this.programForm.controls[n].setValue(h.round1);break;case"Tarde":this.programForm.controls[n].setValue(h.round2);break;default:this.programForm.controls[n].setValue(h.round1);break}}}onVendorSelected(e,o){if(e){let l=kt.filter(this.vendorsList,h=>h.id==e)[0];this.programForm.controls[o].setValue(l.name)}}static{this.\u0275fac=function(o){return new(o||i)(D(Se),D(K))}}static{this.\u0275cmp=R({type:i,selectors:[["app-shared-route-programs"]],inputs:{accountId:"accountId",routeId:"routeId"},decls:33,vars:5,consts:[["programsListTable",""],["modalContent",""],["menu","nzDropdownMenu"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],[3,"nzData","nzLoading"],[2,"color","#4F6F57"],[4,"ngFor","ngForOf"],["nzTitle","Agregar asignaci\xF3n",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzContent"],[3,"nzColor"],["nz-dropdown","","nzPlacement","bottomRight",3,"nzDropdownMenu"],["nz-icon","","nzTooltipTitle","M\xE1s informaci\xF3n","nzTooltipPlacement","topLeft","nz-tooltip",""],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item","",3,"click"],["nz-icon",""],["nz-menu-divider",""],["nz-menu-item","","nz-popconfirm","","nzPopconfirmTitle","\xBFEst\xE1s seguro de eliminar esta asignaci\xF3n?","nzPopconfirmPlacement","topRight",3,"nzOnConfirm","nzOnCancel"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436"],["nz-form","",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-6","col-sm-12"],["formControlName","type"],["nzValue","Permanente","nzLabel","Permanente"],["nzValue","Temporal","nzLabel","Temporal"],["nzValue","Viaje Especial","nzLabel","Viaje Especial"],["formControlName","vendorId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["formControlName","round"],["nzValue","D\xEDa","nzLabel","D\xEDa"],["nzValue","Tarde","nzLabel","Tarde"],["nzValue","Noche","nzLabel","Noche"],["formControlName","program"],["nzValue","M","nzLabel","Mete"],["nzValue","S","nzLabel","Saca"],[1,"col-md-8","col-sm-12"],["formControlName","time","nzFormat","HH:mm"],["nzFor","days"],["nzMode","checkable",3,"nzCheckedChange","nzChecked"],["formControlName","stopBeginId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["formControlName","stopEndId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue"]],template:function(o,n){if(o&1){let l=v();t(0,"div",3)(1,"nz-page-header",4)(2,"nz-page-header-extra")(3,"button",5),f("click",function(){return u(l),_(n.showCreateModal())}),s(4,"Agregar asignaci\xF3n"),r()()()(),t(5,"nz-table",6,0)(7,"thead")(8,"tr")(9,"th",7),s(10,"Asignado A"),r(),t(11,"th",7),s(12,"Tarea"),r(),t(13,"th",7),s(14,"D\xEDas"),r(),t(15,"th",7),s(16,"Turno"),r(),t(17,"th",7),s(18,"Hora"),r(),t(19,"th",7),s(20,"AC"),r(),t(21,"th",7),s(22,"Inicio"),r(),t(23,"th",7),s(24,"Fin"),r(),t(25,"th",7),s(26,"Tipo"),r(),p(27,"th",7),r()(),t(28,"tbody"),g(29,wo,48,41,"tr",8),r()(),t(30,"nz-modal",9),F("nzVisibleChange",function(z){return u(l),k(n.isCreateVisible,z)||(n.isCreateVisible=z),_(z)}),f("nzOnCancel",function(){return u(l),_(n.handleCancel())})("nzOnOk",function(){return u(l),_(n.createProgram())}),g(31,Io,76,11,"ng-template",null,1,y),r()}if(o&2){let l=b(6),h=b(32);a(5),c("nzData",n.programsList)("nzLoading",n.loading),a(24),c("ngForOf",l.data),a(),P("nzVisible",n.isCreateVisible),c("nzContent",h)}},dependencies:[q,H,$,te,ee,ne,ie,oe,re,Oe,Me,Ne,Ae,Le,Ue,we,de,ce,ye,Ve,Ie,me,at,le,j,se,De,ut,Re,pe,ue,X,G,Q,J,Y,Zt,_t,nt]})}}return i})();function Po(i,m){if(i&1&&(t(0,"nz-option",29),p(1,"i",30),s(2),p(3,"br"),s(4),r()),i&2){let e=m.$implicit;c("nzLabel",e.name)("nzValue",e.id),a(2),S(" ",e.name," "),a(2),S(" ",e.description,"")}}var Wa=(()=>{class i{constructor(e,o){this.route=e,this.fb=o,this.routesService=T(Fe),this.accountsService=T(Te),this.accountsList=[],this.stopSubscription$=new A,this.routeElement={},this.infoSegment=[],this.authService=T(Z),this.authService.user.subscribe(n=>{n&&(this.user=n,this.user!==null&&this.user!==void 0&&this.user.idSegment!==void 0&&this.accountsService.getSegmentLevel(this.user.idSegment).pipe(I(this.stopSubscription$),E(l=>{let h=l.payload.id,z=l.payload.data();return w({id:h},z)}),W(l=>(this.infoSegment=l,l))).subscribe())})}ngOnInit(){this.objectSubscription=this.route.params.pipe(I(this.stopSubscription$)).subscribe(e=>{this.accountId=e.accountId,this.routeId=e.routeId,this.getSubscriptions(),this.createForm()})}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}createForm(){this.objectForm=this.fb.group({active:[!1,[C.required]],name:["",[C.required]],description:[""],imageUrl:[""],kmzUrl:[""],routeId:["",[C.required]],customerId:[""]})}patchForm(e){this.objectForm.patchValue({active:e.active,name:e.name,description:e.description,imageUrl:e.imageUrl,kmzUrl:e.kmzUrl,routeId:e.routeId,customerId:this.accountId})}saveForm(){}getSubscriptions(){this.routesService.getRoute(this.accountId,this.routeId).pipe(I(this.stopSubscription$),E(e=>{let o=e.payload.id,n=e.payload.data();return w({id:o},n)})).subscribe(e=>{this.patchForm(e),this.routeElement=e}),this.infoSegment.nivelNum!==void 0&&this.infoSegment.nivelNum==1?this.accountsService.getAccountsByCustomer(this.user.customerId).pipe(I(this.stopSubscription$),E(e=>{let o=e.payload.id,n=e.payload.data();return w({id:o},n)})).subscribe(e=>{this.accountsList=[e]}):this.accountsService.getAccounts().pipe(I(this.stopSubscription$),E(e=>e.map(o=>{let n=o.payload.doc.id,l=o.payload.doc.data();return w({id:n},l)}))).subscribe(e=>{this.accountsList=e})}onCustomerChange(){}static{this.\u0275fac=function(o){return new(o||i)(D(At),D(K))}}static{this.\u0275cmp=R({type:i,selectors:[["app-edit"]],decls:48,vars:11,consts:[[1,"page-header","has-tab"],[1,"d-md-flex","m-b-15","align-items-center","justify-content-between"],[1,"media","align-items-center","m-b-15"],["nzShape","square",2,"background-color","white","color","#4F6F57",3,"nzSize","nzSrc"],[1,"m-l-15"],[1,"m-b-0"],[1,"m-b-15"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nz-icon","","nzType","save","theme","outline"],["nz-form","","nzLayout","vertical",3,"formGroup"],[1,"page-header-tab",3,"nzSelectedIndex"],["nzTitle","Informaci\xF3n B\xE1sica"],[1,"row"],[1,"col-md-9","col-sm-12"],["nzFor","name"],["nz-input","","formControlName","name","type","text"],[1,"col-md-3","col-sm-12"],["nzFor","active"],["formControlName","active","nzCheckedChildren","Activa","nzUnCheckedChildren","Inactiva"],[1,"col-md-12"],["nzFor","description"],["nz-input","","formControlName","description","type","text"],["nzFor","customerId"],["formControlName","customerId","nzAllowClear","","nzPlaceHolder","Selecciona la empresa",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzTitle","Estaciones"],[3,"userCanUpdate","accountId","routeId"],["nzTitle","Asignaciones"],[3,"accountId","routeId"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon","","nzType","flag"]],template:function(o,n){o&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),p(3,"nz-avatar",3),t(4,"div",4)(5,"h4",5),s(6),r()()(),t(7,"div",6)(8,"button",7),f("click",function(){return n.saveForm()}),p(9,"i",8),t(10,"span"),s(11,"Actualizar"),r()()()()(),t(12,"form",9)(13,"nz-tabset",10)(14,"nz-tab",11)(15,"nz-card")(16,"div",12)(17,"div",13)(18,"nz-form-item")(19,"nz-form-label",14),s(20,"Nombre"),r(),t(21,"nz-form-control"),p(22,"input",15),r()()(),t(23,"div",16)(24,"nz-form-item")(25,"nz-form-label",17),s(26,"Activa"),r(),t(27,"nz-form-control"),p(28,"nz-switch",18),r()()()(),t(29,"div",12)(30,"div",19)(31,"nz-form-item")(32,"nz-form-label",20),s(33,"Descripci\xF3n"),r(),t(34,"nz-form-control"),p(35,"input",21),r()()(),t(36,"div",19)(37,"nz-form-item")(38,"nz-form-label",22),s(39,"Empresa"),r(),t(40,"nz-select",23),f("ngModelChange",function(){return n.onCustomerChange()}),g(41,Po,5,4,"nz-option",24),r()()()()()(),t(42,"nz-tab",25)(43,"nz-card"),p(44,"app-shared-stoppoints-list",26),r()(),t(45,"nz-tab",27)(46,"nz-card"),p(47,"app-shared-route-programs",28),r()()()()),o&2&&(a(3),c("nzSize",70)("nzSrc",n.objectForm.controls.imageUrl.value),a(3),x(n.objectForm.controls.name.value),a(6),c("formGroup",n.objectForm),a(),c("nzSelectedIndex",0),a(28),c("ngForOf",n.accountsList),a(3),c("userCanUpdate",!0)("accountId",n.accountId)("routeId",n.routeId),a(3),c("accountId",n.accountId)("routeId",n.routeId))},dependencies:[q,$,te,ee,ne,ie,oe,re,be,ae,ht,le,j,se,st,pe,ue,X,xe,G,Q,J,Y,ke,Pe,Yt,Ti]})}}return i})();export{Si as a,ta as b,la as c,va as d,Wa as e};
