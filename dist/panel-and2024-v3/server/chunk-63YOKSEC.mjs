import './polyfills.server.mjs';
import{a as _0}from"./chunk-7JPAM4IH.mjs";import{a as Kn}from"./chunk-QH42M2RP.mjs";import{a as g0}from"./chunk-M4LO5DUP.mjs";import{a as h0}from"./chunk-6D76FM2H.mjs";import{d as m0}from"./chunk-ZF25OODT.mjs";import{c as Jn}from"./chunk-Q55VFKGY.mjs";import{a as Rn}from"./chunk-EXJRETI6.mjs";import{a as x0,b as v0}from"./chunk-VJYBNRSU.mjs";import{a as qn,c as d0,h as Yn,i as p0}from"./chunk-BGBMSDAX.mjs";import{a as $n}from"./chunk-TB4X4XFH.mjs";import{A as Jr,C as Zr,D as Qr,E as en,F as tn,H as na,a as rr,c as Wn,d as Hn,e as ra,g as Cr,h as c0,k as nr,m as l0,n as Gn,o as Xn,s as f0,t as u0,x as Yr}from"./chunk-7WO2KNYN.mjs";import{$ as i0,M as Wr,P as Zt,Q as Qt,R as er,S as tr,_ as kr,aa as a0,b as wr,c as fe,d as vt,da as Mn,e as Dt,ea as gl,fa as Bn,g as Ti,h as Ln,ha as Nr,i as It,ja as jr,k as Nt,la as o0,m as Pt,pa as ir,q as gt,qa as ar,sa as jn,t as Yt,u as Jt}from"./chunk-VONW7ZKM.mjs";import{a as s0,c as ta,d as Hr}from"./chunk-MD57JE7O.mjs";import{a as Gr,c as Xr,d as Vn,f as Un,g as $r,h as qr,j as Kr}from"./chunk-6LQQHYT7.mjs";import{Lb as ja,Va as Ke,Vb as Lt,Wb as Rt,Xa as ea,Ya as Ot,Yb as Mt,cb as ki,la as Tr,p as Er,qb as Xa}from"./chunk-HW47JO5W.mjs";import{$ as Dn,Ab as vn,C as Js,Cd as r0,Dd as n0,G as Zs,Hb as be,Ia as xn,Ib as C,Ja as y,Jb as Ce,K as mn,Ka as Te,Kb as Be,Kc as xt,Lb as Zi,Lc as Sr,Mc as On,Nb as Et,Ob as Tt,Pb as kt,Pc as Qi,Sb as _r,T as Qs,Tb as In,V as pt,Vb as e0,X as Ir,Xb as Nn,Ya as ue,Zb as Pn,_a as F,ac as Ge,ca as pn,cb as Kt,d as qt,da as we,ha as rt,mb as u,nb as m,o as Si,ob as L,pa as se,pb as wi,q as Fe,qa as oe,qb as Ei,sb as ke,v as Ys,vb as le,xb as j,yd as t0}from"./chunk-OPSN3ZKU.mjs";import{a as De,b as fr,f as vl,h as Ks,j as gr}from"./chunk-H6KHSOBK.mjs";var Zc=vl((Ls,Rs)=>{"use strict";(function(t,r){typeof define=="function"&&define.amd?define([],r):typeof Ls<"u"?r():(r(),t.FileSaver={})})(Ls,function(){"use strict";function t(o,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function r(o,c,l){var f=new XMLHttpRequest;f.open("GET",o),f.responseType="blob",f.onload=function(){s(f.response,c,l)},f.onerror=function(){console.error("could not download file")},f.send()}function e(o){var c=new XMLHttpRequest;c.open("HEAD",o,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function n(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(c)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,a=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(o,c,l){var f=i.URL||i.webkitURL,v=document.createElement("a");c=c||o.name||"download",v.download=c,v.rel="noopener",typeof o=="string"?(v.href=o,v.origin===location.origin?n(v):e(v.href)?r(o,c,l):n(v,v.target="_blank")):(v.href=f.createObjectURL(o),setTimeout(function(){f.revokeObjectURL(v.href)},4e4),setTimeout(function(){n(v)},0))}:"msSaveOrOpenBlob"in navigator?function(o,c,l){if(c=c||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(t(o,l),c);else if(e(o))r(o,c,l);else{var f=document.createElement("a");f.href=o,f.target="_blank",setTimeout(function(){n(f)})}}:function(o,c,l,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof o=="string")return r(o,c,l);var v=o.type==="application/octet-stream",p=/constructor/i.test(i.HTMLElement)||i.safari,x=/CriOS\/[\d]+/.test(navigator.userAgent);if((x||v&&p||a)&&typeof FileReader<"u"){var w=new FileReader;w.onloadend=function(){var D=w.result;D=x?D:D.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=D:location=D,f=null},w.readAsDataURL(o)}else{var h=i.URL||i.webkitURL,S=h.createObjectURL(o);f?f.location=S:location.href=S,f=null,setTimeout(function(){h.revokeObjectURL(S)},4e4)}});i.saveAs=s.saveAs=s,typeof Rs<"u"&&(Rs.exports=s)})});var S0=(()=>{class t{constructor(e){this.afs=e}getSummarized(){return this.afs.collection("summarized").valueChanges()}setAccounts(){}static{this.\u0275fac=function(n){return new(n||t)(pn(Er))}}static{this.\u0275prov=Dn({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Sl=(t,r,e)=>[t,r,e],wl=()=>({size:"large"}),El=t=>["/accounts/edit",t,0],Tl=t=>["/accounts/edit",t,1],w0=t=>["/accounts/edit",t,2],kl=t=>["/accounts/edit",t,3];function Cl(t,r){t&1&&L(0,"nz-empty")}function yl(t,r){if(t&1&&L(0,"nz-avatar",28),t&2){let e=j().$implicit;F("nzSrc",e.imageUrl)}}function Fl(t,r){if(t&1){let e=ke();u(0,"i",31),le("click",function(){se(e);let i=j(2).$implicit,a=j();return oe(a.toggleAccountActive(i.id,!0))}),m()}t&2&&F("nzType","check-circle")("nzTheme","twotone")("nzTwotoneColor","#52c41a")}function Al(t,r){if(t&1){let e=ke();u(0,"i",32),le("click",function(){se(e);let i=j(2).$implicit,a=j();return oe(a.toggleAccountActive(i.id,!1))}),m()}t&2&&F("nzType","pause-circle")("nzTheme","twotone")("nzTwotoneColor","#de4436")}function bl(t,r){if(t&1&&ue(0,Fl,1,3,"i",29)(1,Al,1,3,"i",30),t&2){let e=j().$implicit;F("ngIf",e.active),y(),F("ngIf",!e.active)}}function zl(t,r){if(t&1&&L(0,"i",33),t&2){let e=j().$implicit;F("routerLink",In(1,El,e.id))}}function Dl(t,r){if(t&1){let e=ke();u(0,"a",34),L(1,"i",35),m(),u(2,"nz-dropdown-menu",null,5)(4,"ul",36)(5,"li",37),L(6,"i",38),C(7," Usuarios "),m(),u(8,"li",37),L(9,"i",39),C(10," Productos "),m(),u(11,"li",37),L(12,"i",39),C(13," Promociones "),m(),u(14,"li",37),L(15,"i",40),C(16," Operaci\xF3n y horarios "),m(),L(17,"li",41),u(18,"li",42),le("click",function(){se(e);let i=j().$implicit,a=j();return oe(a.deleteAccountModal(i))}),L(19,"i",43),C(20," Eliminar "),m()()()}if(t&2){let e=be(3),n=j().$implicit;F("nzDropdownMenu",e),y(5),F("routerLink",In(5,Tl,n.id)),y(3),F("routerLink",In(7,w0,n.id)),y(3),F("routerLink",In(9,w0,n.id)),y(3),F("routerLink",In(11,kl,n.id))}}function Il(t,r){if(t&1&&(u(0,"div",24)(1,"nz-card",25)(2,"nz-skeleton",26),L(3,"nz-card-meta",27),m()(),ue(4,yl,1,1,"ng-template",null,1,Ge)(6,bl,2,2,"ng-template",null,2,Ge)(8,zl,1,3,"ng-template",null,3,Ge)(10,Dl,21,13,"ng-template",null,4,Ge),m()),t&2){let e=r.$implicit,n=be(5),i=be(7),a=be(9),s=be(11),o=j();y(),F("nzActions",e0(6,Sl,i,a,s)),y(),F("nzActive",!0)("nzLoading",o.loading)("nzAvatar",_r(10,wl)),y(),F("nzAvatar",n)("nzTitle",e.name)}}function Nl(t,r){if(t&1&&(u(0,"nz-option",61),L(1,"i",62),C(2),m()),t&2){let e=r.$implicit;F("nzLabel",e.name)("nzValue",e.uid),y(2),Be(" ",e.name,"")}}function Pl(t,r){if(t&1){let e=ke();u(0,"form",44),le("ngSubmit",function(){se(e);let i=j();return oe(i.submitForm())}),u(1,"nz-form-item")(2,"nz-form-label",45),C(3,"Nombre"),m(),u(4,"nz-form-control",46),L(5,"input",47),m()(),u(6,"nz-form-item")(7,"nz-form-label",48)(8,"span"),C(9," Giro "),m()(),u(10,"nz-form-control",49)(11,"nz-select",50),le("ngModelChange",function(i){se(e);let a=j();return oe(a.onJobTypeSelected(i))}),ue(12,Nl,3,3,"nz-option",51),m()()(),u(13,"nz-form-item")(14,"nz-form-label",52),C(15," Consecutivo "),m(),u(16,"nz-form-control",53),L(17,"input",54),m()(),u(18,"nz-form-item")(19,"nz-form-label",55),C(20,"Tel\xE9fono"),m(),u(21,"nz-form-control",56),L(22,"input",57),m()(),u(23,"nz-form-item")(24,"nz-form-label",58),C(25,"Sitio web"),m(),u(26,"nz-form-control",59),L(27,"input",60),m()()()}if(t&2){let e=j();F("formGroup",e.validateForm),y(2),F("nzSm",6)("nzXs",24),y(2),F("nzSm",14)("nzXs",24),y(3),F("nzSm",6)("nzXs",24),y(3),F("nzSm",14)("nzXs",24),y(2),F("ngForOf",e.jobType),y(2),F("nzSm",6)("nzXs",24),y(2),F("nzSm",14)("nzXs",24),y(),F("disabled",e.isDisabled),y(2),F("nzSm",6)("nzXs",24),y(2),F("nzSm",14)("nzXs",24),y(3),F("nzSm",6)("nzXs",24),y(2),F("nzSm",14)("nzXs",24)}}var ug=(()=>{class t{constructor(e,n,i){this.messageService=e,this.modalService=n,this.fb=i,this.rolService=we(rr),this.summarizedService=we(S0),this.authService=we(Ot),this.accountsService=we(Un),this.selectedRecord=!1,this.accountsList=[],this.summarized=[],this.loading=!0,this.isVisibleAdd=!1,this.isDeleteVisible=!1,this.isOkLoading=!1,this.infoLoad=[],this.infoSegment=[],this.stopSubscription$=new qt,this.isDisabled=!0,this.currentConsecutive="",this.currentJobType=""}ngOnInit(){this.userSubscription=this.authService.getUser().subscribe(e=>{this.user=e,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(n=>{this.infoLoad=n,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(pt(this.stopSubscription$),Fe(n=>{let i=n.payload.id,a=n.payload.data();return De({id:i},a)}),Ir(n=>(this.infoSegment=n,this.getSubscriptions(),n))).subscribe())}),this.validateForm=this.fb.group({name:[null,[fe.minLength(5),fe.maxLength(40),fe.required]],address:[null,[fe.required]],phoneNumber:[null,[fe.required]],website:[null,[fe.required]],active:[!1],canShowDevices:[!0],showFromHour:[5],jobTypeID:[null,[fe.required]],custConsecutive:[null,[fe.required]],showToHour:[20]})}ngOnDestroy(){this.accountsSubscription&&this.accountsSubscription.unsubscribe(),this.userSubscription&&this.userSubscription.unsubscribe(),this.stopSubscription$&&this.stopSubscription$.unsubscribe()}submitForm(){this.isOkLoading=!0;for(let e in this.validateForm.controls)this.validateForm.controls[e].markAsDirty(),this.validateForm.controls[e].updateValueAndValidity();this.userlevelAccess!="3"?this.accountsService.setAccount(this.validateForm.value,this.currentConsecutive).then(n=>{this.currentJobType.length>0&&this.accountsService.updateJobType(this.currentJobType,this.currentConsecutive).then(()=>{},i=>{this.sendMessage("error",i)}).catch(i=>this.sendMessage("error",i)),this.isVisibleAdd=!1,this.isOkLoading=!1}).catch(n=>this.sendMessage("error",n)):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}toggleAccountActive(e,n){this.accountsService.toggleAccountActive(e,n)}deleteAccount(e){this.isOkLoading=!0,this.userlevelAccess=="1"?this.accountsService.deleteAccount(e.id).then(i=>{this.isOkLoading=!1}).catch(i=>this.sendMessage("error",i)):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}getSubscriptions(){this.loading=!0,this.infoSegment!==void 0&&this.infoSegment.nivelNum==1?this.accountsSubscription=this.accountsService.getAccountsByCustomer(this.user.customerId).pipe(Fe(e=>{let n=e.payload.id,i=e.payload.data();return De({id:n},i)})).subscribe(e=>{this.accountsList=[e],this.loading=!1}):this.accountsSubscription=this.accountsService.getAccounts().pipe(Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return De({id:i},a)}))).subscribe(e=>{this.accountsList=e,this.loading=!1})}deleteAccountModal(e){this.modalService.warning({nzTitle:"\xBFEst\xE1 seguro?",nzContent:"Eliminar\xE1 toda la informaci\xF3n de "+e.name,nzCancelText:"Cancelar",nzOkText:"Eliminar",nzOkLoading:this.isOkLoading,nzOnOk:()=>{this.deleteAccount(e)}})}createBasicMessage(e){this.messageService.success(`Se encontraron ${e} registros.`,{nzDuration:3e3})}showModalAdd(){this.isVisibleAdd=!0,this.accountsSubscription=this.accountsService.getJobType().pipe(Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return De({id:i},a)}))).subscribe(e=>{this.jobType=e})}handleCancel(){this.isVisibleAdd=!1}sendMessage(e,n){this.messageService.create(e,n)}onJobTypeSelected(e){let n=this.jobType.filter(i=>i.uid===e);if(n.length>0){let i=n[0].consecutive;this.currentJobType=e,i=parseInt(i,10)+1,i=i.toString().padStart(4,"0"),this.validateForm.controls.custConsecutive.setValue(n[0].type+i),this.currentConsecutive=i}}static{this.\u0275fac=function(n){return new(n||t)(Te(Ke),Te(Nr),Te(gt))}}static{this.\u0275cmp=rt({type:t,selectors:[["app-dashboard"]],decls:29,vars:6,consts:[["modalContentAdd",""],["avatarTemplate",""],["actionSetting",""],["actionEdit",""],["actionEllipsis",""],["menu","nzDropdownMenu"],[2,"margin","buttom 15px"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"margin-left","350px"],[1,"d-md-flex","align-items-center","d-none"],[1,"media","align-items-center","m-r-40","m-v-5"],[1,"font-size-27"],["nz-icon","","theme","outline",1,"text-primary"],["nz-icon","","theme","outline",1,"text-success"],[1,"media","align-items-center","m-v-5"],["nz-icon","","theme","outline",1,"text-danger"],[1,"media","align-items-center","m-v-5","m-l-10"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],[1,"body"],[4,"ngIf"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","6",4,"ngFor","ngForOf"],["nzTitle","Nueva Empresa","nzCancelText","Cancelar","nzOkText","Crear","nzOkType","primary",3,"nzOnCancel","nzOnOk","nzVisible","nzContent"],["nz-col","","nzSpan","6"],[3,"nzActions"],[3,"nzActive","nzLoading","nzAvatar"],[3,"nzAvatar","nzTitle"],["nzSize","large",2,"vertical-align","middle",3,"ngStyle","nzSrc"],["nz-icon","","nzTooltipTitle","Activo","nzTooltipPlacement","topLeft","nz-tooltip","",3,"nzType","nzTheme","nzTwotoneColor","click",4,"ngIf"],["nz-icon","","nzTooltipTitle","Inactivo","nzTooltipPlacement","topLeft","nz-tooltip","",3,"nzType","nzTheme","nzTwotoneColor","click",4,"ngIf"],["nz-icon","","nzTooltipTitle","Activo","nzTooltipPlacement","topLeft","nz-tooltip","",3,"click","nzType","nzTheme","nzTwotoneColor"],["nz-icon","","nzTooltipTitle","Inactivo","nzTooltipPlacement","topLeft","nz-tooltip","",3,"click","nzType","nzTheme","nzTwotoneColor"],["nz-icon","","nzType","edit","routerLinkActive","router-link-active","nzTooltipTitle","Editar","nzTooltipPlacement","topLeft","nz-tooltip","",3,"routerLink"],["nz-dropdown","","nzPlacement","bottomRight",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","nzTooltipTitle","M\xE1s informaci\xF3n","nzTooltipPlacement","topLeft","nz-tooltip",""],["nz-menu","","nzSelectable",""],["nz-menu-item","","routerLinkActive","router-link-active",3,"routerLink"],["nz-icon","","nzType","user"],["nz-icon","","nzType","shopping"],["nz-icon","","nzType","clock-circle"],["nz-menu-divider",""],["nz-menu-item","",3,"click"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436","nzType","delete"],["nz-form","",3,"ngSubmit","formGroup"],["nzRequired","","nzFor","name",3,"nzSm","nzXs"],["nzErrorTip","Debe contener entre 5 y 30 caracteres.",3,"nzSm","nzXs"],["nz-input","","formControlName","name","id","name"],["nzFor","address","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Ingrese el Giro",3,"nzSm","nzXs"],["formControlName","jobTypeID","nzAllowClear","","nzPlaceHolder","Selecciona el Giro de la Empresa",2,"width","320px",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzRequired","","nzFor","custConsecutive",3,"nzSm","nzXs"],["nzErrorTip","Consecutivo es necesario para crear la empresa.",3,"nzSm","nzXs"],["nz-input","","formControlName","custConsecutive","id","custConsecutive",3,"disabled"],["nzRequired","","nzFor","phoneNumber",3,"nzSm","nzXs"],["nzErrorTip","Ingrese el tel\xE9fono de contacto con la empresa.",3,"nzSm","nzXs"],["nz-input","","formControlName","phoneNumber","id","phoneNumber"],["nzFor","website","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Ingrese el sitio web!",3,"nzSm","nzXs"],["nz-input","","id","website","formControlName","website","placeholder","website"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""]],template:function(n,i){if(n&1){let a=ke();u(0,"div",6)(1,"div",7)(2,"nz-page-header",8)(3,"nz-page-header-title",9),C(4,"CRM"),m(),u(5,"nz-page-header-subtitle"),C(6,"Informaci\xF3n Comercial "),m(),u(7,"nz-page-header-extra")(8,"div",10)(9,"div",11)(10,"div",12),L(11,"i",13),m()(),u(12,"div",11)(13,"div",12),L(14,"i",14),m()(),u(15,"div",15)(16,"div",12),L(17,"i",16),m()(),u(18,"div",17)(19,"button",18),le("click",function(){return se(a),oe(i.showModalAdd())}),C(20,"Nueva Empresa"),m()()()(),L(21,"nz-page-header-footer"),m()(),u(22,"div",19),ue(23,Cl,1,0,"nz-empty",20),u(24,"div",21),ue(25,Il,12,11,"div",22),m()()(),u(26,"nz-modal",23),le("nzOnCancel",function(){return se(a),oe(i.handleCancel())})("nzOnOk",function(){return se(a),oe(i.submitForm())}),m(),ue(27,Pl,28,23,"ng-template",null,0,Ge)}if(n&2){let a=be(28);y(2),F("nzGhost",!1),y(21),F("ngIf",i.accountsList.length===0),y(),F("nzGutter",8),y(),F("ngForOf",i.accountsList),y(),F("nzVisible",i.isVisibleAdd)("nzContent",a)}},dependencies:[xt,Sr,On,Tr,Jt,Yt,Qt,Zt,tr,er,kr,jr,Rn,o0,Xr,Gr,Vn,$r,qr,Kr,Wr,Mt,Lt,Rt,Hr,ta,nr,Wn,Hn,Cr,c0,ir,ar,r0,n0,It,wr,vt,Dt,Nt,Pt,s0]})}}return t})();function Ol(t,r){if(t&1&&L(0,"nz-option",12),t&2){let e=r.$implicit;F("nzValue",e)("nzLabel",e)}}function Ll(t,r){if(t&1&&L(0,"nz-option",12),t&2){let e=r.$implicit;F("nzValue",e)("nzLabel",e)}}function Rl(t,r){if(t&1&&(u(0,"form",6)(1,"nz-form-item")(2,"nz-form-label"),C(3,"Nombre de la Operaci\xF3n"),m(),u(4,"nz-form-control"),L(5,"input",7),m()(),u(6,"nz-form-item")(7,"nz-form-label"),C(8,"Descripci\xF3n"),m(),u(9,"nz-form-control"),L(10,"textarea",8),m()(),u(11,"nz-form-item")(12,"nz-form-label"),C(13,"Horarios Entradas (Opcional)"),m(),u(14,"nz-form-control")(15,"nz-select",9),ue(16,Ol,1,2,"nz-option",10),m()()(),u(17,"nz-form-item")(18,"nz-form-label"),C(19,"Horarios Salidas (Opcional)"),m(),u(20,"nz-form-control")(21,"nz-select",11),ue(22,Ll,1,2,"nz-option",10),m()()()()),t&2){let e=j();F("formGroup",e.objectForm),y(16),F("ngForOf",e.timeOptions),y(6),F("ngForOf",e.timeOptions)}}function Ml(t,r){if(t&1&&(u(0,"nz-tab",13),L(1,"app-shared-stoppoints-list",14),m()),t&2){let e=r.$implicit,n=j();F("nzTitle",n.getTabTitle(e)),y(),F("userCanUpdate",!0)("accountId",n.accountId)("routeId",e.id)}}var k0=(()=>{class t{constructor(e,n,i,a){this.afs=e,this.modalService=n,this.messageService=i,this.fb=a,this.accountId="",this.routesService=we(jn),this.tabs=[],this.nzTabPosition="top",this.selectedIndex=0,this.routesList=[],this.stopPointsList=[],this.stopSubscription$=new qt,this.customersService=we(Mn),this.timeOptions=[]}ngOnInit(){this.createForm(),this.getSubscriptions(),this.generateTimeOptions()}ngOnDestroy(){this.sub.unsubscribe()}generateTimeOptions(){for(let i=7;i<=21;i++){let a=i%12||12,s=i<12?"AM":"PM",o=`${a.toString().padStart(2,"0")}:${i%60===30?"30":"00"} ${s}`;this.timeOptions.push(o)}}createForm(){this.objectForm=this.fb.group({active:[!1,[fe.required]],description:["",[fe.required]],imageUrl:[""],kmzUrl:[""],name:["",[fe.minLength(5),fe.maxLength(20),fe.required]],routeId:[""],customerId:["",[fe.required]],customerName:[""],initialStart:[[]],initialEnd:[[]]})}resetForm(){this.objectForm.reset({active:!1,description:"",imageUrl:"",kmzUrl:"",name:"",routeId:"",customerId:"",customerName:"",initialStart:[],initialEnd:[]})}addNewRoute(e){var n,i;let a=this.modalService.create({nzTitle:"Nueva Operaci\xF3n",nzContent:e,nzFooter:[{label:"Crear Operaci\xF3n ",type:"primary",onClick:()=>this.modalService.confirm({nzTitle:"\xBFEst\xE1 la informaci\xF3n completa?",nzOnOk:()=>{if(this.objectForm.get("customerId").setValue(this.accountId),this.objectForm.valid){let s=this.objectForm.value,o=s.initialStart&&s.initialStart.length>0?s.initialStart.map(p=>({value:p})):null,c=s.initialEnd&&s.initialEnd.length>0?s.initialEnd.map(p=>({value:p})):[],l=De(De({},s),o?{initialStart:o}:{}),f=this.afs.createId(),v=this.routesService.setRoute2(f,this.accountId,this.objectForm.value).then(()=>{}).catch(p=>this.sendMessage("error",p));this.routesService.getInternalCustomer(this.accountId).pipe(pt(this.stopSubscription$),Fe(p=>p.map(x=>{let w=x.payload.doc.id,h=x.payload.doc.data();return fr(De({},h),{id:w})}))).subscribe(p=>{let x=this.objectForm.controls.name.value,w=new Date,S=new Date(w.getFullYear()+3,w.getMonth(),w.getDate()).toISOString();var D="";let I={authorization:"portalAuth",operation_type:"in",method:"Liquidacion",transaction_type:"charge",card:{type:"",brand:"",address:"",card_number:"",holder_name:"",expiration_year:"",expiration_month:"",allows_charges:"",allows_payouts:"",bank_name:"",bank_code:"",points_card:"",points_type:""},status:"completed",conciliated:!1,creation_date:new Date().toISOString(),operation_date:new Date().toISOString(),description:"Pago a traves de portal",error_message:"",order_id:"portalOrder",currency:"MXN",amount:0,customer:{name:"",last_name:"",email:"",phone_number:"",address:"",creation_date:"",external_id:"",clabe:""},product:{product_id:"",amountTrips:0,frequencies:0,rangeWeeks:{},weeks:0,name:""},customerId:this.accountId,active:!0,category:"permanente",date_created:new Date().toISOString(),product_description:"Pago a traves de portal proceso interno al crear una ruta",product_id:"",name:x,isTaskIn:"false",isTaskOut:"false",type:"Servicio",isOpenpay:!1,paidApp:"portal",price:0,round:"",routeId:f,routeName:x,stopDescription:"",stopId:"",stopName:"Internal",validFrom:new Date().toISOString(),validTo:S,idBoardingPass:p[0].id,idPurchasteRequest:"",is_courtesy:!1,typePayment:"Liquidacion"};n={active:!0,amountPayment:0,payment:"Liquidacion",status:"completed",customer_id:this.accountId,customerId:this.accountId,creation_date:new Date().toISOString(),name:"internal",price:0,operation_date:new Date().toISOString(),routeId:f,routeName:x,round:"",stopName:"internal",stopId:"",typePayment:"Liquidacion",validFrom:new Date().toISOString(),validTo:S,idBoardingPass:p[0].uid,idPurchaseRequest:"",baja:!1,type:"Servicio",fileURL:D},this.customersService.saveBoardingPassToUserPurchaseCollection(p[0].id,I).then(P=>{this.customersService.saveBoardingPassDetailToUserPurchaseCollection(p[0].id,f,I).then(H=>{let Z=p[0];this.customersService.createPurchaseCloud(I,Z,p[0].id)}).catch(H=>{this.sendMessage("error",H)})}).catch(P=>{this.sendMessage("error",P)}),this.modalService.closeAll()})}}})}],nzWidth:500})}getSubscriptions(){this.sub=this.routesService.getRoutes(this.accountId).pipe(Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return fr(De({},a),{id:i})}))).subscribe(e=>{this.routesList=e,e.forEach(n=>{this.tabs.push({name:n.name,content:`Content of tab ${n.name}`})})})}getTabTitle(e){return`${e.name}`}sendMessage(e,n){this.messageService.create(e,n)}static{this.\u0275fac=function(n){return new(n||t)(Te(Er),Te(Nr),Te(Ke),Te(gt))}}static{this.\u0275cmp=rt({type:t,selectors:[["app-shared-routes-list"]],inputs:{accountId:"accountId"},decls:9,vars:4,consts:[["newProjectContent",""],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],[3,"nzSelectedIndexChange","nzTabPosition","nzSelectedIndex"],[3,"nzTitle",4,"ngFor","ngForOf"],["nz-form","","nzLayout","vertical",3,"formGroup"],["type","text","formControlName","name","nz-input","","placeholder","Escriba el nombre de la Operaci\xF3n"],["formControlName","description","nz-input",""],["formControlName","initialStart","nzMode","multiple"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["formControlName","initialEnd","nzMode","multiple"],[3,"nzValue","nzLabel"],[3,"nzTitle"],[3,"userCanUpdate","accountId","routeId"]],template:function(n,i){if(n&1){let a=ke();u(0,"div",1)(1,"nz-page-header",2)(2,"nz-page-header-extra")(3,"button",3),le("click",function(){se(a);let o=be(6);return oe(i.addNewRoute(o))}),C(4,"Agregar Operaci\xF3n"),m()()()(),ue(5,Rl,23,3,"ng-template",null,0,Ge),u(7,"nz-tabset",4),kt("nzSelectedIndexChange",function(o){return se(a),Tt(i.selectedIndex,o)||(i.selectedIndex=o),oe(o)}),ue(8,Ml,2,4,"nz-tab",5),m()}n&2&&(y(),F("nzGhost",!1),y(6),F("nzTabPosition",i.nzTabPosition),Et("nzSelectedIndex",i.selectedIndex),y(),F("ngForOf",i.routesList))},dependencies:[xt,Jt,Yt,Qt,Zt,tr,er,kr,Mt,Lt,Rt,nr,Cr,ir,ar,It,wr,vt,Dt,Nt,Pt,Xn,Gn,h0]})}}return t})();var oa=Ks(gl());function Ul(t,r){if(t&1&&(u(0,"nz-tag",10),C(1,"Dom"),m()),t&2){let e=j().$implicit;F("nzColor",e.isSunday?"geekblue":"")}}function Wl(t,r){if(t&1&&(u(0,"nz-tag",10),C(1,"Lun"),m()),t&2){let e=j().$implicit;F("nzColor",e.isMonday?"geekblue":"")}}function Hl(t,r){if(t&1&&(u(0,"nz-tag",10),C(1,"Mar"),m()),t&2){let e=j().$implicit;F("nzColor",e.isTuesday?"geekblue":"")}}function Gl(t,r){if(t&1&&(u(0,"nz-tag",10),C(1,"Mi\xE9"),m()),t&2){let e=j().$implicit;F("nzColor",e.isWednesday?"geekblue":"")}}function Xl(t,r){if(t&1&&(u(0,"nz-tag",10),C(1,"Jue"),m()),t&2){let e=j().$implicit;F("nzColor",e.isThursday?"geekblue":"")}}function jl(t,r){if(t&1&&(u(0,"nz-tag",10),C(1,"Vie"),m()),t&2){let e=j().$implicit;F("nzColor",e.isFriday?"geekblue":"")}}function $l(t,r){if(t&1&&(u(0,"nz-tag",10),C(1,"S\xE1b"),m()),t&2){let e=j().$implicit;F("nzColor",e.isSaturday?"geekblue":"")}}function ql(t,r){t&1&&L(0,"i",24)}function Kl(t,r){if(t&1){let e=ke();u(0,"li",19),le("click",function(){se(e);let i=j().$implicit,a=j(2);return oe(a.toggleActive(i))}),L(1,"i",25),C(2," Activar "),m()}}function Yl(t,r){if(t&1){let e=ke();u(0,"li",19),le("click",function(){se(e);let i=j().$implicit,a=j(2);return oe(a.toggleActive(i))}),L(1,"i",26),C(2," Desactivar "),m()}}function Jl(t,r){if(t&1){let e=ke();u(0,"tr")(1,"td"),C(2),m(),u(3,"td"),C(4),m(),u(5,"td")(6,"nz-tag",10),C(7),m()(),u(8,"td"),ue(9,Ul,2,1,"nz-tag",11)(10,Wl,2,1,"nz-tag",11)(11,Hl,2,1,"nz-tag",11)(12,Gl,2,1,"nz-tag",11)(13,Xl,2,1,"nz-tag",11)(14,jl,2,1,"nz-tag",11)(15,$l,2,1,"nz-tag",11),m(),u(16,"td"),C(17),m(),u(18,"td"),C(19),Nn(20,"date"),m(),u(21,"td")(22,"nz-tag",10),ue(23,ql,1,0,"i",12),u(24,"span"),C(25),m()()(),u(26,"td")(27,"nz-tag",13),C(28),m(),C(29),m(),u(30,"td")(31,"nz-tag",14),C(32),m(),C(33),m(),u(34,"td"),C(35),m(),u(36,"td")(37,"a",15),L(38,"i",16),m(),u(39,"nz-dropdown-menu",null,2)(41,"ul",17),ue(42,Kl,3,0,"li",18)(43,Yl,3,0,"li",18),u(44,"li",19),le("click",function(){let i=se(e).$implicit,a=j(2);return oe(a.showModalEdit(i))}),L(45,"i",20),C(46," Editar "),m(),L(47,"li",21),u(48,"li",22),le("nzOnConfirm",function(){let i=se(e).$implicit,a=j(2);return oe(a.showModalDelete(i))})("nzOnCancel",function(){se(e);let i=j(2);return oe(i.handleCancel())}),L(49,"i",23),C(50," Eliminar "),m()()()()()}if(t&2){let e=r.$implicit,n=be(40),i=j(2);y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(),Ce(e.vendorName),y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(),Ce(i.getRouteName(e.routeId)),y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(),F("nzColor",e.program=="M"?"green":"red"),y(),Ce(e.program=="M"?"Mete":"Saca"),y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(),F("ngIf",e.isSunday),y(),F("ngIf",e.isMonday),y(),F("ngIf",e.isTuesday),y(),F("ngIf",e.isWednesday),y(),F("ngIf",e.isThursday),y(),F("ngIf",e.isFriday),y(),F("ngIf",e.isSaturday),y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(),Ce(e.round),y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(),Be("",Pn(20,46,e.time.toDate(),"HH:mm")," "),y(2),Kt(e.active?"text-dark":"text-muted font-italic"),y(),F("nzColor",e.acRequired?"blue":""),y(),F("ngIf",e.acRequired),y(2),Ce(e.acRequired?"":"No"),y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(2),Ce(e.stopBeginHour),y(),Be(" ",e.stopBeginName,""),y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(2),Ce(e.stopEndHour),y(),Be(" ",e.stopEndName,""),y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(),Ce(e.type),y(),Kt(e.active?"text-dark":"text-muted font-italic"),y(),F("nzDropdownMenu",n),y(5),F("ngIf",!e.active),y(),F("ngIf",e.active)}}function Zl(t,r){if(t&1){let e=ke();u(0,"nz-table",8,1),kt("nzPageSizeChange",function(i){se(e);let a=j();return Tt(a.pageSize,i)||(a.pageSize=i),oe(i)}),u(2,"thead")(3,"tr")(4,"th"),C(5,"Asignado A"),m(),u(6,"th"),C(7,"Operaci\xF3n"),m(),u(8,"th"),C(9,"Tarea"),m(),u(10,"th"),C(11,"D\xEDas"),m(),u(12,"th"),C(13,"Turno"),m(),u(14,"th"),C(15,"Hora"),m(),u(16,"th"),C(17,"AC"),m(),u(18,"th"),C(19,"Inicio"),m(),u(20,"th"),C(21,"Fin"),m(),u(22,"th"),C(23,"Tipo"),m(),L(24,"th"),m()(),u(25,"tbody"),ue(26,Jl,51,49,"tr",9),m()()}if(t&2){let e=be(1),n=j();F("nzData",n.programsList)("nzLoading",n.loading),Et("nzPageSize",n.pageSize),y(26),F("ngForOf",e.data)}}function Ql(t,r){if(t&1&&(u(0,"nz-option",50),L(1,"i",51),C(2),L(3,"br"),C(4),m()),t&2){let e=r.$implicit;F("nzLabel",e.name)("nzValue",e.id),y(2),Be(" ",e.name," "),y(2),Be(" ",e.description,"")}}function ef(t,r){if(t&1&&(u(0,"nz-option",50),L(1,"i",51),C(2),L(3,"br"),C(4),m()),t&2){let e=r.$implicit;F("nzLabel",e.name)("nzValue",e.id),y(2),Be(" ",e.name," "),y(2),Be(" ",e.description,"")}}function tf(t,r){if(t&1&&(u(0,"nz-option",50),L(1,"i",51),C(2),L(3,"br"),C(4),m()),t&2){let e=r.$implicit;F("nzLabel",e.name)("nzValue",e.id),y(2),Be(" ",e.name," "),y(2),Be(" ",e.description,"")}}function rf(t,r){if(t&1&&(u(0,"nz-option",50),L(1,"i",51),C(2),L(3,"br"),C(4),m()),t&2){let e=r.$implicit;F("nzLabel",e.name)("nzValue",e.id),y(2),Be(" ",e.name," "),y(2),Be(" ",e.description,"")}}function nf(t,r){if(t&1){let e=ke();u(0,"form",27),le("ngSubmit",function(){se(e);let i=j();return oe(i.createProgram())}),u(1,"nz-form-item")(2,"nz-form-label"),C(3,"Divisi\xF3n"),m(),u(4,"nz-form-control")(5,"nz-select",28),le("ngModelChange",function(i){se(e);let a=j();return oe(a.onVendorSelected(i,"vendorName"))}),ue(6,Ql,5,4,"nz-option",29),m()()(),u(7,"div",30)(8,"div",31)(9,"nz-form-item")(10,"nz-form-label"),C(11,"Tipo de asignaci\xF3n"),m(),u(12,"nz-form-control")(13,"nz-select",32),L(14,"nz-option",33),m()()()(),u(15,"div",31)(16,"nz-form-item")(17,"nz-form-label"),C(18,"Operaci\xF3n"),m(),u(19,"nz-form-control")(20,"nz-select",34),le("ngModelChange",function(i){se(e);let a=j();return oe(a.onRouteSelected(i))}),ue(21,ef,5,4,"nz-option",29),m()()()()(),u(22,"div",30)(23,"div",31)(24,"nz-form-item")(25,"nz-form-label"),C(26,"Turno"),m(),u(27,"nz-form-control")(28,"nz-select",35),L(29,"nz-option",36)(30,"nz-option",37)(31,"nz-option",38),m()()()(),u(32,"div",31)(33,"nz-form-item")(34,"nz-form-label"),C(35,"Tarea"),m(),u(36,"nz-form-control")(37,"nz-select",39),L(38,"nz-option",40)(39,"nz-option",41),m()()()()(),u(40,"div",30)(41,"div",42)(42,"nz-form-item")(43,"nz-form-label"),C(44,"Hora Compromiso"),m(),u(45,"nz-form-control"),L(46,"nz-time-picker",43),m()()(),u(47,"div",42)(48,"nz-form-item")(49,"nz-form-label"),C(50,"Hora Inicio"),m(),u(51,"nz-form-control"),L(52,"nz-time-picker",44),m()()(),u(53,"div",42)(54,"nz-form-item")(55,"nz-form-label"),C(56,"Hora fin"),m(),u(57,"nz-form-control"),L(58,"nz-time-picker",45),m()()()(),u(59,"nz-form-item")(60,"nz-form-label",46),C(61,"D\xEDas"),m(),u(62,"nz-form-control")(63,"nz-tag",47),le("nzCheckedChange",function(i){se(e);let a=j();return oe(a.checkChange("isSunday",i))}),C(64,"Dom"),m(),u(65,"nz-tag",47),le("nzCheckedChange",function(i){se(e);let a=j();return oe(a.checkChange("isMonday",i))}),C(66,"Lun"),m(),u(67,"nz-tag",47),le("nzCheckedChange",function(i){se(e);let a=j();return oe(a.checkChange("isTuesday",i))}),C(68,"Mar"),m(),u(69,"nz-tag",47),le("nzCheckedChange",function(i){se(e);let a=j();return oe(a.checkChange("isWednesday",i))}),C(70,"Mi\xE9"),m(),u(71,"nz-tag",47),le("nzCheckedChange",function(i){se(e);let a=j();return oe(a.checkChange("isThursday",i))}),C(72,"Jue"),m(),u(73,"nz-tag",47),le("nzCheckedChange",function(i){se(e);let a=j();return oe(a.checkChange("isFriday",i))}),C(74,"Vie"),m(),u(75,"nz-tag",47),le("nzCheckedChange",function(i){se(e);let a=j();return oe(a.checkChange("isSaturday",i))}),C(76,"S\xE1b"),m()()(),u(77,"div",30)(78,"div",31)(79,"nz-form-item")(80,"nz-form-label"),C(81,"Inicia en"),m(),u(82,"nz-form-control")(83,"nz-select",48),le("ngModelChange",function(i){se(e);let a=j();return oe(a.onStopPointSelected(i,"stopBeginName","stopBeginHourT"))}),ue(84,tf,5,4,"nz-option",29),m()()()(),u(85,"div",31)(86,"nz-form-item")(87,"nz-form-label"),C(88,"Termina en"),m(),u(89,"nz-form-control")(90,"nz-select",49),le("ngModelChange",function(i){se(e);let a=j();return oe(a.onStopPointSelected(i,"stopEndName","stopEndHourT"))}),ue(91,rf,5,4,"nz-option",29),m()()()()()()}if(t&2){let e=j();F("formGroup",e.programForm),y(6),F("ngForOf",e.vendorsList),y(15),F("ngForOf",e.routesList),y(42),F("nzChecked",e.programForm.controls.isSunday.value),y(2),F("nzChecked",e.programForm.controls.isMonday.value),y(2),F("nzChecked",e.programForm.controls.isTuesday.value),y(2),F("nzChecked",e.programForm.controls.isWednesday.value),y(2),F("nzChecked",e.programForm.controls.isThursday.value),y(2),F("nzChecked",e.programForm.controls.isFriday.value),y(2),F("nzChecked",e.programForm.controls.isSaturday.value),y(9),F("ngForOf",e.stopPointsList),y(7),F("ngForOf",e.stopPointsList)}}var y0=(()=>{class t{constructor(e,n,i){this.notification=e,this.messageService=n,this.fb=i,this.rolService=we(rr),this.authService=we(Ot),this.vendorsService=we($n),this.routesService=we(jn),this.loading=!0,this.pageSize=10,this.stopSubscription$=new qt,this.programsList=[],this.routesList=[],this.stopPointsList=[],this.vendorsList=[],this.isCreateVisible=!1,this.isEditMode=!1,this.infoLoad=[],this.authService.user.subscribe(a=>{a&&(this.user=a,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&this.rolService.getRol(this.user.rolId).valueChanges().subscribe(s=>{this.infoLoad=s,this.userlevelAccess=this.infoLoad.optionAccessLavel}))}),this.createForm()}ngOnInit(){this.getSubscriptions()}ngOnDestroy(){this.stopSubscription$.next(void 0),this.stopSubscription$.complete()}getSubscriptions(){this.routesService.getRoutes(this.accountId).pipe(pt(this.stopSubscription$),Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return De({id:i},a)}))).subscribe(e=>{this.routesList=e,this.loading=!1}),this.routesService.getCustomerVendorAssignments(this.accountId).pipe(pt(this.stopSubscription$),Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return fr(De({},a),{id:i})}))).subscribe(e=>{this.programsList=e,this.loading=!1}),this.vendorsService.getVendors().pipe(pt(this.stopSubscription$),Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return fr(De({},a),{id:i})}))).subscribe(e=>{this.vendorsList=e,this.loading=!1})}getRouteName(e){let n="";if(this.routesList.length>0){let i=oa.filter(this.routesList,a=>a.id==e);i.length>0&&(n=i[0].name)}return n}createForm(){this.programForm=this.fb.group({active:[!1,[fe.required]],acRequired:[!1,[fe.required]],isSunday:[!1,[fe.required]],isMonday:[!0,[fe.required]],isTuesday:[!0,[fe.required]],isWednesday:[!0,[fe.required]],isThursday:[!0,[fe.required]],isFriday:[!0,[fe.required]],isSaturday:[!1,[fe.required]],program:["",[fe.required]],round:["",[fe.required]],stopBeginId:["",[fe.required]],stopBeginName:["",[fe.required]],stopBeginHour:["",[fe.required]],stopBeginHourT:[""],stopEndId:["",[fe.required]],stopEndName:["",[fe.required]],stopEndHour:["",[fe.required]],stopEndHourT:[""],time:[new Date,[fe.required]],type:[this.assigmentType,[fe.required]],customerName:["",[fe.required]],customerId:[this.accountId,[fe.required]],vendorName:["",[fe.required]],vendorId:["",[fe.required]],routeId:["",[fe.required]]})}patchForm(e){let n=e.stopBeginHour.split(":"),i=e.stopEndHour.split(":");this.programForm.patchValue({active:e.active,acRequired:e.acRequired,isSunday:e.isSunday,isMonday:e.isMonday,isTuesday:e.isTuesday,isWednesday:e.isWednesday,isThursday:e.isThursday,isFriday:e.isFriday,isSaturday:e.isSaturday,program:e.program,round:e.round,stopBeginId:e.stopBeginId,stopBeginName:e.stopBeginName,stopBeginHour:e.stopBeginHour,stopBeginHourT:e.stopBeginHour,stopEndId:e.stopEndId,stopEndName:e.stopEndName,stopEndHour:e.stopEndHour,stopEndHourT:e.stopEndHour,time:e.time,type:e.type,customerName:e.customerName,customerId:this.accountId,vendorName:e.vendorName,vendorId:e.vendorId,routeId:e.routeId})}toggleActive(e){this.routesService.toggleRouteAssignment(this.accountId,e.routeId,e.id,e).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1}).catch(n=>this.sendMessage("error",n))}showCreateModal(){this.programForm.reset(),this.isCreateVisible=!0,this.currentSelectedId="",this.currentSelected=null}sendMessage(e,n){this.messageService.create(e,n)}showModalDelete(e){this.userlevelAccess=="1"?this.routesService.deleteRouteAssignments(this.accountId,e.routeId,e.id).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1}).catch(n=>this.sendMessage("error",n)):this.sendMessage("error","El usuario no tiene permisos para borrar datos, favor de contactar al administrador.")}showModalEdit(e){this.currentSelectedId=e.id,this.currentSelected=e,this.patchForm(e),setTimeout(()=>{this.isCreateVisible=!0},100),this.isEditMode=!0}handleCancel(){this.isCreateVisible=!1,this.isEditMode=!1,this.currentSelectedId=""}createProgram(){this.programForm!==null&&this.programForm!==void 0&&this.programForm.get("customerId").setValue(this.accountId);let e=new Date(this.programForm.controls.stopBeginHourT.value),n=new Date(this.programForm.controls.stopEndHourT.value),i=[e.getHours(),String(e.getMinutes()).padStart(2,"0")].join(":"),a=[n.getHours(),String(n.getMinutes()).padStart(2,"0")].join(":");this.programForm.controls.stopBeginHour.setValue(i),this.programForm.controls.stopEndHour.setValue(a);let s=this.programForm.get("stopBeginHour"),o=this.programForm.get("stopEndHour");if(s==""||o==""){this.notification.create("error","Problema con la informaci\xF3n","No est\xE1n definidos los tiempos entre estaci\xF3n de esta operaci\xF3n para el turno seleccionado");return}if(this.isEditMode)if(this.userlevelAccess!="3"){let c=this.programForm.get("routeId");if(c){this.routesService.updateRouteAssignment(this.accountId,c,this.currentSelectedId,this.programForm.value).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1,this.currentSelectedId=""}).catch(l=>this.sendMessage("error",l));return}}else{this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.");return}else if(this.userlevelAccess!="3"){let c=this.programForm.get("routeId");if(c){this.routesService.setRouteAssignments(this.accountId,c.value,this.programForm.value).then(()=>{this.isCreateVisible=!1,this.isEditMode=!1}).catch(l=>this.sendMessage("error",l));return}}else{this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.");return}}checkChange(e,n){this.programForm.controls[e].setValue(n)}onRouteSelected(e){this.routesService.getRouteStopPoints(this.accountId,e).pipe(pt(this.stopSubscription$),Fe(n=>n.map(i=>{let a=i.payload.doc.id,s=i.payload.doc.data();return fr(De({},s),{id:a})}))).subscribe(n=>{this.stopPointsList=n,this.loading=!1})}onStopPointSelected(e,n,i){let a=this.programForm.controls.time.value,s=this.programForm.controls.program.value,o=n,c="";if(s=="M"?o=="stopBeginName"?c="stopBeginHourT":c="stopEndHourT":o=="stopEndName"?c="stopBeginHourT":c="stopEndHourT",e){let f=oa.filter(this.stopPointsList,p=>p.id==e)[0],v=this.programForm.controls.round.value;switch(this.programForm.controls[n].setValue(f.name),v){case"D\xEDa":this.programForm.controls[c].setValue(ki(a,f.round1MinutesSinceStart));break;case"Tarde":this.programForm.controls[c].setValue(ki(a,f.round2MinutesSinceStart));break;case"Noche":this.programForm.controls[c].setValue(ki(a,f.round3MinutesSinceStart));break;default:this.programForm.controls[c].setValue(ki(a,f.round1MinutesSinceStart));break}}}onVendorSelected(e,n){if(e){let a=oa.filter(this.vendorsList,s=>s.id==e)[0];this.programForm.controls[n].setValue(a.name)}}static{this.\u0275fac=function(n){return new(n||t)(Te(ea),Te(Ke),Te(gt))}}static{this.\u0275cmp=rt({type:t,selectors:[["app-shared-customer-vendor-assignments"]],inputs:{accountId:"accountId"},decls:9,vars:4,consts:[["modalContentAdd",""],["programsListTable",""],["menu","nzDropdownMenu"],[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nzShowSizeChanger","",3,"nzData","nzLoading","nzPageSize","nzPageSizeChange",4,"ngIf"],["nzTitle","Agregar asignaci\xF3n","nzWidth","600","nzOkText","Generar",3,"nzOnCancel","nzOnOk","nzVisible","nzContent"],["nzShowSizeChanger","",3,"nzPageSizeChange","nzData","nzLoading","nzPageSize"],[4,"ngFor","ngForOf"],[3,"nzColor"],[3,"nzColor",4,"ngIf"],["nz-icon","","nzType","deployment-unit",4,"ngIf"],["nzColor","green"],["nzColor","orange"],["nz-dropdown","","nzPlacement","bottomRight",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","nzTooltipTitle","M\xE1s informaci\xF3n","nzTooltipPlacement","topLeft","nz-tooltip",""],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item","",3,"click"],["nz-icon","","nzType","edit"],["nz-menu-divider",""],["nz-menu-item","","nz-popconfirm","","nzPopconfirmTitle","\xBFEst\xE1s seguro de eliminar esta asignaci\xF3n?","nzPopconfirmPlacement","topRight",3,"nzOnConfirm","nzOnCancel"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#de4436","nzType","delete"],["nz-icon","","nzType","deployment-unit"],["nz-icon","","nzType","check-circle"],["nz-icon","","nzType","pause-circle"],["nz-form","",3,"ngSubmit","formGroup"],["formControlName","vendorId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[1,"row"],[1,"col-md-6","col-sm-12"],["formControlName","type"],["nzValue","Permanente","nzLabel","Permanente"],["formControlName","routeId",3,"ngModelChange"],["formControlName","round"],["nzValue","D\xEDa","nzLabel","D\xEDa"],["nzValue","Tarde","nzLabel","Tarde"],["nzValue","Noche","nzLabel","Noche"],["formControlName","program"],["nzValue","M","nzLabel","Mete"],["nzValue","S","nzLabel","Saca"],[1,"col-md-4","col-sm-12"],["name","time","formControlName","time","nzFormat","HH:mm"],["name","stopBeginHourT","formControlName","stopBeginHourT","nzFormat","HH:mm"],["name","stopEndHourT","formControlName","stopEndHourT","nzFormat","HH:mm"],["nzFor","days"],["nzMode","checkable",3,"nzCheckedChange","nzChecked"],["formControlName","stopBeginId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["formControlName","stopEndId","nzAllowClear","","nzPlaceHolder","Selecciona la estaci\xF3n",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon","","nzType","flag"]],template:function(n,i){if(n&1){let a=ke();u(0,"div",3)(1,"nz-page-header",4)(2,"nz-page-header-extra")(3,"button",5),le("click",function(){return se(a),oe(i.showCreateModal())}),C(4,"Agregar asignaci\xF3n"),m()()()(),ue(5,Zl,27,4,"nz-table",6),u(6,"nz-modal",7),le("nzOnCancel",function(){return se(a),oe(i.handleCancel())})("nzOnOk",function(){return se(a),oe(i.createProgram())}),m(),ue(7,nf,92,12,"ng-template",null,0,Ge)}if(n&2){let a=be(8);y(),F("nzGhost",!1),y(4),F("ngIf",i.routesList.length>0),y(),F("nzVisible",i.isCreateVisible)("nzContent",a)}},dependencies:[xt,Sr,Tr,Jt,Yt,Qt,Zt,tr,er,Qr,Yr,Jr,tn,Zr,en,jr,Xr,Gr,Vn,$r,qr,Kr,Wr,Mt,Lt,Rt,nr,Cr,qn,ir,ar,It,vt,Dt,Nt,Pt,d0,m0,Qi]})}}return t})();var F0=(()=>{class t{constructor(e,n){this.afs=e,this.messageService=n,this.promotion=this.afs.collection("customer")}getPromotionsList(e){return this.afs.collection("customers").doc(e).collection("promotions",i=>i.orderBy("date_created","asc")).snapshotChanges()}savePromotion(e,n){let i=this.afs.createId(),a=this.afs.collection("customers").doc(n).collection("promotions").doc(i),s=this.afs.firestore.batch();return s.set(a.ref,e),s.commit()}editPromotion(e,n,i,a,s,o){return this.afs.collection("customers").doc(n).collection("promotions").doc(e).update({name:i,description:a,validFrom:s,validTo:s}).then(()=>{this.sendMessage("success","\xA1Listo! la promoci\xF3n fue actualizada")}).catch(l=>{this.sendMessage("error",`\xA1Oops! Algo sali\xF3 mal ... ${l}`)})}deactivePromotion(e,n,i){return this.afs.collection("customers").doc(i).collection("promotions").doc(e).update({active:n}).then(()=>{this.sendMessage("success","\xA1Listo! la promoci\xF3n fue desactivada")}).catch(s=>{this.sendMessage("error",`\xA1Oops! Algo sali\xF3 mal ... ${s}`)})}deletePromotion(e,n){this.afs.collection("customers").doc(e).collection("promotions").doc(n).delete().then(()=>this.sendMessage("success","La Promocion a sido eliminada.")).catch(a=>this.sendMessage("error",`\xA1Oops! Algo sali\xF3 mal ... ${a}`))}sendMessage(e,n){this.messageService.create(e,n)}static{this.\u0275fac=function(n){return new(n||t)(pn(Er),pn(Ke))}}static{this.\u0275prov=Dn({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var sf=()=>({width:"100%"});function of(t,r){t&1&&(u(0,"nz-tag",20),C(1,"Activo"),m()),t&2&&F("nzColor","cyan")}function cf(t,r){t&1&&(u(0,"nz-tag",20),C(1,"Suspendido"),m()),t&2&&F("nzColor","red")}function lf(t,r){if(t&1){let e=ke();u(0,"li",27),le("click",function(){se(e);let i=j().$implicit,a=j(2);return oe(a.diactivePromotion(!1,i.id))}),C(1,"Suspender Promoci\xF3n "),m()}}function ff(t,r){if(t&1){let e=ke();u(0,"li",27),le("click",function(){se(e);let i=j().$implicit,a=j(2);return oe(a.diactivePromotion(!0,i.id))}),C(1,"Reactivar Promoci\xF3n "),m()}}function uf(t,r){if(t&1){let e=ke();u(0,"tr",18),le("click",function(){let i=se(e).$implicit,a=j(2);return oe(a.promotionSelected(i))}),u(1,"td"),ue(2,of,2,1,"nz-tag",19)(3,cf,2,1,"nz-tag",19),m(),u(4,"td")(5,"nz-tag",20),C(6),m()(),u(7,"td")(8,"nz-tag",20),C(9),m()(),u(10,"td")(11,"span",21),C(12),Nn(13,"date"),m()(),u(14,"td")(15,"span",21),C(16),Nn(17,"date"),m()(),u(18,"td")(19,"span",21),C(20),Nn(21,"date"),m()(),u(22,"td")(23,"a",22),C(24,"Ver Imagen"),m()(),u(25,"td")(26,"a",23),L(27,"i",24),m(),u(28,"nz-dropdown-menu",null,4)(30,"ul",25),ue(31,lf,2,0,"li",26)(32,ff,2,0,"li",26),u(33,"li",27),le("click",function(){let i=se(e).$implicit,a=j(2);return oe(a.editPromotion(i.id,i.name,i.description,i.validFrom.toDate(),i.validTo.toDate()))}),C(34,"Editar Promoci\xF3n"),m(),u(35,"li",27),le("click",function(){let i=se(e).$implicit,a=j(2);return oe(a.deletePromotiom(i.id))}),C(36,"Borrar Promoci\xF3m"),m()()()()()}if(t&2){let e=r.$implicit,n=be(29);y(2),F("ngIf",e.active),y(),F("ngIf",!e.active),y(2),F("nzColor","blue"),y(),Ce(e.name),y(2),F("nzColor","blue"),y(),Ce(e.description),y(3),Be(" ",e.validFrom?Pn(13,13,e.validFrom.toDate(),"mediumDate"):""," "),y(4),Be(" ",e.validTo?Pn(17,16,e.validTo.toDate(),"mediumDate"):""," "),y(4),Be(" ",e.date_created?Pn(21,19,e.date_created.toDate(),"mediumDate"):""," "),y(3),vn("href",e.imageUrl,xn),y(3),F("nzDropdownMenu",n),y(5),F("ngIf",e.active),y(),F("ngIf",!e.active)}}function hf(t,r){if(t&1&&(u(0,"nz-table",16,3)(2,"thead")(3,"tr")(4,"th"),C(5,"Activo"),m(),u(6,"th"),C(7,"Nombre"),m(),u(8,"th"),C(9,"Descripci\xF3n"),m(),u(10,"th"),C(11,"Desde "),m(),u(12,"th"),C(13,"Hasta"),m(),u(14,"th"),C(15,"Fecha Creaci\xF3n"),m(),u(16,"th"),C(17,"Imagen"),m(),L(18,"th"),m()(),u(19,"tbody"),ue(20,uf,37,22,"tr",17),m()()),t&2){let e=be(1),n=j();F("nzData",n.promotionsList)("nzPageSize",n.pageSize3)("nzLoading",n.loadingLatestPurchases)("nzLoadingDelay",500),y(20),F("ngForOf",e.data)}}function df(t,r){if(t&1&&L(0,"img",41),t&2){let e=j(2);F("src",e.previewImage,xn)("ngStyle",_r(2,sf))}}function mf(t,r){if(t&1){let e=ke();u(0,"form",28),le("ngSubmit",function(){se(e);let i=j();return oe(i.createPromotion())}),u(1,"div",29)(2,"div",30)(3,"nz-form-item")(4,"nz-form-label"),C(5,"Nombre"),m(),u(6,"nz-form-control"),L(7,"input",31),m()()(),u(8,"div",30)(9,"nz-form-item")(10,"nz-form-label"),C(11,"Descripci\xF3n"),m(),u(12,"nz-form-control"),L(13,"input",32),m()()(),u(14,"div",33)(15,"nz-form-item")(16,"nz-form-label"),C(17,"Fecha Inicio"),m(),u(18,"nz-form-control"),L(19,"nz-date-picker",34),m()()(),u(20,"div",33)(21,"nz-form-item")(22,"nz-form-label"),C(23,"Fecha Fin"),m(),u(24,"nz-form-control"),L(25,"nz-date-picker",35),m()()(),u(26,"div",33)(27,"nz-form-item")(28,"nz-form-label"),C(29,"Fecha de Creaci\xF3n"),m(),u(30,"nz-form-control"),L(31,"nz-date-picker",36),m()()(),u(32,"div",30)(33,"nz-form-item")(34,"nz-form-label"),C(35,"Adjuntar Promoci\xF3n"),m(),u(36,"nz-form-control")(37,"nz-upload",37),kt("nzFileListChange",function(i){se(e);let a=j();return Tt(a.fileList,i)||(a.fileList=i),oe(i)}),le("nzChange",function(i){se(e);let a=j();return oe(a.handleChange2(i))}),L(38,"i",38),u(39,"div",39),C(40,"Cargar"),m()(),u(41,"nz-modal",40),le("nzOnCancel",function(){se(e);let i=j();return oe(i.previewVisible=!1)}),m()(),ue(42,df,1,3,"ng-template",null,1,Ge),m()()()()}if(t&2){let e=be(43),n=j();F("formGroup",n.programForm),y(37),Et("nzFileList",n.fileList),F("nzShowButton",!0)("nzShowUploadList",n.showUploadList)("nzPreview",n.handlePreview),y(4),F("nzVisible",n.previewVisible)("nzContent",e)("nzFooter",null)}}function pf(t,r){if(t&1){let e=ke();u(0,"form",28),le("ngSubmit",function(){se(e);let i=j();return oe(i.editSavePromotion())}),u(1,"div",29)(2,"div",30)(3,"nz-form-item")(4,"nz-form-label"),C(5,"Nombre"),m(),u(6,"nz-form-control"),L(7,"input",31),m()()(),u(8,"div",30)(9,"nz-form-item")(10,"nz-form-label"),C(11,"Descripci\xF3n"),m(),u(12,"nz-form-control"),L(13,"input",32),m()()(),u(14,"div",33)(15,"nz-form-item")(16,"nz-form-label"),C(17,"Fecha Inicio"),m(),u(18,"nz-form-control"),L(19,"nz-date-picker",34),m()()(),u(20,"div",33)(21,"nz-form-item")(22,"nz-form-label"),C(23,"Fecha Fin"),m(),u(24,"nz-form-control"),L(25,"nz-date-picker",35),m()()()()()}if(t&2){let e=j();F("formGroup",e.programEditForm)}}var D0=(()=>{class t{constructor(e,n,i){this.bucketStorage=e,this.messageService=n,this.fb=i,this.accountId="",this.pageSize3=3,this.loadingLatestPurchases=!1,this.rolService=we(rr),this.promotionsService=we(F0),this.authService=we(Ot),this.view="cardView",this.infoLoad=[],this.isCreateVisible=!1,this.isEditMode=!1,this.fileListInfo=[],this.fileUrl="http://themenate.com/applicator/dist/assets/images/avatars/thumb-13.jpg",this.autosave=!0,this.uploading=!1,this.bucketPath="promotions/",this.uploadvalue=0,this.pageSize=10,this.usersList=[],this.rowGroupPanelShow=[],this.promotionsList=[],this.promotionsListLoaded=[],this.showUploadList={showPreviewIcon:!0,showRemoveIcon:!0,hidePreviewIconInNonImage:!0},this.previewImage="",this.previewVisible=!1,this.isEditVisible=!1,this.handlePreview=a=>{this.previewImage=a.url||a.thumbUrl,this.previewVisible=!0},this.authService.user.subscribe(a=>{a&&(this.user=a,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&this.rolService.getRol(this.user.rolId).valueChanges().subscribe(s=>{this.infoLoad=s,this.userlevelAccess=this.infoLoad.optionAccessLavel}))}),this.programEditForm=this.fb.group({imageUrl:[""],active:[""],uid:[""],name:["",[fe.required]],description:["",[fe.required]],category:[],validFrom:[new Date],validTo:[new Date],date_created:[]}),this.createForm()}editPromotion(e,n,i,a,s){this.programEditForm.controls.uid.setValue(e),this.programEditForm.controls.name.setValue(n),this.programEditForm.controls.description.setValue(i),this.programEditForm.controls.validFrom.setValue(a),this.programEditForm.controls.validTo.setValue(s),this.isEditVisible=!0}deletePromotiom(e){this.promotionsService.deletePromotion(this.accountId,e)}diactivePromotion(e,n){this.promotionsService.deactivePromotion(n,e,this.accountId)}promotionSelected(e){}createForm(){this.programForm=this.fb.group({imageUrl:[""],active:[""],name:["",[fe.required]],description:["",[fe.required]],category:[],validFrom:[],validTo:[],date_created:[]})}toggleActive(){}ngOnInit(){this.sub=this.promotionsService.getPromotionsList(this.accountId).pipe(Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return De({id:i},a)}))).subscribe(e=>{this.promotionsList=e,this.promotionsListLoaded=e})}showCreateModal(){this.programForm.reset(),this.isCreateVisible=!0,this.currentSelectedId="",this.currentSelected=null}showModalDelete(e){}sendMessage(e,n){this.messageService.create(e,n)}handleCancel(){this.isCreateVisible=!1,this.isEditMode=!1,this.currentSelectedId="",this.isEditVisible=!1}createPromotion(){if(this.programForm.valid){var e;e={active:!0,name:this.programForm.controls.name.value,description:this.programForm.controls.description.value,validFrom:this.programForm.controls.validFrom.value,validTo:this.programForm.controls.validTo.value,imageUrl:this.programForm.controls.imageUrl.value||"",customerId:this.user.customerId,category:"",date_created:this.programForm.controls.date_created.value},this.userlevelAccess!="3"?this.promotionsService.savePromotion(e,this.accountId).then(()=>{this.messageService.success("Se agreg\xF3 la promoci\xF3n con \xE9xito.",{nzPauseOnHover:!0,nzDuration:3e3}),this.isCreateVisible=!1}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}}handleChange2(e){if(e.file.status!=="uploading"){let i=e.file.status;this.fileListInfo=e.fileList,e.file.originFileObj&&this.getBase64(e.file.originFileObj,a=>{this.fileUrl=a;let s=e.file.name,o=`${this.bucketPath}/${s}`,c=this.bucketStorage.ref(o);this.task=this.bucketStorage.ref(o).putString(a,"data_url"),this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(Fe(l=>Number((l/100).toFixed(2)))).subscribe(l=>{this.uploading=l!=0,this.uploadvalue=l}),this.task.snapshotChanges().pipe(mn(()=>{this.uploading=!1,this.downloadURL=c.getDownloadURL(),this.downloadURL.subscribe(l=>gr(this,null,function*(){this.updateAdvanceURL(l),l.length>0?this.sendMessage("success",`${e.file.name} Archivo cargado satisfactoriamente.`):i==="error"&&this.sendMessage("error",`${e.file.name} archivo fallido, favor de validar.`)}))})).subscribe()})}}getBase64(e,n){let i=new FileReader;i.readAsDataURL(e),i.onload=()=>n(i.result),i.onerror=a=>this.sendMessage("error",a.toString())}updateAdvanceURL(e){return gr(this,null,function*(){this.programForm.controls.imageUrl.patchValue(e)})}onGridReady(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi}setPaginationPageSize(e=10){this.pageSize=e,this.gridApi.paginationSetPageSize(Number(e))}editSavePromotion(){this.programEditForm.valid?(this.promotionsService.editPromotion(this.programEditForm.controls.uid.value,this.accountId,this.programEditForm.controls.name.value,this.programEditForm.controls.description.value,this.programEditForm.controls.validFrom.value,this.programEditForm.controls.validTo.value).then(()=>{this.messageService.success("Todo sali\xF3 bien.",{nzPauseOnHover:!0,nzDuration:3e3})}),this.isEditVisible=!1):this.sendMessage("error","Datos invalidos favor de validar")}getItems(e){let n=e;if(!n){this.promotionsList=this.promotionsListLoaded.slice();return}let i=n.toLowerCase();this.promotionsList=this.promotionsListLoaded.filter(a=>Object.values(a).some(s=>String(s).toLowerCase().includes(i)))}static{this.\u0275fac=function(n){return new(n||t)(Te(Kn),Te(Ke),Te(gt))}}static{this.\u0275cmp=rt({type:t,selectors:[["app-promotions"]],inputs:{accountId:"accountId"},decls:25,vars:6,consts:[["searchBar",""],["modalContent",""],["modalContentEdit",""],["basicTable",""],["chatSetting","nzDropdownMenu"],[1,"site-page-header",2,"background-color","#f9fbfd"],[1,"site-page-header-ghost-wrapper"],[3,"nzGhost"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nz-row",""],[1,"content"],["nz-icon","","nzTheme","outline",1,"search-icon"],["placeholder","Buscar",3,"keyup"],[3,"nzData","nzPageSize","nzLoading","nzLoadingDelay",4,"ngIf"],["nzTitle","Agregar Promoci\xF3n",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzContent"],["nzTitle","Editar Promoci\xF3n",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzContent"],[3,"nzData","nzPageSize","nzLoading","nzLoadingDelay"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"nzColor",4,"ngIf"],[3,"nzColor"],["nz-text","","nzType","secondary"],["target","_blank",3,"href"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","more","nzTheme","outline"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item","",3,"click"],["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-12","col-sm-12"],["nz-input","","formControlName","name","id","descriptioA"],["nz-input","","formControlName","description","id","descriptioA"],[1,"col-md-7","col-sm-12"],["formControlName","validFrom"],["formControlName","validTo"],["formControlName","date_created"],["zAction","/api/posts/","nzListType","picture-card",3,"nzFileListChange","nzChange","nzFileList","nzShowButton","nzShowUploadList","nzPreview"],["nz-icon",""],[1,"ant-upload-text"],[3,"nzOnCancel","nzVisible","nzContent","nzFooter"],[3,"src","ngStyle"]],template:function(n,i){if(n&1){let a=ke();u(0,"nz-page-header",5)(1,"nz-page-header-title"),C(2,"Promociones"),m(),u(3,"nz-page-header-subtitle"),C(4,"Promociones de esta empresa"),m(),u(5,"nz-page-header-extra")(6,"div",6)(7,"nz-page-header",7)(8,"nz-page-header-extra")(9,"button",8),le("click",function(){return se(a),oe(i.showCreateModal())}),C(10,"Agregar Promocion"),m()()()()(),u(11,"nz-page-header-content")(12,"div",9)(13,"div",10),L(14,"i",11),u(15,"input",12,0),le("keyup",function(){se(a);let o=be(16);return oe(i.getItems(o.value))}),m()()()()(),L(17,"br"),ue(18,hf,21,5,"nz-table",13),u(19,"nz-modal",14),kt("nzVisibleChange",function(o){return se(a),Tt(i.isCreateVisible,o)||(i.isCreateVisible=o),oe(o)}),le("nzOnCancel",function(){return se(a),oe(i.handleCancel())})("nzOnOk",function(){return se(a),oe(i.createPromotion())}),m(),ue(20,mf,44,8,"ng-template",null,1,Ge),u(22,"nz-modal",15),kt("nzVisibleChange",function(o){return se(a),Tt(i.isEditVisible,o)||(i.isEditVisible=o),oe(o)}),le("nzOnCancel",function(){return se(a),oe(i.handleCancel())})("nzOnOk",function(){return se(a),oe(i.editSavePromotion())}),m(),ue(23,pf,26,1,"ng-template",null,2,Ge)}if(n&2){let a=be(21),s=be(24);y(7),F("nzGhost",!1),y(11),F("ngIf",i.promotionsList),y(),Et("nzVisible",i.isCreateVisible),F("nzContent",a),y(3),Et("nzVisible",i.isEditVisible),F("nzContent",s)}},dependencies:[xt,Sr,On,Tr,Jt,Yt,Qt,Zt,tr,er,kr,Yn,Qr,Yr,Jr,tn,Zr,en,jr,Jn,Xr,Gr,$r,qr,Kr,Mt,Lt,Rt,nr,Wn,Hn,ra,Cr,qn,It,wr,vt,Dt,Nt,Pt,Qi]})}}return t})();var I0=()=>({width:"100%"});function gf(t,r){t&1&&L(0,"span",27)}function _f(t,r){if(t&1&&L(0,"img",61),t&2){let e=j(2);F("src",e.previewImage,xn)("ngStyle",_r(2,I0))}}function Sf(t,r){t&1&&(u(0,"div",62),C(1," El precio es requerido. "),m())}function wf(t,r){t&1&&(u(0,"div",62),C(1," El precio debe ser mayor a 0. "),m())}function Ef(t,r){if(t&1&&(u(0,"div",62),ue(1,Sf,2,0,"div",55)(2,wf,2,0,"div",55),m()),t&2){let e=j(2);y(),F("ngIf",e.isPriceRequired()),y(),F("ngIf",e.isPriceMin())}}function Tf(t,r){if(t&1){let e=ke();u(0,"form",28),le("ngSubmit",function(){se(e);let i=j();return oe(i.submitForm("A"))}),u(1,"div",12)(2,"div",29)(3,"nz-form-item")(4,"nz-form-label",30),C(5,"Nombre"),m(),u(6,"nz-form-control"),L(7,"input",31),m()()(),u(8,"div",32)(9,"nz-form-item")(10,"nz-form-label"),C(11,"Activo"),m(),u(12,"nz-form-control"),L(13,"nz-switch",33),m()()()(),u(14,"div",12)(15,"div",29)(16,"nz-form-item")(17,"nz-form-label"),C(18,"Descripci\xF3n"),m(),u(19,"nz-form-control"),L(20,"textarea",34),m()()(),u(21,"div",32)(22,"nz-form-item")(23,"nz-form-label"),C(24,"Adjuntar Imagen"),m(),u(25,"nz-form-control")(26,"nz-upload",35),kt("nzFileListChange",function(i){se(e);let a=j();return Tt(a.fileList,i)||(a.fileList=i),oe(i)}),le("nzChange",function(i){se(e);let a=j();return oe(a.handleChange(i))}),u(27,"div",36),C(28,"Cargar"),m()()(),ue(29,_f,1,3,"ng-template",null,4,Ge),m()()(),u(31,"div",12)(32,"div",11)(33,"nz-form-item")(34,"nz-form-label"),C(35,"Categor\xEDa"),m(),u(36,"nz-form-control")(37,"nz-select",37),L(38,"nz-option",38)(39,"nz-option",39)(40,"nz-option",40)(41,"nz-option",41)(42,"nz-option",42)(43,"nz-option",43)(44,"nz-option",44)(45,"nz-option",45)(46,"nz-option",46)(47,"nz-option",47)(48,"nz-option",48),m()()()(),u(49,"div",11)(50,"nz-form-item")(51,"nz-form-label"),C(52,"Validez"),m(),u(53,"nz-form-control")(54,"nz-range-picker",49),le("nzOnCalendarChange",function(i){se(e);let a=j();return oe(a.mapDateValues(i))}),m()()()()(),u(55,"div",12)(56,"div",50)(57,"nz-form-item")(58,"nz-form-label"),C(59,"Mete"),m(),u(60,"nz-form-control"),L(61,"nz-switch",51),m()()(),u(62,"div",50)(63,"nz-form-item")(64,"nz-form-label"),C(65,"Saca"),m(),u(66,"nz-form-control"),L(67,"nz-switch",52),m()()(),u(68,"div",53)(69,"nz-form-label"),C(70,"Precio"),m(),u(71,"nz-form-control"),L(72,"nz-input-number",54),ue(73,Ef,3,2,"div",55),m()(),u(74,"div",50)(75,"nz-form-item")(76,"nz-form-label"),C(77,"Calculado"),m(),u(78,"nz-form-control"),L(79,"nz-switch",56),m()()(),u(80,"div",53)(81,"div")(82,"nz-form-label"),C(83,"Asientos"),m(),L(84,"nz-input-number",57),m()()(),u(85,"div",12)(86,"div",11)(87,"nz-form-item")(88,"nz-form-label"),C(89,"Frecuencias (Opcional)"),m(),u(90,"nz-select",58),L(91,"nz-option",59)(92,"nz-option",59)(93,"nz-option",59)(94,"nz-option",59)(95,"nz-option",59),m()()(),u(96,"div",11)(97,"nz-form-item")(98,"nz-form-label"),C(99,"Tipo de Producto (Opcional)"),m(),u(100,"nz-select",60),L(101,"nz-option",59)(102,"nz-option",59),m()()()()()}if(t&2){let e=j();F("formGroup",e.validateForm),y(26),Et("nzFileList",e.fileList),F("nzShowButton",!0)("nzShowUploadList",e.showUploadList)("nzPreview",e.handlePreview),y(46),F("nzMin",0)("nzMax",12e4)("nzStep",1),y(),F("ngIf",e.isPriceInvalid()),y(11),F("nzMin",0)("nzMax",200)("nzStep",1),y(7),F("nzValue",1)("nzLabel",1),y(),F("nzValue",2)("nzLabel",2),y(),F("nzValue",3)("nzLabel",3),y(),F("nzValue",4)("nzLabel",4),y(),F("nzValue",5)("nzLabel",5),y(6),F("nzValue",e.camioneta)("nzLabel",e.camioneta),y(),F("nzValue",e.camion)("nzLabel",e.camion)}}function kf(t,r){if(t&1&&L(0,"img",61),t&2){let e=j(2);F("src",e.previewImage,xn)("ngStyle",_r(2,I0))}}function Cf(t,r){t&1&&(u(0,"div",62),C(1," El precio es requerido. "),m())}function yf(t,r){t&1&&(u(0,"div",62),C(1," El precio debe ser mayor a 0. "),m())}function Ff(t,r){if(t&1&&(u(0,"div",62),ue(1,Cf,2,0,"div",55)(2,yf,2,0,"div",55),m()),t&2){let e=j(2);y(),F("ngIf",e.isPriceRequired()),y(),F("ngIf",e.isPriceMin())}}function Af(t,r){if(t&1){let e=ke();u(0,"form",28),le("ngSubmit",function(){se(e);let i=j();return oe(i.submitForm("A"))}),u(1,"div",12)(2,"div",29)(3,"nz-form-item")(4,"nz-form-label",30),C(5,"Nombre"),m(),u(6,"nz-form-control"),L(7,"input",63),m()()()(),u(8,"div",12)(9,"div",29)(10,"nz-form-item")(11,"nz-form-label"),C(12,"Descripci\xF3n"),m(),u(13,"nz-form-control"),L(14,"textarea",34),m()()(),u(15,"div",32)(16,"nz-form-item")(17,"nz-form-label"),C(18,"Adjuntar Imagen"),m(),u(19,"nz-form-control")(20,"nz-upload",64),kt("nzFileListChange",function(i){se(e);let a=j();return Tt(a.fileListE,i)||(a.fileListE=i),oe(i)}),le("nzChange",function(i){se(e);let a=j();return oe(a.handleChange2(i))}),u(21,"div",36),C(22,"Cargar"),m()(),u(23,"nz-modal",65),le("nzOnCancel",function(){se(e);let i=j();return oe(i.previewVisibleE=!1)}),m()(),ue(24,kf,1,3,"ng-template",null,4,Ge),m()()(),u(26,"div",12)(27,"div",11)(28,"nz-form-item")(29,"nz-form-label"),C(30,"Categor\xEDa"),m(),u(31,"nz-form-control")(32,"nz-form-control")(33,"nz-select",66),L(34,"nz-option",38)(35,"nz-option",39)(36,"nz-option",40)(37,"nz-option",41)(38,"nz-option",42)(39,"nz-option",43)(40,"nz-option",44)(41,"nz-option",45)(42,"nz-option",46)(43,"nz-option",47)(44,"nz-option",48),m()()()()(),u(45,"div",11)(46,"nz-form-item")(47,"nz-form-label"),C(48,"Validez"),m(),u(49,"nz-form-control")(50,"nz-range-picker",67),le("nzOnCalendarChange",function(i){se(e);let a=j();return oe(a.mapDateValues(i))}),m()()()()(),u(51,"div",12)(52,"div",50)(53,"nz-form-item")(54,"nz-form-label"),C(55,"Mete"),m(),L(56,"nz-switch",68),m()(),u(57,"div",50)(58,"nz-form-item")(59,"nz-form-label"),C(60,"Saca"),m(),L(61,"nz-switch",69),m()(),u(62,"div",53)(63,"nz-form-label"),C(64,"Precio"),m(),L(65,"nz-input-number",54),ue(66,Ff,3,2,"div",55),m(),u(67,"div",50)(68,"nz-form-item")(69,"nz-form-label"),C(70,"Calculado"),m(),L(71,"nz-switch",56),m()(),u(72,"div",53)(73,"div")(74,"nz-form-label"),C(75,"Asientos"),m(),L(76,"nz-input-number",57),m()()(),u(77,"div",12)(78,"div",11)(79,"nz-form-item")(80,"nz-form-label"),C(81,"Frecuencias (Opcional)"),m(),u(82,"nz-select",58),L(83,"nz-option",59)(84,"nz-option",59)(85,"nz-option",59)(86,"nz-option",59)(87,"nz-option",59),m()()(),u(88,"div",11)(89,"nz-form-item")(90,"nz-form-label"),C(91,"Tipo de Producto (Opcional)"),m(),u(92,"nz-select",60),L(93,"nz-option",59)(94,"nz-option",59),m()()()()()}if(t&2){let e=be(25),n=j();F("formGroup",n.validateFormE),y(20),Et("nzFileList",n.fileListE),F("nzShowButton",!0)("nzShowUploadList",n.showUploadList)("nzPreview",n.handlePreviewE),y(3),F("nzVisible",n.previewVisibleE)("nzContent",e)("nzFooter",null),y(10),F("disabled",!0),y(17),F("disabled",!0),y(6),F("disabled",!0),y(5),F("disabled",!0),y(4),F("nzMin",0)("nzMax",12e4)("nzStep",1),y(),F("ngIf",n.isPriceInvalid()),y(10),F("nzMin",0)("nzMax",200)("nzStep",1),y(7),F("nzValue",1)("nzLabel",1),y(),F("nzValue",2)("nzLabel",2),y(),F("nzValue",3)("nzLabel",3),y(),F("nzValue",4)("nzLabel",4),y(),F("nzValue",5)("nzLabel",5),y(6),F("nzValue",n.camioneta)("nzLabel",n.camioneta),y(),F("nzValue",n.camion)("nzLabel",n.camion)}}function bf(t,r){if(t&1){let e=ke();u(0,"li",77),le("click",function(){se(e);let i=j().$implicit,a=j(2);return oe(a.toggleActivateProduct(i))}),u(1,"a"),L(2,"i",85),u(3,"span",79),C(4,"Detener venta"),m()()()}}function zf(t,r){if(t&1){let e=ke();u(0,"li",77),le("click",function(){se(e);let i=j().$implicit,a=j(2);return oe(a.toggleActivateProduct(i))}),u(1,"a"),L(2,"i",86),u(3,"span",79),C(4,"Activar venta"),m()()()}}function Df(t,r){t&1&&(u(0,"nz-tag",83),C(1,"Venta Activa"),m()),t&2&&F("nzColor","green")}function If(t,r){t&1&&(u(0,"nz-tag",83),C(1,"Venta Detenida"),m()),t&2&&F("nzColor","red")}function Nf(t,r){if(t&1&&L(0,"img",87),t&2){let e=j().$implicit;vn("src",e.imageUrl,xn)}}function Pf(t,r){if(t&1){let e=ke();u(0,"div",53)(1,"nz-card",71),L(2,"nz-card-meta",72),u(3,"div")(4,"a",73),L(5,"i",74),m(),u(6,"nz-dropdown-menu",null,5)(8,"ul",75),ue(9,bf,5,0,"li",76)(10,zf,5,0,"li",76),u(11,"li",77),le("click",function(){let i=se(e).$implicit,a=j(2),s=be(25);return oe(a.editProduct(i,s))}),u(12,"a"),L(13,"i",78),u(14,"span",79),C(15,"Editar"),m()()(),L(16,"li",80),u(17,"li",77),le("click",function(){let i=se(e).$implicit,a=j(2);return oe(a.deleteProduct(i))}),u(18,"a"),L(19,"i",81),u(20,"span",79),C(21,"Eliminar "),m()()()()()(),u(22,"div",82)(23,"div")(24,"nz-tag",83),C(25),m(),ue(26,Df,2,1,"nz-tag",84)(27,If,2,1,"nz-tag",84),m()(),ue(28,Nf,1,1,"ng-template",null,6,Ge),m()()}if(t&2){let e=r.$implicit,n=be(7),i=be(29);y(),F("nzCover",i),y(),vn("nzTitle",e.name),vn("nzDescription",e.description),y(2),F("nzDropdownMenu",n),y(5),F("ngIf",e.active),y(),F("ngIf",!e.active),y(14),F("nzColor","blue"),y(),Ce(e.type),y(),F("ngIf",e.active),y(),F("ngIf",!e.active)}}function Of(t,r){if(t&1&&(u(0,"div",12),ue(1,Pf,30,10,"div",70),m()),t&2){let e=j();y(),F("ngForOf",e.productsList)}}function Lf(t,r){t&1&&(u(0,"nz-tag",83),C(1,"Activo"),m()),t&2&&F("nzColor","green")}function Rf(t,r){if(t&1){let e=ke();u(0,"li",77),le("click",function(){se(e);let i=j().$implicit,a=j(2);return oe(a.toggleActivateProduct(i))}),u(1,"a"),L(2,"i",85),u(3,"span",79),C(4,"Detener venta"),m()()()}}function Mf(t,r){if(t&1){let e=ke();u(0,"li",77),le("click",function(){se(e);let i=j().$implicit,a=j(2);return oe(a.toggleActivateProduct(i))}),u(1,"a"),L(2,"i",86),u(3,"span",79),C(4,"Activar venta"),m()()()}}function Bf(t,r){if(t&1){let e=ke();u(0,"tr")(1,"td")(2,"div",91),L(3,"nz-avatar",92),u(4,"div",79)(5,"h5",93),C(6),m()()()(),u(7,"td"),C(8),m(),u(9,"td"),C(10),m(),u(11,"td")(12,"nz-tag",83),C(13),m()(),u(14,"td",89),ue(15,Lf,2,1,"nz-tag",84),m(),u(16,"td",94)(17,"div")(18,"a",73),L(19,"i",74),m(),u(20,"nz-dropdown-menu",null,8)(22,"ul",75),ue(23,Rf,5,0,"li",76)(24,Mf,5,0,"li",76),u(25,"li",95)(26,"a"),L(27,"i",78),u(28,"span",79),C(29,"Editar"),m()()(),L(30,"li",80),u(31,"li",77),le("click",function(){let i=se(e).$implicit,a=j(2);return oe(a.deleteProduct(i))}),u(32,"a"),L(33,"i",81),u(34,"span",79),C(35,"Eliminar "),m()()()()()()()()}if(t&2){let e=r.$implicit,n=be(21);y(3),vn("nzSrc",e.imageUrl),y(3),Ce(e.name),y(2),Ce(e.category),y(2),Ce(e.description),y(2),F("nzColor","blue"),y(),Ce(e.type),y(2),F("ngIf",e.active),y(3),F("nzDropdownMenu",n),y(5),F("ngIf",e.active),y(),F("ngIf",!e.active)}}function Vf(t,r){if(t&1&&(u(0,"nz-card")(1,"nz-table",88,7)(3,"thead")(4,"tr")(5,"th"),C(6,"Nombre"),m(),u(7,"th"),C(8,"Categor\xEDa"),m(),u(9,"th"),C(10,"Descripci\xF3n"),m(),u(11,"th"),C(12,"Tipo"),m(),u(13,"th",89),C(14,"Status"),m(),L(15,"th"),m()(),u(16,"tbody"),ue(17,Bf,36,10,"tr",90),m()()()),t&2){let e=be(2),n=j();y(),F("nzData",n.productsList),y(16),F("ngForOf",e.data)}}var N0=(()=>{class t{constructor(e,n,i,a,s,o){this.modal=e,this.bucketStorage=n,this.afs=i,this.modalService=a,this.messageService=s,this.fb=o,this.accountId="",this.rolService=we(rr),this.productsService=we(x0),this.usersService=we(Mn),this.view="cardView",this.productsList=[],this.productsListLoaded=[],this.infoLoad=[],this.userService=we(Bn),this.authService=we(Ot),this.fileListInfo=[],this.fileList=[],this.fileListE=[],this.fileUrl="http://themenate.com/applicator/dist/assets/images/avatars/thumb-13.jpg",this.autosave=!0,this.uploading=!1,this.bucketPath="products1/products",this.uploadvalue=0,this.showUploadList={showPreviewIcon:!0,showRemoveIcon:!0,hidePreviewIconInNonImage:!0},this.previewImage="",this.previewImageE="",this.camioneta="Camioneta",this.camion="Cami\xF3n",this.previewVisible=!1,this.previewVisibleE=!1,this.weekControls=[],this.weekControlsE=[],this.handlePreview=c=>{this.previewImage=c.url||c.thumbUrl,this.previewVisible=!0},this.handlePreviewE=c=>{this.previewImageE=c.url||c.thumbUrl,this.previewVisibleE=!0},this.authService.user.subscribe(c=>{c&&(this.user=c,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&this.rolService.getRol(this.user.rolId).valueChanges().subscribe(l=>{this.infoLoad=l,this.userlevelAccess=this.infoLoad.optionAccessLavel}))})}ngOnInit(){this.createForm(),this.getSubscriptions(),this.validateForm.get("weeks").valueChanges.subscribe(e=>{this.onFrequencyChange(e)})}ngOnDestroy(){}createForm(){this.validateForm=this.fb.group({active:[!1,[fe.required]],category:[null,[fe.required]],date_created:[new Date,[fe.required]],description:[null,[fe.required]],isTaskIn:[!0,[fe.required]],isTaskOut:[!0,[fe.required]],name:[null,[fe.required]],price:[null,[fe.required,fe.min(1)]],timesSold:[0,[fe.required]],type:["Servicio"],rangeDatePicker:[null],validFrom:[new Date,[fe.required]],validTo:[new Date,[fe.required]],imageUrl:[""],frequencies:[""],transportType:[""],weeks:[""],disable:[!1],rangeWeeks:this.fb.group({}),amountTrips:[0],id:[],sits:[0],isCalculate:[!1],customerId:[""]}),this.validateFormE=this.fb.group({active:[!1,[fe.required]],category:[null],date_created:[new Date],description:[null,[fe.required]],isTaskIn:[!0],isTaskOut:[!0],name:[null,[fe.required]],price:[null,[fe.required,fe.min(1)]],timesSold:[0],type:["Servicio"],rangeDatePicker:[null],validFrom:[new Date],validTo:[new Date],imageUrl:[""],frequencies:[""],transportType:[""],weeks:[""],disable:[!1],rangeWeeks:this.fb.group({}),amountTrips:[0],sits:[0],id:[],isCalculate:[],customerId:[""]})}get price(){return this.validateForm.get("price")}isPriceInvalid(){let e=this.price;return!!(e&&e.invalid&&(e.dirty||e.touched))}isPriceRequired(){let e=this.price;return!!(e&&e.errors?.required)}isPriceMin(){let e=this.price;return!!(e&&e.errors?.min)}resetForm(){this.fileList=[],this.fileListE=[],this.validateForm.reset({active:!1,date_created:new Date,isTaskIn:!0,isTaskOut:!0,price:0,timesSold:0,validFrom:new Date,validTo:new Date,frequencies:"",transportType:"",weeks:"",imageUrl:"",amountTrips:0,sits:0,customerId:""}),this.validateFormE.reset({active:!1,date_created:new Date,isTaskIn:!0,isTaskOut:!0,price:0,timesSold:0,validFrom:new Date,validTo:new Date,frequencies:"",transportType:"",imageUrl:"",weeks:"",amountTrips:0,sits:0,customerId:""})}mapDateValues(e){e.length>1&&(this.validateForm.controls.validFrom.patchValue(new Date(e[0])),this.validateForm.controls.validTo.patchValue(new Date(e[1])))}sendMessage(e,n){this.messageService.create(e,n)}submitForm(e){var n=0;if(this.userlevelAccess!="3")if(e=="A")if(this.validateForm.valid){let i=this.validateForm.controls.frequencies.value||0;i>0&&(n=Number(i)*80),this.validateForm.controls.amountTrips.setValue(n),this.validateForm.controls.type.setValue("Servicio"),this.validateForm.controls.disable.setValue(!1),this.validateForm.controls.customerId.setValue(this.accountId),this.productsService.setProduct(this.accountId,this.validateForm.value).then(()=>{this.resetForm(),this.modalService.closeAll(),this.messageService.success("Todo sali\xF3 bien.",{nzPauseOnHover:!0,nzDuration:3e3})})}else this.sendMessage("error","Hay valores requeridos para crear el producto, favor de validar.");else if(this.validateFormE.valid){let i=this.validateFormE.controls.id.value,a=this.validateFormE.controls.frequencies.value||0;a>0&&(n=Number(a)*80),this.validateFormE.controls.amountTrips.setValue(n),this.validateFormE.controls.type.setValue("Servicio"),this.validateFormE.controls.disable.setValue(!1),this.validateFormE.controls.customerId.setValue(this.accountId),this.productsService.updateProduct(this.accountId,this.validateFormE.controls.id.value,this.validateFormE.value).then(()=>{this.resetForm(),this.modalService.closeAll(),this.messageService.success("Todo sali\xF3 bien.",{nzPauseOnHover:!0,nzDuration:3e3})})}else this.sendMessage("error","Hay valores requeridos para crear el producto, favor de validar.")}toggleActivateProduct(e){e.active?this.showDeactivateConfirm(e):this.processtoDeactivateProduct(this.accountId,e.id,e.active)}showDeactivateConfirm(e){this.modal.confirm({nzTitle:"Estas Seguro de detener la venta? ",nzContent:`<b style="color: red;">${e.name}</b> ser\xE1 desacrivado. </b>  Una ves realizado todos los pases asociados se desactivaran`,nzOkText:"Yes",nzOkType:"primary",nzOnOk:()=>this.processtoDeactivateProduct(this.accountId,e.id,e.active),nzCancelText:"No"})}processtoDeactivateProduct(e,n,i){this.productsService.toggleProductActive(e,n,i),this.productsService.toggleBoardingPass(n,i),this.productsService.togglePurchaseRequests(n,i)}getSubscriptions(){this.sub=this.usersService.getAccountProducts(this.accountId).pipe(Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return fr(De({},a),{id:i})}))).subscribe(e=>{this.productsList=e,this.productsListLoaded=e})}deleteProduct(e){this.userlevelAccess=="1"?this.productsService.deleteProduct(this.accountId,e.id).then(()=>{this.messageService.success(`El ${e.type} ${e.name} ha sido eliminado.`,{nzPauseOnHover:!0,nzDuration:3e3}),this.productsService.toggleBoardingPass(e.id,!1),this.productsService.togglePurchaseRequests(e.id,!1)}):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}initializeRangeDatePicker(e,n){let i=this.convertTimestampToDate(e),a=this.convertTimestampToDate(n);return[i,a]}convertTimestampToDate(e){return new Date(e.seconds*1e3)}editProduct(e,n){this.resetForm();let i=this.initializeRangeDatePicker(e.validFrom,e.validTo)??null;if(this.validateFormE.patchValue({active:e.active||!1,category:e.category||null,date_created:e.date_created||new Date,description:e.description||null,isTaskIn:e.isTaskIn||!0,isTaskOut:e.isTaskOut||!0,name:e.name||null,price:e.price||0,timesSold:e.timesSold||0,type:e.type||null,rangeDatePicker:i,validFrom:e.validFrom||new Date,validTo:e.validTo||new Date,imageUrl:e.imageUrl||"",frequencies:e.frequencies||null,transportType:e.transportType||"",amountTrips:e.amountTrips||0,weeks:e.weeks||0,rangeWeeks:e.rangeWeeks||{},id:e.id,isCalculate:e.isCalculate||!1,sits:e.sits||0,customerId:e.customerId||""}),e.rangeWeeks!=null){let s=this.validateFormE.get("rangeWeeks");for(let[o,c]of Object.entries(e.rangeWeeks))s.addControl(o,this.fb.control(c))}this.validateFormE.get("category")?.disable(),this.validateFormE.get("date_created")?.disable(),this.validateFormE.get("timesSold")?.disable(),this.validateFormE.get("type")?.disable(),this.validateFormE.get("validFrom")?.disable(),this.validateFormE.get("validTo")?.disable(),this.validateFormE.get("isTaskIn")?.disable(),this.validateFormE.get("isTaskOut")?.disable();let a=this.modalService.create({nzTitle:"Editar Producto / Servicio",nzContent:n,nzFooter:[{label:"Guardar Cambios",type:"primary",onClick:()=>this.modalService.confirm({nzTitle:"\xBFEstas seguro de los cambios?",nzOnOk:()=>{this.submitForm("E")}})}],nzWidth:800})}showNewModal(e){this.resetForm();let n=this.modalService.create({nzTitle:"Nuevo Servicio",nzContent:e,nzFooter:[{label:"Crear",type:"primary",onClick:()=>this.modalService.confirm({nzTitle:"\xBFEst\xE1 seguro?",nzOnOk:()=>{this.submitForm("A")}})}],nzWidth:800})}handleChange(e){let n=e.file.status;n!=="uploading"&&(this.fileList=e.fileList,e.file.originFileObj&&this.getBase64(e.file.originFileObj,i=>{let a=e.file.name,s=`${this.bucketPath}/${a}`,o=this.bucketStorage.ref(s);this.task=this.bucketStorage.ref(s).putString(i,"data_url"),this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(Fe(c=>Number((c/100).toFixed(2)))).subscribe(c=>{this.uploading=c!=0,this.uploadvalue=c}),this.task.snapshotChanges().pipe(mn(()=>{this.uploading=!1,this.downloadURL=o.getDownloadURL(),this.downloadURL.subscribe(c=>gr(this,null,function*(){this.updateAdvanceURL(c,"A"),c.length>0?this.sendMessage("success",`${e.file.name} Archivo cargado satisfactoriamente.`):n==="error"&&this.sendMessage("error",`${e.file.name} archivo fallido, favor de validar.`)}))})).subscribe()}))}handleChange2(e){if(e.file.status!=="uploading"){let i=e.file.status;this.fileListE=e.fileList,e.file.originFileObj&&this.getBase64(e.file.originFileObj,a=>{this.fileUrl=a;let s=e.file.name,o=`${this.bucketPath}/${s}`,c=this.bucketStorage.ref(o);this.task=this.bucketStorage.ref(o).putString(a,"data_url"),this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(Fe(l=>Number((l/100).toFixed(2)))).subscribe(l=>{this.uploading=l!=0,this.uploadvalue=l}),this.task.snapshotChanges().pipe(mn(()=>{this.uploading=!1,this.downloadURL=c.getDownloadURL(),this.downloadURL.subscribe(l=>gr(this,null,function*(){this.updateAdvanceURL(l,"E"),l.length>0?this.sendMessage("success",`${e.file.name} Archivo cargado satisfactoriamente.`):i==="error"&&this.sendMessage("error",`${e.file.name} archivo fallido, favor de validar.`)}))})).subscribe()})}}getBase64(e,n){let i=new FileReader;i.readAsDataURL(e),i.onload=()=>n(i.result),i.onerror=a=>this.sendMessage("error",a.toString())}updateAdvanceURL(e,n){return gr(this,null,function*(){n=="A"?this.validateForm.controls.imageUrl.patchValue(e):this.validateFormE.controls.imageUrl.patchValue(e)})}onFrequencyChange(e){this.weekControls=[];let n=this.fb.group({});for(let i=0;i<e;i++){let a=new Ti(null);a.valueChanges.subscribe(s=>this.getWeek(s,i)),this.weekControls.push(a),n.addControl(`week${i+1}`,new Ti(null))}this.validateForm.setControl("rangeWeeks",n)}onFrequencyChangeE(e){this.weekControlsE=[];let n=this.fb.group({});for(let i=0;i<e;i++){let a=new Ti(null);a.valueChanges.subscribe(s=>this.getWeekE(s,i)),this.weekControlsE.push(a),n.addControl(`week${i+1}`,new Ti(null))}this.validateFormE.setControl("rangeWeeks",n)}getWeekNumber(e){let n=new Date(e.getFullYear(),0,1),i=(e.getDay()+6)%7;return n.setDate(n.getDate()+4-(n.getDay()||7)),Math.ceil(((e.getTime()-n.getTime())/864e5+1)/7).toString().padStart(2,"0")}getWeek(e,n){if(e){let i=e.getFullYear(),a=this.getWeekNumber(e),s=this.getStartOfWeek(new Date(e)),o=this.getEndOfWeek(new Date(e)),c={week:`${i}-${a}`,startDay:s.toISOString().split("T")[0],endDay:o.toISOString().split("T")[0]};this.validateForm.get("rangeWeeks").controls[`week${n+1}`].setValue(c)}}getWeekE(e,n){if(e){let i=e.getFullYear(),a=this.getWeekNumber(e),s=this.getStartOfWeek(new Date(e)),o=this.getEndOfWeek(new Date(e)),c={week:`${i}-${a}`,startDay:s.toISOString().split("T")[0],endDay:o.toISOString().split("T")[0]};this.validateFormE.get("rangeWeeks").controls[`week${n+1}`].setValue(c)}}getStartOfWeek(e){let n=new Date(e);n.setDate(n.getDate()+7);let i=n.getDay(),a=n.getDate()-i+(i===0?-6:1);return n.setDate(a),new Date(n.setHours(0,0,0,0))}getEndOfWeek(e){let n=this.getStartOfWeek(e);return n.setUTCDate(n.getUTCDate()+4),new Date(n.setUTCHours(23,59,59,999))}getItems(e){let n=e;if(!n){this.productsList=this.productsListLoaded.slice();return}let i=n.toLowerCase();this.productsList=this.productsListLoaded.filter(a=>a.description.toLowerCase().includes(i))}static{this.\u0275fac=function(n){return new(n||t)(Te(Nr),Te(Kn),Te(Er),Te(Nr),Te(Ke),Te(gt))}}static{this.\u0275cmp=rt({type:t,selectors:[["app-shared-products-list"]],inputs:{accountId:"accountId"},decls:30,vars:4,consts:[["searchBar",""],["suffixIconSearch",""],["newContent",""],["editContent",""],["modalContent",""],["projectListSetting","nzDropdownMenu"],["coverTemplate",""],["listViewTable",""],["projectListSetting2","nzDropdownMenu"],[1,"page-header"],[1,"row","align-items-md-center"],[1,"col-md-6"],[1,"row"],[2,"margin-left","10px","width","280px"],[3,"nzSuffix"],["type","text","nz-input","","placeholder","Selecciona unn producto",3,"keyup"],[1,"text-md-right","m-v-10"],[1,"m-r-10",3,"ngModelChange","ngModel"],["nz-radio-button","","nzValue","cardView","nzTitle","Vista de tarjeta","nzPlacement","bottom","nz-tooltip",""],["nz-icon","","nzType","appstore","theme","outline",1,"font-size-16"],["nz-radio-button","","nzValue","listView","nzTitle","Vista de lista","nzPlacement","bottom","nz-tooltip",""],["nz-icon","","nzType","ordered-list","theme","outline",1,"font-size-16"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],["nz-icon","","nzType","plus"],[1,"container-fluid"],["class","row",4,"ngIf"],[4,"ngIf"],["nz-icon","","nzType","search"],["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],[1,"col-md-8"],["nzRequired","true"],["type","text","formControlName","name","nz-input","","placeholder","Escriba el nombre del producto / servicio"],[1,"col-md-4"],["formControlName","active"],["nz-input","","formControlName","description"],["nzAction","https://www.mocky.io/v2/5cc8019d300000980a055e76","nzListType","picture-card",3,"nzFileListChange","nzChange","nzFileList","nzShowButton","nzShowUploadList","nzPreview"],[1,"ant-upload-text"],["nzPlaceHolder","Selecciona una opci\xF3n","formControlName","category",1,"w-100"],["nzLabel","Servicio de Transporte Ordinario","nzValue","permanente"],["nzLabel","Servicio Especial","nzValue","especial"],["nzLabel","Producto","nzValue","producto"],["nzLabel","Comedor","nzValue","comedor"],["nzLabel","Seguridad","nzValue","seguridad"],["nzLabel","Monitoreo","nzValue","monitoreo"],["nzLabel","Limpieza","nzValue","limpieza"],["nzLabel","Construcci\xF3n","nzValue","construccion"],["nzLabel","Bienes Raices","nzValue","bienesRaices"],["nzLabel","Mantenimiento","nzValue","mantenimiento"],["nzLabel","Otros","nzValue","otros"],["formControlName","rangeDatePicker",3,"nzOnCalendarChange"],[1,"col-md-2"],["formControlName","isTaskIn"],["formControlName","isTaskOut"],[1,"col-md-3"],["formControlName","price",3,"nzMin","nzMax","nzStep"],["class","error-message",4,"ngIf"],["formControlName","isCalculate"],["formControlName","sits",3,"nzMin","nzMax","nzStep"],["formControlName","frequencies"],[3,"nzValue","nzLabel"],["formControlName","transportType"],[3,"src","ngStyle"],[1,"error-message"],["type","text","formControlName","name","nz-input","","placeholder","Escriba el nombre del servicio"],["nzAction","/api/posts/","nzListType","picture-card",3,"nzFileListChange","nzChange","nzFileList","nzShowButton","nzShowUploadList","nzPreview"],[3,"nzOnCancel","nzVisible","nzContent","nzFooter"],["nzPlaceHolder","Selecciona una opci\xF3n","formControlName","category",1,"w-100",3,"disabled"],["formControlName","rangeDatePicker",3,"nzOnCalendarChange","disabled"],["formControlName","isTaskIn",3,"disabled"],["formControlName","isTaskOut",3,"disabled"],["class","col-md-3",4,"ngFor","ngForOf"],["nzHoverable","",2,"width","240px",3,"nzCover"],[3,"nzTitle","nzDescription"],["nz-dropdown","","nzPlacement","bottomRight","nzTrigger","click",1,"text-gray","font-size-18",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","theme","outline"],["nz-menu","","nzSelectable",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item","",3,"click"],["nz-icon","","nzType","edit","theme","outline"],[1,"m-l-10"],["nz-menu-divider",""],["nz-icon","","nzType","delete","theme","outline"],[1,"d-flex","justify-content-between","align-items-center"],[1,"m-b-0",3,"nzColor"],["class","m-b-0",3,"nzColor",4,"ngIf"],["nz-icon","","nzType","pause-circle","theme","outline"],["nz-icon","","nzType","check-circle","theme","outline"],["alt","",3,"src"],[3,"nzData"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"media","align-items-center"],["nzShape","square",3,"nzSrc"],[1,"m-b-0"],[1,"text-right"],["nz-menu-item",""]],template:function(n,i){if(n&1){let a=ke();u(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12)(4,"div",13)(5,"nz-form-control")(6,"nz-input-group",14)(7,"input",15,0),le("keyup",function(){se(a);let o=be(8);return oe(i.getItems(o.value))}),m()(),ue(9,gf,1,0,"ng-template",null,1,Ge),m()()()(),u(11,"div",11)(12,"div",16)(13,"nz-radio-group",17),kt("ngModelChange",function(o){return se(a),Tt(i.view,o)||(i.view=o),oe(o)}),u(14,"label",18),L(15,"i",19),m(),u(16,"label",20),L(17,"i",21),m()(),u(18,"button",22),le("click",function(){se(a);let o=be(23);return oe(i.showNewModal(o))}),L(19,"i",23),u(20,"span"),C(21,"Agregar nuevo"),m()(),ue(22,Tf,103,26,"ng-template",null,2,Ge)(24,Af,95,33,"ng-template",null,3,Ge),m()()()(),u(26,"div",24),ue(27,Of,2,1,"div",25)(28,Vf,18,2,"nz-card",26),m(),L(29,"nz-modal")}if(n&2){let a=be(10);y(6),F("nzSuffix",a),y(7),Et("ngModel",i.view),y(14),F("ngIf",i.view=="cardView"),y(),F("ngIf",i.view=="listView")}},dependencies:[xt,Sr,On,Tr,Jt,Yt,Qt,Zt,tr,er,kr,a0,i0,Yn,p0,u0,f0,Qr,Yr,Jr,tn,Zr,en,jr,Rn,na,Jn,Xr,Gr,Vn,$r,qr,Kr,Wr,Mt,Lt,Rt,Hr,ta,qn,ir,ar,It,wr,vt,Dt,Nt,Pt,Ln,v0],styles:[".error-message[_ngcontent-%COMP%]{color:red;font-size:.8em}"]})}}return t})();var P0=[{name:"Tienda de conveniencia",description:"Pago en tienda de conveniencia",icon:"pricetag",method:"store",userNavigation:"reference/list",active:!1},{name:"Tarjeta de cr\xE9dito/d\xE9bito",description:"Pago en l\xEDnea con tarjeta",icon:"card",method:"card",userNavigation:"card/purchase",active:!1}],O0=(()=>{class t{constructor(e){this.afs=e}getAccountPaymentMethods(e){return this.afs.collection("customers").doc(e).collection("paymentMethods").snapshotChanges()}getPaymentMethods(){return Si(P0)}createDefaultPaymentMethods(e){return P0.forEach(n=>{this.setAccountPaymentMethod(e,n)})}setAccountPaymentMethod(e,n){return this.afs.collection("customers").doc(e).collection("paymentMethods").add(n)}toggleActiveAccountPaymentMethod(e,n,i){return this.afs.collection("customers").doc(e).collection("paymentMethods").doc(n).update({active:i})}deleteAccountPaymentMethod(e,n){return this.afs.collection("customers").doc(e).collection("paymentMethods").doc(n).delete()}static{this.\u0275fac=function(n){return new(n||t)(pn(Er))}}static{this.\u0275prov=Dn({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Wf(t,r){if(t&1){let e=ke();wi(0),u(1,"div",4)(2,"label",5),C(3),m(),u(4,"nz-switch",6),le("ngModelChange",function(i){let a=se(e).$implicit,s=j();return oe(s.onChange(i,a))}),m()(),Ei()}if(t&2){let e=r.$implicit;y(3),Be("",e.name,"\xA0"),y(),F("ngModel",e.active)}}var L0=(()=>{class t{constructor(e){this.messageService=e,this.loading=!1,this.rolService=we(rr),this.stopSubscription$=new qt,this.paymentMethodsList=[],this.accountPaymentMethods=[],this.infoLoad=[],this.paymentMethodsService=we(O0),this.authService=we(Ot),this.authService.user.subscribe(n=>{n&&this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.user=n,this.rolService.getRol(this.user.rolId).valueChanges().subscribe(i=>{this.infoLoad=i,this.userlevelAccess=this.infoLoad.optionAccessLavel}))})}ngOnInit(){this.getSubscriptions()}ngOnDestroy(){this.stopSubscription$.next(!1),this.stopSubscription$.complete()}sendMessage(e,n){this.messageService.create(e,n)}getSubscriptions(){this.paymentMethodsService.getAccountPaymentMethods(this.accountId).pipe(pt(this.stopSubscription$),Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return De({id:i},a)})),Ir(e=>(this.accountPaymentMethods=e,e.length==0&&this.createDefaultPaymentMethods(),e))).subscribe(()=>{this.loading=!1})}createDefaultPaymentMethods(){this.userlevelAccess!="3"?this.paymentMethodsService.createDefaultPaymentMethods(this.accountId):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}onChange(e,n){this.paymentMethodsService.toggleActiveAccountPaymentMethod(this.accountId,n.id,e)}static{this.\u0275fac=function(n){return new(n||t)(Te(Ke))}}static{this.\u0275cmp=rt({type:t,selectors:[["app-shared-account-payment-methods"]],inputs:{accountId:"accountId"},decls:4,vars:2,consts:[[1,"container"],["nzType","inner","nzTitle","M\xE9todos de Pago (Aplican cuando el Usuario es responsable del Pago)",3,"nzLoading"],[1,"row"],[4,"ngFor","ngForOf"],[1,"col-md-6"],["nzFor","pm.name"],["nzCheckedChildren","Si","nzUnCheckedChildren","No",3,"ngModelChange","ngModel"]],template:function(n,i){n&1&&(u(0,"div",0)(1,"nz-card",1)(2,"div",2),ue(3,Wf,5,2,"ng-container",3),m()()()),n&2&&(y(),F("nzLoading",i.loading),y(2),F("ngForOf",i.accountPaymentMethods))},dependencies:[xt,na,Hr,vt,Ln]})}}return t})();function Gf(t,r){if(t&1&&(u(0,"h5",68),C(1),m()),t&2){let e=j(2);y(),Ce(e.record.name)}}function Xf(t,r){if(t&1&&(u(0,"nz-option",69),L(1,"i",70),C(2),m()),t&2){let e=r.$implicit;F("nzLabel",e.name)("nzValue",e.uid),y(2),Be(" ",e.name,"")}}function jf(t,r){if(t&1&&(u(0,"nz-option",69),L(1,"i",70),C(2),m()),t&2){let e=r.$implicit;F("nzLabel",e.displayName)("nzValue",e.uid),y(2),Be(" ",e.displayName,"")}}function $f(t,r){if(t&1){let e=ke();u(0,"a",71),le("click",function(){se(e);let i=j(2);return oe(i.onSubmit())}),C(1,"Actualizar"),m()}}function qf(t,r){if(t&1){let e=ke();u(0,"div",2)(1,"form",3),le("ngSubmit",function(){se(e);let i=j();return oe(i.onSubmit())}),u(2,"nz-card",4)(3,"div",5),L(4,"nz-avatar",6),u(5,"div",7),ue(6,Gf,2,1,"h5",8),u(7,"p",9),C(8),L(9,"br"),C(10),m()(),u(11,"nz-upload",10),le("nzChange",function(i){se(e);let a=j();return oe(a.handleChange(i))}),u(12,"button",11)(13,"span"),C(14,"Cambiar im\xE1gen "),m()()()(),L(15,"hr",12),u(16,"div",13)(17,"div",14)(18,"nz-form-item")(19,"nz-form-label",15),C(20,"Nombre"),m(),u(21,"nz-form-control"),L(22,"input",16),m()()(),u(23,"div",14)(24,"nz-form-item")(25,"nz-form-label",17),C(26,"Raz\xF3n Social"),m(),u(27,"nz-form-control"),L(28,"input",18),m()()()(),u(29,"div",13)(30,"div",19)(31,"nz-form-item")(32,"nz-form-label",20),C(33,"RFC"),m(),u(34,"nz-form-control"),L(35,"input",21),m()()(),u(36,"div",19)(37,"nz-form-item")(38,"nz-form-label",20),C(39,"Giro"),m(),u(40,"nz-form-control")(41,"nz-select",22),le("ngModelChange",function(i){se(e);let a=j();return oe(a.onJobTypeSelected(i))}),ue(42,Xf,3,3,"nz-option",23),m()()()(),u(43,"div",19)(44,"nz-form-item")(45,"nz-form-label",20),C(46,"Consecutivo"),m(),u(47,"nz-form-control"),L(48,"input",24),m()()()(),u(49,"div",13)(50,"div",25)(51,"nz-form-item")(52,"nz-form-label",26),C(53,"Tel\xE9fono"),m(),u(54,"nz-form-control"),L(55,"input",27),m()()(),u(56,"div",25)(57,"nz-form-item")(58,"nz-form-label",28),C(59,"Sitio Web"),m(),u(60,"nz-form-control"),L(61,"input",29),m()()(),u(62,"div",25)(63,"nz-form-item")(64,"nz-form-label",30),C(65,"Persona Contacto"),m(),u(66,"nz-form-control"),L(67,"input",31),m()()(),u(68,"div",25)(69,"nz-form-item")(70,"nz-form-label",32),C(71,"Responsable"),m(),u(72,"nz-form-control")(73,"nz-select",33),ue(74,jf,3,3,"nz-option",23),m()()()()()(),ue(75,$f,2,0,"ng-template",null,0,Ge),u(77,"nz-card",34)(78,"div",13)(79,"div",35)(80,"nz-form-item")(81,"nz-form-label",36),C(82,"Calle"),m(),u(83,"nz-form-control"),L(84,"input",37),m()()(),u(85,"div",25)(86,"nz-form-item")(87,"nz-form-label",38),C(88,"N\xFAmero"),m(),u(89,"nz-form-control"),L(90,"input",39),m()()()(),u(91,"div",13)(92,"div",14)(93,"nz-form-item")(94,"nz-form-label",36),C(95,"Entre Calles"),m(),u(96,"nz-form-control"),L(97,"input",40),m()()(),u(98,"div",14)(99,"nz-form-item")(100,"nz-form-label",41),C(101,"Fracc / Colonia"),m(),u(102,"nz-form-control"),L(103,"input",42),m()()()(),u(104,"div",13)(105,"div",43)(106,"nz-form-item")(107,"nz-form-label",44),C(108,"C\xF3digo Postal"),m(),u(109,"nz-form-control"),L(110,"input",45),m()()(),u(111,"div",46)(112,"nz-form-item")(113,"nz-form-label",47),C(114,"Ciudad / Municipio"),m(),u(115,"nz-form-control"),L(116,"input",48),m()()(),u(117,"div",46)(118,"nz-form-item")(119,"nz-form-label",49),C(120,"Estado"),m(),u(121,"nz-form-control"),L(122,"input",50),m()()()()(),u(123,"nz-card",51)(124,"div",13)(125,"div",19)(126,"nz-form-item")(127,"nz-form-label",52)(128,"span"),C(129," Origen de los pagos "),L(130,"i",53),m()(),u(131,"nz-form-control",54)(132,"nz-select",55),L(133,"nz-option",56)(134,"nz-option",57),m()()()()(),u(135,"div",13)(136,"div",19)(137,"nz-form-item")(138,"nz-form-label",58)(139,"span"),C(140," Obligatorio subir en la estaci\xF3n definida "),L(141,"i",59),m()(),u(142,"nz-form-control",54)(143,"nz-select",60),L(144,"nz-option",61)(145,"nz-option",62),m()()()(),u(146,"div",19)(147,"nz-form-item")(148,"nz-form-label",63)(149,"span"),C(150," Obligatorio subir en el turno definido "),L(151,"i",64),m()(),u(152,"nz-form-control",54)(153,"nz-select",65),L(154,"nz-option",61)(155,"nz-option",62),m()()()(),u(156,"div",19)(157,"nz-form-item")(158,"nz-form-label",63)(159,"span"),C(160," Obligatorio subir en la operaci\xF3n definida "),L(161,"i",66),m()(),u(162,"nz-form-control",54)(163,"nz-select",67),L(164,"nz-option",61)(165,"nz-option",62),m()()()()()()()()}if(t&2){let e=be(76),n=j();y(),F("formGroup",n.objectForm),y(),F("nzExtra",e)("nzLoading",n.loading),y(2),F("nzSize",80)("nzSrc",n.record.imageUrl),y(2),F("ngIf",!!n.record),y(2),Be(" ",n.record.address," "),y(2),Zi(" ",n.record.address2," ",n.record.address3," "),y(),F("nzShowUploadList",!1),y(31),F("ngForOf",n.jobType),y(32),F("ngForOf",n.usersList),y(57),F("nzSpan",12),y(11),F("nzSpan",12),y(10),F("nzSpan",12),y(10),F("nzSpan",12)}}var R0=(()=>{class t{constructor(e,n,i){this.messageService=e,this.bucketStorage=n,this.fb=i,this.stopSubscription$=new qt,this.loading=!0,this.infoLoad=[],this.rolService=we(rr),this.authService=we(Ot),this.accountsService=we(Un),this.userService=we(Bn),this.infoSegment=[],this.avatarUrl="http://themenate.com/applicator/dist/assets/images/avatars/thumb-13.jpg",this.uploading=!1,this.bucketPath="customers/",this.uploadvalue=0,this.vendorService=we($n),this.authService.user.subscribe(a=>{a&&(this.user=a,this.user!==null&&this.user!==void 0&&this.user.rolId!==void 0&&(this.rolService.getRol(this.user.rolId).valueChanges().subscribe(s=>{this.infoLoad=s,this.userlevelAccess=this.infoLoad.optionAccessLavel}),this.accountsSubscription=this.accountsService.getJobType().pipe(Fe(s=>s.map(o=>{let c=o.payload.doc.id,l=o.payload.doc.data();return De({id:c},l)}))).subscribe(s=>{this.jobType=s}),this.accountsSubscription=this.accountsService.getUsersByCustomer(this.accountId).pipe(Fe(s=>s.map(o=>{let c=o.payload.doc.id,l=o.payload.doc.data();return De({id:c},l)}))).subscribe(s=>{this.usersList=s}),this.accountsService.getSegmentLevel(this.user.idSegment).pipe(pt(this.stopSubscription$),Fe(s=>{let o=s.payload.id,c=s.payload.data();return De({id:o},c)}),Ir(s=>(this.infoSegment=s,s))).subscribe()))})}ngOnInit(){this.createForm(),this.getSubscription()}createForm(){this.objectForm=this.fb.group({active:[!1,[fe.required]],imageUrl:[""],address:[""],paymentResponsible:[1,[fe.required]],name:["",[fe.required]],socialName:[""],rfc:[""],addressNumber:[""],address2:[""],address3:[""],zip:[""],city:[""],state:[""],forceStopPoints:[!0],forceRoute:[!0],forceRound:[!0],website:[""],phoneNumber:[""],jobTypeID:[""],custConsecutive:[""],primaryContact:[""],responsableUser:[""]})}patchForm(e){this.objectForm.patchValue({active:e.active||!1,imageUrl:e.imageUrl||"",address:e.address||"",addressNumber:e.addressNumber||"",name:e.name||"",paymentResponsible:e.paymentResponsible||1,socialName:e.socialName||"",rfc:e.rfc||"",address2:e.address2||"",address3:e.address3||"",zip:e.zip||"",city:e.city||"",state:e.state||"",forceStopPoints:e.forceStopPoints||!0,forceRoute:e.forceRoute||!0,forceRound:e.forceRound||!0,website:e.website||"",phoneNumber:e.phoneNumber||"",jobTypeID:e.jobTypeID||"",custConsecutive:e.custConsecutive||"",primaryContact:e.primaryContact||"",responsableUser:e.responsableUser||""})}ngOnDestroy(){this.stopSubscription$.next(!1),this.stopSubscription$.complete()}getSubscription(){this.accountsService.getAccount(this.accountId).pipe(pt(this.stopSubscription$),Fe(e=>{let n=e.payload.id,i=e.payload.data();return De({id:n},i)}),Ir(e=>(this.patchForm(e),this.record=e,this.loading=!1,e))).subscribe()}getBase64(e,n){let i=new FileReader;i.addEventListener("load",()=>{i.result!==null&&typeof i.result=="string"?n(i.result):this.messageService.error("Invalid Form")}),i.readAsDataURL(e)}handleChange(e){e.file.originFileObj&&this.getBase64(e.file.originFileObj,n=>{this.avatarUrl=n;let i=e.file.name,a=`${this.bucketPath}/${i}`,s=this.bucketStorage.ref(a);this.task=this.bucketStorage.ref(a).putString(n,"data_url"),this.uploadPercent=this.task.percentageChanges(),this.uploadPercent.pipe(Fe(o=>Number((o/100).toFixed(2)))).subscribe(o=>{this.uploading=o!=0,this.uploadvalue=o}),this.task.snapshotChanges().pipe(mn(()=>{this.uploading=!1,this.downloadURL=s.getDownloadURL(),this.downloadURL.subscribe(o=>gr(this,null,function*(){this.updatePhotoURL(o)}))})).subscribe()})}updatePhotoURL(e){return gr(this,null,function*(){this.objectForm.controls.imageUrl.patchValue(e),this.userlevelAccess!="3"?this.accountsService.updateAvatarAccount(this.accountId,e):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")})}sendMessage(e,n){this.messageService.create(e,n)}onSubmit(){this.userlevelAccess!="3"?this.accountsService.updateAccount(this.accountId,this.objectForm.value).then(()=>{this.sendMessage("sucess","El registro a sido actualizado con \xE9xito.")},e=>{this.sendMessage("error",e)}).catch(e=>this.sendMessage("error",e)):this.sendMessage("error","El usuario no tiene permisos para actualizar datos, favor de contactar al administrador.")}onJobTypeSelected(e){if(console.log(e),e!=null){let n=this.jobType.filter(i=>i.uid===e);if(n.length>0){let i=n[0].consecutive;i=parseInt(i,10)+1,i=i.toString().padStart(4,"0"),this.objectForm.controls.custConsecutive.setValue(n[0].type+i)}}}static{this.\u0275fac=function(n){return new(n||t)(Te(Ke),Te(Kn),Te(gt))}}static{this.\u0275cmp=rt({type:t,selectors:[["app-shared-account-edit"]],inputs:{accountId:"accountId"},decls:1,vars:1,consts:[["basicTpl",""],["class","container",4,"ngIf"],[1,"container"],["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],["nzType","inner","nzTitle","Informaci\xF3n B\xE1sica",3,"nzExtra","nzLoading"],[1,"media","align-items-center"],["nzIcon","user","nzSize","large","nzSrc","",2,"background-color","white","color","#4F6F57",3,"nzSize","nzSrc"],[1,"m-l-20","m-r-20"],["class","m-b-5 font-size-18",4,"ngIf"],[1,"opacity-07","font-size-13","m-b-0"],["nzName","imageUrl",3,"nzChange","nzShowUploadList"],["nz-button","","nzGhost","",2,"background-color","#4F6F57","color","#f6f3ea"],[1,"m-v-25"],[1,"row"],[1,"col-md-6"],["nzFor","name"],["nz-input","","formControlName","name","type","text"],["nzFor","socialName"],["nz-input","","formControlName","socialName","type","text"],[1,"col-md-4"],["nzFor","rfc"],["nz-input","","formControlName","rfc","type","text"],["formControlName","jobTypeID","nzAllowClear","","nzPlaceHolder","Selecciona el Giro de la Empresa",3,"ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-input","","formControlName","custConsecutive","nzDisabled",""],[1,"col-md-3"],["nzFor","phoneNumber"],["nz-input","","formControlName","phoneNumber","placeholder","Tel\xE9fono"],["nzFor","website"],["nz-input","","formControlName","website","placeholder","website"],["nzFor","primaryContact"],["nz-input","","formControlName","primaryContact","placeholder","Contacto principal"],["nzFor","responsableUser"],["formControlName","responsableUser","nzAllowClear","","nzPlaceHolder","Selecciona Usuario Responsable"],["nzType","inner","nzTitle","Direcci\xF3n"],[1,"col-md-9"],["nzFor","address"],["nz-input","","formControlName","address","placeholder","Calle"],["nzFor","addressNumber"],["nz-input","","formControlName","addressNumber","placeholder","N\xFAmero"],["nz-input","","formControlName","address2","placeholder","Entre calles"],["nzFor","address3"],["nz-input","","formControlName","address3","placeholder","Fracc / Colonia"],[1,"col-md-2"],["nzFor","zip"],["nz-input","","formControlName","zip","placeholder","C\xF3digo Postal"],[1,"col-md-5"],["nzFor","city"],["nz-input","","formControlName","city","placeholder","Ciudad / Municipio"],["nzFor","state"],["nz-input","","formControlName","state","placeholder","Estado"],["nzType","inner","nzTitle","Par\xE1metros de Servicio"],["nzFor","paymentResponsible","nzRequired",""],["nz-icon","","nz-tooltip","","nzTooltipTitle","\xBFQui\xE9n es el responsable de emitir un pago por el servicio?","nzType","question-circle","nzTheme","outline"],[3,"nzSpan"],["name","select-error","formControlName","paymentResponsible"],["nzValue","0","nzLabel","Empresa"],["nzValue","1","nzLabel","Usuario"],["nzFor","forceStopPoints","nzRequired",""],["nz-icon","","nz-tooltip","","nzTooltipTitle","\xBFEs obligatorio que el usuario suba exclusivamente en la estaci\xF3n seleccionada?","nzType","question-circle","nzTheme","outline"],["name","select-error","formControlName","forceStopPoints"],["nzValue","true","nzLabel","Si"],["nzValue","false","nzLabel","No"],["nzFor","forceRound","nzRequired",""],["nz-icon","","nz-tooltip","","nzTooltipTitle","\xBFEs obligatorio que el usuario suba exclusivamente en el turno seleccionada?","nzType","question-circle","nzTheme","outline"],["name","select-error","formControlName","forceRound"],["nz-icon","","nz-tooltip","","nzTooltipTitle","\xBFEs obligatorio que el usuario suba exclusivamente en la operaci\xF3n seleccionada?","nzType","question-circle","nzTheme","outline"],["name","select-error","formControlName","forceRoute"],[1,"m-b-5","font-size-18"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon",""],[3,"click"]],template:function(n,i){n&1&&ue(0,qf,166,16,"div",1),n&2&&F("ngIf",!!i.record)},dependencies:[xt,Sr,Tr,Jt,Yt,Qt,Zt,tr,er,kr,Rn,Jn,Wr,Mt,Lt,Rt,Hr,ir,ar,It,wr,vt,Dt,Nt,Pt]})}}return t})();var Mi={};Mi.version="0.18.5";var Sn=1200,ui=1252,Yf=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Jf={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Co=function(t){Yf.indexOf(t)!=-1&&(ui=Jf[0]=t)};function Zf(){Co(1252)}var Bi=function(t){Sn=t,Co(t)};function Qf(){Bi(1200),Zf()}function eu(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var ca=function(r){return String.fromCharCode(r)},M0=function(r){return String.fromCharCode(r)},Ue;var Ar=null,zi=!0,an="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Vi(t){for(var r="",e=0,n=0,i=0,a=0,s=0,o=0,c=0,l=0;l<t.length;)e=t.charCodeAt(l++),a=e>>2,n=t.charCodeAt(l++),s=(e&3)<<4|n>>4,i=t.charCodeAt(l++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),r+=an.charAt(a)+an.charAt(s)+an.charAt(o)+an.charAt(c);return r}function Br(t){var r="",e=0,n=0,i=0,a=0,s=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<t.length;)a=an.indexOf(t.charAt(l++)),s=an.indexOf(t.charAt(l++)),e=a<<2|s>>4,r+=String.fromCharCode(e),o=an.indexOf(t.charAt(l++)),n=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(n)),c=an.indexOf(t.charAt(l++)),i=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(i));return r}var Ie=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ur=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function En(t){return Ie?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function B0(t){return Ie?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var mr=function(r){return Ie?Ur(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function za(t){if(typeof ArrayBuffer>"u")return mr(t);for(var r=new ArrayBuffer(t.length),e=new Uint8Array(r),n=0;n!=t.length;++n)e[n]=t.charCodeAt(n)&255;return r}function Xi(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function tu(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ut=Ie?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:Ur(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var n=new Uint8Array(e),i=0;for(r=0,e=0;r<t.length;e+=i,++r)if(i=t[r].length,t[r]instanceof Uint8Array)n.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";n.set(new Uint8Array(t[r]),e)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function ru(t){for(var r=[],e=0,n=t.length+250,i=En(t.length+255),a=0;a<t.length;++a){var s=t.charCodeAt(a);if(s<128)i[e++]=s;else if(s<2048)i[e++]=192|s>>6&31,i[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=t.charCodeAt(++a)&1023;i[e++]=240|s>>8&7,i[e++]=128|s>>2&63,i[e++]=128|o>>6&15|(s&3)<<4,i[e++]=128|o&63}else i[e++]=224|s>>12&15,i[e++]=128|s>>6&63,i[e++]=128|s&63;e>n&&(r.push(i.slice(0,e)),e=0,i=En(65535),n=65530)}return r.push(i.slice(0,e)),ut(r)}var si=/\u0000/g,la=/[\u0001-\u0006]/g;function oi(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function pr(t,r){var e=""+t;return e.length>=r?e:je("0",r-e.length)+e}function fs(t,r){var e=""+t;return e.length>=r?e:je(" ",r-e.length)+e}function va(t,r){var e=""+t;return e.length>=r?e:e+je(" ",r-e.length)}function nu(t,r){var e=""+Math.round(t);return e.length>=r?e:je("0",r-e.length)+e}function iu(t,r){var e=""+t;return e.length>=r?e:je("0",r-e.length)+e}var V0=Math.pow(2,32);function ti(t,r){if(t>V0||t<-V0)return nu(t,r);var e=Math.round(t);return iu(e,r)}function ga(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var U0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Za=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function au(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var $e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},W0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},su={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _a(t,r,e){for(var n=t<0?-1:1,i=t*n,a=0,s=1,o=0,c=1,l=0,f=0,v=Math.floor(i);l<r&&(v=Math.floor(i),o=v*s+a,f=v*l+c,!(i-v<5e-8));)i=1/(i-v),a=s,s=o,c=l,l=f;if(f>r&&(l>r?(f=c,o=a):(f=l,o=s)),!e)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function fa(t,r,e){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),a=0,s=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=e?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=e?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),e&&(a=du(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var yo=new Date(1899,11,31,0,0,0),ou=yo.getTime(),cu=new Date(1900,2,1,0,0,0);function Fo(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=cu&&(e+=24*60*60*1e3),(e-(ou+(t.getTimezoneOffset()-yo.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function us(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function lu(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function fu(t){var r=t<0?12:11,e=us(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function uu(t){var r=us(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function hu(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=fu(t):r===10?e=t.toFixed(10).substr(0,12):e=uu(t),us(lu(e.toUpperCase()))}function ss(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):hu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return on(14,Fo(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function du(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function mu(t,r,e,n){var i="",a=0,s=0,o=e.y,c,l=0;switch(t){case 98:o=e.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:c=e.m,l=r.length;break;case 3:return Za[e.m-1][1];case 5:return Za[e.m-1][0];default:return Za[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=e.d,l=r.length;break;case 3:return U0[e.q][0];default:return U0[e.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(e.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=e.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=e.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?pr(e.S,r.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(e.S+e.u)),a>=60*s&&(a=0),r==="s"?a===0?"0":""+a/s:(i=pr(a,2+n),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?pr(c,l):"";return f}function sn(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,n=t.substr(0,e);e!=t.length;e+=r)n+=(n.length>0?",":"")+t.substr(e,r);return n}var Ao=/%/g;function pu(t,r,e){var n=r.replace(Ao,""),i=r.length-n.length;return Lr(t,n,e*Math.pow(10,2*i))+je("%",i)}function xu(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Lr(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function bo(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+bo(t,-r);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),e=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),e.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+a):e+="E+"+(s-a);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var zo=/# (\?+)( ?)\/( ?)(\d+)/;function vu(t,r,e){var n=parseInt(t[4],10),i=Math.round(r*n),a=Math.floor(i/n),s=i-a*n,o=n;return e+(a===0?"":""+a)+" "+(s===0?je(" ",t[1].length+1+t[4].length):fs(s,t[1].length)+t[2]+"/"+t[3]+pr(o,t[4].length))}function gu(t,r,e){return e+(r===0?"":""+r)+je(" ",t[1].length+2+t[4].length)}var Do=/^#*0*\.([0#]+)/,Io=/\).*[0#]/,No=/\(###\) ###\\?-####/;function Ct(t){for(var r="",e,n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function H0(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function G0(t,r){var e=t-Math.floor(t),n=Math.pow(10,r);return r<(""+Math.round(e*n)).length?0:Math.round(e*n)}function _u(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function Su(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function sr(t,r,e){if(t.charCodeAt(0)===40&&!r.match(Io)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?sr("n",n,e):"("+sr("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return xu(t,r,e);if(r.indexOf("%")!==-1)return pu(t,r,e);if(r.indexOf("E")!==-1)return bo(r,e);if(r.charCodeAt(0)===36)return"$"+sr(t,r.substr(r.charAt(1)==" "?2:1),e);var i,a,s,o,c=Math.abs(e),l=e<0?"-":"";if(r.match(/^00+$/))return l+ti(c,r.length);if(r.match(/^[#?]+$/))return i=ti(e,0),i==="0"&&(i=""),i.length>r.length?i:Ct(r.substr(0,r.length-i.length))+i;if(a=r.match(zo))return vu(a,c,l);if(r.match(/^#+0+$/))return l+ti(c,r.length-r.indexOf("0"));if(a=r.match(Do))return i=H0(e,a[1].length).replace(/^([^\.]+)$/,"$1."+Ct(a[1])).replace(/\.$/,"."+Ct(a[1])).replace(/\.(\d*)$/,function(w,h){return"."+h+je("0",Ct(a[1]).length-h.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return l+H0(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return l+sn(ti(c,0));if(a=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+sr(t,r,-e):sn(""+(Math.floor(e)+_u(e,a[1].length)))+"."+pr(G0(e,a[1].length),a[1].length);if(a=r.match(/^#,#*,#0/))return sr(t,r.replace(/^#,#*,/,""),e);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=oi(sr(t,r.replace(/[\\-]/g,""),e)),s=0,oi(oi(r.replace(/\\/g,"")).replace(/[0#]/g,function(w){return s<i.length?i.charAt(s++):w==="0"?"0":""}));if(r.match(No))return i=sr(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=_a(c,Math.pow(10,s)-1,!1),i=""+l,f=Lr("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=va(o[2],s),f.length<a[4].length&&(f=Ct(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=_a(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?fs(o[1],s)+a[2]+"/"+a[3]+va(o[2],s):je(" ",2*s+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=ti(e,0),r.length<=i.length?i:Ct(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var v=r.indexOf(".")-s,p=r.length-i.length-v;return Ct(r.substr(0,v)+i+r.substr(r.length-p))}if(a=r.match(/^00,000\.([#0]*0)$/))return s=G0(e,a[1].length),e<0?"-"+sr(t,r,-e):sn(Su(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?pr(0,3-w.length):"")+w})+"."+pr(s,a[1].length);switch(r){case"###,##0.00":return sr(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var x=sn(ti(c,0));return x!=="0"?l+x:"";case"###,###.00":return sr(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return sr(t,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function wu(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Lr(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function Eu(t,r,e){var n=r.replace(Ao,""),i=r.length-n.length;return Lr(t,n,e*Math.pow(10,2*i))+je("%",i)}function Po(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Po(t,-r);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),e=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!e.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+a):e+="E+"+(s-a),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function yr(t,r,e){if(t.charCodeAt(0)===40&&!r.match(Io)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?yr("n",n,e):"("+yr("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return wu(t,r,e);if(r.indexOf("%")!==-1)return Eu(t,r,e);if(r.indexOf("E")!==-1)return Po(r,e);if(r.charCodeAt(0)===36)return"$"+yr(t,r.substr(r.charAt(1)==" "?2:1),e);var i,a,s,o,c=Math.abs(e),l=e<0?"-":"";if(r.match(/^00+$/))return l+pr(c,r.length);if(r.match(/^[#?]+$/))return i=""+e,e===0&&(i=""),i.length>r.length?i:Ct(r.substr(0,r.length-i.length))+i;if(a=r.match(zo))return gu(a,c,l);if(r.match(/^#+0+$/))return l+pr(c,r.length-r.indexOf("0"));if(a=r.match(Do))return i=(""+e).replace(/^([^\.]+)$/,"$1."+Ct(a[1])).replace(/\.$/,"."+Ct(a[1])),i=i.replace(/\.(\d*)$/,function(w,h){return"."+h+je("0",Ct(a[1]).length-h.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return l+sn(""+c);if(a=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+yr(t,r,-e):sn(""+e)+"."+je("0",a[1].length);if(a=r.match(/^#,#*,#0/))return yr(t,r.replace(/^#,#*,/,""),e);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=oi(yr(t,r.replace(/[\\-]/g,""),e)),s=0,oi(oi(r.replace(/\\/g,"")).replace(/[0#]/g,function(w){return s<i.length?i.charAt(s++):w==="0"?"0":""}));if(r.match(No))return i=yr(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=_a(c,Math.pow(10,s)-1,!1),i=""+l,f=Lr("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=va(o[2],s),f.length<a[4].length&&(f=Ct(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=_a(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?fs(o[1],s)+a[2]+"/"+a[3]+va(o[2],s):je(" ",2*s+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=""+e,r.length<=i.length?i:Ct(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var v=r.indexOf(".")-s,p=r.length-i.length-v;return Ct(r.substr(0,v)+i+r.substr(r.length-p))}if(a=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+yr(t,r,-e):sn(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?pr(0,3-w.length):"")+w})+"."+pr(0,a[1].length);switch(r){case"###,###":case"##,###":case"#,###":var x=sn(""+c);return x!=="0"?l+x:"";default:if(r.match(/\.[0#?]*$/))return yr(t,r.slice(0,r.lastIndexOf(".")),e)+Ct(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Lr(t,r,e){return(e|0)===e?yr(t,r,e):sr(t,r,e)}function Tu(t){for(var r=[],e=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=t.substr(i,n-i),i=n+1}if(r[r.length]=t.substr(i),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var Oo=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Lo(t){for(var r=0,e="",n="";r<t.length;)switch(e=t.charAt(r)){case"G":ga(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(n=e;t.charAt(r++)!=="]"&&r<t.length;)n+=t.charAt(r);if(n.match(Oo))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function ku(t,r,e,n){for(var i=[],a="",s=0,o="",c="t",l,f,v,p="H";s<t.length;)switch(o=t.charAt(s)){case"G":if(!ga(t,s))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(v=t.charCodeAt(++s))!==34&&s<t.length;)a+=String.fromCharCode(v);i[i.length]={t:"t",v:a},++s;break;case"\\":var x=t.charAt(++s),w=x==="("||x===")"?x:"t";i[i.length]={t:w,v:x},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:r},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(l==null&&(l=fa(r,e,t.charAt(s+1)==="2"),l==null))return"";i[i.length]={t:"X",v:t.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=fa(r,e),l==null))return"";for(a=o;++s<t.length&&t.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:a},c=o;break;case"A":case"a":case"\u4E0A":var h={t:o,v:o};if(l==null&&(l=fa(r,e)),t.substr(s,3).toUpperCase()==="A/P"?(l!=null&&(h.v=l.H>=12?"P":"A"),h.t="T",p="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(l!=null&&(h.v=l.H>=12?"PM":"AM"),h.t="T",s+=5,p="h"):t.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(h.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),h.t="T",s+=5,p="h"):(h.t="t",++s),l==null&&h.t==="T")return"";i[i.length]=h,c=o;break;case"[":for(a=o;t.charAt(s++)!=="]"&&s<t.length;)a+=t.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Oo)){if(l==null&&(l=fa(r,e),l==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Lo(t)||(i[i.length]={t:"t",v:a}));break;case".":if(l!=null){for(a=o;++s<t.length&&(o=t.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},c=o;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)a+=t.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++s;break}var S=0,D=0,I;for(s=i.length-1,c="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=p,c="h",S<1&&(S=1);break;case"s":(I=i[s].v.match(/\.0+$/))&&(D=Math.max(D,I[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":c=i[s].t;break;case"m":c==="s"&&(i[s].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[s].v.match(/[Hh]/)&&(S=1),S<2&&i[s].v.match(/[Mm]/)&&(S=2),S<3&&i[s].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var P="",H;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=mu(i[s].t.charCodeAt(0),i[s].v,l,D),i[s].t="t";break;case"n":case"?":for(H=s+1;i[H]!=null&&((o=i[H].t)==="?"||o==="D"||(o===" "||o==="t")&&i[H+1]!=null&&(i[H+1].t==="?"||i[H+1].t==="t"&&i[H+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[H].v==="/"||i[H].v===" "&&i[H+1]!=null&&i[H+1].t=="?"));)i[s].v+=i[H].v,i[H]={v:"",t:";"},++H;P+=i[s].v,s=H-1;break;case"G":i[s].t="t",i[s].v=ss(r,e);break}var Z="",me,N;if(P.length>0){P.charCodeAt(0)==40?(me=r<0&&P.charCodeAt(0)===45?-r:r,N=Lr("n",P,me)):(me=r<0&&n>1?-r:r,N=Lr("n",P,me),me<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),H=N.length-1;var q=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){q=s;break}var W=i.length;if(q===i.length&&N.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(H>=i[s].v.length-1?(H-=i[s].v.length,i[s].v=N.substr(H+1,i[s].v.length)):H<0?i[s].v="":(i[s].v=N.substr(0,H+1),H=-1),i[s].t="t",W=s);H>=0&&W<i.length&&(i[W].v=N.substr(0,H+1)+i[W].v)}else if(q!==i.length&&N.indexOf("E")===-1){for(H=N.indexOf(".")-1,s=q;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(f=i[s].v.indexOf(".")>-1&&s===q?i[s].v.indexOf(".")-1:i[s].v.length-1,Z=i[s].v.substr(f+1);f>=0;--f)H>=0&&(i[s].v.charAt(f)==="0"||i[s].v.charAt(f)==="#")&&(Z=N.charAt(H--)+Z);i[s].v=Z,i[s].t="t",W=s}for(H>=0&&W<i.length&&(i[W].v=N.substr(0,H+1)+i[W].v),H=N.indexOf(".")+1,s=q;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==q)){for(f=i[s].v.indexOf(".")>-1&&s===q?i[s].v.indexOf(".")+1:0,Z=i[s].v.substr(0,f);f<i[s].v.length;++f)H<N.length&&(Z+=N.charAt(H++));i[s].v=Z,i[s].t="t",W=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(me=n>1&&r<0&&s>0&&i[s-1].v==="-"?-r:r,i[s].v=Lr(i[s].t,i[s].v,me),i[s].t="t");var X="";for(s=0;s!==i.length;++s)i[s]!=null&&(X+=i[s].v);return X}var X0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function j0(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function Cu(t,r){var e=Tu(t),n=e.length,i=e[n-1].indexOf("@");if(n<4&&i>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||i>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var a=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,a];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(X0),o=e[1].match(X0);return j0(r,s)?[n,e[0]]:j0(r,o)?[n,e[1]]:[n,e[s!=null&&o!=null?2:1]]}return[n,a]}function on(t,r,e){e==null&&(e={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?n=e.dateNF:n=t;break;case"number":t==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:$e)[t],n==null&&(n=e.table&&e.table[W0[t]]||$e[W0[t]]),n==null&&(n=su[t]||"General");break}if(ga(n,0))return ss(r,e);r instanceof Date&&(r=Fo(r,e.date1904));var i=Cu(n,r);if(ga(i[1]))return ss(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return ku(i[1],r,e,i[0])}function Ro(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if($e[e]==null){r<0&&(r=e);continue}if($e[e]==t){r=e;break}}r<0&&(r=391)}return $e[r]=t,r}function Da(t){for(var r=0;r!=392;++r)t[r]!==void 0&&Ro(t[r],r)}function Ia(){$e=au()}var Mo=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function yu(t){var r=typeof t=="number"?$e[t]:t;return r=r.replace(Mo,"(\\d+)"),new RegExp("^"+r+"$")}function Fu(t,r,e){var n=-1,i=-1,a=-1,s=-1,o=-1,c=-1;(r.match(Mo)||[]).forEach(function(v,p){var x=parseInt(e[p+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=x;break;case"d":a=x;break;case"h":s=x;break;case"s":c=x;break;case"m":s>=0?o=x:i=x;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?l:n==-1&&i==-1&&a==-1?f:l+"T"+f}var Au=function(){var t={};t.version="1.2.0";function r(){for(var N=0,q=new Array(256),W=0;W!=256;++W)N=W,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,q[W]=N;return typeof Int32Array<"u"?new Int32Array(q):q}var e=r();function n(N){var q=0,W=0,X=0,J=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)J[X]=N[X];for(X=0;X!=256;++X)for(W=N[X],q=256+X;q<4096;q+=256)W=J[q]=W>>>8^N[W&255];var Q=[];for(X=1;X!=16;++X)Q[X-1]=typeof Int32Array<"u"?J.subarray(X*256,X*256+256):J.slice(X*256,X*256+256);return Q}var i=n(e),a=i[0],s=i[1],o=i[2],c=i[3],l=i[4],f=i[5],v=i[6],p=i[7],x=i[8],w=i[9],h=i[10],S=i[11],D=i[12],I=i[13],P=i[14];function H(N,q){for(var W=q^-1,X=0,J=N.length;X<J;)W=W>>>8^e[(W^N.charCodeAt(X++))&255];return~W}function Z(N,q){for(var W=q^-1,X=N.length-15,J=0;J<X;)W=P[N[J++]^W&255]^I[N[J++]^W>>8&255]^D[N[J++]^W>>16&255]^S[N[J++]^W>>>24]^h[N[J++]]^w[N[J++]]^x[N[J++]]^p[N[J++]]^v[N[J++]]^f[N[J++]]^l[N[J++]]^c[N[J++]]^o[N[J++]]^s[N[J++]]^a[N[J++]]^e[N[J++]];for(X+=15;J<X;)W=W>>>8^e[(W^N[J++])&255];return~W}function me(N,q){for(var W=q^-1,X=0,J=N.length,Q=0,ve=0;X<J;)Q=N.charCodeAt(X++),Q<128?W=W>>>8^e[(W^Q)&255]:Q<2048?(W=W>>>8^e[(W^(192|Q>>6&31))&255],W=W>>>8^e[(W^(128|Q&63))&255]):Q>=55296&&Q<57344?(Q=(Q&1023)+64,ve=N.charCodeAt(X++)&1023,W=W>>>8^e[(W^(240|Q>>8&7))&255],W=W>>>8^e[(W^(128|Q>>2&63))&255],W=W>>>8^e[(W^(128|ve>>6&15|(Q&3)<<4))&255],W=W>>>8^e[(W^(128|ve&63))&255]):(W=W>>>8^e[(W^(224|Q>>12&15))&255],W=W>>>8^e[(W^(128|Q>>6&63))&255],W=W>>>8^e[(W^(128|Q&63))&255]);return~W}return t.table=e,t.bstr=H,t.buf=Z,t.str=me,t}(),Ve=function(){var r={};r.version="1.2.1";function e(d,E){for(var g=d.split("/"),_=E.split("/"),T=0,k=0,O=Math.min(g.length,_.length);T<O;++T){if(k=g[T].length-_[T].length)return k;if(g[T]!=_[T])return g[T]<_[T]?-1:1}return g.length-_.length}function n(d){if(d.charAt(d.length-1)=="/")return d.slice(0,-1).indexOf("/")===-1?d:n(d.slice(0,-1));var E=d.lastIndexOf("/");return E===-1?d:d.slice(0,E+1)}function i(d){if(d.charAt(d.length-1)=="/")return i(d.slice(0,-1));var E=d.lastIndexOf("/");return E===-1?d:d.slice(E+1)}function a(d,E){typeof E=="string"&&(E=new Date(E));var g=E.getHours();g=g<<6|E.getMinutes(),g=g<<5|E.getSeconds()>>>1,d.write_shift(2,g);var _=E.getFullYear()-1980;_=_<<4|E.getMonth()+1,_=_<<5|E.getDate(),d.write_shift(2,_)}function s(d){var E=d.read_shift(2)&65535,g=d.read_shift(2)&65535,_=new Date,T=g&31;g>>>=5;var k=g&15;g>>>=4,_.setMilliseconds(0),_.setFullYear(g+1980),_.setMonth(k-1),_.setDate(T);var O=E&31;E>>>=5;var U=E&63;return E>>>=6,_.setHours(E),_.setMinutes(U),_.setSeconds(O<<1),_}function o(d){Gt(d,0);for(var E={},g=0;d.l<=d.length-4;){var _=d.read_shift(2),T=d.read_shift(2),k=d.l+T,O={};switch(_){case 21589:g=d.read_shift(1),g&1&&(O.mtime=d.read_shift(4)),T>5&&(g&2&&(O.atime=d.read_shift(4)),g&4&&(O.ctime=d.read_shift(4))),O.mtime&&(O.mt=new Date(O.mtime*1e3));break}d.l=k,E[_]=O}return E}var c;function l(){return c||(c={})}function f(d,E){if(d[0]==80&&d[1]==75)return qs(d,E);if((d[0]|32)==109&&(d[1]|32)==105)return ul(d,E);if(d.length<512)throw new Error("CFB file size "+d.length+" < 512");var g=3,_=512,T=0,k=0,O=0,U=0,M=0,R=[],B=d.slice(0,512);Gt(B,0);var ee=v(B);switch(g=ee[0],g){case 3:_=512;break;case 4:_=4096;break;case 0:if(ee[1]==0)return qs(d,E);default:throw new Error("Major Version: Expected 3 or 4 saw "+g)}_!==512&&(B=d.slice(0,_),Gt(B,28));var ne=d.slice(0,_);p(B,g);var de=B.read_shift(4,"i");if(g===3&&de!==0)throw new Error("# Directory Sectors: Expected 0 saw "+de);B.l+=4,O=B.read_shift(4,"i"),B.l+=4,B.chk("00100000","Mini Stream Cutoff Size: "),U=B.read_shift(4,"i"),T=B.read_shift(4,"i"),M=B.read_shift(4,"i"),k=B.read_shift(4,"i");for(var ie=-1,ce=0;ce<109&&(ie=B.read_shift(4,"i"),!(ie<0));++ce)R[ce]=ie;var Se=x(d,_);S(M,k,Se,_,R);var We=I(Se,O,R,_);We[O].name="!Directory",T>0&&U!==ve&&(We[U].name="!MiniFAT"),We[R[0]].name="!FAT",We.fat_addrs=R,We.ssz=_;var zt={},qe=[],Wt=[],gi=[];P(O,We,Se,qe,T,zt,Wt,U),w(Wt,gi,qe),qe.shift();var _i={FileIndex:Wt,FullPaths:gi};return E&&E.raw&&(_i.raw={header:ne,sectors:Se}),_i}function v(d){if(d[d.l]==80&&d[d.l+1]==75)return[0,0];d.chk(Ne,"Header Signature: "),d.l+=16;var E=d.read_shift(2,"u");return[d.read_shift(2,"u"),E]}function p(d,E){var g=9;switch(d.l+=2,g=d.read_shift(2)){case 9:if(E!=3)throw new Error("Sector Shift: Expected 9 saw "+g);break;case 12:if(E!=4)throw new Error("Sector Shift: Expected 12 saw "+g);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+g)}d.chk("0600","Mini Sector Shift: "),d.chk("000000000000","Reserved: ")}function x(d,E){for(var g=Math.ceil(d.length/E)-1,_=[],T=1;T<g;++T)_[T-1]=d.slice(T*E,(T+1)*E);return _[g-1]=d.slice(g*E),_}function w(d,E,g){for(var _=0,T=0,k=0,O=0,U=0,M=g.length,R=[],B=[];_<M;++_)R[_]=B[_]=_,E[_]=g[_];for(;U<B.length;++U)_=B[U],T=d[_].L,k=d[_].R,O=d[_].C,R[_]===_&&(T!==-1&&R[T]!==T&&(R[_]=R[T]),k!==-1&&R[k]!==k&&(R[_]=R[k])),O!==-1&&(R[O]=_),T!==-1&&_!=R[_]&&(R[T]=R[_],B.lastIndexOf(T)<U&&B.push(T)),k!==-1&&_!=R[_]&&(R[k]=R[_],B.lastIndexOf(k)<U&&B.push(k));for(_=1;_<M;++_)R[_]===_&&(k!==-1&&R[k]!==k?R[_]=R[k]:T!==-1&&R[T]!==T&&(R[_]=R[T]));for(_=1;_<M;++_)if(d[_].type!==0){if(U=_,U!=R[U])do U=R[U],E[_]=E[U]+"/"+E[_];while(U!==0&&R[U]!==-1&&U!=R[U]);R[_]=-1}for(E[0]+="/",_=1;_<M;++_)d[_].type!==2&&(E[_]+="/")}function h(d,E,g){for(var _=d.start,T=d.size,k=[],O=_;g&&T>0&&O>=0;)k.push(E.slice(O*Q,O*Q+Q)),T-=Q,O=_n(g,O*4);return k.length===0?V(0):ut(k).slice(0,d.size)}function S(d,E,g,_,T){var k=ve;if(d===ve){if(E!==0)throw new Error("DIFAT chain shorter than expected")}else if(d!==-1){var O=g[d],U=(_>>>2)-1;if(!O)return;for(var M=0;M<U&&(k=_n(O,M*4))!==ve;++M)T.push(k);S(_n(O,_-4),E-1,g,_,T)}}function D(d,E,g,_,T){var k=[],O=[];T||(T=[]);var U=_-1,M=0,R=0;for(M=E;M>=0;){T[M]=!0,k[k.length]=M,O.push(d[M]);var B=g[Math.floor(M*4/_)];if(R=M*4&U,_<4+R)throw new Error("FAT boundary crossed: "+M+" 4 "+_);if(!d[B])break;M=_n(d[B],R)}return{nodes:k,data:eo([O])}}function I(d,E,g,_){var T=d.length,k=[],O=[],U=[],M=[],R=_-1,B=0,ee=0,ne=0,de=0;for(B=0;B<T;++B)if(U=[],ne=B+E,ne>=T&&(ne-=T),!O[ne]){M=[];var ie=[];for(ee=ne;ee>=0;){ie[ee]=!0,O[ee]=!0,U[U.length]=ee,M.push(d[ee]);var ce=g[Math.floor(ee*4/_)];if(de=ee*4&R,_<4+de)throw new Error("FAT boundary crossed: "+ee+" 4 "+_);if(!d[ce]||(ee=_n(d[ce],de),ie[ee]))break}k[ne]={nodes:U,data:eo([M])}}return k}function P(d,E,g,_,T,k,O,U){for(var M=0,R=_.length?2:0,B=E[d].data,ee=0,ne=0,de;ee<B.length;ee+=128){var ie=B.slice(ee,ee+128);Gt(ie,64),ne=ie.read_shift(2),de=Oa(ie,0,ne-R),_.push(de);var ce={name:de,type:ie.read_shift(1),color:ie.read_shift(1),L:ie.read_shift(4,"i"),R:ie.read_shift(4,"i"),C:ie.read_shift(4,"i"),clsid:ie.read_shift(16),state:ie.read_shift(4,"i"),start:0,size:0},Se=ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2);Se!==0&&(ce.ct=H(ie,ie.l-8));var We=ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2);We!==0&&(ce.mt=H(ie,ie.l-8)),ce.start=ie.read_shift(4,"i"),ce.size=ie.read_shift(4,"i"),ce.size<0&&ce.start<0&&(ce.size=ce.type=0,ce.start=ve,ce.name=""),ce.type===5?(M=ce.start,T>0&&M!==ve&&(E[M].name="!StreamData")):ce.size>=4096?(ce.storage="fat",E[ce.start]===void 0&&(E[ce.start]=D(g,ce.start,E.fat_addrs,E.ssz)),E[ce.start].name=ce.name,ce.content=E[ce.start].data.slice(0,ce.size)):(ce.storage="minifat",ce.size<0?ce.size=0:M!==ve&&ce.start!==ve&&E[M]&&(ce.content=h(ce,E[M].data,(E[U]||{}).data))),ce.content&&Gt(ce.content,0),k[de]=ce,O.push(ce)}}function H(d,E){return new Date((nt(d,E+4)/1e7*Math.pow(2,32)+nt(d,E)/1e7-11644473600)*1e3)}function Z(d,E){return l(),f(c.readFileSync(d),E)}function me(d,E){var g=E&&E.type;switch(g||Ie&&Buffer.isBuffer(d)&&(g="buffer"),g||"base64"){case"file":return Z(d,E);case"base64":return f(mr(Br(d)),E);case"binary":return f(mr(d),E)}return f(d,E)}function N(d,E){var g=E||{},_=g.root||"Root Entry";if(d.FullPaths||(d.FullPaths=[]),d.FileIndex||(d.FileIndex=[]),d.FullPaths.length!==d.FileIndex.length)throw new Error("inconsistent CFB structure");d.FullPaths.length===0&&(d.FullPaths[0]=_+"/",d.FileIndex[0]={name:_,type:5}),g.CLSID&&(d.FileIndex[0].clsid=g.CLSID),q(d)}function q(d){var E="Sh33tJ5";if(!Ve.find(d,"/"+E)){var g=V(4);g[0]=55,g[1]=g[3]=50,g[2]=54,d.FileIndex.push({name:E,type:2,content:g,size:4,L:69,R:69,C:69}),d.FullPaths.push(d.FullPaths[0]+E),W(d)}}function W(d,E){N(d);for(var g=!1,_=!1,T=d.FullPaths.length-1;T>=0;--T){var k=d.FileIndex[T];switch(k.type){case 0:_?g=!0:(d.FileIndex.pop(),d.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(k.R*k.L*k.C)&&(g=!0),k.R>-1&&k.L>-1&&k.R==k.L&&(g=!0);break;default:g=!0;break}}if(!(!g&&!E)){var O=new Date(1987,1,19),U=0,M=Object.create?Object.create(null):{},R=[];for(T=0;T<d.FullPaths.length;++T)M[d.FullPaths[T]]=!0,d.FileIndex[T].type!==0&&R.push([d.FullPaths[T],d.FileIndex[T]]);for(T=0;T<R.length;++T){var B=n(R[T][0]);_=M[B],_||(R.push([B,{name:i(B).replace("/",""),type:1,clsid:et,ct:O,mt:O,content:null}]),M[B]=!0)}for(R.sort(function(de,ie){return e(de[0],ie[0])}),d.FullPaths=[],d.FileIndex=[],T=0;T<R.length;++T)d.FullPaths[T]=R[T][0],d.FileIndex[T]=R[T][1];for(T=0;T<R.length;++T){var ee=d.FileIndex[T],ne=d.FullPaths[T];if(ee.name=i(ne).replace("/",""),ee.L=ee.R=ee.C=-(ee.color=1),ee.size=ee.content?ee.content.length:0,ee.start=0,ee.clsid=ee.clsid||et,T===0)ee.C=R.length>1?1:-1,ee.size=0,ee.type=5;else if(ne.slice(-1)=="/"){for(U=T+1;U<R.length&&n(d.FullPaths[U])!=ne;++U);for(ee.C=U>=R.length?-1:U,U=T+1;U<R.length&&n(d.FullPaths[U])!=n(ne);++U);ee.R=U>=R.length?-1:U,ee.type=1}else n(d.FullPaths[T+1]||"")==n(ne)&&(ee.R=T+1),ee.type=2}}}function X(d,E){var g=E||{};if(g.fileType=="mad")return hl(d,g);switch(W(d),g.fileType){case"zip":return al(d,g)}var _=function(de){for(var ie=0,ce=0,Se=0;Se<de.FileIndex.length;++Se){var We=de.FileIndex[Se];if(We.content){var zt=We.content.length;zt>0&&(zt<4096?ie+=zt+63>>6:ce+=zt+511>>9)}}for(var qe=de.FullPaths.length+3>>2,Wt=ie+7>>3,gi=ie+127>>7,_i=Wt+ce+qe+gi,dn=_i+127>>7,Ga=dn<=109?0:Math.ceil((dn-109)/127);_i+dn+Ga+127>>7>dn;)Ga=++dn<=109?0:Math.ceil((dn-109)/127);var Dr=[1,Ga,dn,gi,qe,ce,ie,0];return de.FileIndex[0].size=ie<<6,Dr[7]=(de.FileIndex[0].start=Dr[0]+Dr[1]+Dr[2]+Dr[3]+Dr[4]+Dr[5])+(Dr[6]+7>>3),Dr}(d),T=V(_[7]<<9),k=0,O=0;{for(k=0;k<8;++k)T.write_shift(1,ge[k]);for(k=0;k<8;++k)T.write_shift(2,0);for(T.write_shift(2,62),T.write_shift(2,3),T.write_shift(2,65534),T.write_shift(2,9),T.write_shift(2,6),k=0;k<3;++k)T.write_shift(2,0);for(T.write_shift(4,0),T.write_shift(4,_[2]),T.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),T.write_shift(4,0),T.write_shift(4,4096),T.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:ve),T.write_shift(4,_[3]),T.write_shift(-4,_[1]?_[0]-1:ve),T.write_shift(4,_[1]),k=0;k<109;++k)T.write_shift(-4,k<_[2]?_[1]+k:-1)}if(_[1])for(O=0;O<_[1];++O){for(;k<236+O*127;++k)T.write_shift(-4,k<_[2]?_[1]+k:-1);T.write_shift(-4,O===_[1]-1?ve:O+1)}var U=function(de){for(O+=de;k<O-1;++k)T.write_shift(-4,k+1);de&&(++k,T.write_shift(-4,ve))};for(O=k=0,O+=_[1];k<O;++k)T.write_shift(-4,tt.DIFSECT);for(O+=_[2];k<O;++k)T.write_shift(-4,tt.FATSECT);U(_[3]),U(_[4]);for(var M=0,R=0,B=d.FileIndex[0];M<d.FileIndex.length;++M)B=d.FileIndex[M],B.content&&(R=B.content.length,!(R<4096)&&(B.start=O,U(R+511>>9)));for(U(_[6]+7>>3);T.l&511;)T.write_shift(-4,tt.ENDOFCHAIN);for(O=k=0,M=0;M<d.FileIndex.length;++M)B=d.FileIndex[M],B.content&&(R=B.content.length,!(!R||R>=4096)&&(B.start=O,U(R+63>>6)));for(;T.l&511;)T.write_shift(-4,tt.ENDOFCHAIN);for(k=0;k<_[4]<<2;++k){var ee=d.FullPaths[k];if(!ee||ee.length===0){for(M=0;M<17;++M)T.write_shift(4,0);for(M=0;M<3;++M)T.write_shift(4,-1);for(M=0;M<12;++M)T.write_shift(4,0);continue}B=d.FileIndex[k],k===0&&(B.start=B.size?B.start-1:ve);var ne=k===0&&g.root||B.name;if(R=2*(ne.length+1),T.write_shift(64,ne,"utf16le"),T.write_shift(2,R),T.write_shift(1,B.type),T.write_shift(1,B.color),T.write_shift(-4,B.L),T.write_shift(-4,B.R),T.write_shift(-4,B.C),B.clsid)T.write_shift(16,B.clsid,"hex");else for(M=0;M<4;++M)T.write_shift(4,0);T.write_shift(4,B.state||0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,B.start),T.write_shift(4,B.size),T.write_shift(4,0)}for(k=1;k<d.FileIndex.length;++k)if(B=d.FileIndex[k],B.size>=4096)if(T.l=B.start+1<<9,Ie&&Buffer.isBuffer(B.content))B.content.copy(T,T.l,0,B.size),T.l+=B.size+511&-512;else{for(M=0;M<B.size;++M)T.write_shift(1,B.content[M]);for(;M&511;++M)T.write_shift(1,0)}for(k=1;k<d.FileIndex.length;++k)if(B=d.FileIndex[k],B.size>0&&B.size<4096)if(Ie&&Buffer.isBuffer(B.content))B.content.copy(T,T.l,0,B.size),T.l+=B.size+63&-64;else{for(M=0;M<B.size;++M)T.write_shift(1,B.content[M]);for(;M&63;++M)T.write_shift(1,0)}if(Ie)T.l=T.length;else for(;T.l<T.length;)T.write_shift(1,0);return T}function J(d,E){var g=d.FullPaths.map(function(M){return M.toUpperCase()}),_=g.map(function(M){var R=M.split("/");return R[R.length-(M.slice(-1)=="/"?2:1)]}),T=!1;E.charCodeAt(0)===47?(T=!0,E=g[0].slice(0,-1)+E):T=E.indexOf("/")!==-1;var k=E.toUpperCase(),O=T===!0?g.indexOf(k):_.indexOf(k);if(O!==-1)return d.FileIndex[O];var U=!k.match(la);for(k=k.replace(si,""),U&&(k=k.replace(la,"!")),O=0;O<g.length;++O)if((U?g[O].replace(la,"!"):g[O]).replace(si,"")==k||(U?_[O].replace(la,"!"):_[O]).replace(si,"")==k)return d.FileIndex[O];return null}var Q=64,ve=-2,Ne="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],et="00000000000000000000000000000000",tt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ve,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:et,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function At(d,E,g){l();var _=X(d,g);c.writeFileSync(E,_)}function wt(d){for(var E=new Array(d.length),g=0;g<d.length;++g)E[g]=String.fromCharCode(d[g]);return E.join("")}function ot(d,E){var g=X(d,E);switch(E&&E.type||"buffer"){case"file":return l(),c.writeFileSync(E.filename,g),g;case"binary":return typeof g=="string"?g:wt(g);case"base64":return Vi(typeof g=="string"?g:wt(g));case"buffer":if(Ie)return Buffer.isBuffer(g)?g:Ur(g);case"array":return typeof g=="string"?mr(g):g}return g}var bt;function A(d){try{var E=d.InflateRaw,g=new E;if(g._processChunk(new Uint8Array([3,0]),g._finishFlushFlag),g.bytesRead)bt=d;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function G(d,E){if(!bt)return js(d,E);var g=bt.InflateRaw,_=new g,T=_._processChunk(d.slice(d.l),_._finishFlushFlag);return d.l+=_.bytesRead,T}function z(d){return bt?bt.deflateRawSync(d):Vs(d)}var b=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _e(d){var E=(d<<1|d<<11)&139536|(d<<5|d<<15)&558144;return(E>>16|E>>8|E)&255}for(var he=typeof Uint8Array<"u",ae=he?new Uint8Array(256):[],Me=0;Me<256;++Me)ae[Me]=_e(Me);function ye(d,E){var g=ae[d&255];return E<=8?g>>>8-E:(g=g<<8|ae[d>>8&255],E<=16?g>>>16-E:(g=g<<8|ae[d>>16&255],g>>>24-E))}function ct(d,E){var g=E&7,_=E>>>3;return(d[_]|(g<=6?0:d[_+1]<<8))>>>g&3}function Ae(d,E){var g=E&7,_=E>>>3;return(d[_]|(g<=5?0:d[_+1]<<8))>>>g&7}function lr(d,E){var g=E&7,_=E>>>3;return(d[_]|(g<=4?0:d[_+1]<<8))>>>g&15}function Xe(d,E){var g=E&7,_=E>>>3;return(d[_]|(g<=3?0:d[_+1]<<8))>>>g&31}function pe(d,E){var g=E&7,_=E>>>3;return(d[_]|(g<=1?0:d[_+1]<<8))>>>g&127}function $t(d,E,g){var _=E&7,T=E>>>3,k=(1<<g)-1,O=d[T]>>>_;return g<8-_||(O|=d[T+1]<<8-_,g<16-_)||(O|=d[T+2]<<16-_,g<24-_)||(O|=d[T+3]<<24-_),O&k}function zr(d,E,g){var _=E&7,T=E>>>3;return _<=5?d[T]|=(g&7)<<_:(d[T]|=g<<_&255,d[T+1]=(g&7)>>8-_),E+3}function un(d,E,g){var _=E&7,T=E>>>3;return g=(g&1)<<_,d[T]|=g,E+1}function zn(d,E,g){var _=E&7,T=E>>>3;return g<<=_,d[T]|=g&255,g>>>=8,d[T+1]=g,E+8}function Bs(d,E,g){var _=E&7,T=E>>>3;return g<<=_,d[T]|=g&255,g>>>=8,d[T+1]=g&255,d[T+2]=g>>>8,E+16}function Va(d,E){var g=d.length,_=2*g>E?2*g:E+5,T=0;if(g>=E)return d;if(Ie){var k=B0(_);if(d.copy)d.copy(k);else for(;T<d.length;++T)k[T]=d[T];return k}else if(he){var O=new Uint8Array(_);if(O.set)O.set(d);else for(;T<g;++T)O[T]=d[T];return O}return d.length=_,d}function vr(d){for(var E=new Array(d),g=0;g<d;++g)E[g]=0;return E}function Yi(d,E,g){var _=1,T=0,k=0,O=0,U=0,M=d.length,R=he?new Uint16Array(32):vr(32);for(k=0;k<32;++k)R[k]=0;for(k=M;k<g;++k)d[k]=0;M=d.length;var B=he?new Uint16Array(M):vr(M);for(k=0;k<M;++k)R[T=d[k]]++,_<T&&(_=T),B[k]=0;for(R[0]=0,k=1;k<=_;++k)R[k+16]=U=U+R[k-1]<<1;for(k=0;k<M;++k)U=d[k],U!=0&&(B[k]=R[U+16]++);var ee=0;for(k=0;k<M;++k)if(ee=d[k],ee!=0)for(U=ye(B[k],_)>>_-ee,O=(1<<_+4-ee)-1;O>=0;--O)E[U|O<<ee]=ee&15|k<<4;return _}var Ua=he?new Uint16Array(512):vr(512),Wa=he?new Uint16Array(32):vr(32);if(!he){for(var hn=0;hn<512;++hn)Ua[hn]=0;for(hn=0;hn<32;++hn)Wa[hn]=0}(function(){for(var d=[],E=0;E<32;E++)d.push(5);Yi(d,Wa,32);var g=[];for(E=0;E<=143;E++)g.push(8);for(;E<=255;E++)g.push(9);for(;E<=279;E++)g.push(7);for(;E<=287;E++)g.push(8);Yi(g,Ua,288)})();var tl=function(){for(var E=he?new Uint8Array(32768):[],g=0,_=0;g<xe.length-1;++g)for(;_<xe[g+1];++_)E[_]=g;for(;_<32768;++_)E[_]=29;var T=he?new Uint8Array(259):[];for(g=0,_=0;g<Y.length-1;++g)for(;_<Y[g+1];++_)T[_]=g;function k(U,M){for(var R=0;R<U.length;){var B=Math.min(65535,U.length-R),ee=R+B==U.length;for(M.write_shift(1,+ee),M.write_shift(2,B),M.write_shift(2,~B&65535);B-- >0;)M[M.l++]=U[R++]}return M.l}function O(U,M){for(var R=0,B=0,ee=he?new Uint16Array(32768):[];B<U.length;){var ne=Math.min(65535,U.length-B);if(ne<10){for(R=zr(M,R,+(B+ne==U.length)),R&7&&(R+=8-(R&7)),M.l=R/8|0,M.write_shift(2,ne),M.write_shift(2,~ne&65535);ne-- >0;)M[M.l++]=U[B++];R=M.l*8;continue}R=zr(M,R,+(B+ne==U.length)+2);for(var de=0;ne-- >0;){var ie=U[B];de=(de<<5^ie)&32767;var ce=-1,Se=0;if((ce=ee[de])&&(ce|=B&-32768,ce>B&&(ce-=32768),ce<B))for(;U[ce+Se]==U[B+Se]&&Se<250;)++Se;if(Se>2){ie=T[Se],ie<=22?R=zn(M,R,ae[ie+1]>>1)-1:(zn(M,R,3),R+=5,zn(M,R,ae[ie-23]>>5),R+=3);var We=ie<8?0:ie-4>>2;We>0&&(Bs(M,R,Se-Y[ie]),R+=We),ie=E[B-ce],R=zn(M,R,ae[ie]>>3),R-=3;var zt=ie<4?0:ie-2>>1;zt>0&&(Bs(M,R,B-ce-xe[ie]),R+=zt);for(var qe=0;qe<Se;++qe)ee[de]=B&32767,de=(de<<5^U[B])&32767,++B;ne-=Se-1}else ie<=143?ie=ie+48:R=un(M,R,1),R=zn(M,R,ae[ie]),ee[de]=B&32767,++B}R=zn(M,R,0)-1}return M.l=(R+7)/8|0,M.l}return function(M,R){return M.length<8?k(M,R):O(M,R)}}();function Vs(d){var E=V(50+Math.floor(d.length*1.1)),g=tl(d,E);return E.slice(0,g)}var Us=he?new Uint16Array(32768):vr(32768),Ws=he?new Uint16Array(32768):vr(32768),Hs=he?new Uint16Array(128):vr(128),Gs=1,Xs=1;function rl(d,E){var g=Xe(d,E)+257;E+=5;var _=Xe(d,E)+1;E+=5;var T=lr(d,E)+4;E+=4;for(var k=0,O=he?new Uint8Array(19):vr(19),U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=1,R=he?new Uint8Array(8):vr(8),B=he?new Uint8Array(8):vr(8),ee=O.length,ne=0;ne<T;++ne)O[b[ne]]=k=Ae(d,E),M<k&&(M=k),R[k]++,E+=3;var de=0;for(R[0]=0,ne=1;ne<=M;++ne)B[ne]=de=de+R[ne-1]<<1;for(ne=0;ne<ee;++ne)(de=O[ne])!=0&&(U[ne]=B[de]++);var ie=0;for(ne=0;ne<ee;++ne)if(ie=O[ne],ie!=0){de=ae[U[ne]]>>8-ie;for(var ce=(1<<7-ie)-1;ce>=0;--ce)Hs[de|ce<<ie]=ie&7|ne<<3}var Se=[];for(M=1;Se.length<g+_;)switch(de=Hs[pe(d,E)],E+=de&7,de>>>=3){case 16:for(k=3+ct(d,E),E+=2,de=Se[Se.length-1];k-- >0;)Se.push(de);break;case 17:for(k=3+Ae(d,E),E+=3;k-- >0;)Se.push(0);break;case 18:for(k=11+pe(d,E),E+=7;k-- >0;)Se.push(0);break;default:Se.push(de),M<de&&(M=de);break}var We=Se.slice(0,g),zt=Se.slice(g);for(ne=g;ne<286;++ne)We[ne]=0;for(ne=_;ne<30;++ne)zt[ne]=0;return Gs=Yi(We,Us,286),Xs=Yi(zt,Ws,30),E}function nl(d,E){if(d[0]==3&&!(d[1]&3))return[En(E),2];for(var g=0,_=0,T=B0(E||1<<18),k=0,O=T.length>>>0,U=0,M=0;!(_&1);){if(_=Ae(d,g),g+=3,_>>>1)_>>1==1?(U=9,M=5):(g=rl(d,g),U=Gs,M=Xs);else{g&7&&(g+=8-(g&7));var R=d[g>>>3]|d[(g>>>3)+1]<<8;if(g+=32,R>0)for(!E&&O<k+R&&(T=Va(T,k+R),O=T.length);R-- >0;)T[k++]=d[g>>>3],g+=8;continue}for(;;){!E&&O<k+32767&&(T=Va(T,k+32767),O=T.length);var B=$t(d,g,U),ee=_>>>1==1?Ua[B]:Us[B];if(g+=ee&15,ee>>>=4,!(ee>>>8&255))T[k++]=ee;else{if(ee==256)break;ee-=257;var ne=ee<8?0:ee-4>>2;ne>5&&(ne=0);var de=k+Y[ee];ne>0&&(de+=$t(d,g,ne),g+=ne),B=$t(d,g,M),ee=_>>>1==1?Wa[B]:Ws[B],g+=ee&15,ee>>>=4;var ie=ee<4?0:ee-2>>1,ce=xe[ee];for(ie>0&&(ce+=$t(d,g,ie),g+=ie),!E&&O<de&&(T=Va(T,de+100),O=T.length);k<de;)T[k]=T[k-ce],++k}}}return E?[T,g+7>>>3]:[T.slice(0,k),g+7>>>3]}function js(d,E){var g=d.slice(d.l||0),_=nl(g,E);return d.l+=_[1],_[0]}function $s(d,E){if(d)typeof console<"u"&&console.error(E);else throw new Error(E)}function qs(d,E){var g=d;Gt(g,0);var _=[],T=[],k={FileIndex:_,FullPaths:T};N(k,{root:E.root});for(var O=g.length-4;(g[O]!=80||g[O+1]!=75||g[O+2]!=5||g[O+3]!=6)&&O>=0;)--O;g.l=O+4,g.l+=4;var U=g.read_shift(2);g.l+=6;var M=g.read_shift(4);for(g.l=M,O=0;O<U;++O){g.l+=20;var R=g.read_shift(4),B=g.read_shift(4),ee=g.read_shift(2),ne=g.read_shift(2),de=g.read_shift(2);g.l+=8;var ie=g.read_shift(4),ce=o(g.slice(g.l+ee,g.l+ee+ne));g.l+=ee+ne+de;var Se=g.l;g.l=ie+4,il(g,R,B,k,ce),g.l=Se}return k}function il(d,E,g,_,T){d.l+=2;var k=d.read_shift(2),O=d.read_shift(2),U=s(d);if(k&8257)throw new Error("Unsupported ZIP encryption");for(var M=d.read_shift(4),R=d.read_shift(4),B=d.read_shift(4),ee=d.read_shift(2),ne=d.read_shift(2),de="",ie=0;ie<ee;++ie)de+=String.fromCharCode(d[d.l++]);if(ne){var ce=o(d.slice(d.l,d.l+ne));(ce[21589]||{}).mt&&(U=ce[21589].mt),((T||{})[21589]||{}).mt&&(U=T[21589].mt)}d.l+=ne;var Se=d.slice(d.l,d.l+R);switch(O){case 8:Se=G(d,B);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+O)}var We=!1;k&8&&(M=d.read_shift(4),M==134695760&&(M=d.read_shift(4),We=!0),R=d.read_shift(4),B=d.read_shift(4)),R!=E&&$s(We,"Bad compressed size: "+E+" != "+R),B!=g&&$s(We,"Bad uncompressed size: "+g+" != "+B),Ha(_,de,Se,{unsafe:!0,mt:U})}function al(d,E){var g=E||{},_=[],T=[],k=V(1),O=g.compression?8:0,U=0,M=!1;M&&(U|=8);var R=0,B=0,ee=0,ne=0,de=d.FullPaths[0],ie=de,ce=d.FileIndex[0],Se=[],We=0;for(R=1;R<d.FullPaths.length;++R)if(ie=d.FullPaths[R].slice(de.length),ce=d.FileIndex[R],!(!ce.size||!ce.content||ie=="Sh33tJ5")){var zt=ee,qe=V(ie.length);for(B=0;B<ie.length;++B)qe.write_shift(1,ie.charCodeAt(B)&127);qe=qe.slice(0,qe.l),Se[ne]=Au.buf(ce.content,0);var Wt=ce.content;O==8&&(Wt=z(Wt)),k=V(30),k.write_shift(4,67324752),k.write_shift(2,20),k.write_shift(2,U),k.write_shift(2,O),ce.mt?a(k,ce.mt):k.write_shift(4,0),k.write_shift(-4,U&8?0:Se[ne]),k.write_shift(4,U&8?0:Wt.length),k.write_shift(4,U&8?0:ce.content.length),k.write_shift(2,qe.length),k.write_shift(2,0),ee+=k.length,_.push(k),ee+=qe.length,_.push(qe),ee+=Wt.length,_.push(Wt),U&8&&(k=V(12),k.write_shift(-4,Se[ne]),k.write_shift(4,Wt.length),k.write_shift(4,ce.content.length),ee+=k.l,_.push(k)),k=V(46),k.write_shift(4,33639248),k.write_shift(2,0),k.write_shift(2,20),k.write_shift(2,U),k.write_shift(2,O),k.write_shift(4,0),k.write_shift(-4,Se[ne]),k.write_shift(4,Wt.length),k.write_shift(4,ce.content.length),k.write_shift(2,qe.length),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(4,0),k.write_shift(4,zt),We+=k.l,T.push(k),We+=qe.length,T.push(qe),++ne}return k=V(22),k.write_shift(4,101010256),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(2,ne),k.write_shift(2,ne),k.write_shift(4,We),k.write_shift(4,ee),k.write_shift(2,0),ut([ut(_),ut(T),k])}var Ji={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function sl(d,E){if(d.ctype)return d.ctype;var g=d.name||"",_=g.match(/\.([^\.]+)$/);return _&&Ji[_[1]]||E&&(_=(g=E).match(/[\.\\]([^\.\\])+$/),_&&Ji[_[1]])?Ji[_[1]]:"application/octet-stream"}function ol(d){for(var E=Vi(d),g=[],_=0;_<E.length;_+=76)g.push(E.slice(_,_+76));return g.join(`\r
`)+`\r
`}function cl(d){var E=d.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(R){var B=R.charCodeAt(0).toString(16).toUpperCase();return"="+(B.length==1?"0"+B:B)});E=E.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),E.charAt(0)==`
`&&(E="=0D"+E.slice(1)),E=E.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var g=[],_=E.split(`\r
`),T=0;T<_.length;++T){var k=_[T];if(k.length==0){g.push("");continue}for(var O=0;O<k.length;){var U=76,M=k.slice(O,O+U);M.charAt(U-1)=="="?U--:M.charAt(U-2)=="="?U-=2:M.charAt(U-3)=="="&&(U-=3),M=k.slice(O,O+U),O+=U,O<k.length&&(M+="="),g.push(M)}}return g.join(`\r
`)}function ll(d){for(var E=[],g=0;g<d.length;++g){for(var _=d[g];g<=d.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+d[++g];E.push(_)}for(var T=0;T<E.length;++T)E[T]=E[T].replace(/[=][0-9A-Fa-f]{2}/g,function(k){return String.fromCharCode(parseInt(k.slice(1),16))});return mr(E.join(`\r
`))}function fl(d,E,g){for(var _="",T="",k="",O,U=0;U<10;++U){var M=E[U];if(!M||M.match(/^\s*$/))break;var R=M.match(/^(.*?):\s*([^\s].*)$/);if(R)switch(R[1].toLowerCase()){case"content-location":_=R[2].trim();break;case"content-type":k=R[2].trim();break;case"content-transfer-encoding":T=R[2].trim();break}}switch(++U,T.toLowerCase()){case"base64":O=mr(Br(E.slice(U).join("")));break;case"quoted-printable":O=ll(E.slice(U));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+T)}var B=Ha(d,_.slice(g.length),O,{unsafe:!0});k&&(B.ctype=k)}function ul(d,E){if(wt(d.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var g=E&&E.root||"",_=(Ie&&Buffer.isBuffer(d)?d.toString("binary"):wt(d)).split(`\r
`),T=0,k="";for(T=0;T<_.length;++T)if(k=_[T],!!/^Content-Location:/i.test(k)&&(k=k.slice(k.indexOf("file")),g||(g=k.slice(0,k.lastIndexOf("/")+1)),k.slice(0,g.length)!=g))for(;g.length>0&&(g=g.slice(0,g.length-1),g=g.slice(0,g.lastIndexOf("/")+1),k.slice(0,g.length)!=g););var O=(_[1]||"").match(/boundary="(.*?)"/);if(!O)throw new Error("MAD cannot find boundary");var U="--"+(O[1]||""),M=[],R=[],B={FileIndex:M,FullPaths:R};N(B);var ee,ne=0;for(T=0;T<_.length;++T){var de=_[T];de!==U&&de!==U+"--"||(ne++&&fl(B,_.slice(ee,T),g),ee=T)}return B}function hl(d,E){var g=E||{},_=g.boundary||"SheetJS";_="------="+_;for(var T=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],k=d.FullPaths[0],O=k,U=d.FileIndex[0],M=1;M<d.FullPaths.length;++M)if(O=d.FullPaths[M].slice(k.length),U=d.FileIndex[M],!(!U.size||!U.content||O=="Sh33tJ5")){O=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Se){return"_x"+Se.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Se){return"_u"+Se.charCodeAt(0).toString(16)+"_"});for(var R=U.content,B=Ie&&Buffer.isBuffer(R)?R.toString("binary"):wt(R),ee=0,ne=Math.min(1024,B.length),de=0,ie=0;ie<=ne;++ie)(de=B.charCodeAt(ie))>=32&&de<128&&++ee;var ce=ee>=ne*4/5;T.push(_),T.push("Content-Location: "+(g.root||"file:///C:/SheetJS/")+O),T.push("Content-Transfer-Encoding: "+(ce?"quoted-printable":"base64")),T.push("Content-Type: "+sl(U,O)),T.push(""),T.push(ce?cl(B):ol(B))}return T.push(_+`--\r
`),T.join(`\r
`)}function dl(d){var E={};return N(E,d),E}function Ha(d,E,g,_){var T=_&&_.unsafe;T||N(d);var k=!T&&Ve.find(d,E);if(!k){var O=d.FullPaths[0];E.slice(0,O.length)==O?O=E:(O.slice(-1)!="/"&&(O+="/"),O=(O+E).replace("//","/")),k={name:i(E),type:2},d.FileIndex.push(k),d.FullPaths.push(O),T||Ve.utils.cfb_gc(d)}return k.content=g,k.size=g?g.length:0,_&&(_.CLSID&&(k.clsid=_.CLSID),_.mt&&(k.mt=_.mt),_.ct&&(k.ct=_.ct)),k}function ml(d,E){N(d);var g=Ve.find(d,E);if(g){for(var _=0;_<d.FileIndex.length;++_)if(d.FileIndex[_]==g)return d.FileIndex.splice(_,1),d.FullPaths.splice(_,1),!0}return!1}function pl(d,E,g){N(d);var _=Ve.find(d,E);if(_){for(var T=0;T<d.FileIndex.length;++T)if(d.FileIndex[T]==_)return d.FileIndex[T].name=i(g),d.FullPaths[T]=g,!0}return!1}function xl(d){W(d,!0)}return r.find=J,r.read=me,r.parse=f,r.write=ot,r.writeFile=At,r.utils={cfb_new:dl,cfb_add:Ha,cfb_del:ml,cfb_mov:pl,cfb_gc:xl,ReadShift:Pi,CheckField:Jo,prep_blob:Gt,bconcat:ut,use_zlib:A,_deflateRaw:Vs,_inflateRaw:js,consts:tt},r}(),ua;function bu(t){return typeof t=="string"?za(t):Array.isArray(t)?tu(t):t}function ji(t,r,e){if(typeof ua<"u"&&ua.writeFileSync)return e?ua.writeFileSync(t,r,e):ua.writeFileSync(t,r);if(typeof Deno<"u"){if(e&&typeof r=="string")switch(e){case"utf8":r=new TextEncoder(e).encode(r);break;case"binary":r=za(r);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,r)}var n=e=="utf8"?Or(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([bu(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=t,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(r)&&(r=Xi(r)),o.write(r),o.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function mt(t){for(var r=Object.keys(t),e=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(t,r[n])&&e.push(r[n]);return e}function $0(t,r){for(var e=[],n=mt(t),i=0;i!==n.length;++i)e[t[n[i]][r]]==null&&(e[t[n[i]][r]]=n[i]);return e}function hs(t){for(var r=[],e=mt(t),n=0;n!==e.length;++n)r[t[e[n]]]=e[n];return r}function Na(t){for(var r=[],e=mt(t),n=0;n!==e.length;++n)r[t[e[n]]]=parseInt(e[n],10);return r}function zu(t){for(var r=[],e=mt(t),n=0;n!==e.length;++n)r[t[e[n]]]==null&&(r[t[e[n]]]=[]),r[t[e[n]]].push(e[n]);return r}var Sa=new Date(1899,11,30,0,0,0);function Vt(t,r){var e=t.getTime();r&&(e-=1462*24*60*60*1e3);var n=Sa.getTime()+(t.getTimezoneOffset()-Sa.getTimezoneOffset())*6e4;return(e-n)/(24*60*60*1e3)}var Bo=new Date,Du=Sa.getTime()+(Bo.getTimezoneOffset()-Sa.getTimezoneOffset())*6e4,q0=Bo.getTimezoneOffset();function Vo(t){var r=new Date;return r.setTime(t*24*60*60*1e3+Du),r.getTimezoneOffset()!==q0&&r.setTime(r.getTime()+(r.getTimezoneOffset()-q0)*6e4),r}var K0=new Date("2017-02-19T19:06:09.000Z"),Uo=isNaN(K0.getFullYear())?new Date("2/19/17"):K0,Iu=Uo.getFullYear()==2017;function Ft(t,r){var e=new Date(t);if(Iu)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(Uo.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return t.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Pa(t,r){if(Ie&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return Or(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Or(eu(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return Or(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Or(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return e[a]||a})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Ut(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Ut(t[e]));return r}function je(t,r){for(var e="";e.length<r;)e+=t;return e}function Rr(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return e=-e,a}),!isNaN(r=Number(n)))?r/e:r}var Nu=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ui(t){var r=new Date(t),e=new Date(NaN),n=r.getYear(),i=r.getMonth(),a=r.getDate();if(isNaN(a))return e;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&Nu.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return n<0||n>8099?e:(i>0||a>1)&&n!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}function Ee(t,r,e){if(t.FullPaths){if(typeof e=="string"){var n;return Ie?n=Ur(e):n=ru(e),Ve.utils.cfb_add(t,r,n)}Ve.utils.cfb_add(t,r,e)}else t.file(r,e)}function ds(){return Ve.utils.cfb_new()}var Ze=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var Pu={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ms=hs(Pu);var ps=/[&<>'"]/g,Ou=/[\u0000-\u0008\u000b-\u001f]/g;function Le(t){var r=t+"";return r.replace(ps,function(e){return ms[e]}).replace(Ou,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Y0(t){return Le(t).replace(/ /g,"_x0020_")}var Wo=/[\u0000-\u001f]/g;function Lu(t){var r=t+"";return r.replace(ps,function(e){return ms[e]}).replace(/\n/g,"<br/>").replace(Wo,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Ru(t){var r=t+"";return r.replace(ps,function(e){return ms[e]}).replace(Wo,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function Mu(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Bu(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Qa(t){for(var r="",e=0,n=0,i=0,a=0,s=0,o=0;e<t.length;){if(n=t.charCodeAt(e++),n<128){r+=String.fromCharCode(n);continue}if(i=t.charCodeAt(e++),n>191&&n<224){s=(n&31)<<6,s|=i&63,r+=String.fromCharCode(s);continue}if(a=t.charCodeAt(e++),n<240){r+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=t.charCodeAt(e++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function J0(t){var r=En(2*t.length),e,n,i=1,a=0,s=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?e=o:o<224?(e=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(e=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,e=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(r[a++]=s&255,r[a++]=s>>>8,s=0),r[a++]=e%256,r[a++]=e>>>8;return r.slice(0,a).toString("ucs2")}function Z0(t){return Ur(t,"binary").toString("utf8")}var ha="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Ni=Ie&&(Z0(ha)==Qa(ha)&&Z0||J0(ha)==Qa(ha)&&J0)||Qa,Or=Ie?function(t){return Ur(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,n=0,i=0;e<t.length;)switch(n=t.charCodeAt(e++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(e++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")};var Vu=function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}();var Ho=/(^\s|\s$|\n)/;function ht(t,r){return"<"+t+(r.match(Ho)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function Wi(t){return mt(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function te(t,r,e){return"<"+t+(e!=null?Wi(e):"")+(r!=null?(r.match(Ho)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function os(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(r)throw e}return""}function Uu(t,r){switch(typeof t){case"string":var e=te("vt:lpwstr",Le(t));return r&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return te((t|0)==t?"vt:i4":"vt:r8",Le(String(t)));case"boolean":return te("vt:bool",t?"true":"false")}if(t instanceof Date)return te("vt:filetime",os(t));throw new Error("Unable to serialize "+t)}var it={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},di=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Xt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Wu(t,r){for(var e=1-2*(t[r+7]>>>7),n=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),i=t[r+6]&15,a=5;a>=0;--a)i=i*256+t[r+a];return n==2047?i==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),e*Math.pow(2,n-52)*i)}function Hu(t,r,e){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,a=0,s=n?-r:r;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(r)?26985:0);for(var o=0;o<=5;++o,a/=256)t[e+o]=a&255;t[e+6]=(i&15)<<4|a&15,t[e+7]=i>>4|n}var Q0=function(t){for(var r=[],e=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,a=t[0][n].length;i<a;i+=e)r.push.apply(r,t[0][n].slice(i,i+e));return r},eo=Ie?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:Ur(r)})):Q0(t)}:Q0,to=function(t,r,e){for(var n=[],i=r;i<e;i+=2)n.push(String.fromCharCode(Ii(t,i)));return n.join("").replace(si,"")},Oa=Ie?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(si,""):to(t,r,e)}:to,ro=function(t,r,e){for(var n=[],i=r;i<r+e;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Go=Ie?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):ro(t,r,e)}:ro,no=function(t,r,e){for(var n=[],i=r;i<e;i++)n.push(String.fromCharCode(ii(t,i)));return n.join("")},mi=Ie?function(r,e,n){return Buffer.isBuffer(r)?r.toString("utf8",e,n):no(r,e,n)}:no,Xo=function(t,r){var e=nt(t,r);return e>0?mi(t,r+4,r+4+e-1):""},xs=Xo,jo=function(t,r){var e=nt(t,r);return e>0?mi(t,r+4,r+4+e-1):""},vs=jo,$o=function(t,r){var e=2*nt(t,r);return e>0?mi(t,r+4,r+4+e-1):""},gs=$o,qo=function(r,e){var n=nt(r,e);return n>0?Oa(r,e+4,e+4+n):""},_s=qo,Ko=function(t,r){var e=nt(t,r);return e>0?mi(t,r+4,r+4+e):""},Ss=Ko,Yo=function(t,r){return Wu(t,r)},wa=Yo,ws=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ie&&(xs=function(r,e){if(!Buffer.isBuffer(r))return Xo(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},vs=function(r,e){if(!Buffer.isBuffer(r))return jo(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},gs=function(r,e){if(!Buffer.isBuffer(r))return $o(r,e);var n=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n-1)},_s=function(r,e){if(!Buffer.isBuffer(r))return qo(r,e);var n=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n)},Ss=function(r,e){if(!Buffer.isBuffer(r))return Ko(r,e);var n=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+n)},wa=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):Yo(r,e)},ws=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});function Gu(){Oa=function(t,r,e){return Ue.utils.decode(1200,t.slice(r,e)).replace(si,"")},mi=function(t,r,e){return Ue.utils.decode(65001,t.slice(r,e))},xs=function(t,r){var e=nt(t,r);return e>0?Ue.utils.decode(ui,t.slice(r+4,r+4+e-1)):""},vs=function(t,r){var e=nt(t,r);return e>0?Ue.utils.decode(Sn,t.slice(r+4,r+4+e-1)):""},gs=function(t,r){var e=2*nt(t,r);return e>0?Ue.utils.decode(1200,t.slice(r+4,r+4+e-1)):""},_s=function(t,r){var e=nt(t,r);return e>0?Ue.utils.decode(1200,t.slice(r+4,r+4+e)):""},Ss=function(t,r){var e=nt(t,r);return e>0?Ue.utils.decode(65001,t.slice(r+4,r+4+e)):""}}typeof Ue<"u"&&Gu();var ii=function(t,r){return t[r]},Ii=function(t,r){return t[r+1]*256+t[r]},Xu=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},nt=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},_n=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},ju=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function Pi(t,r){var e="",n,i,a=[],s,o,c,l;switch(r){case"dbcs":if(l=this.l,Ie&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)e+=String.fromCharCode(Ii(this,l)),l+=2;t*=2;break;case"utf8":e=mi(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Oa(this,this.l,this.l+t);break;case"wstr":if(typeof Ue<"u")e=Ue.utils.decode(Sn,this.slice(this.l,this.l+2*t));else return Pi.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":e=xs(this,this.l),t=4+nt(this,this.l);break;case"lpstr-cp":e=vs(this,this.l),t=4+nt(this,this.l);break;case"lpwstr":e=gs(this,this.l),t=4+2*nt(this,this.l);break;case"lpp4":t=4+nt(this,this.l),e=_s(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+nt(this,this.l),e=Ss(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(s=ii(this,this.l+t++))!==0;)a.push(ca(s));e=a.join("");break;case"_wstr":for(t=0,e="";(s=Ii(this,this.l+t))!==0;)a.push(ca(s)),t+=2;t+=2,e=a.join("");break;case"dbcs-cont":for(e="",l=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=ii(this,l),this.l=l+1,o=Pi.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(ca(Ii(this,l))),l+=2}e=a.join(""),t*=2;break;case"cpstr":if(typeof Ue<"u"){e=Ue.utils.decode(Sn,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(e="",l=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=ii(this,l),this.l=l+1,o=Pi.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(ca(ii(this,l))),l+=1}e=a.join("");break;default:switch(t){case 1:return n=ii(this,this.l),this.l++,n;case 2:return n=(r==="i"?Xu:Ii)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(t>0?_n:ju)(this,this.l),this.l+=4,n):(i=nt(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return t==8?i=wa(this,this.l):i=wa([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:e=Go(this,this.l,t);break}}return this.l+=t,e}var $u=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},qu=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},Ku=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function Yu(t,r,e){var n=0,i=0;if(e==="dbcs"){for(i=0;i!=r.length;++i)Ku(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if(e==="sbcs"){if(typeof Ue<"u"&&ui==874)for(i=0;i!=r.length;++i){var a=Ue.utils.encode(ui,r.charAt(i));this[this.l+i]=a[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;n=r.length}else if(e==="hex"){for(;i<t;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(r.length,t);++i){var o=r.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,$u(this,r,this.l);break;case 8:if(n=8,e==="f"){Hu(this,r,this.l);break}case 16:break;case-4:n=4,qu(this,r,this.l);break}return this.l+=n,this}function Jo(t,r){var e=Go(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function Gt(t,r){t.l=r,t.read_shift=Pi,t.chk=Jo,t.write_shift=Yu}function br(t,r){t.l+=r}function V(t){var r=En(t);return Gt(r,0),r}function Bt(){var t=[],r=Ie?256:2048,e=function(l){var f=V(l);return Gt(f,0),f},n=e(r),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(l){return n&&l<n.length-n.l?n:(i(),n=e(Math.max(l+1,r)))},s=function(){return i(),ut(t)},o=function(l){i(),n=l,n.l==null&&(n.l=n.length),a(r)};return{next:a,push:o,end:s,_bufs:t}}function K(t,r,e,n){var i=+r,a;if(!isNaN(i)){n||(n=Hx[i].p||(e||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var s=t.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&ws(e)&&t.push(e)}}function Oi(t,r,e){var n=Ut(t);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function io(t,r,e){var n=Ut(t);return n.s=Oi(n.s,r.s,e),n.e=Oi(n.e,r.s,e),n}function Li(t,r){if(t.cRel&&t.c<0)for(t=Ut(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=Ut(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=Re(t);return!t.cRel&&t.cRel!=null&&(e=Qu(e)),!t.rRel&&t.rRel!=null&&(e=Ju(e)),e}function es(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+_t(t.s.c)+":"+(t.e.cRel?"":"$")+_t(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+dt(t.s.r)+":"+(t.e.rRel?"":"$")+dt(t.e.r):Li(t.s,r.biff)+":"+Li(t.e,r.biff)}function Es(t){return parseInt(Zu(t),10)-1}function dt(t){return""+(t+1)}function Ju(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Zu(t){return t.replace(/\$(\d+)$/,"$1")}function Ts(t){for(var r=eh(t),e=0,n=0;n!==r.length;++n)e=26*e+r.charCodeAt(n)-64;return e-1}function _t(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function Qu(t){return t.replace(/^([A-Z])/,"$$$1")}function eh(t){return t.replace(/^\$([A-Z])/,"$1")}function th(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function at(t){for(var r=0,e=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:r-1}}function Re(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function jt(t){var r=t.indexOf(":");return r==-1?{s:at(t),e:at(t)}:{s:at(t.slice(0,r)),e:at(t.slice(r+1))}}function Je(t,r){return typeof r>"u"||typeof r=="number"?Je(t.s,t.e):(typeof t!="string"&&(t=Re(t)),typeof r!="string"&&(r=Re(r)),t==r?t:t+":"+r)}function He(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,i=0,a=t.length;for(e=0;n<a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)e=26*e+i;for(r.s.c=--e,e=0;n<a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)e=10*e+i;if(r.s.r=--e,n===a||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,e=0;n!=a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)e=26*e+i;for(r.e.c=--e,e=0;n!=a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)e=10*e+i;return r.e.r=--e,r}function ao(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=on(t.z,e?Vt(r):r)}catch{}try{return t.w=on((t.XF||{}).numFmtId||(e?14:0),e?Vt(r):r)}catch{return""+r}}function Vr(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?$i[t.v]||t.v:r==null?ao(t,t.v):ao(t,r))}function Cn(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",n={};return n[e]=t,{SheetNames:[e],Sheets:n}}function Zo(t,r,e){var n=e||{},i=t?Array.isArray(t):n.dense;Ar!=null&&i==null&&(i=Ar);var a=t||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?at(n.origin):n.origin;s=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=He(a["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),s==-1&&(l.e.r=s=f.e.r+1)}for(var v=0;v!=r.length;++v)if(r[v]){if(!Array.isArray(r[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=r[v].length;++p)if(!(typeof r[v][p]>"u")){var x={v:r[v][p]},w=s+v,h=o+p;if(l.s.r>w&&(l.s.r=w),l.s.c>h&&(l.s.c=h),l.e.r<w&&(l.e.r=w),l.e.c<h&&(l.e.c=h),r[v][p]&&typeof r[v][p]=="object"&&!Array.isArray(r[v][p])&&!(r[v][p]instanceof Date))x=r[v][p];else if(Array.isArray(x.v)&&(x.f=r[v][p][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||$e[14],n.cellDates?(x.t="d",x.w=on(x.z,Vt(x.v))):(x.t="n",x.v=Vt(x.v),x.w=on(x.z,x.v))):x.t="s";if(i)a[w]||(a[w]=[]),a[w][h]&&a[w][h].z&&(x.z=a[w][h].z),a[w][h]=x;else{var S=Re({c:h,r:w});a[S]&&a[S].z&&(x.z=a[S].z),a[S]=x}}}return l.s.c<1e7&&(a["!ref"]=Je(l)),a}function pi(t,r){return Zo(null,t,r)}function rh(t){return t.read_shift(4,"i")}function xr(t,r){return r||(r=V(4)),r.write_shift(4,t),r}function St(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function st(t,r){var e=!1;return r==null&&(e=!0,r=V(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}function nh(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function ih(t,r){return r||(r=V(4)),r.write_shift(2,t.ich||0),r.write_shift(2,t.ifnt||0),r}function ks(t,r){var e=t.l,n=t.read_shift(1),i=St(t),a=[],s={t:i,h:i};if(n&1){for(var o=t.read_shift(4),c=0;c!=o;++c)a.push(nh(t));s.r=a}else s.r=[{ich:0,ifnt:0}];return t.l=e+r,s}function ah(t,r){var e=!1;return r==null&&(e=!0,r=V(15+4*t.t.length)),r.write_shift(1,0),st(t.t,r),e?r.slice(0,r.l):r}var sh=ks;function oh(t,r){var e=!1;return r==null&&(e=!0,r=V(23+4*t.t.length)),r.write_shift(1,1),st(t.t,r),r.write_shift(4,1),ih({ich:0,ifnt:0},r),e?r.slice(0,r.l):r}function cr(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function yn(t,r){return r==null&&(r=V(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function Fn(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function An(t,r){return r==null&&(r=V(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var ch=St,Qo=st;function Cs(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function Ea(t,r){var e=!1;return r==null&&(e=!0,r=V(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}var lh=St,cs=Cs,ys=Ea;function ec(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,n=r[0]&2;t.l+=4;var i=n===0?wa([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):_n(r,0)>>2;return e?i/100:i}function tc(t,r){r==null&&(r=V(4));var e=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,e=1),n)r.write_shift(-4,((e?i:t)<<2)+(e+2));else throw new Error("unsupported RkNumber "+t)}function rc(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function fh(t,r){return r||(r=V(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var bn=rc,xi=fh;function vi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Tn(t,r){return(r||V(8)).write_shift(8,t,"f")}function uh(t){var r={},e=t.read_shift(1),n=e>>>1,i=t.read_shift(1),a=t.read_shift(2,"i"),s=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var l=Sh[i];l&&(r.rgb=vo(l));break;case 2:r.rgb=vo([s,o,c]);break;case 3:r.theme=i;break}return a!=0&&(r.tint=a>0?a/32767:a/32768),r}function Ta(t,r){if(r||(r=V(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),r.write_shift(2,e),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function hh(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function dh(t,r){r||(r=V(2));var e=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,e),r.write_shift(1,0),r}var nc=2,Ht=3,da=11;var ka=19;var ma=64,mh=65,ph=71;var xh=4108,vh=4126,ft=80;var so={1:{n:"CodePage",t:nc},2:{n:"Category",t:ft},3:{n:"PresentationFormat",t:ft},4:{n:"ByteCount",t:Ht},5:{n:"LineCount",t:Ht},6:{n:"ParagraphCount",t:Ht},7:{n:"SlideCount",t:Ht},8:{n:"NoteCount",t:Ht},9:{n:"HiddenCount",t:Ht},10:{n:"MultimediaClipCount",t:Ht},11:{n:"ScaleCrop",t:da},12:{n:"HeadingPairs",t:xh},13:{n:"TitlesOfParts",t:vh},14:{n:"Manager",t:ft},15:{n:"Company",t:ft},16:{n:"LinksUpToDate",t:da},17:{n:"CharacterCount",t:Ht},19:{n:"SharedDoc",t:da},22:{n:"HyperlinksChanged",t:da},23:{n:"AppVersion",t:Ht,p:"version"},24:{n:"DigSig",t:mh},26:{n:"ContentType",t:ft},27:{n:"ContentStatus",t:ft},28:{n:"Language",t:ft},29:{n:"Version",t:ft},255:{},2147483648:{n:"Locale",t:ka},2147483651:{n:"Behavior",t:ka},1919054434:{}},oo={1:{n:"CodePage",t:nc},2:{n:"Title",t:ft},3:{n:"Subject",t:ft},4:{n:"Author",t:ft},5:{n:"Keywords",t:ft},6:{n:"Comments",t:ft},7:{n:"Template",t:ft},8:{n:"LastAuthor",t:ft},9:{n:"RevNumber",t:ft},10:{n:"EditTime",t:ma},11:{n:"LastPrinted",t:ma},12:{n:"CreatedDate",t:ma},13:{n:"ModifiedDate",t:ma},14:{n:"PageCount",t:Ht},15:{n:"WordCount",t:Ht},16:{n:"CharCount",t:Ht},17:{n:"Thumbnail",t:ph},18:{n:"Application",t:ft},19:{n:"DocSecurity",t:Ht},255:{},2147483648:{n:"Locale",t:ka},2147483651:{n:"Behavior",t:ka},1919054434:{}};function gh(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var _h=gh([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Sh=Ut(_h),$i={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var wh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},pa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ic(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ac(t,r){var e=zu(wh),n=[],i;n[n.length]=Ze,n[n.length]=te("Types",null,{xmlns:it.CT,"xmlns:xsd":it.xsd,"xmlns:xsi":it.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return te("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){t[c]&&t[c].length>0&&(i=t[c][0],n[n.length]=te("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:pa[c][r.bookType]||pa[c].xlsx}))},s=function(c){(t[c]||[]).forEach(function(l){n[n.length]=te("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:pa[c][r.bookType]||pa[c].xlsx})})},o=function(c){(t[c]||[]).forEach(function(l){n[n.length]=te("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:e[c][0]})})};return a("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ze={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sc(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function ci(t){var r=[Ze,te("Relationships",null,{xmlns:it.RELS})];return mt(t["!id"]).forEach(function(e){r[r.length]=te("Relationship",null,t["!id"][e])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Oe(t,r,e,n,i,a){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,i.Id="rId"+r,i.Type=n,i.Target=e,a?i.TargetMode=a:[ze.HLINK,ze.XPATH,ze.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,r}function Eh(t){var r=[Ze];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<t.length;++e)r.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function co(t,r,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Th(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function kh(t){var r=[Ze];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=t.length;++e)r.push(co(t[e][0],t[e][1])),r.push(Th("",t[e][0]));return r.push(co("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function oc(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Mi.version+"</meta:generator></office:meta></office:document-meta>"}var wn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function ts(t,r,e,n,i){i[t]!=null||r==null||r===""||(i[t]=r,r=Le(r),n[n.length]=e?te(t,r,e):ht(t,r))}function cc(t,r){var e=r||{},n=[Ze,te("cp:coreProperties",null,{"xmlns:cp":it.CORE_PROPS,"xmlns:dc":it.dc,"xmlns:dcterms":it.dcterms,"xmlns:dcmitype":it.dcmitype,"xmlns:xsi":it.xsi})],i={};if(!t&&!e.Props)return n.join("");t&&(t.CreatedDate!=null&&ts("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:os(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&ts("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:os(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=wn.length;++a){var s=wn[a],o=e.Props&&e.Props[s[1]]!=null?e.Props[s[1]]:t?t[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ts(s[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var li=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],lc=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function fc(t){var r=[],e=te;return t||(t={}),t.Application="SheetJS",r[r.length]=Ze,r[r.length]=te("Properties",null,{xmlns:it.EXT_PROPS,"xmlns:vt":it.vt}),li.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Le(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(r[r.length]=e(n[0],i))}}),r[r.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Le(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function uc(t){var r=[Ze,te("Properties",null,{xmlns:it.CUST_PROPS,"xmlns:vt":it.vt})];if(!t)return r.join("");var e=1;return mt(t).forEach(function(i){++e,r[r.length]=te("property",Uu(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Le(i)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var lo={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ch(t,r){var e=[];return mt(lo).map(function(n){for(var i=0;i<wn.length;++i)if(wn[i][1]==n)return wn[i];for(i=0;i<li.length;++i)if(li[i][1]==n)return li[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),e.push(ht(lo[n[1]]||n[1],i))}}),te("DocumentProperties",e.join(""),{xmlns:Xt.o})}function yh(t,r){var e=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&mt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var s=0;s<wn.length;++s)if(a==wn[s][1])return;for(s=0;s<li.length;++s)if(a==li[s][1])return;for(s=0;s<e.length;++s)if(a==e[s])return;var o=t[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(te(Y0(a),o,{"dt:dt":c}))}}),r&&mt(r).forEach(function(a){if(Object.prototype.hasOwnProperty.call(r,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var s=r[a],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),i.push(te(Y0(a),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Xt.o+'">'+i.join("")+"</"+n+">"}function Fh(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,e=r.getTime()/1e3+11644473600,n=e%Math.pow(2,32),i=(e-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var s=V(8);return s.write_shift(4,n),s.write_shift(4,i),s}function fo(t,r){var e=V(4),n=V(4);switch(e.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,r);break;case 5:n=V(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=Fh(r);break;case 31:case 80:for(n=V(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return ut([e,n])}var hc=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Ah(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function uo(t,r,e){var n=V(8),i=[],a=[],s=8,o=0,c=V(8),l=V(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),a.push(c),i.push(l),s+=8+c.length,!r){l=V(8),l.write_shift(4,0),i.unshift(l);var f=[V(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var v=t[o][0];for(c=V(8+2*(v.length+1)+(v.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,v.length+1),c.write_shift(0,v,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=ut(f),a.unshift(c),s+=8+c.length}for(o=0;o<t.length;++o)if(!(r&&!r[t[o][0]])&&!(hc.indexOf(t[o][0])>-1||lc.indexOf(t[o][0])>-1)&&t[o][1]!=null){var p=t[o][1],x=0;if(r){x=+r[t[o][0]];var w=e[x];if(w.p=="version"&&typeof p=="string"){var h=p.split(".");p=(+h[0]<<16)+(+h[1]||0)}c=fo(w.t,p)}else{var S=Ah(p);S==-1&&(S=31,p=String(p)),c=fo(S,p)}a.push(c),l=V(8),l.write_shift(4,r?x:2+o),i.push(l),s+=8+c.length}var D=8*(a.length+1);for(o=0;o<a.length;++o)i[o].write_shift(4,D),D+=a[o].length;return n.write_shift(4,s),n.write_shift(4,a.length),ut([n].concat(i).concat(a))}function ho(t,r,e,n,i,a){var s=V(i?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Ve.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,r,"hex"),s.write_shift(4,i?68:48);var c=uo(t,e,n);if(o.push(c),i){var l=uo(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+c.length),o.push(l)}return ut(o)}function bh(t,r){r||(r=V(t));for(var e=0;e<t;++e)r.write_shift(1,0);return r}function zh(t,r){return t.read_shift(r)===1}function yt(t,r){return r||(r=V(2)),r.write_shift(2,+!!t),r}function dc(t){return t.read_shift(2,"u")}function or(t,r){return r||(r=V(2)),r.write_shift(2,t),r}function mc(t,r,e){return e||(e=V(2)),e.write_shift(1,r=="e"?+t:+!!t),e.write_shift(1,r=="e"?1:0),e}function pc(t,r,e){var n=t.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont",a=Sn;if(e&&e.biff>=8&&(Sn=1200),!e||e.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else e.biff==12&&(i="wstr");e.biff>=2&&e.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return Sn=a,o}function Dh(t){var r=t.t||"",e=1,n=V(3+(e>1?2:0));n.write_shift(2,r.length),n.write_shift(1,(e>1?8:0)|1),e>1&&n.write_shift(2,e);var i=V(2*r.length);i.write_shift(2*r.length,r,"utf16le");var a=[n,i];return ut(a)}function Ih(t,r,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(r,"sbcs-cont"):n=t.read_shift(r,"dbcs-cont"),n}function Nh(t,r,e){var n=t.read_shift(e&&e.biff==2?1:2);return n===0?(t.l++,""):Ih(t,n,e)}function Ph(t,r,e){if(e.biff>5)return Nh(t,r,e);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function xc(t,r,e){return e||(e=V(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function mo(t,r){r||(r=V(6+t.length*2)),r.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)r.write_shift(2,t.charCodeAt(e));return r.write_shift(2,0),r}function Oh(t){var r=V(512),e=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}r.write_shift(4,2),r.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(e=0;e<s.length;++e)r.write_shift(4,s[e]);if(a==28)n=n.slice(1),mo(n,r);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<s.length;++e)r.write_shift(1,parseInt(s[e],16));var o=i>-1?n.slice(0,i):n;for(r.write_shift(4,2*(o.length+1)),e=0;e<o.length;++e)r.write_shift(2,o.charCodeAt(e));r.write_shift(2,0),a&8&&mo(i>-1?n.slice(i+1):"",r)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<s.length;++e)r.write_shift(1,parseInt(s[e],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,n.length-3*c+1),e=0;e<n.length-3*c;++e)r.write_shift(1,n.charCodeAt(e+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),e=0;e<6;++e)r.write_shift(4,0)}return r.slice(0,r.l)}function kn(t,r,e,n){return n||(n=V(6)),n.write_shift(2,t),n.write_shift(2,r),n.write_shift(2,e||0),n}function Lh(t,r,e){var n=e.biff>8?4:2,i=t.read_shift(n),a=t.read_shift(n,"i"),s=t.read_shift(n,"i");return[i,a,s]}function Rh(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r},e:{c:i,r:e}}}function vc(t,r){return r||(r=V(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function Fs(t,r,e){var n=1536,i=16;switch(e.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=V(i);return a.write_shift(2,n),a.write_shift(2,r),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Mh(t,r){var e=!r||r.biff==8,n=V(e?112:54);for(n.write_shift(r.biff==8?2:1,7),e&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(e?0:536870912));n.l<n.length;)n.write_shift(1,e?0:32);return n}function Bh(t,r){var e=!r||r.biff>=8?2:1,n=V(8+e*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(e*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Vh(t,r){var e=V(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=Dh(t[i],r);var a=ut([e].concat(n));return a.parts=[e.length].concat(n.map(function(s){return s.length})),a}function Uh(){var t=V(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Wh(t){var r=V(18),e=1718;return t&&t.RTL&&(e|=64),r.write_shift(2,e),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function Hh(t,r){var e=t.name||"Arial",n=r&&r.biff==5,i=n?15+e.length:16+2*e.length,a=V(i);return a.write_shift(2,(t.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,e.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le"),a}function Gh(t,r,e,n){var i=V(10);return kn(t,r,n,i),i.write_shift(4,e),i}function Xh(t,r,e,n,i){var a=!i||i.biff==8,s=V(8+ +a+(1+a)*e.length);return kn(t,r,n,s),s.write_shift(2,e.length),a&&s.write_shift(1,1),s.write_shift((1+a)*e.length,e,a?"utf16le":"sbcs"),s}function jh(t,r,e,n){var i=e&&e.biff==5;n||(n=V(i?3+r.length:5+2*r.length)),n.write_shift(2,t),n.write_shift(i?1:2,r.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function $h(t,r){var e=r.biff==8||!r.biff?4:2,n=V(2*e+6);return n.write_shift(e,t.s.r),n.write_shift(e,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function po(t,r,e,n){var i=e&&e.biff==5;n||(n=V(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,r<<4));var a=0;return t.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function qh(t){var r=V(8);return r.write_shift(4,0),r.write_shift(2,t[0]?t[0]+1:0),r.write_shift(2,t[1]?t[1]+1:0),r}function Kh(t,r,e,n,i,a){var s=V(8);return kn(t,r,n,s),mc(e,a,s),s}function Yh(t,r,e,n){var i=V(14);return kn(t,r,n,i),Tn(e,i),i}function Jh(t,r,e){if(e.biff<8)return Zh(t,r,e);for(var n=[],i=t.l+r,a=t.read_shift(e.biff>8?4:2);a--!==0;)n.push(Lh(t,e.biff>8?12:6,e));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function Zh(t,r,e){t[t.l+1]==3&&t[t.l]++;var n=pc(t,r,e);return n.charCodeAt(0)==3?n.slice(1):n}function Qh(t){var r=V(2+t.length*8);r.write_shift(2,t.length);for(var e=0;e<t.length;++e)vc(t[e],r);return r}function ed(t){var r=V(24),e=at(t[0]);r.write_shift(2,e.r),r.write_shift(2,e.r),r.write_shift(2,e.c),r.write_shift(2,e.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)r.write_shift(1,parseInt(n[i],16));return ut([r,Oh(t[1])])}function td(t){var r=t[1].Tooltip,e=V(10+2*(r.length+1));e.write_shift(2,2048);var n=at(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var i=0;i<r.length;++i)e.write_shift(2,r.charCodeAt(i));return e.write_shift(2,0),e}function rd(t){return t||(t=V(4)),t.write_shift(2,1),t.write_shift(2,1),t}function nd(t,r,e){if(!e.cellStyles)return br(t,r);var n=e&&e.biff>=12?4:2,i=t.read_shift(n),a=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var l={s:i,e:a,w:s,ixfe:o,flags:c};return(e.biff>=5||!e.biff)&&(l.level=c>>8&7),l}function id(t,r){var e=V(12);e.write_shift(2,r),e.write_shift(2,r),e.write_shift(2,t.width*256),e.write_shift(2,0);var n=0;return t.hidden&&(n|=1),e.write_shift(1,n),n=t.level||0,e.write_shift(1,n),e.write_shift(2,0),e}function ad(t){for(var r=V(2*t),e=0;e<t;++e)r.write_shift(2,e+1);return r}function sd(t,r,e){var n=V(15);return Ki(n,t,r),n.write_shift(8,e,"f"),n}function od(t,r,e){var n=V(9);return Ki(n,t,r),n.write_shift(2,e),n}var cd=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=hs({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,c){var l=[],f=En(1);switch(c.type){case"base64":f=mr(Br(o));break;case"binary":f=mr(o);break;case"buffer":case"array":f=o;break}Gt(f,0);var v=f.read_shift(1),p=!!(v&136),x=!1,w=!1;switch(v){case 2:break;case 3:break;case 48:x=!0,p=!0;break;case 49:x=!0,p=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var h=0,S=521;v==2&&(h=f.read_shift(2)),f.l+=3,v!=2&&(h=f.read_shift(4)),h>1048576&&(h=1e6),v!=2&&(S=f.read_shift(2));var D=f.read_shift(2),I=c.codepage||1252;v!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(I=t[f[f.l]]),f.l+=1,f.l+=2),w&&(f.l+=36);for(var P=[],H={},Z=Math.min(f.length,v==2?521:S-10-(x?264:0)),me=w?32:11;f.l<Z&&f[f.l]!=13;)switch(H={},H.name=Ue.utils.decode(I,f.slice(f.l,f.l+me)).replace(/[\u0000\r\n].*$/g,""),f.l+=me,H.type=String.fromCharCode(f.read_shift(1)),v!=2&&!w&&(H.offset=f.read_shift(4)),H.len=f.read_shift(1),v==2&&(H.offset=f.read_shift(2)),H.dec=f.read_shift(1),H.name.length&&P.push(H),v!=2&&(f.l+=w?13:14),H.type){case"B":(!x||H.len!=8)&&c.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+H.type)}if(f[f.l]!==13&&(f.l=S-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=S;var N=0,q=0;for(l[0]=[],q=0;q!=P.length;++q)l[0][q]=P[q].name;for(;h-- >0;){if(f[f.l]===42){f.l+=D;continue}for(++f.l,l[++N]=[],q=0,q=0;q!=P.length;++q){var W=f.slice(f.l,f.l+P[q].len);f.l+=P[q].len,Gt(W,0);var X=Ue.utils.decode(I,W);switch(P[q].type){case"C":X.trim().length&&(l[N][q]=X.replace(/\s+$/,""));break;case"D":X.length===8?l[N][q]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):l[N][q]=X;break;case"F":l[N][q]=parseFloat(X.trim());break;case"+":case"I":l[N][q]=w?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":l[N][q]=!0;break;case"N":case"F":l[N][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));l[N][q]="##MEMO##"+(w?parseInt(X.trim(),10):W.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(l[N][q]=+X||0);break;case"@":l[N][q]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":l[N][q]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":l[N][q]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[N][q]=-W.read_shift(-8,"f");break;case"B":if(x&&P[q].len==8){l[N][q]=W.read_shift(8,"f");break}case"G":case"P":W.l+=P[q].len;break;case"0":if(P[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+P[q].type)}}}if(v!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=P,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=pi(e(o,l),l);return f["!cols"]=l.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete l.DBF,f}function i(o,c){try{return Cn(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var l=c||{};if(+l.codepage>=0&&Bi(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=Bt(),v=ba(o,{header:1,raw:!0,cellDates:!0}),p=v[0],x=v.slice(1),w=o["!cols"]||[],h=0,S=0,D=0,I=1;for(h=0;h<p.length;++h){if(((w[h]||{}).DBF||{}).name){p[h]=w[h].DBF.name,++D;continue}if(p[h]!=null){if(++D,typeof p[h]=="number"&&(p[h]=p[h].toString(10)),typeof p[h]!="string")throw new Error("DBF Invalid column name "+p[h]+" |"+typeof p[h]+"|");if(p.indexOf(p[h])!==h){for(S=0;S<1024;++S)if(p.indexOf(p[h]+"_"+S)==-1){p[h]+="_"+S;break}}}}var P=He(o["!ref"]),H=[],Z=[],me=[];for(h=0;h<=P.e.c-P.s.c;++h){var N="",q="",W=0,X=[];for(S=0;S<x.length;++S)x[S][h]!=null&&X.push(x[S][h]);if(X.length==0||p[h]==null){H[h]="?";continue}for(S=0;S<X.length;++S){switch(typeof X[S]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=X[S]instanceof Date?"D":"C";break;default:q="C"}W=Math.max(W,String(X[S]).length),N=N&&N!=q?"C":q}W>250&&(W=250),q=((w[h]||{}).DBF||{}).type,q=="C"&&w[h].DBF.len>W&&(W=w[h].DBF.len),N=="B"&&q=="N"&&(N="N",me[h]=w[h].DBF.dec,W=w[h].DBF.len),Z[h]=N=="C"||q=="N"?W:a[N]||0,I+=Z[h],H[h]=N}var J=f.next(32);for(J.write_shift(4,318902576),J.write_shift(4,x.length),J.write_shift(2,296+32*D),J.write_shift(2,I),h=0;h<4;++h)J.write_shift(4,0);for(J.write_shift(4,0|(+r[ui]||3)<<8),h=0,S=0;h<p.length;++h)if(p[h]!=null){var Q=f.next(32),ve=(p[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Q.write_shift(1,ve,"sbcs"),Q.write_shift(1,H[h]=="?"?"C":H[h],"sbcs"),Q.write_shift(4,S),Q.write_shift(1,Z[h]||a[H[h]]||0),Q.write_shift(1,me[h]||0),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(1,0),Q.write_shift(4,0),Q.write_shift(4,0),S+=Z[h]||a[H[h]]||0}var Ne=f.next(264);for(Ne.write_shift(4,13),h=0;h<65;++h)Ne.write_shift(4,0);for(h=0;h<x.length;++h){var ge=f.next(I);for(ge.write_shift(1,0),S=0;S<p.length;++S)if(p[S]!=null)switch(H[S]){case"L":ge.write_shift(1,x[h][S]==null?63:x[h][S]?84:70);break;case"B":ge.write_shift(8,x[h][S]||0,"f");break;case"N":var et="0";for(typeof x[h][S]=="number"&&(et=x[h][S].toFixed(me[S]||0)),D=0;D<Z[S]-et.length;++D)ge.write_shift(1,32);ge.write_shift(1,et,"sbcs");break;case"D":x[h][S]?(ge.write_shift(4,("0000"+x[h][S].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(x[h][S].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+x[h][S].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var tt=String(x[h][S]!=null?x[h][S]:"").slice(0,Z[S]);for(ge.write_shift(1,tt,"sbcs"),D=0;D<Z[S]-tt.length;++D)ge.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),ld=function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+mt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(p,x){var w=t[x];return typeof w=="number"?M0(w):w},n=function(p,x,w){var h=x.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return h==59?p:M0(h)};t["|"]=254;function i(p,x){switch(x.type){case"base64":return a(Br(p),x);case"binary":return a(p,x);case"buffer":return a(Ie&&Buffer.isBuffer(p)?p.toString("binary"):Xi(p),x);case"array":return a(Pa(p),x)}throw new Error("Unrecognized type "+x.type)}function a(p,x){var w=p.split(/[\n\r]+/),h=-1,S=-1,D=0,I=0,P=[],H=[],Z=null,me={},N=[],q=[],W=[],X=0,J;for(+x.codepage>=0&&Bi(+x.codepage);D!==w.length;++D){X=0;var Q=w[D].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,e),ve=Q.replace(/;;/g,"\0").split(";").map(function(b){return b.replace(/\u0000/g,";")}),Ne=ve[0],ge;if(Q.length>0)switch(Ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ve[1].charAt(0)=="P"&&H.push(Q.slice(3).replace(/;;/g,";"));break;case"C":var et=!1,tt=!1,At=!1,wt=!1,ot=-1,bt=-1;for(I=1;I<ve.length;++I)switch(ve[I].charAt(0)){case"A":break;case"X":S=parseInt(ve[I].slice(1))-1,tt=!0;break;case"Y":for(h=parseInt(ve[I].slice(1))-1,tt||(S=0),J=P.length;J<=h;++J)P[J]=[];break;case"K":ge=ve[I].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(Rr(ge))?isNaN(Ui(ge).getDate())||(ge=Ft(ge)):(ge=Rr(ge),Z!==null&&Lo(Z)&&(ge=Vo(ge))),typeof Ue<"u"&&typeof ge=="string"&&(x||{}).type!="string"&&(x||{}).codepage&&(ge=Ue.utils.decode(x.codepage,ge)),et=!0;break;case"E":wt=!0;var A=om(ve[I].slice(1),{r:h,c:S});P[h][S]=[P[h][S],A];break;case"S":At=!0,P[h][S]=[P[h][S],"S5S"];break;case"G":break;case"R":ot=parseInt(ve[I].slice(1))-1;break;case"C":bt=parseInt(ve[I].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Q)}if(et&&(P[h][S]&&P[h][S].length==2?P[h][S][0]=ge:P[h][S]=ge,Z=null),At){if(wt)throw new Error("SYLK shared formula cannot have own formula");var G=ot>-1&&P[ot][bt];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");P[h][S][1]=cm(G[1],{r:h-ot,c:S-bt})}break;case"F":var z=0;for(I=1;I<ve.length;++I)switch(ve[I].charAt(0)){case"X":S=parseInt(ve[I].slice(1))-1,++z;break;case"Y":for(h=parseInt(ve[I].slice(1))-1,J=P.length;J<=h;++J)P[J]=[];break;case"M":X=parseInt(ve[I].slice(1))/20;break;case"F":break;case"G":break;case"P":Z=H[parseInt(ve[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=ve[I].slice(1).split(" "),J=parseInt(W[0],10);J<=parseInt(W[1],10);++J)X=parseInt(W[2],10),q[J-1]=X===0?{hidden:!0}:{wch:X},As(q[J-1]);break;case"C":S=parseInt(ve[I].slice(1))-1,q[S]||(q[S]={});break;case"R":h=parseInt(ve[I].slice(1))-1,N[h]||(N[h]={}),X>0?(N[h].hpt=X,N[h].hpx=Ec(X)):X===0&&(N[h].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Q)}z<1&&(Z=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Q)}}return N.length>0&&(me["!rows"]=N),q.length>0&&(me["!cols"]=q),x&&x.sheetRows&&(P=P.slice(0,x.sheetRows)),[P,me]}function s(p,x){var w=i(p,x),h=w[0],S=w[1],D=pi(h,x);return mt(S).forEach(function(I){D[I]=S[I]}),D}function o(p,x){return Cn(s(p,x),x)}function c(p,x,w,h){var S="C;Y"+(w+1)+";X"+(h+1)+";K";switch(p.t){case"n":S+=p.v||0,p.f&&!p.F&&(S+=";E"+zs(p.f,{r:w,c:h}));break;case"b":S+=p.v?"TRUE":"FALSE";break;case"e":S+=p.w||p.v;break;case"d":S+='"'+(p.w||p.v)+'"';break;case"s":S+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function l(p,x){x.forEach(function(w,h){var S="F;W"+(h+1)+" "+(h+1)+" ";w.hidden?S+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Ca(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=ya(w.wpx)),typeof w.wch=="number"&&(S+=Math.round(w.wch))),S.charAt(S.length-1)!=" "&&p.push(S)})}function f(p,x){x.forEach(function(w,h){var S="F;";w.hidden?S+="M0;":w.hpt?S+="M"+20*w.hpt+";":w.hpx&&(S+="M"+20*Fa(w.hpx)+";"),S.length>2&&p.push(S+"R"+(h+1))})}function v(p,x){var w=["ID;PWXL;N;E"],h=[],S=He(p["!ref"]),D,I=Array.isArray(p),P=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),p["!cols"]&&l(w,p["!cols"]),p["!rows"]&&f(w,p["!rows"]),w.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var H=S.s.r;H<=S.e.r;++H)for(var Z=S.s.c;Z<=S.e.c;++Z){var me=Re({r:H,c:Z});D=I?(p[H]||[])[Z]:p[me],!(!D||D.v==null&&(!D.f||D.F))&&h.push(c(D,p,H,Z,x))}return w.join(P)+P+h.join(P)+P+"E"+P}return{to_workbook:o,to_sheet:s,from_sheet:v}}(),fd=function(){function t(a,s){switch(s.type){case"base64":return r(Br(a),s);case"binary":return r(a,s);case"buffer":return r(Ie&&Buffer.isBuffer(a)?a.toString("binary"):Xi(a),s);case"array":return r(Pa(a),s)}throw new Error("Unrecognized type "+s.type)}function r(a,s){for(var o=a.split(`
`),c=-1,l=-1,f=0,v=[];f!==o.length;++f){if(o[f].trim()==="BOT"){v[++c]=[],l=0;continue}if(!(c<0)){var p=o[f].trim().split(","),x=p[0],w=p[1];++f;for(var h=o[f]||"";(h.match(/["]/g)||[]).length&1&&f<o.length-1;)h+=`
`+o[++f];switch(h=h.trim(),+x){case-1:if(h==="BOT"){v[++c]=[],l=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?v[c][l]=!0:h==="FALSE"?v[c][l]=!1:isNaN(Rr(w))?isNaN(Ui(w).getDate())?v[c][l]=w:v[c][l]=Ft(w):v[c][l]=Rr(w),++l;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),zi&&h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),v[c][l++]=h!==""?h:null;break}if(h==="EOD")break}}return s&&s.sheetRows&&(v=v.slice(0,s.sheetRows)),v}function e(a,s){return pi(t(a,s),s)}function n(a,s){return Cn(e(a,s),s)}var i=function(){var a=function(c,l,f,v,p){c.push(l),c.push(f+","+v),c.push('"'+p.replace(/"/g,'""')+'"')},s=function(c,l,f,v){c.push(l+","+f),c.push(l==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(c){var l=[],f=He(c["!ref"]),v,p=Array.isArray(c);a(l,"TABLE",0,1,"sheetjs"),a(l,"VECTORS",0,f.e.r-f.s.r+1,""),a(l,"TUPLES",0,f.e.c-f.s.c+1,""),a(l,"DATA",0,0,"");for(var x=f.s.r;x<=f.e.r;++x){s(l,-1,0,"BOT");for(var w=f.s.c;w<=f.e.c;++w){var h=Re({r:x,c:w});if(v=p?(c[x]||[])[w]:c[h],!v){s(l,1,0,"");continue}switch(v.t){case"n":var S=zi?v.w:v.v;!S&&v.v!=null&&(S=v.v),S==null?zi&&v.f&&!v.F?s(l,1,0,"="+v.f):s(l,1,0,""):s(l,0,S,"V");break;case"b":s(l,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":s(l,1,0,!zi||isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=on(v.z||$e[14],Vt(Ft(v.v)))),zi?s(l,0,v.w,"V"):s(l,1,0,v.w);break;default:s(l,1,0,"")}}}s(l,-1,0,"EOD");var D=`\r
`,I=l.join(D);return I}}();return{to_workbook:n,to_sheet:e,from_sheet:i}}(),gc=function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(v,p){for(var x=v.split(`
`),w=-1,h=-1,S=0,D=[];S!==x.length;++S){var I=x[S].trim().split(":");if(I[0]==="cell"){var P=at(I[1]);if(D.length<=P.r)for(w=D.length;w<=P.r;++w)D[w]||(D[w]=[]);switch(w=P.r,h=P.c,I[2]){case"t":D[w][h]=t(I[3]);break;case"v":D[w][h]=+I[3];break;case"vtf":var H=I[I.length-1];case"vtc":switch(I[3]){case"nl":D[w][h]=!!+I[4];break;default:D[w][h]=+I[4];break}I[2]=="vtf"&&(D[w][h]=[D[w][h],H])}}}return p&&p.sheetRows&&(D=D.slice(0,p.sheetRows)),D}function n(v,p){return pi(e(v,p),p)}function i(v,p){return Cn(n(v,p),p)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(v){if(!v||!v["!ref"])return"";for(var p=[],x=[],w,h="",S=jt(v["!ref"]),D=Array.isArray(v),I=S.s.r;I<=S.e.r;++I)for(var P=S.s.c;P<=S.e.c;++P)if(h=Re({r:I,c:P}),w=D?(v[I]||[])[P]:v[h],!(!w||w.v==null||w.t==="z")){switch(x=["cell",h,"t"],w.t){case"s":case"str":x.push(r(w.v));break;case"n":w.f?(x[2]="vtf",x[3]="n",x[4]=w.v,x[5]=r(w.f)):(x[2]="v",x[3]=w.v);break;case"b":x[2]="vt"+(w.f?"f":"c"),x[3]="nl",x[4]=w.v?"1":"0",x[5]=r(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var H=Vt(Ft(w.v));x[2]="vtc",x[3]="nd",x[4]=""+H,x[5]=w.w||on(w.z||$e[14],H);break;case"e":continue}p.push(x.join(":"))}return p.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(v){return[a,s,o,s,l(v),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),ud=function(){function t(f,v,p,x,w){w.raw?v[p][x]=f:f===""||(f==="TRUE"?v[p][x]=!0:f==="FALSE"?v[p][x]=!1:isNaN(Rr(f))?isNaN(Ui(f).getDate())?v[p][x]=f:v[p][x]=Ft(f):v[p][x]=Rr(f))}function r(f,v){var p=v||{},x=[];if(!f||f.length===0)return x;for(var w=f.split(/[\r\n]/),h=w.length-1;h>=0&&w[h].length===0;)--h;for(var S=10,D=0,I=0;I<=h;++I)D=w[I].indexOf(" "),D==-1?D=w[I].length:D++,S=Math.max(S,D);for(I=0;I<=h;++I){x[I]=[];var P=0;for(t(w[I].slice(0,S).trim(),x,I,P,p),P=1;P<=(w[I].length-S)/10+1;++P)t(w[I].slice(S+(P-1)*10,S+P*10).trim(),x,I,P,p)}return p.sheetRows&&(x=x.slice(0,p.sheetRows)),x}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var v={},p=!1,x=0,w=0;x<f.length;++x)(w=f.charCodeAt(x))==34?p=!p:!p&&w in e&&(v[w]=(v[w]||0)+1);w=[];for(x in v)Object.prototype.hasOwnProperty.call(v,x)&&w.push([v[x],x]);if(!w.length){v=n;for(x in v)Object.prototype.hasOwnProperty.call(v,x)&&w.push([v[x],x])}return w.sort(function(h,S){return h[0]-S[0]||n[h[1]]-n[S[1]]}),e[w.pop()[1]]||44}function a(f,v){var p=v||{},x="";Ar!=null&&p.dense==null&&(p.dense=Ar);var w=p.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(x=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(x=f.charAt(4),f=f.slice(6)):x=i(f.slice(0,1024)):p&&p.FS?x=p.FS:x=i(f.slice(0,1024));var S=0,D=0,I=0,P=0,H=0,Z=x.charCodeAt(0),me=!1,N=0,q=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var W=p.dateNF!=null?yu(p.dateNF):null;function X(){var J=f.slice(P,H),Q={};if(J.charAt(0)=='"'&&J.charAt(J.length-1)=='"'&&(J=J.slice(1,-1).replace(/""/g,'"')),J.length===0)Q.t="z";else if(p.raw)Q.t="s",Q.v=J;else if(J.trim().length===0)Q.t="s",Q.v=J;else if(J.charCodeAt(0)==61)J.charCodeAt(1)==34&&J.charCodeAt(J.length-1)==34?(Q.t="s",Q.v=J.slice(2,-1).replace(/""/g,'"')):lm(J)?(Q.t="n",Q.f=J.slice(1)):(Q.t="s",Q.v=J);else if(J=="TRUE")Q.t="b",Q.v=!0;else if(J=="FALSE")Q.t="b",Q.v=!1;else if(!isNaN(I=Rr(J)))Q.t="n",p.cellText!==!1&&(Q.w=J),Q.v=I;else if(!isNaN(Ui(J).getDate())||W&&J.match(W)){Q.z=p.dateNF||$e[14];var ve=0;W&&J.match(W)&&(J=Fu(J,p.dateNF,J.match(W)||[]),ve=1),p.cellDates?(Q.t="d",Q.v=Ft(J,ve)):(Q.t="n",Q.v=Vt(Ft(J,ve))),p.cellText!==!1&&(Q.w=on(Q.z,Q.v instanceof Date?Vt(Q.v):Q.v)),p.cellNF||delete Q.z}else Q.t="s",Q.v=J;if(Q.t=="z"||(p.dense?(w[S]||(w[S]=[]),w[S][D]=Q):w[Re({c:D,r:S})]=Q),P=H+1,q=f.charCodeAt(P),h.e.c<D&&(h.e.c=D),h.e.r<S&&(h.e.r=S),N==Z)++D;else if(D=0,++S,p.sheetRows&&p.sheetRows<=S)return!0}e:for(;H<f.length;++H)switch(N=f.charCodeAt(H)){case 34:q===34&&(me=!me);break;case Z:case 10:case 13:if(!me&&X())break e;break;default:break}return H-P>0&&X(),w["!ref"]=Je(h),w}function s(f,v){return!(v&&v.PRN)||v.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,v):pi(r(f,v),v)}function o(f,v){var p="",x=v.type=="string"?[0,0,0,0]:Tv(f,v);switch(v.type){case"base64":p=Br(f);break;case"binary":p=f;break;case"buffer":v.codepage==65001?p=f.toString("utf8"):v.codepage&&typeof Ue<"u"?p=Ue.utils.decode(v.codepage,f):p=Ie&&Buffer.isBuffer(f)?f.toString("binary"):Xi(f);break;case"array":p=Pa(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+v.type)}return x[0]==239&&x[1]==187&&x[2]==191?p=Ni(p.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?p=Ni(p):v.type=="binary"&&typeof Ue<"u"&&v.codepage&&(p=Ue.utils.decode(v.codepage,Ue.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?gc.to_sheet(v.type=="string"?p:Ni(p),v):s(p,v)}function c(f,v){return Cn(o(f,v),v)}function l(f){for(var v=[],p=He(f["!ref"]),x,w=Array.isArray(f),h=p.s.r;h<=p.e.r;++h){for(var S=[],D=p.s.c;D<=p.e.c;++D){var I=Re({r:h,c:D});if(x=w?(f[h]||[])[D]:f[I],!x||x.v==null){S.push("          ");continue}for(var P=(x.w||(Vr(x),x.w)||"").slice(0,10);P.length<10;)P+=" ";S.push(P+(D===0?" ":""))}v.push(S.join(""))}return v.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();var xo=function(){function t(A,G,z){if(A){Gt(A,A.l||0);for(var b=z.Enum||ot;A.l<A.length;){var Y=A.read_shift(2),xe=b[Y]||b[65535],_e=A.read_shift(2),he=A.l+_e,ae=xe.f&&xe.f(A,_e,z);if(A.l=he,G(ae,xe,Y))return}}}function r(A,G){switch(G.type){case"base64":return e(mr(Br(A)),G);case"binary":return e(mr(A),G);case"buffer":case"array":return e(A,G)}throw"Unsupported type "+G.type}function e(A,G){if(!A)return A;var z=G||{};Ar!=null&&z.dense==null&&(z.dense=Ar);var b=z.dense?[]:{},Y="Sheet1",xe="",_e=0,he={},ae=[],Me=[],ye={s:{r:0,c:0},e:{r:0,c:0}},ct=z.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)z.Enum=ot,t(A,function(pe,$t,zr){switch(zr){case 0:z.vers=pe,pe>=4096&&(z.qpro=!0);break;case 6:ye=pe;break;case 204:pe&&(xe=pe);break;case 222:xe=pe;break;case 15:case 51:z.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:zr==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=z.dateNF||$e[14],z.cellDates&&(pe[1].t="d",pe[1].v=Vo(pe[1].v))),z.qpro&&pe[3]>_e&&(b["!ref"]=Je(ye),he[Y]=b,ae.push(Y),b=z.dense?[]:{},ye={s:{r:0,c:0},e:{r:0,c:0}},_e=pe[3],Y=xe||"Sheet"+(_e+1),xe="");var un=z.dense?(b[pe[0].r]||[])[pe[0].c]:b[Re(pe[0])];if(un){un.t=pe[1].t,un.v=pe[1].v,pe[1].z!=null&&(un.z=pe[1].z),pe[1].f!=null&&(un.f=pe[1].f);break}z.dense?(b[pe[0].r]||(b[pe[0].r]=[]),b[pe[0].r][pe[0].c]=pe[1]):b[Re(pe[0])]=pe[1];break;default:}},z);else if(A[2]==26||A[2]==14)z.Enum=bt,A[2]==14&&(z.qpro=!0,A.l=0),t(A,function(pe,$t,zr){switch(zr){case 204:Y=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>_e&&(b["!ref"]=Je(ye),he[Y]=b,ae.push(Y),b=z.dense?[]:{},ye={s:{r:0,c:0},e:{r:0,c:0}},_e=pe[3],Y="Sheet"+(_e+1)),ct>0&&pe[0].r>=ct)break;z.dense?(b[pe[0].r]||(b[pe[0].r]=[]),b[pe[0].r][pe[0].c]=pe[1]):b[Re(pe[0])]=pe[1],ye.e.c<pe[0].c&&(ye.e.c=pe[0].c),ye.e.r<pe[0].r&&(ye.e.r=pe[0].r);break;case 27:pe[14e3]&&(Me[pe[14e3][0]]=pe[14e3][1]);break;case 1537:Me[pe[0]]=pe[1],pe[0]==_e&&(Y=pe[1]);break;default:break}},z);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(b["!ref"]=Je(ye),he[xe||Y]=b,ae.push(xe||Y),!Me.length)return{SheetNames:ae,Sheets:he};for(var Ae={},lr=[],Xe=0;Xe<Me.length;++Xe)he[ae[Xe]]?(lr.push(Me[Xe]||ae[Xe]),Ae[Me[Xe]]=he[Me[Xe]]||he[ae[Xe]]):(lr.push(Me[Xe]),Ae[Me[Xe]]={"!ref":"A1"});return{SheetNames:lr,Sheets:Ae}}function n(A,G){var z=G||{};if(+z.codepage>=0&&Bi(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var b=Bt(),Y=He(A["!ref"]),xe=Array.isArray(A),_e=[];re(b,0,a(1030)),re(b,6,c(Y));for(var he=Math.min(Y.e.r,8191),ae=Y.s.r;ae<=he;++ae)for(var Me=dt(ae),ye=Y.s.c;ye<=Y.e.c;++ye){ae===Y.s.r&&(_e[ye]=_t(ye));var ct=_e[ye]+Me,Ae=xe?(A[ae]||[])[ye]:A[ct];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?re(b,13,x(ae,ye,Ae.v)):re(b,14,h(ae,ye,Ae.v));else{var lr=Vr(Ae);re(b,15,v(ae,ye,lr.slice(0,239)))}}return re(b,1),b.end()}function i(A,G){var z=G||{};if(+z.codepage>=0&&Bi(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var b=Bt();re(b,0,s(A));for(var Y=0,xe=0;Y<A.SheetNames.length;++Y)(A.Sheets[A.SheetNames[Y]]||{})["!ref"]&&re(b,27,wt(A.SheetNames[Y],xe++));var _e=0;for(Y=0;Y<A.SheetNames.length;++Y){var he=A.Sheets[A.SheetNames[Y]];if(!(!he||!he["!ref"])){for(var ae=He(he["!ref"]),Me=Array.isArray(he),ye=[],ct=Math.min(ae.e.r,8191),Ae=ae.s.r;Ae<=ct;++Ae)for(var lr=dt(Ae),Xe=ae.s.c;Xe<=ae.e.c;++Xe){Ae===ae.s.r&&(ye[Xe]=_t(Xe));var pe=ye[Xe]+lr,$t=Me?(he[Ae]||[])[Xe]:he[pe];if(!(!$t||$t.t=="z"))if($t.t=="n")re(b,23,X(Ae,Xe,_e,$t.v));else{var zr=Vr($t);re(b,22,N(Ae,Xe,_e,zr.slice(0,239)))}}++_e}}return re(b,1),b.end()}function a(A){var G=V(2);return G.write_shift(2,A),G}function s(A){var G=V(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var z=0,b=0,Y=0,xe=0;xe<A.SheetNames.length;++xe){var _e=A.SheetNames[xe],he=A.Sheets[_e];if(!(!he||!he["!ref"])){++Y;var ae=jt(he["!ref"]);z<ae.e.r&&(z=ae.e.r),b<ae.e.c&&(b=ae.e.c)}}return z>8191&&(z=8191),G.write_shift(2,z),G.write_shift(1,Y),G.write_shift(1,b),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(A,G,z){var b={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&z.qpro?(b.s.c=A.read_shift(1),A.l++,b.s.r=A.read_shift(2),b.e.c=A.read_shift(1),A.l++,b.e.r=A.read_shift(2),b):(b.s.c=A.read_shift(2),b.s.r=A.read_shift(2),G==12&&z.qpro&&(A.l+=2),b.e.c=A.read_shift(2),b.e.r=A.read_shift(2),G==12&&z.qpro&&(A.l+=2),b.s.c==65535&&(b.s.c=b.e.c=b.s.r=b.e.r=0),b)}function c(A){var G=V(8);return G.write_shift(2,A.s.c),G.write_shift(2,A.s.r),G.write_shift(2,A.e.c),G.write_shift(2,A.e.r),G}function l(A,G,z){var b=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(b[0].c=A.read_shift(1),b[3]=A.read_shift(1),b[0].r=A.read_shift(2),A.l+=2):(b[2]=A.read_shift(1),b[0].c=A.read_shift(2),b[0].r=A.read_shift(2)),b}function f(A,G,z){var b=A.l+G,Y=l(A,G,z);if(Y[1].t="s",z.vers==20768){A.l++;var xe=A.read_shift(1);return Y[1].v=A.read_shift(xe,"utf8"),Y}return z.qpro&&A.l++,Y[1].v=A.read_shift(b-A.l,"cstr"),Y}function v(A,G,z){var b=V(7+z.length);b.write_shift(1,255),b.write_shift(2,G),b.write_shift(2,A),b.write_shift(1,39);for(var Y=0;Y<b.length;++Y){var xe=z.charCodeAt(Y);b.write_shift(1,xe>=128?95:xe)}return b.write_shift(1,0),b}function p(A,G,z){var b=l(A,G,z);return b[1].v=A.read_shift(2,"i"),b}function x(A,G,z){var b=V(7);return b.write_shift(1,255),b.write_shift(2,G),b.write_shift(2,A),b.write_shift(2,z,"i"),b}function w(A,G,z){var b=l(A,G,z);return b[1].v=A.read_shift(8,"f"),b}function h(A,G,z){var b=V(13);return b.write_shift(1,255),b.write_shift(2,G),b.write_shift(2,A),b.write_shift(8,z,"f"),b}function S(A,G,z){var b=A.l+G,Y=l(A,G,z);if(Y[1].v=A.read_shift(8,"f"),z.qpro)A.l=b;else{var xe=A.read_shift(2);H(A.slice(A.l,A.l+xe),Y),A.l+=xe}return Y}function D(A,G,z){var b=G&32768;return G&=-32769,G=(b?A:0)+(G>=8192?G-16384:G),(b?"":"$")+(z?_t(G):dt(G))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},P=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function H(A,G){Gt(A,0);for(var z=[],b=0,Y="",xe="",_e="",he="";A.l<A.length;){var ae=A[A.l++];switch(ae){case 0:z.push(A.read_shift(8,"f"));break;case 1:xe=D(G[0].c,A.read_shift(2),!0),Y=D(G[0].r,A.read_shift(2),!1),z.push(xe+Y);break;case 2:{var Me=D(G[0].c,A.read_shift(2),!0),ye=D(G[0].r,A.read_shift(2),!1);xe=D(G[0].c,A.read_shift(2),!0),Y=D(G[0].r,A.read_shift(2),!1),z.push(Me+ye+":"+xe+Y)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(A.read_shift(2));break;case 6:{for(var ct="";ae=A[A.l++];)ct+=String.fromCharCode(ae);z.push('"'+ct.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:he=z.pop(),_e=z.pop(),z.push(["AND","OR"][ae-20]+"("+_e+","+he+")");break;default:if(ae<32&&P[ae])he=z.pop(),_e=z.pop(),z.push(_e+P[ae]+he);else if(I[ae]){if(b=I[ae][1],b==69&&(b=A[A.l++]),b>z.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+z.join("|")+"|");return}var Ae=z.slice(-b);z.length-=b,z.push(I[ae][0]+"("+Ae.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}z.length==1?G[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function Z(A){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=A.read_shift(2),G[3]=A[A.l++],G[0].c=A[A.l++],G}function me(A,G){var z=Z(A,G);return z[1].t="s",z[1].v=A.read_shift(G-4,"cstr"),z}function N(A,G,z,b){var Y=V(6+b.length);Y.write_shift(2,A),Y.write_shift(1,z),Y.write_shift(1,G),Y.write_shift(1,39);for(var xe=0;xe<b.length;++xe){var _e=b.charCodeAt(xe);Y.write_shift(1,_e>=128?95:_e)}return Y.write_shift(1,0),Y}function q(A,G){var z=Z(A,G);z[1].v=A.read_shift(2);var b=z[1].v>>1;if(z[1].v&1)switch(b&7){case 0:b=(b>>3)*5e3;break;case 1:b=(b>>3)*500;break;case 2:b=(b>>3)/20;break;case 3:b=(b>>3)/200;break;case 4:b=(b>>3)/2e3;break;case 5:b=(b>>3)/2e4;break;case 6:b=(b>>3)/16;break;case 7:b=(b>>3)/64;break}return z[1].v=b,z}function W(A,G){var z=Z(A,G),b=A.read_shift(4),Y=A.read_shift(4),xe=A.read_shift(2);if(xe==65535)return b===0&&Y===3221225472?(z[1].t="e",z[1].v=15):b===0&&Y===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var _e=xe&32768;return xe=(xe&32767)-16446,z[1].v=(1-_e*2)*(Y*Math.pow(2,xe+32)+b*Math.pow(2,xe)),z}function X(A,G,z,b){var Y=V(14);if(Y.write_shift(2,A),Y.write_shift(1,z),Y.write_shift(1,G),b==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var xe=0,_e=0,he=0,ae=0;return b<0&&(xe=1,b=-b),_e=Math.log2(b)|0,b/=Math.pow(2,_e-31),ae=b>>>0,ae&2147483648||(b/=2,++_e,ae=b>>>0),b-=ae,ae|=2147483648,ae>>>=0,b*=Math.pow(2,32),he=b>>>0,Y.write_shift(4,he),Y.write_shift(4,ae),_e+=16383+(xe?32768:0),Y.write_shift(2,_e),Y}function J(A,G){var z=W(A,14);return A.l+=G-14,z}function Q(A,G){var z=Z(A,G),b=A.read_shift(4);return z[1].v=b>>6,z}function ve(A,G){var z=Z(A,G),b=A.read_shift(8,"f");return z[1].v=b,z}function Ne(A,G){var z=ve(A,14);return A.l+=G-10,z}function ge(A,G){return A[A.l+G-1]==0?A.read_shift(G,"cstr"):""}function et(A,G){var z=A[A.l++];z>G-1&&(z=G-1);for(var b="";b.length<z;)b+=String.fromCharCode(A[A.l++]);return b}function tt(A,G,z){if(!(!z.qpro||G<21)){var b=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var Y=A.read_shift(G-21,"cstr");return[b,Y]}}function At(A,G){for(var z={},b=A.l+G;A.l<b;){var Y=A.read_shift(2);if(Y==14e3){for(z[Y]=[0,""],z[Y][0]=A.read_shift(2);A[A.l];)z[Y][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return z}function wt(A,G){var z=V(5+A.length);z.write_shift(2,14e3),z.write_shift(2,G);for(var b=0;b<A.length;++b){var Y=A.charCodeAt(b);z[z.l++]=Y>127?95:Y}return z[z.l++]=0,z}var ot={0:{n:"BOF",f:dc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:w},15:{n:"LABEL",f},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:et},65535:{n:""}},bt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:me},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:J},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:At},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Q},38:{n:"??"},39:{n:"NUMBER27",f:ve},40:{n:"FORMULA28",f:Ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:tt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:r}}();var hd=/^\s|\s$|[\t\n\r]/;function _c(t,r){if(!r.bookSST)return"";var e=[Ze];e[e.length]=te("sst",null,{xmlns:di[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(hd)&&(a+=' xml:space="preserve"'),a+=">"+Le(i.t)+"</t>"),a+="</si>",e[e.length]=a}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function dd(t){return[t.read_shift(4),t.read_shift(4)]}function md(t,r){return r||(r=V(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var pd=ah;function xd(t){var r=Bt();K(r,159,md(t));for(var e=0;e<t.length;++e)K(r,19,pd(t[e]));return K(r,160),r.end()}function vd(t){if(typeof Ue<"u")return Ue.utils.encode(ui,t);for(var r=[],e=t.split(""),n=0;n<e.length;++n)r[n]=e[n].charCodeAt(0);return r}function Sc(t){var r=0,e,n=vd(t),i=n.length+1,a,s,o,c,l;for(e=En(i),e[0]=n.length,a=1;a!=i;++a)e[a]=n[a-1];for(a=i-1;a>=0;--a)s=e[a],o=r&16384?1:0,c=r<<1&32767,l=o|c,r=l^s;return r^52811}var gd=function(){function t(i,a){switch(a.type){case"base64":return r(Br(i),a);case"binary":return r(i,a);case"buffer":return r(Ie&&Buffer.isBuffer(i)?i.toString("binary"):Xi(i),a);case"array":return r(Pa(i),a)}throw new Error("Unrecognized type "+a.type)}function r(i,a){var s=a||{},o=s.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,v){Array.isArray(o)&&(o[v]=[]);for(var p=/\\\w+\b/g,x=0,w,h=-1;w=p.exec(f);){switch(w[0]){case"\\cell":var S=f.slice(x,p.lastIndex-w[0].length);if(S[0]==" "&&(S=S.slice(1)),++h,S.length){var D={v:S,t:"s"};Array.isArray(o)?o[v][h]=D:o[Re({r:v,c:h})]=D}break}x=p.lastIndex}h>l.e.c&&(l.e.c=h)}),o["!ref"]=Je(l),o}function e(i,a){return Cn(t(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=He(i["!ref"]),o,c=Array.isArray(i),l=s.s.r;l<=s.e.r;++l){a.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var v=Re({r:l,c:f});o=c?(i[l]||[])[f]:i[v],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Vr(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:n}}();function vo(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}var _d=6;var Mr=_d;function Ca(t){return Math.floor((t+Math.round(128/Mr)/256)*Mr)}function ya(t){return Math.floor((t-5)/Mr*100+.5)/100}function ls(t){return Math.round((t*Mr+5)/Mr*256)/256}function As(t){t.width?(t.wpx=Ca(t.width),t.wch=ya(t.wpx),t.MDW=Mr):t.wpx?(t.wch=ya(t.wpx),t.width=ls(t.wch),t.MDW=Mr):typeof t.wch=="number"&&(t.width=ls(t.wch),t.wpx=Ca(t.width),t.MDW=Mr),t.customWidth&&delete t.customWidth}var Sd=96,wc=Sd;function Fa(t){return t*96/wc}function Ec(t){return t*wc/96}function wd(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)t[n]!=null&&(r[r.length]=te("numFmt",null,{numFmtId:n,formatCode:Le(t[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=te("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Ed(t){var r=[];return r[r.length]=te("cellXfs",null),t.forEach(function(e){r[r.length]=te("xf",null,e)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=te("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Tc(t,r){var e=[Ze,te("styleSheet",null,{xmlns:di[0],"xmlns:vt":it.vt})],n;return t.SSF&&(n=wd(t.SSF))!=null&&(e[e.length]=n),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Ed(r.cellXfs))&&(e[e.length]=n),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function Td(t,r){var e=t.read_shift(2),n=St(t,r-2);return[e,n]}function kd(t,r,e){e||(e=V(6+4*r.length)),e.write_shift(2,t),st(r,e);var n=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),n}function Cd(t,r,e){var n={};n.sz=t.read_shift(2)/20;var i=hh(t,2,e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(n.underline=s);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=uh(t,8),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=St(t,r-21),n}function yd(t,r){r||(r=V(25+4*32)),r.write_shift(2,t.sz*20),dh(t,r),r.write_shift(2,t.bold?700:400);var e=0;t.vertAlign=="superscript"?e=1:t.vertAlign=="subscript"&&(e=2),r.write_shift(2,e),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),Ta(t.color,r);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),r.write_shift(1,n),st(t.name,r),r.length>r.l?r.slice(0,r.l):r}var Fd=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rs,Ad=br;function go(t,r){r||(r=V(4*3+8*7+16*1)),rs||(rs=hs(Fd));var e=rs[t.patternType];e==null&&(e=40),r.write_shift(4,e);var n=0;if(e!=40)for(Ta({auto:1},r),Ta({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function bd(t,r){var e=t.l+r,n=t.read_shift(2),i=t.read_shift(2);return t.l=e,{ixfe:n,numFmtId:i}}function kc(t,r,e){e||(e=V(16)),e.write_shift(2,r||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var n=0;return e.write_shift(1,n),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function Di(t,r){return r||(r=V(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var zd=br;function Dd(t,r){return r||(r=V(51)),r.write_shift(1,0),Di(null,r),Di(null,r),Di(null,r),Di(null,r),Di(null,r),r.length>r.l?r.slice(0,r.l):r}function Id(t,r){return r||(r=V(12+4*10)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,+t.builtinId),r.write_shift(1,0),Ea(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function Nd(t,r,e){var n=V(2052);return n.write_shift(4,t),Ea(r,n),Ea(e,n),n.length>n.l?n.slice(0,n.l):n}function Pd(t,r){if(r){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&++e}),e!=0&&(K(t,615,xr(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&K(t,44,kd(i,r[i]))}),K(t,616))}}function Od(t){var r=1;r!=0&&(K(t,611,xr(r)),K(t,43,yd({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),K(t,612))}function Ld(t){var r=2;r!=0&&(K(t,603,xr(r)),K(t,45,go({patternType:"none"})),K(t,45,go({patternType:"gray125"})),K(t,604))}function Rd(t){var r=1;r!=0&&(K(t,613,xr(r)),K(t,46,Dd({})),K(t,614))}function Md(t){var r=1;K(t,626,xr(r)),K(t,47,kc({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),K(t,627)}function Bd(t,r){K(t,617,xr(r.length)),r.forEach(function(e){K(t,47,kc(e,0))}),K(t,618)}function Vd(t){var r=1;K(t,619,xr(r)),K(t,48,Id({xfId:0,builtinId:0,name:"Normal"})),K(t,620)}function Ud(t){var r=0;K(t,505,xr(r)),K(t,506)}function Wd(t){var r=0;K(t,508,Nd(r,"TableStyleMedium9","PivotStyleMedium4")),K(t,509)}function Hd(t,r){var e=Bt();return K(e,278),Pd(e,t.SSF),Od(e,t),Ld(e,t),Rd(e,t),Md(e,t),Bd(e,r.cellXfs),Vd(e,t),Ud(e,t),Wd(e,t),K(e,279),e.end()}function Cc(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var e=[Ze];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function Gd(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:St(t,r-8)}}function Xd(t){var r=V(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),st(t.name,r),r.slice(0,r.l)}function jd(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function $d(t){var r=V(4+8*t.length);r.write_shift(4,t.length);for(var e=0;e<t.length;++e)r.write_shift(4,t[e][0]),r.write_shift(4,t[e][1]);return r}function qd(t,r){var e=V(8+2*r.length);return e.write_shift(4,t),st(r,e),e.slice(0,e.l)}function Kd(t){return t.l+=4,t.read_shift(4)!=0}function Yd(t,r){var e=V(8);return e.write_shift(4,t),e.write_shift(4,r?1:0),e}function Jd(){var t=Bt();return K(t,332),K(t,334,xr(1)),K(t,335,Xd({name:"XLDAPR",version:12e4,flags:3496657072})),K(t,336),K(t,339,qd(1,"XLDAPR")),K(t,52),K(t,35,xr(514)),K(t,4096,xr(0)),K(t,4097,or(1)),K(t,36),K(t,53),K(t,340),K(t,337,Yd(1,!0)),K(t,51,$d([[1,0]])),K(t,338),K(t,333),t.end()}function yc(){var t=[Ze];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Zd(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=Re(e);var n=t.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}var ai=1024;function Fc(t,r){for(var e=[21600,21600],n=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),i=[te("xml",null,{"xmlns:v":Xt.v,"xmlns:o":Xt.o,"xmlns:x":Xt.x,"xmlns:mv":Xt.mv}).replace(/\/>/,">"),te("o:shapelayout",te("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),te("v:shapetype",[te("v:stroke",null,{joinstyle:"miter"}),te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:n})];ai<t*1e3;)ai+=1e3;return r.forEach(function(a){var s=at(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=te("v:fill",c,o),f={on:"t",obscured:"t"};++ai,i=i.concat(["<v:shape"+Wi({id:"_x0000_s"+ai,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,te("v:shadow",null,f),te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ht("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),ht("x:AutoFill","False"),ht("x:Row",String(s.r)),ht("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Ac(t){var r=[Ze,te("comments",null,{xmlns:di[0]})],e=[];return r.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var a=Le(i.a);e.indexOf(a)==-1&&(e.push(a),r.push("<author>"+a+"</author>")),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),r.push("<author>tc="+i.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=e.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=e.indexOf(Le(c.a))),a.push(c.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)r.push(ht("t",Le(a[0]||"")));else{for(var s=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)s+=`Reply:
    `+a[o]+`
`;r.push(ht("t",Le(s)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Qd(t,r,e){var n=[Ze,te("ThreadedComments",null,{xmlns:it.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var a="";(i[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&r.indexOf(s.a)==-1&&r.push(s.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(s.a)).slice(-12)+"}"),n.push(te("threadedComment",ht("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function em(t){var r=[Ze,te("personList",null,{xmlns:it.TCMNT,"xmlns:x":di[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,n){r.push(te("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}function tm(t){var r={};r.iauthor=t.read_shift(4);var e=bn(t,16);return r.rfx=e.s,r.ref=Re(e.s),t.l+=16,r}function rm(t,r){return r==null&&(r=V(36)),r.write_shift(4,t[1].iauthor),xi(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var nm=St;function im(t){return st(t.slice(0,54))}function am(t){var r=Bt(),e=[];return K(r,628),K(r,630),t.forEach(function(n){n[1].forEach(function(i){e.indexOf(i.a)>-1||(e.push(i.a.slice(0,54)),K(r,632,im(i.a)))})}),K(r,631),K(r,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=e.indexOf(i.a);var a={s:at(n[0]),e:at(n[0])};K(r,635,rm([a,i])),i.t&&i.t.length>0&&K(r,637,oh(i)),K(r,636),delete i.iauthor})}),K(r,634),K(r,629),r.end()}function sm(t,r){r.FullPaths.forEach(function(e,n){if(n!=0){var i=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ve.utils.cfb_add(t,i,r.FileIndex[n].content)}})}var bc=["xlsb","xlsm","xlam","biff8","xla"];var om=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(n,i,a,s){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var l=a.length>0?parseInt(a,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=r.c:--f,c?l+=r.r:--l,i+(o?"":"$")+_t(f)+(c?"":"$")+dt(l)}return function(i,a){return r=a,i.replace(t,e)}}(),bs=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zs=function(){return function(r,e){return r.replace(bs,function(n,i,a,s,o,c){var l=Ts(s)-(a?0:e.c),f=Es(c)-(o?0:e.r),v=f==0?"":o?f+1:"["+f+"]",p=l==0?"":a?l+1:"["+l+"]";return i+"R"+v+"C"+p})}}();function cm(t,r){return t.replace(bs,function(e,n,i,a,s,o){return n+(i=="$"?i+a:_t(Ts(a)+r.c))+(s=="$"?s+o:dt(Es(o)+r.r))})}function lm(t){return t.length!=1}function Ye(t){t.l+=1}function cn(t,r){var e=t.read_shift(r==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function zc(t,r,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return Dc(t,r,e);e.biff==12&&(n=4)}var i=t.read_shift(n),a=t.read_shift(n),s=cn(t,2),o=cn(t,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Dc(t){var r=cn(t,2),e=cn(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function fm(t,r,e){if(e.biff<8)return Dc(t,r,e);var n=t.read_shift(e.biff==12?4:2),i=t.read_shift(e.biff==12?4:2),a=cn(t,2),s=cn(t,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function Ic(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return um(t,r,e);var n=t.read_shift(e&&e.biff==12?4:2),i=cn(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function um(t){var r=cn(t,2),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function hm(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function dm(t,r,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return mm(t,r,e);var i=t.read_shift(n>=12?4:2),a=t.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function mm(t){var r=t.read_shift(2),e=t.read_shift(1),n=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),i==1&&e>=128&&(e=e-256),{r,c:e,cRel:i,rRel:n}}function pm(t,r,e){var n=(t[t.l++]&96)>>5,i=zc(t,e.biff>=2&&e.biff<=5?6:8,e);return[n,i]}function xm(t,r,e){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var s=zc(t,a,e);return[n,i,s]}function vm(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function gm(t,r,e){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,i]}function _m(t,r,e){var n=(t[t.l++]&96)>>5,i=fm(t,r-1,e);return[n,i]}function Sm(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[n]}function _o(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function wm(t,r,e){t.l+=2;for(var n=t.read_shift(e&&e.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(t.read_shift(e&&e.biff==2?1:2));return i}function Em(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function Tm(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function km(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function Cm(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[n]}function Nc(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function ym(t){return t.read_shift(2),Nc(t,2)}function Fm(t){return t.read_shift(2),Nc(t,2)}function Am(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=Ic(t,0,e);return[n,i]}function bm(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=dm(t,0,e);return[n,i]}function zm(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var a=Ic(t,0,e);return[n,i,a]}function Dm(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(e&&e.biff<=3?1:2);return[D1[i],Lc[i],n]}function Im(t,r,e){var n=t[t.l++],i=t.read_shift(1),a=e&&e.biff<=3?[n==88?-1:0,t.read_shift(1)]:Nm(t);return[i,(a[0]===0?Lc:z1)[a[1]]]}function Nm(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Pm(t,r,e){t.l+=e&&e.biff==2?3:4}function Om(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(e&&e.biff==2?1:2);return[n,i]}function Lm(t){return t.l++,$i[t.read_shift(1)]}function Rm(t){return t.l++,t.read_shift(2)}function Mm(t){return t.l++,t.read_shift(1)!==0}function Bm(t){return t.l++,vi(t,8)}function Vm(t,r,e){return t.l++,pc(t,r-1,e)}function Um(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=zh(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=$i[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=vi(t,8);break;case 2:e[1]=Ph(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function Wm(t,r,e){for(var n=t.read_shift(e.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((e.biff==12?bn:Rh)(t,8));return i}function Hm(t,r,e){var n=0,i=0;e.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=Um(t,e.biff);return s}function Gm(t,r,e){var n=t.read_shift(1)>>>5&3,i=!e||e.biff>=8?4:2,a=t.read_shift(i);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function Xm(t,r,e){if(e.biff==5)return jm(t,r,e);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),a=t.read_shift(4);return[n,i,a]}function jm(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[r,e,n]}function $m(t,r,e){var n=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var i=t.read_shift(e&&e.biff==2?1:2);return[n,i]}function qm(t,r,e){var n=t.read_shift(1)>>>5&3,i=t.read_shift(e&&e.biff==2?1:2);return[n,i]}function Km(t,r,e){var n=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[n]}function Ym(t,r,e){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=4;if(e)switch(e.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,i]}var Jm=br,Zm=br,Qm=br;function qi(t,r,e){return t.l+=2,[hm(t,4,e)]}function Ds(t){return t.l+=6,[]}var e1=qi,t1=Ds,r1=Ds,n1=qi;function Pc(t){return t.l+=2,[dc(t),t.read_shift(2)&1]}var i1=qi,a1=Pc,s1=Ds,o1=qi,c1=qi,l1=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function f1(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),a=t.read_shift(2),s=l1[e>>2&31];return{ixti:r,coltype:e&3,rt:s,idx:n,c:i,C:a}}function u1(t){return t.l+=2,[t.read_shift(4)]}function h1(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function d1(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function m1(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function p1(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function x1(t){return t.l+=4,[0,0]}var So={1:{n:"PtgExp",f:Om},2:{n:"PtgTbl",f:Qm},3:{n:"PtgAdd",f:Ye},4:{n:"PtgSub",f:Ye},5:{n:"PtgMul",f:Ye},6:{n:"PtgDiv",f:Ye},7:{n:"PtgPower",f:Ye},8:{n:"PtgConcat",f:Ye},9:{n:"PtgLt",f:Ye},10:{n:"PtgLe",f:Ye},11:{n:"PtgEq",f:Ye},12:{n:"PtgGe",f:Ye},13:{n:"PtgGt",f:Ye},14:{n:"PtgNe",f:Ye},15:{n:"PtgIsect",f:Ye},16:{n:"PtgUnion",f:Ye},17:{n:"PtgRange",f:Ye},18:{n:"PtgUplus",f:Ye},19:{n:"PtgUminus",f:Ye},20:{n:"PtgPercent",f:Ye},21:{n:"PtgParen",f:Ye},22:{n:"PtgMissArg",f:Ye},23:{n:"PtgStr",f:Vm},26:{n:"PtgSheet",f:h1},27:{n:"PtgEndSheet",f:d1},28:{n:"PtgErr",f:Lm},29:{n:"PtgBool",f:Mm},30:{n:"PtgInt",f:Rm},31:{n:"PtgNum",f:Bm},32:{n:"PtgArray",f:Sm},33:{n:"PtgFunc",f:Dm},34:{n:"PtgFuncVar",f:Im},35:{n:"PtgName",f:Gm},36:{n:"PtgRef",f:Am},37:{n:"PtgArea",f:pm},38:{n:"PtgMemArea",f:$m},39:{n:"PtgMemErr",f:Jm},40:{n:"PtgMemNoMem",f:Zm},41:{n:"PtgMemFunc",f:qm},42:{n:"PtgRefErr",f:Km},43:{n:"PtgAreaErr",f:vm},44:{n:"PtgRefN",f:bm},45:{n:"PtgAreaN",f:_m},46:{n:"PtgMemAreaN",f:m1},47:{n:"PtgMemNoMemN",f:p1},57:{n:"PtgNameX",f:Xm},58:{n:"PtgRef3d",f:zm},59:{n:"PtgArea3d",f:xm},60:{n:"PtgRefErr3d",f:Ym},61:{n:"PtgAreaErr3d",f:gm},255:{}},v1={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},g1={1:{n:"PtgElfLel",f:Pc},2:{n:"PtgElfRw",f:o1},3:{n:"PtgElfCol",f:e1},6:{n:"PtgElfRwV",f:c1},7:{n:"PtgElfColV",f:n1},10:{n:"PtgElfRadical",f:i1},11:{n:"PtgElfRadicalS",f:s1},13:{n:"PtgElfColS",f:t1},15:{n:"PtgElfColSV",f:r1},16:{n:"PtgElfRadicalLel",f:a1},25:{n:"PtgList",f:f1},29:{n:"PtgSxName",f:u1},255:{}},_1={0:{n:"PtgAttrNoop",f:x1},1:{n:"PtgAttrSemi",f:Cm},2:{n:"PtgAttrIf",f:Tm},4:{n:"PtgAttrChoose",f:wm},8:{n:"PtgAttrGoto",f:Em},16:{n:"PtgAttrSum",f:Pm},32:{n:"PtgAttrBaxcel",f:_o},33:{n:"PtgAttrBaxcel",f:_o},64:{n:"PtgAttrSpace",f:ym},65:{n:"PtgAttrSpaceSemi",f:Fm},128:{n:"PtgAttrIfError",f:km},255:{}};function S1(t,r,e,n){if(n.biff<8)return br(t,r);for(var i=t.l+r,a=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=Hm(t,0,n),a.push(e[s][1]);break;case"PtgMemArea":e[s][2]=Wm(t,e[s][1],n),a.push(e[s][2]);break;case"PtgExp":n&&n.biff==12&&(e[s][1][1]=t.read_shift(4),a.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0];default:break}return r=i-t.l,r!==0&&a.push(br(t,r)),a}function w1(t,r,e){for(var n=t.l+r,i,a,s=[];n!=t.l;)r=n-t.l,a=t[t.l],i=So[a]||So[v1[a]],(a===24||a===25)&&(i=(a===24?g1:_1)[t[t.l+1]]),!i||!i.f?br(t,r):s.push([i.n,i.f(t,r,e)]);return s}function E1(t){for(var r=[],e=0;e<t.length;++e){for(var n=t[e],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var T1={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function k1(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Oc(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(e.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function wo(t,r,e){var n=Oc(t,r,e);return n=="#REF"?n:k1(n,e)}function hi(t,r,e,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,f,v=0,p=0,x,w="";if(!t[0]||!t[0][0])return"";for(var h=-1,S="",D=0,I=t[0].length;D<I;++D){var P=t[0][D];switch(P[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),h>=0){switch(t[0][h][1][0]){case 0:S=je(" ",t[0][h][1][1]);break;case 1:S=je("\r",t[0][h][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][h][1][0])}l=l+S,h=-1}o.push(l+T1[P[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Oi(P[1][1],s,i),o.push(Li(f,a));break;case"PtgRefN":f=e?Oi(P[1][1],e,i):P[1][1],o.push(Li(f,a));break;case"PtgRef3d":v=P[1][1],f=Oi(P[1][2],s,i),w=wo(n,v,i);var H=w;o.push(w+"!"+Li(f,a));break;case"PtgFunc":case"PtgFuncVar":var Z=P[1][0],me=P[1][1];Z||(Z=0),Z&=127;var N=Z==0?[]:o.slice(-Z);o.length-=Z,me==="User"&&(me=N.shift()),o.push(me+"("+N.join(",")+")");break;case"PtgBool":o.push(P[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(P[1]);break;case"PtgNum":o.push(String(P[1]));break;case"PtgStr":o.push('"'+P[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(P[1]);break;case"PtgAreaN":x=io(P[1][1],e?{s:e}:s,i),o.push(es(x,i));break;case"PtgArea":x=io(P[1][1],s,i),o.push(es(x,i));break;case"PtgArea3d":v=P[1][1],x=P[1][2],w=wo(n,v,i),o.push(w+"!"+es(x,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=P[1][2];var q=(n.names||[])[p-1]||(n[0]||[])[p],W=q?q.Name:"SH33TJSNAME"+String(p);W&&W.slice(0,6)=="_xlfn."&&!i.xlfn&&(W=W.slice(6)),o.push(W);break;case"PtgNameX":var X=P[1][1];p=P[1][2];var J;if(i.biff<=5)X<0&&(X=-X),n[X]&&(J=n[X][p]);else{var Q="";if(((n[X]||[])[0]||[])[0]==14849||(((n[X]||[])[0]||[])[0]==1025?n[X][p]&&n[X][p].itab>0&&(Q=n.SheetNames[n[X][p].itab-1]+"!"):Q=n.SheetNames[p-1]+"!"),n[X]&&n[X][p])Q+=n[X][p].Name;else if(n[0]&&n[0][p])Q+=n[0][p].Name;else{var ve=(Oc(n,X,i)||"").split(";;");ve[p-1]?Q=ve[p-1]:Q+="SH33TJSERRX"}o.push(Q);break}J||(J={Name:"SH33TJSERRY"}),o.push(J.Name);break;case"PtgParen":var Ne="(",ge=")";if(h>=0){switch(S="",t[0][h][1][0]){case 2:Ne=je(" ",t[0][h][1][1])+Ne;break;case 3:Ne=je("\r",t[0][h][1][1])+Ne;break;case 4:ge=je(" ",t[0][h][1][1])+ge;break;case 5:ge=je("\r",t[0][h][1][1])+ge;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][h][1][0])}h=-1}o.push(Ne+o.pop()+ge);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:P[1][1],r:P[1][0]};var et={c:e.c,r:e.r};if(n.sharedf[Re(f)]){var tt=n.sharedf[Re(f)];o.push(hi(tt,s,et,n,i))}else{var At=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(hi(l[1],s,et,n,i)),At=!0;break}At||o.push(P[1])}break;case"PtgArray":o.push("{"+E1(P[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=D;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+P[1].idx+"[#"+P[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(P));default:throw new Error("Unrecognized Formula Token: "+String(P))}var wt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&h>=0&&wt.indexOf(t[0][D][0])==-1){P=t[0][h];var ot=!0;switch(P[1][0]){case 4:ot=!1;case 0:S=je(" ",P[1][1]);break;case 5:ot=!1;case 1:S=je("\r",P[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+P[1][0])}o.push((ot?S:"")+o.pop()+(ot?"":S)),h=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function C1(t){if(t==null){var r=V(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return Tn(t);return Tn(0)}function y1(t,r,e,n,i){var a=kn(r,e,i),s=C1(t.v),o=V(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=V(t.bf.length),f=0;f<t.bf.length;++f)l[f]=t.bf[f];var v=ut([a,s,o,l]);return v}function La(t,r,e){var n=t.read_shift(4),i=w1(t,n,e),a=t.read_shift(4),s=a>0?S1(t,a,i,e):null;return[i,s]}var F1=La,Ra=La,A1=La,b1=La,z1={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Lc={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},D1={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function I1(t){var r="of:="+t.replace(bs,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function N1(t){return t.replace(/\./,"!")}var Ri=typeof Map<"u";function Is(t,r,e){var n=0,i=t.length;if(e){if(Ri?e.has(r):Object.prototype.hasOwnProperty.call(e,r)){for(var a=Ri?e.get(r):e[r];n<a.length;++n)if(t[a[n]].t===r)return t.Count++,a[n]}}else for(;n<i;++n)if(t[n].t===r)return t.Count++,n;return t[i]={t:r},t.Count++,t.Unique++,e&&(Ri?(e.has(r)||e.set(r,[]),e.get(r).push(i)):(Object.prototype.hasOwnProperty.call(e,r)||(e[r]=[]),e[r].push(i))),i}function Ma(t,r){var e={min:t+1,max:t+1},n=-1;return r.MDW&&(Mr=r.MDW),r.width!=null?e.customWidth=1:r.wpx!=null?n=ya(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(e.width=ls(n),e.customWidth=1):r.width!=null&&(e.width=r.width),r.hidden&&(e.hidden=!0),r.level!=null&&(e.outlineLevel=e.level=r.level),e}function Rc(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function fn(t,r,e){var n=e.revssf[r.z!=null?r.z:"General"],i=60,a=t.length;if(n==null&&e.ssf){for(;i<392;++i)if(e.ssf[i]==null){Ro(r.z,i),e.ssf[i]=r.z,e.revssf[r.z]=n=i;break}}for(i=0;i!=a;++i)if(t[i].numFmtId===n)return i;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function P1(t,r,e){if(t&&t["!ref"]){var n=He(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}function O1(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)r+='<mergeCell ref="'+Je(t[e])+'"/>';return r+"</mergeCells>"}function L1(t,r,e,n,i){var a=!1,s={},o=null;if(n.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[e];try{r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}a=!0,s.codeName=Or(Le(c))}if(t&&t["!outline"]){var l={summaryBelow:1,summaryRight:1};t["!outline"].above&&(l.summaryBelow=0),t["!outline"].left&&(l.summaryRight=0),o=(o||"")+te("outlinePr",null,l)}!a&&!o||(i[i.length]=te("sheetPr",o,s))}var R1=["objects","scenarios","selectLockedCells","selectUnlockedCells"],M1=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function B1(t){var r={sheet:1};return R1.forEach(function(e){t[e]!=null&&t[e]&&(r[e]="1")}),M1.forEach(function(e){t[e]!=null&&!t[e]&&(r[e]="0")}),t.password&&(r.password=Sc(t.password).toString(16).toUpperCase()),te("sheetProtection",null,r)}function V1(t){return Rc(t),te("pageMargins",null,t)}function U1(t,r){for(var e=["<cols>"],n,i=0;i!=r.length;++i)(n=r[i])&&(e[e.length]=te("col",null,Ma(i,n)));return e[e.length]="</cols>",e.join("")}function W1(t,r,e,n){var i=typeof t.ref=="string"?t.ref:Je(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,s=jt(i);s.s.r==s.e.r&&(s.e.r=jt(r["!ref"]).e.r,i=Je(s));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+e.SheetNames[n]+"'!"+i;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+i}),te("autoFilter",null,{ref:i})}function H1(t,r,e,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),te("sheetViews",te("sheetView",null,i),{})}function G1(t,r,e,n){if(t.c&&e["!comments"].push([r,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",a=t.t,s=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=$i[t.v];break;case"d":n&&n.cellDates?i=Ft(t.v,-1).toISOString():(t=Ut(t),t.t="n",i=""+(t.v=Vt(Ft(t.v)))),typeof t.z>"u"&&(t.z=$e[14]);break;default:i=t.v;break}var o=ht("v",Le(i)),c={r},l=fn(n.cellXfs,t,n);switch(l!==0&&(c.s=l),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ht("v",""+Is(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=a&&(t.t=a,t.v=s),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;o=te("f",Le(t.f),f)+(t.v!=null?o:"")}return t.l&&e["!links"].push([r,t.l]),t.D&&(c.cm=1),te("c",o,c)}function X1(t,r,e,n){var i=[],a=[],s=He(t["!ref"]),o="",c,l="",f=[],v=0,p=0,x=t["!rows"],w=Array.isArray(t),h={r:l},S,D=-1;for(p=s.s.c;p<=s.e.c;++p)f[p]=_t(p);for(v=s.s.r;v<=s.e.r;++v){for(a=[],l=dt(v),p=s.s.c;p<=s.e.c;++p){c=f[p]+l;var I=w?(t[v]||[])[p]:t[c];I!==void 0&&(o=G1(I,c,t,r,e,n))!=null&&a.push(o)}(a.length>0||x&&x[v])&&(h={r:l},x&&x[v]&&(S=x[v],S.hidden&&(h.hidden=1),D=-1,S.hpx?D=Fa(S.hpx):S.hpt&&(D=S.hpt),D>-1&&(h.ht=D,h.customHeight=1),S.level&&(h.outlineLevel=S.level)),i[i.length]=te("row",a.join(""),h))}if(x)for(;v<x.length;++v)x&&x[v]&&(h={r:v+1},S=x[v],S.hidden&&(h.hidden=1),D=-1,S.hpx?D=Fa(S.hpx):S.hpt&&(D=S.hpt),D>-1&&(h.ht=D,h.customHeight=1),S.level&&(h.outlineLevel=S.level),i[i.length]=te("row","",h));return i.join("")}function Mc(t,r,e,n){var i=[Ze,te("worksheet",null,{xmlns:di[0],"xmlns:r":it.r})],a=e.SheetNames[t],s=0,o="",c=e.Sheets[a];c==null&&(c={});var l=c["!ref"]||"A1",f=He(l);if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),l=Je(f)}n||(n={}),c["!comments"]=[];var v=[];L1(c,e,t,r,i),i[i.length]=te("dimension",null,{ref:l}),i[i.length]=H1(c,r,t,e),r.sheetFormat&&(i[i.length]=te("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=U1(c,c["!cols"])),i[s=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=X1(c,r,t,e,n),o.length>0&&(i[i.length]=o)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),c["!protect"]&&(i[i.length]=B1(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=W1(c["!autofilter"],c,e,t)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=O1(c["!merges"]));var p=-1,x,w=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(h){h[1].Target&&(x={ref:h[0]},h[1].Target.charAt(0)!="#"&&(w=Oe(n,-1,Le(h[1].Target).replace(/#.*$/,""),ze.HLINK),x["r:id"]="rId"+w),(p=h[1].Target.indexOf("#"))>-1&&(x.location=Le(h[1].Target.slice(p+1))),h[1].Tooltip&&(x.tooltip=Le(h[1].Tooltip)),i[i.length]=te("hyperlink",null,x))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=V1(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(i[i.length]=ht("ignoredErrors",te("ignoredError",null,{numberStoredAsText:1,sqref:l}))),v.length>0&&(w=Oe(n,-1,"../drawings/drawing"+(t+1)+".xml",ze.DRAW),i[i.length]=te("drawing",null,{"r:id":"rId"+w}),c["!drawing"]=v),c["!comments"].length>0&&(w=Oe(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ze.VML),i[i.length]=te("legacyDrawing",null,{"r:id":"rId"+w}),c["!legacy"]=w),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function j1(t,r){var e={},n=t.l+r;e.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(e.level=a&7),a&16&&(e.hidden=!0),a&32&&(e.hpt=i/20),e}function $1(t,r,e){var n=V(145),i=(e["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;i.hpx?a=Fa(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r:t,c:0},f=0;f<16;++f)if(!(r.s.c>f+1<<10||r.e.c<f<<10)){for(var v=-1,p=-1,x=f<<10;x<f+1<<10;++x){l.c=x;var w=Array.isArray(e)?(e[l.r]||[])[l.c]:e[Re(l)];w&&(v<0&&(v=x),p=x)}v<0||(++o,n.write_shift(4,v),n.write_shift(4,p))}var h=n.l;return n.l=c,n.write_shift(4,o),n.l=h,n.length>n.l?n.slice(0,n.l):n}function q1(t,r,e,n){var i=$1(n,e,r);(i.length>17||(r["!rows"]||[])[n])&&K(t,0,i)}var K1=bn,Y1=xi;function J1(){}function Z1(t,r){var e={},n=t[t.l];return++t.l,e.above=!(n&64),e.left=!(n&128),t.l+=18,e.name=ch(t,r-19),e}function Q1(t,r,e){e==null&&(e=V(84+4*t.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),e.write_shift(1,n);for(var i=1;i<3;++i)e.write_shift(1,0);return Ta({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),Qo(t,e),e.slice(0,e.l)}function ep(t){var r=cr(t);return[r]}function tp(t,r,e){return e==null&&(e=V(8)),yn(r,e)}function rp(t){var r=Fn(t);return[r]}function np(t,r,e){return e==null&&(e=V(4)),An(r,e)}function ip(t){var r=cr(t),e=t.read_shift(1);return[r,e,"b"]}function ap(t,r,e){return e==null&&(e=V(9)),yn(r,e),e.write_shift(1,t.v?1:0),e}function sp(t){var r=Fn(t),e=t.read_shift(1);return[r,e,"b"]}function op(t,r,e){return e==null&&(e=V(5)),An(r,e),e.write_shift(1,t.v?1:0),e}function cp(t){var r=cr(t),e=t.read_shift(1);return[r,e,"e"]}function lp(t,r,e){return e==null&&(e=V(9)),yn(r,e),e.write_shift(1,t.v),e}function fp(t){var r=Fn(t),e=t.read_shift(1);return[r,e,"e"]}function up(t,r,e){return e==null&&(e=V(8)),An(r,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}function hp(t){var r=cr(t),e=t.read_shift(4);return[r,e,"s"]}function dp(t,r,e){return e==null&&(e=V(12)),yn(r,e),e.write_shift(4,r.v),e}function mp(t){var r=Fn(t),e=t.read_shift(4);return[r,e,"s"]}function pp(t,r,e){return e==null&&(e=V(8)),An(r,e),e.write_shift(4,r.v),e}function xp(t){var r=cr(t),e=vi(t);return[r,e,"n"]}function vp(t,r,e){return e==null&&(e=V(16)),yn(r,e),Tn(t.v,e),e}function gp(t){var r=Fn(t),e=vi(t);return[r,e,"n"]}function _p(t,r,e){return e==null&&(e=V(12)),An(r,e),Tn(t.v,e),e}function Sp(t){var r=cr(t),e=ec(t);return[r,e,"n"]}function wp(t,r,e){return e==null&&(e=V(12)),yn(r,e),tc(t.v,e),e}function Ep(t){var r=Fn(t),e=ec(t);return[r,e,"n"]}function Tp(t,r,e){return e==null&&(e=V(8)),An(r,e),tc(t.v,e),e}function kp(t){var r=cr(t),e=ks(t);return[r,e,"is"]}function Cp(t){var r=cr(t),e=St(t);return[r,e,"str"]}function yp(t,r,e){return e==null&&(e=V(12+4*t.v.length)),yn(r,e),st(t.v,e),e.length>e.l?e.slice(0,e.l):e}function Fp(t){var r=Fn(t),e=St(t);return[r,e,"str"]}function Ap(t,r,e){return e==null&&(e=V(8+4*t.v.length)),An(r,e),st(t.v,e),e.length>e.l?e.slice(0,e.l):e}function bp(t,r,e){var n=t.l+r,i=cr(t);i.r=e["!row"];var a=t.read_shift(1),s=[i,a,"b"];if(e.cellFormula){t.l+=2;var o=Ra(t,n-t.l,e);s[3]=hi(o,null,i,e.supbooks,e)}else t.l=n;return s}function zp(t,r,e){var n=t.l+r,i=cr(t);i.r=e["!row"];var a=t.read_shift(1),s=[i,a,"e"];if(e.cellFormula){t.l+=2;var o=Ra(t,n-t.l,e);s[3]=hi(o,null,i,e.supbooks,e)}else t.l=n;return s}function Dp(t,r,e){var n=t.l+r,i=cr(t);i.r=e["!row"];var a=vi(t),s=[i,a,"n"];if(e.cellFormula){t.l+=2;var o=Ra(t,n-t.l,e);s[3]=hi(o,null,i,e.supbooks,e)}else t.l=n;return s}function Ip(t,r,e){var n=t.l+r,i=cr(t);i.r=e["!row"];var a=St(t),s=[i,a,"str"];if(e.cellFormula){t.l+=2;var o=Ra(t,n-t.l,e);s[3]=hi(o,null,i,e.supbooks,e)}else t.l=n;return s}var Np=bn,Pp=xi;function Op(t,r){return r==null&&(r=V(4)),r.write_shift(4,t),r}function Lp(t,r){var e=t.l+r,n=bn(t,16),i=Cs(t),a=St(t),s=St(t),o=St(t);t.l=e;var c={rfx:n,relId:i,loc:a,display:o};return s&&(c.Tooltip=s),c}function Rp(t,r){var e=V(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));xi({s:at(t[0]),e:at(t[0])},e),ys("rId"+r,e);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return st(i||"",e),st(t[1].Tooltip||"",e),st("",e),e.slice(0,e.l)}function Mp(){}function Bp(t,r,e){var n=t.l+r,i=rc(t,16),a=t.read_shift(1),s=[i];if(s[2]=a,e.cellFormula){var o=F1(t,n-t.l,e);s[1]=o}else t.l=n;return s}function Vp(t,r,e){var n=t.l+r,i=bn(t,16),a=[i];if(e.cellFormula){var s=b1(t,n-t.l,e);a[1]=s,t.l=n}else t.l=n;return a}function Up(t,r,e){e==null&&(e=V(18));var n=Ma(t,r);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,(n.width||10)*256),e.write_shift(4,0);var i=0;return r.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),r.level&&(i|=r.level<<8),e.write_shift(2,i),e}var Bc=["left","right","top","bottom","header","footer"];function Wp(t){var r={};return Bc.forEach(function(e){r[e]=vi(t,8)}),r}function Hp(t,r){return r==null&&(r=V(6*8)),Rc(t),Bc.forEach(function(e){Tn(t[e],r)}),r}function Gp(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function Xp(t,r,e){e==null&&(e=V(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function jp(t){var r=V(24);return r.write_shift(4,4),r.write_shift(4,1),xi(t,r),r}function $p(t,r){return r==null&&(r=V(16*4+2)),r.write_shift(2,t.password?Sc(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,t[e[0]]!=null&&!t[e[0]]?1:0):r.write_shift(4,t[e[0]]!=null&&t[e[0]]?0:1)}),r}function qp(){}function Kp(){}function Yp(t,r,e,n,i,a,s){if(r.v===void 0)return!1;var o="";switch(r.t){case"b":o=r.v?"1":"0";break;case"d":r=Ut(r),r.z=r.z||$e[14],r.v=Vt(Ft(r.v)),r.t="n";break;case"n":case"e":o=""+r.v;break;default:o=r.v;break}var c={r:e,c:n};switch(c.s=fn(i.cellXfs,r,i),r.l&&a["!links"].push([Re(c),r.l]),r.c&&a["!comments"].push([Re(c),r.c]),r.t){case"s":case"str":return i.bookSST?(o=Is(i.Strings,r.v,i.revStrings),c.t="s",c.v=o,s?K(t,18,pp(r,c)):K(t,7,dp(r,c))):(c.t="str",s?K(t,17,Ap(r,c)):K(t,6,yp(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?s?K(t,13,Tp(r,c)):K(t,2,wp(r,c)):s?K(t,16,_p(r,c)):K(t,5,vp(r,c)),!0;case"b":return c.t="b",s?K(t,15,op(r,c)):K(t,4,ap(r,c)),!0;case"e":return c.t="e",s?K(t,14,up(r,c)):K(t,3,lp(r,c)),!0}return s?K(t,12,np(r,c)):K(t,1,tp(r,c)),!0}function Jp(t,r,e,n){var i=He(r["!ref"]||"A1"),a,s="",o=[];K(t,145);var c=Array.isArray(r),l=i.e.r;r["!rows"]&&(l=Math.max(i.e.r,r["!rows"].length-1));for(var f=i.s.r;f<=l;++f){s=dt(f),q1(t,r,i,f);var v=!1;if(f<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){f===i.s.r&&(o[p]=_t(p)),a=o[p]+s;var x=c?(r[f]||[])[p]:r[a];if(!x){v=!1;continue}v=Yp(t,x,f,p,n,r,v)}}K(t,146)}function Zp(t,r){!r||!r["!merges"]||(K(t,177,Op(r["!merges"].length)),r["!merges"].forEach(function(e){K(t,176,Pp(e))}),K(t,178))}function Qp(t,r){!r||!r["!cols"]||(K(t,390),r["!cols"].forEach(function(e,n){e&&K(t,60,Up(n,e))}),K(t,391))}function ex(t,r){!r||!r["!ref"]||(K(t,648),K(t,649,jp(He(r["!ref"]))),K(t,650))}function tx(t,r,e){r["!links"].forEach(function(n){if(n[1].Target){var i=Oe(e,-1,n[1].Target.replace(/#.*$/,""),ze.HLINK);K(t,494,Rp(n,i))}}),delete r["!links"]}function rx(t,r,e,n){if(r["!comments"].length>0){var i=Oe(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ze.VML);K(t,551,ys("rId"+i)),r["!legacy"]=i}}function nx(t,r,e,n){if(r["!autofilter"]){var i=r["!autofilter"],a=typeof i.ref=="string"?i.ref:Je(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,o=jt(a);o.s.r==o.e.r&&(o.e.r=jt(r["!ref"]).e.r,a=Je(o));for(var c=0;c<s.length;++c){var l=s[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+e.SheetNames[n]+"'!"+a;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+a}),K(t,161,xi(He(a))),K(t,162)}}function ix(t,r,e){K(t,133),K(t,137,Xp(r,e)),K(t,138),K(t,134)}function ax(t,r){r["!protect"]&&K(t,535,$p(r["!protect"]))}function sx(t,r,e,n){var i=Bt(),a=e.SheetNames[t],s=e.Sheets[a]||{},o=a;try{e&&e.Workbook&&(o=e.Workbook.Sheets[t].CodeName||o)}catch{}var c=He(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],K(i,129),(e.vbaraw||s["!outline"])&&K(i,147,Q1(o,s["!outline"])),K(i,148,Y1(c)),ix(i,s,e.Workbook),Qp(i,s,t,r,e),Jp(i,s,t,r,e),ax(i,s),nx(i,s,e,t),Zp(i,s),tx(i,s,n),s["!margins"]&&K(i,476,Hp(s["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&ex(i,s),rx(i,s,t,n),K(i,130),i.end()}function ox(t,r){t.l+=10;var e=St(t,r-10);return{name:e}}var cx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function lx(t){return!t.Workbook||!t.Workbook.WBProps?"false":Bu(t.Workbook.WBProps.date1904)?"true":"false"}var fx="][*?/\\".split("");function Vc(t,r){if(t.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return fx.forEach(function(n){if(t.indexOf(n)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}function ux(t,r,e){t.forEach(function(n,i){Vc(n);for(var a=0;a<i;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(e){var s=r&&r[i]&&r[i].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function hx(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];ux(t.SheetNames,r,!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)P1(t.Sheets[t.SheetNames[e]],t.SheetNames[e],e)}function Uc(t){var r=[Ze];r[r.length]=te("workbook",null,{xmlns:di[0],"xmlns:r":it.r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(cx.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=te("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(r[r.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==t.SheetNames.length&&(a=0),r[r.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var s={name:Le(t.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}r[r.length]=te("sheet",null,s)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(r[r.length]=te("definedName",Le(o.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function dx(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=cs(t,r-8),e.name=St(t),e}function mx(t,r){return r||(r=V(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),ys(t.strRelID,r),st(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function px(t,r){var e={},n=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var i=r>8?St(t):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function xx(t,r){r||(r=V(72));var e=0;return t&&t.filterPrivacy&&(e|=8),r.write_shift(4,e),r.write_shift(4,0),Qo(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function vx(t,r,e){var n=t.l+r;t.l+=4,t.l+=1;var i=t.read_shift(4),a=lh(t),s=A1(t,0,e),o=Cs(t);t.l=n;var c={Name:a,Ptg:s};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function gx(t,r){K(t,143);for(var e=0;e!=r.SheetNames.length;++e){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e]&&r.Workbook.Sheets[e].Hidden||0,i={Hidden:n,iTabID:e+1,strRelID:"rId"+(e+1),name:r.SheetNames[e]};K(t,156,mx(i))}K(t,144)}function _x(t,r){r||(r=V(127));for(var e=0;e!=4;++e)r.write_shift(4,0);return st("SheetJS",r),st(Mi.version,r),st(Mi.version,r),st("7262",r),r.length>r.l?r.slice(0,r.l):r}function Sx(t,r){r||(r=V(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var e=120;return r.write_shift(1,e),r.length>r.l?r.slice(0,r.l):r}function wx(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var e=r.Workbook.Sheets,n=0,i=-1,a=-1;n<e.length;++n)!e[n]||!e[n].Hidden&&i==-1?i=n:e[n].Hidden==1&&a==-1&&(a=n);a>i||(K(t,135),K(t,158,Sx(i)),K(t,136))}}function Ex(t,r){var e=Bt();return K(e,131),K(e,128,_x()),K(e,153,xx(t.Workbook&&t.Workbook.WBProps||null)),wx(e,t,r),gx(e,t,r),K(e,132),e.end()}function Tx(t,r,e){return(r.slice(-4)===".bin"?Ex:Uc)(t,e)}function kx(t,r,e,n,i){return(r.slice(-4)===".bin"?sx:Mc)(t,e,n,i)}function Cx(t,r,e){return(r.slice(-4)===".bin"?Hd:Tc)(t,e)}function yx(t,r,e){return(r.slice(-4)===".bin"?xd:_c)(t,e)}function Fx(t,r,e){return(r.slice(-4)===".bin"?am:Ac)(t,e)}function Ax(t){return(t.slice(-4)===".bin"?Jd:yc)()}function bx(t,r){var e=[];return t.Props&&e.push(Ch(t.Props,r)),t.Custprops&&e.push(yh(t.Props,t.Custprops,r)),e.join("")}function zx(){return""}function Dx(t,r){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,i){var a=[];a.push(te("NumberFormat",null,{"ss:Format":Le($e[n.numFmtId])}));var s={"ss:ID":"s"+(21+i)};e.push(te("Style",a.join(""),s))}),te("Styles",e.join(""))}function Wc(t){return te("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+zs(t.Ref,{r:0,c:0})})}function Ix(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,e=[],n=0;n<r.length;++n){var i=r[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||e.push(Wc(i)))}return te("Names",e.join(""))}function Nx(t,r,e,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==e&&(o.Name.match(/^_xlfn\./)||a.push(Wc(o)))}return a.join("")}function Px(t,r,e,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(te("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(te("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(te("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e])if(n.Workbook.Sheets[e].Hidden)i.push(te("Visible",n.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<e&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==e&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(ht("ProtectContents","True")),t["!protect"].objects&&i.push(ht("ProtectObjects","True")),t["!protect"].scenarios&&i.push(ht("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(ht("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(ht("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){t["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":te("WorksheetOptions",i.join(""),{xmlns:Xt.x})}function Ox(t){return t.map(function(r){var e=Mu(r.t||""),n=te("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return te("Comment",n,{"ss:Author":r.a})}).join("")}function Lx(t,r,e,n,i,a,s){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Le(zs(t.f,s))),t.F&&t.F.slice(0,r.length)==r){var c=at(t.F.slice(r.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Le(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Le(t.l.Tooltip))),e["!merges"])for(var l=e["!merges"],f=0;f!=l.length;++f)l[f].s.c!=s.c||l[f].s.r!=s.r||(l[f].e.c>l[f].s.c&&(o["ss:MergeAcross"]=l[f].e.c-l[f].s.c),l[f].e.r>l[f].s.r&&(o["ss:MergeDown"]=l[f].e.r-l[f].s.r));var v="",p="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":v="Number",p=String(t.v);break;case"b":v="Boolean",p=t.v?"1":"0";break;case"e":v="Error",p=$i[t.v];break;case"d":v="DateTime",p=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||$e[14]);break;case"s":v="String",p=Ru(t.v||"");break}var x=fn(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+x),o["ss:Index"]=s.c+1;var w=t.v!=null?p:"",h=t.t=="z"?"":'<Data ss:Type="'+v+'">'+w+"</Data>";return(t.c||[]).length>0&&(h+=Ox(t.c)),te("Cell",h,o)}function Rx(t,r){var e='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Ec(r.hpt)),r.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(e+=' ss:Hidden="1"')),e+">"}function Mx(t,r,e,n){if(!t["!ref"])return"";var i=He(t["!ref"]),a=t["!merges"]||[],s=0,o=[];t["!cols"]&&t["!cols"].forEach(function(S,D){As(S);var I=!!S.width,P=Ma(D,S),H={"ss:Index":D+1};I&&(H["ss:Width"]=Ca(P.width)),S.hidden&&(H["ss:Hidden"]="1"),o.push(te("Column",null,H))});for(var c=Array.isArray(t),l=i.s.r;l<=i.e.r;++l){for(var f=[Rx(l,(t["!rows"]||[])[l])],v=i.s.c;v<=i.e.c;++v){var p=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>v)&&!(a[s].s.r>l)&&!(a[s].e.c<v)&&!(a[s].e.r<l)){(a[s].s.c!=v||a[s].s.r!=l)&&(p=!0);break}if(!p){var x={r:l,c:v},w=Re(x),h=c?(t[l]||[])[v]:t[w];f.push(Lx(h,w,t,r,e,n,x))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function Bx(t,r,e){var n=[],i=e.SheetNames[t],a=e.Sheets[i],s=a?Nx(a,r,t,e):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=a?Mx(a,r,t,e):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Px(a,r,t,e)),n.join("")}function Vx(t,r){r||(r={}),t.SSF||(t.SSF=Ut($e)),t.SSF&&(Ia(),Da(t.SSF),r.revssf=Na(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],fn(r.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(bx(t,r)),e.push(zx(t,r)),e.push(""),e.push("");for(var n=0;n<t.SheetNames.length;++n)e.push(te("Worksheet",Bx(n,r,t),{"ss:Name":Le(t.SheetNames[n])}));return e[2]=Dx(t,r),e[3]=Ix(t,r),Ze+te("Workbook",e.join(""),{xmlns:Xt.ss,"xmlns:o":Xt.o,"xmlns:x":Xt.x,"xmlns:ss":Xt.ss,"xmlns:dt":Xt.dt,"xmlns:html":Xt.html})}var ns={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Ux(t,r){var e=[],n=[],i=[],a=0,s,o=$0(so,"n"),c=$0(oo,"n");if(t.Props)for(s=mt(t.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(o,s[a])?e:Object.prototype.hasOwnProperty.call(c,s[a])?n:i).push([s[a],t.Props[s[a]]]);if(t.Custprops)for(s=mt(t.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(o,s[a])?e:Object.prototype.hasOwnProperty.call(c,s[a])?n:i).push([s[a],t.Custprops[s[a]]]);var l=[];for(a=0;a<i.length;++a)hc.indexOf(i[a][0])>-1||lc.indexOf(i[a][0])>-1||i[a][1]!=null&&l.push(i[a]);n.length&&Ve.utils.cfb_add(r,"/SummaryInformation",ho(n,ns.SI,c,oo)),(e.length||l.length)&&Ve.utils.cfb_add(r,"/DocumentSummaryInformation",ho(e,ns.DSI,o,so,l.length?l:null,ns.UDI))}function Wx(t,r){var e=r||{},n=Ve.utils.cfb_new({root:"R"}),i="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":i="/Workbook",e.biff=8;break;case"biff5":i="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Ve.utils.cfb_add(n,i,Hc(t,e)),e.biff==8&&(t.Props||t.Custprops)&&Ux(t,n),e.biff==8&&t.vbaraw&&sm(n,Ve.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Hx={0:{f:j1},1:{f:ep},2:{f:Sp},3:{f:cp},4:{f:ip},5:{f:xp},6:{f:Cp},7:{f:hp},8:{f:Ip},9:{f:Dp},10:{f:bp},11:{f:zp},12:{f:rp},13:{f:Ep},14:{f:fp},15:{f:sp},16:{f:gp},17:{f:Fp},18:{f:mp},19:{f:ks},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:vx},40:{},42:{},43:{f:Cd},44:{f:Td},45:{f:Ad},46:{f:zd},47:{f:bd},48:{},49:{f:rh},50:{},51:{f:jd},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:nd},62:{f:kp},63:{f:Zd},64:{f:qp},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:br,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Gp},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Z1},148:{f:K1,p:16},151:{f:Mp},152:{},153:{f:px},154:{},155:{},156:{f:dx},157:{},158:{},159:{T:1,f:dd},160:{T:-1},161:{T:1,f:bn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Np},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Gd},336:{T:-1},337:{f:Kd,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:cs},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Jh},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Bp},427:{f:Vp},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Wp},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:J1},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Lp},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:cs},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nm},633:{T:1},634:{T:-1},635:{T:1,f:tm},636:{T:-1},637:{f:sh},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ox},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Kp},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function re(t,r,e,n){var i=r;if(!isNaN(i)){var a=n||(e||[]).length||0,s=t.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&ws(e)&&t.push(e)}}function Gx(t,r,e,n){var i=n||(e||[]).length||0;if(i<=8224)return re(t,r,e,i);var a=r;if(!isNaN(a)){for(var s=e.parts||[],o=0,c=0,l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,a),f.write_shift(2,l),t.push(e.slice(c,c+l)),c+=l;c<i;){for(f=t.next(4),f.write_shift(2,60),l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;f.write_shift(2,l),t.push(e.slice(c,c+l)),c+=l}}}function Ki(t,r,e){return t||(t=V(7)),t.write_shift(2,r),t.write_shift(2,e),t.write_shift(2,0),t.write_shift(1,0),t}function Xx(t,r,e,n){var i=V(9);return Ki(i,t,r),mc(e,n||"b",i),i}function jx(t,r,e){var n=V(8+2*e.length);return Ki(n,t,r),n.write_shift(1,e.length),n.write_shift(e.length,e,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function $x(t,r,e,n){if(r.v!=null)switch(r.t){case"d":case"n":var i=r.t=="d"?Vt(Ft(r.v)):r.v;i==(i|0)&&i>=0&&i<65536?re(t,2,od(e,n,i)):re(t,3,sd(e,n,i));return;case"b":case"e":re(t,5,Xx(e,n,r.v,r.t));return;case"s":case"str":re(t,4,jx(e,n,(r.v||"").slice(0,255)));return}re(t,1,Ki(null,e,n))}function qx(t,r,e,n){var i=Array.isArray(r),a=He(r["!ref"]||"A1"),s,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=Je(a)}for(var l=a.s.r;l<=a.e.r;++l){o=dt(l);for(var f=a.s.c;f<=a.e.c;++f){l===a.s.r&&(c[f]=_t(f)),s=c[f]+o;var v=i?(r[l]||[])[f]:r[s];v&&$x(t,v,l,f,n)}}}function Kx(t,r){var e=r||{};Ar!=null&&e.dense==null&&(e.dense=Ar);for(var n=Bt(),i=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==e.sheet&&(i=a);if(i==0&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return re(n,e.biff==4?1033:e.biff==3?521:9,Fs(t,16,e)),qx(n,t.Sheets[t.SheetNames[i]],i,e,t),re(n,10),n.end()}function Yx(t,r,e){re(t,49,Hh({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function Jx(t,r,e){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&re(t,1054,jh(i,r[i],e))})}function Zx(t,r){var e=V(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),re(t,2151,e),e=V(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),vc(He(r["!ref"]||"A1"),e),e.write_shift(4,4),re(t,2152,e)}function Qx(t,r){for(var e=0;e<16;++e)re(t,224,po({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){re(t,224,po(n,0,r))})}function ev(t,r){for(var e=0;e<r["!links"].length;++e){var n=r["!links"][e];re(t,440,ed(n)),n[1].Tooltip&&re(t,2048,td(n))}delete r["!links"]}function tv(t,r){if(r){var e=0;r.forEach(function(n,i){++e<=256&&n&&re(t,125,id(Ma(i,n),i))})}}function rv(t,r,e,n,i){var a=16+fn(i.cellXfs,r,i);if(r.v==null&&!r.bf){re(t,513,kn(e,n,a));return}if(r.bf)re(t,6,y1(r,e,n,i,a));else switch(r.t){case"d":case"n":var s=r.t=="d"?Vt(Ft(r.v)):r.v;re(t,515,Yh(e,n,s,a,i));break;case"b":case"e":re(t,517,Kh(e,n,r.v,a,i,r.t));break;case"s":case"str":if(i.bookSST){var o=Is(i.Strings,r.v,i.revStrings);re(t,253,Gh(e,n,o,a,i))}else re(t,516,Xh(e,n,(r.v||"").slice(0,255),a,i));break;default:re(t,513,kn(e,n,a))}}function nv(t,r,e){var n=Bt(),i=e.SheetNames[t],a=e.Sheets[i]||{},s=(e||{}).Workbook||{},o=(s.Sheets||[])[t]||{},c=Array.isArray(a),l=r.biff==8,f,v="",p=[],x=He(a["!ref"]||"A1"),w=l?65536:16384;if(x.e.c>255||x.e.r>=w){if(r.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,w-1)}re(n,2057,Fs(e,16,r)),re(n,13,or(1)),re(n,12,or(100)),re(n,15,yt(!0)),re(n,17,yt(!1)),re(n,16,Tn(.001)),re(n,95,yt(!0)),re(n,42,yt(!1)),re(n,43,yt(!1)),re(n,130,or(1)),re(n,128,qh([0,0])),re(n,131,yt(!1)),re(n,132,yt(!1)),l&&tv(n,a["!cols"]),re(n,512,$h(x,r)),l&&(a["!links"]=[]);for(var h=x.s.r;h<=x.e.r;++h){v=dt(h);for(var S=x.s.c;S<=x.e.c;++S){h===x.s.r&&(p[S]=_t(S)),f=p[S]+v;var D=c?(a[h]||[])[S]:a[f];D&&(rv(n,D,h,S,r),l&&D.l&&a["!links"].push([f,D.l]))}}var I=o.CodeName||o.name||i;return l&&re(n,574,Wh((s.Views||[])[0])),l&&(a["!merges"]||[]).length&&re(n,229,Qh(a["!merges"])),l&&ev(n,a),re(n,442,xc(I,r)),l&&Zx(n,a),re(n,10),n.end()}function iv(t,r,e){var n=Bt(),i=(t||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},o=e.biff==8,c=e.biff==5;if(re(n,2057,Fs(t,5,e)),e.bookType=="xla"&&re(n,135),re(n,225,o?or(1200):null),re(n,193,bh(2)),c&&re(n,191),c&&re(n,192),re(n,226),re(n,92,Mh("SheetJS",e)),re(n,66,or(o?1200:1252)),o&&re(n,353,or(0)),o&&re(n,448),re(n,317,ad(t.SheetNames.length)),o&&t.vbaraw&&re(n,211),o&&t.vbaraw){var l=s.CodeName||"ThisWorkbook";re(n,442,xc(l,e))}re(n,156,or(17)),re(n,25,yt(!1)),re(n,18,yt(!1)),re(n,19,or(0)),o&&re(n,431,yt(!1)),o&&re(n,444,or(0)),re(n,61,Uh(e)),re(n,64,yt(!1)),re(n,141,or(0)),re(n,34,yt(lx(t)=="true")),re(n,14,yt(!0)),o&&re(n,439,yt(!1)),re(n,218,or(0)),Yx(n,t,e),Jx(n,t.SSF,e),Qx(n,e),o&&re(n,352,yt(!1));var f=n.end(),v=Bt();o&&re(v,140,rd()),o&&e.Strings&&Gx(v,252,Vh(e.Strings,e)),re(v,10);var p=v.end(),x=Bt(),w=0,h=0;for(h=0;h<t.SheetNames.length;++h)w+=(o?12:11)+(o?2:1)*t.SheetNames[h].length;var S=f.length+w+p.length;for(h=0;h<t.SheetNames.length;++h){var D=a[h]||{};re(x,133,Bh({pos:S,hs:D.Hidden||0,dt:0,name:t.SheetNames[h]},e)),S+=r[h].length}var I=x.end();if(w!=I.length)throw new Error("BS8 "+w+" != "+I.length);var P=[];return f.length&&P.push(f),I.length&&P.push(I),p.length&&P.push(p),ut(P)}function av(t,r){var e=r||{},n=[];t&&!t.SSF&&(t.SSF=Ut($e)),t&&t.SSF&&(Ia(),Da(t.SSF),e.revssf=Na(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ns(e),e.cellXfs=[],fn(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=nv(i,e,t);return n.unshift(iv(t,n,e)),ut(n)}function Hc(t,r){for(var e=0;e<=t.SheetNames.length;++e){var n=t.Sheets[t.SheetNames[e]];if(!(!n||!n["!ref"])){var i=jt(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var a=r||{};switch(a.biff||2){case 8:case 5:return av(t,r);case 4:case 3:case 2:return Kx(t,r)}throw new Error("invalid type "+a.bookType+" for BIFF")}function sv(t,r,e,n){for(var i=t["!merges"]||[],a=[],s=r.s.c;s<=r.e.c;++s){for(var o=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>e||i[l].s.c>s)&&!(i[l].e.r<e||i[l].e.c<s)){if(i[l].s.r<e||i[l].s.c<s){o=-1;break}o=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var f=Re({r:e,c:s}),v=n.dense?(t[e]||[])[s]:t[f],p=v&&v.v!=null&&(v.h||Lu(v.w||(Vr(v),v.w)||""))||"",x={};o>1&&(x.rowspan=o),c>1&&(x.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":v&&(x["data-t"]=v&&v.t||"z",v.v!=null&&(x["data-v"]=v.v),v.z!=null&&(x["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+v.l.Target+'">'+p+"</a>")),x.id=(n.id||"sjs")+"-"+f,a.push(te("td",p,x))}}var w="<tr>";return w+a.join("")+"</tr>"}var ov='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',cv="</body></html>";function lv(t,r,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function Gc(t,r){var e=r||{},n=e.header!=null?e.header:ov,i=e.footer!=null?e.footer:cv,a=[n],s=jt(t["!ref"]);e.dense=Array.isArray(t),a.push(lv(t,s,e));for(var o=s.s.r;o<=s.e.r;++o)a.push(sv(t,s,o,e));return a.push("</table>"+i),a.join("")}function Xc(t,r,e){var n=e||{};Ar!=null&&(n.dense=Ar);var i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?at(n.origin):n.origin;i=s.r,a=s.c}var o=r.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:a}};if(t["!ref"]){var f=jt(t["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),i==-1&&(l.e.r=i=f.e.r+1)}var v=[],p=0,x=t["!rows"]||(t["!rows"]=[]),w=0,h=0,S=0,D=0,I=0,P=0;for(t["!cols"]||(t["!cols"]=[]);w<o.length&&h<c;++w){var H=o[w];if(Eo(H)){if(n.display)continue;x[h]={hidden:!0}}var Z=H.children;for(S=D=0;S<Z.length;++S){var me=Z[S];if(!(n.display&&Eo(me))){var N=me.hasAttribute("data-v")?me.getAttribute("data-v"):me.hasAttribute("v")?me.getAttribute("v"):Vu(me.innerHTML),q=me.getAttribute("data-z")||me.getAttribute("z");for(p=0;p<v.length;++p){var W=v[p];W.s.c==D+a&&W.s.r<h+i&&h+i<=W.e.r&&(D=W.e.c+1-a,p=-1)}P=+me.getAttribute("colspan")||1,((I=+me.getAttribute("rowspan")||1)>1||P>1)&&v.push({s:{r:h+i,c:D+a},e:{r:h+i+(I||1)-1,c:D+a+(P||1)-1}});var X={t:"s",v:N},J=me.getAttribute("data-t")||me.getAttribute("t")||"";N!=null&&(N.length==0?X.t=J||"z":n.raw||N.trim().length==0||J=="s"||(N==="TRUE"?X={t:"b",v:!0}:N==="FALSE"?X={t:"b",v:!1}:isNaN(Rr(N))?isNaN(Ui(N).getDate())||(X={t:"d",v:Ft(N)},n.cellDates||(X={t:"n",v:Vt(X.v)}),X.z=n.dateNF||$e[14]):X={t:"n",v:Rr(N)})),X.z===void 0&&q!=null&&(X.z=q);var Q="",ve=me.getElementsByTagName("A");if(ve&&ve.length)for(var Ne=0;Ne<ve.length&&!(ve[Ne].hasAttribute("href")&&(Q=ve[Ne].getAttribute("href"),Q.charAt(0)!="#"));++Ne);Q&&Q.charAt(0)!="#"&&(X.l={Target:Q}),n.dense?(t[h+i]||(t[h+i]=[]),t[h+i][D+a]=X):t[Re({c:D+a,r:h+i})]=X,l.e.c<D+a&&(l.e.c=D+a),D+=P}}++h}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),l.e.r=Math.max(l.e.r,h-1+i),t["!ref"]=Je(l),h>=c&&(t["!fullref"]=Je((l.e.r=o.length-w+h-1+i,l))),t}function jc(t,r){var e=r||{},n=e.dense?[]:{};return Xc(n,t,r)}function fv(t,r){return Cn(jc(t,r),r)}function Eo(t){var r="",e=uv(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function uv(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var hv=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ze+r}}(),To=function(){var t=function(a){return Le(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,n=function(a,s,o){var c=[];c.push('      <table:table table:name="'+Le(s.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,f=0,v=jt(a["!ref"]||"A1"),p=a["!merges"]||[],x=0,w=Array.isArray(a);if(a["!cols"])for(f=0;f<=v.e.c;++f)c.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var h="",S=a["!rows"]||[];for(l=0;l<v.s.r;++l)h=S[l]?' table:style-name="ro'+S[l].ods+'"':"",c.push("        <table:table-row"+h+`></table:table-row>
`);for(;l<=v.e.r;++l){for(h=S[l]?' table:style-name="ro'+S[l].ods+'"':"",c.push("        <table:table-row"+h+`>
`),f=0;f<v.s.c;++f)c.push(r);for(;f<=v.e.c;++f){var D=!1,I={},P="";for(x=0;x!=p.length;++x)if(!(p[x].s.c>f)&&!(p[x].s.r>l)&&!(p[x].e.c<f)&&!(p[x].e.r<l)){(p[x].s.c!=f||p[x].s.r!=l)&&(D=!0),I["table:number-columns-spanned"]=p[x].e.c-p[x].s.c+1,I["table:number-rows-spanned"]=p[x].e.r-p[x].s.r+1;break}if(D){c.push(e);continue}var H=Re({r:l,c:f}),Z=w?(a[l]||[])[f]:a[H];if(Z&&Z.f&&(I["table:formula"]=Le(I1(Z.f)),Z.F&&Z.F.slice(0,H.length)==H)){var me=jt(Z.F);I["table:number-matrix-columns-spanned"]=me.e.c-me.s.c+1,I["table:number-matrix-rows-spanned"]=me.e.r-me.s.r+1}if(!Z){c.push(r);continue}switch(Z.t){case"b":P=Z.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=Z.v?"true":"false";break;case"n":P=Z.w||String(Z.v||0),I["office:value-type"]="float",I["office:value"]=Z.v||0;break;case"s":case"str":P=Z.v==null?"":Z.v,I["office:value-type"]="string";break;case"d":P=Z.w||Ft(Z.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=Ft(Z.v).toISOString(),I["table:style-name"]="ce1";break;default:c.push(r);continue}var N=t(P);if(Z.l&&Z.l.Target){var q=Z.l.Target;q=q.charAt(0)=="#"?"#"+N1(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),N=te("text:a",N,{"xlink:href":q.replace(/&/g,"&amp;")})}c.push("          "+te("table:table-cell",te("text:p",N,{}),I)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(a,s){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var f=0;f<l["!cols"].length;++f)if(l["!cols"][f]){var v=l["!cols"][f];if(v.width==null&&v.wpx==null&&v.wch==null)continue;As(v),v.ods=o;var p=l["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var f=0;f<l["!rows"].length;++f)if(l["!rows"][f]){l["!rows"][f].ods=c;var v=l["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(s,o){var c=[Ze],l=Wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Wi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+f+`>
`),c.push(oc().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),i(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var v=0;v!=s.SheetNames.length;++v)c.push(n(s.Sheets[s.SheetNames[v]],s,v,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function $c(t,r){if(r.bookType=="fods")return To(t,r);var e=ds(),n="",i=[],a=[];return n="mimetype",Ee(e,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ee(e,n,To(t,r)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Ee(e,n,hv(t,r)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Ee(e,n,Ze+oc()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Ee(e,n,kh(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ee(e,n,Eh(i)),e}function Aa(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function dv(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):mr(Or(t))}function mv(t,r){e:for(var e=0;e<=t.length-r.length;++e){for(var n=0;n<r.length;++n)if(t[e+n]!=r[n])continue e;return!0}return!1}function ln(t){var r=t.reduce(function(i,a){return i+a.length},0),e=new Uint8Array(r),n=0;return t.forEach(function(i){e.set(i,n),n+=i.length}),e}function pv(t,r,e){var n=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,i=e/Math.pow(10,n-6176);t[r+15]|=n>>7,t[r+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)t[r+a]=i&255;t[r+15]|=e>=0?0:128}function Hi(t,r){var e=r?r[0]:0,n=t[e]&127;e:if(t[e++]>=128&&(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),n}function Pe(t){var r=new Uint8Array(7);r[0]=t&127;var e=1;e:if(t>127){if(r[e-1]|=128,r[e]=t>>7&127,++e,t<=16383||(r[e-1]|=128,r[e]=t>>14&127,++e,t<=2097151)||(r[e-1]|=128,r[e]=t>>21&127,++e,t<=268435455)||(r[e-1]|=128,r[e]=t/256>>>21&127,++e,t<=34359738367)||(r[e-1]|=128,r[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;r[e-1]|=128,r[e]=t/16777216>>>21&127,++e}return r.slice(0,e)}function fi(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function Qe(t){for(var r=[],e=[0];e[0]<t.length;){var n=e[0],i=Hi(t,e),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var c=e[0];t[e[0]++]>=128;);o=t.slice(c,e[0])}break;case 5:s=4,o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=Hi(t,e),o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var l={data:o,type:a};r[i]==null?r[i]=[l]:r[i].push(l)}return r}function lt(t){var r=[];return t.forEach(function(e,n){e.forEach(function(i){i.data&&(r.push(Pe(n*8+i.type)),i.type==2&&r.push(Pe(i.data.length)),r.push(i.data))})}),ln(r)}function hr(t){for(var r,e=[],n=[0];n[0]<t.length;){var i=Hi(t,n),a=Qe(t.slice(n[0],n[0]+i));n[0]+=i;var s={id:fi(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=Qe(o.data),l=fi(c[3][0].data);s.messages.push({meta:c,data:t.slice(n[0],n[0]+l)}),n[0]+=l}),(r=a[3])!=null&&r[0]&&(s.merge=fi(a[3][0].data)>>>0>0),e.push(s)}return e}function ri(t){var r=[];return t.forEach(function(e){var n=[];n[1]=[{data:Pe(e.id),type:0}],n[2]=[],e.merge!=null&&(n[3]=[{data:Pe(+!!e.merge),type:0}]);var i=[];e.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:Pe(s.data.length)}],n[2].push({data:lt(s.meta),type:2})});var a=lt(n);r.push(Pe(a.length)),r.push(a),i.forEach(function(s){return r.push(s)})}),ln(r)}function xv(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],n=Hi(r,e),i=[];e[0]<r.length;){var a=r[e[0]]&3;if(a==0){var s=r[e[0]++]>>2;if(s<60)++s;else{var o=s-59;s=r[e[0]],o>1&&(s|=r[e[0]+1]<<8),o>2&&(s|=r[e[0]+2]<<16),o>3&&(s|=r[e[0]+3]<<24),s>>>=0,s++,e[0]+=o}i.push(r.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var c=0,l=0;if(a==1?(l=(r[e[0]]>>2&7)+4,c=(r[e[0]++]&224)<<3,c|=r[e[0]++]):(l=(r[e[0]++]>>2)+1,a==2?(c=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(c=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),i=[ln(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var f=ln(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function dr(t){for(var r=[],e=0;e<t.length;){var n=t[e++],i=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(xv(n,t.slice(e,e+i))),e+=i}if(e!==t.length)throw new Error("data is not a valid framed stream!");return ln(r)}function ni(t){for(var r=[],e=0;e<t.length;){var n=Math.min(t.length-e,268435455),i=new Uint8Array(4);r.push(i);var a=Pe(n),s=a.length;r.push(a),n<=60?(s++,r.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(t.slice(e,e+n)),s+=n,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,e+=n}return ln(r)}function is(t,r){var e=new Uint8Array(32),n=Aa(e),i=12,a=0;switch(e[0]=5,t.t){case"n":e[1]=2,pv(e,i,t.v),a|=1,i+=16;break;case"b":e[1]=6,n.setFloat64(i,t.v?1:0,!0),a|=2,i+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[1]=3,n.setUint32(i,r.indexOf(t.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),e.slice(0,i)}function as(t,r){var e=new Uint8Array(32),n=Aa(e),i=12,a=0;switch(e[0]=3,t.t){case"n":e[2]=2,n.setFloat64(i,t.v,!0),a|=32,i+=8;break;case"b":e[2]=6,n.setFloat64(i,t.v?1:0,!0),a|=32,i+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[2]=3,n.setUint32(i,r.indexOf(t.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),e.slice(0,i)}function nn(t){var r=Qe(t);return Hi(r[1][0].data)}function vv(t,r,e){var n,i,a,s;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(a=t[8])==null?void 0:a[0])==null?void 0:s.data)&&fi(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=Aa(t[7][0].data),f=0,v=[],p=Aa(t[4][0].data),x=0,w=[],h=0;h<r.length;++h){if(r[h]==null){l.setUint16(h*2,65535,!0),p.setUint16(h*2,65535);continue}l.setUint16(h*2,f,!0),p.setUint16(h*2,x,!0);var S,D;switch(typeof r[h]){case"string":S=is({t:"s",v:r[h]},e),D=as({t:"s",v:r[h]},e);break;case"number":S=is({t:"n",v:r[h]},e),D=as({t:"n",v:r[h]},e);break;case"boolean":S=is({t:"b",v:r[h]},e),D=as({t:"b",v:r[h]},e);break;default:throw new Error("Unsupported value "+r[h])}v.push(S),f+=S.length,w.push(D),x+=D.length,++c}for(t[2][0].data=Pe(c);h<t[7][0].data.length/2;++h)l.setUint16(h*2,65535,!0),p.setUint16(h*2,65535,!0);return t[6][0].data=ln(v),t[3][0].data=ln(w),c}function gv(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=jt(e["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Je(n)));var a=ba(e,{range:n,header:1}),s=["~Sh33tJ5~"];a.forEach(function(z){return z.forEach(function(b){typeof b=="string"&&s.push(b)})});var o={},c=[],l=Ve.read(r.numbers,{type:"base64"});l.FileIndex.map(function(z,b){return[z,l.FullPaths[b]]}).forEach(function(z){var b=z[0],Y=z[1];if(b.type==2&&b.name.match(/\.iwa/)){var xe=b.content,_e=dr(xe),he=hr(_e);he.forEach(function(ae){c.push(ae.id),o[ae.id]={deps:[],location:Y,type:fi(ae.messages[0].meta[1][0].data)}})}}),c.sort(function(z,b){return z-b});var f=c.filter(function(z){return z>1}).map(function(z){return[z,Pe(z)]});l.FileIndex.map(function(z,b){return[z,l.FullPaths[b]]}).forEach(function(z){var b=z[0],Y=z[1];if(b.name.match(/\.iwa/)){var xe=hr(dr(b.content));xe.forEach(function(_e){_e.messages.forEach(function(he){f.forEach(function(ae){_e.messages.some(function(Me){return fi(Me.meta[1][0].data)!=11006&&mv(Me.data,ae[1])})&&o[ae[0]].deps.push(_e.id)})})})}});function v(){for(var z=927262;z<2e6;++z)if(!o[z])return z;throw new Error("Too many messages")}for(var p=Ve.find(l,o[1].location),x=hr(dr(p.content)),w,h=0;h<x.length;++h){var S=x[h];S.id==1&&(w=S)}var D=nn(Qe(w.messages[0].data)[1][0].data);for(p=Ve.find(l,o[D].location),x=hr(dr(p.content)),h=0;h<x.length;++h)S=x[h],S.id==D&&(w=S);for(D=nn(Qe(w.messages[0].data)[2][0].data),p=Ve.find(l,o[D].location),x=hr(dr(p.content)),h=0;h<x.length;++h)S=x[h],S.id==D&&(w=S);for(D=nn(Qe(w.messages[0].data)[2][0].data),p=Ve.find(l,o[D].location),x=hr(dr(p.content)),h=0;h<x.length;++h)S=x[h],S.id==D&&(w=S);var I=Qe(w.messages[0].data);{I[6][0].data=Pe(n.e.r+1),I[7][0].data=Pe(n.e.c+1);var P=nn(I[46][0].data),H=Ve.find(l,o[P].location),Z=hr(dr(H.content));{for(var me=0;me<Z.length&&Z[me].id!=P;++me);if(Z[me].id!=P)throw"Bad ColumnRowUIDMapArchive";var N=Qe(Z[me].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var q=0;q<=n.e.c;++q){var W=[];W[1]=W[2]=[{type:0,data:Pe(q+420690)}],N[1].push({type:2,data:lt(W)}),N[2].push({type:0,data:Pe(q)}),N[3].push({type:0,data:Pe(q)})}N[4]=[],N[5]=[],N[6]=[];for(var X=0;X<=n.e.r;++X)W=[],W[1]=W[2]=[{type:0,data:Pe(X+726270)}],N[4].push({type:2,data:lt(W)}),N[5].push({type:0,data:Pe(X)}),N[6].push({type:0,data:Pe(X)});Z[me].messages[0].data=lt(N)}H.content=ni(ri(Z)),H.size=H.content.length,delete I[46];var J=Qe(I[4][0].data);{J[7][0].data=Pe(n.e.r+1);var Q=Qe(J[1][0].data),ve=nn(Q[2][0].data);H=Ve.find(l,o[ve].location),Z=hr(dr(H.content));{if(Z[0].id!=ve)throw"Bad HeaderStorageBucket";var Ne=Qe(Z[0].messages[0].data);for(X=0;X<a.length;++X){var ge=Qe(Ne[2][0].data);ge[1][0].data=Pe(X),ge[4][0].data=Pe(a[X].length),Ne[2][X]={type:Ne[2][0].type,data:lt(ge)}}Z[0].messages[0].data=lt(Ne)}H.content=ni(ri(Z)),H.size=H.content.length;var et=nn(J[2][0].data);H=Ve.find(l,o[et].location),Z=hr(dr(H.content));{if(Z[0].id!=et)throw"Bad HeaderStorageBucket";for(Ne=Qe(Z[0].messages[0].data),q=0;q<=n.e.c;++q)ge=Qe(Ne[2][0].data),ge[1][0].data=Pe(q),ge[4][0].data=Pe(n.e.r+1),Ne[2][q]={type:Ne[2][0].type,data:lt(ge)};Z[0].messages[0].data=lt(Ne)}H.content=ni(ri(Z)),H.size=H.content.length;var tt=nn(J[4][0].data);(function(){for(var z=Ve.find(l,o[tt].location),b=hr(dr(z.content)),Y,xe=0;xe<b.length;++xe){var _e=b[xe];_e.id==tt&&(Y=_e)}var he=Qe(Y.messages[0].data);{he[3]=[];var ae=[];s.forEach(function(ct,Ae){ae[1]=[{type:0,data:Pe(Ae)}],ae[2]=[{type:0,data:Pe(1)}],ae[3]=[{type:2,data:dv(ct)}],he[3].push({type:2,data:lt(ae)})})}Y.messages[0].data=lt(he);var Me=ri(b),ye=ni(Me);z.content=ye,z.size=z.content.length})();var At=Qe(J[3][0].data);{var wt=At[1][0];delete At[2];var ot=Qe(wt.data);{var bt=nn(ot[2][0].data);(function(){for(var z=Ve.find(l,o[bt].location),b=hr(dr(z.content)),Y,xe=0;xe<b.length;++xe){var _e=b[xe];_e.id==bt&&(Y=_e)}var he=Qe(Y.messages[0].data);{delete he[6],delete At[7];var ae=new Uint8Array(he[5][0].data);he[5]=[];for(var Me=0,ye=0;ye<=n.e.r;++ye){var ct=Qe(ae);Me+=vv(ct,a[ye],s),ct[1][0].data=Pe(ye),he[5].push({data:lt(ct),type:2})}he[1]=[{type:0,data:Pe(n.e.c+1)}],he[2]=[{type:0,data:Pe(n.e.r+1)}],he[3]=[{type:0,data:Pe(Me)}],he[4]=[{type:0,data:Pe(n.e.r+1)}]}Y.messages[0].data=lt(he);var Ae=ri(b),lr=ni(Ae);z.content=lr,z.size=z.content.length})()}wt.data=lt(ot)}J[3][0].data=lt(At)}I[4][0].data=lt(J)}w.messages[0].data=lt(I);var A=ri(x),G=ni(A);return p.content=G,p.size=p.content.length,l}function _v(t){return function(e){for(var n=0;n!=t.length;++n){var i=t[n];e[i[0]]===void 0&&(e[i[0]]=i[1]),i[2]==="n"&&(e[i[0]]=Number(e[i[0]]))}}}function Ns(t){_v([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Sv(t,r){return r.bookType=="ods"?$c(t,r):r.bookType=="numbers"?gv(t,r):r.bookType=="xlsb"?wv(t,r):Ev(t,r)}function wv(t,r){ai=1024,t&&!t.SSF&&(t.SSF=Ut($e)),t&&t.SSF&&(Ia(),Da(t.SSF),r.revssf=Na(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ri?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e=r.bookType=="xlsb"?"bin":"xml",n=bc.indexOf(r.bookType)>-1,i=ic();Ns(r=r||{});var a=ds(),s="",o=0;if(r.cellXfs=[],fn(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",Ee(a,s,cc(t.Props,r)),i.coreprops.push(s),Oe(r.rels,2,s,ze.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Ee(a,s,fc(t.Props,r)),i.extprops.push(s),Oe(r.rels,3,s,ze.EXT_PROPS),t.Custprops!==t.Props&&mt(t.Custprops||{}).length>0&&(s="docProps/custom.xml",Ee(a,s,uc(t.Custprops,r)),i.custprops.push(s),Oe(r.rels,4,s,ze.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},v=t.Sheets[t.SheetNames[o-1]],p=(v||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,Ee(a,s,kx(o-1,s,r,t,f)),i.sheets.push(s),Oe(r.wbrels,-1,"worksheets/sheet"+o+"."+e,ze.WS[0])}if(v){var x=v["!comments"],w=!1,h="";x&&x.length>0&&(h="xl/comments"+o+"."+e,Ee(a,h,Fx(x,h,r)),i.comments.push(h),Oe(f,-1,"../comments"+o+"."+e,ze.CMNT),w=!0),v["!legacy"]&&w&&Ee(a,"xl/drawings/vmlDrawing"+o+".vml",Fc(o,v["!comments"])),delete v["!comments"],delete v["!legacy"]}f["!id"].rId1&&Ee(a,sc(s),ci(f))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+e,Ee(a,s,yx(r.Strings,s,r)),i.strs.push(s),Oe(r.wbrels,-1,"sharedStrings."+e,ze.SST)),s="xl/workbook."+e,Ee(a,s,Tx(t,s,r)),i.workbooks.push(s),Oe(r.rels,1,s,ze.WB),s="xl/theme/theme1.xml",Ee(a,s,Cc(t.Themes,r)),i.themes.push(s),Oe(r.wbrels,-1,"theme/theme1.xml",ze.THEME),s="xl/styles."+e,Ee(a,s,Cx(t,s,r)),i.styles.push(s),Oe(r.wbrels,-1,"styles."+e,ze.STY),t.vbaraw&&n&&(s="xl/vbaProject.bin",Ee(a,s,t.vbaraw),i.vba.push(s),Oe(r.wbrels,-1,"vbaProject.bin",ze.VBA)),s="xl/metadata."+e,Ee(a,s,Ax(s)),i.metadata.push(s),Oe(r.wbrels,-1,"metadata."+e,ze.XLMETA),Ee(a,"[Content_Types].xml",ac(i,r)),Ee(a,"_rels/.rels",ci(r.rels)),Ee(a,"xl/_rels/workbook."+e+".rels",ci(r.wbrels)),delete r.revssf,delete r.ssf,a}function Ev(t,r){ai=1024,t&&!t.SSF&&(t.SSF=Ut($e)),t&&t.SSF&&(Ia(),Da(t.SSF),r.revssf=Na(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ri?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="xml",n=bc.indexOf(r.bookType)>-1,i=ic();Ns(r=r||{});var a=ds(),s="",o=0;if(r.cellXfs=[],fn(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",Ee(a,s,cc(t.Props,r)),i.coreprops.push(s),Oe(r.rels,2,s,ze.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Ee(a,s,fc(t.Props,r)),i.extprops.push(s),Oe(r.rels,3,s,ze.EXT_PROPS),t.Custprops!==t.Props&&mt(t.Custprops||{}).length>0&&(s="docProps/custom.xml",Ee(a,s,uc(t.Custprops,r)),i.custprops.push(s),Oe(r.rels,4,s,ze.CUST_PROPS));var f=["SheetJ5"];for(r.tcid=0,o=1;o<=t.SheetNames.length;++o){var v={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],x=(p||{})["!type"]||"sheet";switch(x){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,Ee(a,s,Mc(o-1,r,t,v)),i.sheets.push(s),Oe(r.wbrels,-1,"worksheets/sheet"+o+"."+e,ze.WS[0])}if(p){var w=p["!comments"],h=!1,S="";if(w&&w.length>0){var D=!1;w.forEach(function(I){I[1].forEach(function(P){P.T==!0&&(D=!0)})}),D&&(S="xl/threadedComments/threadedComment"+o+"."+e,Ee(a,S,Qd(w,f,r)),i.threadedcomments.push(S),Oe(v,-1,"../threadedComments/threadedComment"+o+"."+e,ze.TCMNT)),S="xl/comments"+o+"."+e,Ee(a,S,Ac(w,r)),i.comments.push(S),Oe(v,-1,"../comments"+o+"."+e,ze.CMNT),h=!0}p["!legacy"]&&h&&Ee(a,"xl/drawings/vmlDrawing"+o+".vml",Fc(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}v["!id"].rId1&&Ee(a,sc(s),ci(v))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+e,Ee(a,s,_c(r.Strings,r)),i.strs.push(s),Oe(r.wbrels,-1,"sharedStrings."+e,ze.SST)),s="xl/workbook."+e,Ee(a,s,Uc(t,r)),i.workbooks.push(s),Oe(r.rels,1,s,ze.WB),s="xl/theme/theme1.xml",Ee(a,s,Cc(t.Themes,r)),i.themes.push(s),Oe(r.wbrels,-1,"theme/theme1.xml",ze.THEME),s="xl/styles."+e,Ee(a,s,Tc(t,r)),i.styles.push(s),Oe(r.wbrels,-1,"styles."+e,ze.STY),t.vbaraw&&n&&(s="xl/vbaProject.bin",Ee(a,s,t.vbaraw),i.vba.push(s),Oe(r.wbrels,-1,"vbaProject.bin",ze.VBA)),s="xl/metadata."+e,Ee(a,s,yc()),i.metadata.push(s),Oe(r.wbrels,-1,"metadata."+e,ze.XLMETA),f.length>1&&(s="xl/persons/person.xml",Ee(a,s,em(f,r)),i.people.push(s),Oe(r.wbrels,-1,"persons/person.xml",ze.PEOPLE)),Ee(a,"[Content_Types].xml",ac(i,r)),Ee(a,"_rels/.rels",ci(r.rels)),Ee(a,"xl/_rels/workbook."+e+".rels",ci(r.wbrels)),delete r.revssf,delete r.ssf,a}function Tv(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Br(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function qc(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return ji(r.file,Ve.write(t,{type:Ie?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Ve.write(t,r)}function kv(t,r){var e=Ut(r||{}),n=Sv(t,e);return Cv(n,e)}function Cv(t,r){var e={},n=Ie?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(e.compression="DEFLATE"),r.password)e.type=n;else switch(r.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":e.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var i=t.FullPaths?Ve.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!r.compression}):t.generate(e);if(typeof Deno<"u"&&typeof i=="string"){if(r.type=="binary"||r.type=="base64")return i;i=new Uint8Array(za(i))}return r.password&&typeof encrypt_agile<"u"?qc(encrypt_agile(i,r.password),r):r.type==="file"?ji(r.file,i):r.type=="string"?Ni(i):i}function yv(t,r){var e=r||{},n=Wx(t,e);return qc(n,e)}function Fr(t,r,e){e||(e="");var n=e+t;switch(r.type){case"base64":return Vi(Or(n));case"binary":return Or(n);case"string":return t;case"file":return ji(r.file,n,"utf8");case"buffer":return Ie?Ur(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Fr(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Fv(t,r){switch(r.type){case"base64":return Vi(t);case"binary":return t;case"string":return t;case"file":return ji(r.file,t,"binary");case"buffer":return Ie?Ur(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function xa(t,r){switch(r.type){case"string":case"base64":case"binary":for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return r.type=="base64"?Vi(e):r.type=="string"?Ni(e):e;case"file":return ji(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function Ba(t,r){Qf(),hx(t);var e=Ut(r||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var n=Ba(t,e);return e.type="array",za(n)}var i=0;if(e.sheet&&(typeof e.sheet=="number"?i=e.sheet:i=t.SheetNames.indexOf(e.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Fr(Vx(t,e),e);case"slk":case"sylk":return Fr(ld.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"htm":case"html":return Fr(Gc(t.Sheets[t.SheetNames[i]],e),e);case"txt":return Fv(Kc(t.Sheets[t.SheetNames[i]],e),e);case"csv":return Fr(Ps(t.Sheets[t.SheetNames[i]],e),e,"\uFEFF");case"dif":return Fr(fd.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"dbf":return xa(cd.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"prn":return Fr(ud.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"rtf":return Fr(gd.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"eth":return Fr(gc.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"fods":return Fr($c(t,e),e);case"wk1":return xa(xo.sheet_to_wk1(t.Sheets[t.SheetNames[i]],e),e);case"wk3":return xa(xo.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),xa(Hc(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),yv(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return kv(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function Av(t,r,e,n,i,a,s,o){var c=dt(e),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),v=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:e,enumerable:!1})}catch{p.__rowNum__=e}else p.__rowNum__=e;if(!s||t[e])for(var x=r.s.c;x<=r.e.c;++x){var w=s?t[e][x]:t[n[x]+c];if(w===void 0||w.t===void 0){if(l===void 0)continue;a[x]!=null&&(p[a[x]]=l);continue}var h=w.v;switch(w.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(a[x]!=null){if(h==null)if(w.t=="e"&&h===null)p[a[x]]=null;else if(l!==void 0)p[a[x]]=l;else if(f&&h===null)p[a[x]]=null;else continue;else p[a[x]]=f&&(w.t!=="n"||w.t==="n"&&o.rawNumbers!==!1)?h:Vr(w,h,o);h!=null&&(v=!1)}}return{row:p,isempty:v}}function ba(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},n=0,i=1,a=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},f=l.range!=null?l.range:t["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof f){case"string":c=He(f);break;case"number":c=He(t["!ref"]),c.s.r=f;break;default:c=f}n>0&&(i=0);var v=dt(c.s.r),p=[],x=[],w=0,h=0,S=Array.isArray(t),D=c.s.r,I=0,P={};S&&!t[D]&&(t[D]=[]);var H=l.skipHidden&&t["!cols"]||[],Z=l.skipHidden&&t["!rows"]||[];for(I=c.s.c;I<=c.e.c;++I)if(!(H[I]||{}).hidden)switch(p[I]=_t(I),e=S?t[D][I]:t[p[I]+v],n){case 1:a[I]=I-c.s.c;break;case 2:a[I]=p[I];break;case 3:a[I]=l.header[I-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=s=Vr(e,null,l),h=P[s]||0,!h)P[s]=1;else{do o=s+"_"+h++;while(P[o]);P[s]=h,P[o]=1}a[I]=o}for(D=c.s.r+i;D<=c.e.r;++D)if(!(Z[D]||{}).hidden){var me=Av(t,c,D,p,n,a,S,l);(me.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(x[w++]=me.row)}return x.length=w,x}var ko=/"/g;function bv(t,r,e,n,i,a,s,o){for(var c=!0,l=[],f="",v=dt(e),p=r.s.c;p<=r.e.c;++p)if(n[p]){var x=o.dense?(t[e]||[])[p]:t[n[p]+v];if(x==null)f="";else if(x.v!=null){c=!1,f=""+(o.rawNumbers&&x.t=="n"?x.v:Vr(x,null,o));for(var w=0,h=0;w!==f.length;++w)if((h=f.charCodeAt(w))===i||h===a||h===34||o.forceQuotes){f='"'+f.replace(ko,'""')+'"';break}f=="ID"&&(f='"ID"')}else x.f!=null&&!x.F?(c=!1,f="="+x.f,f.indexOf(",")>=0&&(f='"'+f.replace(ko,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(s)}function Ps(t,r){var e=[],n=r??{};if(t==null||t["!ref"]==null)return"";var i=He(t["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((a=="|"?"\\|":a)+"+$"),f="",v=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],x=n.skipHidden&&t["!rows"]||[],w=i.s.c;w<=i.e.c;++w)(p[w]||{}).hidden||(v[w]=_t(w));for(var h=0,S=i.s.r;S<=i.e.r;++S)(x[S]||{}).hidden||(f=bv(t,i,S,v,s,c,a,n),f!=null&&(n.strip&&(f=f.replace(l,"")),(f||n.blankrows!==!1)&&e.push((h++?o:"")+f)));return delete n.dense,e.join("")}function Kc(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=Ps(t,r);if(typeof Ue>"u"||r.type=="string")return e;var n=Ue.utils.encode(1200,e,"str");return"\xFF\xFE"+n}function zv(t){var r="",e,n="";if(t==null||t["!ref"]==null)return[];var i=He(t["!ref"]),a="",s=[],o,c=[],l=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)s[o]=_t(o);for(var f=i.s.r;f<=i.e.r;++f)for(a=dt(f),o=i.s.c;o<=i.e.c;++o)if(r=s[o]+a,e=l?(t[f]||[])[o]:t[r],n="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;n=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}c[c.length]=r+"="+n}return c}function Yc(t,r,e){var n=e||{},i=+!n.skipHeader,a=t||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?at(n.origin):n.origin;s=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:s+r.length-1+i}};if(a["!ref"]){var v=He(a["!ref"]);f.e.c=Math.max(f.e.c,v.e.c),f.e.r=Math.max(f.e.r,v.e.r),s==-1&&(s=v.e.r+1,f.e.r=s+r.length-1+i)}else s==-1&&(s=0,f.e.r=r.length-1+i);var p=n.header||[],x=0;r.forEach(function(h,S){mt(h).forEach(function(D){(x=p.indexOf(D))==-1&&(p[x=p.length]=D);var I=h[D],P="z",H="",Z=Re({c:o+x,r:s+S+i});l=Gi(a,Z),I&&typeof I=="object"&&!(I instanceof Date)?a[Z]=I:(typeof I=="number"?P="n":typeof I=="boolean"?P="b":typeof I=="string"?P="s":I instanceof Date?(P="d",n.cellDates||(P="n",I=Vt(I)),H=n.dateNF||$e[14]):I===null&&n.nullError&&(P="e",I=0),l?(l.t=P,l.v=I,delete l.w,delete l.R,H&&(l.z=H)):a[Z]=l={t:P,v:I},H&&(l.z=H))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var w=dt(s);if(i)for(x=0;x<p.length;++x)a[_t(x+o)+w]={t:"s",v:p[x]};return a["!ref"]=Je(f),a}function Dv(t,r){return Yc(null,t,r)}function Gi(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var n=at(r);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?Gi(t,Re(r)):Gi(t,Re({r,c:e||0}))}function Iv(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Nv(){return{SheetNames:[],Sheets:{}}}function Pv(t,r,e,n){var i=1;if(!e)for(;i<=65535&&t.SheetNames.indexOf(e="Sheet"+i)!=-1;++i,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(e)>=0){var a=e.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||e;for(++i;i<=65535&&t.SheetNames.indexOf(e=s+i)!=-1;++i);}if(Vc(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function Ov(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Iv(t,r);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[n].Hidden=e}function Lv(t,r){return t.z=r,t}function Jc(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function Rv(t,r,e){return Jc(t,"#"+r,e)}function Mv(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function Bv(t,r,e,n){for(var i=typeof r!="string"?r:He(r),a=typeof r=="string"?r:Je(r),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var c=Gi(t,s,o);c.t="n",c.F=a,delete c.v,s==i.s.r&&o==i.s.c&&(c.f=e,n&&(c.D=!0))}return t}var Os={encode_col:_t,encode_row:dt,encode_cell:Re,encode_range:Je,decode_col:Ts,decode_row:Es,split_cell:th,decode_cell:at,decode_range:jt,format_cell:Vr,sheet_add_aoa:Zo,sheet_add_json:Yc,sheet_add_dom:Xc,aoa_to_sheet:pi,json_to_sheet:Dv,table_to_sheet:jc,table_to_book:fv,sheet_to_csv:Ps,sheet_to_txt:Kc,sheet_to_json:ba,sheet_to_html:Gc,sheet_to_formulae:zv,sheet_to_row_object_array:ba,sheet_get_cell:Gi,book_new:Nv,book_append_sheet:Pv,book_set_sheet_visibility:Ov,cell_set_number_format:Lv,cell_set_hyperlink:Jc,cell_set_internal_link:Rv,cell_add_comment:Mv,sheet_set_array_formula:Bv,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var z2=Mi.version;var Ms=Ks(Zc());var Qc=()=>({x:"1000px"});function Uv(t,r){if(t&1&&L(0,"nz-option",19),t&2){let e=r.$implicit;F("nzValue",e.routeId)("nzLabel",e.routeName)}}function Wv(t,r){if(t&1&&(wi(0),u(1,"tr")(2,"td"),C(3),m(),u(4,"td"),C(5),m(),u(6,"td"),C(7),m(),u(8,"td"),C(9),m(),u(10,"td"),C(11),m(),u(12,"td"),C(13),m()(),Ei()),t&2){let e=r.$implicit;y(3),Zi("",e.firstName," ",e.lastName,""),y(2),Ce(e.email),y(2),Ce(e.phoneNumber),y(2),Ce(e.curp),y(2),Ce(e.age),y(2),Ce(e.adress)}}function Hv(t,r){if(t&1&&L(0,"nz-option",19),t&2){let e=r.$implicit;F("nzValue",e.routeId)("nzLabel",e.routeName)}}function Gv(t,r){if(t&1&&(wi(0),u(1,"tr")(2,"td"),C(3),m(),u(4,"td"),C(5),m(),u(6,"td"),C(7),m(),u(8,"td"),C(9),m(),u(10,"td"),C(11),m(),u(12,"td"),C(13),m(),u(14,"td"),C(15),m()(),Ei()),t&2){let e=r.$implicit;y(3),Ce(e.date),y(2),Ce(e.studentName),y(2),Ce(e.user.group),y(2),Ce(e.op),y(2),Ce(e.round),y(2),Ce(e.driver),y(2),Ce(e.vehicleName)}}var el=(()=>{class t{constructor(e,n,i){this.notification=e,this.messageService=n,this.fb=i,this.accountId="",this.usersService=we(Mn),this.usrService=we(Bn),this.authService=we(Ot),this.vendorsService=we($n),this.routesService=we(jn),this.userData=[],this.listOfCurrentPageData=[],this.listOfCurrentPageDataScan=[],this.pageSize=10,this.routeNamesMap={},this.selectedRouteId="",this.selectedRouteIdScan="",this.selectedRouteNameScan="",this.filteredUserData=[],this.filteredUserDataScan=[],this.stopSubscription$=new qt,this.logisticsService=we(g0),this.liveService=we(_0),this.startDate=ja(),this.endDate=Xa(),this.authService.user.subscribe(a=>{a&&a.rolId&&(this.user=a)}),this.dateRangeForm=this.fb.group({startDate:[ja()],endDate:[Xa()],selectedOption:[null]})}getusers(){this.usersService.getAccountUsers(this.accountId).pipe(Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return De({id:i},a)}))).subscribe(e=>{this.userData=e,this.filteredUserData=[...this.userData]})}ngOnInit(){this.loadRoutes(),this.getusers()}filterUsersByRoute(){this.selectedRouteId?this.filteredUserData=this.userData.filter(e=>e.defaultRoute===this.selectedRouteId):this.filteredUserData=[...this.userData]}filterUsersByRouteScan(){}loadRoutes(){this.routesService.getRoutes(this.accountId).pipe(pt(this.stopSubscription$),Fe(e=>e.map(n=>{let i=n.payload.doc.id,a=n.payload.doc.data();return{routeId:i,routeName:a.description??"Sin nombre"}}))).subscribe(e=>{this.routesList=e})}export(){let e=this.routesList.find(c=>c.routeId===this.selectedRouteId)?.routeName||"Todas",n=this.filteredUserData.map(c=>({Nombre:`${c.firstName} ${c.lastName}`,Correo:c.email,Tel\u00E9fono:c.phoneNumber,Ruta:e,Curp:c.curp,Edad:c.age,Direcci\u00F3n:c.adress,Poblacion:c.group})),a={Sheets:{Usuarios:Os.json_to_sheet(n)},SheetNames:["Usuarios"]},s=Ba(a,{bookType:"xlsx",type:"array"}),o=new Blob([s],{type:"application/octet-stream"});Ms.saveAs(o,`usuarios_exportados_${new Date().toISOString().slice(0,10)}.xlsx`)}exportScan(){let e=this.filteredUserDataScan.map(c=>({Nombre:c.studentName,Fecha:c.date,Ruta:c.op,Turno:c.round,Conductor:c.driver,Vehiculo:c.vehicleName,Email:c.user?.email||"",CURP:c.user?.curp||"",Tel\u00E9fono:c.user?.phoneNumber||"",C\u00F3digoPostal:c.user?.zipCode||"",Direcci\u00F3n:c.user?.adress||"",Edad:c.user?.age||"",NombreCompleto:c.user?.displayName||"",NombreUsuario:c.user?.firstName||"",Apellido:c.user?.lastName||"",Grupo:c.user?.group||"",Ocupaci\u00F3n:c.user?.occupation||"",Username:c.user?.username||"",Cliente:c.user?.customerName||"",Status:c.user?.status||"",RutaDefault:c.user?.defaultRoute||"",FechaRegistro:c.user?.dateCreateUserFormat||"",ViajeRedondo:c.user?.roundTrip||"",Poblacion:c.user?.group||""})),n=Os.json_to_sheet(e),i="Usuarios Escaneados",a={Sheets:{[i]:n},SheetNames:[i]},s=Ba(a,{bookType:"xlsx",type:"array"}),o=new Blob([s],{type:"application/octet-stream"});Ms.saveAs(o,`usuarios_scan_exportados_${new Date().toISOString().slice(0,10)}.xlsx`)}ngOnDestroy(){this.stopSubscription$.next(),this.stopSubscription$.complete()}loadData(){this.startDate=this.dateRangeForm.get("startDate").value,this.endDate=this.dateRangeForm.get("endDate").value,this.startDate=this.dateRangeForm.get("startDate").value,this.endDate=this.dateRangeForm.get("endDate").value;let e=this.routesList.find(n=>n.routeId===this.selectedRouteIdScan);if(this.selectedRouteNameScan=e?e.routeName:"",this.selectedRouteIdScan!="")if(this.startDate&&this.endDate)this.logisticsService.getActivityLogByCustomerByRoute(this.startDate,this.endDate,this.accountId,this.selectedRouteIdScan).pipe(Ir(n=>{}),Qs(n=>{let i=n.map(a=>{let s=a.payload.doc.data(),o=a.payload.doc.id,c=s.userId;return this.usrService.getUserInfoScan(c).pipe(Zs(1),Js(l=>(console.error("Error al obtener usuario",c,l),Si(null))),Fe(l=>fr(De({},s),{id:o,op:this.selectedRouteNameScan,user:l||{}})))});return i.length>0?Ys(i):Si([])})).subscribe(n=>{this.filteredUserDataScan=n,console.log(n)});else{this.notification.create("error","Error","Se Requiere un rango de fechas");return}}onDateRangeChange(){}static{this.\u0275fac=function(n){return new(n||t)(Te(ea),Te(Ke),Te(gt))}}static{this.\u0275cmp=rt({type:t,selectors:[["app-reports"]],inputs:{accountId:"accountId"},decls:68,vars:25,consts:[[1,"site-page-header-ghost-wrapper"],[2,"background-color","#f9fbfd",3,"nzGhost"],[2,"font-weight","bold"],["nzTitle","Usuarios"],[2,"margin-bottom","16px"],["for","routeFilter",2,"margin-right","8px","font-weight","bold"],["id","routeFilter","nzPlaceHolder","Selecciona una Operaci\xF3n",3,"ngModelChange","ngModel"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nz-button","",2,"background-color","#4F6F57","color","#f6f3ea",3,"click"],[3,"nzCurrentPageDataChange","nzData","nzPageSize","nzFrontPagination","nzShowPagination","nzScroll","nzSize"],[4,"ngFor","ngForOf"],["nzTitle","Escaneos"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],[3,"formGroup"],["formControlName","startDate"],["formControlName","endDate"],["for","routeFilter1",2,"margin-right","8px","font-weight","bold"],["id","routeFilter1","nzPlaceHolder","Selecciona una Operaci\xF3n",3,"ngModelChange","ngModel"],[3,"nzValue","nzLabel"]],template:function(n,i){n&1&&(u(0,"div",0)(1,"nz-page-header",1)(2,"nz-page-header-extra")(3,"div",2),C(4),m()()()(),u(5,"nz-tabset")(6,"nz-tab",3)(7,"div",4)(8,"label",5),C(9,"Filtrar por Ruta:"),m(),u(10,"nz-select",6),kt("ngModelChange",function(s){return Tt(i.selectedRouteId,s)||(i.selectedRouteId=s),s}),le("ngModelChange",function(){return i.filterUsersByRoute()}),ue(11,Uv,1,2,"nz-option",7),m(),u(12,"div",2),C(13),u(14,"button",8),le("click",function(){return i.export()}),C(15,"Exportar"),m()()(),u(16,"nz-table",9),le("nzCurrentPageDataChange",function(s){return i.listOfCurrentPageData=s.slice()}),u(17,"thead")(18,"tr")(19,"th"),C(20,"Nombre"),m(),u(21,"th"),C(22,"Correo"),m(),u(23,"th"),C(24,"Tel\xE9fono"),m(),u(25,"th"),C(26,"Curp"),m(),u(27,"th"),C(28,"Edad"),m(),u(29,"th"),C(30,"Direccion"),m()()(),u(31,"tbody"),ue(32,Wv,14,7,"ng-container",10),m()()(),u(33,"nz-tab",11)(34,"div",12)(35,"h5",13),C(36,"Actividad en Vivo"),m()(),u(37,"form",14),L(38,"nz-date-picker",15)(39,"nz-date-picker",16),m(),u(40,"div")(41,"label",17),C(42,"Filtrar por Ruta:"),m(),u(43,"nz-select",18),kt("ngModelChange",function(s){return Tt(i.selectedRouteIdScan,s)||(i.selectedRouteIdScan=s),s}),le("ngModelChange",function(){return i.loadData()}),ue(44,Hv,1,2,"nz-option",7),m(),u(45,"div",2),C(46),u(47,"button",8),le("click",function(){return i.exportScan()}),C(48,"Exportar"),m()()(),u(49,"nz-table",9),le("nzCurrentPageDataChange",function(s){return i.listOfCurrentPageDataScan=s.slice()}),u(50,"thead")(51,"tr")(52,"th"),C(53,"Fecha"),m(),u(54,"th"),C(55,"Nombre"),m(),u(56,"th"),C(57,"Grupo"),m(),u(58,"th"),C(59,"Operaci\xF3n"),m(),u(60,"th"),C(61,"Turno"),m(),u(62,"th"),C(63,"Veh\xEDculo"),m(),u(64,"th"),C(65,"Chofer"),m()()(),u(66,"tbody"),ue(67,Gv,16,7,"ng-container",10),m()()()()),n&2&&(y(),F("nzGhost",!1),y(3),Be(" Usuarios Actuales: ",i.userData.length," "),y(6),Et("ngModel",i.selectedRouteId),y(),F("ngForOf",i.routesList),y(2),Be(" Usuarios Totales: ",i.filteredUserData.length," "),y(3),F("nzData",i.filteredUserData)("nzPageSize",i.pageSize)("nzFrontPagination",!0)("nzShowPagination",!0)("nzScroll",_r(23,Qc))("nzSize","middle"),y(16),F("ngForOf",i.listOfCurrentPageData),y(5),F("formGroup",i.dateRangeForm),y(6),Et("ngModel",i.selectedRouteIdScan),y(),F("ngForOf",i.routesList),y(2),Be(" Usuarios Totales: ",i.filteredUserDataScan.length," "),y(3),F("nzData",i.filteredUserDataScan)("nzPageSize",i.pageSize)("nzFrontPagination",!0)("nzShowPagination",!0)("nzScroll",_r(24,Qc))("nzSize","middle"),y(18),F("ngForOf",i.listOfCurrentPageDataScan))},dependencies:[xt,Yn,Qr,Yr,Jr,tn,Zr,en,Mt,Lt,Rt,nr,Cr,ir,ar,It,vt,Dt,Nt,Pt,Ln,Xn,Gn]})}}return t})();function jv(t,r){if(t&1&&L(0,"app-shared-account-edit",10),t&2){let e=j();F("accountId",e.recordId)}}function $v(t,r){if(t&1&&L(0,"app-shared-account-payment-methods",10),t&2){let e=j();F("accountId",e.recordId)}}function qv(t,r){if(t&1&&L(0,"app-shared-routes-list",10),t&2){let e=j();F("accountId",e.recordId)}}function Kv(t,r){if(t&1&&L(0,"app-shared-customer-vendor-assignments",10),t&2){let e=j();F("accountId",e.recordId)}}function Yv(t,r){if(t&1&&L(0,"app-shared-products-list",10),t&2){let e=j();F("accountId",e.recordId)}}function Jv(t,r){if(t&1&&L(0,"app-promotions",10),t&2){let e=j();F("accountId",e.recordId)}}function Zv(t,r){if(t&1&&L(0,"app-reports",10),t&2){let e=j();F("accountId",e.recordId)}}var Y2=(()=>{class t{constructor(e,n,i,a){this.fb=e,this.route=n,this.modalService=i,this.message=a,this.accountsService=we(Un),this.selectedIndex=0,this.record=[],this.avatarUrl="http://themenate.com/applicator/dist/assets/images/avatars/thumb-13.jpg"}ngOnInit(){this.sub=this.route.params.subscribe(e=>{this.recordId=e.id,this.selectedIndex=e.index,this.getSubscriptions()}),this.changePWForm=this.fb.group({oldPassword:[null,[fe.required]],newPassword:[null,[fe.required]],confirmPassword:[null,[fe.required]]})}ngOnDestroy(){this.sub.unsubscribe()}showConfirm(){this.modalService.confirm({nzTitle:"<i>Do you want to change your password?</i>",nzOnOk:()=>this.message.success("Password Change Successfully")})}getSubscriptions(){this.accountsService.getAccount(this.recordId).pipe(Fe(e=>{let n=e.payload.id,i=e.payload.data();return De({id:n},i)})).subscribe(e=>{this.record=e})}submitForm(){for(let e in this.changePWForm.controls)this.changePWForm.controls[e].markAsDirty(),this.changePWForm.controls[e].updateValueAndValidity();this.showConfirm()}getBase64(e,n){let i=new FileReader;i.addEventListener("load",()=>n(i.result)),i.readAsDataURL(e)}static{this.\u0275fac=function(n){return new(n||t)(Te(gt),Te(t0),Te(Nr),Te(Ke))}}static{this.\u0275cmp=rt({type:t,selectors:[["app-edit"]],decls:21,vars:2,consts:[["nzBackIcon","",1,"page-header",2,"background-color","#f9fbfd"],[1,"page-header-tab",3,"nzSelectedIndex"],["nzTitle","General"],["nz-tab",""],["nzTitle","M\xE9todos de Pago"],["nzTitle","Operaci\xF3n"],["nzTitle","Asignaciones"],["nzTitle","Productos"],["nzTitle","Promociones"],["nzTitle","Reportes"],[3,"accountId"]],template:function(n,i){n&1&&(u(0,"nz-page-header",0)(1,"nz-page-header-title"),C(2),m(),u(3,"nz-page-header-subtitle"),C(4,"Detalles de la empresa"),m(),u(5,"nz-page-header-content")(6,"nz-tabset",1)(7,"nz-tab",2),ue(8,jv,1,1,"ng-template",3),m(),u(9,"nz-tab",4),ue(10,$v,1,1,"ng-template",3),m(),u(11,"nz-tab",5),ue(12,qv,1,1,"ng-template",3),m(),u(13,"nz-tab",6),ue(14,Kv,1,1,"ng-template",3),m(),u(15,"nz-tab",7),ue(16,Yv,1,1,"ng-template",3),m(),u(17,"nz-tab",8),ue(18,Jv,1,1,"ng-template",3),m(),u(19,"nz-tab",9),ue(20,Zv,1,1,"ng-template",3),m()()()()),n&2&&(y(2),Ce(i.record.name),y(4),F("nzSelectedIndex",i.selectedIndex))},dependencies:[nr,Wn,Hn,ra,Xn,Gn,l0,k0,y0,D0,N0,L0,R0,el]})}}return t})();export{ug as a,Y2 as b};
